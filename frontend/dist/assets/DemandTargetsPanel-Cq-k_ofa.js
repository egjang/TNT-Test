import{r as n,j as e}from"./index-BDCdW1US.js";import{t as o}from"./tone-B1QjB-CC.js";function I(){var j,p;const[h,m]=n.useState(!1),[c,x]=n.useState(null),[i,u]=n.useState([]),[d,v]=n.useState(""),y=new Date().getFullYear(),b=((j=i[0])==null?void 0:j.year1)??y,S=((p=i[0])==null?void 0:p.year2)??y-1;async function g(s){x(null),m(!0);try{const t=localStorage.getItem("tnt.sales.empId");if(!t)throw new Error("로그인이 필요합니다");const r=new URL("/api/v1/customers/missing-demand",window.location.origin);r.searchParams.set("mineOnly","true"),r.searchParams.set("empId",t),r.searchParams.set("limit","500"),s&&s.trim()&&r.searchParams.set("name",s.trim());const a=await fetch(r.toString());if(!a.ok){let w=`HTTP ${a.status}`;try{const l=await a.json();l!=null&&l.error&&(w=l.error)}catch{}throw new Error(w)}const f=await a.json(),E=Array.isArray(f)?f:[];u(E)}catch(t){x(t.message||"조회 중 오류가 발생했습니다"),u([])}finally{m(!1)}}n.useEffect(()=>{g()},[]),n.useEffect(()=>{const s=setTimeout(()=>{g(d)},300);return()=>clearTimeout(s)},[d]);const N=n.useMemo(()=>{if(h)return e.jsx("div",{className:"muted",children:o.loading});if(c)return e.jsx("div",{className:"error",children:c||o.errorGeneric});if(i.length===0)return e.jsx("div",{className:"empty-state",children:o.empty});const s=({on:t})=>e.jsx("span",{style:{fontWeight:700,color:t?"#059669":"#94a3b8",opacity:t?1:.35},children:"$"});return e.jsx("div",{className:"table-container",style:{border:"1px solid var(--border)",borderRadius:8},children:e.jsxs("table",{className:"table",style:{width:"100%"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:140},children:"회사구분"}),e.jsx("th",{style:{width:200},children:"거래처명"}),e.jsx("th",{style:{width:80,textAlign:"center"},children:S}),e.jsx("th",{style:{width:80,textAlign:"center"},children:b})]})}),e.jsx("tbody",{children:i.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{children:t.companyType}),e.jsx("td",{children:t.customerName}),e.jsx("td",{style:{textAlign:"center"},children:e.jsx(s,{on:t.hasSalesY2})}),e.jsx("td",{style:{textAlign:"center"},children:e.jsx(s,{on:t.hasSalesY1})})]},`${t.customerName}-${r}`))})]})})},[h,c,i]);return e.jsxs("div",{style:{padding:8,display:"flex",flexDirection:"column",height:"100%"},children:[e.jsxs("div",{style:{marginBottom:8,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("div",{style:{fontWeight:400,fontSize:12,lineHeight:"18px",whiteSpace:"normal"},children:o.title.demandTargets}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("input",{value:d,onChange:s=>v(s.target.value),placeholder:"거래처명 검색",style:{fontSize:12,padding:"4px 8px",border:"1px solid var(--border)",borderRadius:6}}),e.jsxs("div",{className:"muted",style:{fontSize:12},children:["미수립 ",i.length,"건"]})]})]}),N]})}export{I as DemandTargetsPanel};
