var Gb=Object.defineProperty;var Vb=(e,t,r)=>t in e?Gb(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Yl=(e,t,r)=>Vb(e,typeof t!="symbol"?t+"":t,r);import{c as It,r as c,j as n,_ as zf,R as Ae,a as jd,g as Wf,b as Kl,o as Xb,i as Gl,s as Qb,P as Zp,C as zo,d as Ti,F as wd,e as Nc,T as eg,f as Vr,h as Jb,k as Zb}from"./index-BmcpNj69.js";import{DemandList as ej}from"./DemandList-BqulI4_7.js";import{c as Pt}from"./close-CV7tuFPj.js";import{t as lt}from"./tone-B1QjB-CC.js";import{u as wn}from"./useDraggableModal-Bhzq3OTK.js";import{S as Rt,a as ya,g as Bf,f as tj}from"./week-B2gHVnfh.js";import{c as tg,a as ng}from"./chevron-right-DHqVul_D.js";import{w as Ff}from"./warehouse-Du5HBj7c.js";import{C as qf,P as nj}from"./plus-Dk5bBnfh.js";import"./check-Bie4bzYh.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rj=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],aj=It("arrow-left",rj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ij=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],sj=It("arrow-right",ij);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oj=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],lj=It("award",oj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cj=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],dj=It("chart-no-axes-column",cj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uj=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],fj=It("circle-check-big",uj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hj=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Wo=It("circle-check",hj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mj=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],pj=It("clock",mj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gj=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],yj=It("database",gj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vj=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ci=It("dollar-sign",vj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xj=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],bj=It("ellipsis",xj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jj=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],wj=It("eye",jj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sj=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],Nj=It("flame",Sj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kj=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]],Aj=It("layout-list",kj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cj=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],rg=It("layout-grid",Cj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ej=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Pj=It("list",Ej);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ij=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Uf=It("loader-circle",Ij);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tj=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Oj=It("refresh-cw",Tj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _j=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],va=It("search",_j);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dj=[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]],Mj=It("table-2",Dj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $j=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],Lj=It("thumbs-up",$j);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rj=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],zj=It("triangle-alert",Rj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wj=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],kc=It("user",Wj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bj=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Sd=It("x",Bj),ln={demandManagement:!0,customerManagement:!0};function Fj(){const e=c.useRef(null),[t,r]=c.useState(null),[a,i]=c.useState([]),[s,o]=c.useState(null),[l,d]=c.useState([]),[h,u]=c.useState([]),[f,m]=c.useState(null),[p,x]=c.useState(!1),[v,g]=c.useState(null),[b,y]=c.useState(0),[N,A]=c.useState(""),E=()=>{var L;return(L=e.current)==null?void 0:L.click()},w=async L=>{var S;m(null);const j=(S=L.target.files)==null?void 0:S[0];if(r(j?j.name:null),d([]),i([]),o(null),!!j)try{const R=await zf(()=>import("./xlsx-D_0l8YDs.js"),[]),O=await j.arrayBuffer(),z=R.read(O,{type:"array"}),Z=z.SheetNames||[];i(Z);const ae=Z[0];if(o(ae||null),ae){const se=z.Sheets[ae],H=R.utils.sheet_to_json(se,{header:1});u(H),d(H)}}catch(R){m("엑셀 파일을 읽는 중 오류가 발생했습니다. 파일 형식을 확인해 주세요."),console.error(R)}},P=l&&l.length>0,_=c.useMemo(()=>{if(!P)return null;const L=l.reduce((j,S)=>Math.max(j,Array.isArray(S)?S.length:0),0);return n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsx("tr",{children:Array.from({length:L}).map((j,S)=>n.jsxs("th",{children:["C",S+1]},S))})}),n.jsx("tbody",{children:l.map((j,S)=>n.jsx("tr",{children:Array.from({length:L}).map((R,O)=>n.jsx("td",{children:Array.isArray(j)&&j[O]!=null?String(j[O]):""},O))},S))})]})})},[l,P]),$=async L=>{var R,O;const j=L.target.value;o(j);const S=(O=(R=e.current)==null?void 0:R.files)==null?void 0:O[0];if(S)try{const z=await zf(()=>import("./xlsx-D_0l8YDs.js"),[]),Z=await S.arrayBuffer(),se=z.read(Z,{type:"array"}).Sheets[j],H=z.utils.sheet_to_json(se,{header:1});u(H),d(H)}catch(z){m("시트를 전환하는 중 오류가 발생했습니다."),console.error(z)}};return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:18},children:"Excel Upload"}),n.jsx("div",{className:"muted count-text"})]}),n.jsx("p",{children:"로컬 PC에서 엑셀 파일(.xlsx, .xls)만 선택할 수 있습니다."}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[n.jsx("input",{ref:e,type:"file",accept:".xlsx,.xls,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",onChange:w,style:{display:"none"}}),n.jsx("button",{className:"btn",onClick:E,children:"엑셀 파일 선택"}),t&&n.jsxs("span",{className:"muted",children:["선택됨: ",t]})]}),a.length>1&&n.jsx("div",{style:{marginTop:10},children:n.jsxs("label",{children:["시트 선택: ",n.jsx("select",{value:s??"",onChange:$,children:a.map(L=>n.jsx("option",{value:L,children:L},L))})]})}),f&&n.jsx("div",{className:"error",children:f}),_,P&&n.jsxs("div",{style:{marginTop:12,display:"flex",alignItems:"center",gap:10},children:[n.jsx("button",{type:"button",className:"btn",disabled:p,onClick:async L=>{L.preventDefault(),L.stopPropagation(),g(null),m(null);try{x(!0),y(0),A("데이터 준비 중...");const j=qj(h);if(!j.length)throw new Error("업로드할 데이터가 없습니다. 엑셀 내용을 확인해 주세요.");const R=Hj(j,250);let O=0,z=0,Z=0;for(let ae=0;ae<R.length;ae++){const se=R[ae];A(`업로드 중... (${ae+1}/${R.length})`);const H=await fetch("/api/v1/demand/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:se})});if(!H.ok){const C=await H.text();try{const T=JSON.parse(C),W=(T==null?void 0:T.error)||C||`Upload failed: ${H.status}`;throw new Error(W)}catch{throw new Error(`Upload failed: ${H.status} ${C}`)}}const q=await H.json();z+=Number(q.updated||0),Z+=Number(q.inserted||0),O+=se.length,y(Math.min(100,Math.round(O/j.length*100)))}A("완료"),g(`성공: 총 ${z+Z}건 (업데이트 ${z}, 신규 ${Z})`)}catch(j){m(j.message||"업로드 중 오류가 발생했습니다")}finally{x(!1),setTimeout(()=>{y(0),A("")},1200)}},children:"업로드"}),v&&n.jsx("span",{className:"muted",children:v})]}),p&&n.jsxs("div",{style:{marginTop:10,width:"100%"},children:[n.jsx("div",{className:"progress",children:n.jsx("div",{className:"progress-bar",style:{width:`${b}%`}})}),n.jsxs("div",{className:"muted",style:{marginTop:6},children:[N," ",b>0?`${b}%`:""]})]})]})}function qj(e){if(!e||e.length===0)return[];const t=e[0].map(v=>String(v||"").trim()),r=e.slice(1);function a(v){return t.map((g,b)=>v.some(y=>gs(g,y))?b:-1).filter(g=>g>=0)}const i=t.findIndex(v=>["영업담당자","영업사원","sales_owner","sales_rep","sales_rep_name"].some(g=>gs(v,g))),s=t.findIndex(v=>["거래처","고객","customer"].some(g=>gs(v,g))),o=t.findIndex(v=>["중분류","품목중분류","종분류","category_mid","item_subcategory"].some(g=>gs(v,g))),l=a(["공급사(tnt)","공급사 tnt","tnt","공급사","공급자","supplier"]),d=a(["영업관리단위","관리단위","mgmt_unit","sales_mgmt_unit"]),h=a(["점유율(%)","점유율","share","share_rate"]),u=Math.max(l.length,d.length,h.length),f=[];let m=null,p=null,x=null;for(const v of r){let g=Ma(v,i).trim(),b=Ma(v,s).trim(),y=Ma(v,o).trim();if(g||(g=m||""),b||(b=p||""),y||(y=x||""),!g||!b||!y){g&&(m=g),b&&(p=b),y&&(x=y);continue}m=g,p=b,x=y;for(let N=0;N<u;N++){const A=Ma(v,l[N]).trim(),E=Ma(v,d[N]).trim(),w=Uj(Ma(v,h[N])),P=w!=null&&w!==0;if(!(A||E||P))continue;const _=P?w:null;f.push({salesRepName:g,customerName:b,itemSubcategory:y,supplierName:A,salesMgmtUnit:E,shareRate:_,priority:N+1})}}return f}function Ma(e,t){return t>=0?e[t]??"":""}function Hf(e){return String(e||"").replace(/[\s\-_%()\[\]{}]/g,"").replace(/tnt/gi,"").toLowerCase()}function gs(e,t){return Hf(e)===Hf(t)}function Uj(e){if(e==null)return null;const t=Number(String(e).replace(/[,\s%]/g,""));return Number.isFinite(t)?t:null}function Hj(e,t){const r=[];for(let a=0;a<e.length;a+=t)r.push(e.slice(a,a+t));return r}const ag="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='20'%20height='20'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20aria-hidden='true'%3e%3cpath%20d='M20.59%2013.41%2011%203H4v7l9.59%209.59a2%202%200%200%200%202.82%200l4.18-4.18a2%202%200%200%200%200-2.82Z'/%3e%3ccircle%20cx='7.5'%20cy='7.5'%20r='1.5'/%3e%3c/svg%3e";function Yj(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function Yf(){const[e,t]=c.useState(""),[r,a]=c.useState(""),[i,s]=c.useState(""),[o,l]=c.useState(!1),[d,h]=c.useState(null),[u,f]=c.useState([]),[m,p]=c.useState(""),[x,v]=c.useState(!1),[g,b]=c.useState({open:!1,x:0,y:0}),[y,N]=c.useState(()=>new Set),[A,E]=c.useState({open:!1,x:0,y:0}),[w,P]=c.useState(void 0),[_,$]=c.useState("init"),[L,j]=c.useState({}),[S,R]=c.useState("TNT"),O=100,[z,Z]=c.useState(0),[ae,se]=c.useState(!0),[H,q]=c.useState(!1),C=Ae.useRef(null),[T,W]=c.useState(0),I=["init","sim","apply","confirm"],U=[{key:"init",label:"초기설정"},{key:"sim",label:"Simulation"},{key:"apply",label:"목표반영"},{key:"confirm",label:"확정"}],K=I.indexOf(_),Y=()=>{const V=Math.max(0,K-1);$(I[V])},M=()=>{const V=Math.min(I.length-1,K+1);$(I[V])};function D(){const V=[];for(let ce=2030;ce>=2026;ce--)V.push(ce);return V}const[oe,F]=c.useState(""),[G,de]=c.useState(!1),[be,ke]=c.useState(null),[ye,Ce]=c.useState({tnt:0,dys:0}),[J,ge]=c.useState({tnt:0,dys:0}),[Ee,we]=c.useState({tnt:0,dys:0}),He=new Intl.NumberFormat("ko-KR");function mt(V,ce){return Number.isFinite(V)?V:0}function vt(V,ce){const je=Number.isFinite(V)&&V>0,Te=je?mt(V):0;return n.jsxs("div",{style:{textAlign:"right",lineHeight:1.15},children:[n.jsx("div",{children:je?V%1===0?Math.round(V).toLocaleString():V.toFixed(2):"-"}),n.jsx("div",{className:"muted",style:{fontSize:11},children:je?`${He.format(Math.round(Te))} 원`:""})]})}async function Ot(){de(!0),ke(null);try{const V=(localStorage.getItem("tnt.sales.empName")||"").trim();if(!V){Ce({tnt:0,dys:0}),ke("로그인이 필요합니다");return}if(!oe||isNaN(Number(oe))){Ce({tnt:0,dys:0});return}const ce=new URL("/api/v1/targets/assigned",window.location.origin);ce.searchParams.set("year",String(oe)),ce.searchParams.set("empNames",V);try{const Oe=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),Be=Oe==="moderate"?"2":Oe==="best"?"1":"";Be&&ce.searchParams.set("versionNo",Be)}catch{}const je=await fetch(ce.toString());if(!je.ok)throw new Error(`HTTP ${je.status}`);const Te=await je.json().catch(()=>[]),ze=Array.isArray(Te)?Te.find(Oe=>String(Oe.company_name||"").toUpperCase()==="TNT"):null,Pe=Array.isArray(Te)?Te.find(Oe=>String(Oe.company_name||"").toUpperCase()==="DYS"):null;Ce({tnt:Math.round(Number((ze==null?void 0:ze.assigned_amount)||0)),dys:Math.round(Number((Pe==null?void 0:Pe.assigned_amount)||0)),tntStage:String((ze==null?void 0:ze.target_stage)||"").trim()||void 0,dysStage:String((Pe==null?void 0:Pe.target_stage)||"").trim()||void 0})}catch(V){ke((V==null?void 0:V.message)||"조회 오류"),Ce({tnt:0,dys:0})}finally{de(!1)}}const[pt,Xt]=c.useState(0);c.useEffect(()=>{const V=()=>Xt(ce=>ce+1);return window.addEventListener("tnt.sales.assign.mode.changed",V),()=>window.removeEventListener("tnt.sales.assign.mode.changed",V)},[]),c.useEffect(()=>{Ot()},[oe,pt]);const[Ke,gt]=c.useState(!1),[Qe,_t]=c.useState(null);new Date().getFullYear();const[rn,vn]=c.useState("prev1"),[Xe,An]=c.useState(()=>new Array(12).fill(0)),[ta,xn]=c.useState({loading:!1});async function hn(){if(!(w!=null&&w.customerSeq)){An(new Array(12).fill(0));return}gt(!0),_t(null);try{const V=new Date().getFullYear(),ce=rn==="prev1"?[V-1]:rn==="last2"?[V-1,V-2]:[V-1,V-2,V-3],je=[];await Promise.all(ce.map(async Oe=>{try{const Be=await fetch(`/api/v1/customers/${w.customerSeq}/invoice-monthly-by-dim?year=${Oe}`);if(!Be.ok)return;const ct=await Be.json().catch(()=>[]),qt=Ve=>{const xt=String(Ve??"").trim();return xt.toLowerCase()==="na"?"":xt},on=(Array.isArray(ct)?ct:[]).map(Ve=>({itemSubcategorySeq:Number(Ve.itemSubcategorySeq??Ve.item_subcategory_seq??0),salesMgmtUnitSeq:Number(Ve.salesMgmtUnitSeq??Ve.sales_mgmt_unit_seq??0),itemSubcategory:qt(Ve.itemSubcategory??Ve.item_subcategory),salesMgmtUnit:qt(Ve.salesMgmtUnit??Ve.sales_mgmt_unit),month:Number(Ve.month??0),amount:Number(Ve.amount??0)}));je.push(...on)}catch{}}));const Te=new Map,ze=(Oe,Be)=>`${(Oe||"").trim().toLowerCase()}||${(Be||"").trim().toLowerCase()}`;for(const Oe of je){const Be=ze(Oe.itemSubcategory,Oe.salesMgmtUnit);let ct=Te.get(Be);ct||(ct={sub:Oe.itemSubcategory||"",unit:Oe.salesMgmtUnit||"",months:new Array(12).fill(0)},Te.set(Be,ct));const qt=Math.min(12,Math.max(1,Number(Oe.month)||0))-1;ct.months[qt]+=Number.isFinite(Oe.amount)?Number(Oe.amount):0}const Pe=Array.from(Te.values()).sort((Oe,Be)=>(Oe.sub||"").localeCompare(Be.sub||"")||(Oe.unit||"").localeCompare(Be.unit||""));Ta(Pe)}catch(V){_t(V.message||"조회 중 오류가 발생했습니다"),Ta([])}finally{gt(!1)}}c.useEffect(()=>{_==="init"&&hn()},[_,w==null?void 0:w.customerSeq,rn]);async function an(){if(!(w!=null&&w.customerSeq)){xn({loading:!1,hasRecent:void 0,error:null});return}xn({loading:!0,hasRecent:void 0,error:null});try{const V=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);V.searchParams.set("custSeq",String(w.customerSeq)),V.searchParams.set("years","2");const ce=await fetch(V.toString());if(!ce.ok){let ze=`HTTP ${ce.status}`;try{const Pe=await ce.json();Pe!=null&&Pe.error&&(ze=Pe.error)}catch{}throw new Error(ze)}const je=await ce.json(),Te=Array.isArray(je)&&je.some(ze=>Number((ze==null?void 0:ze.customerSeq)||(ze==null?void 0:ze.customerSeqText)||0)===Number(w.customerSeq)&&!!(ze!=null&&ze.hasRecent));xn({loading:!1,hasRecent:Te,error:null})}catch(V){xn({loading:!1,hasRecent:void 0,error:V.message||"오류"})}}c.useEffect(()=>{_==="init"&&an()},[_,w==null?void 0:w.customerSeq]);const[Yn,Ta]=c.useState([]),Oa=c.useMemo(()=>n.jsx("div",{className:"table-container",style:{border:"1px solid var(--border)",borderRadius:8,marginTop:8},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:220,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:120,textAlign:"center"},children:"목표입력"}),Array.from({length:12},(V,ce)=>n.jsxs("th",{style:{width:90,textAlign:"right"},children:[String(ce+1).padStart(2,"0"),"월"]},ce))]})}),n.jsx("tbody",{children:Yn.length===0?n.jsx("tr",{children:n.jsx("td",{className:"muted",colSpan:15,style:{padding:"12px 10px"},children:Ke?"불러오는 중…":"데이터가 없습니다"})}):Yn.map((V,ce)=>n.jsxs("tr",{children:[n.jsx("td",{children:V.sub}),n.jsx("td",{children:V.unit}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>ci(V.sub,V.unit),children:"목표입력"})}),V.months.map((je,Te)=>n.jsx("td",{style:{textAlign:"right"},children:Math.round(je).toLocaleString()},Te))]},ce))})]})}),[Yn,Ke]),[At,er]=c.useState({open:!1,dist:new Array(12).fill(0)});function ci(V,ce){er({open:!0,sub:V,unit:ce,month:"",qty:"",dist:new Array(12).fill(0)})}function tr(){er({open:!1,dist:new Array(12).fill(0)})}function nr(V,ce){const je=Number(V),Te=Number(ce),ze=new Array(12).fill(0);if(Number.isFinite(je)&&je>=1&&je<=12&&Number.isFinite(Te)&&Te>0){const Pe=12-je+1,Oe=Te/Pe;for(let Be=je-1;Be<12;Be++)ze[Be]=Oe}er(Pe=>({...Pe,month:V,qty:ce,dist:ze}))}const[bn,Kn]=c.useState({open:!1,rows:[]});function Ze(){const V=(Yn||[]).map((ce,je)=>({key:`${ce.sub}||${ce.unit}||${je}`,sub:ce.sub,unit:ce.unit,month:"",qty:"",dist:new Array(12).fill(0)}));Kn({open:!0,rows:V})}function Mn(){Kn({open:!1,rows:[]})}function na(V,ce,je){Kn(Te=>{const ze=Te.rows.slice(),Pe={...ze[V]},Oe=Number(ce??Pe.month),Be=Number(je??Pe.qty),ct=new Array(12).fill(0);if(Number.isFinite(Oe)&&Oe>=1&&Oe<=12&&Number.isFinite(Be)&&Be>0){const qt=12-Oe+1,on=Be/qt;for(let Ve=Oe-1;Ve<12;Ve++)ct[Ve]=on}return Pe.month=ce??Pe.month,Pe.qty=je??Pe.qty,Pe.dist=ct,ze[V]=Pe,{...Te,rows:ze}})}function fr(V){try{const ce=V.getBoundingClientRect(),je=(ce==null?void 0:ce.width)||V.offsetWidth||600,Te=(ce==null?void 0:ce.height)||V.offsetHeight||400,ze=Math.max(0,Math.round((window.innerWidth-je)/2)),Oe=Math.max(0,Math.round(window.innerHeight-Te-40));return{x:ze,y:Oe}}catch{const ce=Math.max(0,Math.round((window.innerWidth-600)/2)),Te=Math.max(0,Math.round(window.innerHeight-400-40));return{x:ce,y:Te}}}function di(V){try{const ce=V.getBoundingClientRect(),je=(ce==null?void 0:ce.width)||V.offsetWidth||460,Te=Math.max(0,Math.round(window.innerWidth-je)),ze=Math.max(0,Math.round(window.innerHeight*.17));return{x:Te,y:ze}}catch{const je=Math.max(0,Math.round(window.innerWidth-460)),Te=Math.max(0,Math.round(window.innerHeight*.17));return{x:je,y:Te}}}const hr=wn("sales-plan-target-input",!!At.open,fr,{persist:!1,resetOnOpen:!0}),ra=wn("sales-plan-bulk-input",!!bn.open,fr,{persist:!1,resetOnOpen:!0}),[rr,aa]=c.useState({open:!1,rows:[]}),[it,Mt]=c.useState("");function re(){const V=(Yn||[]).map((ce,je)=>({key:`${ce.sub}||${ce.unit}||${je}`,sub:ce.sub,unit:ce.unit,month:"",qty:"",dist:new Array(12).fill(0)}));aa({open:!0,rows:V})}function xe(){aa({open:!1,rows:[]})}function ve(V,ce,je){aa(Te=>{const ze=Te.rows.slice(),Pe={...ze[V]},Oe=Number(ce??Pe.month),Be=Number(je??Pe.qty),ct=new Array(12).fill(0);if(Number.isFinite(Oe)&&Oe>=1&&Oe<=12&&Number.isFinite(Be)&&Be>0){const qt=12-Oe+1,on=Be/qt;for(let Ve=Oe-1;Ve<12;Ve++)ct[Ve]=on}return Pe.month=ce??Pe.month,Pe.qty=je??Pe.qty,Pe.dist=ct,ze[V]=Pe,{...Te,rows:ze}})}const Le=wn("sales-plan-bulk-ratio",!!rr.open,fr,{persist:!1,resetOnOpen:!0}),[ue,De]=c.useState({open:!1,loading:!1,error:null,opts:[],dist:new Array(12).fill(0),rows:[]}),Ne=wn("sales-plan-new-item",!!ue.open,fr,{persist:!1,resetOnOpen:!0});async function Fe(){De(V=>({...V,open:!0,loading:!0,error:null,unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0),rows:[]}));try{const V=await fetch("/api/v1/items/dim"),ce=V.ok?await V.json():[],je=Array.isArray(ce)?ce.map(Pe=>({itemSubcategory:String(Pe.itemSubcategory||Pe.item_subcategory||""),salesMgmtUnit:String(Pe.salesMgmtUnit||Pe.sales_mgmt_unit||"")})):[],Te={};je.forEach(Pe=>{const Oe=Pe.salesMgmtUnit.trim();Oe&&!Te[Oe]&&(Te[Oe]=Pe)});const ze=Object.values(Te).sort((Pe,Oe)=>Pe.salesMgmtUnit.localeCompare(Oe.salesMgmtUnit));De(Pe=>({...Pe,loading:!1,opts:ze}))}catch(V){De(ce=>({...ce,loading:!1,error:(V==null?void 0:V.message)||"조회 오류",opts:[]}))}}function qe(){De({open:!1,loading:!1,error:null,opts:[],dist:new Array(12).fill(0),rows:[]})}function Ge(V){const ce=ue.opts.find(je=>je.salesMgmtUnit===V);De(je=>({...je,unit:V,sub:(ce==null?void 0:ce.itemSubcategory)||je.sub}))}function Ue(V,ce){const je=Number(V??ue.month),Te=Number(ce??ue.qty),ze=new Array(12).fill(0);if(Number.isFinite(je)&&je>=1&&je<=12&&Number.isFinite(Te)&&Te>0){const Pe=12-je+1,Oe=Te/Pe;for(let Be=je-1;Be<12;Be++)ze[Be]=Oe}De(Pe=>({...Pe,month:V??Pe.month,qty:ce??Pe.qty,dist:ze}))}function Ct(){const V=(ue.unit||"").trim(),ce=(ue.sub||"").trim(),je=ue.month,Te=ue.qty;if(!V||!je||!Te){alert("영업관리단위, 매출월, 매출 수량을 입력하세요.");return}const ze={sub:ce||"(신규)",unit:V,months:ue.dist.slice()};De(Pe=>({...Pe,rows:[...Pe.rows,ze],unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0)}))}c.useEffect(()=>{if(!At.open&&!bn.open&&!ue.open)return;const V=ce=>{ce.key==="Escape"&&(At.open&&tr(),bn.open&&Mn(),ue.open&&qe())};return window.addEventListener("keydown",V,!0),()=>window.removeEventListener("keydown",V,!0)},[At.open,bn.open,ue.open]);async function st(V=!0){h(null),V?(l(!0),Z(0),se(!0)):q(!0);try{const ce=localStorage.getItem("tnt.sales.assigneeId");if(!ce){f([]),h(lt.loginRequired);return}const je=new URL("/api/v1/customers",window.location.origin);je.searchParams.set("mineOnly","true"),je.searchParams.set("assigneeId",ce),je.searchParams.set("companyType",S),m.trim()&&je.searchParams.set("name",m.trim()),je.searchParams.set("limit",String(O)),je.searchParams.set("offset",String(V?0:z));const Te=await fetch(je.toString());if(!Te.ok){let Oe=`HTTP ${Te.status}`;try{const Be=await Te.json();Be!=null&&Be.error&&(Oe=Be.error)}catch{const Be=await Te.text();Be&&(Oe=Be)}throw new Error(Oe)}const ze=await Te.json(),Pe=Array.isArray(ze)?ze:[];f(V?Pe:Oe=>[...Oe,...Pe]),se(Pe.length>=O),Z(Oe=>V?O:Oe+O);try{if(ce){const Oe=new URL("/api/v1/customers/count",window.location.origin);Oe.searchParams.set("mineOnly","true"),Oe.searchParams.set("assigneeId",ce);const Be=await fetch(Oe.toString());if(Be.ok){const ct=await Be.json().catch(()=>({})),qt=Number((ct==null?void 0:ct.total)??0);W(Number.isFinite(qt)?qt:0)}else W(0)}else W(0)}catch{W(0)}try{const Oe=Pe.map(Be=>Number(Be.customerSeq||0)).filter(Be=>Number.isFinite(Be)&&Be>0);if(Oe.length>0){const Be=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);Be.searchParams.set("custSeq",Array.from(new Set(Oe)).join(",")),Be.searchParams.set("years","2");const ct=await fetch(Be.toString());if(ct.ok){const qt=await ct.json(),on={};Array.isArray(qt)&&qt.forEach(Ve=>{const xt=Number((Ve==null?void 0:Ve.customerSeq)||(Ve==null?void 0:Ve.customerSeqText)||0);Number.isFinite(xt)&&(on[xt]=!!(Ve!=null&&Ve.hasRecent))}),j(Ve=>V?on:{...Ve,...on})}else V&&j({})}else V&&j({})}catch{j({})}}catch(ce){h(ce.message||"조회 중 오류가 발생했습니다")}finally{V?l(!1):q(!1)}}c.useEffect(()=>{st(!0)},[]),c.useEffect(()=>{st(!0)},[S]),c.useEffect(()=>{if(!g.open)return;const V=()=>b({open:!1,x:0,y:0});return window.addEventListener("click",V),()=>window.removeEventListener("click",V)},[g.open]),c.useEffect(()=>{if(!g.open)return;const V=ce=>{ce.key==="Escape"&&b({open:!1,x:0,y:0})};return window.addEventListener("keydown",V),()=>window.removeEventListener("keydown",V)},[g.open]),c.useEffect(()=>{const V=ce=>{((ce==null?void 0:ce.key)==="Escape"||(ce==null?void 0:ce.key)==="Esc"||(ce==null?void 0:ce.keyCode)===27)&&(b({open:!1,x:0,y:0}),E({open:!1,x:0,y:0}))};return document.addEventListener("keydown",V,!0),()=>document.removeEventListener("keydown",V,!0)},[]);async function rt(V,ce){V.preventDefault(),V.stopPropagation(),b({open:!1,x:0,y:0});const je=V.clientX,Te=V.clientY;E({open:!0,x:je,y:Te,row:ce,loading:!1,error:null,data:[]})}const mr=c.useMemo(()=>{var ce,je,Te,ze,Pe,Oe,Be,ct,qt,on,Ve,xt,ia,ui,fs;const V=[...u].sort((mn,zr)=>{const ar=Number(mn.customerSeq||0),fi=Number(zr.customerSeq||0),Wl=!!L[ar],Je=!!L[fi];if(Wl!==Je)return Je?1:-1;const Cn=(mn.customerName||"").toString(),hi=(zr.customerName||"").toString();return Cn.localeCompare(hi,"ko",{sensitivity:"base"})});return n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:8},children:[n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,cursor:"pointer"},children:[n.jsx("input",{type:"radio",name:"companyType",checked:S==="TNT",onChange:()=>R("TNT")}),n.jsx("span",{children:"TNT"})]}),n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,cursor:"pointer"},children:[n.jsx("input",{type:"radio",name:"companyType",checked:S==="DYS",onChange:()=>R("DYS")}),n.jsx("span",{children:"DYS"})]})]}),n.jsxs("div",{ref:C,className:"table-container",onClick:()=>b({open:!1,x:0,y:0}),style:{height:"100%",overflow:"auto"},children:[V.length===0?n.jsx("div",{className:"empty-state",children:lt.empty}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsx("tr",{children:n.jsx("th",{style:{width:"auto"},children:"거래처명"})})}),n.jsx("tbody",{children:V.map((mn,zr)=>n.jsx("tr",{onClick:ar=>{ar.preventDefault(),ar.stopPropagation(),P(mn),E({open:!1,x:0,y:0})},onContextMenu:ar=>rt(ar,mn),"aria-selected":(w==null?void 0:w.customerId)===mn.customerId?!0:void 0,style:(w==null?void 0:w.customerId)===mn.customerId?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:n.jsx("td",{children:(()=>{const ar=Number(mn.customerSeq||0);return L[ar]?n.jsxs("span",{children:[mn.customerName," "," ","$"]}):mn.customerName})()})},zr))})]}),H&&n.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:lt.loading}),!o&&!H&&!ae&&u.length>0&&n.jsx("div",{className:"muted",style:{padding:"8px 10px",textAlign:"center"},children:"마지막 데이터입니다."}),A.open&&n.jsxs("div",{className:"context-menu",style:{left:A.x+6,top:A.y+6,maxWidth:420,padding:8},onClick:mn=>mn.stopPropagation(),children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 상세"}),A.error?n.jsx("div",{className:"error",style:{maxWidth:380},children:A.error}):n.jsx("table",{className:"table",style:{width:"100%"},children:n.jsxs("tbody",{children:[n.jsxs("tr",{children:[n.jsx("th",{style:{width:110,textAlign:"left"},children:"거래처번호"}),n.jsx("td",{children:((ce=A.row)==null?void 0:ce.customerId)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"사업자번호"}),n.jsx("td",{children:((je=A.row)==null?void 0:je.bizNo)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"대표자명"}),n.jsx("td",{children:((Te=A.row)==null?void 0:Te.ownerName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"업태"}),n.jsx("td",{children:((ze=A.row)==null?void 0:ze.bizKind)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"종목"}),n.jsx("td",{children:((Pe=A.row)==null?void 0:Pe.bizType)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"전화번호"}),n.jsx("td",{children:((Oe=A.row)==null?void 0:Oe.telNo)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"담당자명"}),n.jsx("td",{children:((Be=A.row)==null?void 0:Be.empName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"부서명"}),n.jsx("td",{children:((ct=A.row)==null?void 0:ct.deptName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"시/도"}),n.jsx("td",{children:((qt=A.row)==null?void 0:qt.addrProvinceName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"시/군/구"}),n.jsx("td",{children:((on=A.row)==null?void 0:on.addrCityName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"고객유형"}),n.jsx("td",{children:((Ve=A.row)==null?void 0:Ve.customerTypeName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"비고"}),n.jsx("td",{children:((xt=A.row)==null?void 0:xt.customerRemark)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"생성자"}),n.jsx("td",{children:((ia=A.row)==null?void 0:ia.createdBy)??""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"수정자"}),n.jsx("td",{children:((ui=A.row)==null?void 0:ui.updatedBy)??""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"생성일시"}),n.jsx("td",{children:Yj((fs=A.row)==null?void 0:fs.createdAt)})]})]})})]})]})]})},[u,g,y,A,w,L,o,H,ae]);c.useEffect(()=>{const V=C.current;if(!V)return;function ce(){V.scrollTop+V.clientHeight>=V.scrollHeight-48&&ae&&!H&&!o&&st(!1)}return V.addEventListener("scroll",ce),()=>V.removeEventListener("scroll",ce)},[ae,H,o,z]);const[Qt,Lr]=c.useState({open:!1,loading:!1,error:null,rows:[]}),Rr=wn("unit-amounts-by-emp",Qt.open,di,{persist:!1,resetOnOpen:!0});function ds(){Lr({open:!0,loading:!0,error:null,rows:[]});const V=(localStorage.getItem("tnt.sales.empName")||"").trim();if(!V){Lr({open:!0,loading:!1,error:"로그인이 필요합니다",rows:[]});return}const ce=new URL("/api/v1/dashboard/unit-amounts-by-emp",window.location.origin);ce.searchParams.set("empName",V),fetch(ce.toString()).then(async je=>{if(!je.ok){let Pe=`HTTP ${je.status}`;try{const Oe=await je.json();Oe!=null&&Oe.error&&(Pe=Oe.error)}catch{const Oe=await je.text();Oe&&(Pe=Oe)}throw new Error(Pe)}const Te=await je.json(),ze=(Array.isArray(Te)?Te:[]).map(Pe=>({unit:String((Pe==null?void 0:Pe.sales_mgmt_unit)??(Pe==null?void 0:Pe.salesMgmtUnit)??""),amount:Number((Pe==null?void 0:Pe.amount)??0)}));Lr({open:!0,loading:!1,error:null,rows:ze})}).catch(je=>Lr({open:!0,loading:!1,error:(je==null?void 0:je.message)||"조회 오류",rows:[]}))}function us(){Lr(V=>({...V,open:!1}))}return c.useEffect(()=>{if(!Qt.open)return;const V=ce=>{ce.key==="Escape"&&us()};return window.addEventListener("keydown",V,!0),()=>window.removeEventListener("keydown",V,!0)},[Qt.open]),c.useEffect(()=>{if(!At.open)return;const V=ce=>{ce.key==="Escape"&&tr()};return window.addEventListener("keydown",V,!0),()=>window.removeEventListener("keydown",V,!0)},[At.open]),c.useEffect(()=>{if(!bn.open)return;const V=ce=>{ce.key==="Escape"&&Mn()};return window.addEventListener("keydown",V,!0),()=>window.removeEventListener("keydown",V,!0)},[bn.open]),c.useEffect(()=>{if(!rr.open)return;const V=ce=>{ce.key==="Escape"&&xe()};return window.addEventListener("keydown",V,!0),()=>window.removeEventListener("keydown",V,!0)},[rr.open]),c.useEffect(()=>{if(!ue.open)return;const V=ce=>{ce.key==="Escape"&&qe()};return window.addEventListener("keydown",V,!0),()=>window.removeEventListener("keydown",V,!0)},[ue.open]),n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsxs("h2",{style:{margin:0,fontSize:18,display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:["목표 Simulation",n.jsxs("select",{className:"search-input",value:oe,onChange:V=>F(V.target.value),"aria-label":"목표년도",children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),D().map(V=>n.jsxs("option",{value:String(V),children:[V,"년"]},V))]}),n.jsxs("span",{className:"badge",title:"내 목표 배정(TNT)",children:["TNT(배정): ",He.format(ye.tnt)," 억"]}),n.jsxs("span",{className:"badge",title:"내 목표 배정(DYS)",children:["DYS(배정): ",He.format(ye.dys)," 억"]}),n.jsx("span",{"aria-hidden":"true",style:{opacity:.4},children:"|"}),n.jsxs("span",{className:"badge",title:"내 목표 계획(TNT)",children:["TNT(계획): ",He.format(J.tnt)," 억"]}),n.jsxs("span",{className:"badge",title:"내 목표 계획(DYS)",children:["DYS(계획): ",He.format(J.dys)," 억"]}),n.jsx("span",{"aria-hidden":"true",style:{opacity:.4},children:"|"}),n.jsxs("span",{className:"badge",title:"내 목표 차액(TNT)",children:["TNT(차액): ",He.format(Ee.tnt)," 억"]}),n.jsxs("span",{className:"badge",title:"내 목표 차액(DYS)",children:["DYS(차액): ",He.format(Ee.dys)," 억"]})]}),n.jsxs("div",{className:"muted count-text",style:{display:"flex",alignItems:"center",gap:12},children:[n.jsx("button",{className:"btn-plain",title:"내 평균거래 단가",onClick:ds,"aria-label":"평균거래 단가 팝업 열기",children:n.jsx("img",{src:ag,className:"icon",alt:"단가"})}),T.toLocaleString(),"개 거래처"]})]}),d&&n.jsx("div",{className:"error",children:d||lt.errorGeneric}),n.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[n.jsxs("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:[n.jsx("div",{className:"card",style:{padding:8,marginBottom:8},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{className:"search-input",placeholder:"거래처명",value:m,onChange:V=>p(V.target.value),onKeyDown:V=>{V.key==="Enter"&&st(!0)},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:()=>st(!0),disabled:o,style:{flex:"0 0 auto"},children:"조회"})]})}),mr]}),n.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[n.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:U.map((V,ce)=>{const je=ce<K,Te=ce===K;return n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:ce===U.length-1?"0 0 auto":"1 1 0"},children:[n.jsx("div",{title:V.label,onClick:()=>$(V.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:je||Te?"var(--accent)":"transparent",border:`2px solid ${je||Te?"var(--accent)":"var(--border)"}`,color:je||Te?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":Te?"step":void 0,children:je?"✓":ce+1}),n.jsx("div",{style:{fontSize:12,color:Te||je?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:V.label}),ce<U.length-1&&n.jsx("div",{style:{height:2,background:ce<K?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},V.key)})}),n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[n.jsx("button",{className:"btn btn-icon",onClick:Y,disabled:K===0,"aria-label":"이전 단계",title:"이전 단계",children:n.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:n.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),n.jsx("button",{className:"btn btn-icon",onClick:M,disabled:K===U.length-1,"aria-label":"다음 단계",title:"다음 단계",children:n.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:n.jsx("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),_==="init"&&n.jsxs("section",{style:{marginTop:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:10},children:[n.jsx("b",{children:"기준매출"}),n.jsxs("select",{value:rn,onChange:V=>vn(V.target.value),style:{height:28,padding:"4px 8px",borderRadius:8,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12},"aria-label":"기준 기간 선택",children:[n.jsx("option",{value:"prev1",children:"전년"}),n.jsx("option",{value:"last2",children:"최근2년"}),n.jsx("option",{value:"last3",children:"최근3년"})]})]}),n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[Qe&&n.jsx("span",{className:"error",children:Qe}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:re,children:"일괄비율"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:Ze,children:"일괄입력"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:Fe,children:"신규품목"})]})]}),Oa]})]})]}),At.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:hr.ref,className:"card",style:{...hr.style,width:720,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[n.jsx("div",{...hr.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:tr,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 120px 1fr",gap:8,alignItems:"center"},children:[n.jsx("div",{className:"muted",children:"중분류"}),n.jsx("div",{children:At.sub||""}),n.jsx("div",{className:"muted",children:"영업관리단위"}),n.jsx("div",{children:At.unit||""}),n.jsx("div",{className:"muted",children:"매출월"}),n.jsx("div",{children:n.jsxs("select",{className:"search-input",value:At.month||"",onChange:V=>nr(V.target.value,At.qty),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(V,ce)=>ce+1).map(V=>n.jsxs("option",{value:String(V),children:[V,"월"]},V))]})}),n.jsx("div",{className:"muted",children:"매출 수량"}),n.jsx("div",{children:n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:At.qty||"",onChange:V=>nr(At.month,V.target.value)})})]}),n.jsx("div",{style:{marginTop:12},children:n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsx("tr",{children:Array.from({length:12},(V,ce)=>ce+1).map(V=>n.jsxs("th",{style:{textAlign:"right"},children:[String(V).padStart(2,"0"),"월"]},V))})}),n.jsx("tbody",{children:n.jsx("tr",{children:At.dist.map((V,ce)=>n.jsx("td",{children:vt(V)},ce))})})]})})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(단건) — 추후 구현 예정"),children:"목표등록"})})]})}),bn.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:ra.ref,className:"card",style:{...ra.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[n.jsx("div",{...ra.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:Mn,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h2",{style:{margin:0},children:"목표 일괄입력"})}),n.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:120,textAlign:"left"},children:"매출월"}),n.jsx("th",{style:{width:120,textAlign:"left"},children:"매출 수량"}),Array.from({length:12},(V,ce)=>ce+1).map(V=>n.jsxs("th",{style:{textAlign:"right"},children:[String(V).padStart(2,"0"),"월"]},V))]})}),n.jsx("tbody",{children:bn.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:16,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):bn.rows.map((V,ce)=>n.jsxs("tr",{children:[n.jsx("td",{children:V.sub}),n.jsx("td",{children:V.unit}),n.jsx("td",{children:n.jsxs("select",{className:"search-input",value:V.month||"",onChange:je=>na(ce,je.target.value,void 0),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(je,Te)=>Te+1).map(je=>n.jsxs("option",{value:String(je),children:[je,"월"]},je))]})}),n.jsx("td",{children:n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:V.qty||"",onChange:je=>na(ce,void 0,je.target.value)})}),V.dist.map((je,Te)=>n.jsx("td",{children:vt(je)},Te))]},V.key))})]})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(일괄) — 추후 구현 예정"),children:"목표등록"})})]})}),rr.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:Le.ref,className:"card",style:{...Le.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[n.jsx("div",{...Le.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:xe,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{className:"page-title",style:{marginBottom:8,alignItems:"center"},children:[n.jsx("h2",{style:{margin:0},children:"목표 일괄비율"}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsx("span",{className:"muted",children:"적용 비율(%)"}),n.jsx("input",{className:"assign-input",type:"number",min:0,max:100,step:1,placeholder:"0",value:it,onChange:V=>Mt(V.target.value),style:{width:100},"aria-label":"일괄 비율 입력"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("일괄비율 적용 — 추후 개발 예정"),children:"적용"})]})]}),n.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:120,textAlign:"left"},children:"매출월"}),n.jsx("th",{style:{width:120,textAlign:"left"},children:"매출 수량"}),Array.from({length:12},(V,ce)=>ce+1).map(V=>n.jsxs("th",{style:{textAlign:"right"},children:[String(V).padStart(2,"0"),"월"]},V))]})}),n.jsx("tbody",{children:rr.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:16,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):rr.rows.map((V,ce)=>n.jsxs("tr",{children:[n.jsx("td",{children:V.sub}),n.jsx("td",{children:V.unit}),n.jsx("td",{children:n.jsxs("select",{className:"search-input",value:V.month||"",onChange:je=>ve(ce,je.target.value,void 0),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(je,Te)=>Te+1).map(je=>n.jsxs("option",{value:String(je),children:[je,"월"]},je))]})}),n.jsx("td",{children:n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:V.qty||"",onChange:je=>ve(ce,void 0,je.target.value)})}),V.dist.map((je,Te)=>n.jsx("td",{children:vt(je)},Te))]},V.key))})]})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(일괄비율) — 추후 구현 예정"),children:"목표등록"})})]})}),ue.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:Ne.ref,className:"card",style:{...Ne.style,width:820,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[n.jsx("div",{...Ne.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:qe,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h2",{style:{margin:0},children:"신규품목"})}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 120px 1fr",gap:8,alignItems:"center"},children:[n.jsx("div",{className:"muted",children:"영업관리단위"}),n.jsx("div",{children:n.jsxs("select",{className:"search-input",value:ue.unit||"",onChange:V=>Ge(V.target.value),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),ue.opts.map((V,ce)=>n.jsx("option",{value:V.salesMgmtUnit,children:V.salesMgmtUnit},ce))]})}),n.jsx("div",{className:"muted",children:"중분류"}),n.jsx("div",{children:n.jsx("input",{className:"assign-input",value:ue.sub||"",readOnly:!0,placeholder:"자동"})}),n.jsx("div",{className:"muted",children:"매출월"}),n.jsx("div",{children:n.jsxs("select",{className:"search-input",value:ue.month||"",onChange:V=>Ue(V.target.value,void 0),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(V,ce)=>ce+1).map(V=>n.jsxs("option",{value:String(V),children:[V,"월"]},V))]})}),n.jsx("div",{className:"muted",children:"매출 수량"}),n.jsx("div",{children:n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:ue.qty||"",onChange:V=>Ue(void 0,V.target.value)})})]}),n.jsx("div",{style:{marginTop:12},children:n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsx("tr",{children:Array.from({length:12},(V,ce)=>ce+1).map(V=>n.jsxs("th",{style:{textAlign:"right"},children:[String(V).padStart(2,"0"),"월"]},V))})}),n.jsx("tbody",{children:n.jsx("tr",{children:ue.dist.map((V,ce)=>n.jsx("td",{children:vt(V)},ce))})})]})})}),n.jsxs("div",{style:{marginTop:12},children:[n.jsx("div",{className:"pane-header",style:{margin:0},children:"추가된 항목"}),n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),Array.from({length:12},(V,ce)=>ce+1).map(V=>n.jsxs("th",{style:{textAlign:"right"},children:[String(V).padStart(2,"0"),"월"]},V))]})}),n.jsx("tbody",{children:ue.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:14,className:"muted",style:{padding:"12px 10px"},children:"추가된 항목이 없습니다"})}):ue.rows.map((V,ce)=>n.jsxs("tr",{children:[n.jsx("td",{children:V.sub}),n.jsx("td",{children:V.unit}),V.months.map((je,Te)=>n.jsx("td",{children:vt(je)},Te))]},ce))})]})})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:[n.jsx("button",{className:"btn btn-card btn-3d",onClick:Ct,children:"추가"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(신규품목) — 추후 구현 예정"),children:"목표등록"})]})]})}),Qt.open&&n.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:60},children:n.jsxs("div",{ref:Rr.ref,className:"card",style:{...Rr.style,height:"66vh",width:460,maxWidth:"92vw",background:"var(--panel)",padding:12,borderLeft:"1px solid var(--border)",boxShadow:"-8px 0 24px rgba(0,0,0,0.18)",overflow:"auto"},children:[n.jsx("div",{...Rr.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:us,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h2",{style:{margin:0},children:"내 평균거래 단가"})}),Qt.error?n.jsx("div",{className:"error",style:{maxWidth:420},children:Qt.error}):n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:280,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:180,textAlign:"right"},children:"합계(원)"})]})}),n.jsx("tbody",{children:Qt.loading?n.jsx("tr",{children:n.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"불러오는 중…"})}):Qt.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):Qt.rows.map((V,ce)=>n.jsxs("tr",{children:[n.jsx("td",{children:V.unit||"na"}),n.jsxs("td",{style:{textAlign:"right"},children:[He.format(Math.round(V.amount))," 원"]})]},ce))})]})})]})})]})}function Kj(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function Gj(){const[e,t]=c.useState(""),[r,a]=c.useState(""),[i,s]=c.useState(""),[o,l]=c.useState(!1),[d,h]=c.useState(null),[u,f]=c.useState([]),[m,p]=c.useState(""),[x,v]=c.useState(!1),[g,b]=c.useState({open:!1,x:0,y:0}),[y,N]=c.useState(()=>new Set),[A,E]=c.useState({open:!1,x:0,y:0}),[w,P]=c.useState(void 0),[_,$]=c.useState("init"),[L,j]=c.useState({}),[S,R]=c.useState("TNT"),[O,z]=c.useState({}),Z=100,[ae,se]=c.useState(0),[H,q]=c.useState(!0),[C,T]=c.useState(!1),W=Ae.useRef(null),[I,U]=c.useState(0),[K,Y]=c.useState({show:!1,name:"",tnt:0,dys:0,year:0}),[M,D]=c.useState(!1),[oe,F]=c.useState({tnt:0,dys:0}),G=["init","sim","confirm"],de=[{key:"init",label:"초기설정"},{key:"sim",label:"계획 수립 중"},{key:"confirm",label:"확정"}],be=G.indexOf(_);function ke(){const k=[];for(let B=2030;B>=2026;B--)k.push(B);return k}const[ye,Ce]=c.useState(""),[J,ge]=c.useState(!1),[Ee,we]=c.useState(null),[He,mt]=c.useState({tnt:0,dys:0}),[vt,Ot]=c.useState({tnt:0,dys:0}),[pt,Xt]=c.useState({tnt:0,dys:0}),[Ke,gt]=c.useState({tnt:0,dys:0}),[Qe,_t]=c.useState({open:!1,company:"TNT",group:"customer",loading:!1,error:null,rows:[]}),[rn,vn]=c.useState({x:0,y:0}),Xe=new Intl.NumberFormat("ko-KR"),An=new Intl.NumberFormat("ko-KR",{minimumFractionDigits:2,maximumFractionDigits:2}),[ta,xn]=c.useState(null),[hn,an]=c.useState({val:"",loading:!1,saving:!1,error:null,success:null});async function Yn(){try{const k=Number(ye),B=Number((w==null?void 0:w.customerSeq)||0),Q=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!Q||!Number.isFinite(k)||k<=0||!B){an(ie=>({...ie,val:"",loading:!1,error:null}));return}an(ie=>({...ie,loading:!0,error:null}));const te=new URL("/api/v1/sales/plan/plan-remark",window.location.origin);te.searchParams.set("year",String(k)),te.searchParams.set("customerSeq",String(B));const ee=await fetch(te.toString(),{headers:{"X-ASSIGNEE-ID":Q}});if(!ee.ok)throw new Error(`HTTP ${ee.status}`);const X=await ee.json().catch(()=>({})),le=String((X==null?void 0:X.remark)??"");an({val:le,loading:!1,saving:!1,error:null,success:null})}catch(k){an(B=>({...B,loading:!1,error:(k==null?void 0:k.message)||"조회 오류"}))}}async function Ta(){try{const k=Number(ye),B=Number((w==null?void 0:w.customerSeq)||0),Q=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!Q){alert("로그인이 필요합니다.");return}if(!Number.isFinite(k)||k<=0){alert("연도를 선택하세요.");return}if(!B){alert("거래처를 선택하세요.");return}an(le=>({...le,saving:!0,error:null,success:null}));const te={"Content-Type":"application/json","X-ASSIGNEE-ID":Q},ee=JSON.stringify({year:k,customerSeq:B,remark:hn.val}),X=await fetch("/api/v1/sales/plan/plan-remark",{method:"POST",headers:te,body:ee});if(!X.ok){let le=await X.text().catch(()=>"");throw new Error(le||"HTTP "+X.status)}an(le=>({...le,saving:!1,success:"저장되었습니다."})),setTimeout(()=>an(le=>({...le,success:null})),1200)}catch(k){an(B=>({...B,saving:!1,error:(k==null?void 0:k.message)||"저장 오류"}))}}c.useEffect(()=>{w!=null&&w.customerSeq&&ye&&Yn()},[w==null?void 0:w.customerSeq,ye]);async function Oa(){try{const k=Number(ye),B=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),Q=Number((w==null?void 0:w.customerSeq)||0);if(!B){alert("로그인이 필요합니다.");return}if(!Number.isFinite(k)||k<=0){alert("연도를 선택하세요.");return}if(!Q){alert("거래처를 선택하세요.");return}const te={year:k,companyType:S,assigneeId:B,customerSeq:Q},ee={"Content-Type":"application/json","X-ASSIGNEE-ID":B},X=(localStorage.getItem("tnt.sales.empId")||"").trim();X&&(ee["X-EMP-ID"]=X);const le=await fetch("/api/v1/sales/plan/confirm-customer",{method:"POST",headers:ee,body:JSON.stringify(te)});if(!le.ok){let ie=await le.text().catch(()=>"");throw new Error(ie||"HTTP "+le.status)}await le.json().catch(()=>({})),$("confirm"),aa(ie=>ie+1);try{const ie=String((w==null?void 0:w.customerName)||""),ne=String(ye||"");xn(ie&&ne?`${ie} ${ne}년 목표 수립이 완료되었습니다.`:"목표 수립이 완료되었습니다.")}catch{xn("목표 수립이 완료되었습니다.")}}catch(k){alert((k==null?void 0:k.message)||"확정 처리 중 오류가 발생했습니다")}}const[At,er]=c.useState(!1),[ci,tr]=c.useState(""),[nr,bn]=c.useState("TNT");function Kn(k,B){return Number.isFinite(k)?k:0}function Ze(k,B,Q,te,ee){const X=Number.isFinite(k)&&k>0,le=X&&Number.isFinite(Q),ie=le?Number(Q):X?Kn(k):0,ne=X?An.format(Number(k)):"-",fe=X?le?`${An.format(Number(ie))} 원`:"-":"";return n.jsxs("div",{style:{textAlign:"right",lineHeight:1.15,color:te||void 0},children:[n.jsx("div",{style:{fontWeight:ee?700:void 0},children:ne}),n.jsx("div",{className:ee?void 0:"muted",style:{fontSize:11,color:te||void 0,fontWeight:ee?700:void 0},children:fe})]})}async function Mn(k,B){try{const Q=Number(ye),te=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!te||!Number.isFinite(Q)||Q<=0){_t(ne=>({...ne,rows:[],error:null,loading:!1}));return}_t(ne=>({...ne,loading:!0,error:null}));const ee=new URL("/api/v1/sales/plan/totals-breakdown",window.location.origin);ee.searchParams.set("year",String(Q)),ee.searchParams.set("assigneeId",te),ee.searchParams.set("companyType",k),ee.searchParams.set("groupBy",B);const X=await fetch(ee.toString());if(!X.ok){let ne=await X.text().catch(()=>"");throw new Error(ne||"HTTP "+X.status)}const le=await X.json().catch(()=>[]),ie=(Array.isArray(le)?le:[]).map(ne=>({key:String((ne==null?void 0:ne.key)??""),label:ne!=null&&ne.label?String(ne.label):void 0,amount:Number((ne==null?void 0:ne.amount)??0)}));_t(ne=>({...ne,rows:ie,loading:!1,error:null}))}catch(Q){_t(te=>({...te,loading:!1,error:(Q==null?void 0:Q.message)||"조회 오류",rows:[]}))}}function na(k,B){if(B)try{vn({x:B.clientX||0,y:B.clientY||0})}catch{}_t({open:!0,company:k,group:"customer",loading:!1,error:null,rows:[]}),Mn(k,"customer")}function fr(){_t(k=>({...k,open:!1}))}async function di(){ge(!0),we(null);try{const k=(localStorage.getItem("tnt.sales.empName")||"").trim();if(!k){mt({tnt:0,dys:0}),we("로그인이 필요합니다");return}if(!ye||isNaN(Number(ye))){mt({tnt:0,dys:0});return}const B=new URL("/api/v1/targets/assigned",window.location.origin);B.searchParams.set("year",String(ye)),B.searchParams.set("empNames",k);try{const le=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),ie=le==="moderate"?"2":le==="best"?"1":"";ie&&B.searchParams.set("versionNo",ie)}catch{}const Q=await fetch(B.toString());if(!Q.ok)throw new Error(`HTTP ${Q.status}`);const te=await Q.json().catch(()=>[]),ee=Array.isArray(te)?te.find(le=>String(le.company_name||"").toUpperCase()==="TNT"):null,X=Array.isArray(te)?te.find(le=>String(le.company_name||"").toUpperCase()==="DYS"):null;mt({tnt:Math.round(Number((ee==null?void 0:ee.assigned_amount)||0)),dys:Math.round(Number((X==null?void 0:X.assigned_amount)||0)),tntStage:String((ee==null?void 0:ee.target_stage)||"").trim()||void 0,dysStage:String((X==null?void 0:X.target_stage)||"").trim()||void 0})}catch(k){we((k==null?void 0:k.message)||"조회 오류"),mt({tnt:0,dys:0})}finally{ge(!1)}}const[hr,ra]=c.useState(0);c.useEffect(()=>{const k=()=>ra(B=>B+1);return window.addEventListener("tnt.sales.assign.mode.changed",k),()=>window.removeEventListener("tnt.sales.assign.mode.changed",k)},[]),c.useEffect(()=>{di()},[ye,hr]),c.useEffect(()=>{(async()=>{try{const k=Number(ye),B=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!B||!Number.isFinite(k)||k<=0){Xt({tnt:0,dys:0});return}const Q=new URL("/api/v1/sales/plan/totals-by-assignee",window.location.origin);Q.searchParams.set("year",String(k)),Q.searchParams.set("assigneeId",B);const te=await fetch(Q.toString());if(!te.ok)throw new Error(`HTTP ${te.status}`);const ee=await te.json().catch(()=>[]);let X=0,le=0;Array.isArray(ee)&&ee.forEach(ie=>{const ne=String((ie==null?void 0:ie.company_type)||(ie==null?void 0:ie.companyType)||"").toUpperCase(),fe=Number((ie==null?void 0:ie.amount)||0);ne==="TNT"?X+=fe:ne==="DYS"&&(le+=fe)}),Xt({tnt:Math.round(X),dys:Math.round(le)})}catch{Xt({tnt:0,dys:0})}})()},[ye]),c.useEffect(()=>{async function k(){try{D(!1);const B=Number(ye);if(!Number.isFinite(B)||B<=0){Y(We=>({...We,show:!1})),D(!0);return}const Q=localStorage.getItem("tnt.sales.assigneeId")||"",te=localStorage.getItem("tnt.sales.empId")||"",ee=new URL("/api/v1/sales/plan/status",window.location.origin);ee.searchParams.set("year",String(B)),Q?ee.searchParams.set("assigneeId",Q):te&&ee.searchParams.set("empId",te);const X=await fetch(ee.toString());if(!X.ok){Y(We=>({...We,show:!1})),D(!0);return}const le=await X.json().catch(()=>({})),ie=(localStorage.getItem("tnt.sales.empName")||"").trim()||"사용자",ne=Number((le==null?void 0:le.tnt)||0),fe=Number((le==null?void 0:le.dys)||0),me=!!(le!=null&&le.hasP),he=!!(le!=null&&le.hasC),Ie=!!(le!=null&&le.hasI);let Se="";he&&!me&&!Ie?Se="목표수립완료":Ie&&!me&&!he?Se="초기설정완료":(me||he&&Ie)&&(Se="계획수립 중"),Y({show:!!Se,name:ie,tnt:ne,dys:fe,year:B,label:Se,hasP:me,hasC:he,hasI:Ie}),$(he&&!me&&!Ie?"confirm":me?"sim":"init"),D(!0)}catch{Y(Q=>({...Q,show:!1})),D(!0)}}k()},[ye]);const[rr,aa]=c.useState(0),[it,Mt]=c.useState({loading:!1,error:null,rows:[]});c.useEffect(()=>{const k=Number((w==null?void 0:w.customerSeq)||0),B=Number(ye);if(!k||!Number.isFinite(B)||B<=0){Mt({loading:!1,error:null,rows:[]});return}let Q=!1;return(async()=>{try{Mt(ne=>({...ne,loading:!0,error:null}));const te=localStorage.getItem("tnt.sales.assigneeId")||"",ee=new URL("/api/v1/sales/plan/customer-monthly-rows",window.location.origin);ee.searchParams.set("year",String(B)),ee.searchParams.set("customerSeq",String(k)),S&&ee.searchParams.set("companyType",S),te&&ee.searchParams.set("assigneeId",te);const X=await fetch(ee.toString());if(!X.ok){let ne=`HTTP ${X.status}`;try{const fe=await X.json();fe!=null&&fe.error&&(ne=fe.error)}catch{}throw new Error(ne)}const le=await X.json().catch(()=>[]),ie=(Array.isArray(le)?le:[]).map(ne=>({sub:String((ne==null?void 0:ne.item_subcategory)??(ne==null?void 0:ne.itemSubcategory)??""),unit:String((ne==null?void 0:ne.sales_mgmt_unit)??(ne==null?void 0:ne.salesMgmtUnit)??""),months:Array.from({length:12},(fe,me)=>Number((ne==null?void 0:ne[`qty_${String(me+1).padStart(2,"0")}`])??0)),amounts:Array.from({length:12},(fe,me)=>Number((ne==null?void 0:ne[`amount_${String(me+1).padStart(2,"0")}`])??0)),type:String((ne==null?void 0:ne.plan_type)||(ne==null?void 0:ne.planType)||"").toUpperCase()==="P"?"P":"B",stage:String((ne==null?void 0:ne.target_stage)||(ne==null?void 0:ne.targetStage)||"").toUpperCase()||void 0}));Q||Mt({loading:!1,error:null,rows:ie})}catch(te){Q||Mt({loading:!1,error:(te==null?void 0:te.message)||"오류",rows:[]})}})(),()=>{Q=!0}},[w==null?void 0:w.customerSeq,ye,S,rr]),c.useEffect(()=>{try{if(!Number((w==null?void 0:w.customerSeq)||0))return;const B=Array.isArray(it.rows)?it.rows:[];if(!B.length){$("init");return}const Q=B.some(X=>String((X==null?void 0:X.type)||"").toUpperCase()==="P"),te=B.map(X=>String((X==null?void 0:X.stage)||"").toUpperCase()).filter(Boolean),ee=te.length>0&&te.every(X=>X==="C");$(ee?"confirm":Q?"sim":"init")}catch{}},[w==null?void 0:w.customerSeq,it.rows]);const[re,xe]=c.useState({open:!1,dist:new Array(12).fill(0),curMonths:new Array(12).fill(0),curAmounts:new Array(12).fill(0),success:null}),[ve,Le]=c.useState({}),[ue,De]=c.useState({}),[Ne,Fe]=c.useState({});function qe(k){return String(k||"").trim().toUpperCase()}function Ge(k){try{const B=Ue(),te=(ve[B]||{})[qe(k)];if(Number.isFinite(te)&&Number(te)>0)return Number(te);const ee=st(),le=((ue==null?void 0:ue[ee])||{})[qe(k)];return Number.isFinite(le)&&Number(le)>0?Number(le):void 0}catch{return}}function Ue(){const k=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),B=Number(ye),Q=new Date().getFullYear()-1,te=Number.isFinite(B)&&B>0?B-1:Q;return`${k}|${S||""}|${te}`}async function Ct(){try{const k=Ue();if(!k||ve[k])return;const[B,Q,te]=k.split("|"),ee=Number(te);if(!B||!Q||!Number.isFinite(ee)||ee<=0)return;const X=new URL("/api/v1/dashboard/avg-unit-price-by-emp",window.location.origin);X.searchParams.set("assigneeId",B),X.searchParams.set("companyType",Q),X.searchParams.set("year",String(ee));const le=await fetch(X.toString());if(!le.ok)return;const ie=await le.json().catch(()=>[]),ne={},fe={};Array.isArray(ie)&&ie.forEach(me=>{const he=qe((me==null?void 0:me.sales_mgmt_unit)||(me==null?void 0:me.salesMgmtUnit)),Ie=Number((me==null?void 0:me.avg_unit_price)||(me==null?void 0:me.avgUnitPrice)||0);he&&(ne[he]=Ie),he&&(fe[he]={itemUnit:String((me==null?void 0:me.item_unit)||(me==null?void 0:me.itemUnit)||""),itemStdUnit:String((me==null?void 0:me.item_std_unit)||(me==null?void 0:me.itemStdUnit)||"")})}),Le(me=>({...me,[k]:ne})),Fe(me=>({...me,[k]:fe}))}catch{}}function st(){const k=Number(ye),B=new Date().getFullYear()-1,Q=Number.isFinite(k)&&k>0?k-1:B;return`${S||""}|${Q}`}async function rt(){try{const k=st();if(!k||ue[k])return;const[B,Q]=k.split("|"),te=Number(Q);if(!B||!Number.isFinite(te)||te<=0)return;const ee=new URL("/api/v1/dashboard/avg-unit-price",window.location.origin);ee.searchParams.set("companyType",B),ee.searchParams.set("year",String(te));const X=await fetch(ee.toString());if(!X.ok)return;const le=await X.json().catch(()=>[]),ie={};Array.isArray(le)&&le.forEach(ne=>{const fe=qe((ne==null?void 0:ne.sales_mgmt_unit)||(ne==null?void 0:ne.salesMgmtUnit)),me=Number((ne==null?void 0:ne.avg_unit_price)||(ne==null?void 0:ne.avgUnitPrice)||0);fe&&(ie[fe]=me)}),De(ne=>({...ne,[k]:ie}))}catch{}}async function mr(k){try{await rt()}catch{}}async function Qt(k){try{const B=Ue();if(!B)return;const[Q,te,ee]=B.split("|"),X=Number(ee);if(!Q||!te||!Number.isFinite(X)||X<=0)return;const le=new URL("/api/v1/dashboard/avg-unit-price-by-emp",window.location.origin);le.searchParams.set("assigneeId",Q),le.searchParams.set("companyType",te),le.searchParams.set("year",String(X));const ie=await fetch(le.toString());if(!ie.ok)return;const ne=await ie.json().catch(()=>[]);let fe=null;if(Array.isArray(ne)){const me=qe(k);fe=ne.find(he=>qe((he==null?void 0:he.sales_mgmt_unit)||(he==null?void 0:he.salesMgmtUnit))===me)}if(fe){const me=qe((fe==null?void 0:fe.sales_mgmt_unit)||(fe==null?void 0:fe.salesMgmtUnit)),he=Number((fe==null?void 0:fe.avg_unit_price)||(fe==null?void 0:fe.avgUnitPrice)||0),Ie={itemUnit:String((fe==null?void 0:fe.item_unit)||(fe==null?void 0:fe.itemUnit)||""),itemStdUnit:String((fe==null?void 0:fe.item_std_unit)||(fe==null?void 0:fe.itemStdUnit)||"")};Le(Se=>({...Se,[B]:{...Se[B]||{},[me]:he}})),Fe(Se=>({...Se,[B]:{...Se[B]||{},[me]:Ie}}))}}catch{}}function Lr(k,B){const Q=(it.rows||[]).find(X=>X.sub===k&&X.unit===B),te=Q!=null&&Q.months?Q.months.slice():new Array(12).fill(0),ee=Q!=null&&Q.amounts?Q.amounts.slice():new Array(12).fill(0);xe({open:!0,sub:k,unit:B,stage:Q==null?void 0:Q.stage,month:"",qty:"",dist:new Array(12).fill(0),curMonths:te,curAmounts:ee,success:null});try{Ct()}catch{}try{rt()}catch{}}function Rr(){xe({open:!1,dist:new Array(12).fill(0),curMonths:new Array(12).fill(0),curAmounts:new Array(12).fill(0),success:null})}function ds(k,B){const Q=Number(k),te=Number(B),ee=new Array(12).fill(0);if(Number.isFinite(Q)&&Q>=1&&Q<=12&&Number.isFinite(te)&&te>0){const X=12-Q+1,le=te/X;for(let ie=Q-1;ie<12;ie++)ee[ie]=le}xe(X=>({...X,month:k,qty:B,dist:ee}))}async function us(){try{const k=Number(ye),B=S,Q=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),te=Number((w==null?void 0:w.customerSeq)||0),ee=(re.sub||"").trim(),X=(re.unit||"").trim();if(!Number.isFinite(k)||k<=0){alert("연도를 선택하세요.");return}if(!Q){alert("로그인이 필요합니다.");return}if(!te||!ee||!X){alert("거래처/중분류/영업관리단위가 필요합니다.");return}const le=(re.dist||[]).map(he=>{const Ie=Number(he);return!Number.isFinite(Ie)||Ie<=0?0:Math.round(Ie*100)/100});if(!le.some(he=>he>0)&&!(re.month&&Number(re.month)>0)){alert("매출월을 선택하세요.");return}const ie={year:k,companyType:B,assigneeId:Q,customerSeq:te,itemSubcategory:ee,salesMgmtUnit:X,qty:le},ne={"Content-Type":"application/json","X-ASSIGNEE-ID":Q},fe=(localStorage.getItem("tnt.sales.empId")||"").trim();fe&&(ne["X-EMP-ID"]=fe);const me=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:ne,body:JSON.stringify(ie)});if(!me.ok){let he=await me.text().catch(()=>"");throw new Error(he||"HTTP "+me.status)}xe(he=>({...he,success:"목표가 변경되었습니다"}))}catch(k){alert((k==null?void 0:k.message)||"저장 중 오류가 발생했습니다")}}async function V(){try{const k=Number(ye),B=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),Q=Number((w==null?void 0:w.customerSeq)||0);if(Number.isFinite(k)&&k>0&&B&&Q){const te=new URL("/api/v1/sales/plan/customer-monthly-rows",window.location.origin);te.searchParams.set("year",String(k)),te.searchParams.set("customerSeq",String(Q)),S&&te.searchParams.set("companyType",S),te.searchParams.set("assigneeId",B);const ee=await fetch(te.toString());if(ee.ok){const X=await ee.json().catch(()=>[]),le=(Array.isArray(X)?X:[]).map(ie=>({sub:String((ie==null?void 0:ie.item_subcategory)??(ie==null?void 0:ie.itemSubcategory)??""),unit:String((ie==null?void 0:ie.sales_mgmt_unit)??(ie==null?void 0:ie.salesMgmtUnit)??""),months:Array.from({length:12},(ne,fe)=>Number((ie==null?void 0:ie[`qty_${String(fe+1).padStart(2,"0")}`])??0)),amounts:Array.from({length:12},(ne,fe)=>Number((ie==null?void 0:ie[`amount_${String(fe+1).padStart(2,"0")}`])??0)),type:String((ie==null?void 0:ie.plan_type)||(ie==null?void 0:ie.planType)||"").toUpperCase()==="P"?"P":"B",stage:String((ie==null?void 0:ie.target_stage)||(ie==null?void 0:ie.targetStage)||"").toUpperCase()||void 0}));Mt({loading:!1,error:null,rows:le})}}}catch{}Rr();try{ze()}catch{}try{zr()}catch{}try{hs()}catch{}}const[ce,je]=c.useState({open:!1,rows:[],success:null});function Te(){const k=(it.rows||[]).map((B,Q)=>({key:`${B.sub}||${B.unit}||${Q}`,sub:B.sub,unit:B.unit,stage:B.stage,type:B.type,month:"",qty:"",dist:new Array(12).fill(0),curMonths:B.months?B.months.slice():new Array(12).fill(0),curAmounts:B.amounts?B.amounts.slice():new Array(12).fill(0)}));je({open:!0,rows:k,success:null});try{Ct()}catch{}try{rt()}catch{}}function ze(){je({open:!1,rows:[],success:null})}function Pe(k,B,Q){je(te=>{const ee=te.rows.slice(),X={...ee[k]},le=Number(B??X.month),ie=Number(Q??X.qty),ne=new Array(12).fill(0);if(Number.isFinite(le)&&le>=1&&le<=12&&Number.isFinite(ie)&&ie>0){const fe=12-le+1,me=ie/fe;for(let he=le-1;he<12;he++)ne[he]=me}return X.month=B??X.month,X.qty=Q??X.qty,X.dist=ne,ee[k]=X,{...te,rows:ee}})}async function Oe(){try{const k=Number(ye),B=S,Q=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),te=Number((w==null?void 0:w.customerSeq)||0);if(!Number.isFinite(k)||k<=0){alert("연도를 선택하세요.");return}if(!Q){alert("로그인이 필요합니다.");return}if(!te){alert("거래처를 선택하세요.");return}const ee={"Content-Type":"application/json","X-ASSIGNEE-ID":Q},X=(localStorage.getItem("tnt.sales.empId")||"").trim();X&&(ee["X-EMP-ID"]=X);const le=(ce.rows||[]).filter(ie=>!!ie.month&&Number(ie.month)>0);if(le.length===0){alert("매출월을 선택한 행이 없습니다.");return}for(const ie of le){const ne=Number(ie.month),fe=Number(ie.qty||0),me=new Array(12).fill(0);if(Number.isFinite(ne)&&ne>=1&&ne<=12){const We=12-ne+1,Re=Number.isFinite(fe)&&fe>0?fe/We:0;for(let Ye=ne-1;Ye<12;Ye++)me[Ye]=Re}const he=me.map(We=>{const Re=Number(We);return!Number.isFinite(Re)||Re<=0?0:Math.round(Re*100)/100}),Ie={year:k,companyType:B,assigneeId:Q,customerSeq:te,itemSubcategory:ie.sub,salesMgmtUnit:ie.unit,qty:he},Se=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:ee,body:JSON.stringify(Ie)});if(!Se.ok){let We=await Se.text().catch(()=>"");throw new Error(We||"HTTP "+Se.status)}}je(ie=>({...ie,success:"목표가 변경되었습니다"}))}catch(k){alert((k==null?void 0:k.message)||"저장 중 오류가 발생했습니다")}}function Be(k){try{const B=k.getBoundingClientRect(),Q=(B==null?void 0:B.width)||k.offsetWidth||600,te=(B==null?void 0:B.height)||k.offsetHeight||400,ee=Math.max(0,Math.round((window.innerWidth-Q)/2)),le=Math.max(0,Math.round(window.innerHeight-te-40));return{x:ee,y:le}}catch{const B=Math.max(0,Math.round((window.innerWidth-600)/2)),te=Math.max(0,Math.round(window.innerHeight-400-40));return{x:B,y:te}}}function ct(k){try{const B=k.getBoundingClientRect(),Q=(B==null?void 0:B.width)||k.offsetWidth||600,te=(B==null?void 0:B.height)||k.offsetHeight||400,ee=Math.max(0,Math.round((window.innerWidth-Q)/2)),X=Math.max(0,Math.round((window.innerHeight-te)/2));return{x:ee,y:X}}catch{const te=Math.max(0,Math.round((window.innerWidth-600)/2)),ee=Math.max(0,Math.round((window.innerHeight-400)/2));return{x:te,y:ee}}}function qt(k){try{const B=k.getBoundingClientRect(),Q=(B==null?void 0:B.width)||k.offsetWidth||460,te=Math.max(0,Math.round(window.innerWidth-Q)),ee=Math.max(0,Math.round(window.innerHeight*.17));return{x:te,y:ee}}catch{const Q=Math.max(0,Math.round(window.innerWidth-460)),te=Math.max(0,Math.round(window.innerHeight*.17));return{x:Q,y:te}}}const on=wn("sales-plan-target-input",!!re.open,Be,{persist:!1,resetOnOpen:!0}),Ve=wn("sales-plan-bulk-input",!!ce.open,ct,{persist:!1,resetOnOpen:!0}),[xt,ia]=c.useState({open:!1,rows:[],success:null}),[ui,fs]=c.useState("");function mn(){const k=(it.rows||[]).map((B,Q)=>({key:`${B.sub}||${B.unit}||${Q}`,sub:B.sub,unit:B.unit,stage:B.stage,type:B.type,month:"",qty:"",dist:new Array(12).fill(0),curMonths:B.months?B.months.slice():new Array(12).fill(0),curAmounts:B.amounts?B.amounts.slice():new Array(12).fill(0)}));ia({open:!0,rows:k,success:null});try{Ct()}catch{}try{rt()}catch{}}function zr(){ia({open:!1,rows:[],success:null})}function ar(){const k=Number(ui);if(!Number.isFinite(k)){alert("적용 비율(%)을 입력하세요.");return}let B=1+k/100;(!Number.isFinite(B)||B<0)&&(B=0),ia(Q=>{const te=(Q.rows||[]).map(ee=>{const X=ee.curMonths||[],le=Array.from({length:12},(ie,ne)=>{const fe=Number(X[ne]||0);return Number.isFinite(fe)?fe*B:0});return{...ee,dist:le}});return{...Q,rows:te}})}const fi=wn("sales-plan-bulk-ratio",!!xt.open,ct,{persist:!1,resetOnOpen:!0});async function Wl(){try{const k=Number(ye),B=S,Q=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),te=Number((w==null?void 0:w.customerSeq)||0);if(!Number.isFinite(k)||k<=0){alert("연도를 선택하세요.");return}if(!Q){alert("로그인이 필요합니다.");return}if(!te){alert("거래처를 선택하세요.");return}const ee={"Content-Type":"application/json","X-ASSIGNEE-ID":Q},X=(localStorage.getItem("tnt.sales.empId")||"").trim();X&&(ee["X-EMP-ID"]=X);const le=(xt.rows||[]).filter(ie=>(ie.dist||[]).some(ne=>Number(ne)>0));if(le.length===0){alert("적용 비율을 먼저 적용하세요.");return}for(const ie of le){const ne=(ie.dist||[]).map(he=>{const Ie=Number(he);return!Number.isFinite(Ie)||Ie<=0?0:Math.round(Ie*100)/100}),fe={year:k,companyType:B,assigneeId:Q,customerSeq:te,itemSubcategory:ie.sub,salesMgmtUnit:ie.unit,qty:ne},me=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:ee,body:JSON.stringify(fe)});if(!me.ok){let he=await me.text().catch(()=>"");throw new Error(he||"HTTP "+me.status)}}ia(ie=>({...ie,success:"목표가 변경되었습니다"}))}catch(k){alert((k==null?void 0:k.message)||"저장 중 오류가 발생했습니다")}}const[Je,Cn]=c.useState({open:!1,loading:!1,error:null,success:null,opts:[],dist:new Array(12).fill(0),rows:[]}),hi=wn("sales-plan-new-item",!!Je.open,ct,{persist:!1,resetOnOpen:!0});function Mb(k){try{const B=k.getBoundingClientRect(),Q=(B==null?void 0:B.width)||k.offsetWidth||480,te=(B==null?void 0:B.height)||k.offsetHeight||300,ee=12;let X=Math.round(rn.x-Math.min(Q/2,240)),le=Math.round(rn.y+ee);return X=Math.max(8,Math.min(X,window.innerWidth-Q-8)),le=Math.max(8,Math.min(le,window.innerHeight-te-8)),{x:X,y:le}}catch{const B=Math.max(8,Math.min(rn.x,window.innerWidth-500)),Q=Math.max(8,Math.min(rn.y,window.innerHeight-320));return{x:B,y:Q}}}const Bl=wn("plan-totals-breakdown",Qe.open,Mb,{persist:!1,resetOnOpen:!0});async function _f(){Cn(k=>({...k,open:!0,loading:!0,error:null,unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0),rows:[]}));try{const k=await fetch("/api/v1/items/dim"),B=k.ok?await k.json():[],Q=Array.isArray(B)?B.map(X=>({itemSubcategory:String(X.itemSubcategory||X.item_subcategory||""),salesMgmtUnit:String(X.salesMgmtUnit||X.sales_mgmt_unit||"")})):[],te={};Q.forEach(X=>{const le=X.salesMgmtUnit.trim();le&&!te[le]&&(te[le]=X)});const ee=Object.values(te).sort((X,le)=>X.salesMgmtUnit.localeCompare(le.salesMgmtUnit));Cn(X=>({...X,loading:!1,opts:ee}));try{Ct()}catch{}}catch(k){Cn(B=>({...B,loading:!1,error:(k==null?void 0:k.message)||"조회 오류",opts:[]}))}}c.useEffect(()=>{if(Je.open){try{Ct()}catch{}try{rt()}catch{}}},[Je.open,ye,S]);function hs(){Cn({open:!1,loading:!1,error:null,success:null,opts:[],dist:new Array(12).fill(0),rows:[]})}function $b(k){const B=Je.opts.find(Q=>Q.salesMgmtUnit===k);Cn(Q=>({...Q,unit:k,sub:(B==null?void 0:B.itemSubcategory)||Q.sub}));try{Ct()}catch{}try{Qt(k)}catch{}try{mr(k)}catch{}}function Df(k,B){const Q=Number(k??Je.month),te=Number(B??Je.qty),ee=new Array(12).fill(0);if(Number.isFinite(Q)&&Q>=1&&Q<=12&&Number.isFinite(te)&&te>0){const X=12-Q+1,le=te/X;for(let ie=Q-1;ie<12;ie++)ee[ie]=le}Cn(X=>({...X,month:k??X.month,qty:B??X.qty,dist:ee}))}function Lb(){const k=(Je.unit||"").trim(),B=(Je.sub||"").trim(),Q=Je.month,te=Je.qty;if(!k||!Q||!te){alert("영업관리단위, 매출월, 매출 수량을 입력하세요.");return}const ee={sub:B||"(신규)",unit:k,months:Je.dist.slice()};Cn(X=>{const le=X.rows.slice(),ie=le.findIndex(ne=>(ne.unit||"").trim()===k&&(ne.sub||"").trim()===(ee.sub||"").trim());return ie>=0?le[ie]={...le[ie],sub:ee.sub,unit:ee.unit,months:ee.months.slice()}:le.push(ee),{...X,rows:le,unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0)}})}async function Rb(){try{const k=Number(ye),B=S,Q=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),te=Number((w==null?void 0:w.customerSeq)||0);if(!Number.isFinite(k)||k<=0){alert("연도를 선택하세요.");return}if(!Q){alert("로그인이 필요합니다.");return}if(!te){alert("거래처를 선택하세요.");return}const ee=Je.rows||[];if(!ee.length){alert("추가된 영업관리단위가 없습니다.");return}const X=new Set((it.rows||[]).map(fe=>`${String(fe.sub||"").trim()}||${String(fe.unit||"").trim()}`).filter(fe=>!!fe&&fe!=="||")),le=ee.map(fe=>({sub:String(fe.sub||"").trim(),unit:String(fe.unit||"").trim()})).filter(fe=>fe.sub&&fe.unit&&X.has(`${fe.sub}||${fe.unit}`)).map(fe=>fe.unit);if(le.length>0){Cn(fe=>({...fe,error:`${le.join(", ")} 이미 목표에 등록되어 있습니다. 목표 수정을 통해 작업 하세요.`}));return}const ie={"Content-Type":"application/json","X-ASSIGNEE-ID":Q},ne=(localStorage.getItem("tnt.sales.empId")||"").trim();ne&&(ie["X-EMP-ID"]=ne);for(const fe of ee){const me=(fe.months||[]).map(Et=>{const at=Number(Et);return!Number.isFinite(at)||at<=0?0:Math.round(at*100)/100}),he=String(fe.unit||"").trim(),Ie=Ge(he),Se=Number.isFinite(Ie)?Math.round(Number(Ie)):0,We=me.map(Et=>Number.isFinite(Et)&&Se>0?Math.round(Number(Et)*Se):0),Re={year:k,companyType:B,assigneeId:Q,customerSeq:te,itemSubcategory:fe.sub,salesMgmtUnit:fe.unit,qty:me,amount:We},Ye=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:ie,body:JSON.stringify(Re)});if(!Ye.ok){let Et=await Ye.text().catch(()=>"");throw new Error(Et||"HTTP "+Ye.status)}}Cn(fe=>({...fe,success:"목표가 변경되었습니다"}))}catch(k){alert((k==null?void 0:k.message)||"저장 중 오류가 발생했습니다")}}c.useEffect(()=>{if(!re.open&&!ce.open&&!Je.open)return;const k=B=>{B.key==="Escape"&&(re.open&&Rr(),ce.open&&ze(),Je.open&&hs())};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[re.open,ce.open,Je.open]);async function sa(k=!0){h(null),k?(l(!0),se(0),q(!0)):T(!0);try{const B=Number(ye);if(!Number.isFinite(B)||B<=0){k&&(f([]),q(!0),se(0),j({}),z({}));return}const Q=localStorage.getItem("tnt.sales.assigneeId");if(!Q){f([]),h(lt.loginRequired);return}const te=new URL("/api/v1/customers",window.location.origin);te.searchParams.set("mineOnly","true"),te.searchParams.set("assigneeId",Q),te.searchParams.set("companyType",S),ye&&te.searchParams.set("year",String(ye)),m.trim()&&te.searchParams.set("name",m.trim()),te.searchParams.set("limit",String(Z)),te.searchParams.set("offset",String(k?0:ae));const ee=await fetch(te.toString());if(!ee.ok){let ie=`HTTP ${ee.status}`;try{const ne=await ee.json();ne!=null&&ne.error&&(ie=ne.error)}catch{const ne=await ee.text();ne&&(ie=ne)}throw new Error(ie)}const X=await ee.json(),le=Array.isArray(X)?X:[];f(k?le:ie=>[...ie,...le]),q(le.length>=Z),se(ie=>k?Z:ie+Z);try{if(Q){const ie=new URL("/api/v1/customers/count",window.location.origin);ie.searchParams.set("mineOnly","true"),ie.searchParams.set("assigneeId",Q);const ne=await fetch(ie.toString());if(ne.ok){const fe=await ne.json().catch(()=>({})),me=Number((fe==null?void 0:fe.total)??0);U(Number.isFinite(me)?me:0)}else U(0)}else U(0)}catch{U(0)}try{const ie=le.map(ne=>Number(ne.customerSeq||0)).filter(ne=>Number.isFinite(ne)&&ne>0);if(ie.length>0){const ne=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);ne.searchParams.set("custSeq",Array.from(new Set(ie)).join(",")),ne.searchParams.set("years","2");const fe=await fetch(ne.toString());if(fe.ok){const me=await fe.json(),he={};Array.isArray(me)&&me.forEach(Ie=>{const Se=Number((Ie==null?void 0:Ie.customerSeq)||(Ie==null?void 0:Ie.customerSeqText)||0);Number.isFinite(Se)&&(he[Se]=!!(Ie!=null&&Ie.hasRecent))}),j(Ie=>k?he:{...Ie,...he})}else k&&j({})}else k&&j({})}catch{j({})}try{const ie=Number(ye),ne=Number.isFinite(ie)&&ie>0?ie:new Date().getFullYear(),fe=localStorage.getItem("tnt.sales.assigneeId")||"",me=le.map(he=>Number(he.customerSeq||0)).filter(he=>Number.isFinite(he)&&he>0);if(fe&&me.length>0){const he=new URL("/api/v1/sales/plan/stages",window.location.origin);he.searchParams.set("year",String(ne)),S&&he.searchParams.set("companyType",S),he.searchParams.set("assigneeId",fe),he.searchParams.set("customerSeqs",Array.from(new Set(me)).join(","));const Ie=await fetch(he.toString());if(Ie.ok){const Se=await Ie.json(),We={};Array.isArray(Se)&&Se.forEach(Re=>{const Ye=Number((Re==null?void 0:Re.customer_seq)??(Re==null?void 0:Re.customerSeq)??0),Et=String((Re==null?void 0:Re.target_stage)??(Re==null?void 0:Re.targetStage)??"").trim();Number.isFinite(Ye)&&Et&&(We[Ye]=Et)}),z(Re=>k?We:{...Re,...We})}else k&&z({})}else k&&z({})}catch{k&&z({})}}catch(B){h(B.message||"조회 중 오류가 발생했습니다")}finally{k?l(!1):T(!1)}}c.useEffect(()=>{ye&&sa(!0)},[ye,S]),c.useEffect(()=>{ye||(f([]),q(!0),se(0),j({}),z({}))},[ye]),c.useEffect(()=>{async function k(){try{const B=localStorage.getItem("tnt.sales.assigneeId");if(!B){F({tnt:0,dys:0});return}const Q=Number(ye);if(!Number.isFinite(Q)||Q<=0){F({tnt:0,dys:0});return}const te=new URL("/api/v1/customers/with-invoice-count",window.location.origin);te.searchParams.set("assigneeId",B),te.searchParams.set("year",String(Q));const ee=await fetch(te.toString());if(!ee.ok){F({tnt:0,dys:0});return}const X=await ee.json().catch(()=>({})),le=Number((X==null?void 0:X.tnt)??0),ie=Number((X==null?void 0:X.dys)??0);F({tnt:Number.isFinite(le)?le:0,dys:Number.isFinite(ie)?ie:0})}catch{F({tnt:0,dys:0})}}k()},[ye]);const zb=c.useMemo(()=>{const k=Number(ye);return Number.isFinite(k)&&k>0?`${k-1}년`:"전년도"},[ye]),Wb=c.useMemo(()=>(localStorage.getItem("tnt.sales.empName")||"").trim()||"사용자",[]),Dt="#1e3a8a";c.useEffect(()=>{if(!g.open)return;const k=()=>b({open:!1,x:0,y:0});return window.addEventListener("click",k),()=>window.removeEventListener("click",k)},[g.open]),c.useEffect(()=>{if(!g.open)return;const k=B=>{B.key==="Escape"&&b({open:!1,x:0,y:0})};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[g.open]),c.useEffect(()=>{const k=B=>{((B==null?void 0:B.key)==="Escape"||(B==null?void 0:B.key)==="Esc"||(B==null?void 0:B.keyCode)===27)&&(b({open:!1,x:0,y:0}),E({open:!1,x:0,y:0}))};return document.addEventListener("keydown",k,!0),()=>document.removeEventListener("keydown",k,!0)},[]);async function Bb(k,B){k.preventDefault(),k.stopPropagation(),b({open:!1,x:0,y:0});const Q=k.clientX,te=k.clientY;E({open:!0,x:Q,y:te,row:B,loading:!1,error:null,data:[]})}const Mf=c.useMemo(()=>{var B,Q,te,ee,X,le,ie,ne,fe,me,he,Ie,Se,We,Re;const k=[...u].sort((Ye,Et)=>{const at=Number(Ye.customerSeq||0),$n=Number(Et.customerSeq||0),Ln=!!O[at],Vn=!!O[$n];if(Ln!==Vn)return Ln?-1:1;const pr=(Ye.customerName||"").toString(),Hl=(Et.customerName||"").toString();return pr.localeCompare(Hl,"ko",{sensitivity:"base"})});return n.jsx(n.Fragment,{children:n.jsxs("div",{ref:W,className:"table-container",onClick:()=>b({open:!1,x:0,y:0}),style:{height:"100%",overflow:"auto"},children:[k.length===0?n.jsx("div",{className:"empty-state",children:lt.empty}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsx("tr",{children:n.jsx("th",{style:{width:"auto"},children:"거래처명"})})}),n.jsx("tbody",{children:k.map((Ye,Et)=>n.jsx("tr",{onClick:at=>{at.preventDefault(),at.stopPropagation(),P(Ye),E({open:!1,x:0,y:0})},onContextMenu:at=>Bb(at,Ye),"aria-selected":(w==null?void 0:w.customerId)===Ye.customerId?!0:void 0,style:(w==null?void 0:w.customerId)===Ye.customerId?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:n.jsx("td",{children:(()=>{const at=Number(Ye.customerSeq||0),$n=O[at],Ln={};return $n==="P"&&(Ln.color="#dc2626"),$n==="C"&&(Ln.fontWeight=700),n.jsxs("span",{children:[n.jsx("span",{style:Ln,children:Ye.customerName}),$n?n.jsx("span",{className:"badge stage-badge",style:{marginLeft:6},children:$n}):null]})})()})},Et))})]}),C&&n.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:lt.loading}),!o&&!C&&!H&&u.length>0&&n.jsx("div",{className:"muted",style:{padding:"8px 10px",textAlign:"center"},children:"마지막 데이터입니다."}),A.open&&n.jsxs("div",{className:"context-menu",style:{left:A.x+6,top:A.y+6,maxWidth:420,padding:8},onClick:Ye=>Ye.stopPropagation(),children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 상세"}),A.error?n.jsx("div",{className:"error",style:{maxWidth:380},children:A.error}):n.jsx("table",{className:"table",style:{width:"100%"},children:n.jsxs("tbody",{children:[n.jsxs("tr",{children:[n.jsx("th",{style:{width:110,textAlign:"left"},children:"거래처번호"}),n.jsx("td",{children:((B=A.row)==null?void 0:B.customerId)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"사업자번호"}),n.jsx("td",{children:((Q=A.row)==null?void 0:Q.bizNo)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"대표자명"}),n.jsx("td",{children:((te=A.row)==null?void 0:te.ownerName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"업태"}),n.jsx("td",{children:((ee=A.row)==null?void 0:ee.bizKind)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"종목"}),n.jsx("td",{children:((X=A.row)==null?void 0:X.bizType)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"전화번호"}),n.jsx("td",{children:((le=A.row)==null?void 0:le.telNo)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"담당자명"}),n.jsx("td",{children:((ie=A.row)==null?void 0:ie.empName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"부서명"}),n.jsx("td",{children:((ne=A.row)==null?void 0:ne.deptName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"시/도"}),n.jsx("td",{children:((fe=A.row)==null?void 0:fe.addrProvinceName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"시/군/구"}),n.jsx("td",{children:((me=A.row)==null?void 0:me.addrCityName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"고객유형"}),n.jsx("td",{children:((he=A.row)==null?void 0:he.customerTypeName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"비고"}),n.jsx("td",{children:((Ie=A.row)==null?void 0:Ie.customerRemark)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"생성자"}),n.jsx("td",{children:((Se=A.row)==null?void 0:Se.createdBy)??""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"수정자"}),n.jsx("td",{children:((We=A.row)==null?void 0:We.updatedBy)??""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"생성일시"}),n.jsx("td",{children:Kj((Re=A.row)==null?void 0:Re.createdAt)})]})]})})]})]})})},[u,g,y,A,w,O,o,C,H]);c.useEffect(()=>{const k=W.current;if(!k)return;function B(){k.scrollTop+k.clientHeight>=k.scrollHeight-48&&H&&!C&&!o&&sa(!1)}return k.addEventListener("scroll",B),()=>k.removeEventListener("scroll",B)},[H,C,o,ae]);const[Gn,_a]=c.useState({open:!1,loading:!1,error:null,rows:[]}),[Fl,Fb]=c.useState(10),[Wr,$f]=c.useState(""),[mi,ql]=c.useState("TNT"),Ul=wn("unit-amounts-by-emp",Gn.open,qt,{persist:!1,resetOnOpen:!0}),[Da,ms]=c.useState({total:0,confirmed:0,inprogress:0,loading:!1,error:null}),[pi,ps]=c.useState({tnt:0,dys:0,loading:!1,error:null});c.useEffect(()=>{async function k(){const B=Number(ye),Q=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),te=(localStorage.getItem("tnt.sales.empId")||"").trim();if(!Number.isFinite(B)||B<=0||!Q&&!te){ms({total:0,confirmed:0,inprogress:0,loading:!1,error:null});return}ms(ee=>({...ee,loading:!0,error:null}));try{const ee=new URL("/api/v1/sales/plan/customer-counts-overall",window.location.origin);ee.searchParams.set("year",String(B)),Q?ee.searchParams.set("assigneeId",Q):te&&ee.searchParams.set("empId",te);const X=await fetch(ee.toString());if(!X.ok)throw new Error(`HTTP ${X.status}`);const le=await X.json(),ie=Number((le==null?void 0:le.total_customers)??0)||0,ne=Number((le==null?void 0:le.confirmed_customers)??0)||0,fe=Number((le==null?void 0:le.inprogress_customers)??0)||0;ms({total:ie,confirmed:ne,inprogress:fe,loading:!1,error:null})}catch(ee){ms({total:0,confirmed:0,inprogress:0,loading:!1,error:(ee==null?void 0:ee.message)||"요약 조회 오류"})}}k()},[ye,hr]);async function qb(){try{const k=localStorage.getItem("tnt.sales.assigneeId");if(!k||!Wr){_a(he=>({...he,loading:!1}));return}const B=new URL("/api/v1/dashboard/avg-unit-price-by-emp",window.location.origin);B.searchParams.set("assigneeId",k),B.searchParams.set("companyType",mi),B.searchParams.set("year",String(Wr));const Q=await fetch(B.toString());if(!Q.ok)throw new Error(`HTTP ${Q.status}`);const te=await Q.json(),ee=new URL("/api/v1/dashboard/avg-unit-price",window.location.origin);ee.searchParams.set("companyType",mi),ee.searchParams.set("year",String(Wr));const X=await fetch(ee.toString()),le=X.ok?await X.json():[],ie={},ne={};Array.isArray(te)&&te.forEach(he=>{const Se=String((he==null?void 0:he.sales_mgmt_unit)??(he==null?void 0:he.salesMgmtUnit)??"").trim().toUpperCase();Se&&(ie[Se]={amount:Number((he==null?void 0:he.avg_unit_price)??(he==null?void 0:he.avgUnitPrice)??0),itemUnit:String((he==null?void 0:he.item_unit)??(he==null?void 0:he.itemUnit)??""),itemStdUnit:String((he==null?void 0:he.item_std_unit)??(he==null?void 0:he.itemStdUnit)??"")})}),Array.isArray(le)&&le.forEach(he=>{const Se=String((he==null?void 0:he.sales_mgmt_unit)??(he==null?void 0:he.salesMgmtUnit)??"").trim().toUpperCase();Se&&(ne[Se]={amount:Number((he==null?void 0:he.avg_unit_price)??(he==null?void 0:he.avgUnitPrice)??0),itemUnit:String((he==null?void 0:he.item_unit)??(he==null?void 0:he.itemUnit)??""),itemStdUnit:String((he==null?void 0:he.item_std_unit)??(he==null?void 0:he.itemStdUnit)??"")})});const me=Array.from(new Set([...Object.keys(ie),...Object.keys(ne)])).sort().map(he=>{var Ie,Se,We,Re,Ye,Et;return{unit:he,amountMy:Number(((Ie=ie[he])==null?void 0:Ie.amount)??0),amountGlobal:Number(((Se=ne[he])==null?void 0:Se.amount)??0),itemUnit:((We=ie[he])==null?void 0:We.itemUnit)||((Re=ne[he])==null?void 0:Re.itemUnit)||"",itemStdUnit:((Ye=ie[he])==null?void 0:Ye.itemStdUnit)||((Et=ne[he])==null?void 0:Et.itemStdUnit)||""}});_a({open:!0,loading:!1,error:null,rows:me})}catch(k){_a({open:!0,loading:!1,error:(k==null?void 0:k.message)||"조회 오류",rows:[]})}}function Ub(){_a({open:!0,loading:!0,error:null,rows:[]});const k=Number(ye),B=Number.isFinite(k)&&k>0?k-1:new Date().getFullYear()-1,Q=Math.max(2025,Math.min(2030,B));$f(Q),ql("TNT")}function Hb(k){const B=k.target.value;Ce(B)}function Lf(){_a(k=>({...k,open:!1}))}return c.useEffect(()=>{if(!Gn.open)return;const k=B=>{B.key==="Escape"&&Lf()};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[Gn.open]),c.useEffect(()=>{Gn.open&&Wr&&(_a(k=>({...k,loading:!0})),qb())},[Gn.open,Wr,mi]),c.useEffect(()=>{(async()=>{try{ps(ne=>({...ne,loading:!0,error:null}));const k=Number(ye),B=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),Q=(localStorage.getItem("tnt.sales.empId")||"").trim();if(!Number.isFinite(k)||k<=0||!B&&!Q){ps({tnt:0,dys:0,loading:!1,error:null});return}const te=new URL("/api/v1/sales/plan/totals-confirmed-by-assignee",window.location.origin);te.searchParams.set("year",String(k)),B?te.searchParams.set("assigneeId",B):Q&&te.searchParams.set("empId",Q);const ee=await fetch(te.toString());if(!ee.ok)throw new Error(`HTTP ${ee.status}`);const X=await ee.json().catch(()=>[]);let le=0,ie=0;if(Array.isArray(X))for(const ne of X){const fe=String((ne==null?void 0:ne.company_type)||(ne==null?void 0:ne.companyType)||"").toUpperCase(),me=Number((ne==null?void 0:ne.amount)||0);fe==="TNT"?le+=me:fe==="DYS"&&(ie+=me)}ps({tnt:Math.round(le),dys:Math.round(ie),loading:!1,error:null})}catch(k){ps({tnt:0,dys:0,loading:!1,error:(k==null?void 0:k.message)||"확정 합계 조회 오류"})}})()},[ye]),c.useEffect(()=>{if(!re.open)return;const k=B=>{B.key==="Escape"&&Rr()};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[re.open]),c.useEffect(()=>{if(!ce.open)return;const k=B=>{B.key==="Escape"&&ze()};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[ce.open]),c.useEffect(()=>{if(!xt.open)return;const k=B=>{B.key==="Escape"&&zr()};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[xt.open]),c.useEffect(()=>{if(!Je.open)return;const k=B=>{B.key==="Escape"&&hs()};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[Je.open]),c.useEffect(()=>{if(!Qe.open)return;const k=B=>{B.key==="Escape"&&fr()};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[Qe.open]),n.jsxs("section",{"aria-busy":At||void 0,children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:18},children:"목표 Simulation"}),n.jsxs("div",{className:"muted count-text",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[n.jsx("span",{style:{fontWeight:700},children:"현재목표"}),n.jsxs("span",{onClick:k=>na("TNT",k),style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #3b82f6",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent",cursor:"pointer"},title:"TNT 계획 합계 (클릭하여 상세)",children:[n.jsx("span",{style:{fontSize:12,color:"#3b82f6",fontWeight:700},children:"TNT"}),n.jsx("span",{style:{color:"#3b82f6"},children:Xe.format(pt.tnt)}),n.jsx("span",{style:{fontSize:12,color:"#3b82f6"},children:"원"})]}),n.jsxs("span",{onClick:k=>na("DYS",k),style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #10b981",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent",cursor:"pointer"},title:"DYS 계획 합계 (클릭하여 상세)",children:[n.jsx("span",{style:{fontSize:12,color:"#10b981",fontWeight:700},children:"DYS"}),n.jsx("span",{style:{color:"#10b981"},children:Xe.format(pt.dys)}),n.jsx("span",{style:{fontSize:12,color:"#10b981"},children:"원"})]}),n.jsx("span",{"aria-hidden":!0,style:{width:1,height:20,background:"var(--border)",display:"inline-block"}}),n.jsx("span",{style:{fontWeight:700},children:"목표확정"}),pi.loading?n.jsx("span",{className:"muted",style:{fontSize:12},children:"불러오는 중…"}):pi.error?n.jsx("span",{className:"error",style:{fontSize:12},children:pi.error}):n.jsxs(n.Fragment,{children:[n.jsxs("span",{title:"확정된 고객 합계 (TNT)",style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #3b82f6",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent"},children:[n.jsx("span",{style:{fontSize:12,color:"#3b82f6",fontWeight:700},children:"TNT"}),n.jsx("span",{style:{color:"#3b82f6"},children:Xe.format(pi.tnt)}),n.jsx("span",{style:{fontSize:12,color:"#3b82f6"},children:"원"})]}),n.jsxs("span",{title:"확정된 고객 합계 (DYS)",style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #10b981",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent"},children:[n.jsx("span",{style:{fontSize:12,color:"#10b981",fontWeight:700},children:"DYS"}),n.jsx("span",{style:{color:"#10b981"},children:Xe.format(pi.dys)}),n.jsx("span",{style:{fontSize:12,color:"#10b981"},children:"원"})]})]}),n.jsx("button",{className:"btn-plain",title:"내 평균거래 단가",onClick:Ub,"aria-label":"평균거래 단가 팝업 열기",children:n.jsx("img",{src:ag,className:"icon",alt:"단가"})}),I.toLocaleString(),"개 거래처"]})]}),n.jsxs("div",{className:"card",style:{padding:8,marginTop:8,display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[n.jsx("div",{className:"muted",children:"목표년도"}),n.jsxs("select",{className:"search-input",value:ye,onChange:Hb,"aria-label":"목표년도",style:{height:28},children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),ke().map(k=>n.jsxs("option",{value:String(k),children:[k,"년"]},k))]}),n.jsx("div",{className:"muted",style:{marginLeft:12},children:"가중치"}),n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[n.jsx("input",{className:"search-input",value:String(Fl),onChange:k=>{const B=Number((k.target.value||"").replace(/[^0-9]/g,""));Number.isFinite(B)&&Fb(Math.max(0,Math.min(999,B)))},inputMode:"numeric","aria-label":"가중치(%)",style:{width:72,height:28,textAlign:"right"}}),n.jsx("span",{className:"muted",children:"%"})]})]}),(()=>{const k=!!(K.hasC&&!K.hasP&&!K.hasI),B=!!(K.hasI&&!K.hasP&&!K.hasC),Q=!!(K.hasP||K.hasC&&K.hasI),te=k?"목표수립완료":B?"초기설정완료":Q?"계획수립 중":"초기설정",ee=k||B||Q,X=ee||At?{opacity:.6,cursor:"not-allowed",background:"var(--border)",color:"var(--muted)"}:void 0;return n.jsx("button",{className:"btn btn-card btn-3d",onClick:Yb,disabled:ee||At,style:X,children:te})})(),ye?K.show?n.jsxs("div",{className:"muted",style:{display:"inline-flex",alignItems:"center",gap:6,flexWrap:"wrap",fontSize:12},children:[n.jsxs("span",{style:{fontSize:12},children:[K.name,"님"]}),n.jsxs("span",{style:{color:Dt,fontWeight:700,fontSize:14,whiteSpace:"pre"},children:[K.year,"년"]}),n.jsx("span",{style:{fontSize:12},children:" "}),n.jsxs("span",{style:{color:Dt,fontWeight:700,fontSize:14},children:["TNT ",K.tnt.toLocaleString(),"개"]}),n.jsx("span",{style:{fontSize:12},children:","}),n.jsxs("span",{style:{color:Dt,fontWeight:700,fontSize:14},children:[" DYS ",K.dys.toLocaleString(),"개"]}),n.jsx("span",{style:{fontSize:12},children:K.label||""})]}):M?n.jsxs("div",{className:"muted",style:{display:"inline-flex",alignItems:"center",gap:6,flexWrap:"wrap",fontSize:12},children:[n.jsxs("span",{style:{fontSize:12},children:[Wb,"님,"]}),n.jsx("span",{style:{color:Dt,fontWeight:700,fontSize:14},children:zb}),n.jsx("span",{style:{fontSize:12},children:"매출 기준으로 담당 거래처"}),n.jsx("span",{style:{color:Dt,fontWeight:700,fontSize:14},children:"TNT"}),n.jsx("span",{style:{color:Dt,fontWeight:700,fontSize:14},children:oe.tnt.toLocaleString()}),n.jsx("span",{style:{fontSize:12},children:"개,"}),n.jsx("span",{style:{color:Dt,fontWeight:700,fontSize:14},children:"DYS"}),n.jsx("span",{style:{color:Dt,fontWeight:700,fontSize:14},children:oe.dys.toLocaleString()}),n.jsx("span",{style:{fontSize:12},children:"개에 대해"}),n.jsxs("span",{style:{color:Dt,fontWeight:700,fontSize:14},children:[Fl,"%"]}),n.jsx("span",{style:{fontSize:12},children:"추가하여 목표 설정합니다."})]}):null:null,n.jsx("div",{className:"muted",style:{marginLeft:"auto"},children:Da.loading?"요약 불러오는 중…":Da.error?n.jsx("span",{className:"error",children:Da.error}):n.jsxs(n.Fragment,{children:["수립대상 ",Da.total.toLocaleString(),"개, 확정 ",Da.confirmed.toLocaleString(),"개, 진행 중 ",Da.inprogress.toLocaleString(),"개"]})})]}),Qe.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"transparent",zIndex:60},children:n.jsxs("div",{ref:Bl.ref,className:"card",style:{...Bl.style,width:720,maxWidth:"92vw",background:"var(--panel)",padding:12,fontSize:12},children:[n.jsx("div",{...Bl.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:fr,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{className:"page-title",style:{marginBottom:8,alignItems:"center"},children:[n.jsxs("h2",{style:{margin:0},children:[Qe.company," 계획 합계 상세"]}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[n.jsx("input",{type:"radio",name:"totals-group",checked:Qe.group==="customer",onChange:()=>{_t(k=>({...k,group:"customer"})),Mn(Qe.company,"customer")}}),"거래처별"]}),n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[n.jsx("input",{type:"radio",name:"totals-group",checked:Qe.group==="unit",onChange:()=>{_t(k=>({...k,group:"unit"})),Mn(Qe.company,"unit")}}),"영업관리단위별"]})]})]}),Qe.error?n.jsx("div",{className:"error",children:Qe.error}):null,n.jsx("div",{className:"table-container",style:{maxHeight:"66vh",overflow:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left",width:380},children:Qe.group==="customer"?"거래처":"영업관리단위"}),n.jsx("th",{style:{textAlign:"right",width:200},children:"금액(원)"})]})}),n.jsx("tbody",{children:Qe.loading?n.jsx("tr",{children:n.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"불러오는 중…"})}):Qe.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):Qe.rows.map((k,B)=>{const Q=Qe.group==="customer"&&k.label||k.key;return n.jsxs("tr",{children:[n.jsx("td",{children:Q}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Xe.format(Math.round(k.amount))})]},B)})})]})})]})}),ta?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:80,display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:280,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:ta}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>xn(null),children:"확인"})})]})}):null,n.jsx("div",{className:"c360-tabs",role:"tablist","aria-label":"회사 구분 탭",style:{marginTop:8},children:["TNT","DYS"].map(k=>n.jsx("button",{role:"tab","aria-selected":nr===k,className:`tab ${nr===k?"active":""}`,onClick:()=>{bn(k);try{R(k)}catch{}},children:k},k))}),nr==="TNT"?n.jsxs(n.Fragment,{children:[d&&n.jsx("div",{className:"error",children:d||lt.errorGeneric}),n.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[n.jsxs("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:[n.jsx("div",{className:"card",style:{padding:8,marginBottom:8},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{className:"search-input",placeholder:"거래처명",value:m,onChange:k=>p(k.target.value),onKeyDown:k=>{k.key==="Enter"&&sa(!0)},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:()=>sa(!0),disabled:o,style:{flex:"0 0 auto"},children:"조회"})]})}),ye?Mf:n.jsx("div",{className:"muted",style:{padding:"12px 10px"},children:"연도를 먼저 선택하세요."})]}),n.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[n.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:de.map((k,B)=>{const Q=B<be,te=B===be;return n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:B===de.length-1?"0 0 auto":"1 1 0"},children:[n.jsx("div",{title:k.label,onClick:()=>$(k.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:Q||te?"var(--accent)":"transparent",border:`2px solid ${Q||te?"var(--accent)":"var(--border)"}`,color:Q||te?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":te?"step":void 0,children:Q?"✓":B+1}),n.jsx("div",{style:{fontSize:12,color:te||Q?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:k.label}),B<de.length-1&&n.jsx("div",{style:{height:2,background:B<be?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},k.key)})}),n.jsx("div",{children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:Oa,disabled:!(w!=null&&w.customerSeq)||!ye,title:"해당 거래처 목표 확정",children:"확정"})})]}),w!=null&&w.customerSeq&&ye?n.jsxs("div",{className:"card",style:{marginBottom:12,padding:8},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginBottom:8,gap:8,flexWrap:"wrap"},children:[n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:mn,children:"일괄비율"}),n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:Te,children:"일괄입력"}),n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:_f,children:"신규 영업관리단위"})]}),it.error?n.jsx("div",{className:"error",children:it.error}):n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left",width:220},children:"중분류"}),n.jsx("th",{style:{textAlign:"left",width:220},children:"영업관리단위"}),n.jsx("th",{style:{textAlign:"center",width:120},children:"목표입력"}),n.jsx("th",{className:"sum-head",style:{textAlign:"right",width:140},children:"합계"}),Array.from({length:12},(k,B)=>B+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:it.rows.length===0?n.jsx("tr",{children:n.jsx("td",{className:"muted",colSpan:16,style:{padding:"12px 10px"},children:it.loading?"불러오는 중…":"데이터가 없습니다"})}):it.rows.map((k,B)=>{const Q=(k.months||[]).reduce((ee,X)=>ee+(Number.isFinite(X)?Number(X):0),0),te=(k.amounts||[]).reduce((ee,X)=>ee+(Number.isFinite(X)?Number(X):0),0);return n.jsxs("tr",{children:[n.jsx("td",{children:k.sub}),n.jsxs("td",{children:[n.jsx("span",{children:k.unit}),k.stage?n.jsx("span",{className:"stage-badge",style:{marginLeft:6},title:String(k.stage),children:k.stage}):null]}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx("button",{type:"button",className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:ee=>{ee.preventDefault(),ee.stopPropagation(),Lr(k.sub,k.unit)},children:"입력"})}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(Q,0,te)}),k.months.map((ee,X)=>{var le;return n.jsx("td",{style:{textAlign:"right"},children:Ze(ee,X,(le=k.amounts)==null?void 0:le[X],k.stage==="P"?"#dc2626":void 0,k.stage==="C")},X)})]},B)})}),(()=>{if(!it.rows||it.rows.length===0)return null;const k=Array.from({length:12},(ee,X)=>it.rows.reduce((le,ie)=>{var ne;return le+(Number((ne=ie.months)==null?void 0:ne[X])||0)},0)),B=Array.from({length:12},(ee,X)=>it.rows.reduce((le,ie)=>{var ne;return le+(Number((ne=ie.amounts)==null?void 0:ne[X])||0)},0)),Q=k.reduce((ee,X)=>ee+(Number(X)||0),0),te=B.reduce((ee,X)=>ee+(Number(X)||0),0);return n.jsx("tfoot",{children:n.jsxs("tr",{className:"sum-row",children:[n.jsx("td",{colSpan:3,style:{textAlign:"center",fontWeight:700},children:"합계"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(Q,0,te)}),k.map((ee,X)=>n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(ee,X,B[X])},X))]})})})()]})})]}):null]})]})]}):n.jsxs(n.Fragment,{children:[d&&n.jsx("div",{className:"error",children:d||lt.errorGeneric}),n.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[n.jsxs("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:[n.jsx("div",{className:"card",style:{padding:8,marginBottom:8},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{className:"search-input",placeholder:"거래처명",value:m,onChange:k=>p(k.target.value),onKeyDown:k=>{k.key==="Enter"&&sa(!0)},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:()=>sa(!0),disabled:o,style:{flex:"0 0 auto"},children:"조회"})]})}),ye?Mf:n.jsx("div",{className:"muted",style:{padding:"12px 10px"},children:"연도를 먼저 선택하세요."})]}),n.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[n.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:de.map((k,B)=>{const Q=B<be,te=B===be;return n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:B===de.length-1?"0 0 auto":"1 1 0"},children:[n.jsx("div",{title:k.label,onClick:()=>$(k.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:Q||te?"var(--accent)":"transparent",border:`2px solid ${Q||te?"var(--accent)":"var(--border)"}`,color:Q||te?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":te?"step":void 0,children:Q?"✓":B+1}),n.jsx("div",{style:{fontSize:12,color:te||Q?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:k.label}),B<de.length-1&&n.jsx("div",{style:{height:2,background:B<be?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},k.key)})}),n.jsx("div",{children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:Oa,disabled:!(w!=null&&w.customerSeq)||!ye,title:"해당 거래처 목표 확정",children:"확정"})})]}),w!=null&&w.customerSeq&&ye?n.jsxs("div",{className:"card",style:{marginBottom:12,padding:8},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginBottom:8,gap:8,flexWrap:"wrap"},children:[n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:mn,children:"일괄비율"}),n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:Te,children:"일괄입력"}),n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:_f,children:"신규 영업관리단위"})]}),it.error?n.jsx("div",{className:"error",children:it.error}):n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left",width:220},children:"중분류"}),n.jsx("th",{style:{textAlign:"left",width:220},children:"영업관리단위"}),n.jsx("th",{style:{textAlign:"center",width:120},children:"목표입력"}),n.jsx("th",{className:"sum-head",style:{textAlign:"right",width:140},children:"합계"}),Array.from({length:12},(k,B)=>B+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:it.rows.length===0?n.jsx("tr",{children:n.jsx("td",{className:"muted",colSpan:16,style:{padding:"12px 10px"},children:it.loading?"불러오는 중…":"데이터가 없습니다"})}):it.rows.map((k,B)=>{const Q=(k.months||[]).reduce((ee,X)=>ee+(Number.isFinite(X)?Number(X):0),0),te=(k.amounts||[]).reduce((ee,X)=>ee+(Number.isFinite(X)?Number(X):0),0);return n.jsxs("tr",{children:[n.jsx("td",{children:k.sub}),n.jsxs("td",{children:[n.jsx("span",{children:k.unit}),k.stage?n.jsx("span",{className:"badge stage-badge",style:{marginLeft:6},children:k.stage}):null]}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx("button",{type:"button",className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:ee=>{ee.preventDefault(),ee.stopPropagation(),Lr(k.sub,k.unit)},children:"입력"})}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(Q,0,te)}),k.months.map((ee,X)=>{var le;return n.jsx("td",{style:{textAlign:"right"},children:Ze(ee,X,(le=k.amounts)==null?void 0:le[X],k.stage==="P"?"#dc2626":void 0,k.stage==="C")},X)})]},B)})}),(()=>{if(!it.rows||it.rows.length===0)return null;const k=Array.from({length:12},(ee,X)=>it.rows.reduce((le,ie)=>{var ne;return le+(Number((ne=ie.months)==null?void 0:ne[X])||0)},0)),B=Array.from({length:12},(ee,X)=>it.rows.reduce((le,ie)=>{var ne;return le+(Number((ne=ie.amounts)==null?void 0:ne[X])||0)},0)),Q=k.reduce((ee,X)=>ee+(Number(X)||0),0),te=B.reduce((ee,X)=>ee+(Number(X)||0),0);return n.jsx("tfoot",{children:n.jsxs("tr",{className:"sum-row",children:[n.jsx("td",{colSpan:3,style:{textAlign:"center",fontWeight:700},children:"합계"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(Q,0,te)}),k.map((ee,X)=>n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(ee,X,B[X])},X))]})})})()]})})]}):null,w!=null&&w.customerSeq&&ye?n.jsxs("div",{className:"card",style:{marginBottom:12,padding:8},children:[n.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[n.jsx("div",{className:"muted",style:{fontWeight:700,lineHeight:"28px",fontSize:14},children:"목표수립의견"}),n.jsx("textarea",{className:"search-input",value:hn.val,onChange:k=>an(B=>({...B,val:k.target.value})),placeholder:"목표수립에 대한 의견을 입력하세요",rows:6,style:{flex:1,resize:"vertical",height:80,minHeight:80,fontSize:12}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:8,marginTop:8},children:[hn.loading?n.jsx("span",{className:"muted",style:{fontSize:12},children:"(읽는 중…)"}):null,hn.error?n.jsx("span",{className:"error",style:{fontSize:12},children:hn.error}):null,hn.success?n.jsx("span",{style:{fontSize:12,color:"var(--accent)",fontWeight:700},children:hn.success}):null,n.jsx("button",{className:"btn btn-card btn-3d",onClick:Ta,disabled:hn.saving,children:hn.saving?"저장중…":"저장"})]})]}):null]})]})]}),re.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:on.ref,className:"card compact",style:{...on.style,position:"relative",width:900,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[n.jsx("div",{...on.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:Rr,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1.6fr 120px 1fr",gap:8,alignItems:"center"},children:[n.jsx("div",{className:"muted form-label",children:"영업관리단위"}),n.jsx("div",{children:re.unit||""}),n.jsx("div",{className:"muted form-label",children:"중분류"}),n.jsx("div",{children:re.sub||""}),n.jsx("div",{className:"muted form-label",children:"매출 수량"}),n.jsx("div",{style:{gridColumn:"2 / 5"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"nowrap",minWidth:0},children:[n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:re.qty||"",onChange:k=>ds(re.month,k.target.value)}),(()=>{const k=Ue(),B=(re.unit||"").trim(),Q=qe(B),te=ve[k]||{},ee=Number(te[Q]||0),X=st(),le=(ue==null?void 0:ue[X])||{},ie=Number(le[Q]||0),ne=Number.isFinite(ee)&&ee>0?Xe.format(Math.round(ee)):"-",fe=Number.isFinite(ie)&&ie>0?Xe.format(Math.round(ie)):"-",me=Number.isFinite(ee)&&Number.isFinite(ie)?ee>=ie?Dt:"#dc2626":Dt;return n.jsxs("span",{className:"muted",style:{fontSize:12,whiteSpace:"nowrap"},children:[n.jsxs("span",{style:{color:me,fontWeight:700},children:["내단가 ",ne," 원"]})," | 전체단가 ",fe," 원/단위"]})})()]})}),n.jsx("div",{className:"muted form-label",children:"매출월"}),n.jsx("div",{children:n.jsxs("select",{className:"search-input",value:re.month||"",onChange:k=>ds(k.target.value,re.qty),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(k,B)=>B+1).map(k=>n.jsxs("option",{value:String(k),children:[k,"월"]},k))]})})]}),n.jsxs("div",{style:{marginTop:12},children:[n.jsx("div",{className:"pane-header",style:{margin:0},children:"현재 목표"}),n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(k,B)=>B+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:n.jsx("tr",{children:(()=>{const k=(re.curMonths||[]).reduce((Q,te)=>Q+(Number.isFinite(te)?Number(te):0),0),B=(re.curAmounts||[]).reduce((Q,te)=>Q+(Number.isFinite(te)?Number(te):0),0);return n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(k,0,B)}),re.curMonths.map((Q,te)=>{var ee;return n.jsx("td",{children:Ze(Q,te,(ee=re.curAmounts)==null?void 0:ee[te],re.stage==="P"?"#dc2626":void 0,re.stage==="C")},te)})]})})()})})]})})]}),n.jsxs("div",{style:{marginTop:12},children:[n.jsx("div",{className:"pane-header",style:{margin:0},children:"분배 미리보기"}),n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(k,B)=>B+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:n.jsx("tr",{children:(()=>{const k=Ue();ve[k];const B=(re.unit||"").trim(),Q=Ge(B),te=Number.isFinite(Q)?Number(Q):0,ee=(re.dist||[]).reduce((ie,ne)=>ie+(Number.isFinite(ne)?Number(ne):0),0),X=Number.isFinite(te)?Math.round(te):0,le=(re.dist||[]).reduce((ie,ne)=>ie+(Number.isFinite(ne)&&X>0?Number(ne)*X:0),0);return n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(ee,0,le)}),re.dist.map((ie,ne)=>{const fe=Number.isFinite(te)?Math.round(te):0,me=Number.isFinite(ie)&&fe>0?Number(ie)*fe:void 0;return n.jsx("td",{children:Ze(ie,ne,me,re.stage==="P"?"#dc2626":void 0,re.stage==="C")},ne)})]})})()})})]})})]}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:us,children:"목표등록"})}),re.success?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:re.success}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:V,children:"확인"})})]})}):null]})}),ce.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:Ve.ref,className:"card compact",style:{...Ve.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[n.jsx("div",{...Ve.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:ze,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h2",{style:{margin:0},children:"목표 일괄입력"})}),n.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto",position:"relative"},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:68,textAlign:"center"},children:"구분"}),n.jsx("th",{style:{width:160,textAlign:"left"},children:"내 평균단가"}),n.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(k,B)=>B+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:ce.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:19,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):ce.rows.map((k,B)=>{const Q=Ue();ve[Q];const te=Ge((k.unit||"").trim()),ee=Number.isFinite(te)?Number(te):0,X=Number(k.month||0),le=Number(k.qty||0),ie=new Array(12).fill(0);if(Number.isFinite(X)&&X>=1&&X<=12&&Number.isFinite(le)&&le>0){const Se=12-X+1,We=le/Se;for(let Re=X-1;Re<12;Re++)ie[Re]=We}const ne=ie,fe=(k.curMonths||[]).reduce((Se,We)=>Se+(Number.isFinite(We)?Number(We):0),0),me=(k.curAmounts||[]).reduce((Se,We)=>Se+(Number.isFinite(We)?Number(We):0),0),he=ie.reduce((Se,We)=>Se+(Number.isFinite(We)?Number(We):0),0),Ie=ie.reduce((Se,We)=>Se+(Number.isFinite(We)&&Number.isFinite(ee)?Number(We)*ee:0),0);return n.jsxs(n.Fragment,{children:[n.jsxs("tr",{children:[n.jsx("td",{children:n.jsx("span",{style:{fontSize:12},children:k.sub})}),n.jsxs("td",{children:[n.jsx("span",{style:{fontSize:12},children:k.unit}),k.stage?n.jsx("span",{className:"stage-badge",style:{marginLeft:6},title:String(k.stage),children:String(k.stage)}):null]}),n.jsx("td",{style:{textAlign:"center"},className:"muted",children:"현재"}),n.jsx("td",{className:"muted",children:"-"}),n.jsx("td",{className:"muted",children:"-"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(fe,0,me)}),k.curMonths.map((Se,We)=>{var Re;return n.jsx("td",{children:Ze(Se,We,(Re=k.curAmounts)==null?void 0:Re[We],k.stage==="P"?"#dc2626":void 0,k.stage==="C")},We)})]},k.key+":cur"),n.jsxs("tr",{style:{background:"var(--panel-2)"},children:[n.jsx("td",{}),n.jsx("td",{}),n.jsx("td",{style:{textAlign:"center"},className:"sum-head",children:"적용"}),n.jsx("td",{children:n.jsxs("select",{className:"search-input",value:k.month||"",onChange:Se=>Pe(B,Se.target.value,void 0),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(Se,We)=>We+1).map(Se=>n.jsxs("option",{value:String(Se),children:[Se,"월"]},Se))]})}),n.jsx("td",{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:k.qty||"",onChange:Se=>Pe(B,void 0,Se.target.value)}),(()=>{var Rf;const Se=Ue(),Re=(((Rf=(Ne[Se]||{})[(k.unit||"").trim()])==null?void 0:Rf.itemStdUnit)||"").trim(),Ye=qe(k.unit||""),Et=ve[Se]||{},at=Number(Et[Ye]||0),$n=st(),Ln=(ue==null?void 0:ue[$n])||{},Vn=Number(Ln[Ye]||0),pr=Number.isFinite(at)&&at>0?Xe.format(Math.round(at)):"-",Hl=Number.isFinite(Vn)&&Vn>0?Xe.format(Math.round(Vn)):"-",Kb=Number.isFinite(at)&&Number.isFinite(Vn)?at>=Vn?Dt:"#dc2626":Dt;return n.jsxs("span",{className:"muted",style:{fontSize:12},children:[n.jsxs("span",{style:{color:Kb,fontWeight:700},children:["내단가 ",pr," 원"]})," | 전체단가 ",Hl," 원/",Re||"단위"]})})()]})}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(he,0,Ie)}),ne.map((Se,We)=>{const Re=Number.isFinite(ee)?Math.round(ee):0,Ye=Number.isFinite(Se)&&Re>0?Number(Se)*Re:void 0;return n.jsx("td",{children:Ze(Se,We,Ye,k.stage==="P"?"#dc2626":void 0,k.stage==="C")},We)})]},k.key+":prev")]})})}),(()=>{if(!ce.rows||ce.rows.length===0)return null;const k=Ue();ve[k];const B=Array.from({length:12},(fe,me)=>ce.rows.reduce((he,Ie)=>{var Se;return he+(Number((Se=Ie.curMonths)==null?void 0:Se[me])||0)},0)),Q=Array.from({length:12},(fe,me)=>ce.rows.reduce((he,Ie)=>{var Se;return he+(Number((Se=Ie.curAmounts)==null?void 0:Se[me])||0)},0)),te=B.reduce((fe,me)=>fe+(Number(me)||0),0),ee=Q.reduce((fe,me)=>fe+(Number(me)||0),0),X=Array.from({length:12},(fe,me)=>ce.rows.reduce((he,Ie)=>{var Se;return he+(Number((Se=Ie.dist)==null?void 0:Se[me])||0)},0)),le=Array.from({length:12},(fe,me)=>ce.rows.reduce((he,Ie)=>{var Ye;const Se=Ge((Ie.unit||"").trim()),We=Number.isFinite(Se)?Math.round(Number(Se)):0,Re=Number(((Ye=Ie.dist)==null?void 0:Ye[me])||0);return he+(Number.isFinite(Re)&&We>0?Re*We:0)},0)),ie=X.reduce((fe,me)=>fe+(Number(me)||0),0),ne=le.reduce((fe,me)=>fe+(Number(me)||0),0);return n.jsxs("tfoot",{children:[n.jsxs("tr",{className:"sum-row-current",children:[n.jsx("td",{colSpan:5,style:{textAlign:"center",fontWeight:700},children:"[현재] 합계"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(te,0,ee)}),B.map((fe,me)=>n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(fe,me,Q[me])},me))]}),n.jsxs("tr",{className:"sum-row-apply",style:{background:"var(--panel-2)"},children:[n.jsx("td",{colSpan:5,style:{textAlign:"center",fontWeight:700},children:"[적용] 합계"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(ie,0,ne)}),X.map((fe,me)=>n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(fe,me,le[me])},me))]})]})})()]})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:Oe,children:"목표등록"})}),ce.success?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"absolute",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:ce.success}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:V,children:"확인"})})]})}):null]})}),xt.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:fi.ref,className:"card compact",style:{...fi.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[n.jsx("div",{...fi.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:zr,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{className:"page-title",style:{marginBottom:8,alignItems:"center"},children:[n.jsx("h2",{style:{margin:0},children:"목표 일괄비율"}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsx("span",{className:"muted",children:"적용 비율(%)"}),n.jsx("input",{className:"assign-input",type:"number",min:0,max:100,step:1,placeholder:"0",value:ui,onChange:k=>fs(k.target.value),style:{width:100},"aria-label":"일괄 비율 입력"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:ar,children:"적용"})]})]}),n.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:68,textAlign:"center"},children:"구분"}),n.jsx("th",{style:{width:160,textAlign:"left"},children:"내 평균단가"}),n.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(k,B)=>B+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:xt.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:19,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):xt.rows.map((k,B)=>{const Q=Ue();ve[Q];const te=Ge((k.unit||"").trim()),ee=Number.isFinite(te)?Number(te):0,X=Array.isArray(k.dist)?k.dist.slice():new Array(12).fill(0),le=(k.curMonths||[]).reduce((me,he)=>me+(Number.isFinite(he)?Number(he):0),0),ie=(k.curAmounts||[]).reduce((me,he)=>me+(Number.isFinite(he)?Number(he):0),0),ne=X.reduce((me,he)=>me+(Number.isFinite(he)?Number(he):0),0),fe=X.reduce((me,he)=>me+(Number.isFinite(he)&&Number.isFinite(ee)?Number(he)*ee:0),0);return n.jsxs(n.Fragment,{children:[n.jsxs("tr",{children:[n.jsx("td",{children:n.jsx("span",{style:{fontSize:12},children:k.sub})}),n.jsxs("td",{children:[n.jsx("span",{style:{fontSize:12},children:k.unit}),k.stage?n.jsx("span",{className:"stage-badge",style:{marginLeft:6},title:String(k.stage),children:String(k.stage)}):null]}),n.jsx("td",{style:{textAlign:"center"},className:"muted",children:"현재"}),n.jsx("td",{className:"muted",style:{textAlign:"left"},children:(()=>{var pr;const me=Ue(),Ie=(((pr=(Ne[me]||{})[(k.unit||"").trim()])==null?void 0:pr.itemStdUnit)||"").trim(),Se=qe(k.unit||""),We=ve[me]||{},Re=Number(We[Se]||0),Ye=st(),Et=(ue==null?void 0:ue[Ye])||{},at=Number(Et[Se]||0),$n=Number.isFinite(Re)&&Re>0?Xe.format(Math.round(Re)):"-",Ln=Number.isFinite(at)&&at>0?Xe.format(Math.round(at)):"-",Vn=Number.isFinite(Re)&&Number.isFinite(at)?Re>=at?Dt:"#dc2626":Dt;return n.jsxs("span",{children:[n.jsxs("span",{style:{color:Vn,fontWeight:700},children:["내단가 ",$n," 원"]})," | 전체단가 ",Ln," 원/",Ie||"단위"]})})()}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(le,0,ie)}),k.curMonths.map((me,he)=>{var Ie;return n.jsx("td",{children:Ze(me,he,(Ie=k.curAmounts)==null?void 0:Ie[he],k.stage==="P"?"#dc2626":void 0,k.stage==="C")},he)})]},k.key+":cur"),n.jsxs("tr",{style:{background:"var(--panel-2)"},children:[n.jsx("td",{}),n.jsx("td",{}),n.jsx("td",{style:{textAlign:"center"},className:"sum-head",children:"적용"}),n.jsx("td",{className:"muted",style:{textAlign:"left"},children:(()=>{var pr;const me=Ue(),Ie=(((pr=(Ne[me]||{})[(k.unit||"").trim()])==null?void 0:pr.itemStdUnit)||"").trim(),Se=qe(k.unit||""),We=ve[me]||{},Re=Number(We[Se]||0),Ye=st(),Et=(ue==null?void 0:ue[Ye])||{},at=Number(Et[Se]||0),$n=Number.isFinite(Re)&&Re>0?Xe.format(Math.round(Re)):"-",Ln=Number.isFinite(at)&&at>0?Xe.format(Math.round(at)):"-",Vn=Number.isFinite(Re)&&Number.isFinite(at)?Re>=at?Dt:"#dc2626":Dt;return n.jsxs("span",{children:[n.jsxs("span",{style:{color:Vn,fontWeight:700},children:["내단가 ",$n," 원"]})," | 전체단가 ",Ln," 원/",Ie||"단위"]})})()}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(ne,0,fe)}),X.map((me,he)=>{const Ie=Number.isFinite(ee)?Math.round(ee):0,Se=Number.isFinite(me)&&Ie>0?Number(me)*Ie:void 0;return n.jsx("td",{children:Ze(me,he,Se,k.stage==="P"?"#dc2626":void 0,k.stage==="C")},he)})]},k.key+":prev")]})})}),(()=>{if(!xt.rows||xt.rows.length===0)return null;const k=Ue();ve[k];const B=Array.from({length:12},(fe,me)=>xt.rows.reduce((he,Ie)=>{var Se;return he+(Number((Se=Ie.curMonths)==null?void 0:Se[me])||0)},0)),Q=Array.from({length:12},(fe,me)=>xt.rows.reduce((he,Ie)=>{var Se;return he+(Number((Se=Ie.curAmounts)==null?void 0:Se[me])||0)},0)),te=B.reduce((fe,me)=>fe+(Number(me)||0),0),ee=Q.reduce((fe,me)=>fe+(Number(me)||0),0),X=Array.from({length:12},(fe,me)=>xt.rows.reduce((he,Ie)=>{var Se;return he+(Number((Se=Ie.dist)==null?void 0:Se[me])||0)},0)),le=Array.from({length:12},(fe,me)=>xt.rows.reduce((he,Ie)=>{var Ye;const Se=Ge((Ie.unit||"").trim()),We=Number.isFinite(Se)?Math.round(Number(Se)):0,Re=Number(((Ye=Ie.dist)==null?void 0:Ye[me])||0);return he+(Number.isFinite(Re)&&We>0?Re*We:0)},0)),ie=X.reduce((fe,me)=>fe+(Number(me)||0),0),ne=le.reduce((fe,me)=>fe+(Number(me)||0),0);return n.jsxs("tfoot",{children:[n.jsxs("tr",{className:"sum-row-current",children:[n.jsx("td",{colSpan:4,style:{textAlign:"center",fontWeight:700},children:"[현재] 합계"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(te,0,ee)}),B.map((fe,me)=>n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(fe,me,Q[me])},me))]}),n.jsxs("tr",{className:"sum-row-apply",style:{background:"var(--panel-2)"},children:[n.jsx("td",{colSpan:4,style:{textAlign:"center",fontWeight:700},children:"[적용] 합계"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(ie,0,ne)}),X.map((fe,me)=>n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze(fe,me,le[me])},me))]})]})})()]})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:Wl,children:"목표등록"})}),xt.success?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:xt.success}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:V,children:"확인"})})]})}):null]})}),Je.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:hi.ref,className:"card",style:{...hi.style,width:984,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[n.jsx("div",{...hi.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:hs,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h2",{style:{margin:0},children:"신규 영업관리단위"})}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 120px 1fr",gap:8,alignItems:"center",fontSize:12},children:[n.jsx("div",{className:"muted",children:"영업관리단위"}),n.jsx("div",{children:n.jsxs("select",{className:"search-input",value:Je.unit||"",onChange:k=>$b(k.target.value),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Je.opts.map((k,B)=>n.jsx("option",{value:k.salesMgmtUnit,children:k.salesMgmtUnit},B))]})}),n.jsx("div",{className:"muted",children:"중분류"}),n.jsx("div",{children:n.jsx("input",{className:"assign-input",value:Je.sub||"",readOnly:!0,placeholder:"자동"})}),n.jsx("div",{className:"muted",children:"매출월"}),n.jsx("div",{children:n.jsxs("select",{className:"search-input",value:Je.month||"",onChange:k=>Df(k.target.value,void 0),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(k,B)=>B+1).map(k=>n.jsxs("option",{value:String(k),children:[k,"월"]},k))]})}),n.jsx("div",{className:"muted",children:"매출 수량"}),n.jsx("div",{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:Je.qty||"",onChange:k=>Df(void 0,k.target.value)}),(()=>{var Se;const k=Ue(),B=ve[k]||{},Q=Ne[k]||{},te=(Je.unit||"").trim(),ee=qe(te),X=Number((B==null?void 0:B[ee])||0),le=st(),ie=(ue==null?void 0:ue[le])||{},ne=Number(ie[ee]||0),fe=(((Se=Q[te])==null?void 0:Se.itemStdUnit)||"").trim(),me=Number.isFinite(X)&&X>0?Xe.format(Math.round(X)):"-",he=Number.isFinite(ne)&&ne>0?Xe.format(Math.round(ne)):"-",Ie=Number.isFinite(X)&&Number.isFinite(ne)?X>=ne?Dt:"#dc2626":Dt;return n.jsxs("span",{className:"muted",style:{fontSize:12,whiteSpace:"nowrap"},children:[n.jsxs("span",{style:{color:Ie,fontWeight:700},children:["내단가 ",me," 원"]})," | 전체단가 ",he," 원/",fe||"단위"]})})()]})})]}),n.jsx("div",{style:{marginTop:12},children:n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsx("tr",{children:Array.from({length:12},(k,B)=>B+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))})}),n.jsx("tbody",{children:n.jsx("tr",{children:Je.dist.map((k,B)=>{const Q=Ue();ve[Q];const te=Ge((Je.unit||"").trim()),ee=Number.isFinite(te)?Number(te):0,X=Number.isFinite(ee)?Math.round(ee):0,le=Number.isFinite(k)&&X>0?Number(k)*X:void 0;return n.jsx("td",{children:Ze(k,B,le)},B)})})})]})})}),n.jsxs("div",{style:{marginTop:12},children:[n.jsx("div",{className:"pane-header",style:{margin:0},children:"추가된 영업관리단위"}),n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),Array.from({length:12},(k,B)=>B+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:Je.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:14,className:"muted",style:{padding:"12px 10px"},children:"추가된 영업관리단위가 없습니다"})}):Je.rows.map((k,B)=>n.jsxs("tr",{children:[n.jsxs("td",{children:[n.jsx("button",{className:"btn-plain","aria-label":"삭제",title:"삭제",onClick:()=>Cn(Q=>({...Q,rows:Q.rows.filter((te,ee)=>ee!==B)})),style:{marginRight:6,verticalAlign:"middle"},children:n.jsx("img",{src:Pt,className:"icon",alt:"삭제"})}),k.sub]}),n.jsx("td",{children:k.unit}),k.months.map((Q,te)=>{const ee=Ue();ve[ee];const X=Ge((k.unit||"").trim()),le=Number.isFinite(X)?Number(X):0,ie=Number.isFinite(le)?Math.round(le):0,ne=Number.isFinite(Q)&&ie>0?Number(Q)*ie:void 0;return n.jsx("td",{children:Ze(Q,te,ne)},te)})]},B))})]})})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:[n.jsx("button",{className:"btn btn-card btn-3d",onClick:Lb,children:"추가"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:Rb,children:"목표등록"})]}),Je.error?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:Je.error}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>Cn(k=>({...k,error:null})),children:"확인"})})]})}):null,Je.success?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:Je.success}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:V,children:"확인"})})]})}):null]})}),Gn.open&&n.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:60},children:n.jsxs("div",{ref:Ul.ref,className:"card",style:{...Ul.style,height:"66vh",width:760,maxWidth:"96vw",background:"var(--panel)",padding:12,borderLeft:"1px solid var(--border)",boxShadow:"-8px 0 24px rgba(0,0,0,0.18)",overflow:"hidden"},children:[n.jsx("div",{...Ul.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:Lf,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{className:"page-title",style:{marginBottom:8,display:"flex",alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,display:"flex",alignItems:"center",gap:6,fontSize:14},children:Wr?n.jsxs(n.Fragment,{children:[n.jsxs("span",{style:{color:Dt,fontWeight:700,fontSize:14},children:[Wr,"년"]}),n.jsx("span",{style:{fontSize:12},children:"내 평균거래 단가"})]}):n.jsx("span",{style:{fontSize:12},children:"내 평균거래 단가"})}),n.jsxs("div",{style:{marginLeft:"auto",display:"inline-flex",alignItems:"center",gap:8,flexWrap:"nowrap"},children:[n.jsx("select",{className:"search-input",value:Wr,onChange:k=>$f(Number(k.target.value)),"aria-label":"평균단가 조회 연도",style:{height:28},children:[2025,2026,2027,2028,2029,2030].map(k=>n.jsxs("option",{value:k,children:[k,"년"]},k))}),n.jsxs("div",{role:"radiogroup","aria-label":"회사 구분",className:"segmented",style:{display:"inline-flex",alignItems:"center",gap:8,height:28,border:"1px solid var(--border)",borderRadius:6,padding:"0 6px"},children:[n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:12,height:"100%"},children:[n.jsx("input",{type:"radio",name:"unit-company",value:"TNT",checked:mi==="TNT",onChange:()=>ql("TNT")}),n.jsx("span",{style:{fontSize:12},children:"TNT"})]}),n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:12,height:"100%"},children:[n.jsx("input",{type:"radio",name:"unit-company",value:"DYS",checked:mi==="DYS",onChange:()=>ql("DYS")}),n.jsx("span",{style:{fontSize:12},children:"DYS"})]})]})]})]}),Gn.error?n.jsx("div",{className:"error",style:{maxWidth:420},children:Gn.error}):n.jsx("div",{className:"table-container",style:{height:"calc(66vh - 120px)",overflow:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:180,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:120,textAlign:"left"},children:"판매단위"}),n.jsx("th",{style:{width:120,textAlign:"left"},children:"표준단위"}),n.jsx("th",{style:{width:120,textAlign:"right"},children:"내평균단가(원)"}),n.jsx("th",{style:{width:120,textAlign:"right"},children:"전체단가(원)"})]})}),n.jsx("tbody",{children:Gn.loading?n.jsx("tr",{children:n.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"불러오는 중…"})}):Gn.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):Gn.rows.map((k,B)=>n.jsxs("tr",{children:[n.jsx("td",{children:k.unit||"na"}),n.jsx("td",{children:k.itemUnit||"-"}),n.jsx("td",{children:k.itemStdUnit||"-"}),(()=>{const Q=Number(k.amountMy||0),te=Number(k.amountGlobal||0),ee=Number.isFinite(Q)&&Number.isFinite(te)?Q>=te?Dt:"#dc2626":Dt;return n.jsx("td",{style:{textAlign:"right",color:ee,fontWeight:700},children:Number.isFinite(Q)&&Q>0?`${Xe.format(Math.round(Q))} 원`:"-"})})(),n.jsx("td",{style:{textAlign:"right"},children:Number.isFinite(Number(k.amountGlobal))&&Number(k.amountGlobal)>0?`${Xe.format(Math.round(Number(k.amountGlobal)))} 원`:"-"})]},B))})]})})]})}),At&&n.jsx("div",{role:"alert","aria-live":"assertive","aria-busy":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:n.jsxs("div",{className:"card",style:{padding:16,background:"var(--panel)",minWidth:280,textAlign:"center",boxShadow:"0 4px 16px rgba(0,0,0,.3)"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"초기설정 진행 중"}),n.jsx("div",{className:"muted",style:{marginBottom:12},children:ci||"작업을 준비 중입니다…"}),n.jsx("div",{className:"muted",style:{fontSize:12},children:"작업이 완료될 때까지 다른 동작을 할 수 없습니다."})]})})]});async function Yb(){try{if(er(!0),tr("초기설정 요청 중입니다…"),!ye||isNaN(Number(ye))){alert("연도를 선택하세요.");return}const k=localStorage.getItem("tnt.sales.assigneeId")||"";if(!k){alert("로그인이 필요합니다.");return}const B={year:Number(ye),companyType:S,upliftPercent:Math.max(0,Math.min(999,Number(Fl)||0)),versionNo:1,assigneeId:k},Q=localStorage.getItem("tnt.sales.empSeq")||"",te=localStorage.getItem("tnt.sales.empId")||"",ee={"Content-Type":"application/json"};Q&&(ee["X-EMP-SEQ"]=Q),te&&(ee["X-EMP-ID"]=te),ee["X-ASSIGNEE-ID"]=k;const X=await fetch("/api/v1/sales/plan/init",{method:"POST",headers:ee,body:JSON.stringify(B)});if(tr("초기 목표를 저장하고 있습니다…"),!X.ok){let ne=`HTTP ${X.status}`;try{const fe=await X.json();fe!=null&&fe.error&&(ne=fe.error)}catch{const fe=await X.text();fe&&(ne=fe)}throw new Error(ne)}await X.json().catch(()=>({}));const le=(localStorage.getItem("tnt.sales.empName")||"").trim()||"사용자",ie=Number(ye);Y({show:!0,name:le,tnt:oe.tnt,dys:oe.dys,year:Number.isFinite(ie)&&ie>0?ie:0,hasP:!1,hasC:!1,hasI:!0,label:"초기설정완료"});try{await sa(!0)}catch{}}catch(k){alert((k==null?void 0:k.message)||"초기설정 중 오류가 발생했습니다.")}finally{er(!1),tr("")}}}function Vj(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function Xj(){const[e,t]=c.useState(""),[r,a]=c.useState(""),[i,s]=c.useState(""),[o,l]=c.useState(!1),[d,h]=c.useState(null),[u,f]=c.useState([]),[m,p]=c.useState(!1),[x,v]=c.useState({open:!1,x:0,y:0}),[g,b]=c.useState(()=>new Set),[y,N]=c.useState({open:!1,x:0,y:0}),[A,E]=c.useState(void 0),[w,P]=c.useState("init"),[_,$]=c.useState({}),L=["init","sim","apply","confirm"],j=[{key:"init",label:"초기설정"},{key:"sim",label:"Simulation"},{key:"apply",label:"목표반영"},{key:"confirm",label:"확정"}],S=L.indexOf(w),R=()=>{const F=Math.max(0,S-1);P(L[F])},O=()=>{const F=Math.min(L.length-1,S+1);P(L[F])},[z,Z]=c.useState(!1),[ae,se]=c.useState(null);new Date().getFullYear();const[H,q]=c.useState("prev1"),[C,T]=c.useState(()=>new Array(12).fill(0)),[W,I]=c.useState({loading:!1});async function U(){if(!(A!=null&&A.customerSeq)){T(new Array(12).fill(0));return}Z(!0),se(null);try{const F=new Date().getFullYear(),G=H==="prev1"?[F-1]:H==="last2"?[F-1,F-2]:[F-1,F-2,F-3],de=[];await Promise.all(G.map(async ke=>{try{const ye=await fetch(`/api/v1/customers/${A.customerSeq}/invoice-monthly?year=${ke}`);if(!ye.ok)return;const Ce=await ye.json().catch(()=>[]),J=(Array.isArray(Ce)?Ce:[]).map(ge=>({month:Number(ge.month??0),amount:Number(ge.amount??0)}));de.push(...J)}catch{}}));const be=new Array(12).fill(0);for(const ke of de){const ye=Math.min(12,Math.max(1,Number(ke.month)||0))-1;be[ye]+=Number.isFinite(ke.amount)?Number(ke.amount):0}T(be)}catch(F){se(F.message||"조회 중 오류가 발생했습니다"),T(new Array(12).fill(0))}finally{Z(!1)}}c.useEffect(()=>{w==="init"&&U()},[w,A==null?void 0:A.customerSeq,H]);async function K(){if(!(A!=null&&A.customerSeq)){I({loading:!1,hasRecent:void 0,error:null});return}I({loading:!0,hasRecent:void 0,error:null});try{const F=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);F.searchParams.set("custSeq",String(A.customerSeq)),F.searchParams.set("years","2");const G=await fetch(F.toString());if(!G.ok){let ke=`HTTP ${G.status}`;try{const ye=await G.json();ye!=null&&ye.error&&(ke=ye.error)}catch{}throw new Error(ke)}const de=await G.json(),be=Array.isArray(de)&&de.some(ke=>Number((ke==null?void 0:ke.customerSeq)||(ke==null?void 0:ke.customerSeqText)||0)===Number(A.customerSeq)&&!!(ke!=null&&ke.hasRecent));I({loading:!1,hasRecent:be,error:null})}catch(F){I({loading:!1,hasRecent:void 0,error:F.message||"오류"})}}c.useEffect(()=>{w==="init"&&K()},[w,A==null?void 0:A.customerSeq]);const Y=c.useMemo(()=>n.jsx("div",{className:"table-container",style:{border:"1px solid var(--border)",borderRadius:8,marginTop:8},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsx("tr",{children:Array.from({length:12},(F,G)=>n.jsxs("th",{style:{width:100,textAlign:"right"},children:[String(G+1).padStart(2,"0"),"월"]},G))})}),n.jsx("tbody",{children:n.jsx("tr",{children:C.map((F,G)=>n.jsx("td",{style:{textAlign:"right"},children:Math.round(F).toLocaleString()},G))})})]})}),[C]);async function M(){h(null),l(!0);try{const F=localStorage.getItem("tnt.sales.empId");if(!F){f([]),h(lt.loginRequired);return}const G=new URL("/api/v1/customers",window.location.origin);G.searchParams.set("mineOnly","true"),G.searchParams.set("empId",F);const de=await fetch(G.toString());if(!de.ok){let ye=`HTTP ${de.status}`;try{const Ce=await de.json();Ce!=null&&Ce.error&&(ye=Ce.error)}catch{const Ce=await de.text();Ce&&(ye=Ce)}throw new Error(ye)}const be=await de.json(),ke=Array.isArray(be)?be:[];f(ke);try{const ye=ke.map(Ce=>Number(Ce.customerSeq||0)).filter(Ce=>Number.isFinite(Ce)&&Ce>0);if(ye.length>0){const Ce=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);Ce.searchParams.set("custSeq",Array.from(new Set(ye)).join(",")),Ce.searchParams.set("years","2");const J=await fetch(Ce.toString());if(J.ok){const ge=await J.json(),Ee={};Array.isArray(ge)&&ge.forEach(we=>{const He=Number((we==null?void 0:we.customerSeq)||(we==null?void 0:we.customerSeqText)||0);Number.isFinite(He)&&(Ee[He]=!!(we!=null&&we.hasRecent))}),$(Ee)}else $({})}else $({})}catch{$({})}}catch(F){h(F.message||"조회 중 오류가 발생했습니다")}finally{l(!1)}}c.useEffect(()=>{M()},[]),c.useEffect(()=>{if(!x.open)return;const F=()=>v({open:!1,x:0,y:0});return window.addEventListener("click",F),()=>window.removeEventListener("click",F)},[x.open]),c.useEffect(()=>{if(!x.open)return;const F=G=>{G.key==="Escape"&&v({open:!1,x:0,y:0})};return window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[x.open]),c.useEffect(()=>{const F=G=>{((G==null?void 0:G.key)==="Escape"||(G==null?void 0:G.key)==="Esc"||(G==null?void 0:G.keyCode)===27)&&(v({open:!1,x:0,y:0}),N({open:!1,x:0,y:0}))};return document.addEventListener("keydown",F,!0),()=>document.removeEventListener("keydown",F,!0)},[]);async function D(F,G){F.preventDefault(),F.stopPropagation(),v({open:!1,x:0,y:0});const de=F.clientX,be=F.clientY;N({open:!0,x:de,y:be,row:G,loading:!1,error:null,data:[]})}const oe=c.useMemo(()=>{var F,G,de,be,ke,ye,Ce,J,ge,Ee,we,He,mt,vt,Ot;return n.jsx(n.Fragment,{children:n.jsxs("div",{className:"table-container",onClick:()=>v({open:!1,x:0,y:0}),style:{height:"100%",overflow:"auto"},children:[u.length===0?n.jsx("div",{className:"empty-state",children:lt.empty}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsx("tr",{children:n.jsx("th",{style:{width:"auto"},children:"거래처명"})})}),n.jsx("tbody",{children:u.map((pt,Xt)=>n.jsx("tr",{onClick:Ke=>{Ke.preventDefault(),Ke.stopPropagation(),E(pt),N({open:!1,x:0,y:0})},onContextMenu:Ke=>D(Ke,pt),"aria-selected":(A==null?void 0:A.customerId)===pt.customerId?!0:void 0,style:(A==null?void 0:A.customerId)===pt.customerId?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:n.jsx("td",{children:(()=>{const Ke=Number(pt.customerSeq||0);return _[Ke]?n.jsxs("span",{children:[pt.customerName," "," ","$"]}):pt.customerName})()})},Xt))})]}),y.open&&n.jsxs("div",{className:"context-menu",style:{left:y.x+6,top:y.y+6,maxWidth:420,padding:8},onClick:pt=>pt.stopPropagation(),children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 상세"}),y.error?n.jsx("div",{className:"error",style:{maxWidth:380},children:y.error}):n.jsx("table",{className:"table",style:{width:"100%"},children:n.jsxs("tbody",{children:[n.jsxs("tr",{children:[n.jsx("th",{style:{width:110,textAlign:"left"},children:"거래처번호"}),n.jsx("td",{children:((F=y.row)==null?void 0:F.customerId)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"사업자번호"}),n.jsx("td",{children:((G=y.row)==null?void 0:G.bizNo)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"대표자명"}),n.jsx("td",{children:((de=y.row)==null?void 0:de.ownerName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"업태"}),n.jsx("td",{children:((be=y.row)==null?void 0:be.bizKind)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"종목"}),n.jsx("td",{children:((ke=y.row)==null?void 0:ke.bizType)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"전화번호"}),n.jsx("td",{children:((ye=y.row)==null?void 0:ye.telNo)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"담당자명"}),n.jsx("td",{children:((Ce=y.row)==null?void 0:Ce.empName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"부서명"}),n.jsx("td",{children:((J=y.row)==null?void 0:J.deptName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"시/도"}),n.jsx("td",{children:((ge=y.row)==null?void 0:ge.addrProvinceName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"시/군/구"}),n.jsx("td",{children:((Ee=y.row)==null?void 0:Ee.addrCityName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"고객유형"}),n.jsx("td",{children:((we=y.row)==null?void 0:we.customerTypeName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"비고"}),n.jsx("td",{children:((He=y.row)==null?void 0:He.customerRemark)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"생성자"}),n.jsx("td",{children:((mt=y.row)==null?void 0:mt.createdBy)??""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"수정자"}),n.jsx("td",{children:((vt=y.row)==null?void 0:vt.updatedBy)??""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"생성일시"}),n.jsx("td",{children:Vj((Ot=y.row)==null?void 0:Ot.createdAt)})]})]})})]})]})})},[u,x,g,y,A,_]);return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:18},children:"목표 Simulation"}),n.jsxs("div",{className:"muted count-text",children:[u.length.toLocaleString(),"개 거래처"]})]}),d&&n.jsx("div",{className:"error",children:d||lt.errorGeneric}),n.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[n.jsx("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:oe}),n.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[n.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:(()=>{const F=[];for(let G=0;G<j.length;G++){const de=j[G],be=G<S,ke=G===S;F.push(n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:G===j.length-1?"0 0 auto":"1 1 0"},children:[n.jsx("div",{title:de.label,onClick:()=>P(de.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:be||ke?"var(--accent)":"transparent",border:`2px solid ${be||ke?"var(--accent)":"var(--border)"}`,color:be||ke?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":ke?"step":void 0,children:be?"✓":G+1}),n.jsx("div",{style:{fontSize:12,color:ke||be?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:de.label}),G<j.length-1&&n.jsx("div",{style:{height:2,background:G<S?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},de.key))}return F})()}),n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[n.jsx("button",{className:"btn btn-icon",onClick:R,disabled:S===0,"aria-label":"이전 단계",title:"이전 단계",children:n.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:n.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),n.jsx("button",{className:"btn btn-icon",onClick:O,disabled:S===j.length-1,"aria-label":"다음 단계",title:"다음 단계",children:n.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:n.jsx("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),w==="init"&&n.jsxs("section",{style:{marginTop:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:10},children:[n.jsx("b",{children:"기준매출"}),n.jsxs("select",{value:H,onChange:F=>q(F.target.value),style:{height:28,padding:"4px 8px",borderRadius:8,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12},"aria-label":"기준 기간 선택",children:[n.jsx("option",{value:"prev1",children:"전년"}),n.jsx("option",{value:"last2",children:"최근2년"}),n.jsx("option",{value:"last3",children:"최근3년"})]})]}),ae&&n.jsx("span",{className:"error",children:ae})]}),z?n.jsx("div",{className:"empty-state",style:{marginTop:8},children:"불러오는 중…"}):Y]})]})]})]})}const Qj="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M12%201v22'/%3e%3cpath%20d='M17%205H9.5a3.5%203.5%200%200%200%200%207H14a3.5%203.5%200%200%201%200%207H6'/%3e%3c/svg%3e",Jj="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpolyline%20points='3%2017%209%2011%2013%2015%2021%207'%20/%3e%3ccircle%20cx='21'%20cy='7'%20r='1'%20/%3e%3c/svg%3e";function ys(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function Nd({compact:e=!1,maxHeight:t,context:r="list",onSelect:a,autoSelectFirst:i=!0}){const[s,o]=c.useState(""),[l,d]=c.useState(""),[h,u]=c.useState(""),[f,m]=c.useState(!1),[p,x]=c.useState(null),[v,g]=c.useState([]),[b,y]=c.useState("mine"),[N,A]=c.useState({open:!1,x:0,y:0}),[E,w]=c.useState(()=>new Set),[P,_]=c.useState({open:!1,x:0,y:0}),[$,L]=c.useState({}),[j,S]=c.useState({}),[R,O]=c.useState(!1),[z,Z]=c.useState(0),ae=100,[se,H]=c.useState(0),[q,C]=c.useState(!0),[T,W]=c.useState(!1),I=Ae.useRef(null),[U,K]=c.useState(()=>{try{const J=localStorage.getItem("tnt.sales.selectedCustomer");if(J){const ge=JSON.parse(J),Ee=Number(ge==null?void 0:ge.customerSeq);return Number.isFinite(Ee)?Ee:null}}catch{}return null}),[Y,M]=c.useState(()=>{try{const J=localStorage.getItem("tnt.sales.selectedCustomer");if(J){const ge=JSON.parse(J);return String((ge==null?void 0:ge.customerId)||"")||null}}catch{}return null}),D=c.useMemo(()=>{const J=typeof window<"u"?localStorage.getItem("tnt.sales.empName"):"",ge=typeof window<"u"?localStorage.getItem("tnt.sales.assigneeId"):"";return J||ge||""},[]);function oe(J,ge){w(Ee=>{const we=new Set(Ee);return ge?we.add(J):we.delete(J),we})}function F(J){if(!J){w(new Set);return}const ge=new Set;v.forEach(Ee=>{Ee.customerId&&ge.add(Ee.customerId)}),w(ge)}async function G(J=!0){x(null),J?(m(!0),H(0),C(!0)):W(!0);try{const ge=localStorage.getItem("tnt.sales.assigneeId");if(!ge){g([]),x(lt.loginRequired);return}const Ee=new URL("/api/v1/customers",window.location.origin);s.trim()&&Ee.searchParams.set("name",s.trim()),l.trim()&&Ee.searchParams.set("provinceName",l.trim()),h.trim()&&Ee.searchParams.set("cityName",h.trim());const we=b==="mine";Ee.searchParams.set("mineOnly",we?"true":"false"),we&&ge&&Ee.searchParams.set("assigneeId",ge),Ee.searchParams.set("limit",String(ae)),Ee.searchParams.set("offset",String(J?0:se));const He=await fetch(Ee.toString());if(!He.ok){let Ke=`HTTP ${He.status}`;try{const gt=await He.json();gt!=null&&gt.error&&(Ke=gt.error)}catch{const Qe=await He.text();Qe&&(Ke=Qe)}throw new Error(Ke)}const mt=await He.json(),vt=Array.isArray(mt)?mt:[],Ot=[...vt].sort((Ke,gt)=>{const Qe=(Ke.customerName||"").toString(),_t=(gt.customerName||"").toString();return Qe.localeCompare(_t,"ko",{sensitivity:"base"})}),pt=(J?Ot:vt).map(Ke=>Number(Ke.customerSeq||0)).filter(Ke=>Number.isFinite(Ke)&&Ke>0),Xt=Array.from(new Set(pt)).join(",");try{if(pt.length>0){const Ke=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);Ke.searchParams.set("custSeq",Xt),Ke.searchParams.set("years","2");const gt=new URL("/api/v1/customers/demand-flags",window.location.origin);gt.searchParams.set("custSeq",Xt);const[Qe,_t]=await Promise.all([fetch(Ke.toString()),fetch(gt.toString())]);if(Qe.ok){const rn=await Qe.json(),vn={};Array.isArray(rn)&&rn.forEach(Xe=>{const An=Number((Xe==null?void 0:Xe.customerSeq)||0);Number.isFinite(An)&&(vn[An]=!!(Xe!=null&&Xe.hasRecent))}),L(Xe=>J?vn:{...Xe,...vn})}else J&&L({});if(_t.ok){const rn=await _t.json(),vn={};Array.isArray(rn)&&rn.forEach(Xe=>{const An=Number((Xe==null?void 0:Xe.customerSeq)||0);Number.isFinite(An)&&(vn[An]=!!(Xe!=null&&Xe.hasDemand))}),S(Xe=>J?vn:{...Xe,...vn})}else J&&S({})}else J&&(L({}),S({}))}catch{J&&(L({}),S({}))}g(J?Ot:Ke=>[...Ke,...Ot]),C(vt.length>=ae),H(J?ae:Ke=>Ke+ae),J&&!R&&Ot.length>0&&i&&(de(Ot[0]),O(!0));try{if(ge&&b==="mine"){const Ke=new URL("/api/v1/customers/count",window.location.origin);Ke.searchParams.set("mineOnly","true"),Ke.searchParams.set("assigneeId",ge);const gt=await fetch(Ke.toString());if(gt.ok){const Qe=await gt.json().catch(()=>({})),_t=Number((Qe==null?void 0:Qe.total)??0);Z(Number.isFinite(_t)?_t:0)}else Z(0)}else Z(0)}catch{Z(0)}}catch(ge){x(ge.message||"조회 중 오류가 발생했습니다")}finally{J?m(!1):W(!1)}}c.useEffect(()=>{G(!0)},[]),c.useEffect(()=>{const J=()=>{try{const ge=localStorage.getItem("tnt.sales.selectedCustomer");if(ge){const Ee=JSON.parse(ge),we=Number(Ee==null?void 0:Ee.customerSeq);K(Number.isFinite(we)?we:null),M((Ee==null?void 0:Ee.customerId)||null)}}catch{}};return window.addEventListener("tnt.sales.customer.selected",J),()=>window.removeEventListener("tnt.sales.customer.selected",J)},[]),c.useEffect(()=>{G(!0)},[b]),c.useEffect(()=>{const J=I.current;if(!J)return;function ge(){J.scrollTop+J.clientHeight>=J.scrollHeight-48&&q&&!T&&!f&&G(!1)}return J.addEventListener("scroll",ge),()=>J.removeEventListener("scroll",ge)},[q,T,f,se,s,l,h,b]),c.useEffect(()=>{if(!N.open)return;const J=()=>A({open:!1,x:0,y:0});return window.addEventListener("click",J),()=>window.removeEventListener("click",J)},[N.open]),c.useEffect(()=>{if(!N.open)return;const J=ge=>{ge.key==="Escape"&&A({open:!1,x:0,y:0})};return window.addEventListener("keydown",J),()=>window.removeEventListener("keydown",J)},[N.open]),c.useEffect(()=>{if(!P.open)return;const J=()=>_({open:!1,x:0,y:0}),ge=Ee=>{Ee.key==="Escape"&&_({open:!1,x:0,y:0})};return window.addEventListener("click",J),window.addEventListener("keydown",ge),()=>{window.removeEventListener("click",J),window.removeEventListener("keydown",ge)}},[P.open]),c.useEffect(()=>{const J=ge=>{((ge==null?void 0:ge.key)==="Escape"||(ge==null?void 0:ge.key)==="Esc"||(ge==null?void 0:ge.keyCode)===27)&&(A({open:!1,x:0,y:0}),_({open:!1,x:0,y:0}))};return document.addEventListener("keydown",J,!0),()=>document.removeEventListener("keydown",J,!0)},[]);function de(J){try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(J||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:J}})),a&&a(J)}catch{}K((()=>{const ge=Number(J.customerSeq);return Number.isFinite(ge)?ge:null})()),M(J.customerId||null),A({open:!1,x:0,y:0}),_({open:!1,x:0,y:0})}function be(J,ge){const Ee=J.clientX,we=J.clientY;_({open:!0,x:Ee,y:we,row:ge,loading:!1,error:null,data:[]})}function ke(J){P.open&&_(ge=>({...ge,x:J.clientX,y:J.clientY}))}function ye(){_({open:!1,x:0,y:0})}const Ce=c.useMemo(()=>{const J=ge=>{const Ee=(ge||"").trim().toUpperCase();if(Ee!=="TNT"&&Ee!=="DYS")return null;const we=Ee==="TNT"?"#2563eb":"#16a34a";return n.jsx("span",{"aria-label":Ee,style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:"50%",color:"#fff",fontWeight:700,fontSize:11,background:we,flexShrink:0},children:Ee==="TNT"?"T":"D"})};return n.jsx(n.Fragment,{children:n.jsxs("div",{ref:I,className:"table-container",onClick:()=>A({open:!1,x:0,y:0}),style:{maxHeight:t??(e?"32vh":void 0),overflow:"auto"},children:[v.length===0?n.jsx("div",{className:"empty-state",children:lt.empty}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:36,textAlign:"center"},children:n.jsx("input",{type:"checkbox",checked:v.length>0&&E.size===v.length,onChange:ge=>F(ge.target.checked)})}),n.jsx("th",{style:{width:140},children:"거래처번호"}),n.jsx("th",{style:{width:200},children:"거래처명"}),n.jsx("th",{style:{width:80},children:"추가정보"}),n.jsx("th",{style:{width:140},children:"사업자번호"}),n.jsx("th",{style:{width:120},children:"대표자명"}),n.jsx("th",{style:{width:120},children:"업태"}),n.jsx("th",{style:{width:120},children:"종목"}),n.jsx("th",{style:{width:130},children:"전화번호"}),n.jsx("th",{style:{width:120},children:"담당자명"}),n.jsx("th",{style:{width:140},children:"부서명"}),n.jsx("th",{style:{width:120},children:"시/도"}),n.jsx("th",{style:{width:120},children:"시/군/구"}),n.jsx("th",{style:{width:120},children:"고객유형"}),n.jsx("th",{children:"비고"}),n.jsx("th",{style:{width:120},children:"생성자"}),n.jsx("th",{style:{width:120},children:"수정자"}),n.jsx("th",{style:{width:180},children:"생성일시"}),n.jsx("th",{style:{width:180},children:"수정일시"})]})}),n.jsx("tbody",{children:v.map((ge,Ee)=>n.jsxs("tr",{className:Number(ge.customerSeq||0)===(U||-1)||Y&&ge.customerId===Y?"selected":void 0,onClick:()=>de(ge),onContextMenu:we=>{we.preventDefault(),we.stopPropagation(),ye(),A({open:!0,x:we.clientX,y:we.clientY,row:ge})},children:[n.jsx("td",{style:{textAlign:"center"},onClick:we=>we.stopPropagation(),children:n.jsx("input",{type:"checkbox",checked:E.has(ge.customerId),onChange:we=>oe(ge.customerId,we.target.checked)})}),n.jsx("td",{onMouseEnter:we=>be(we,ge),onMouseMove:ke,onMouseLeave:ye,children:ge.customerId}),n.jsx("td",{children:r==="c360"?n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[J(ge.companyType),n.jsx("span",{children:ge.customerName})]}):ge.customerName}),n.jsx("td",{children:(()=>{const we=Number(ge.customerSeq||0),He=!!$[we],mt=!!j[we];return!He&&!mt?"":n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[He&&n.jsx("img",{src:Qj,className:"icon",alt:"",title:"최근2년 매출 있음",style:{width:14,height:14}}),mt&&n.jsx("img",{src:Jj,className:"icon",alt:"",title:"수요 있음",style:{width:14,height:14}})]})})()}),n.jsx("td",{children:ge.bizNo||""}),n.jsx("td",{children:ge.ownerName||""}),n.jsx("td",{children:ge.bizKind||""}),n.jsx("td",{children:ge.bizType||""}),n.jsx("td",{children:ge.telNo||""}),n.jsx("td",{children:ge.empName||""}),n.jsx("td",{children:ge.deptName||""}),n.jsx("td",{children:ge.addrProvinceName||""}),n.jsx("td",{children:ge.addrCityName||""}),n.jsx("td",{children:ge.customerTypeName||""}),n.jsx("td",{children:ge.customerRemark||""}),n.jsx("td",{children:ge.createdBy??""}),n.jsx("td",{children:ge.updatedBy??""}),n.jsx("td",{children:ys(ge.createdAt)}),n.jsx("td",{children:ys(ge.updatedAt)})]},Ee))})]}),T&&n.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:lt.loading}),!f&&!T&&!q&&v.length>0&&n.jsx("div",{className:"muted",style:{padding:"8px 10px",textAlign:"center"},children:"마지막 데이터입니다."}),N.open&&n.jsxs("div",{className:"context-menu",style:{left:N.x+4,top:N.y+4},onClick:ge=>ge.stopPropagation(),children:[r!=="c360"?n.jsxs(n.Fragment,{children:[n.jsx("button",{className:"context-item",onClick:()=>{try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(N.row||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:N.row}}))}catch{}const ge=document.querySelector('button[data-key="customer:c360"]');ge&&ge.click(),A({open:!1,x:0,y:0})},children:"C360"}),n.jsx("button",{className:"context-item",onClick:()=>{try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(N.row||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:N.row}}))}catch{}window.dispatchEvent(new CustomEvent("tnt.sales.navigate",{detail:{key:"sales-mgmt:receivables"}})),A({open:!1,x:0,y:0})},children:"미수현황"})]}):null,n.jsx("button",{className:"context-item",onClick:()=>{try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(N.row||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:N.row}}))}catch{}if(r==="c360")try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.create.inline",{detail:{customer:N.row}}))}catch{}else{const ge=document.querySelector('button[data-key="customer:sales-activity-new"]');ge&&ge.click()}A({open:!1,x:0,y:0})},children:"활동등록"})]}),P.open&&P.row&&n.jsxs("div",{className:"context-menu",style:{left:P.x+6,top:P.y+6,maxWidth:500,padding:10},onClick:ge=>ge.stopPropagation(),onMouseLeave:ye,children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 정보"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr",gap:6,maxWidth:480},children:[n.jsx("div",{className:"muted",children:"거래처번호"}),n.jsx("div",{children:P.row.customerId||""}),n.jsx("div",{className:"muted",children:"거래처명"}),n.jsx("div",{children:P.row.customerName||""}),P.row.customerFullName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"정식명"}),n.jsx("div",{children:P.row.customerFullName})]}):null,P.row.bizNo?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"사업자번호"}),n.jsx("div",{children:P.row.bizNo})]}):null,P.row.ownerName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"대표자명"}),n.jsx("div",{children:P.row.ownerName})]}):null,P.row.bizKind?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"업태"}),n.jsx("div",{children:P.row.bizKind})]}):null,P.row.bizType?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"종목"}),n.jsx("div",{children:P.row.bizType})]}):null,P.row.telNo?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"전화번호"}),n.jsx("div",{children:P.row.telNo})]}):null,P.row.empName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"담당자명"}),n.jsx("div",{children:P.row.empName})]}):null,P.row.deptName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"부서명"}),n.jsx("div",{children:P.row.deptName})]}):null,P.row.addrProvinceName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"시/도"}),n.jsx("div",{children:P.row.addrProvinceName})]}):null,P.row.addrCityName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"시/군/구"}),n.jsx("div",{children:P.row.addrCityName})]}):null,P.row.customerTypeName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"고객유형"}),n.jsx("div",{children:P.row.customerTypeName})]}):null,P.row.customerRemark?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"비고"}),n.jsx("div",{children:P.row.customerRemark})]}):null,P.row.createdAt?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"생성일시"}),n.jsx("div",{children:ys(P.row.createdAt)})]}):null,P.row.updatedAt?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"수정일시"}),n.jsx("div",{children:ys(P.row.updatedAt)})]}):null]})]})]})})},[v,N,E,P]);return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,alignItems:"center",flex:"1 1 auto",minWidth:0},children:[n.jsxs("select",{value:b,onChange:J=>y(J.target.value),style:{height:30,padding:"2px 8px",fontSize:11,background:b==="mine"?"rgba(59,130,246,.15)":"#fff",borderRadius:8,border:b==="mine"?"1px solid var(--accent)":"1px solid var(--border)"},children:[n.jsx("option",{value:"mine",children:"내 거래처"}),n.jsx("option",{value:"hq",children:"본부 거래처"}),n.jsx("option",{value:"all",children:"전체"})]}),n.jsx("input",{className:"search-input",value:s,onChange:J=>o(J.target.value),onKeyDown:J=>{J.key==="Enter"&&G()},placeholder:"거래처명",style:{background:"#fff",borderRadius:8,border:"1px solid var(--border)"}}),n.jsx("input",{className:"search-input",value:l,onChange:J=>d(J.target.value),onKeyDown:J=>{J.key==="Enter"&&G()},placeholder:"시/도",style:{background:"#fff",borderRadius:8,border:"1px solid var(--border)",minWidth:100}}),n.jsx("input",{className:"search-input",value:h,onChange:J=>u(J.target.value),onKeyDown:J=>{J.key==="Enter"&&G()},placeholder:"시/군/구",style:{background:"#fff",borderRadius:8,border:"1px solid var(--border)",minWidth:120}}),n.jsx("button",{className:"btn",onClick:()=>G(),disabled:f,style:{height:30,padding:"0 12px"},children:"조회"}),f&&n.jsx("span",{className:"muted",style:{lineHeight:"30px"},children:lt.loading})]}),n.jsx("div",{className:"meta",style:{gap:0},children:n.jsxs("span",{className:"muted count-text",children:[b==="mine"&&D?`${D} · `:"",(b==="mine"?z:v.length).toLocaleString(),"개 거래처",E.size?` · 선택 ${E.size}건`:""]})})]}),p&&n.jsx("div",{className:"error",children:p||lt.errorGeneric}),n.jsx("div",{style:{marginTop:12},children:Ce})]})}function gr(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function kd({customerSeq:e,customerId:t,hideHeader:r=!1,hideRefresh:a=!1,enableContextMenu:i=!1}){const[s,o]=c.useState([]),[l,d]=c.useState(!1),[h,u]=c.useState(null),[f,m]=c.useState({open:!1,x:0,y:0}),p=c.useRef(null),[x,v]=c.useState(null);async function g(){u(null),d(!0);try{const E=new URL("/api/v1/sales-activities",window.location.origin);E.searchParams.set("mineOnly","false");const w=t&&t.trim()||(()=>{try{const $=localStorage.getItem("tnt.sales.selectedCustomer");if($){const L=JSON.parse($);return(L==null?void 0:L.customerId)||""}}catch{}return""})();E.searchParams.set("sfAccountId",w||"");const P=await fetch(E.toString());if(!P.ok){let $=`HTTP ${P.status}`;try{const L=await P.json();L!=null&&L.error&&($=L.error)}catch{}throw new Error($)}const _=await P.json();o(Array.isArray(_)?_:[])}catch(E){u(E.message||"조회 중 오류가 발생했습니다")}finally{d(!1)}}c.useEffect(()=>{e&&g()},[e,t]);async function b(E){try{const w=new URL("/api/v1/sales-activities",window.location.origin);w.searchParams.set("mineOnly","false");const P=t&&t.trim()||(()=>{try{const j=localStorage.getItem("tnt.sales.selectedCustomer");if(j){const S=JSON.parse(j);return(S==null?void 0:S.customerId)||""}}catch{}return""})();w.searchParams.set("sfAccountId",P||""),w.searchParams.set("parentSeq",String(E)),w.searchParams.set("includeParent","true");const _=await fetch(w.toString());if(!_.ok)return;const $=await _.json(),L=Array.isArray($)?$:[];L.sort((j,S)=>{const R=!j.parentSeq,O=!S.parentSeq;if(R&&!O)return-1;if(!R&&O)return 1;const z=j.createdAt?new Date(j.createdAt).getTime():0;return(S.createdAt?new Date(S.createdAt).getTime():0)-z}),v(L)}catch{v([])}}c.useEffect(()=>{if(!f.open)return;const E=w=>{if(w.button!==0)return;const P=w.target;p.current&&P&&p.current.contains(P)||m({open:!1,x:0,y:0})};return window.addEventListener("mousedown",E,!0),()=>window.removeEventListener("mousedown",E,!0)},[f.open]),c.useEffect(()=>{if(!f.open)return;const E=w=>{((w==null?void 0:w.key)==="Escape"||(w==null?void 0:w.key)==="Esc"||(w==null?void 0:w.keyCode)===27)&&m({open:!1,x:0,y:0})};return document.addEventListener("keydown",E,!0),()=>document.removeEventListener("keydown",E,!0)},[f.open]),c.useEffect(()=>{if(!x)return;const E=w=>{w.key==="Escape"&&(w.preventDefault(),w.stopPropagation(),v(null))};return window.addEventListener("keydown",E,!0),()=>window.removeEventListener("keydown",E,!0)},[x]);const y=(E,w)=>E?w==="type"?{site_visit:"정기방문",opportunity:"영업기회",AR_mgmt:"채권관리",meeting:"미팅",call:"전화",email:"이메일",demo:"데모",task:"업무",other:"기타"}[E]||E:w==="status"?{scheduled:"계획",completed:"완료",canceled:"취소",postponed:"연기",no_show:"미방문"}[E]||E:w==="channel"&&{in_person:"방문",phone:"전화",email:"문자/메일/팩스",other:"기타",video:"영상",chat:"채팅",sms:"문자"}[E]||E:"",N=E=>[`제목: ${E.subject||""}`,`활동설명: ${E.description||""}`,`활동유형: ${y(E.activityType,"type")}`,`활동방법: ${y(E.channel,"channel")}`,`상태: ${y(E.activityStatus,"status")}`,`상위활동: ${E.parentSubject||""}`,`계획 일시: ${gr(E.plannedStartAt)}`,`종료 일시: ${gr(E.plannedEndAt)}`,`생성일시: ${gr(E.createdAt)}`,E.customerName?`거래처명: ${E.customerName}`:""].filter(Boolean).join(`
`),A=c.useMemo(()=>n.jsxs(n.Fragment,{children:[!r&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[n.jsx("div",{className:"muted"}),n.jsxs("div",{className:"muted count-text",children:["총 ",s.length,"건"]})]}),n.jsx("div",{className:"table-container",children:s.length===0?n.jsx("div",{className:"empty-state",children:"활동이 없습니다."}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:240},children:"제목"}),n.jsx("th",{style:{width:280},children:"활동설명"}),n.jsx("th",{style:{width:120},children:"활동유형"}),n.jsx("th",{style:{width:120},children:"활동방법"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:220},children:"상위활동"}),n.jsx("th",{style:{width:180},children:"계획 일시"}),n.jsx("th",{style:{width:180},children:"종료 일시"}),n.jsx("th",{style:{width:180},children:"생성일시"})]})}),n.jsx("tbody",{children:s.map((E,w)=>n.jsxs("tr",{title:N(E),onContextMenu:P=>{i&&E.parentSeq&&(P.preventDefault(),P.stopPropagation(),m({open:!0,x:P.clientX,y:P.clientY,row:E}))},children:[n.jsx("td",{children:E.subject||""}),n.jsx("td",{title:E.description||"",style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:E.description||""}),n.jsx("td",{children:y(E.activityType,"type")}),n.jsx("td",{children:y(E.channel,"channel")}),n.jsx("td",{children:y(E.activityStatus,"status")}),n.jsx("td",{children:E.parentSubject||""}),n.jsx("td",{children:gr(E.plannedStartAt)}),n.jsx("td",{children:gr(E.plannedEndAt)}),n.jsx("td",{children:gr(E.createdAt)})]},w))})]})})]}),[s]);return n.jsxs("section",{children:[!a&&n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[n.jsx("button",{className:"btn",onClick:g,disabled:l,children:l?"새로고침…":"새로고침"}),h&&n.jsx("span",{className:"error",children:h})]}),a&&h&&n.jsx("div",{className:"error",children:h}),n.jsx("div",{style:{marginTop:12},children:A}),f.open&&n.jsx("div",{ref:p,className:"context-menu",style:{left:f.x+4,top:f.y+4},onClick:E=>E.stopPropagation(),children:n.jsx("button",{className:"context-item",onClick:()=>{var E,w;(E=f.row)!=null&&E.parentSeq?b(f.row.parentSeq):(w=f.row)!=null&&w.id&&b(f.row.id),m({open:!1,x:0,y:0})},children:"관련활동"})}),x&&n.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.4)"},onClick:()=>v(null),children:n.jsxs("div",{className:"card",style:{width:"min(1200px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:E=>E.stopPropagation(),children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[n.jsxs("div",{className:"list-title",style:{display:"flex",alignItems:"center",gap:6},children:[n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",style:{color:"#555"},children:[n.jsx("circle",{cx:"6",cy:"6",r:"3",stroke:"currentColor",strokeWidth:"1.8"}),n.jsx("circle",{cx:"18",cy:"6",r:"3",stroke:"currentColor",strokeWidth:"1.8"}),n.jsx("circle",{cx:"12",cy:"18",r:"3",stroke:"currentColor",strokeWidth:"1.8"}),n.jsx("line",{x1:"8.5",y1:"7.4",x2:"15.5",y2:"7.4",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),n.jsx("line",{x1:"7.2",y1:"8.9",x2:"10.8",y2:"15.1",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),n.jsx("line",{x1:"16.8",y1:"8.9",x2:"13.2",y2:"15.1",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]}),n.jsx("span",{style:{fontWeight:600,fontSize:14},children:"관련활동"}),n.jsxs("span",{className:"muted count-text",style:{marginLeft:8},children:["총 ",x.length,"건"]})]}),n.jsx("button",{onClick:()=>v(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:E=>{E.currentTarget.style.background="var(--panel-2)",E.currentTarget.style.color="var(--text)"},onMouseLeave:E=>{E.currentTarget.style.background="transparent",E.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)",children:"×"})]}),n.jsx("div",{className:"table-container",children:x.length===0?n.jsx("div",{className:"empty-state",children:"관련활동이 없습니다."}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200},children:"상위활동"}),n.jsx("th",{style:{width:240},children:"제목"}),n.jsx("th",{style:{width:280},children:"활동설명"}),n.jsx("th",{style:{width:120},children:"활동유형"}),n.jsx("th",{style:{width:120},children:"활동방법"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:180},children:"계획 일시"}),n.jsx("th",{style:{width:180},children:"종료 일시"}),n.jsx("th",{style:{width:180},children:"생성일시"})]})}),n.jsx("tbody",{children:x.map((E,w)=>n.jsxs("tr",{title:N(E),className:E.parentSeq?void 0:"row-parent",children:[n.jsx("td",{children:E.parentSubject||""}),n.jsx("td",{children:E.subject||""}),n.jsx("td",{style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:E.description||""}),n.jsx("td",{children:y(E.activityType,"type")}),n.jsx("td",{children:y(E.channel,"channel")}),n.jsx("td",{children:y(E.activityStatus,"status")}),n.jsx("td",{children:gr(E.plannedStartAt)}),n.jsx("td",{children:gr(E.plannedEndAt)}),n.jsx("td",{children:gr(E.createdAt)})]},`rel-${w}`))})]})})]})})]})}function Zj(){const[e,t]=c.useState(null),[r,a]=c.useState("form");c.useEffect(()=>{try{const s=localStorage.getItem("tnt.sales.selectedCustomer");t(s?JSON.parse(s):null)}catch{t(null)}},[]);const i=c.useMemo(()=>e?n.jsx("section",{className:"card compact-form",children:n.jsxs("div",{className:"form-grid",children:[n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"거래처번호"}),n.jsx(Rt,{value:e.customerId||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"거래처명"}),n.jsx(Rt,{value:e.customerName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"정식명"}),n.jsx(Rt,{value:e.customerFullName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"사업자번호"}),n.jsx(Rt,{value:e.bizNo||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"대표자명"}),n.jsx(Rt,{value:e.ownerName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"고객유형"}),n.jsx(Rt,{value:e.customerTypeName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"시/도"}),n.jsx(Rt,{value:e.addrProvinceName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"시/군/구"}),n.jsx(Rt,{value:e.addrCityName||"",readOnly:!0})]}),n.jsxs("div",{className:"field row-2",children:[n.jsx("label",{children:"비고"}),n.jsx(Rt,{value:e.customerRemark||"",readOnly:!0})]})]})}):null,[e]);return n.jsxs("section",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:18},children:"영업활동"}),n.jsx("div",{className:"muted count-text"})]}),i,n.jsxs("section",{className:"card sales-activity-panel",style:{marginTop:12},children:[n.jsxs("div",{className:"tabs c360-tabs",children:[n.jsx("button",{className:r==="form"?"tab active":"tab",onClick:()=>a("form"),children:"영업활동 등록"}),n.jsx("button",{className:r==="list"?"tab active":"tab",onClick:()=>a("list"),children:"영업활동"})]}),n.jsx("div",{className:"sales-activity-content",children:r==="form"?n.jsx(ya,{bare:!0}):n.jsx(kd,{customerSeq:(()=>{try{const s=localStorage.getItem("tnt.sales.selectedCustomer");if(s){const o=JSON.parse(s);return Number(o==null?void 0:o.customerSeq)||0}}catch{}return 0})(),customerId:(()=>{try{const s=localStorage.getItem("tnt.sales.selectedCustomer");if(s){const o=JSON.parse(s);return String((o==null?void 0:o.customerId)||"")}}catch{}return""})(),hideRefresh:!0,enableContextMenu:!0})})]})]})}function ig({customerSeq:e}){const[t,r]=c.useState([]),[a,i]=c.useState(!1),[s,o]=c.useState(null),[l,d]=c.useState([]);async function h(){o(null),i(!0);try{const x=e??(()=>{try{const w=localStorage.getItem("tnt.sales.selectedCustomer");if(w){const P=JSON.parse(w);return Number(P==null?void 0:P.customerSeq)}}catch{}})();if(!x||Number.isNaN(x)){r([]),d([]),i(!1);return}const v=new URL(`/api/v1/customers/${x}/transactions`,window.location.origin),g=await fetch(v.toString());if(!g.ok){let w=`HTTP ${g.status}`;try{const P=await g.json();P!=null&&P.error&&(w=P.error)}catch{}throw new Error(w)}const b=await g.json(),y=Array.isArray(b)?b:[];r(y);let N=[];if(y.length>0){const w=new Map;y.forEach(P=>{const _=P.minorName||"na",$=w.get(_)||{qty:0,amt:0};$.qty+=Number(P.qty??P.qty??0)||0,$.amt+=Number(P.curAmt||0)||0,w.set(_,$)}),N=Array.from(w.entries()).map(([P,_])=>({name:P,qty:_.qty,amt:_.amt})),N.sort((P,_)=>_.qty-P.qty||_.amt-P.amt),d(N)}else d([]);const A=await fetch(`/api/v1/customers/${x}/transactions/summary`);let E=[];if(A.ok)try{const w=await A.json();E=(Array.isArray(w)?w:[]).map(P=>({name:P.minorName||"na",qty:Number(P.qty||0),amt:Number(P.amt||0)}))}catch{E=[]}E.sort((w,P)=>P.qty-w.qty||P.amt-w.amt),E.length>0&&d(E)}catch(x){o(x.message||"조회 중 오류가 발생했습니다")}finally{i(!1)}}c.useEffect(()=>{h()},[e]);const u=c.useMemo(()=>{const x=[...l];return x.sort((v,g)=>g.qty-v.qty||g.amt-v.amt),x},[l]),f=c.useMemo(()=>{const x=[...l];return x.sort((v,g)=>g.amt-v.amt||g.qty-v.qty),x},[l]);function m({data:x,type:v}){const b={top:10,right:10,bottom:60,left:10},y=Math.max(360,x.length*80),N=y-b.left-b.right,A=180-b.top-b.bottom,E=Math.max(1,...x.map(P=>P.value)),w=N/Math.max(1,x.length);return n.jsx("div",{style:{overflowX:"auto"},children:n.jsx("svg",{width:y,height:180,children:n.jsx("g",{transform:`translate(${b.left},${b.top})`,children:x.map((P,_)=>{const $=_*w+w*.15,L=w*.7,j=Math.max(0,P.value/E*A),S=A-j;return n.jsxs("g",{transform:`translate(${$},0)`,children:[n.jsx("rect",{x:0,y:S,width:L,height:j,fill:v==="amt"?"#4e79a7":"#f28e2b"}),n.jsx("text",{x:L/2,y:A+14,fontSize:11,textAnchor:"middle",fill:"var(--muted)",transform:`rotate(25 ${L/2},${A+14})`,children:P.name}),n.jsx("text",{x:L/2,y:S-4,fontSize:11,textAnchor:"middle",fill:"var(--text)",children:P.value.toLocaleString()})]},_)})})})})}const p=c.useMemo(()=>n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:6},children:n.jsxs("div",{className:"muted count-text",children:["총 ",t.length,"건"]})}),t.length>0&&n.jsxs("div",{className:"card",style:{padding:12,marginBottom:8},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[n.jsx("b",{children:"중분류별 금액/수량"}),n.jsx("span",{className:"muted",style:{fontSize:12},children:"가로축: 중분류"})]}),n.jsxs("div",{style:{marginTop:8},children:[n.jsxs("div",{style:{marginBottom:12},children:[n.jsx("div",{className:"muted",style:{marginBottom:4},children:"금액"}),n.jsx(m,{type:"amt",data:f.map(x=>({name:x.name,value:x.amt}))})]}),n.jsxs("div",{children:[n.jsx("div",{className:"muted",style:{marginBottom:4},children:"수량"}),n.jsx(m,{type:"qty",data:u.map(x=>({name:x.name,value:x.qty}))})]})]})]}),n.jsx("div",{className:"table-container",children:t.length===0?n.jsx("div",{className:"empty-state",children:"거래 내역이 없습니다."}):n.jsxs("table",{className:"table transactions",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:160},children:"전표번호"}),n.jsx("th",{style:{width:160},children:"중분류"}),n.jsx("th",{children:"품목명"}),n.jsx("th",{style:{width:100,textAlign:"right"},children:"수량"}),n.jsx("th",{style:{width:160,textAlign:"right"},children:"금액"}),n.jsx("th",{style:{width:140},children:"전표일자"})]})}),n.jsx("tbody",{children:(()=>{let x="",v="",g="";const b=[];return t.forEach((y,N)=>{const A=y.invoiceNo!==x;let E="",w="",P="",_;A?(N>0&&b.push(n.jsx("tr",{className:"sep-row",children:n.jsx("td",{colSpan:6})},`sep-${N}`)),E=y.invoiceNo,w=y.invoiceDate,P=y.minorName||"na",_=void 0,x=y.invoiceNo,v=y.invoiceDate,g=y.minorName):(y.invoiceDate!==v&&(w=y.invoiceDate,v=y.invoiceDate),y.minorName!==g&&(P=y.minorName||"na",g=y.minorName),_="same-invoice"),b.push(n.jsxs("tr",{className:_,children:[n.jsx("td",{className:"col-invno",children:E}),n.jsx("td",{children:P}),n.jsx("td",{children:y.itemName}),n.jsx("td",{style:{textAlign:"right"},children:Number(y.qty??y.qty??0).toLocaleString()}),n.jsx("td",{style:{textAlign:"right"},children:Number(y.curAmt||0).toLocaleString()}),n.jsx("td",{className:"col-invdate",children:w?(()=>{const $=new Date(w);if(isNaN($.getTime()))return w;const L=String($.getFullYear()%100).padStart(2,"0"),j=String($.getMonth()+1).padStart(2,"0"),S=String($.getDate()).padStart(2,"0"),R=String($.getHours()).padStart(2,"0"),O=String($.getMinutes()).padStart(2,"0");return`${L}-${j}-${S} ${R}:${O}`})():""})]},`row-${N}`))}),b})()})]})})]}),[t]);return n.jsxs("div",{children:[n.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:s&&n.jsx("span",{className:"error",children:s})}),p]})}function e1(e){if(e==null)return"";const t=Number(e);return isFinite(t)?`${(t<=1?t*100:t).toLocaleString(void 0,{maximumFractionDigits:2})}%`:""}function sg({customerName:e,refreshTick:t=0}){const[r,a]=c.useState([]),[i,s]=c.useState(!1),[o,l]=c.useState(null);async function d(){if(e!=null&&e.trim()){s(!0),l(null);try{const u=new URLSearchParams({customer:e,limit:"1000"}),f=await fetch(`/api/v1/demand?${u.toString()}`);if(!f.ok){const x=await f.json().catch(()=>({}));throw new Error((x==null?void 0:x.error)||`HTTP ${f.status}`)}const p=(await f.json()||[]).map(x=>({itemSubcategory:x.itemSubcategory??null,supplierName:x.supplierName??null,salesMgmtUnit:x.salesMgmtUnit??null,shareRate:x.shareRate??null}));a(p)}catch(u){l(u.message||"로드 중 오류가 발생했습니다")}finally{s(!1)}}}c.useEffect(()=>{d()},[e,t]);const h=c.useMemo(()=>{const u=new Set,f=new Set,m=new Map;for(const v of r){const g=v.itemSubcategory||"-",b=`${v.supplierName||"-"}|${v.salesMgmtUnit||"-"}`;u.add(g),f.add(b);const y=`${g}::${b}`;m.set(y,v.shareRate)}const p=Array.from(u).sort((v,g)=>v.localeCompare(g)),x=Array.from(f).sort((v,g)=>v.localeCompare(g));return{rows:p,cols:x,cell:m}},[r]);return n.jsxs("section",{children:[i&&n.jsx("div",{className:"muted",style:{marginBottom:8},children:"불러오는 중…"}),o&&n.jsx("div",{className:"error",style:{marginTop:8},children:o}),n.jsx("div",{className:"table-container",style:{marginTop:8,border:"1px solid var(--border)",borderRadius:8},children:n.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"separate",borderSpacing:0},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{position:"sticky",left:0,background:"var(--bg)",textAlign:"left",padding:"8px 10px",zIndex:1},children:"중분류"}),h.cols.map(u=>{const[f,m]=u.split("|");return n.jsxs("th",{style:{textAlign:"center",padding:"8px 10px",whiteSpace:"nowrap"},children:[n.jsx("div",{children:f}),n.jsx("div",{className:"muted",style:{fontSize:12},children:m})]},u)})]})}),n.jsx("tbody",{children:h.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:Math.max(1,h.cols.length+1),className:"muted",style:{padding:"12px 10px"},children:i?"불러오는 중…":"데이터가 없습니다"})}):h.rows.map(u=>n.jsxs("tr",{children:[n.jsx("td",{style:{position:"sticky",left:0,background:"var(--bg)",padding:"8px 10px"},children:u}),h.cols.map(f=>{const m=`${u}::${f}`,p=h.cell.get(m)??null;return n.jsx("td",{style:{textAlign:"right",padding:"8px 10px"},children:e1(p)},f)})]},u))})]})})]})}function t1(e){if(e==null)return 0;const t=Number(e);return isFinite(t)?t<=1?t*100:t:0}const Ei=["#4e79a7","#f28e2b","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab","#1f77b4","#ff7f0e"];function n1({data:e,size:t=140}){const r=t/2,a=r,i=r,s=e.filter(h=>(h.value||0)>0),o=s.reduce((h,u)=>h+Math.max(0,u.value),0)||1;if(s.length===1)return n.jsx("svg",{width:t,height:t,viewBox:`0 0 ${t} ${t}`,children:n.jsx("circle",{cx:a,cy:i,r,fill:Ei[0],stroke:"#0b1324",strokeWidth:1})});let l=-Math.PI/2;const d=s.map((h,u)=>{const p=Math.max(0,h.value)/o*Math.PI*2,x=a+r*Math.cos(l),v=i+r*Math.sin(l),g=a+r*Math.cos(l+p),b=i+r*Math.sin(l+p),y=p>Math.PI?1:0,N=`M ${a} ${i} L ${x} ${v} A ${r} ${r} 0 ${y} 1 ${g} ${b} Z`;return l+=p,{path:N,color:Ei[u%Ei.length],label:h.label,value:h.value}});return n.jsx("svg",{width:t,height:t,viewBox:`0 0 ${t} ${t}`,children:d.map((h,u)=>n.jsx("path",{d:h.path,fill:h.color,stroke:"#0b1324",strokeWidth:1},u))})}function og({customerName:e,refreshTick:t=0}){const[r,a]=c.useState([]),[i,s]=c.useState(!1),[o,l]=c.useState(null);async function d(){s(!0),l(null);try{const u=new URLSearchParams({customer:e,limit:"1000"}),f=await fetch(`/api/v1/demand?${u.toString()}`);if(!f.ok){const x=await f.json().catch(()=>({}));throw new Error((x==null?void 0:x.error)||`HTTP ${f.status}`)}const p=(await f.json()||[]).map(x=>({itemSubcategory:x.itemSubcategory??null,supplierName:x.supplierName??null,salesMgmtUnit:x.salesMgmtUnit??null,shareRate:x.shareRate??null}));a(p)}catch(u){l(u.message||"로드 중 오류가 발생했습니다")}finally{s(!1)}}c.useEffect(()=>{e&&d()},[e,t]);const h=c.useMemo(()=>{const u=new Map;for(const f of r){const m=f.itemSubcategory||"-",p=`${f.supplierName||"-"} / ${f.salesMgmtUnit||"-"}`,x=t1(f.shareRate);u.has(m)||u.set(m,[]);const v=u.get(m),g=v.find(b=>b.label===p);g?g.value+=x:v.push({label:p,value:x})}for(const[f,m]of u)m.sort((p,x)=>x.value-p.value);return u},[r]);return e?n.jsxs("section",{className:"card",style:{marginTop:12},children:[i&&n.jsx("div",{className:"muted",children:lt.loading}),o&&n.jsx("div",{className:"error",children:o||lt.errorGeneric}),!i&&!o&&n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16},children:[Array.from(h.entries()).map(([u,f])=>n.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",border:"1px solid var(--border)",borderRadius:12,padding:12,width:"calc((100% - 16px) / 2)"},children:[n.jsx("div",{style:{flex:"0 0 auto"},children:n.jsx(n1,{data:f})}),n.jsxs("div",{style:{flex:1,minWidth:0},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6,fontSize:13},children:u}),n.jsxs("div",{style:{fontSize:12},children:[f.slice(0,8).map((m,p)=>n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[n.jsx("span",{style:{width:10,height:10,borderRadius:2,background:Ei[p%Ei.length],display:"inline-block"}}),n.jsx("span",{style:{minWidth:160},children:m.label}),n.jsxs("span",{style:{color:"var(--muted)"},children:[m.value.toLocaleString(void 0,{maximumFractionDigits:2}),"%"]})]},p)),f.length>8&&n.jsxs("div",{className:"muted",children:["외 ",f.length-8,"개…"]})]})]})]},u)),h.size===0&&n.jsx("div",{className:"empty-state",children:"데이터가 없습니다"})]})]}):null}function lg({customerName:e,customerSeq:t,empSeq:r,empName:a,onSuccess:i}){const[s,o]=c.useState([]),[l,d]=c.useState([]),[h,u]=c.useState([]),[f,m]=c.useState(""),[p,x]=c.useState(""),[v,g]=c.useState(""),[b,y]=c.useState(""),[N,A]=c.useState({subcats:!1,suppliers:!1,units:!1,submit:!1}),[E,w]=c.useState(null),[P,_]=c.useState(null);c.useEffect(()=>{async function j(){A(S=>({...S,subcats:!0})),w(null);try{const S=await fetch("/api/v1/supplier/subcategories");if(!S.ok)throw new Error(`HTTP ${S.status}`);const R=await S.json();o(R||[])}catch(S){w(S.message||"중분류 목록을 불러오지 못했습니다")}finally{A(S=>({...S,subcats:!1}))}}j()},[]),c.useEffect(()=>{if(x(""),d([]),g(""),u([]),!f)return;async function j(){A(S=>({...S,suppliers:!0})),w(null);try{const S=new URLSearchParams({subcategory:f}),R=await fetch(`/api/v1/supplier/names?${S.toString()}`);if(!R.ok)throw new Error(`HTTP ${R.status}`);const O=await R.json();d(O||[])}catch(S){w(S.message||"공급사 목록을 불러오지 못했습니다")}finally{A(S=>({...S,suppliers:!1}))}}j()},[f]),c.useEffect(()=>{if(g(""),u([]),!f||!p)return;async function j(){A(S=>({...S,units:!0})),w(null);try{const S=new URLSearchParams({subcategory:f,supplier:p}),R=await fetch(`/api/v1/supplier/units?${S.toString()}`);if(!R.ok)throw new Error(`HTTP ${R.status}`);const O=await R.json();u(O||[])}catch(S){w(S.message||"영업관리단위를 불러오지 못했습니다")}finally{A(S=>({...S,units:!1}))}}j()},[f,p]);const $=c.useMemo(()=>{if(!b)return"";const j=Number(b);if(!isFinite(j))return"숫자를 입력하세요";const S=j<=1?j*100:j;return lt.hint.sharePreview(S)},[b]);async function L(){if(_(null),w(null),!f||!p||!v){w("중분류/공급사/영업관리단위를 선택하세요");return}const j=Number(b);if(!isFinite(j)||j<=0){w("점유율을 올바르게 입력하세요");return}A(S=>({...S,submit:!0}));try{const S={customerSeq:t,customerName:e||void 0,empSeq:r&&r>0?r:void 0,empName:a||void 0,itemSubcategory:f,supplierName:p,salesMgmtUnit:v,share:j},R=await fetch("/api/v1/demand/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)}),O=await R.json().catch(()=>({}));if(!R.ok)throw new Error((O==null?void 0:O.error)||`HTTP ${R.status}`);_("등록되었습니다"),i&&i()}catch(S){w(S.message||"등록 중 오류가 발생했습니다")}finally{A(S=>({...S,submit:!1}))}}return n.jsxs("section",{style:{marginTop:16},children:[n.jsx("h3",{style:{marginTop:0},children:"수요등록"}),n.jsxs("div",{className:"card",style:{padding:12},children:[n.jsxs("div",{className:"form-grid",style:{gridTemplateColumns:"1fr 1fr 1fr 1fr"},children:[n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"중분류"}),n.jsxs("select",{value:f,onChange:j=>m(j.target.value),children:[n.jsx("option",{value:"",children:"선택하세요"}),s.map(j=>n.jsx("option",{value:j,children:j},j))]}),N.subcats&&n.jsx("div",{className:"muted",style:{marginTop:4},children:"불러오는 중…"})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"공급사"}),n.jsxs("select",{value:p,onChange:j=>x(j.target.value),disabled:!f||N.suppliers,children:[n.jsx("option",{value:"",children:"선택하세요"}),l.map(j=>n.jsx("option",{value:j,children:j},j))]})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"영업관리단위"}),n.jsxs("select",{value:v,onChange:j=>g(j.target.value),disabled:!f||!p||N.units,children:[n.jsx("option",{value:"",children:"선택하세요"}),h.map(j=>n.jsx("option",{value:j,children:j},j))]})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"점유율(%)"}),n.jsx(Rt,{value:b,onChange:j=>y(j),placeholder:"예: 0.25 또는 25"}),$&&n.jsx("div",{className:"muted",style:{marginTop:4},children:$})]})]}),E&&n.jsx("div",{className:"error",style:{marginTop:8},children:E||lt.errorGeneric}),P&&n.jsx("div",{className:"muted",style:{marginTop:8},children:P}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:n.jsx("button",{className:"btn",onClick:L,disabled:N.submit,children:N.submit?lt.fetching:e?`${e}에 ${lt.action.register}`:lt.action.register})})]})]})}const cg=[{value:"Credit / Receivable",label:"신용·채권"},{value:"Pricing / Terms",label:"가격·조건"},{value:"Quality / Claim",label:"품질·클레임"},{value:"Logistics / Delivery",label:"물류·납기"},{value:"Contract / Legal",label:"계약·법무"},{value:"Relationship / Strategic",label:"관계·전략"},{value:"Operational",label:"운영 이슈"},{value:"기타",label:"기타"}],r1=e=>{if(!e)return"미정";const t=cg.find(r=>r.value===e);return(t==null?void 0:t.label)??e},Kf={noteTitle:"",noteContent:"",noteType:"",importanceLevel:1},a1=e=>{try{const t=new Date(e),r=String(t.getFullYear()).slice(-2),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}catch{return e}},Gf=e=>e==null?"중요도 미정":["하","중","상"][Math.min(Math.max(e,0),2)];function i1({customerSeq:e,customerId:t,empName:r}){const[a,i]=c.useState([]),[s,o]=c.useState(!1),[l,d]=c.useState(null),[h,u]=c.useState(0),[f,m]=c.useState(!1),[p,x]=c.useState(!1),[v,g]=c.useState(null),[b,y]=c.useState(()=>({...Kf})),[N,A]=c.useState(null),E=c.useMemo(()=>typeof window>"u"?"":localStorage.getItem("tnt.sales.assigneeId")??"",[]),[w,P]=c.useState(null),[_,$]=c.useState(null),[L,j]=c.useState(!1);c.useEffect(()=>{if(!t){d("고객 ID가 없어 특이사항을 불러올 수 없습니다."),i([]);return}let H=!1;async function q(){o(!0),d(null);try{const C=await fetch(`/api/v1/customers/${t}/special-notes`);if(!C.ok)throw new Error(`HTTP ${C.status}`);const T=await C.json();if(H)return;const W=Array.isArray(T)?T:[];W.sort((I,U)=>new Date(U.updatedAt??U.createdAt).getTime()-new Date(I.updatedAt??I.createdAt).getTime()),i(W)}catch(C){if(H)return;d(C.message||"특이사항을 불러오지 못했습니다."),i([])}finally{H||o(!1)}}return q(),()=>{H=!0}},[t,h]);const S=async H=>{if(H.preventDefault(),!t)return;x(!0),g(null);const q=N!=null,C=E||"system";try{const T={customerId:t,customerSeq:e,noteTitle:b.noteTitle.trim()||"특이사항",noteContent:b.noteContent.trim(),noteType:b.noteType||void 0,importanceLevel:b.importanceLevel},W=q?`/api/v1/customers/${t}/special-notes/${N.id}`:`/api/v1/customers/${t}/special-notes`,I=q?"PUT":"POST";q||(T.createdBy=C),T.updatedBy=C;const U=await fetch(W,{method:I,headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(!U.ok){const K=await U.json().catch(()=>null);throw new Error((K==null?void 0:K.error)||`HTTP ${U.status}`)}O(),u(K=>K+1)}catch(T){g(T.message||(q?"수정 중 오류가 발생했습니다.":"등록 중 오류가 발생했습니다."))}finally{x(!1)}};c.useEffect(()=>{if(!f)return;const H=q=>{q.key==="Escape"&&O()};return window.addEventListener("keydown",H),()=>window.removeEventListener("keydown",H)},[f]);const R=()=>y({...Kf}),O=()=>{m(!1),A(null),R(),g(null)},z=H=>{A(H??null),y({noteTitle:(H==null?void 0:H.noteTitle)??"",noteContent:(H==null?void 0:H.noteContent)??"",noteType:(H==null?void 0:H.noteType)??"",importanceLevel:(H==null?void 0:H.importanceLevel)??1}),g(null),m(!0)},Z=H=>{P(H)},ae=async()=>{if(!t||!w)return;const H=w;g(null),j(!0);try{const q=E||"system",C=await fetch(`/api/v1/customers/${t}/special-notes/${H.id}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({updatedBy:q})});if(!C.ok){const T=await C.json().catch(()=>null);throw new Error((T==null?void 0:T.error)||`HTTP ${C.status}`)}$("특이사항을 삭제했습니다."),i(T=>T.filter(W=>W.id!==H.id)),u(T=>T+1)}catch(q){g(q.message||"삭제 중 오류가 발생했습니다.")}finally{j(!1),P(null)}};c.useEffect(()=>{if(!_)return;const H=window.setTimeout(()=>$(null),4e3);return()=>window.clearTimeout(H)},[_]);const se=H=>H==null?"unknown":H>=2?"high":H===1?"medium":"low";return n.jsxs("div",{className:"special-notes",children:[n.jsx("header",{className:"special-notes-header",children:n.jsx("button",{className:"btn btn-card btn-3d",type:"button",onClick:()=>z(),children:"신규"})}),l?n.jsx("div",{className:"empty-state",children:l}):s?n.jsx("div",{className:"empty-state",children:"특이사항을 불러오는 중입니다…"}):a.length===0?n.jsx("div",{className:"empty-state",children:"등록된 특이사항이 없습니다."}):n.jsx("div",{className:"special-notes-list",children:a.map(H=>n.jsxs("article",{className:"special-note-card",children:[n.jsxs("div",{className:"note-actions",children:[n.jsx("button",{type:"button",className:"note-edit-button","aria-label":"특이사항 수정",onClick:()=>z(H),children:"✎"}),n.jsx("button",{type:"button",className:"note-delete-button","aria-label":"특이사항 삭제",onClick:()=>Z(H),children:"🗑"})]}),n.jsxs("div",{className:"note-top",children:[n.jsx("span",{className:`importance-dot level-${se(H.importanceLevel)}`,"aria-label":`중요도 ${Gf(H.importanceLevel)}`,children:Gf(H.importanceLevel)}),n.jsxs("div",{className:"note-meta-info",children:[n.jsx("span",{className:"note-type",children:r1(H.noteType)}),n.jsx("strong",{className:"note-date",children:a1(H.updatedAt??H.createdAt)})]})]}),n.jsx("strong",{className:"note-title",children:H.noteTitle||"특이사항"}),n.jsx("p",{className:"note-content",children:H.noteContent}),n.jsxs("div",{className:"special-note-meta",children:[n.jsxs("span",{className:"meta-pill",children:[n.jsx("span",{className:"meta-icon edit-icon","aria-hidden":"true",children:"✎"}),n.jsx("span",{children:"수정자"}),n.jsx("strong",{children:H.updatedByName||H.updatedBy||"-"})]}),n.jsxs("span",{className:"meta-pill",children:[n.jsx("span",{className:"meta-icon user-icon","aria-hidden":"true",children:"👤"}),n.jsx("span",{children:"등록자"}),n.jsx("strong",{children:H.createdByName||H.createdBy})]})]})]},H.id))}),f&&n.jsx("div",{className:"overlay-modal",role:"dialog","aria-modal":"true",children:n.jsxs("div",{className:"overlay-card",children:[n.jsx("button",{type:"button",className:"modal-close","aria-label":"닫기",onClick:O,children:"×"}),n.jsx("h4",{children:"특이사항 등록"}),n.jsxs("form",{className:"special-note-form",onSubmit:S,children:[n.jsxs("label",{children:[n.jsx("span",{children:"제목"}),n.jsx("input",{type:"text",value:b.noteTitle,onChange:H=>y(q=>({...q,noteTitle:H.target.value})),placeholder:"예: 신용이슈",required:!0})]}),n.jsxs("label",{children:[n.jsx("span",{children:"유형"}),n.jsxs("select",{value:b.noteType,onChange:H=>y(q=>({...q,noteType:H.target.value})),children:[n.jsx("option",{value:"",children:"선택 안 함"}),cg.map(H=>n.jsx("option",{value:H.value,children:H.label},H.value))]})]}),n.jsxs("label",{children:[n.jsx("span",{children:"중요도"}),n.jsxs("select",{value:b.importanceLevel,onChange:H=>y(q=>({...q,importanceLevel:Number(H.target.value)})),children:[n.jsx("option",{value:2,children:"상"}),n.jsx("option",{value:1,children:"중"}),n.jsx("option",{value:0,children:"하"})]})]}),n.jsxs("label",{children:[n.jsx("span",{children:"내용"}),n.jsx("textarea",{value:b.noteContent,onChange:H=>y(q=>({...q,noteContent:H.target.value})),rows:4,required:!0})]}),v?n.jsx("div",{className:"empty-state",children:v}):null,n.jsxs("footer",{children:[n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>m(!1),disabled:p,children:"취소"}),n.jsx("button",{type:"submit",className:"btn btn-card btn-3d",disabled:p,children:p?"등록 중…":"등록"})]})]})]})}),_&&n.jsxs("div",{className:"toast-message",children:[n.jsx("span",{children:_}),n.jsx("button",{type:"button",onClick:()=>$(null),children:"×"})]}),w&&n.jsx("div",{className:"confirm-overlay",role:"dialog","aria-modal":"true",children:n.jsxs("div",{className:"confirm-card",children:[n.jsxs("p",{children:[n.jsx("strong",{children:w.noteTitle||"특이사항"}),"을(를) 삭제하시겠습니까?",n.jsx("br",{}),"삭제하면 되돌릴 수 없습니다."]}),n.jsxs("div",{className:"confirm-actions",children:[n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>P(null),disabled:L,children:"취소"}),n.jsx("button",{type:"button",className:"btn btn-card btn-3d",onClick:ae,disabled:L,children:L?"삭제 중…":"삭제"})]})]})})]})}function s1(){const[e,t]=c.useState(()=>{try{const u=localStorage.getItem("tnt.sales.selectedCustomer");return u?JSON.parse(u):null}catch{return null}}),[r,a]=c.useState("transactions"),[i,s]=c.useState(0),[o,l]=c.useState(null);c.useEffect(()=>{try{const u=localStorage.getItem("tnt.sales.selectedCustomer");t(u?JSON.parse(u):null)}catch{t(null)}},[]),c.useEffect(()=>{const u=()=>{try{const f=localStorage.getItem("tnt.sales.selectedCustomer");t(f?JSON.parse(f):null)}catch{t(null)}};return window.addEventListener("tnt.sales.customer.selected",u),()=>window.removeEventListener("tnt.sales.customer.selected",u)},[]),c.useEffect(()=>{const u=f=>{var v;const m=((v=f==null?void 0:f.detail)==null?void 0:v.customer)||e,p=(m==null?void 0:m.customerId)??(m==null?void 0:m.customer_id),x=(m==null?void 0:m.customerName)??(m==null?void 0:m.customer_name);l({sfAccountId:p?String(p):void 0,customerName:x})};return window.addEventListener("tnt.sales.activity.create.inline",u),()=>window.removeEventListener("tnt.sales.activity.create.inline",u)},[e]),c.useEffect(()=>{if(!o)return;const u=f=>{f.key==="Escape"&&(f.preventDefault(),f.stopPropagation(),l(null))};return window.addEventListener("keydown",u,!0),()=>window.removeEventListener("keydown",u,!0)},[o]);const d=c.useMemo(()=>n.jsx(Nd,{compact:!0,maxHeight:"32vh",context:"c360"}),[]),h=()=>!e||e.customerSeq==null?n.jsx("div",{className:"empty-state",children:"거래처를 선택하세요."}):r==="transactions"?n.jsx(ig,{customerSeq:e.customerSeq}):r==="activities"?n.jsx(kd,{customerSeq:e.customerSeq,customerId:e.customerId||"",hideRefresh:!0,enableContextMenu:!0}):r==="demand"?e.customerName?n.jsxs("div",{className:"c360-demand-stack",children:[n.jsx(sg,{customerName:e.customerName,refreshTick:i}),n.jsx(og,{customerName:e.customerName,refreshTick:i}),n.jsx(lg,{customerName:e.customerName,customerSeq:e.customerSeq,empSeq:e.empSeq,empName:e.empName||void 0,onSuccess:()=>s(u=>u+1)})]}):n.jsx("div",{className:"empty-state",children:"수요정보를 보려면 거래처명을 확인하세요."}):r==="special-notes"?n.jsx(i1,{customerSeq:e.customerSeq,customerId:e.customerId,empName:e.empName}):r==="complaint"?n.jsx("div",{className:"card",style:{padding:12},children:n.jsx("div",{className:"muted",children:"Complaint 기능은 추후 제공될 예정입니다."})}):null;return n.jsxs("section",{className:"c360",children:[d,n.jsxs("section",{className:"card c360-panel",style:{marginTop:12,minHeight:240},children:[n.jsxs("div",{className:"tabs c360-tabs",children:[n.jsx("button",{className:r==="transactions"?"tab active":"tab",onClick:()=>a("transactions"),children:"거래 내역"}),n.jsx("button",{className:r==="activities"?"tab active":"tab",onClick:()=>a("activities"),children:"영업활동"}),n.jsx("button",{className:r==="demand"?"tab active":"tab",onClick:()=>a("demand"),children:"수요정보"}),n.jsx("button",{className:r==="special-notes"?"tab active":"tab",onClick:()=>a("special-notes"),children:"특이사항"}),n.jsx("button",{className:r==="complaint"?"tab active":"tab",onClick:()=>a("complaint"),children:"Complaint"})]}),n.jsx("div",{className:`c360-tab-panel-wrapper ${r==="demand"?"c360-demand-scroll":""}`,children:n.jsx("div",{className:"c360-tab-panel",children:h()})})]}),o&&n.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",zIndex:120,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>l(null),children:n.jsxs("div",{className:"card",style:{width:"min(920px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:u=>u.stopPropagation(),children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[n.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"영업활동 등록"}),n.jsx("button",{onClick:()=>l(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:u=>{u.currentTarget.style.background="var(--panel-2)",u.currentTarget.style.color="var(--text)"},onMouseLeave:u=>{u.currentTarget.style.background="transparent",u.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)","aria-label":"닫기",children:"×"})]}),n.jsx(ya,{bare:!0,initial:o,onSaved:()=>{l(null);try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated"))}catch{}},onNoticeClose:()=>l(null)})]})})]})}function dg({open:e,onClose:t,leadId:r,leadName:a,targetKind:i,targetCompanyType:s,editId:o,initial:l,onSaved:d}){const{ref:h,style:u,bindHeader:f,bindContainer:m}=wn("lead.activity",e,E=>{const w=document.querySelector(".pane.center"),P=w?w.getBoundingClientRect():null,_=E.getBoundingClientRect(),$=_.width,L=_.height,j=P?P.left+(P.width-$)/2:(window.innerWidth-$)/2,S=P?P.top+Math.max(24,(P.height-L)*.2):Math.max(24,(window.innerHeight-L)*.2);return{x:j,y:S}},{persist:!1,resetOnOpen:!0});c.useEffect(()=>{if(!e)return;const E=w=>{w.key==="Escape"&&t()};return window.addEventListener("keydown",E,!0),()=>window.removeEventListener("keydown",E,!0)},[e,t]);const p=c.useCallback(()=>{o||t()},[o,t]),x=i||(r?"lead":void 0),v=(()=>{const E=(a??"").toString().trim();return E||((l==null?void 0:l.customerName)??"").toString().trim()})(),g=(s??"").toString().trim().toUpperCase(),b=x==="lead"?"잠":g.includes("TNT")?"T":g.includes("DYS")?"D":g?g.slice(0,1):"거",y=x==="lead"?"잠재고객":g||"거래처",N=x?n.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:22,height:22,borderRadius:"50%",fontSize:12,fontWeight:700,background:x==="lead"?"rgba(236,72,153,.2)":"rgba(59,130,246,.2)",color:x==="lead"?"#be185d":"#1d4ed8"},title:y,children:b}):null,A=o?"영업활동":"영업활동 등록";return e?n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:11e3,pointerEvents:"none"},children:[n.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)",pointerEvents:"none"}}),n.jsxs("div",{ref:h,className:"card",style:{...u,width:"min(880px, 96vw)",maxHeight:"86vh",overflow:"auto",padding:16,pointerEvents:"auto"},...m,children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6,cursor:"move"},...f,children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[n.jsx("h3",{style:{margin:0},children:A}),v||N?n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13,fontWeight:600,color:"var(--text)"},children:[v?n.jsx("span",{children:v}):null,N]}):null]}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:t,children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})})]}),n.jsx(ya,{bare:!0,editId:o??void 0,leadId:r??void 0,initial:l,onNoticeClose:p,onSaved:E=>{d?d():t()}})]})]}):null}function gi(e){if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return"";const r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}function vs(e,t=0){if(!e)return;const r=e.trim();if(!r)return;const[a,i,s]=r.split("-").map(l=>Number(l));if(!a||!i||!s)return;const o=new Date(a,i-1,s,t,0,0,0);if(!isNaN(o.getTime()))return o.toISOString()}function Vf(e){if(e.type==="customer"){const t=(e.companyType??"").toString().trim(),r=t||"거래처",a=t.toUpperCase(),i=a.includes("TNT")?"T":a.includes("DYS")?"D":(a||"거")[0];return{label:r,bg:"rgba(59,130,246,.12)",color:"#1d4ed8",icon:i,iconBg:"#1d4ed8"}}return{label:"잠재",bg:"rgba(236,72,153,.12)",color:"#be185d",icon:"잠",iconBg:"#be185d"}}function o1({onClose:e,prefillAt:t}){const[r,a]=Ae.useState(""),[i,s]=Ae.useState([]),[o,l]=Ae.useState(!1),[d,h]=Ae.useState(null),[u,f]=Ae.useState([]),[m,p]=Ae.useState(null);async function x(){l(!0),h(null);try{const y=new URL("/api/v1/customers",window.location.origin);y.searchParams.set("mineOnly","false"),r.trim()&&y.searchParams.set("name",r.trim()),y.searchParams.set("limit","100");try{console.debug("[customer search]",y.toString())}catch{}const N=await fetch(y.toString());if(!N.ok)throw new Error(`HTTP ${N.status}`);const A=await N.json(),E=Array.isArray(A)?A.map(w=>({customerSeq:(w==null?void 0:w.customerSeq)??(w==null?void 0:w.customer_seq)??null,customerId:(w==null?void 0:w.customerId)??(w==null?void 0:w.customer_id)??null,customerName:(w==null?void 0:w.customerName)??(w==null?void 0:w.customer_name)??null,ownerName:(w==null?void 0:w.ownerName)??(w==null?void 0:w.owner_name)??null,companyType:(w==null?void 0:w.companyType)??(w==null?void 0:w.company_type)??null})).sort((w,P)=>String(w.customerName||"").localeCompare(String(P.customerName||""),"ko-KR")):[];s(E)}catch(y){h((y==null?void 0:y.message)||"조회 실패"),s([])}finally{l(!1)}}function v(y){f(N=>{const E=N.some(w=>(w.customerId||"")===(y.customerId||""))?N:[y,...N];return!m&&E.length>0&&b(E[0]),E})}function g(y){if(f(N=>N.filter(A=>(A.customerId||"")!==(y.customerId||""))),m&&(m.customerId||"")===(y.customerId||"")){const N=u.filter(A=>(A.customerId||"")!==(y.customerId||""));b(N[0]||null)}}function b(y){p(y||null);try{y&&localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify({customerId:y.customerId||"",customerName:y.customerName||""}))}catch{}}return Ae.useEffect(()=>{const y=N=>{N.key==="Escape"&&e()};return window.addEventListener("keydown",y,!0),()=>window.removeEventListener("keydown",y,!0)},[e]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:12e3},children:[n.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"6%",left:"50%",transform:"translateX(-50%)",width:"min(1200px,96vw)",maxHeight:"88vh",overflow:"auto",padding:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[n.jsx("h3",{style:{margin:0},children:"거래처 활동계획수립"}),n.jsx("button",{className:"btn-plain","aria-label":"닫기",title:"닫기",onClick:e,style:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),n.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:12,minHeight:520,alignItems:"start"},children:[n.jsxs("div",{className:"card",style:{padding:12,overflow:"auto"},children:[n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"거래처명",value:r,onChange:y=>a(y.target.value),onKeyDown:y=>{y.key==="Enter"&&x()},style:{flex:"0 0 220px",height:28,fontSize:12}}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button",title:"조회","aria-label":"조회",onClick:x,children:n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:[n.jsx("circle",{cx:"11",cy:"11",r:"8"}),n.jsx("path",{d:"m21 21-4.35-4.35"})]})})]}),n.jsx("div",{className:"table-container",style:{maxHeight:240,overflowY:"auto",overflowX:"hidden",fontSize:12},children:i.length===0?n.jsx("div",{className:"empty-state",children:o?"불러오는 중…":d||"검색 결과가 없습니다"}):n.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:100},children:"회사구분"}),n.jsx("th",{style:{width:180},children:"거래처명"}),n.jsx("th",{style:{width:120},children:"대표자명"}),n.jsx("th",{style:{width:48}})]})}),n.jsx("tbody",{children:i.map((y,N)=>n.jsxs("tr",{children:[n.jsx("td",{title:y.companyType||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.companyType||""}),n.jsx("td",{title:y.customerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.customerName||""}),n.jsx("td",{title:y.ownerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.ownerName||""}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx("span",{role:"button",tabIndex:0,className:"icon-button",title:"계획수립대상 담기","aria-label":"계획수립대상 담기",onClick:()=>v(y),children:n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:[n.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),n.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})})]},N))})]})}),n.jsxs("div",{style:{marginTop:12,fontWeight:700},children:["계획수립대상(",u.length,")"]}),n.jsx("div",{className:"table-container",style:{maxHeight:220,overflowY:"auto",overflowX:"hidden",fontSize:12},children:u.length===0?n.jsx("div",{className:"empty-state",children:"담긴 거래처가 없습니다."}):n.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:100},children:"회사구분"}),n.jsx("th",{style:{width:180},children:"거래처명"}),n.jsx("th",{style:{width:120},children:"대표자명"}),n.jsx("th",{style:{width:60},children:"작업"})]})}),n.jsx("tbody",{children:u.map((y,N)=>n.jsxs("tr",{className:m&&(m.customerId||"")===(y.customerId||"")?"selected":"",onClick:()=>b(y),children:[n.jsx("td",{title:y.companyType||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.companyType||""}),n.jsx("td",{title:y.customerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.customerName||""}),n.jsx("td",{title:y.ownerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.ownerName||""}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx("span",{role:"button",tabIndex:0,className:"icon-button",title:"삭제","aria-label":"삭제",onClick:A=>{A.stopPropagation(),g(y)},children:n.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:n.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})})})]},N))})]})})]}),n.jsxs("div",{className:"card plan-compact-card",style:{overflow:"auto"},children:[!m&&n.jsx("div",{className:"empty-state",children:"좌측에서 거래처를 선택해 주세요."}),n.jsx(ya,{bare:!0,initial:{plannedStartAt:t||void 0,...m?{sfAccountId:m.customerId||"",customerName:m.customerName||"",subject:m!=null&&m.customerName?`${m.customerName} (활동계획) 으로 저장됩니다.`:""}:{}},lockSubject:!0,planMode:!0,multiTargets:u})]})]})]})]})}function l1(e){const t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=t.getDay()||7;return r!==1&&t.setDate(t.getDate()-(r-1)),t.setHours(0,0,0,0),t}function c1(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),r=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-r);const a=new Date(Date.UTC(t.getUTCFullYear(),0,1)),i=Math.ceil(((t.getTime()-a.getTime())/864e5+1)/7);return{year:t.getUTCFullYear(),week:i}}function d1(e){const t=e.getFullYear(),r=e.getMonth()+1;return`${t}년 ${r}월`}function u1(e){return String(e.getDate())}const f1=Array.from({length:24},(e,t)=>t),$a=60,Xf=18,Vl=18;function h1(){const[e,t]=Ae.useState(()=>new Date),r=Ae.useMemo(()=>c1(e),[e]),a=Ae.useMemo(()=>l1(e),[e]),i=Ae.useMemo(()=>{const re=new Date(a);return re.setDate(a.getDate()+6),re.setHours(23,59,59,999),re},[a]),s=Ae.useMemo(()=>Array.from({length:7}).map((re,xe)=>{const ve=new Date(a);return ve.setDate(a.getDate()+xe),ve}),[a]),o=Ae.useRef(null),[l,d]=Ae.useState(()=>({open:!1,x:0,y:0})),h=Ae.useRef(null),[u,f]=Ae.useState(!1),[m,p]=Ae.useState(!1),[x,v]=Ae.useState([]),[g,b]=Ae.useState(""),[y,N]=Ae.useState([]),[A,E]=Ae.useState(""),[w,P]=Ae.useState(""),[_,$]=Ae.useState(""),[L,j]=Ae.useState(""),[S,R]=Ae.useState(""),[O,z]=Ae.useState(""),[Z,ae]=Ae.useState(""),[se,H]=Ae.useState(!1),[q,C]=Ae.useState(null),[T,W]=Ae.useState(null),[I,U]=Ae.useState(null),[K,Y]=Ae.useState(""),[M,D]=Ae.useState([]),[oe,F]=Ae.useState(!1),[G,de]=Ae.useState(null),[be,ke]=Ae.useState([]),[ye,Ce]=Ae.useState(null),[J,ge]=Ae.useState([]),[Ee,we]=Ae.useState([]),[He,mt]=Ae.useState(null),[vt,Ot]=Ae.useState(null),[pt,Xt]=Ae.useState(""),[Ke,gt]=Ae.useState(null),[Qe,_t]=Ae.useState(""),[rn,vn]=Ae.useState(void 0),[Xe,An]=Ae.useState(!1),ta=Ae.useRef(null),xn=Ae.useMemo(()=>{const re=new Array(24).fill(0).map(()=>$a);if(!J||J.length===0)return re;const xe=new Array(24).fill(0),ve=new Date(a.getFullYear(),a.getMonth(),a.getDate());for(let Le=0;Le<24;Le++){let ue=0;for(let De=0;De<7;De++){const Ne=new Date(ve);Ne.setDate(Ne.getDate()+De);const Fe=Ne.getFullYear(),qe=Ne.getMonth(),Ge=Ne.getDate(),Ue=J.reduce((Ct,st)=>{if(!st.plannedStartAt)return Ct;const rt=new Date(st.plannedStartAt);return rt.getFullYear()===Fe&&rt.getMonth()===qe&&rt.getDate()===Ge&&rt.getHours()===Le?Ct+1:Ct},0);Ue>ue&&(ue=Ue)}xe[Le]=ue}for(let Le=0;Le<24;Le++){const ue=Math.max(0,xe[Le]-1);re[Le]=Math.min($a+ue*Vl,$a+64)}return re},[J,a]),hn=Ae.useMemo(()=>{const re=[0];for(let xe=0;xe<24;xe++)re[xe+1]=re[xe]+(xn[xe]||$a);return re},[xn]),an=Ae.useCallback(async()=>{try{const re=localStorage.getItem("tnt.sales.assigneeId")||"",xe=localStorage.getItem("tnt.sales.empId")||"",ve=new URL("/api/v1/sales-activities",window.location.origin);re?ve.searchParams.set("assigneeId",re):xe&&ve.searchParams.set("empId",xe),ve.searchParams.set("mineOnly","true"),ve.searchParams.set("start",a.toISOString()),ve.searchParams.set("end",i.toISOString()),ve.searchParams.set("onlyRoot","true"),ve.searchParams.set("_t",Date.now().toString());const Le=await fetch(ve.toString(),{cache:"no-cache"});if(!Le.ok)throw new Error(`HTTP ${Le.status}`);const ue=await Le.json(),De=Array.isArray(ue)?ue:[];ge(De.map(Ne=>{const Fe=Ne.plannedStartAt||Ne.planned_start_at,qe=(Ne.activityStatus||Ne.activity_status||"").toString().toLowerCase(),Ge=qe==="completed"||qe==="완료";return{id:Number(Ne.id),subject:Ne.subject,description:Ne.description,activityType:Ne.activityType||Ne.activity_type,activityStatus:Ne.activityStatus||Ne.activity_status,channel:Ne.channel,plannedStartAt:Fe?new Date(Fe).toISOString():void 0,plannedEndAt:Ne.plannedEndAt||Ne.planned_end_at||null,actualStartAt:Ne.actualStartAt||Ne.actual_start_at||void 0,sfAccountId:Ne.sfAccountId||Ne.sf_account_id||void 0,customerName:Ne.customerName||Ne.customer_name||"",leadId:Ne.sfLeadId||Ne.sf_lead_id||null,companyType:Ne.companyType||Ne.company_type||Ne.companyTypeName||Ne.company_type_name||null,isCompleted:Ge}}))}catch{ge([])}},[a,i]),Yn=Ae.useCallback(async()=>{try{const re=localStorage.getItem("tnt.sales.assigneeId")||localStorage.getItem("tnt.sales.empId")||"";if(!re){we([]);return}const xe=new URL("/api/v1/region-activity-plans",window.location.origin);xe.searchParams.set("assigneeId",re),xe.searchParams.set("start",a.toISOString()),xe.searchParams.set("end",i.toISOString());const ve=await fetch(xe.toString());if(!ve.ok)throw new Error(`HTTP ${ve.status}`);const Le=await ve.json(),ue=Array.isArray(Le)?Le:[];we(ue.map(De=>({id:Number(De.id),subject:De.subject,plannedStartAt:De.planned_start_at||De.plannedStartAt||null,plannedEndAt:De.planned_end_at||De.plannedEndAt||null,actualStartAt:De.actual_start_at||De.actualStartAt||null,actualEndAt:De.actual_end_at||De.actualEndAt||null,isCompleted:!!(De.actual_start_at||De.actualStartAt||De.actual_end_at||De.actualEndAt)})))}catch{we([])}},[a,i]);Ae.useEffect(()=>{an()},[an]),Ae.useEffect(()=>{Yn()},[Yn]),Ae.useEffect(()=>{const re=()=>{try{an()}catch{}};return window.addEventListener("tnt.sales.activity.updated",re),()=>window.removeEventListener("tnt.sales.activity.updated",re)},[an]);const Ta=`${r.week}주차`,Oa=d1(e),At=Ae.useCallback(()=>{t(re=>{const xe=new Date(re);return xe.setDate(xe.getDate()-7),xe})},[]),er=Ae.useCallback(()=>{t(re=>{const xe=new Date(re);return xe.setDate(xe.getDate()+7),xe})},[]),ci=Ae.useCallback(()=>{t(new Date)},[]);Ae.useEffect(()=>{function re(ve){let Le=ve;for(;Le;){const ue=(Le.tagName||"").toLowerCase();if(["input","textarea","select","button","label","a"].includes(ue)||Le!=null&&Le.isContentEditable)return!0;Le=Le.parentElement}return!1}function xe(ve){const Le=ve.target;re(Le)||re(document.activeElement)||(ve.key==="ArrowLeft"?(ve.preventDefault(),At()):ve.key==="ArrowRight"&&(ve.preventDefault(),er()))}return window.addEventListener("keydown",xe,!0),()=>window.removeEventListener("keydown",xe,!0)},[At,er]);const tr=Ae.useRef(!1);Ae.useEffect(()=>{if(tr.current)return;const re=o.current;if(!re)return;const xe=hn[7]||7*$a;let ve=0;const Le=30,ue=()=>{if(re){if(re.scrollTop=xe,ve+=1,Math.abs(re.scrollTop-xe)<2||ve>=Le){tr.current=!0;return}setTimeout(()=>requestAnimationFrame(ue),50)}};requestAnimationFrame(ue)},[hn]),Ae.useEffect(()=>{if(!l.open)return;const re=ve=>{const Le=(ve==null?void 0:ve.target)||null;h.current&&Le&&h.current.contains(Le)||d({open:!1,x:0,y:0})},xe=ve=>{ve.key==="Escape"&&re()};return window.addEventListener("click",re,!0),window.addEventListener("contextmenu",re,!0),window.addEventListener("keydown",xe,!0),()=>{window.removeEventListener("click",re,!0),window.removeEventListener("contextmenu",re,!0),window.removeEventListener("keydown",xe,!0)}},[l.open]);const nr=Ae.useCallback(async()=>{try{const re=await fetch("/api/v1/address/provinces"),xe=re.ok?await re.json():[],ve=Array.isArray(xe)?xe.filter(Boolean):[];v(ve)}catch{v([])}},[]),bn=Ae.useCallback(async re=>{try{if(!re){N([]);return}const xe=new URL("/api/v1/address/districts",window.location.origin);xe.searchParams.set("province",re);const ve=await fetch(xe.toString()),Le=ve.ok?await ve.json():[],ue=Array.isArray(Le)?Le.filter(Boolean):[];N(ue)}catch{N([])}},[]),Kn=Ae.useCallback(()=>{P(""),$(""),j(""),R(""),z(""),ae(""),C(null),ke([]),U(null)},[]),Ze=Ae.useCallback(()=>{Kn();const re=ye?gi(ye):"";j(re),b(""),E(""),N([]),p(!0),nr()},[ye,nr,Kn]),Mn=Ae.useCallback(()=>{Kn(),W(null),p(!1)},[Kn]);Ae.useEffect(()=>{if(!m)return;const re=xe=>{xe.key==="Escape"&&(xe.preventDefault(),Mn())};return window.addEventListener("keydown",re,!0),()=>window.removeEventListener("keydown",re,!0)},[m,Mn]);const na=Ae.useCallback(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||localStorage.getItem("tnt.sales.empId")||""}catch{return""}},[]);Ae.useEffect(()=>{if(!m||w&&w.trim().length>0||!g)return;const re=A?`${g} ${A}`:g;P(`${re} 지역활동`)},[m,w,g,A]);async function fr(re){try{const xe=await fetch(`/api/v1/region-activity-plans/${re}`);if(!xe.ok)throw new Error(`HTTP ${xe.status}`);const ve=await xe.json();Kn(),U(re),P((ve==null?void 0:ve.subject)||""),$((ve==null?void 0:ve.description)||"");const Le=(ve==null?void 0:ve.addrProvinceName)||(ve==null?void 0:ve.addr_province_name)||"",ue=(ve==null?void 0:ve.addrDistrictName)||(ve==null?void 0:ve.addr_district_name)||"";await nr(),b(Le),Le?await bn(Le):N([]),E(ue),j(ve!=null&&ve.planned_start_at?gi(ve.planned_start_at):""),R(ve!=null&&ve.planned_end_at?gi(ve.planned_end_at):""),z(ve!=null&&ve.actual_start_at?gi(ve.actual_start_at):""),ae(ve!=null&&ve.actual_end_at?gi(ve.actual_end_at):"");const De=Array.isArray(ve==null?void 0:ve.targets)?ve.targets:[];ke(De.map((Ne,Fe)=>{const qe=(Ne==null?void 0:Ne.customerId)||(Ne==null?void 0:Ne.customer_id)||"",Ge=(Ne==null?void 0:Ne.leadId)||(Ne==null?void 0:Ne.lead_id)||"",Ue=qe?"customer":"lead";return{key:qe?`customer-${qe}`:Ge?`lead-${Ge}`:`target-${Fe}-${re}`,type:Ue,name:(Ne==null?void 0:Ne.displayName)||(Ne==null?void 0:Ne.display_name)||qe||Ge||"(대상)",companyType:(Ne==null?void 0:Ne.companyType)||(Ne==null?void 0:Ne.company_type)||null,customerId:qe||void 0,leadId:Ge||void 0}})),p(!0)}catch(xe){window.alert((xe==null?void 0:xe.message)||"지역활동 계획을 불러오지 못했습니다.")}}async function di(){const re=w.trim();if(!re){C("제목을 입력해 주세요."),W(null);return}if(!g){C("방문 도(Province)를 선택해 주세요."),W(null);return}if(!A){C("방문 시/군/구(District)를 선택해 주세요."),W(null);return}const xe=na().trim();if(!xe){C("담당자 정보를 확인할 수 없습니다. 다시 로그인해 주세요."),W(null);return}const ve={subject:re,addrProvinceName:g,addrDistrictName:A,assigneeId:xe},Le=_==null?void 0:_.trim();Le&&(ve.description=Le);const ue=vs(L,8),De=vs(S);ue&&(ve.plannedStartAt=ue),De&&(ve.plannedEndAt=De);const Ne=vs(O),Fe=vs(Z);Ne&&(ve.actualStartAt=Ne),Fe&&(ve.actualEndAt=Fe);const qe=be.map(Ue=>Ue.type==="customer"&&Ue.customerId?{customerId:Ue.customerId}:Ue.type==="lead"&&Ue.leadId?{leadId:Ue.leadId}:null).filter(Boolean);qe.length>0&&(ve.targets=qe);const Ge=Number(xe);Number.isNaN(Ge)||(I||(ve.createdBy=Ge),ve.updatedBy=Ge),H(!0),C(null),W(null);try{const Ue=I?`/api/v1/region-activity-plans/${I}`:"/api/v1/region-activity-plans",st=await fetch(Ue,{method:I?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ve)});let rt=null;try{rt=await st.json()}catch{rt=null}if(!st.ok){const Qt=(rt==null?void 0:rt.message)||(rt==null?void 0:rt.error)||`HTTP ${st.status}`;throw new Error(Qt)}W(I?"지역활동 계획이 수정되었습니다.":"지역활동 계획이 등록되었습니다."),C(null),await Yn()}catch(Ue){C((Ue==null?void 0:Ue.message)||"등록에 실패했습니다."),W(null)}finally{H(!1)}}async function hr(){const re=K.trim();if(!re){de("검색어를 입력해 주세요."),D([]);return}F(!0),de(null);try{const[xe,ve]=await Promise.all([(async()=>{const ue=new URL("/api/v1/customers",window.location.origin);ue.searchParams.set("mineOnly","false"),ue.searchParams.set("limit","50"),ue.searchParams.set("name",re);const De=await fetch(ue.toString());if(!De.ok)throw new Error(`거래처 조회 실패 (HTTP ${De.status})`);const Ne=await De.json();return Array.isArray(Ne)?Ne:[]})(),(async()=>{const ue=new URL("/api/v1/leads",window.location.origin);ue.searchParams.set("limit","50"),ue.searchParams.set("company_name",re);const De=await fetch(ue.toString());if(!De.ok)throw new Error(`잠재고객 조회 실패 (HTTP ${De.status})`);const Ne=await De.json();return Array.isArray(Ne)?Ne:[]})()]),Le=[...xe.map((ue,De)=>{const Ne=(ue==null?void 0:ue.customerId)??(ue==null?void 0:ue.customer_id)??(ue==null?void 0:ue.customerSeq)??(ue==null?void 0:ue.customer_seq)??"",Fe=Ne!=null?String(Ne).trim():"",qe=Fe?`customer-${Fe}`:`customer-${De}-${Math.random().toString(36).slice(2)}`,Ge=(ue==null?void 0:ue.companyType)??(ue==null?void 0:ue.company_type)??(ue==null?void 0:ue.companyTypeName)??(ue==null?void 0:ue.company_type_name)??(ue==null?void 0:ue.companyClass)??(ue==null?void 0:ue.company_class)??(ue==null?void 0:ue.companyGroup)??(ue==null?void 0:ue.company_group)??null;return{key:qe,type:"customer",name:(ue==null?void 0:ue.customerName)??(ue==null?void 0:ue.customer_name)??"(이름 없음)",companyType:Ge!=null?String(Ge):null,customerId:Fe||void 0}}),...ve.map((ue,De)=>{const Ne=(ue==null?void 0:ue.id)??(ue==null?void 0:ue.lead_id)??"",Fe=Ne!=null?String(Ne).trim():"";return{key:Fe?`lead-${Fe}`:`lead-${De}-${Math.random().toString(36).slice(2)}`,type:"lead",name:(ue==null?void 0:ue.company_name)??(ue==null?void 0:ue.companyName)??(ue==null?void 0:ue.contact_name)??"(이름 없음)",leadId:Fe||void 0}})];D(Le),Le.length===0&&de("조회 결과가 없습니다.")}catch(xe){de((xe==null?void 0:xe.message)||"조회에 실패했습니다."),D([])}finally{F(!1)}}function ra(re){ke(xe=>xe.some(ve=>ve.key===re.key)?xe:[...xe,re])}function rr(re){ke(xe=>xe.filter(ve=>ve.key!==re))}const aa=Ae.useCallback(re=>{mt(re.id);const xe=re.leadId?"lead":"customer";ta.current!==re.id?(Ot(re.leadId??null),Xt(re.customerName||""),gt(xe),_t(xe==="customer"&&re.companyType||""),vn({id:re.id,subject:re.subject,description:re.description,activityType:re.activityType,activityStatus:re.activityStatus,channel:re.channel,plannedStartAt:re.plannedStartAt,actualStartAt:re.actualStartAt,sfAccountId:re.sfAccountId,customerName:re.customerName}),ta.current=re.id):gt(xe),An(!0)},[]),it=Ae.useCallback(()=>{An(!1),mt(null),Ot(null),Xt(""),gt(null),_t(""),vn(void 0),ta.current=null},[]),Mt=Ae.useMemo(()=>{const re=J.length,xe=J.filter(Fe=>Fe.isCompleted).length,ve=Ee.length,Le=Ee.filter(Fe=>Fe.isCompleted).length,ue=re+ve,De=xe+Le,Ne=ue>0?Math.round(De/ue*100):0;return{customerTotal:re,customerCompleted:xe,regionTotal:ve,regionCompleted:Le,totalPlanned:ue,totalCompleted:De,achievementRate:Ne}},[J,Ee]);return n.jsxs("section",{className:"activity-plan-page",children:[n.jsx("div",{className:"card",style:{padding:"12px 16px",marginBottom:12,flexShrink:0},children:n.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[n.jsx("button",{onClick:At,title:"이전 주",style:{width:32,height:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"var(--text)",transition:"background-color 0.2s"},onMouseEnter:re=>re.currentTarget.style.backgroundColor="var(--hover)",onMouseLeave:re=>re.currentTarget.style.backgroundColor="transparent",children:n.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:n.jsx("polyline",{points:"15 18 9 12 15 6"})})}),n.jsx("button",{onClick:er,title:"다음 주",style:{width:32,height:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"var(--text)",transition:"background-color 0.2s"},onMouseEnter:re=>re.currentTarget.style.backgroundColor="var(--hover)",onMouseLeave:re=>re.currentTarget.style.backgroundColor="transparent",children:n.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:n.jsx("polyline",{points:"9 18 15 12 9 6"})})}),n.jsx("button",{className:"btn",onClick:ci,style:{marginLeft:4},children:"오늘"}),n.jsxs("span",{className:"badge",style:{marginLeft:"auto"},children:[Oa," ",Ta]})]})}),n.jsxs("div",{className:"activity-kpi-grid",children:[n.jsxs("div",{className:"card kpi-card",style:{background:"linear-gradient(135deg, rgba(59,130,246,0.1) 0%, rgba(147,51,234,0.1) 100%)"},children:[n.jsx("div",{className:"kpi-label",children:"주간 달성률"}),n.jsxs("div",{className:"kpi-value",children:[n.jsx("span",{className:"kpi-number",children:Mt.achievementRate}),n.jsx("span",{className:"kpi-unit",children:"%"})]}),n.jsxs("div",{className:"kpi-desc",children:["목표 ",Mt.totalPlanned,"건 / 완료 ",Mt.totalCompleted,"건"]})]}),n.jsxs("div",{className:"card kpi-card",children:[n.jsx("div",{className:"kpi-label",children:"거래처 활동"}),n.jsxs("div",{className:"kpi-stats",children:[n.jsxs("div",{children:[n.jsx("div",{className:"kpi-stat-label",style:{color:"#dc2626"},children:"목표"}),n.jsx("div",{className:"kpi-stat-value",style:{color:"#dc2626"},children:Mt.customerTotal})]}),n.jsx("div",{className:"kpi-arrow",children:"→"}),n.jsxs("div",{children:[n.jsx("div",{className:"kpi-stat-label",style:{color:"#2563eb"},children:"완료"}),n.jsx("div",{className:"kpi-stat-value",style:{color:"#2563eb"},children:Mt.customerCompleted})]})]}),n.jsx("div",{className:"kpi-progress",children:n.jsx("div",{style:{width:`${Mt.customerTotal>0?Mt.customerCompleted/Mt.customerTotal*100:0}%`,background:"linear-gradient(90deg, #dc2626 0%, #2563eb 100%)"}})})]}),n.jsxs("div",{className:"card kpi-card",children:[n.jsx("div",{className:"kpi-label",children:"지역 활동"}),n.jsxs("div",{className:"kpi-stats",children:[n.jsxs("div",{children:[n.jsx("div",{className:"kpi-stat-label",style:{color:"#dc2626"},children:"목표"}),n.jsx("div",{className:"kpi-stat-value",style:{color:"#dc2626"},children:Mt.regionTotal})]}),n.jsx("div",{className:"kpi-arrow",children:"→"}),n.jsxs("div",{children:[n.jsx("div",{className:"kpi-stat-label",style:{color:"#10b981"},children:"완료"}),n.jsx("div",{className:"kpi-stat-value",style:{color:"#10b981"},children:Mt.regionCompleted})]})]}),n.jsx("div",{className:"kpi-progress",children:n.jsx("div",{style:{width:`${Mt.regionTotal>0?Mt.regionCompleted/Mt.regionTotal*100:0}%`,background:"linear-gradient(90deg, #dc2626 0%, #10b981 100%)"}})})]})]}),n.jsxs("div",{className:"card",style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",minHeight:0},children:[n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px repeat(7, 1fr)",background:"var(--panel)",borderBottom:"1px solid var(--border)",flex:"0 0 auto"},children:[n.jsx("div",{style:{padding:8,fontSize:12,color:"var(--text-muted)"},children:"시간"}),s.map((re,xe)=>n.jsx("div",{style:{padding:8,textAlign:"center",borderLeft:xe>0?"1px solid var(--border)":"none"},children:n.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[["월","화","수","목","금","토","일"][xe]," ",u1(re)]})},xe))]}),n.jsx("div",{ref:o,className:"calendar-scroll",onContextMenu:re=>{re.preventDefault();const xe=re.target;let ve=null,Le=null;const ue=Fe=>{var st,rt;if(!Fe)return!1;const qe=Fe.getAttribute("data-day")||((st=Fe.dataset)==null?void 0:st.day),Ge=Fe.getAttribute("data-hour")||((rt=Fe.dataset)==null?void 0:rt.hour),Ue=qe?parseInt(qe,10):NaN,Ct=Ge?parseInt(Ge,10):NaN;return!Number.isNaN(Ue)&&!Number.isNaN(Ct)?(ve=Ue,Le=Ct,!0):!1},De=xe?xe.closest(".week-event"):null,Ne=xe?xe.closest(".week-cell"):null;if(!(ue(De)||ue(Ne))){const Fe=o.current;if(Fe){const qe=Fe.getBoundingClientRect(),Ge=re.clientX-qe.left,Ue=re.clientY-qe.top+Fe.scrollTop,Ct=Ge-60,st=Math.max(1,(qe.width-60)/7),rt=Math.floor(Ct/st);let mr=0;for(let Qt=0;Qt<24&&Ue>=hn[Qt];Qt++)mr=Qt;rt>=0&&rt<=6&&mr>=0&&mr<=23&&(ve=rt,Le=mr)}}if(ve!=null&&Le!=null){const Fe=new Date(a);Fe.setDate(Fe.getDate()+ve),Fe.setHours(Le,0,0,0),Ce(new Date(Fe).toISOString())}d({open:!0,x:re.clientX,y:re.clientY})},style:{flex:1,overflowY:"scroll",overflowX:"hidden",minHeight:0},children:n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px repeat(7, 1fr)",gridTemplateRows:xn.map(re=>`${re}px`).join(" "),position:"relative"},children:[f1.map(re=>n.jsxs(Ae.Fragment,{children:[n.jsxs("div",{style:{gridColumn:"1",gridRow:`${re+1}`,height:xn[re]||$a,padding:"4px 8px",fontSize:11,color:"var(--text-muted)",borderTop:"1px solid var(--border)"},children:[String(re).padStart(2,"0"),":00"]}),s.map((xe,ve)=>n.jsx("div",{className:"week-cell","data-day":ve,"data-hour":re,style:{gridColumn:`${ve+2}`,gridRow:`${re+1}`,borderTop:"1px solid var(--border)",borderLeft:"1px solid var(--border)"}},`${re}-${ve}`))]},re)),(()=>{const re=new Map,xe=J.map(ue=>{if(!ue.plannedStartAt)return null;const De=new Date(ue.plannedStartAt),Ne=Math.floor((new Date(De.getFullYear(),De.getMonth(),De.getDate()).getTime()-new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime())/864e5);if(Ne<0||Ne>6)return null;const Fe=De.getHours(),qe=`${Ne}-${Fe}`,Ge=re.get(qe)||0;re.set(qe,Ge+1);const Ue=ue.isCompleted?"(완)":"(계)",Ct=ue.isCompleted?"#2563eb":"#dc2626";return n.jsxs("div",{className:"week-event","data-day":Ne,"data-hour":Fe,onDoubleClick:st=>{st.stopPropagation(),aa(ue)},style:{gridColumn:`${Ne+2}`,gridRow:`${Fe+1}`,height:Xf,padding:"0 6px",fontSize:10,background:"rgba(59,130,246,.12)",border:"1px solid var(--accent)",borderRadius:6,margin:1,marginTop:Ge*Vl,display:"flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left"},title:ue.subject||"",children:[n.jsx("span",{style:{color:Ct,fontWeight:700,marginRight:4},children:Ue}),n.jsx("span",{children:ue.subject||"(제목 없음)"})]},`ev-${ue.id}-${Ge}`)}),ve=new Date(a.getFullYear(),a.getMonth(),a.getDate()),Le=Ee.map(ue=>{if(!ue.plannedStartAt)return null;const De=new Date(ue.plannedStartAt);if(isNaN(De.getTime()))return null;const Ne=Math.floor((new Date(De.getFullYear(),De.getMonth(),De.getDate()).getTime()-ve.getTime())/864e5);if(Ne<0||Ne>6)return null;const Fe=De.getHours(),qe=`${Ne}-${Fe}`,Ge=re.get(qe)||0;re.set(qe,Ge+1);const Ue=ue.isCompleted||!!ue.actualEndAt,Ct=Ue?"(완)":"(계)",st=Ue?"#2563eb":"#dc2626";return n.jsxs("div",{className:"week-event","data-day":Ne,"data-hour":Fe,onDoubleClick:rt=>{rt.stopPropagation(),fr(ue.id)},style:{gridColumn:`${Ne+2}`,gridRow:`${Fe+1}`,height:Xf,padding:"0 6px",fontSize:10,background:"rgba(16,185,129,.18)",border:"1px solid rgba(16,185,129,.6)",borderRadius:6,margin:1,marginTop:Ge*Vl,display:"flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left"},title:ue.subject||"",children:[n.jsx("span",{style:{color:st,fontWeight:700,marginRight:4},children:Ct}),n.jsx("span",{children:ue.subject||"(지역활동)"})]},`region-${ue.id}-${Ne}-${Fe}-${Ge}`)}).filter(Boolean);return[...xe,...Le]})()]})})]}),l.open&&n.jsxs("div",{className:"context-menu",role:"menu",ref:h,style:{position:"fixed",left:l.x+6,top:l.y+6,zIndex:20050},children:[n.jsx("button",{className:"context-item",role:"menuitem",onClick:()=>{d({open:!1,x:0,y:0}),f(!0)},children:"거래처활동"}),n.jsx("button",{className:"context-item",role:"menuitem",onClick:()=>{d({open:!1,x:0,y:0}),Ze()},children:"지역활동"})]}),u&&n.jsx(o1,{onClose:()=>f(!1),prefillAt:ye}),m&&n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:13e3},children:[n.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),n.jsx("div",{style:{position:"absolute",top:"8%",left:"50%",transform:"translateX(-50%)",width:"min(920px,96vw)",maxHeight:"84vh"},children:n.jsxs("div",{className:"card plan-compact-card",style:{height:"100%",overflow:"auto",padding:12,position:"relative"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[n.jsx("h3",{style:{margin:0},children:"지역활동 계획"}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:Mn,children:n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:[n.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),n.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0,1fr) minmax(0,380px)",gap:12},children:[n.jsxs("div",{className:"plan-compact",style:{display:"flex",flexDirection:"column",gap:8},children:[n.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[n.jsx("label",{children:"제목"}),n.jsx("input",{className:"subject-input",value:w,onChange:re=>P(re.target.value),placeholder:"예: 서울 강남구 지역활동"})]}),n.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[n.jsx("label",{children:"도 선택"}),n.jsxs("select",{value:g,onChange:re=>{const xe=re.target.value;b(xe),E(""),bn(xe)},style:{height:32},children:[n.jsx("option",{value:"",children:"— 선택 —"}),x.map((re,xe)=>n.jsx("option",{value:re,children:re},`${re}-${xe}`))]})]}),n.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[n.jsx("label",{children:"시군 선택"}),n.jsxs("select",{value:A,onChange:re=>E(re.target.value),disabled:!g,style:{height:32},children:[n.jsx("option",{value:"",children:"— 선택 —"}),y.map((re,xe)=>n.jsx("option",{value:re,children:re},`${re}-${xe}`))]})]}),n.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[n.jsx("label",{children:"계획 일정"}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:n.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[n.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:n.jsx("input",{className:"subject-input",type:"date",value:L,onChange:re=>j(re.target.value),style:{flex:1}})}),n.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"~"}),n.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:n.jsx("input",{className:"subject-input",type:"date",value:S,onChange:re=>R(re.target.value),style:{flex:1}})})]})})]}),n.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[n.jsx("label",{children:"완료일"}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:n.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[n.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:n.jsx("input",{className:"subject-input",type:"date",value:O,onChange:re=>z(re.target.value),style:{flex:1}})}),n.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"~"}),n.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:n.jsx("input",{className:"subject-input",type:"date",value:Z,onChange:re=>ae(re.target.value),style:{flex:1}})})]})})]}),n.jsxs("div",{className:"field",style:{display:"flex",flexDirection:"column",gap:4},children:[n.jsx("label",{children:"활동계획/설명"}),n.jsx("textarea",{value:_,onChange:re=>$(re.target.value),placeholder:"방문 목적, 세부 활동계획, 비고 등을 입력해 주세요.",rows:4,style:{resize:"vertical",padding:8}})]})]}),n.jsxs("div",{className:"card",style:{padding:10,background:"var(--panel-2)",borderRadius:12,display:"flex",flexDirection:"column",gap:8,minHeight:0},children:[n.jsx("div",{style:{fontWeight:600,fontSize:13},children:"영업대상 조회/등록"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[n.jsx("input",{className:"subject-input",placeholder:"거래처 또는 잠재고객명으로 검색",value:K,onChange:re=>Y(re.target.value),onKeyDown:re=>{re.key==="Enter"&&(re.preventDefault(),hr())}}),n.jsx("button",{className:"btn",type:"button",onClick:hr,disabled:oe,children:"조회"})]}),n.jsx("div",{className:"table-container",style:{maxHeight:220,overflowY:"auto",overflowX:"hidden",background:"var(--panel)",borderRadius:8,padding:6},children:oe?n.jsx("div",{className:"empty-state",children:"조회 중…"}):M.length===0?n.jsx("div",{className:"empty-state",children:G||"조회 결과가 없습니다."}):M.map(re=>{const xe=Vf(re);return n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 4px",borderBottom:"1px solid var(--border)"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,minWidth:0},children:[n.jsx("span",{title:re.name,style:{fontSize:13,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:1},children:re.name}),n.jsx("span",{title:xe.label,style:{width:22,height:22,borderRadius:"50%",background:xe.bg,color:xe.color,fontWeight:700,display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:12},children:n.jsx("span",{style:{width:18,height:18,borderRadius:"50%",background:xe.iconBg,color:"#fff",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:11},children:xe.icon})})]}),n.jsx("button",{className:"btn-ghost",type:"button",onClick:()=>ra(re),style:{width:28,height:28,display:"inline-flex",alignItems:"center",justifyContent:"center",border:"none"},"aria-label":"등록",children:n.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})]},re.key)})}),n.jsxs("div",{style:{fontWeight:600,fontSize:12},children:["등록된 대상 (",be.length,")"]}),n.jsx("div",{className:"table-container",style:{maxHeight:140,overflowY:"auto",background:"var(--panel)",borderRadius:8,padding:6},children:be.length===0?n.jsx("div",{className:"empty-state",children:"등록된 대상이 없습니다."}):be.map(re=>{const xe=Vf(re);return n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 2px",borderBottom:"1px dashed var(--border)"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,minWidth:0},children:[n.jsx("span",{title:re.name,style:{fontSize:13,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:1},children:re.name}),n.jsx("span",{title:xe.label,style:{width:22,height:22,borderRadius:"50%",background:xe.bg,color:xe.color,fontWeight:700,display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:12},children:n.jsx("span",{style:{width:18,height:18,borderRadius:"50%",background:xe.iconBg,color:"#fff",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:11},children:xe.icon})})]}),n.jsx("button",{className:"btn-ghost",type:"button",onClick:()=>rr(re.key),style:{width:28,height:28,display:"inline-flex",alignItems:"center",justifyContent:"center",border:"none"},"aria-label":"삭제",children:n.jsx("span",{style:{fontSize:22,lineHeight:1},children:"−"})})]},`selected-${re.key}`)})})]})]}),q&&n.jsx("div",{style:{color:"#dc2626",fontSize:12,marginTop:8},children:q}),T&&n.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center",gap:8,border:"1px solid #10b981",background:"#ecfdf5",padding:"6px 10px",borderRadius:6},children:[n.jsx("span",{style:{color:"#047857",fontWeight:600},children:T}),n.jsx("button",{className:"btn btn-plain",type:"button",onClick:()=>W(null),style:{padding:"2px 8px",fontSize:12},children:"확인"})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[n.jsx("button",{className:"btn",type:"button",onClick:Mn,children:"취소"}),n.jsx("button",{className:"btn btn-accent",type:"button",onClick:di,disabled:se,children:se?"저장 중…":"저장"})]})]})})]}),n.jsx(dg,{open:Xe&&He!=null,onClose:it,editId:He??void 0,leadId:vt&&/^\d+$/.test(vt)?Number(vt):void 0,leadName:pt,targetKind:Ke??void 0,targetCompanyType:Qe||void 0,initial:rn,onSaved:()=>{setTimeout(()=>an(),50)}})]})}function m1(){const[e,t]=c.useState(()=>{try{const l=localStorage.getItem("tnt.sales.selectedCustomer");return l?JSON.parse(l):null}catch{return null}}),[r,a]=c.useState("transactions"),[i,s]=c.useState(0);c.useEffect(()=>{try{const l=localStorage.getItem("tnt.sales.selectedCustomer");t(l?JSON.parse(l):null)}catch{t(null)}},[]);const o=c.useMemo(()=>e?n.jsx("section",{className:"card compact-form",children:n.jsxs("div",{className:"form-grid",children:[n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"거래처번호"}),n.jsx(Rt,{value:e.customerId||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"거래처명"}),n.jsx(Rt,{value:e.customerName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"정식명"}),n.jsx(Rt,{value:e.customerFullName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"사업자번호"}),n.jsx(Rt,{value:e.bizNo||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"대표자명"}),n.jsx(Rt,{value:e.ownerName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"전화번호"}),n.jsx(Rt,{value:e.telNo||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"고객유형"}),n.jsx(Rt,{value:e.customerTypeName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"시/도"}),n.jsx(Rt,{value:e.addrProvinceName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"시/군/구"}),n.jsx(Rt,{value:e.addrCityName||"",readOnly:!0})]}),n.jsxs("div",{className:"field row-2",children:[n.jsx("label",{children:"비고"}),n.jsx(Rt,{value:e.customerRemark||"",readOnly:!0})]})]})}):n.jsx("div",{className:"empty-state",children:"선택된 거래처가 없습니다."}),[e]);return n.jsxs("section",{className:"c360",children:[n.jsx("div",{className:"page-title"}),o,n.jsxs("section",{className:"card",style:{marginTop:12,minHeight:240},children:[n.jsxs("div",{className:"tabs c360-tabs",children:[n.jsx("button",{className:r==="transactions"?"tab active":"tab",onClick:()=>a("transactions"),children:"거래 내역"}),n.jsx("button",{className:r==="activities"?"tab active":"tab",onClick:()=>a("activities"),children:"영업활동"}),n.jsx("button",{className:r==="demand"?"tab active":"tab",onClick:()=>a("demand"),children:"수요정보"})]}),n.jsxs("div",{style:{marginTop:12},children:[r==="transactions"&&(e==null?void 0:e.customerSeq)!=null&&n.jsx(ig,{customerSeq:e.customerSeq}),r==="activities"&&(e==null?void 0:e.customerSeq)!=null&&n.jsx(kd,{customerSeq:e.customerSeq,customerId:e.customerId||"",hideRefresh:!0,enableContextMenu:!0}),r==="demand"&&(e==null?void 0:e.customerName)&&n.jsxs(n.Fragment,{children:[n.jsx(sg,{customerName:e.customerName,refreshTick:i}),n.jsx(og,{customerName:e.customerName,refreshTick:i}),n.jsx(lg,{customerName:e.customerName,customerSeq:e.customerSeq,empSeq:e.empSeq,empName:e.empName||void 0,onSuccess:()=>s(l=>l+1)})]}),(!e||e.customerSeq==null)&&n.jsx("div",{className:"empty-state",children:"탭을 선택하세요"})]})]})]})}function xs(e){const t=new Date(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Qf(e,t){const r=new Date(e);return r.setMonth(r.getMonth()+t),r}function La(e,t){const r=new Date(e);return r.setDate(r.getDate()+t),r}function Xl(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function p1(){const[e,t]=c.useState(()=>xs(new Date)),r=new Date,[a,i]=c.useState([]),[s,o]=c.useState([]),[l,d]=c.useState(!1),[h,u]=c.useState(null),[f,m]=c.useState("month"),[p,x]=c.useState({open:!1,x:0,y:0,event:void 0,date:void 0}),[v,g]=c.useState(0),[b,y]=c.useState(null),[N,A]=c.useState(null),[E,w]=c.useState({open:!1}),P=c.useMemo(()=>{const q=[];if(f==="month"){const C=xs(e),T=C.getDay(),W=new Date(C);W.setDate(C.getDate()-T);for(let I=0;I<42;I++){const U=new Date(W);U.setDate(W.getDate()+I),q.push({date:U,inMonth:U.getMonth()===e.getMonth(),isToday:Xl(U,r)})}}else if(f==="week"){const C=new Date(e),T=C.getDay(),W=new Date(C);W.setDate(C.getDate()-T);for(let I=0;I<7;I++){const U=new Date(W);U.setDate(W.getDate()+I),q.push({date:U,inMonth:!0,isToday:Xl(U,r)})}}else{const C=new Date(e);q.push({date:C,inMonth:!0,isToday:Xl(C,r)})}return q},[e,f]),_=c.useMemo(()=>{const q=e.getFullYear(),C=String(e.getMonth()+1).padStart(2,"0"),T=String(e.getDate()).padStart(2,"0");if(f==="month")return`${q}.${C}`;if(f==="week"){const W=e.getDay(),I=La(new Date(e),-W),U=La(new Date(I),6),K=String(I.getMonth()+1).padStart(2,"0"),Y=String(I.getDate()).padStart(2,"0"),M=String(U.getMonth()+1).padStart(2,"0"),D=String(U.getDate()).padStart(2,"0");return`${q}.${K}.${Y} ~ ${U.getFullYear()}.${M}.${D}`}return`${q}.${C}.${T}`},[e,f]);c.useEffect(()=>{const q=localStorage.getItem("tnt.sales.assigneeId");if(!q){u("로그인이 필요합니다"),i([]),o([]),d(!1);return}u(null),d(!0),(async()=>{const C=[],T=new Date(P[0].date);T.setHours(0,0,0,0);const W=new Date(P[P.length-1].date);W.setHours(23,59,59,999);try{const I=new URL("/api/v1/sales-activities",window.location.origin);I.searchParams.set("mineOnly","true"),I.searchParams.set("assigneeId",String(q)),I.searchParams.set("start",T.toISOString()),I.searchParams.set("end",W.toISOString());const U=await fetch(I.toString());if(!U.ok){let M=`HTTP ${U.status}`;try{const D=await U.json();D!=null&&D.error&&(M=D.error)}catch{}throw new Error(M)}const K=await U.json(),Y=Array.isArray(K)?K.map(M=>({id:Number(M==null?void 0:M.id),subject:(M==null?void 0:M.subject)??void 0,customerName:(M==null?void 0:M.customerName)??(M==null?void 0:M.customer_name)??void 0,plannedStartAt:(M==null?void 0:M.plannedStartAt)??(M==null?void 0:M.planned_start_at)??void 0,plannedEndAt:(M==null?void 0:M.plannedEndAt)??(M==null?void 0:M.planned_end_at)??null,activityStatus:(M==null?void 0:M.activityStatus)??(M==null?void 0:M.activity_status)??void 0,leadId:(M==null?void 0:M.sfLeadId)??(M==null?void 0:M.sf_lead_id)??(M==null?void 0:M.leadId)??(M==null?void 0:M.lead_id)??null,source:"sales"})):[];i(Y)}catch(I){C.push((I==null?void 0:I.message)||"활동 조회 중 오류가 발생했습니다"),i([])}try{const I=new URL("/api/v1/region-activity-plans",window.location.origin);I.searchParams.set("assigneeId",String(q)),I.searchParams.set("start",T.toISOString()),I.searchParams.set("end",W.toISOString());const U=await fetch(I.toString());if(!U.ok)throw new Error(`HTTP ${U.status}`);const K=await U.json(),Y=Array.isArray(K)?K.map(M=>{const D=(M==null?void 0:M.plannedStartAt)??(M==null?void 0:M.planned_start_at)??null,oe=(M==null?void 0:M.plannedEndAt)??(M==null?void 0:M.planned_end_at)??null,F=!!(M!=null&&M.actualStartAt||M!=null&&M.actual_start_at||M!=null&&M.actualEndAt||M!=null&&M.actual_end_at),G=M!=null&&M.subject?`[지역] ${M.subject}`:"지역활동";return{id:Number(M==null?void 0:M.id),subject:G,plannedStartAt:D||void 0,plannedEndAt:oe||null,activityStatus:F?"completed":"region",leadId:null,source:"region"}}):[];o(Y)}catch(I){C.push((I==null?void 0:I.message)||"지역활동 조회 중 오류가 발생했습니다"),o([])}u(C.length?C.join(" / "):null),d(!1)})()},[e,f,P,v]);const $=c.useMemo(()=>{const q=new Map,C=[...a,...s];if(!C||C.length===0)return q;const T=new Date(P[0].date),W=new Date(P[P.length-1].date);W.setHours(23,59,59,999);for(const I of C){if(!I.plannedStartAt&&!I.plannedEndAt)continue;const U=I.plannedStartAt?new Date(I.plannedStartAt):null,K=I.plannedEndAt?new Date(I.plannedEndAt):U;if(!U)continue;const Y=U,M=K||U;if(M<T||Y>W)continue;const D=`${Y.getFullYear()}-${String(Y.getMonth()+1).padStart(2,"0")}-${String(Y.getDate()).padStart(2,"0")}`,oe=Y.toTimeString().slice(0,5),F=M.toTimeString().slice(0,5),G=q.get(D)||[];G.push({id:I.id,subject:I.subject,customerName:I.customerName,time:oe,endTime:F,status:I.activityStatus,start:Y,end:M,leadId:I.leadId??null,source:I.source}),q.set(D,G)}return q},[a,s,P]);function L(q){return q.getHours()*60+q.getMinutes()}function j(q){const C=Math.floor(q/60).toString().padStart(2,"0"),T=(q%60).toString().padStart(2,"0");return`${C}:${T}`}const S=Ae.useCallback(q=>{const C=new Date(q);C.setHours(0,0,0,0);const T=new Date(q);T.setHours(23,59,59,999);const W=[],I=[...a,...s];for(const U of I){const K=U.plannedStartAt?new Date(U.plannedStartAt):null,Y=U.plannedEndAt?new Date(U.plannedEndAt):K;if(!K)continue;const M=Y||K;if(M<C||K>T)continue;const D=K<C?C:K,oe=M>T?T:M;W.push({id:U.id,subject:U.subject,customerName:U.customerName,status:U.activityStatus,start:D,end:oe,leadId:U.leadId??null,source:U.source})}return W.sort((U,K)=>U.start.getTime()-K.start.getTime()),W},[a,s]),R=c.useCallback(()=>{x({open:!1,x:0,y:0,event:void 0,date:void 0})},[]);c.useEffect(()=>{if(!p.open)return;const q=T=>{T.target.closest(".context-menu")||R()},C=T=>{T.key==="Escape"&&R()};return window.addEventListener("click",q,!0),window.addEventListener("contextmenu",q,!1),window.addEventListener("keydown",C,!0),()=>{window.removeEventListener("click",q,!0),window.removeEventListener("contextmenu",q,!0),window.removeEventListener("keydown",C,!0)}},[p.open,R]);function O(q,C){C.source!=="region"&&(q.preventDefault(),q.stopPropagation(),x({open:!0,x:q.clientX,y:q.clientY,event:C,date:C.start}))}async function z(q){const C=q==null?void 0:q.id;if(C)try{const T=await fetch(`/api/v1/sales-activities/${C}`);if(!T.ok)throw new Error(`HTTP ${T.status}`);const W=await T.json(),I=(W==null?void 0:W.customerName)||(W==null?void 0:W.customer_name)||"";w({open:!0,event:q,customerName:I})}catch(T){console.error("활동 상세 조회 실패:",T),w({open:!0,event:q,customerName:""})}}async function Z(){var C;const q=(C=E.event)==null?void 0:C.id;if(!q){w({open:!1});return}try{const T=await fetch(`/api/v1/sales-activities/${q}`,{method:"DELETE"});if(!T.ok)throw new Error(`HTTP ${T.status}`);i(W=>W.filter(I=>I.id!==q));try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated",{detail:{id:q}}))}catch{}w({open:!1}),R()}catch(T){window.alert((T==null?void 0:T.message)||"삭제 중 오류가 발생했습니다"),w({open:!1})}}function ae(){w({open:!1})}c.useEffect(()=>{(f==="week"||f==="day")&&setTimeout(()=>{document.querySelectorAll(".day-timeline").forEach(q=>{q.scrollTop=7*40})},0)},[f,P]);async function se(q){q.source!=="region"&&q!=null&&q.id&&y(q.id)}c.useEffect(()=>{if(f!=="week")return;const q=Array.from(document.querySelectorAll(".day-timeline"));if(q.length===0)return;const C=T=>{const W=T.target,I=W.scrollTop;q.forEach(U=>{U!==W&&(U.scrollTop=I)})};return q.forEach(T=>T.addEventListener("scroll",C)),()=>q.forEach(T=>T.removeEventListener("scroll",C))},[f,P]),c.useEffect(()=>{if(!b)return;const q=C=>{C.key==="Escape"&&(C.preventDefault(),C.stopPropagation(),y(null))};return window.addEventListener("keydown",q,!0),()=>window.removeEventListener("keydown",q,!0)},[b]),c.useEffect(()=>{if(!N)return;const q=C=>{C.key==="Escape"&&(C.preventDefault(),C.stopPropagation(),A(null))};return window.addEventListener("keydown",q,!0),()=>window.removeEventListener("keydown",q,!0)},[N]);const H=c.useCallback((q,C)=>{const T=new Date(q);T.setHours(9,0,0,0);const W=K=>{const Y=K.getFullYear(),M=String(K.getMonth()+1).padStart(2,"0"),D=String(K.getDate()).padStart(2,"0"),oe=String(K.getHours()).padStart(2,"0"),F=String(K.getMinutes()).padStart(2,"0");return`${Y}-${M}-${D}T${oe}:${F}`},I=(C==null?void 0:C.customerId)??(C==null?void 0:C.customer_id)??void 0,U=(C==null?void 0:C.customerName)??(C==null?void 0:C.customer_name)??void 0;A({plannedStartAt:W(T),sfAccountId:I,customerName:U})},[]);return c.useEffect(()=>{const q=C=>{var I,U;const T=(I=C==null?void 0:C.detail)!=null&&I.date?new Date(C.detail.date):new Date,W=(U=C==null?void 0:C.detail)==null?void 0:U.customer;H(T,W)};return window.addEventListener("tnt.sales.calendar.create",q),window.addEventListener("tnt.sales.activity.create.inline",q),()=>{window.removeEventListener("tnt.sales.calendar.create",q),window.removeEventListener("tnt.sales.activity.create.inline",q)}},[H]),n.jsxs(n.Fragment,{children:[n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",children:[n.jsx("h2",{children:"일정"}),n.jsx("div",{className:"meta",children:n.jsx("button",{className:"btn",onClick:()=>t(xs(new Date)),children:"오늘"})})]}),n.jsxs("div",{className:"card",style:{padding:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("button",{className:"btn",onClick:()=>t(q=>f==="month"?Qf(q,-1):f==="week"?La(q,-7):La(q,-1)),children:"〈"}),n.jsx("div",{style:{fontWeight:700},children:_}),n.jsx("button",{className:"btn",onClick:()=>t(q=>f==="month"?Qf(q,1):f==="week"?La(q,7):La(q,1)),children:"〉"})]}),n.jsxs("div",{style:{display:"flex",gap:6},children:[n.jsx("button",{className:"btn",onClick:()=>{m("month"),t(xs(new Date))},disabled:f==="month",children:"월"}),n.jsx("button",{className:"btn",onClick:()=>{m("week"),t(new Date)},disabled:f==="week",children:"주"}),n.jsx("button",{className:"btn",onClick:()=>{m("day"),t(new Date)},disabled:f==="day",children:"일"})]})]}),h&&n.jsx("div",{className:"error",style:{marginBottom:8},children:h}),l&&n.jsx("div",{className:"muted",style:{marginBottom:8},children:"활동 불러오는 중…"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:`repeat(${f==="day"?1:7}, 1fr)`,gap:4},children:[(f==="day"?[""]:["일","월","화","수","목","금","토"]).map((q,C)=>n.jsx("div",{style:{textAlign:"center",color:"var(--muted)",padding:"6px 0"},children:q},C)),f==="month"&&P.map((q,C)=>n.jsxs("div",{style:{position:"relative",border:"1px solid var(--border)",borderRadius:8,padding:8,height:120,overflow:"hidden",display:"flex",flexDirection:"column",background:q.inMonth?"transparent":"var(--panel-2)",outline:q.isToday?"2px solid var(--accent)":"none"},onContextMenu:T=>{T.preventDefault(),T.stopPropagation(),x({open:!0,x:T.clientX,y:T.clientY,date:q.date,event:void 0})},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6,opacity:q.inMonth?1:.6},children:q.date.getDate()}),(()=>{const T=`${q.date.getFullYear()}-${String(q.date.getMonth()+1).padStart(2,"0")}-${String(q.date.getDate()).padStart(2,"0")}`,W=$.get(T)||[];return W.length?n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{position:"absolute",top:6,right:8,fontSize:11,fontWeight:700,color:"#dc2626"},children:W.length}),n.jsx("div",{className:"cal-events",style:{flex:1,minHeight:0,overflowY:"auto",display:"flex",flexDirection:"column",gap:4},children:W.map((I,U)=>{const K=I.customerName||I.subject||"활동",Y=I.customerName&&I.subject?`${I.customerName} · ${I.subject}`:I.customerName||I.subject||"";return n.jsxs("div",{className:`cal-pill status-${(I.status||"scheduled").replaceAll(" ","_")}`,title:Y,onClick:()=>{I.source!=="region"&&se(I)},onContextMenu:M=>{I.source!=="region"&&O(M,I)},style:{cursor:I.source==="region"?"default":"pointer"},children:[n.jsx("span",{className:"time",children:I.time}),n.jsx("span",{className:"subj",children:K})]},U)})})]}):null})()]},C)),(f==="week"||f==="day")&&P.map((W,I)=>{const U=`${W.date.getFullYear()}-${String(W.date.getMonth()+1).padStart(2,"0")}-${String(W.date.getDate()).padStart(2,"0")}`,K=($.get(U)||[]).sort((G,de)=>G.start.getTime()-de.start.getTime()),Y=f==="day"?S(W.date):K,M=Array.from({length:24},()=>[]);Y.forEach(G=>{const de=L(G.start),be=L(G.end),ke=be>de?be:de,ye=Math.floor(de/60),Ce=Math.floor(ke/60);for(let J=ye;J<=Math.min(Ce,23);J++)M[J].push(G)});const D=M.map(G=>G.length===0?40:40+(G.length-1)*20),oe=[0];for(let G=0;G<24;G++)oe.push(oe[G]+D[G]);const F=oe[24];return n.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8,padding:8},onContextMenu:G=>{G.preventDefault(),G.stopPropagation(),x({open:!0,x:G.clientX,y:G.clientY,date:W.date,event:void 0})},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6},children:W.date.getDate()}),n.jsx("div",{className:"day-timeline",style:{position:"relative",height:F,borderTop:"1px solid var(--border)",overflowY:"auto",maxHeight:640},children:[...Array(24)].map((G,de)=>{const be=M[de],ke=oe[de],ye=D[de];return n.jsxs("div",{style:{position:"absolute",top:ke,left:0,right:0,height:ye},children:[n.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,borderTop:"1px dashed var(--border)",fontSize:10,color:"var(--muted)"},children:n.jsxs("span",{style:{position:"absolute",left:0,transform:"translateY(-50%)",paddingLeft:4},children:[de,":00"]})}),be.map((Ce,J)=>{const ge=L(Ce.start),Ee=L(Ce.end),we=Ee>ge?Ee:ge;if(Math.floor(ge/60)!==de)return null;const Ot=ge%60/60*40+J*20,pt=we-ge,Xt=pt>0?Math.max(18,pt/60*40):18,Ke=Ce.customerName||Ce.subject||"활동",gt=Ce.customerName&&Ce.subject?`${Ce.customerName} · ${Ce.subject}`:Ce.customerName||Ce.subject||"";return n.jsxs("div",{className:`cal-pill status-${(Ce.status||"scheduled").replaceAll(" ","_")}`,style:{position:"absolute",top:Ot,left:"60px",width:"calc(100% - 64px)",height:Xt,zIndex:J},title:`${j(ge)}~${j(we)} ${gt}`,onClick:()=>{Ce.source!=="region"&&se(Ce)},onContextMenu:Qe=>{Ce.source!=="region"&&O(Qe,Ce)},"aria-disabled":Ce.source==="region"?!0:void 0,children:[n.jsx("span",{className:"time",children:j(ge)}),n.jsx("span",{className:"subj",children:Ke})]},Ce.id)})]},de)})})]},I)})]}),p.open&&n.jsxs("div",{className:"context-menu",style:{left:p.x+4,top:p.y+4},onClick:q=>q.stopPropagation(),children:[n.jsx("button",{className:"context-item",onClick:()=>{p.date&&(H(p.date),R())},disabled:!p.date,children:"활동 등록"}),n.jsx("button",{className:"context-item",onClick:()=>{p.event&&(y(p.event.id),R())},disabled:!p.event,style:p.event?void 0:{opacity:.35,cursor:"not-allowed"},children:"활동 수정"}),n.jsx("button",{className:"context-item",onClick:()=>{p.event&&(R(),z(p.event))},disabled:!p.event,style:p.event?void 0:{opacity:.35,cursor:"not-allowed"},children:"활동 삭제"})]})]})]}),b&&n.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.4)"},onClick:()=>y(null),children:n.jsxs("div",{className:"card",style:{width:"min(920px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:q=>q.stopPropagation(),children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[n.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"영업활동 수정"}),n.jsx("button",{onClick:()=>y(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:q=>{q.currentTarget.style.background="var(--panel-2)",q.currentTarget.style.color="var(--text)"},onMouseLeave:q=>{q.currentTarget.style.background="transparent",q.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)",children:"×"})]}),n.jsx(ya,{bare:!0,editId:b,onSaved:()=>{y(null),g(q=>q+1)},onNoticeClose:()=>y(null)})]})}),N&&n.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.4)"},onClick:()=>A(null),children:n.jsxs("div",{className:"card",style:{width:"min(920px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:q=>q.stopPropagation(),children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[n.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"영업활동 등록"}),n.jsx("button",{onClick:()=>A(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:q=>{q.currentTarget.style.background="var(--panel-2)",q.currentTarget.style.color="var(--text)"},onMouseLeave:q=>{q.currentTarget.style.background="transparent",q.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)",children:"×"})]}),n.jsx(ya,{bare:!0,initial:N,onSaved:()=>{A(null),g(q=>q+1)},onNoticeClose:()=>A(null)})]})}),E.open&&n.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.5)"},onClick:ae,children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:20,border:"1px solid var(--border)",borderRadius:12,minWidth:320,maxWidth:"86vw",boxShadow:"0 8px 32px rgba(0,0,0,.3)"},onClick:q=>q.stopPropagation(),children:[n.jsx("div",{style:{marginBottom:16,fontSize:16,fontWeight:700,color:"var(--text)",textAlign:"center"},children:"활동 삭제"}),n.jsxs("div",{style:{marginBottom:20,fontSize:14,color:"var(--text)",textAlign:"center",lineHeight:1.6},children:[E.customerName&&n.jsx("div",{style:{marginBottom:8,fontWeight:600,color:"var(--primary)"},children:E.customerName}),n.jsx("div",{children:"정말로 삭제하시겠습니까?"})]}),n.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[n.jsx("button",{className:"btn",onClick:ae,style:{minWidth:80,background:"var(--panel-2)",border:"1px solid var(--border)",color:"var(--text)",display:"flex",alignItems:"center",justifyContent:"center"},children:"취소"}),n.jsx("button",{className:"btn",onClick:Z,style:{minWidth:80,background:"#dc2626",border:"1px solid #b91c1c",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center"},children:"삭제"})]})]})})]})}function g1(){const[e,t]=c.useState(()=>{const S=new Date;return S.setMinutes(S.getMinutes()-S.getTimezoneOffset()),S.toISOString().slice(0,10)}),[r,a]=c.useState(null),[i,s]=c.useState(new Array(12).fill(0)),[o,l]=c.useState(new Array(12).fill(0)),[d,h]=c.useState([]),[u,f]=c.useState([]),[m,p]=c.useState(!1),[x,v]=c.useState(null),[g,b]=c.useState("compare");async function y(S){p(!0),v(null);try{const R=await fetch(`/api/v1/dashboard/sales-summary?date=${encodeURIComponent(S)}`),O=await R.json().catch(()=>({}));if(!R.ok||O&&O.error)throw new Error(O.error||`HTTP ${R.status}`);a(O);const z=new Date(S),Z=z.getFullYear(),ae=Z-1,se=S,[H,q]=await Promise.all([fetch(`/api/v1/dashboard/monthly?year=${ae}`),fetch(`/api/v1/dashboard/monthly?year=${Z}&until=${encodeURIComponent(se)}`)]),C=await H.json().catch(()=>[]),T=await q.json().catch(()=>[]),W=oe=>{const F=new Array(12).fill(0);return Array.isArray(oe)&&oe.forEach(G=>{const de=Number(G==null?void 0:G.month),be=Number((G==null?void 0:G.amount)||0);de>=1&&de<=12&&(F[de-1]=be)}),F};s(W(C)),l(W(T));const I=z.getMonth()+1,[U,K]=await Promise.all([fetch(`/api/v1/dashboard/daily?year=${ae}&month=${I}`),fetch(`/api/v1/dashboard/daily?year=${Z}&month=${I}&until=${encodeURIComponent(se)}`)]),Y=await U.json().catch(()=>[]),M=await K.json().catch(()=>[]),D=(oe,F,G)=>{let de=31;try{de=new Date(F,G,0).getDate()}catch{}const be=new Array(de).fill(0);return Array.isArray(oe)&&oe.forEach(ke=>{const ye=Number(ke==null?void 0:ke.day),Ce=Number((ke==null?void 0:ke.amount)||0);ye>=1&&ye<=de&&(be[ye-1]=Ce)}),be};h(D(Y,ae,I)),f(D(M,Z,I))}catch(R){v((R==null?void 0:R.message)||"조회 중 오류가 발생했습니다"),a(null)}finally{p(!1)}}c.useEffect(()=>{y(e)},[]);const N=S=>{if(S==null)return"-";try{return new Intl.NumberFormat("ko-KR").format(S)}catch{return String(S)}},A=new Date(e),E=A.getFullYear(),w=A.getMonth()+1,P=A.getDate(),_=S=>String(S).padStart(2,"0"),$=E-1,L=new Date($,w,0).getDate(),j=Math.min(P,L);return n.jsxs("section",{style:{display:"flex",flexDirection:"column",fontSize:12},children:[n.jsxs("div",{className:"tabs",style:{display:"flex",gap:8,padding:"6px 8px",marginBottom:8},children:[n.jsx("button",{className:g==="compare"?"tab active":"tab",onClick:()=>b("compare"),children:"전년동기 매출비교"}),n.jsx("button",{className:g==="arrears"?"tab active":"tab",onClick:()=>b("arrears"),children:"미수 분석"})]}),g==="compare"?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"page-title",children:[n.jsx("h2",{children:"전년동기 매출비교"}),n.jsx("div",{className:"controls",style:{gap:8},children:n.jsx("input",{type:"date",className:"subject-input",value:e,onChange:S=>{t(S.target.value),y(S.target.value)}})})]}),x&&n.jsx("div",{className:"error",style:{marginBottom:8},children:x}),n.jsx("div",{className:"card",style:{padding:12},children:m?n.jsx("div",{className:"empty-state",children:"불러오는 중…"}):r?n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:12},children:[n.jsx(Ra,{label:`${$} 전체`,value:N(r.prevYearTotal)}),n.jsx(Ra,{label:`${$}-01-01 ~ ${$}-${_(w)}-${_(P)}`,value:N(r.prevYearToDate)}),n.jsx(Ra,{label:`${E}-01-01 ~ ${E}-${_(w)}-${_(P)}`,value:N(r.currentYearToDate)}),n.jsx(Ra,{label:`${$}-${_(w)} 전체`,value:N(r.prevYearMonthTotal)}),n.jsx(Ra,{label:`${$}-${_(w)}-01 ~ ${$}-${_(w)}-${_(j)}`,value:N(r.prevYearMonthToDate)}),n.jsx(Ra,{label:`${E}-${_(w)}-01 ~ ${E}-${_(w)}-${_(P)}`,value:N(r.currentYearMonthToDate)})]}):n.jsx("div",{className:"empty-state",children:"데이터가 없습니다"})}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[n.jsxs("div",{className:"card",style:{padding:12},children:[n.jsx("div",{className:"muted",style:{marginBottom:8},children:"월별 매출 (올해 vs 전년)"}),n.jsx(y1,{prev:i,cur:o,upToMonth:new Date(e).getMonth()+1})]}),n.jsxs("div",{className:"card",style:{padding:12},children:[n.jsx("div",{className:"muted",style:{marginBottom:8},children:"일별 매출 (해당 월: 올해 vs 전년)"}),n.jsx(v1,{prev:d,cur:u,upToDay:new Date(e).getDate()})]})]}),n.jsxs("div",{className:"controls",style:{justifyContent:"flex-start",marginTop:12},children:[n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"8px 12px",borderRadius:10},onClick:async()=>{try{const S=await fetch(`/api/v1/dashboard/churn?date=${encodeURIComponent(e)}`),R=await S.json().catch(()=>[]);if(!S.ok||R&&R.error)throw new Error(R.error||`HTTP ${S.status}`);try{window.dispatchEvent(new CustomEvent("tnt.sales.dashboard.churn",{detail:{items:R}}))}catch{}}catch{alert("이탈거래처 조회 실패")}},children:"이탈거래처"}),n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"8px 12px",borderRadius:10,marginLeft:12},onClick:async()=>{try{const S=await fetch(`/api/v1/dashboard/newcustomers?date=${encodeURIComponent(e)}`),R=await S.json().catch(()=>[]);if(!S.ok||R&&R.error)throw new Error(R.error||`HTTP ${S.status}`);try{window.dispatchEvent(new CustomEvent("tnt.sales.dashboard.newcustomers",{detail:{items:R}}))}catch{}}catch{alert("신규 거래처 조회 실패")}},children:"신규 거래처"})]})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"page-title",children:n.jsx("h2",{children:"미수 분석"})}),n.jsx("div",{className:"card",style:{padding:12},children:n.jsx("div",{className:"empty-state",children:"미수 분석 콘텐츠가 준비 중입니다."})})]})]})}function Ra({label:e,value:t}){return n.jsxs("div",{className:"card",style:{padding:12},children:[n.jsx("div",{className:"muted",style:{fontSize:10,marginBottom:8},children:e}),n.jsx("div",{style:{fontSize:16,fontWeight:700},children:t})]})}function y1({prev:e,cur:t,upToMonth:r}){const o=Array.from({length:12},(g,b)=>b+1),l=Math.max(1,...e,...t),d=g=>36+g*(320-2*36)/11,h=g=>204-g/l*(240-2*36),u=(g,b)=>o.filter(N=>!b||N<=b).map((N,A)=>`${A===0?"M":"L"} ${d(N-1)} ${h(g[N-1]||0)}`).join(" "),f=4,m=Array.from({length:f},(g,b)=>Math.round((b+1)*l/f)),p=g=>`${Math.round((g||0)/1e6)}`,x=g=>new Intl.NumberFormat("ko-KR",{maximumFractionDigits:0}).format((g||0)/1e6),v={prev:"#64748b",cur:"#2563eb"};return n.jsxs("svg",{width:"100%",viewBox:"0 0 320 240",children:[n.jsx("rect",{x:0,y:0,width:320,height:240,fill:"transparent"}),m.map((g,b)=>{const y=h(g);return n.jsxs("g",{children:[n.jsx("line",{x1:36,y1:y,x2:284,y2:y,stroke:"var(--border)"}),n.jsx("text",{x:30,y:y+2,textAnchor:"end",fontSize:4,fill:"var(--muted)",children:p(g)})]},b)}),n.jsx("text",{x:4,y:10,fontSize:4,fill:"var(--muted)",children:"단위: 백만원"}),n.jsx("path",{d:u(e),fill:"none",stroke:v.prev,strokeWidth:2}),n.jsx("path",{d:u(t,r),fill:"none",stroke:v.cur,strokeWidth:2}),o.map(g=>{const b=e[g-1]||0,y=h(b)-4;return n.jsx("text",{x:d(g-1),y,textAnchor:"middle",fontSize:4,fill:v.prev,children:x(b)},`p-${g}`)}),o.filter(g=>g<=r).map(g=>{const b=t[g-1]||0,y=h(b)-4;return n.jsx("text",{x:d(g-1),y:y-6,textAnchor:"middle",fontSize:4,fill:v.cur,children:x(b)},`c-${g}`)}),o.map(g=>n.jsxs("text",{x:d(g-1),y:234,textAnchor:"middle",fontSize:4,fill:"var(--muted)",children:[g,"월"]},g)),n.jsxs("g",{children:[n.jsx("circle",{cx:196,cy:14,r:4,fill:v.prev}),n.jsx("text",{x:206,y:18,fontSize:4,fill:"var(--muted)",children:"전년"}),n.jsx("circle",{cx:250,cy:14,r:4,fill:v.cur}),n.jsx("text",{x:260,y:18,fontSize:4,fill:"var(--muted)",children:"올해"})]})]})}function v1({prev:e,cur:t,upToDay:r}){const l=Math.max(1,...e,...t),d=(320-2*36)/31,h=Math.max(1,Math.floor(d*.35)),u=N=>36+N*d,f=N=>204-N/l*(240-2*36),m=N=>`${Math.round((N||0)/1e6)}`,p=Array.from({length:31},(N,A)=>A+1),x=Array.from({length:4},(N,A)=>Math.round((A+1)*l/4)),[v,g]=Ae.useState(null),b=N=>{const E=N.currentTarget.getBoundingClientRect(),w=N.clientX-E.left,P=Math.max(0,Math.min(320-2*36,w-36)),_=Math.max(0,Math.min(30,Math.floor(P/d)));g(_)},y={prev:"#94a3b8",cur:"#3b82f6"};return n.jsxs("svg",{width:"100%",viewBox:"0 0 320 240",onMouseMove:b,onMouseLeave:()=>g(null),children:[n.jsx("rect",{x:0,y:0,width:320,height:240,fill:"transparent"}),x.map((N,A)=>{const E=f(N);return n.jsxs("g",{children:[n.jsx("line",{x1:36,y1:E,x2:284,y2:E,stroke:"var(--border)"}),n.jsx("text",{x:30,y:E+2,textAnchor:"end",fontSize:4,fill:"var(--muted)",children:m(N)})]},A)}),n.jsx("text",{x:4,y:10,fontSize:4,fill:"var(--muted)",children:"단위: 백만원"}),Array.from({length:31},(N,A)=>A).map(N=>{const A=u(N),E=204-f(e[N]||0),w=204-f(t[N]||0);return n.jsxs("g",{children:[n.jsx("rect",{x:A-h-1,y:f(e[N]||0),width:h,height:E,fill:y.prev}),n.jsx("rect",{x:A+1,y:f(t[N]||0),width:h,height:w,fill:y.cur})]},N)}),p.map(N=>n.jsx("text",{x:u(N-1),y:232,textAnchor:"middle",fontSize:3,fill:"var(--muted)",children:N},N)),n.jsxs("g",{children:[n.jsx("rect",{x:194,y:8,width:8,height:8,fill:y.prev}),n.jsx("text",{x:208,y:16,fontSize:4,fill:"var(--muted)",children:"전년"}),n.jsx("rect",{x:244,y:8,width:8,height:8,fill:y.cur}),n.jsx("text",{x:258,y:16,fontSize:4,fill:"var(--muted)",children:"올해"})]}),v!=null&&v<31&&n.jsxs("g",{children:[n.jsx("line",{x1:u(v),y1:32,x2:u(v),y2:208,stroke:"var(--border)"}),n.jsxs("g",{transform:`translate(${Math.min(174,Math.max(36,u(v)-55))}, 36)`,children:[n.jsx("rect",{x:0,y:0,width:110,height:38,rx:6,fill:"var(--panel)",stroke:"var(--border)"}),n.jsxs("text",{x:6,y:12,fontSize:4,fill:"var(--muted)",children:[v+1,"일"]}),n.jsxs("text",{x:6,y:22,fontSize:4,fill:y.prev,children:["전년 ",m(e[v]||0)]}),n.jsxs("text",{x:6,y:32,fontSize:4,fill:y.cur,children:["올해 ",v+1<=r?m(t[v]||0):"-"]})]})]})]})}function x1({activity:e}){return n.jsxs("section",{className:"card activity-edit-panel",style:{marginTop:12,minHeight:240},children:[n.jsx("div",{className:"tabs c360-tabs",children:n.jsx("button",{className:"tab active",children:"영업활동 변경"})}),n.jsx("div",{className:"activity-form-wrapper",children:n.jsx(ya,{bare:!0,editId:e==null?void 0:e.id,initial:{id:e==null?void 0:e.id,subject:(e==null?void 0:e.subject)||"",description:(e==null?void 0:e.description)||"",channel:(e==null?void 0:e.channel)||"in_person",activityType:(e==null?void 0:e.activityType)||"site_visit",activityStatus:(e==null?void 0:e.activityStatus)||"scheduled",plannedStartAt:(e==null?void 0:e.plannedStartAt)||"",plannedEndAt:(e==null?void 0:e.plannedEndAt)||"",sfAccountId:(e==null?void 0:e.sfAccountId)||"",customerName:(e==null?void 0:e.customerName)||"",parentActivitySeq:e==null?void 0:e.parentSeq,parentSubject:e==null?void 0:e.parentSubject}},`edit-${(e==null?void 0:e.id)??"new"}`)})]})}function ir(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function b1(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState(()=>new Set),[d,h]=c.useState(null),[u,f]=c.useState(""),[m,p]=c.useState([]),[x,v]=c.useState(""),[g,b]=c.useState(void 0),[y,N]=c.useState({open:!1,x:0,y:0});function A(){try{const L=localStorage.getItem("tnt.sales.visitPlanActivities"),j=L?JSON.parse(L):[],S=new Set;return Array.isArray(j)&&j.forEach(R=>{(R==null?void 0:R.id)!=null&&S.add(Number(R.id))}),S}catch{return new Set}}async function E(){s(null),a(!0);try{const L=localStorage.getItem("tnt.sales.assigneeId");if(!L)throw new Error(lt.loginRequired);const j=new URL("/api/v1/sales-activities",window.location.origin);j.searchParams.set("mineOnly","true"),j.searchParams.set("assigneeId",String(L)),u&&u.trim()&&j.searchParams.set("customerName",u.trim()),x&&x.trim()&&j.searchParams.append("status",x.trim());const S=await fetch(j.toString());if(!S.ok){let ae=`HTTP ${S.status}`;try{const se=await S.json();se!=null&&se.error&&(ae=se.error)}catch{}throw new Error(ae)}const R=await S.json(),O=Array.isArray(R)?R:[],z=A(),Z=O.filter(ae=>!z.has(ae.id));t(Z),b(ae=>{if(!(!Z||Z.length===0))return ae&&Z.some(se=>se.id===ae.id)?ae:Z[0]})}catch(L){s(L.message||"조회 중 오류가 발생했습니다")}finally{a(!1)}}c.useEffect(()=>{E(),(async()=>{try{const S=await fetch("/api/v1/sales-activities/statuses");if(S.ok){const R=await S.json(),O=["scheduled","completed","canceled","postponed"];Array.isArray(R)&&R.length>0?p(R):p(O)}else p(["scheduled","completed","canceled","postponed"])}catch{}})();const L=()=>{try{const S=localStorage.getItem("tnt.sales.availableActivities");if(S){const R=JSON.parse(S);if(Array.isArray(R)){const O=R;t(O),b(z=>{if(!(!O||O.length===0))return z&&O.some(Z=>Z.id===z.id)?z:O[0]})}}}catch{}};window.addEventListener("tnt.sales.availableActivitiesUpdated",L);const j=()=>{E()};return window.addEventListener("tnt.sales.activity.updated",j),()=>window.removeEventListener("tnt.sales.availableActivitiesUpdated",L)},[]),c.useEffect(()=>{if(!y.open)return;const L=()=>N({open:!1,x:0,y:0}),j=S=>{S.key==="Escape"&&N({open:!1,x:0,y:0})};return window.addEventListener("click",L),window.addEventListener("keydown",j),()=>{window.removeEventListener("click",L),window.removeEventListener("keydown",j)}},[y.open]);function w(L,j){L.preventDefault(),L.stopPropagation();const S=(j.parentSubject||"").trim();if(!S){N({open:!1,x:0,y:0});return}const R=e.find(z=>(z.subject||"").trim()===S)||null,O=e.filter(z=>(z.parentSubject||"").trim()===S);N({open:!0,x:L.clientX,y:L.clientY,parent:R,siblings:O})}function P(){if(h(null),o.size===0){h("선택된 활동이 없습니다");return}const L=e.filter(S=>o.has(S.id)),j=e.filter(S=>!o.has(S.id));try{let S=[];try{const se=localStorage.getItem("tnt.sales.visitPlanActivities");if(se){const H=JSON.parse(se);Array.isArray(H)&&(S=H)}}catch{}const R=new Map;S.forEach(se=>R.set(se.id,se)),L.forEach(se=>R.set(se.id,se));const O=Array.from(R.values());localStorage.setItem("tnt.sales.visitPlanActivities",JSON.stringify(O));let z=[];try{const se=localStorage.getItem("tnt.sales.availableActivities");if(se){const H=JSON.parse(se);Array.isArray(H)&&(z=H)}}catch{}const Z=new Map;z.forEach(se=>Z.set(se.id,se)),j.forEach(se=>Z.set(se.id,se)),L.forEach(se=>Z.delete(se.id));const ae=Array.from(Z.values());localStorage.setItem("tnt.sales.availableActivities",JSON.stringify(ae)),window.dispatchEvent(new CustomEvent("tnt.sales.visitPlanUpdated")),window.dispatchEvent(new CustomEvent("tnt.sales.availableActivitiesUpdated")),h(`방문 일정 대상 ${L.length}건을 우측 패널에 추가했습니다`),t(ae),l(new Set)}catch{h("저장 중 오류가 발생했습니다")}}const _=(L,j)=>L?j==="type"?{site_visit:"정기방문",opportunity:"영업기회",AR_mgmt:"채권관리",meeting:"미팅",call:"전화",email:"이메일",demo:"데모",task:"업무",other:"기타"}[L]||L:j==="status"?{scheduled:"계획",completed:"완료",canceled:"취소",postponed:"연기",no_show:"미방문"}[L]||L:j==="channel"&&{in_person:"방문",phone:"전화",email:"문자/메일/팩스",other:"기타",video:"영상",chat:"채팅",sms:"문자"}[L]||L:"",$=c.useMemo(()=>{const L=j=>[`제목: ${j.subject||""}`,`활동설명: ${j.description||""}`,`활동유형: ${_(j.activityType,"type")}`,`활동방법: ${_(j.channel,"channel")}`,`상태: ${_(j.activityStatus,"status")}`,`상위활동: ${j.parentSubject||""}`,`계획 일시: ${ir(j.plannedStartAt)}`,`종료 일시: ${ir(j.plannedEndAt)}`,`거래처명: ${j.customerName||""}`,`생성일시: ${ir(j.createdAt)}`].join(`
`);return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"table-container",style:{maxHeight:"32vh"},children:e.length===0?n.jsx("div",{className:"empty-state",children:lt.empty}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:36,textAlign:"center"},children:n.jsx("input",{type:"checkbox",checked:e.length>0&&o.size===e.length,onChange:j=>{if(j.target.checked){const S=new Set;e.forEach(R=>S.add(R.id)),l(S)}else l(new Set)}})}),n.jsx("th",{style:{width:240},children:"제목"}),n.jsx("th",{style:{width:120},children:"활동방법"}),n.jsx("th",{style:{width:200},children:"거래처명"}),n.jsx("th",{style:{width:280},children:"활동설명"}),n.jsx("th",{style:{width:220},children:"상위활동"}),n.jsx("th",{style:{width:120},children:"활동유형"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:180},children:"계획 일시"}),n.jsx("th",{style:{width:180},children:"종료 일시"}),n.jsx("th",{style:{width:180},children:"생성일시"})]})}),n.jsx("tbody",{children:e.map((j,S)=>n.jsxs("tr",{title:L(j),onClick:()=>b(j),onContextMenu:R=>w(R,j),"aria-selected":(g==null?void 0:g.id)===j.id?!0:void 0,style:(g==null?void 0:g.id)===j.id?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:[n.jsx("td",{style:{textAlign:"center"},children:n.jsx("input",{type:"checkbox",checked:o.has(j.id),onChange:R=>{l(O=>{const z=new Set(O);return R.target.checked?z.add(j.id):z.delete(j.id),z})}})}),n.jsx("td",{children:j.subject||""}),n.jsx("td",{children:_(j.channel,"channel")}),n.jsx("td",{children:j.customerName||""}),n.jsx("td",{title:j.description||"",style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:j.description||""}),n.jsx("td",{children:j.parentSubject||""}),n.jsx("td",{children:_(j.activityType,"type")}),n.jsx("td",{children:_(j.activityStatus,"status")}),n.jsx("td",{children:ir(j.plannedStartAt)}),n.jsx("td",{children:ir(j.plannedEndAt)}),n.jsx("td",{children:ir(j.createdAt)})]},S))})]})}),y.open&&n.jsxs("div",{className:"context-menu",style:{left:y.x+6,top:y.y+6,maxWidth:720,padding:10,fontSize:10},onClick:j=>j.stopPropagation(),children:[n.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"상위활동"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:8},children:[y.parent&&n.jsx("div",{className:"card",style:{padding:8},children:n.jsx("div",{style:{overflowX:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%",fontSize:10},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"제목"}),n.jsx("th",{children:"활동설명"}),n.jsx("th",{children:"활동유형"}),n.jsx("th",{children:"활동방법"}),n.jsx("th",{children:"상태"}),n.jsx("th",{children:"거래처명"}),n.jsx("th",{children:"계획 일시"}),n.jsx("th",{children:"종료 일시"})]})}),n.jsx("tbody",{children:n.jsxs("tr",{children:[n.jsx("td",{children:y.parent.subject||""}),n.jsx("td",{style:{whiteSpace:"pre-wrap",maxWidth:360},children:y.parent.description||""}),n.jsx("td",{children:_(y.parent.activityType,"type")}),n.jsx("td",{children:_(y.parent.channel,"channel")}),n.jsx("td",{children:_(y.parent.activityStatus,"status")}),n.jsx("td",{children:y.parent.customerName||""}),n.jsx("td",{children:ir(y.parent.plannedStartAt)}),n.jsx("td",{children:ir(y.parent.plannedEndAt)})]})})]})})}),n.jsxs("div",{className:"card",style:{padding:8},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"관련활동"}),y.siblings&&y.siblings.length>0?n.jsxs("table",{className:"table",style:{width:"100%",fontSize:10},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:240},children:"제목"}),n.jsx("th",{style:{width:120},children:"활동유형"}),n.jsx("th",{style:{width:120},children:"활동방법"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:180},children:"계획 일시"}),n.jsx("th",{style:{width:180},children:"종료 일시"})]})}),n.jsx("tbody",{children:y.siblings.map((j,S)=>n.jsxs("tr",{onClick:()=>{b(j),N({open:!1,x:0,y:0})},children:[n.jsx("td",{children:j.subject||""}),n.jsx("td",{children:_(j.activityType,"type")}),n.jsx("td",{children:_(j.channel,"channel")}),n.jsx("td",{children:_(j.activityStatus,"status")}),n.jsx("td",{children:ir(j.plannedStartAt)}),n.jsx("td",{children:ir(j.plannedEndAt)})]},S))})]}):n.jsx("div",{className:"muted",children:"하위 활동이 없습니다"})]})]})]})]})},[e,o,g,y]);return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("input",{value:u,onChange:L=>f(L.target.value),onKeyDown:L=>{L.key==="Enter"&&!r&&E()},placeholder:"거래처명 입력",style:{width:220,height:28,padding:"6px 8px",borderRadius:6,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12}}),n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginLeft:8},children:[n.jsx("label",{className:"muted",style:{fontSize:12},children:"상태"}),n.jsxs("select",{value:x,onChange:L=>v(L.target.value),style:{minWidth:140,height:28,padding:"4px 8px",borderRadius:8,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12},children:[n.jsx("option",{value:"",children:"전체"}),m.map(L=>n.jsx("option",{value:L,children:_(L,"status")},L))]})]}),n.jsx("button",{className:"btn",onClick:E,disabled:r,children:r?"조회중…":"조회"}),n.jsx("button",{className:"btn",onClick:P,disabled:!0,title:"준비중 기능",style:{marginLeft:8,opacity:.6,cursor:"not-allowed"},children:lt.action.addToPlan}),i&&n.jsx("span",{className:"error",children:i||lt.errorGeneric}),d&&n.jsx("span",{className:"muted",children:d}),n.jsx("div",{style:{flex:1}}),n.jsxs("div",{className:"muted count-text",children:["총 ",e.length,"건",o.size?` · 선택 ${o.size}건`:""]})]}),n.jsx("div",{style:{marginTop:12},children:$}),n.jsx(x1,{activity:g})]})}function j1(){return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",children:[n.jsx("h2",{children:"Complaint"}),n.jsx("div",{className:"meta",children:"준비 중"})]}),n.jsx("div",{className:"empty-state",children:"Complaint 기능은 추후 제공될 예정입니다."})]})}function w1({compact:e=!1,maxHeight:t}){const[r,a]=c.useState([]),[i,s]=c.useState(!1),[o,l]=c.useState(null),[d,h]=c.useState({open:!1,x:0,y:0}),[u,f]=c.useState(()=>{try{const v=localStorage.getItem("tnt.sales.selectedInquiry");if(v){const g=JSON.parse(v),b=Number(g==null?void 0:g.id);return Number.isFinite(b)?b:null}}catch{}return null});async function m(v){l(null),s(!0);try{let g=null;try{const y=await fetch("/api/v1/inquiries");y.ok&&(g=await y.json())}catch{}let b=[];if(Array.isArray(g)?b=g.map((y,N)=>({id:Number((y==null?void 0:y.id)??N+1),title:(y==null?void 0:y.title)!=null?String(y.title):"",customerSeq:(y==null?void 0:y.customerSeq)!=null?Number(y.customerSeq):(y==null?void 0:y.customer_seq)!=null?Number(y.customer_seq):null,customerName:(y==null?void 0:y.customerName)??(y==null?void 0:y.customer_name)??null,inquiryStatus:(y==null?void 0:y.inquiryStatus)??(y==null?void 0:y.inquiry_status)??(y==null?void 0:y.status)??"",assigneeSeq:(y==null?void 0:y.assigneeSeq)!=null?Number(y.assigneeSeq):(y==null?void 0:y.assignee_seq)!=null?Number(y.assignee_seq):null,assigneeName:(y==null?void 0:y.assigneeName)??(y==null?void 0:y.assignee_name)??null,assigneeId:(y==null?void 0:y.assigneeId)??(y==null?void 0:y.assignee_id)??null,openedAt:(y==null?void 0:y.openedAt)??(y==null?void 0:y.opened_at)??"",updatedAt:(y==null?void 0:y.updatedAt)??(y==null?void 0:y.updated_at)??"",inquiryCategory:(y==null?void 0:y.inquiryCategory)??(y==null?void 0:y.inquiry_category)??"",ownerSeq:(y==null?void 0:y.ownerSeq)!=null?Number(y.ownerSeq):(y==null?void 0:y.owner_seq)!=null?Number(y.owner_seq):null,ownerName:(y==null?void 0:y.ownerName)??(y==null?void 0:y.owner_name)??null,channel:(y==null?void 0:y.channel)??"",contactSeq:(y==null?void 0:y.contactSeq)!=null?Number(y.contactSeq):(y==null?void 0:y.contact_seq)!=null?Number(y.contact_seq):null,contactName:(y==null?void 0:y.contactName)??(y==null?void 0:y.contact_name)??null,leadId:(y==null?void 0:y.leadId)??"",severity:(y==null?void 0:y.severity)??"",closedAt:(y==null?void 0:y.closedAt)??(y==null?void 0:y.closed_at)??"",inquiryContent:(y==null?void 0:y.inquiryContent)??(y==null?void 0:y.inquiry_content)??"",answerContent:(y==null?void 0:y.answerContent)??(y==null?void 0:y.answer_content)??""})):b=[],b.sort((y,N)=>{const A=y.updatedAt?Date.parse(y.updatedAt):0,E=N.updatedAt?Date.parse(N.updatedAt):0;return E!==A?E-A:(y.title||"").localeCompare(N.title||"","ko",{sensitivity:"base"})}),a(b),v!=null){const y=b.find(N=>N.id===v);if(y){p(y);return}}b.length>0&&u==null&&p(b[0])}catch(g){l((g==null?void 0:g.message)||"조회 중 오류가 발생했습니다")}finally{s(!1)}}c.useEffect(()=>{m()},[]),c.useEffect(()=>{const v=g=>{var y;const b=((y=g==null?void 0:g.detail)==null?void 0:y.focusId)!=null?Number(g.detail.focusId):null;m(b)};return window.addEventListener("tnt.sales.inquiry.reload",v),()=>window.removeEventListener("tnt.sales.inquiry.reload",v)},[]);function p(v){f(v.id);try{localStorage.setItem("tnt.sales.selectedInquiry",JSON.stringify(v)),window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.selected",{detail:{inquiry:v}}))}catch{}}return c.useMemo(()=>n.jsxs("div",{className:"table-container",style:{height:t??(e?"32vh":void 0),maxHeight:t??(e?"32vh":void 0)},children:[r.length===0?n.jsx("div",{className:"empty-state",children:i?"불러오는 중…":o||"데이터가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"제목"}),n.jsx("th",{style:{width:200},children:"거래처명"}),n.jsx("th",{style:{width:120},children:"문의유형"}),n.jsx("th",{style:{width:120},children:"접수자"}),n.jsx("th",{style:{width:120},children:"당사담당자"}),n.jsx("th",{style:{width:160},children:"접수시간"})]})}),n.jsx("tbody",{children:r.map((v,g)=>{const b=(()=>{if(String(v.inquiryStatus||"").trim()==="완료")return!1;const N=v.openedAt?Date.parse(v.openedAt):NaN;return Number.isFinite(N)?N<=Date.now()-864e5:!1})();return n.jsxs("tr",{className:u===v.id?"selected":void 0,onClick:()=>p(v),onMouseEnter:y=>h({open:!0,x:y.clientX+8,y:y.clientY+8,row:v}),onMouseMove:y=>h(N=>({...N,x:y.clientX+8,y:y.clientY+8})),onMouseLeave:()=>h({open:!1,x:0,y:0}),style:b?{color:"#ef4444"}:void 0,children:[n.jsx("td",{children:v.title||""}),n.jsx("td",{children:v.customerName||(v.customerSeq!=null?String(v.customerSeq):"")}),n.jsx("td",{children:v.inquiryCategory||""}),n.jsx("td",{children:v.ownerName||(v.ownerSeq!=null?String(v.ownerSeq):"")}),n.jsx("td",{children:v.assigneeName||(v.assigneeSeq!=null?String(v.assigneeSeq):"")}),n.jsx("td",{children:v.openedAt?(()=>{const y=new Date(v.openedAt);if(isNaN(y.getTime()))return v.openedAt;const N=String(y.getFullYear()%100).padStart(2,"0"),A=String(y.getMonth()+1).padStart(2,"0"),E=String(y.getDate()).padStart(2,"0"),w=String(y.getHours()).padStart(2,"0"),P=String(y.getMinutes()).padStart(2,"0");return`${N}-${A}-${E} ${w}:${P}`})():""})]},g)})})]}),d.open&&d.row&&n.jsxs("div",{role:"dialog","aria-label":"문의 상세",style:{position:"fixed",left:Math.min(d.x,(typeof window<"u"?window.innerWidth:1200)-420),top:Math.min(d.y,(typeof window<"u"?window.innerHeight:800)-320),zIndex:9999,maxWidth:400,background:"var(--panel)",color:"var(--text)",border:"1px solid var(--border)",borderRadius:10,boxShadow:"0 12px 28px rgba(0,0,0,.25)",padding:10,fontSize:12,lineHeight:1.4,pointerEvents:"none"},children:[n.jsx("div",{style:{fontWeight:700,marginBottom:6},children:d.row.title||"(문의)"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr",columnGap:8,rowGap:4},children:[n.jsx("span",{className:"muted",children:"거래처"}),n.jsx("span",{children:d.row.customerName||(d.row.customerSeq!=null?String(d.row.customerSeq):"")}),n.jsx("span",{className:"muted",children:"문의유형"}),n.jsx("span",{children:d.row.inquiryCategory||""}),n.jsx("span",{className:"muted",children:"상태"}),n.jsx("span",{children:d.row.inquiryStatus||""}),n.jsx("span",{className:"muted",children:"난이도"}),n.jsx("span",{children:d.row.severity||""}),n.jsx("span",{className:"muted",children:"접수자"}),n.jsx("span",{children:d.row.ownerName||(d.row.ownerSeq!=null?String(d.row.ownerSeq):"")}),n.jsx("span",{className:"muted",children:"당사담당자"}),n.jsx("span",{children:d.row.assigneeName||(d.row.assigneeSeq!=null?String(d.row.assigneeSeq):"")}),n.jsx("span",{className:"muted",children:"리드ID"}),n.jsx("span",{children:d.row.leadId||""}),n.jsx("span",{className:"muted",children:"채널"}),n.jsx("span",{children:d.row.channel||""}),n.jsx("span",{className:"muted",children:"접수시각"}),n.jsx("span",{children:d.row.openedAt?(()=>{const v=new Date(d.row.openedAt);if(isNaN(v.getTime()))return String(d.row.openedAt);const g=String(v.getFullYear()%100).padStart(2,"0"),b=String(v.getMonth()+1).padStart(2,"0"),y=String(v.getDate()).padStart(2,"0"),N=String(v.getHours()).padStart(2,"0"),A=String(v.getMinutes()).padStart(2,"0");return`${g}-${b}-${y} ${N}:${A}`})():""}),n.jsx("span",{className:"muted",children:"종료시각"}),n.jsx("span",{children:d.row.closedAt?(()=>{const v=new Date(d.row.closedAt);if(isNaN(v.getTime()))return String(d.row.closedAt);const g=String(v.getFullYear()%100).padStart(2,"0"),b=String(v.getMonth()+1).padStart(2,"0"),y=String(v.getDate()).padStart(2,"0"),N=String(v.getHours()).padStart(2,"0"),A=String(v.getMinutes()).padStart(2,"0");return`${g}-${b}-${y} ${N}:${A}`})():""}),n.jsx("span",{className:"muted",children:"문의내용"}),n.jsx("span",{style:{whiteSpace:"pre-wrap"},children:d.row.inquiryContent||""}),n.jsx("span",{className:"muted",children:"답변내용"}),n.jsx("span",{style:{whiteSpace:"pre-wrap"},children:d.row.answerContent||""}),n.jsx("span",{className:"muted",children:"수정시각"}),n.jsx("span",{children:d.row.updatedAt?(()=>{const v=new Date(d.row.updatedAt);if(isNaN(v.getTime()))return String(d.row.updatedAt);const g=String(v.getFullYear()%100).padStart(2,"0"),b=String(v.getMonth()+1).padStart(2,"0"),y=String(v.getDate()).padStart(2,"0"),N=String(v.getHours()).padStart(2,"0"),A=String(v.getMinutes()).padStart(2,"0");return`${g}-${b}-${y} ${N}:${A}`})():""}),n.jsx("span",{className:"muted",children:"ID"}),n.jsx("span",{children:d.row.id})]})]})]}),[r,u,i,o,e,t,d])}const Pi="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20width='16'%20height='16'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20aria-hidden='true'%3e%3ccircle%20cx='11'%20cy='11'%20r='7'%20/%3e%3cline%20x1='21'%20y1='21'%20x2='16.65'%20y2='16.65'%20/%3e%3c/svg%3e";function ug({open:e,onClose:t,title:r,children:a,footer:i,width:s=380}){return c.useEffect(()=>{if(!e)return;const o=l=>{l.key==="Escape"&&t()};return window.addEventListener("keydown",o,!0),()=>window.removeEventListener("keydown",o,!0)},[e,t]),e?jd.createPortal(n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:2e3},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"22%",left:"50%",transform:"translateX(-50%)",width:s,maxWidth:"92vw",padding:12},children:[r?n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h3",{style:{margin:0,fontSize:14},children:r})}):null,n.jsx("div",{style:{padding:"4px 2px",fontSize:13},children:a}),n.jsx("div",{className:"controls",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:i})]})]}),document.body):null}function S1({open:e,onClose:t,onSubmit:r}){const[a,i]=c.useState(""),[s,o]=c.useState(""),[l,d]=c.useState(""),[h,u]=c.useState(""),[f,m]=c.useState(""),[p,x]=c.useState(""),[v,g]=c.useState(""),[b,y]=c.useState(!1),[N,A]=c.useState(""),[E,w]=c.useState(""),[P,_]=c.useState(""),[$,L]=c.useState(""),[j,S]=c.useState(""),[R,O]=c.useState(!1),[z,Z]=c.useState(""),[ae,se]=c.useState(""),[H,q]=c.useState(!1),[C,T]=c.useState(""),[W,I]=c.useState(""),[U,K]=c.useState(""),[Y,M]=c.useState(""),[D,oe]=c.useState(null),F=c.useRef(null),[G,de]=c.useState(!1),[be,ke]=c.useState({left:0,top:0});c.useEffect(()=>{if(e){const J=new Date;J.setMinutes(J.getMinutes()-J.getTimezoneOffset()),T(J.toISOString().slice(0,16)),I(""),i(""),o(""),d(""),u(""),m(""),x(""),g(""),A("");try{const ge=localStorage.getItem("tnt.sales.empName")||"",Ee=localStorage.getItem("tnt.sales.assigneeId")||"";w(ge),_(Ee)}catch{w(""),_("")}L(""),S(""),Z(""),se(""),K(""),M(""),de(!1)}},[e]),c.useEffect(()=>{if(!e)return;const J=ge=>{if(ge.key==="Escape"){if(b||H||R)return;t()}};return window.addEventListener("keydown",J,!0),()=>window.removeEventListener("keydown",J,!0)},[e,t,b,H,R]),c.useEffect(()=>{if(!D)return;const J=ge=>{ge.key==="Escape"&&oe(null)};return window.addEventListener("keydown",J,!0),()=>window.removeEventListener("keydown",J,!0)},[D]);function ye(J){var pt;J.preventDefault();const ge=(pt=F.current)==null?void 0:pt.getBoundingClientRect(),Ee=J.clientX,we=J.clientY,He=ge?ge.left:be.left,mt=ge?ge.top:be.top,vt=Xt=>{const Ke=Xt.clientX-Ee,gt=Xt.clientY-we;ke({left:He+Ke,top:mt+gt}),de(!0)},Ot=()=>{window.removeEventListener("mousemove",vt),window.removeEventListener("mouseup",Ot)};window.addEventListener("mousemove",vt),window.addEventListener("mouseup",Ot)}if(!e)return null;function Ce(){const J=(a||"").trim().length>0,ge=(s||"").trim().length>0,Ee=!!(p&&Number(p)),we=!!(z&&String(z).trim());if(!J){oe("제목을 입력해 주세요.");return}if(!ge){oe("상태를 선택해 주세요.");return}if(!(Ee||we)){oe("거래처 또는 잠재고객 중 하나를 선택해 주세요.");return}const He={title:a,inquiryStatus:s,severity:l,inquiryCategory:h,channel:f,customerSeq:p?Number(p):null,contactName:N||null,ownerId:P||null,assigneeId:j||null,createdBy:P||null,updatedBy:P||null,leadId:z,openedAt:C||null,closedAt:W||null,inquiryContent:U,answerContent:Y};r==null||r(He)}return n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e3},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),n.jsxs("div",{ref:F,className:"card",style:{position:"absolute",zIndex:1001,width:"90%",maxWidth:900,maxHeight:"90%",overflow:"auto",padding:12,left:G?be.left:"50%",top:G?be.top:"50%",transform:G?"none":"translate(-50%, -50%)"},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{onMouseDown:ye,style:{display:"flex",alignItems:"center",gap:8,marginBottom:12,cursor:"move"},children:[n.jsx("span",{className:"muted",style:{fontWeight:700},children:"새 문의"}),n.jsx("div",{style:{flex:1,height:1,background:"var(--border)"}})]}),n.jsxs("div",{className:"form-grid",children:[n.jsxs("div",{className:"inline-field",children:[n.jsxs("label",{children:["제목",n.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),n.jsx("input",{className:"subject-input",value:a,onChange:J=>i(J.target.value),placeholder:"제목"})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"문의유형"}),n.jsxs("select",{className:"subject-input",value:h,onChange:J=>u(J.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"제품문의",children:"제품문의"}),n.jsx("option",{value:"재고/배송문의",children:"재고/배송문의"}),n.jsx("option",{value:"가격문의",children:"가격문의"}),n.jsx("option",{value:"기타문의",children:"기타문의"})]})]}),n.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[n.jsx("label",{children:"문의내용"}),n.jsx("textarea",{className:"subject-input",value:U,onChange:J=>K(J.target.value),placeholder:"상세 설명",style:{minHeight:120}})]}),n.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[n.jsx("label",{children:"답변내용"}),n.jsx("textarea",{className:"subject-input",value:Y,onChange:J=>M(J.target.value),placeholder:"답변/조치",style:{minHeight:120}})]}),n.jsxs("div",{className:"inline-field",children:[n.jsxs("label",{children:["상태",n.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),n.jsxs("select",{className:"subject-input",value:s,onChange:J=>o(J.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"신규접수",children:"신규접수"}),n.jsx("option",{value:"확인 중",children:"확인 중"}),n.jsx("option",{value:"완료",children:"완료"}),n.jsx("option",{value:"보류",children:"보류"})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"난이도"}),n.jsxs("select",{className:"subject-input",value:l,onChange:J=>d(J.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"상",children:"상"}),n.jsx("option",{value:"중",children:"중"}),n.jsx("option",{value:"하",children:"하"})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"접수경로"}),n.jsxs("select",{className:"subject-input",value:f,onChange:J=>m(J.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"전화",children:"전화"}),n.jsx("option",{value:"이메일",children:"이메일"}),n.jsx("option",{value:"고객채널",children:"고객채널"}),n.jsx("option",{value:"직접입력",children:"직접입력"})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"잠재고객"}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("input",{className:"subject-input",type:"text",value:ae,onChange:J=>{se(J.target.value),Z("")},placeholder:"잠재고객명",style:{paddingRight:28}}),n.jsx("button",{type:"button","aria-label":"잠재고객 검색",title:"잠재고객 검색",onClick:()=>q(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:n.jsx("img",{src:Pi,className:"icon",alt:"검색"})})]}),z&&n.jsxs("div",{className:"muted",style:{fontSize:11,marginTop:4},children:["선택됨: id ",z]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"거래처"}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("input",{className:"subject-input",type:"text",value:v,onChange:J=>{g(J.target.value),x("")},placeholder:"거래처명",style:{paddingRight:28}}),n.jsx("button",{type:"button","aria-label":"거래처 검색",title:"거래처 검색",onClick:()=>y(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:n.jsx("img",{src:Pi,className:"icon",alt:"검색"})})]}),p&&n.jsxs("div",{className:"muted",style:{fontSize:11,marginTop:4},children:["선택됨: seq ",p]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"거래처 담당자"}),n.jsx("input",{className:"subject-input",type:"text",value:N,onChange:J=>A(J.target.value),placeholder:"이름"})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"접수자"}),n.jsx("input",{className:"subject-input",value:E,readOnly:!0,title:"로그인 사용자"})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"당사 담당자"}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("input",{className:"subject-input",type:"text",value:$,onChange:J=>{L(J.target.value),S("")},placeholder:"이름",style:{paddingRight:28}}),n.jsx("button",{type:"button","aria-label":"직원 검색",title:"직원 검색",onClick:()=>O(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:n.jsx("img",{src:Pi,className:"icon",alt:"검색"})})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"접수시각"}),n.jsx("input",{className:"subject-input",type:"datetime-local",value:C,onChange:J=>T(J.target.value)})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"종료시각"}),n.jsx("input",{className:"subject-input",type:"datetime-local",value:W,onChange:J=>I(J.target.value)})]})]}),n.jsxs("div",{className:"controls",style:{gap:8,justifyContent:"flex-end"},children:[n.jsx("button",{className:"btn",onClick:Ce,children:"저장"}),n.jsx("button",{className:"btn",onClick:t,children:"취소"})]})]}),b&&n.jsx(N1,{defaultQuery:v,onClose:()=>y(!1),onSelect:J=>{x(J.customerSeq?String(J.customerSeq):""),g(J.customerName||""),y(!1)}}),R&&n.jsx(A1,{defaultQuery:$,onClose:()=>O(!1),onSelect:J=>{S(J.assigneeId||""),L(J.empName||""),O(!1)}}),H&&n.jsx(k1,{defaultQuery:ae,onClose:()=>q(!1),onSelect:J=>{Z(J.id!=null?String(J.id):""),se(J.companyName||""),q(!1)}}),n.jsx(ug,{open:!!D,onClose:()=>oe(null),width:360,footer:n.jsx("button",{className:"btn",onClick:()=>oe(null),children:"확인"}),children:D})]})}function N1({defaultQuery:e,onClose:t,onSelect:r}){const[a,i]=c.useState(e||""),[s,o]=c.useState([]),[l,d]=c.useState(!1),[h,u]=c.useState(null);async function f(m=!0){d(!0),u(null);try{const p=new URL("/api/v1/customers",window.location.origin);a.trim()&&p.searchParams.set("name",a.trim()),p.searchParams.set("mineOnly","false"),p.searchParams.set("limit","100");const x=await fetch(p.toString());if(!x.ok)throw new Error(`HTTP ${x.status}`);const v=await x.json();if(Array.isArray(v)){const g=v.map(b=>({customerSeq:(b==null?void 0:b.customerSeq)??(b==null?void 0:b.customer_seq)??null,customerId:(b==null?void 0:b.customerId)??(b==null?void 0:b.customer_id)??null,customerName:(b==null?void 0:b.customerName)??(b==null?void 0:b.customer_name)??null,telNo:(b==null?void 0:b.telNo)??(b==null?void 0:b.tel_no)??null,addrProvinceName:(b==null?void 0:b.addrProvinceName)??(b==null?void 0:b.addr_province_name)??null,addrCityName:(b==null?void 0:b.addrCityName)??(b==null?void 0:b.addr_city_name)??null,companyType:(b==null?void 0:b.companyType)??(b==null?void 0:b.company_type)??null,ownerName:(b==null?void 0:b.ownerName)??(b==null?void 0:b.owner_name)??null}));o(g)}else o([])}catch(p){u((p==null?void 0:p.message)||"조회 중 오류가 발생했습니다"),o([])}finally{d(!1)}}return c.useEffect(()=>{f(!0)},[]),c.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"거래처명",value:a,onChange:m=>i(m.target.value),onKeyDown:m=>{m.key==="Enter"&&f(!0)},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:()=>f(!0),children:"조회"})]}),n.jsx("div",{className:"table-container",style:{height:360},children:s.length===0?n.jsx("div",{className:"empty-state",children:l?"불러오는 중…":h||"결과가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:220},children:"거래처명"}),n.jsx("th",{style:{width:140},children:"회사구분"}),n.jsx("th",{style:{width:140},children:"대표자명"}),n.jsx("th",{style:{width:180},children:"지역"})]})}),n.jsx("tbody",{children:s.map((m,p)=>n.jsxs("tr",{onDoubleClick:()=>r(m),onClick:()=>r(m),children:[n.jsx("td",{children:m.customerName||""}),n.jsx("td",{children:m.companyType||""}),n.jsx("td",{children:m.ownerName||""}),n.jsx("td",{children:[m.addrProvinceName,m.addrCityName].filter(Boolean).join(" ")})]},p))})]})})]})]})}function k1({defaultQuery:e,onClose:t,onSelect:r}){const[a,i]=c.useState(e||""),[s,o]=c.useState([]),[l,d]=c.useState(!1),[h,u]=c.useState(null);async function f(m=!0){d(!0),u(null);try{const p=new URL("/api/v1/leads",window.location.origin);a.trim()&&p.searchParams.set("company_name",a.trim()),p.searchParams.set("limit","100");const x=await fetch(p.toString());if(!x.ok)throw new Error(`HTTP ${x.status}`);const v=await x.json();if(Array.isArray(v)){const g=v.map(b=>({id:(b==null?void 0:b.id)!=null?Number(b.id):null,companyName:(b==null?void 0:b.company_name)??null,leadStatus:(b==null?void 0:b.lead_status)??null,ownerName:(b==null?void 0:b.owner_name)??null,addrProvinceName:(b==null?void 0:b.addr_province_name)??null}));o(g)}else o([])}catch(p){u((p==null?void 0:p.message)||"조회 중 오류가 발생했습니다"),o([])}finally{d(!1)}}return c.useEffect(()=>{f(!0)},[]),c.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"잠재고객명",value:a,onChange:m=>i(m.target.value),onKeyDown:m=>{m.key==="Enter"&&f(!0)},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:()=>f(!0),children:"조회"})]}),n.jsx("div",{className:"table-container",style:{height:360},children:s.length===0?n.jsx("div",{className:"empty-state",children:l?"불러오는 중…":h||"결과가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:220},children:"잠재고객명"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:140},children:"소유자"}),n.jsx("th",{style:{width:160},children:"지역"})]})}),n.jsx("tbody",{children:s.map((m,p)=>n.jsxs("tr",{onDoubleClick:()=>r(m),onClick:()=>r(m),children:[n.jsx("td",{children:m.companyName||""}),n.jsx("td",{children:m.leadStatus||""}),n.jsx("td",{children:m.ownerName||""}),n.jsx("td",{children:m.addrProvinceName||""})]},p))})]})})]})]})}function A1({defaultQuery:e,onClose:t,onSelect:r}){const[a,i]=c.useState(e||""),[s,o]=c.useState([]),[l,d]=c.useState(!1),[h,u]=c.useState(null);async function f(){d(!0),u(null);try{const m=new URL("/api/v1/employees",window.location.origin);m.searchParams.set("depts","all");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const x=await p.json(),v=Array.isArray(x)?x.map(y=>({empId:(y==null?void 0:y.emp_id)??null,empName:(y==null?void 0:y.emp_name)??null,deptName:(y==null?void 0:y.dept_name)??null,assigneeId:(y==null?void 0:y.assignee_id)??null})):[],g=a.trim().toLowerCase(),b=(g?v.filter(y=>(y.empName||"").toLowerCase().includes(g)||(y.empId||"").toLowerCase().includes(g)||(y.deptName||"").toLowerCase().includes(g)):v).sort((y,N)=>(y.empName||"").localeCompare(N.empName||"","ko",{sensitivity:"base"}));o(b)}catch(m){u((m==null?void 0:m.message)||"조회 실패"),o([])}finally{d(!1)}}return c.useEffect(()=>{f()},[]),c.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:700,maxHeight:"80%",overflow:"auto",padding:12},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"이름/사번/부서",value:a,onChange:m=>i(m.target.value),onKeyDown:m=>{m.key==="Enter"&&f()},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:f,children:"조회"})]}),n.jsx("div",{className:"table-container",style:{height:320},children:s.length===0?n.jsx("div",{className:"empty-state",children:l?"불러오는 중…":h||"결과가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:160},children:"이름"}),n.jsx("th",{style:{width:160},children:"부서"}),n.jsx("th",{style:{width:140},children:"사번"}),n.jsx("th",{style:{width:140},children:"assignee_id"})]})}),n.jsx("tbody",{children:s.map((m,p)=>n.jsxs("tr",{onDoubleClick:()=>r(m),onClick:()=>r(m),children:[n.jsx("td",{children:m.empName||""}),n.jsx("td",{children:m.deptName||""}),n.jsx("td",{children:m.empId||""}),n.jsx("td",{children:m.assigneeId||""})]},p))})]})})]})]})}function C1(){const[e,t]=c.useState(()=>{try{const j=localStorage.getItem("tnt.sales.selectedInquiry");return j?JSON.parse(j):null}catch{return null}});c.useEffect(()=>{const j=()=>{try{const S=localStorage.getItem("tnt.sales.selectedInquiry");t(S?JSON.parse(S):null)}catch{t(null)}};return window.addEventListener("tnt.sales.inquiry.selected",j),()=>window.removeEventListener("tnt.sales.inquiry.selected",j)},[]);const[r,a]=c.useState(null),[i,s]=c.useState(null),[o,l]=c.useState(!1),[d,h]=c.useState(null);c.useEffect(()=>{if(!i)return;const j=S=>{S.key==="Escape"&&s(null)};return window.addEventListener("keydown",j,!0),()=>window.removeEventListener("keydown",j,!0)},[i]),c.useEffect(()=>{if(!o)return;const j=S=>{S.key==="Escape"&&l(!1)};return window.addEventListener("keydown",j,!0),()=>window.removeEventListener("keydown",j,!0)},[o]),c.useEffect(()=>{if(!d)return;const j=S=>{S.key==="Escape"&&h(null)};return window.addEventListener("keydown",j,!0),()=>window.removeEventListener("keydown",j,!0)},[d]);const u=j=>{if(!j)return"";try{const S=new Date(j);if(isNaN(S.getTime()))return"";const R=String(S.getFullYear()),O=String(S.getMonth()+1).padStart(2,"0"),z=String(S.getDate()).padStart(2,"0"),Z=String(S.getHours()).padStart(2,"0"),ae=String(S.getMinutes()).padStart(2,"0");return`${R}-${O}-${z}T${Z}:${ae}`}catch{return""}},[f,m]=c.useState({}),[p,x]=c.useState(!1),[v,g]=c.useState(!1),[b,y]=c.useState(!1);c.useEffect(()=>{if(!e){m({});return}const j=typeof window<"u"&&localStorage.getItem("tnt.sales.empName")||"",S=typeof window<"u"&&localStorage.getItem("tnt.sales.assigneeId")||"";m({title:e.title||"",inquiryCategory:e.inquiryCategory||"",inquiryContent:e.inquiryContent||"",answerContent:e.answerContent||"",inquiryStatus:e.inquiryStatus||"",severity:e.severity||"",channel:e.channel||"",leadId:e.leadId||"",leadName:"",customerSeq:e.customerSeq!=null?String(e.customerSeq):"",customerName:e.customerName||"",contactName:e.contactName||"",ownerName:j,ownerId:S,assigneeName:e.assigneeName||"",assigneeId:e.assigneeId||"",openedAt:u(e.openedAt),closedAt:u(e.closedAt)})},[e]),c.useEffect(()=>{const j=f.leadId;if(!j||f.leadName)return;let S=!1;return(async()=>{try{const R=await fetch(`/api/v1/leads/${encodeURIComponent(String(j))}`);if(!R.ok)return;const O=await R.json().catch(()=>null);!S&&O&&m(z=>({...z,leadName:O.company_name||z.leadName||""}))}catch{}})(),()=>{S=!0}},[f.leadId,f.leadName]);function N(j,S){m(R=>({...R,[j]:S}))}async function A(){if(!(e!=null&&e.id))return;const j=(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||""}catch{return""}})(),S=String(f.title||"").trim().length>0,R=String(f.inquiryStatus||"").trim().length>0,O=!!(f.customerSeq&&Number(f.customerSeq)),z=!!(f.leadId&&String(f.leadId).trim());if(!S){s("제목을 입력해 주세요.");return}if(!R){s("상태를 선택해 주세요.");return}if(!(O||z)){s("거래처 또는 잠재고객 중 하나를 선택해 주세요.");return}const Z={title:f.title,inquiryCategory:f.inquiryCategory,inquiryContent:f.inquiryContent,answerContent:f.answerContent,inquiryStatus:f.inquiryStatus,severity:f.severity,channel:f.channel,leadId:f.leadId,customerSeq:f.customerSeq?Number(f.customerSeq):null,contactName:f.contactName||null,ownerId:f.ownerId||null,assigneeId:f.assigneeId||null,updatedBy:j||f.ownerId||null,openedAt:f.openedAt||null,closedAt:f.closedAt||null};try{const ae=await fetch(`/api/v1/inquiries/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Z)});if(!ae.ok){const se=await ae.text().catch(()=>"");s("수정 실패: "+(se||ae.status));return}try{a("수정 되었습니다."),window.setTimeout(()=>a(null),3e3)}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.reload",{detail:{focusId:e.id}}))}catch{}}catch{alert("수정 중 오류가 발생했습니다")}}const E=c.useMemo(()=>n.jsx("div",{className:"card",style:{padding:12},children:e?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"form-grid",children:[n.jsxs("div",{className:"inline-field",children:[n.jsxs("label",{children:["제목",n.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),n.jsx("input",{className:"subject-input",value:f.title||"",onChange:j=>N("title",j.target.value)})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"문의유형"}),n.jsxs("select",{className:"subject-input",value:f.inquiryCategory||"",onChange:j=>N("inquiryCategory",j.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"제품문의",children:"제품문의"}),n.jsx("option",{value:"재고/배송문의",children:"재고/배송문의"}),n.jsx("option",{value:"가격문의",children:"가격문의"}),n.jsx("option",{value:"기타문의",children:"기타문의"})]})]}),n.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[n.jsx("label",{children:"문의내용"}),n.jsx("textarea",{className:"subject-input",value:f.inquiryContent||"",onChange:j=>N("inquiryContent",j.target.value),style:{minHeight:80}})]}),n.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[n.jsx("label",{children:"답변내용"}),n.jsx("textarea",{className:"subject-input",value:f.answerContent||"",onChange:j=>N("answerContent",j.target.value),style:{minHeight:80}})]}),n.jsxs("div",{className:"inline-field",children:[n.jsxs("label",{children:["상태",n.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),n.jsxs("select",{className:"subject-input",value:f.inquiryStatus||"",onChange:j=>N("inquiryStatus",j.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"신규접수",children:"신규접수"}),n.jsx("option",{value:"확인 중",children:"확인 중"}),n.jsx("option",{value:"완료",children:"완료"}),n.jsx("option",{value:"보류",children:"보류"})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"난이도"}),n.jsxs("select",{className:"subject-input",value:f.severity||"",onChange:j=>N("severity",j.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"상",children:"상"}),n.jsx("option",{value:"중",children:"중"}),n.jsx("option",{value:"하",children:"하"})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"접수경로"}),n.jsxs("select",{className:"subject-input",value:f.channel||"",onChange:j=>N("channel",j.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"전화",children:"전화"}),n.jsx("option",{value:"이메일",children:"이메일"}),n.jsx("option",{value:"고객채널",children:"고객채널"}),n.jsx("option",{value:"직접입력",children:"직접입력"})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"잠재고객"}),n.jsx("input",{className:"subject-input",value:f.leadName||"",readOnly:!0,placeholder:"-"})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"거래처"}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("input",{className:"subject-input",value:f.customerName||"",onChange:j=>{N("customerName",j.target.value),N("customerSeq","")},placeholder:"거래처명",style:{paddingRight:28}}),n.jsx("button",{type:"button","aria-label":"거래처 검색",title:"거래처 검색",onClick:()=>x(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:n.jsx("img",{src:Pi,className:"icon",alt:"검색"})})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"거래처 담당자"}),n.jsx("input",{className:"subject-input",value:f.contactName||"",onChange:j=>N("contactName",j.target.value),placeholder:"이름"})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"접수자"}),n.jsx("input",{className:"subject-input",value:f.ownerName||"",readOnly:!0,title:"로그인 사용자"})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"당사 담당자"}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("input",{className:"subject-input",value:f.assigneeName||"",onChange:j=>{N("assigneeName",j.target.value),N("assigneeId","")},placeholder:"이름",style:{paddingRight:28}}),n.jsx("button",{type:"button","aria-label":"직원 검색",title:"직원 검색",onClick:()=>y(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:n.jsx("img",{src:Pi,className:"icon",alt:"검색"})})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"접수시각"}),n.jsx("input",{className:"subject-input",type:"datetime-local",value:f.openedAt||"",onChange:j=>N("openedAt",j.target.value)})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"종료시각"}),n.jsx("input",{className:"subject-input",type:"datetime-local",value:f.closedAt||"",onChange:j=>N("closedAt",j.target.value)})]})]}),n.jsxs("div",{className:"controls",style:{gap:8,justifyContent:"flex-end",alignItems:"center"},children:[r&&n.jsx("span",{className:"success",children:r}),n.jsx("button",{className:"btn",onClick:A,children:"저장"}),n.jsx("button",{className:"btn",onClick:L,children:"삭제"})]})]}):n.jsx("div",{className:"empty-state",children:"선택된 케이스가 없습니다."})}),[e,f,r]),[w,P]=c.useState(!1);async function _(j){try{const S=await fetch("/api/v1/inquiries",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)});if(!S.ok){const z=await S.text().catch(()=>"");alert("저장 실패: "+(z||S.status));return}const R=await S.json().catch(()=>null),O=R&&R.id!=null?Number(R.id):null;P(!1);try{window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.reload",{detail:{focusId:O}}))}catch{}}catch{alert("저장 중 오류가 발생했습니다")}}async function $(){try{const j=await fetch(`/api/v1/inquiries/${e.id}`,{method:"DELETE"});if(!j.ok){const S=await j.text().catch(()=>"");s("삭제 실패: "+(S||j.status));return}try{localStorage.removeItem("tnt.sales.selectedInquiry")}catch{}t(null),h("삭제 되었습니다.");try{window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.reload",{detail:{}}))}catch{}}catch{s("삭제 중 오류가 발생했습니다")}}async function L(){e!=null&&e.id&&l(!0)}return n.jsxs(n.Fragment,{children:[n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,minWidth:0,flex:"1 1 auto"},children:[n.jsx("h2",{style:{margin:0},children:"문의"}),(()=>{const j=["신규접수","확인 중","완료"],S=String(f.inquiryStatus||"").trim(),R=S==="보류";let O=j.indexOf(S);R&&(O=1),O<0&&(O=0);const z=Math.max(0,Math.min(100,Math.round(O/Math.max(1,j.length-1)*100)));return n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,flex:"0 1 520px"},children:[n.jsx("div",{className:"progress",style:{width:"min(520px, 48vw)"},children:n.jsx("div",{className:"progress-bar",style:{width:`${z}%`,background:R?"#ef4444":"var(--accent)"}})}),n.jsx("div",{style:{display:"flex",justifyContent:"space-between",width:"min(520px, 48vw)",fontSize:11,color:"var(--muted)"},children:j.map(Z=>n.jsx("span",{style:{fontWeight:S===Z?700:400},children:Z},Z))})]})})()]}),n.jsx("div",{className:"controls",style:{gap:8},children:n.jsx("button",{className:"btn",onClick:()=>P(!0),children:"신규 등록"})})]}),p&&n.jsx(E1,{defaultQuery:f.customerName,onClose:()=>x(!1),onSelect:j=>{N("customerSeq",j.customerSeq?String(j.customerSeq):""),N("customerName",j.customerName||""),x(!1)}}),v&&n.jsx(P1,{defaultQuery:f.leadName,onClose:()=>g(!1),onSelect:j=>{N("leadId",j.id!=null?String(j.id):""),N("leadName",j.companyName||""),g(!1)}}),b&&n.jsx(I1,{defaultQuery:f.assigneeName,onClose:()=>y(!1),onSelect:j=>{N("assigneeId",j.assigneeId||""),N("assigneeName",j.empName||""),y(!1)}}),n.jsx(w1,{compact:!0,maxHeight:"21vh"}),n.jsx("section",{className:"card",style:{marginTop:12,minHeight:240},children:E})]}),n.jsx(S1,{open:w,onClose:()=>P(!1),onSubmit:_}),n.jsx(ug,{open:!!i,onClose:()=>s(null),width:380,footer:n.jsx("button",{className:"btn",onClick:()=>s(null),children:"확인"}),children:i}),o&&n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:90},children:[n.jsx("div",{onClick:()=>l(!1),style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"24%",left:"50%",transform:"translateX(-50%)",width:380,maxWidth:"92vw",padding:12},children:[n.jsx("div",{style:{padding:"4px 2px",fontSize:13},children:"선택한 문의를 삭제하시겠습니까?"}),n.jsxs("div",{className:"controls",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:[n.jsx("button",{className:"btn",onClick:()=>l(!1),children:"취소"}),n.jsx("button",{className:"btn",onClick:()=>{l(!1),$()},children:"삭제"})]})]})]}),d&&n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:90},children:[n.jsx("div",{onClick:()=>h(null),style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"20%",left:"50%",transform:"translateX(-50%)",width:360,maxWidth:"92vw",padding:12},children:[n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h3",{style:{margin:0,fontSize:14},children:"알림"})}),n.jsx("div",{style:{padding:"4px 2px",fontSize:13},children:d}),n.jsx("div",{className:"controls",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:n.jsx("button",{className:"btn",onClick:()=>h(null),children:"확인"})})]})]})]})}function E1({defaultQuery:e,onClose:t,onSelect:r}){const[a,i]=c.useState(e||""),[s,o]=c.useState([]),[l,d]=c.useState(!1),[h,u]=c.useState(null);async function f(){d(!0),u(null);try{const m=new URL("/api/v1/customers",window.location.origin);a.trim()&&m.searchParams.set("name",a.trim()),m.searchParams.set("mineOnly","false"),m.searchParams.set("limit","100");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const x=await p.json(),v=Array.isArray(x)?x.map(g=>({customerSeq:(g==null?void 0:g.customerSeq)??(g==null?void 0:g.customer_seq)??null,customerId:(g==null?void 0:g.customerId)??(g==null?void 0:g.customer_id)??null,customerName:(g==null?void 0:g.customerName)??(g==null?void 0:g.customer_name)??null,telNo:(g==null?void 0:g.telNo)??(g==null?void 0:g.tel_no)??null,addrProvinceName:(g==null?void 0:g.addrProvinceName)??(g==null?void 0:g.addr_province_name)??null,addrCityName:(g==null?void 0:g.addrCityName)??(g==null?void 0:g.addr_city_name)??null,companyType:(g==null?void 0:g.companyType)??(g==null?void 0:g.company_type)??null,ownerName:(g==null?void 0:g.ownerName)??(g==null?void 0:g.owner_name)??null})):[];o(v)}catch(m){u((m==null?void 0:m.message)||"조회 실패"),o([])}finally{d(!1)}}return c.useEffect(()=>{f()},[]),c.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"거래처명",value:a,onChange:m=>i(m.target.value),onKeyDown:m=>{m.key==="Enter"&&f()},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:f,children:"조회"})]}),n.jsx("div",{className:"table-container",style:{height:360},children:s.length===0?n.jsx("div",{className:"empty-state",children:l?"불러오는 중…":h||"결과가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:220},children:"거래처명"}),n.jsx("th",{style:{width:140},children:"회사구분"}),n.jsx("th",{style:{width:140},children:"대표자명"}),n.jsx("th",{style:{width:180},children:"지역"})]})}),n.jsx("tbody",{children:s.map((m,p)=>n.jsxs("tr",{onDoubleClick:()=>r(m),onClick:()=>r(m),children:[n.jsx("td",{children:m.customerName||""}),n.jsx("td",{children:m.companyType||""}),n.jsx("td",{children:m.ownerName||""}),n.jsx("td",{children:[m.addrProvinceName,m.addrCityName].filter(Boolean).join(" ")})]},p))})]})})]})]})}function P1({defaultQuery:e,onClose:t,onSelect:r}){const[a,i]=c.useState(e||""),[s,o]=c.useState([]),[l,d]=c.useState(!1),[h,u]=c.useState(null);async function f(){d(!0),u(null);try{const m=new URL("/api/v1/leads",window.location.origin);a.trim()&&m.searchParams.set("company_name",a.trim()),m.searchParams.set("limit","100");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const x=await p.json(),v=Array.isArray(x)?x.map(g=>({id:(g==null?void 0:g.id)!=null?Number(g.id):null,companyName:(g==null?void 0:g.company_name)??null,leadStatus:(g==null?void 0:g.lead_status)??null,ownerName:(g==null?void 0:g.owner_name)??null,addrProvinceName:(g==null?void 0:g.addr_province_name)??null})):[];o(v)}catch(m){u((m==null?void 0:m.message)||"조회 실패"),o([])}finally{d(!1)}}return c.useEffect(()=>{f()},[]),c.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"잠재고객명",value:a,onChange:m=>i(m.target.value),onKeyDown:m=>{m.key==="Enter"&&f()},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:f,children:"조회"})]}),n.jsx("div",{className:"table-container",style:{height:360},children:s.length===0?n.jsx("div",{className:"empty-state",children:l?"불러오는 중…":h||"결과가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:220},children:"잠재고객명"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:140},children:"소유자"}),n.jsx("th",{style:{width:160},children:"지역"})]})}),n.jsx("tbody",{children:s.map((m,p)=>n.jsxs("tr",{onDoubleClick:()=>r(m),onClick:()=>r(m),children:[n.jsx("td",{children:m.companyName||""}),n.jsx("td",{children:m.leadStatus||""}),n.jsx("td",{children:m.ownerName||""}),n.jsx("td",{children:m.addrProvinceName||""})]},p))})]})})]})]})}function I1({defaultQuery:e,onClose:t,onSelect:r}){const[a,i]=c.useState(e||""),[s,o]=c.useState([]),[l,d]=c.useState(!1),[h,u]=c.useState(null);async function f(){d(!0),u(null);try{const m=new URL("/api/v1/employees",window.location.origin);m.searchParams.set("depts","all");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const x=await p.json(),v=Array.isArray(x)?x.map(y=>({empId:(y==null?void 0:y.emp_id)??null,empName:(y==null?void 0:y.emp_name)??null,deptName:(y==null?void 0:y.dept_name)??null,assigneeId:(y==null?void 0:y.assignee_id)??null})):[],g=a.trim().toLowerCase(),b=(g?v.filter(y=>(y.empName||"").toLowerCase().includes(g)||(y.empId||"").toLowerCase().includes(g)||(y.deptName||"").toLowerCase().includes(g)):v).sort((y,N)=>(y.empName||"").localeCompare(N.empName||"","ko",{sensitivity:"base"}));o(b)}catch(m){u((m==null?void 0:m.message)||"조회 실패"),o([])}finally{d(!1)}}return c.useEffect(()=>{f()},[]),c.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:700,maxHeight:"80%",overflow:"auto",padding:12},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"이름/사번/부서",value:a,onChange:m=>i(m.target.value),onKeyDown:m=>{m.key==="Enter"&&f()},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:f,children:"조회"})]}),n.jsx("div",{className:"table-container",style:{height:320},children:s.length===0?n.jsx("div",{className:"empty-state",children:l?"불러오는 중…":h||"결과가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:160},children:"이름"}),n.jsx("th",{style:{width:160},children:"부서"}),n.jsx("th",{style:{width:140},children:"사번"}),n.jsx("th",{style:{width:140},children:"assignee_id"})]})}),n.jsx("tbody",{children:s.map((m,p)=>n.jsxs("tr",{onDoubleClick:()=>r(m),onClick:()=>r(m),children:[n.jsx("td",{children:m.empName||""}),n.jsx("td",{children:m.deptName||""}),n.jsx("td",{children:m.empId||""}),n.jsx("td",{children:m.assigneeId||""})]},p))})]})})]})]})}function T1({compact:e=!1,maxHeight:t}){const[r,a]=c.useState([]),[i,s]=c.useState(!1),[o,l]=c.useState(null),[d,h]=c.useState(()=>{try{const p=localStorage.getItem("tnt.sales.selectedEstimate");if(p){const x=JSON.parse(p),v=Number(x==null?void 0:x.id);return Number.isFinite(v)?v:null}}catch{}return null});async function u(){l(null),s(!0);try{const p=["/api/v1/estimates","/api/v1/quotes"];let x=null;for(const g of p)try{const b=await fetch(g);if(b.ok){x=await b.json();break}}catch{}let v=[];Array.isArray(x)?v=x.map((g,b)=>({id:Number((g==null?void 0:g.id)??b+1),estimateNumber:String((g==null?void 0:g.estimateNumber)??(g==null?void 0:g.estimate_number)??""),title:String((g==null?void 0:g.title)??""),status:String((g==null?void 0:g.status)??""),owner:String((g==null?void 0:g.owner)??(g==null?void 0:g.ownerId)??(g==null?void 0:g.owner_id)??""),issuedAt:String((g==null?void 0:g.issuedAt)??(g==null?void 0:g.issued_at)??"")})):v=[{id:1,estimateNumber:"E-2025-0001",title:"제품 견적 A",status:"draft",owner:"kim",issuedAt:"2025-02-01T10:00:00Z"},{id:2,estimateNumber:"E-2025-0002",title:"서비스 견적 B",status:"sent",owner:"lee",issuedAt:"2025-02-03T11:00:00Z"}],v.sort((g,b)=>(g.title||"").localeCompare(b.title||"","ko",{sensitivity:"base"})),a(v),v.length>0&&d==null&&f(v[0])}catch(p){l((p==null?void 0:p.message)||"조회 중 오류가 발생했습니다")}finally{s(!1)}}c.useEffect(()=>{u()},[]);function f(p){h(p.id);try{localStorage.setItem("tnt.sales.selectedEstimate",JSON.stringify(p)),window.dispatchEvent(new CustomEvent("tnt.sales.estimate.selected",{detail:{estimate:p}}))}catch{}}return c.useMemo(()=>n.jsx("div",{className:"table-container",style:{maxHeight:t??(e?"32vh":void 0)},children:r.length===0?n.jsx("div",{className:"empty-state",children:i?"불러오는 중…":o||"데이터가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:140},children:"견적번호"}),n.jsx("th",{children:"제목"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:140},children:"소유자"}),n.jsx("th",{style:{width:180},children:"발행시각"})]})}),n.jsx("tbody",{children:r.map((p,x)=>n.jsxs("tr",{className:d===p.id?"selected":void 0,onClick:()=>f(p),children:[n.jsx("td",{children:p.estimateNumber||""}),n.jsx("td",{children:p.title||""}),n.jsx("td",{children:p.status||""}),n.jsx("td",{children:p.owner||""}),n.jsx("td",{children:p.issuedAt?(()=>{const v=new Date(p.issuedAt);if(isNaN(v.getTime()))return p.issuedAt;const g=String(v.getFullYear()%100).padStart(2,"0"),b=String(v.getMonth()+1).padStart(2,"0"),y=String(v.getDate()).padStart(2,"0"),N=String(v.getHours()).padStart(2,"0"),A=String(v.getMinutes()).padStart(2,"0");return`${g}-${b}-${y} ${N}:${A}`})():""})]},x))})]})}),[r,d,i,o,e,t])}function O1(){const[e,t]=c.useState(()=>{try{const s=localStorage.getItem("tnt.sales.selectedEstimate");return s?JSON.parse(s):null}catch{return null}});c.useEffect(()=>{const s=()=>{try{const o=localStorage.getItem("tnt.sales.selectedEstimate");t(o?JSON.parse(o):null)}catch{t(null)}};return window.addEventListener("tnt.sales.estimate.selected",s),()=>window.removeEventListener("tnt.sales.estimate.selected",s)},[]);const r=c.useMemo(()=>n.jsx("div",{className:"card",style:{padding:12},children:e?n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"견적번호"}),n.jsx("div",{className:"subject-input",children:e.estimateNumber||""})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"상태"}),n.jsx("div",{className:"subject-input",children:e.status||""})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"제목"}),n.jsx("div",{className:"subject-input",children:e.title||""})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"소유자"}),n.jsx("div",{className:"subject-input",children:e.owner||""})]})]}):n.jsx("div",{className:"empty-state",children:"선택된 견적이 없습니다."})}),[e]),[a,i]=c.useState("details");return n.jsxs("section",{children:[n.jsx("div",{className:"page-title",children:n.jsx("h2",{children:"견적"})}),n.jsx(T1,{compact:!0,maxHeight:"32vh"}),n.jsxs("section",{className:"card",style:{marginTop:12,minHeight:240},children:[n.jsxs("div",{className:"tabs c360-tabs",children:[n.jsx("button",{className:a==="details"?"tab active":"tab",onClick:()=>i("details"),children:"상세"}),n.jsx("button",{className:a==="items"?"tab active":"tab",onClick:()=>i("items"),children:"품목"}),n.jsx("button",{className:a==="attachments"?"tab active":"tab",onClick:()=>i("attachments"),children:"첨부"})]}),n.jsxs("div",{style:{marginTop:12},children:[a==="details"&&r,a==="items"&&n.jsx("div",{className:"empty-state",children:"견적 품목(추후)"}),a==="attachments"&&n.jsx("div",{className:"empty-state",children:"첨부 파일(추후)"})]})]})]})}function _1(){const[e,t]=c.useState(()=>Wf()),[r,a]=c.useState(Kl());c.useEffect(()=>Xb(()=>a(Kl())),[]);function i(s){const o=!Gl(s);Qb(s,o),a(Kl())}return n.jsxs("section",{children:[n.jsx("h1",{children:"설정"}),n.jsx("p",{className:"muted",children:"좌측 메뉴(1, 2 레벨)를 표시/숨김으로 제어합니다. 모든 사용자에게 동일하게 적용됩니다(임시: 로컬 저장소 기반)."}),n.jsx("div",{style:{display:"flex",gap:24,alignItems:"flex-start",marginTop:12},children:n.jsxs("div",{style:{flex:1},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n.jsx("h3",{style:{margin:"12px 0"},children:"메뉴 표시 설정"}),n.jsx("button",{className:"btn",onClick:()=>t(Wf()),children:"메뉴 다시 읽기"})]}),n.jsx("ul",{style:{listStyle:"none",padding:0,margin:0},children:e.map(s=>{var o;return n.jsxs("li",{style:{marginBottom:10},children:[n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Gl(s.key),onChange:()=>i(s.key)}),n.jsx("strong",{children:s.label}),n.jsxs("span",{className:"muted",style:{fontSize:12},children:["(",s.key,")"]})]}),(o=s.children)!=null&&o.length?n.jsx("ul",{style:{listStyle:"none",padding:"6px 0 0 22px",margin:0},children:s.children.map(l=>n.jsx("li",{style:{marginBottom:6},children:n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Gl(l.key),onChange:()=>i(l.key)}),n.jsx("span",{children:l.label}),n.jsxs("span",{className:"muted",style:{fontSize:12},children:["(",l.key,")"]})]})},l.key))}):null]},s.key)})})]})})]})}function D1(){const[e,t]=c.useState(null),[r,a]=c.useState({}),[i,s]=c.useState(null),[o,l]=c.useState({open:!1,text:""}),[d,h]=c.useState([]),u=c.useMemo(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||""}catch{return""}},[]),f=c.useMemo(()=>{try{return localStorage.getItem("tnt.sales.empId")||""}catch{return""}},[]);c.useEffect(()=>{const C=()=>{try{const T=localStorage.getItem("tnt.sales.selectedLead"),W=T?JSON.parse(T):null;t(W),a({...W||{}}),s(null)}catch{t(null),a({}),s(null)}};return window.addEventListener("tnt.sales.lead.selected",C),()=>window.removeEventListener("tnt.sales.lead.selected",C)},[]);function m(C,T){a(W=>({...W,[C]:T})),i&&s(null)}async function p(){if(!(!r||r.id==null))try{const C={...r};delete C.created_by_name,delete C.updated_by_name,delete C.created_at,delete C.updated_at;try{(!r.assignee_id||String(r.assignee_id).trim()==="")&&(delete C.assignee_id,delete C.owner_name,delete C.owner_id)}catch{}try{const I=localStorage.getItem("tnt.sales.assigneeId")||"";I&&(C.updated_by=I)}catch{}const T=await fetch(`/api/v1/leads/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)});if(!T.ok)throw new Error(`HTTP ${T.status}`);const W=await T.json().catch(()=>({}));if(W!=null&&W.ok){const I=r.company_name||"";l({open:!0,text:`${I} 수정되었습니다.`});try{const U=await fetch(`/api/v1/leads/${r.id}`),K=U.ok?await U.json():r;a(Y=>({...Y,...K||{}})),t(Y=>({...Y||{},...K||{}})),localStorage.setItem("tnt.sales.selectedLead",JSON.stringify(K||r)),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:K||r}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:K||r}}))}catch{try{localStorage.setItem("tnt.sales.selectedLead",JSON.stringify(r)),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:r}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:r}}))}catch{}}}else throw new Error("저장 실패")}catch(C){s((C==null?void 0:C.message)||"저장 중 오류가 발생했습니다")}}c.useEffect(()=>{(async()=>{try{const C=await fetch("/api/v1/employees");if(!C.ok)return;const T=await C.json();if(Array.isArray(T)){let W=[...T];if(!W.some(U=>String((U==null?void 0:U.emp_name)||"")==="윤이랑"))try{const U=await fetch("/api/v1/employees?depts=all");if(U.ok){const K=await U.json();if(Array.isArray(K)){const Y=K.find(M=>String((M==null?void 0:M.emp_name)||"")==="윤이랑");Y&&(W=[...W,Y])}}}catch{}h(W)}}catch{}})()},[]);const x=!r||r.id==null,[v,g]=c.useState(!1),[b,y]=c.useState(""),[N,A]=c.useState(""),[E,w]=c.useState(!1),[P,_]=c.useState({}),[$,L]=c.useState(!1),{ref:j,style:S,bindHeader:R,bindContainer:O}=wn("lead.tm",v,C=>{const T=document.querySelector(".pane.center"),W=T?T.getBoundingClientRect():null,I=C.getBoundingClientRect(),U=I.width,K=I.height,Y=W?W.left+(W.width-U)/2:(window.innerWidth-U)/2,M=Math.max(0,window.innerHeight-K-16),D=Math.min(Math.max(0,Y),window.innerWidth-U),oe=Math.min(Math.max(0,M),window.innerHeight-K);return{x:D,y:oe}},{persist:!1,resetOnOpen:!0}),{ref:z,style:Z,bindHeader:ae,bindContainer:se}=wn("lead.new",E,C=>{const T=document.querySelector(".pane.center"),W=T?T.getBoundingClientRect():null,I=C.getBoundingClientRect(),U=I.width,K=I.height,Y=W?W.left+(W.width-U)/2:(window.innerWidth-U)/2,M=Math.max(0,window.innerHeight*.1),D=Math.min(Math.max(0,Y),window.innerWidth-U),oe=Math.min(Math.max(0,M),window.innerHeight-K);return{x:D,y:oe}},{persist:!1,resetOnOpen:!0});c.useEffect(()=>{if(!E)return;const C=T=>{T.key==="Escape"&&w(!1)};return window.addEventListener("keydown",C,!0),()=>window.removeEventListener("keydown",C,!0)},[E]),c.useEffect(()=>{if(!v)return;const C=T=>{T.key==="Escape"&&g(!1)};return window.addEventListener("keydown",C,!0),()=>window.removeEventListener("keydown",C,!0)},[v]);function H(C){if(!C)return"";const T=new Date(C);return isNaN(T.getTime())?String(C):new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).format(T)}const q=c.useMemo(()=>{const C=["신규등록","접촉 중","영업 접촉 중","전환성공"],T=((r==null?void 0:r.lead_status)||"").trim(),W=T==="자격미달"||T==="전환실패";let I=C.indexOf(T);T==="자격미달"&&(I=1),T==="전환실패"&&(I=C.length-1),I<0&&(I=0);const U=Math.max(0,Math.min(100,Math.round(I/Math.max(1,C.length-1)*100)));return n.jsxs("div",{className:"page-title",children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,minWidth:0,flex:"1 1 auto"},children:[n.jsx("h2",{style:{margin:0},children:"잠재고객"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,flex:"0 1 520px"},children:[n.jsx("div",{className:"progress",style:{width:"min(520px, 48vw)"},children:n.jsx("div",{className:"progress-bar",style:{width:`${U}%`,background:W?"#ef4444":"var(--accent)"}})}),n.jsx("div",{style:{display:"flex",justifyContent:"space-between",width:"min(520px, 48vw)",fontSize:11,color:"var(--muted)"},children:C.map(K=>n.jsx("span",{style:{fontWeight:T===K?700:400},children:K},K))})]})]}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsx("button",{className:"btn",onClick:()=>{_({}),w(!0)},children:"신규"}),n.jsx("button",{className:"btn",onClick:()=>L(!0),disabled:x,children:"영업활동 등록"}),n.jsx("button",{className:"btn",onClick:()=>{g(!0),s(null)},disabled:x,children:"TM활동 등록"})]})]})},[x,r.lead_status]);return n.jsxs("section",{children:[q,n.jsx("div",{className:"card",style:{padding:12},children:r&&r.id!=null?n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",columnGap:10,rowGap:6},children:[n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"상태"}),n.jsxs("select",{className:"search-input",value:r.lead_status||"",onChange:C=>m("lead_status",C.target.value),children:[n.jsx("option",{value:"",children:"(선택)"}),n.jsx("option",{value:"신규등록",children:"신규등록"}),n.jsx("option",{value:"자격미달",children:"자격미달"}),n.jsx("option",{value:"접촉 중",children:"접촉 중"}),n.jsx("option",{value:"영업 접촉 중",children:"영업 접촉 중"}),n.jsx("option",{value:"전환성공",children:"전환성공"}),n.jsx("option",{value:"전환실패",children:"전환실패"})]})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"소스"}),n.jsxs("select",{className:"search-input",value:r.lead_source||"",onChange:C=>m("lead_source",C.target.value),children:[n.jsx("option",{value:"",children:"(선택)"}),n.jsx("option",{value:"목록구매",children:"목록구매"}),n.jsx("option",{value:"내부추천",children:"내부추천"}),n.jsx("option",{value:"외부추천",children:"외부추천"}),n.jsx("option",{value:"전시회/행사",children:"전시회/행사"})]})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"회사"}),n.jsx("input",{className:"search-input",type:"text",value:r.company_name||"",onChange:C=>m("company_name",C.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"거래처 담당자"}),n.jsx("input",{className:"search-input",type:"text",value:r.contact_name||"",onChange:C=>m("contact_name",C.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"이메일"}),n.jsx("input",{className:"search-input",type:"text",value:r.email||"",onChange:C=>m("email",C.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"연락처"}),n.jsx("input",{className:"search-input",type:"text",value:r.contact_phone||"",onChange:C=>m("contact_phone",C.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"대표번호"}),n.jsx("input",{className:"search-input",type:"text",value:r.office_phone||"",onChange:C=>m("office_phone",C.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"업종"}),n.jsxs("select",{className:"search-input",value:r.biz_type||"",onChange:C=>m("biz_type",C.target.value),children:[n.jsx("option",{value:"",children:"(선택)"}),n.jsx("option",{value:"가공",children:"가공"}),n.jsx("option",{value:"시공",children:"시공"}),n.jsx("option",{value:"가시공",children:"가시공"}),n.jsx("option",{value:"유통",children:"유통"}),n.jsx("option",{value:"알수없음",children:"알수없음"})]})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"사업자번호"}),n.jsx("input",{className:"search-input",type:"text",value:r.biz_no||"",onChange:C=>m("biz_no",C.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"지역(도/광역)"}),n.jsx("input",{className:"search-input",type:"text",value:r.addr_province_name||"",onChange:C=>m("addr_province_name",C.target.value)})]}),n.jsxs("div",{className:"field inline-field",style:{gridColumn:"1 / -1"},children:[n.jsx("label",{children:"주소"}),n.jsx("input",{className:"search-input",type:"text",value:r.address||"",onChange:C=>m("address",C.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"팩스"}),n.jsx("input",{className:"search-input",type:"text",value:r.fax_no||"",onChange:C=>m("fax_no",C.target.value)})]}),n.jsxs("div",{className:"field inline-field",style:{gridColumn:"1 / -1"},children:[n.jsx("label",{children:"비고"}),n.jsx("textarea",{className:"search-input",value:r.note||"",onChange:C=>m("note",C.target.value),style:{minHeight:80}})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"소유자"}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsxs("select",{className:"search-input",value:r.assignee_id||"",onChange:C=>m("assignee_id",C.target.value||null),style:{flex:1},children:[n.jsx("option",{value:"",children:"(선택)"}),d.map(C=>n.jsxs("option",{value:C.assignee_id,children:[C.dept_name," · ",C.emp_name]},C.assignee_id))]}),n.jsx("div",{style:{whiteSpace:"nowrap",fontSize:11,color:"var(--muted)"},children:(()=>{const C=r.owner_name&&String(r.owner_name).trim()?String(r.owner_name):"",T=r.assignee_id||"",W=d.find(U=>U.assignee_id===T);return`현재: ${C||(W?W.emp_name:"")||"-"}`})()})]})]}),n.jsxs("div",{className:"field inline-four",style:{gridColumn:"1 / -1"},children:[n.jsx("label",{children:"작성자"}),n.jsxs("div",{className:"subject-input",style:{padding:"6px 8px"},children:[r.created_by_name||(r.created_by??"")||u||f,r.created_at?`, ${H(r.created_at)}`:""]}),n.jsx("label",{children:"최종 수정자"}),n.jsxs("div",{className:"subject-input",style:{padding:"6px 8px"},children:[r.updated_by_name||(r.updated_by??"")||u||f,r.updated_at?`, ${H(r.updated_at)}`:""]})]})]}),n.jsxs("div",{className:"controls",style:{justifyContent:"space-between",marginTop:10,gap:8},children:[n.jsx("div",{"aria-live":"polite",style:{fontSize:12,color:"var(--accent)"},children:i||""}),n.jsx("div",{children:n.jsxs("div",{style:{display:"inline-flex",gap:8},children:[n.jsx("button",{className:"btn",onClick:p,disabled:x,children:"저장"}),x?null:n.jsx("button",{className:"btn btn-danger",onClick:async()=>{if(r!=null&&r.id){`${r.id}`;try{const C=await fetch(`/api/v1/leads/${r.id}`,{method:"DELETE"});if(!C.ok){const T=await C.json().catch(()=>null);throw new Error((T==null?void 0:T.message)||`HTTP ${C.status}`)}l({open:!0,text:"삭제되었습니다."}),a({}),t(null),localStorage.removeItem("tnt.sales.selectedLead"),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:null}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:null}}))}catch(C){s((C==null?void 0:C.message)||"삭제 중 오류가 발생했습니다")}}},children:"삭제"})]})})]})]}):n.jsx("div",{className:"empty-state",children:"우측에서 잠재고객을 선택하세요."})}),v&&n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e4,pointerEvents:"none"},children:[n.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)",pointerEvents:"none"}}),n.jsxs("div",{ref:j,className:"card",style:{...S,width:"min(720px, 92vw)",maxHeight:"80vh",overflow:"auto",padding:16,pointerEvents:"auto"},...O,children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10,cursor:"move"},...R,children:[n.jsx("h3",{style:{margin:0},children:"TM 활동 등록"}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:()=>g(!1),onKeyDown:C=>{(C.key==="Enter"||C.key===" ")&&(C.preventDefault(),g(!1))},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"제목"}),n.jsx("input",{className:"search-input",type:"text",value:b,onChange:C=>y(C.target.value),placeholder:"제목"})]}),n.jsxs("div",{className:"field inline-field row-2",children:[n.jsx("label",{children:"활동 설명"}),n.jsx("textarea",{className:"search-input",value:N,onChange:C=>A(C.target.value),placeholder:"활동 설명",style:{minHeight:100}})]}),n.jsxs("div",{className:"field inline-field row-2",children:[n.jsx("label",{children:"잠재고객"}),n.jsxs("div",{className:"subject-input",style:{padding:"6px 8px"},children:[r.company_name||"",r.contact_name?` / ${r.contact_name}`:"",r.contact_phone?` / ${r.contact_phone}`:""]})]}),n.jsxs("div",{className:"controls",style:{justifyContent:"flex-end",marginTop:10,gap:8},children:[n.jsx("button",{className:"btn",onClick:()=>g(!1),children:"취소"}),n.jsx("button",{className:"btn",onClick:async()=>{try{const C=localStorage.getItem("tnt.sales.assigneeId")||localStorage.getItem("tnt.sales.empId")||"";if(!C){s("로그인이 필요합니다");return}const T={sfOwnerId:C,subject:b||"",description:N||"",activityType:"전화",activityStatus:"계획",channel:"전화",sfLeadId:(r==null?void 0:r.id)!=null?String(r.id):void 0,createdBy:localStorage.getItem("tnt.sales.empId")||void 0,updatedBy:localStorage.getItem("tnt.sales.empId")||void 0},W=await fetch("/api/v1/sales-activities",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(!W.ok){let I=`HTTP ${W.status}`;try{const U=await W.json();U!=null&&U.error&&(I=U.error)}catch{}throw new Error(I)}g(!1),y(""),A("");try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated",{detail:{leadId:r==null?void 0:r.id}}))}catch{}l({open:!0,text:"TM 활동이 등록되었습니다."})}catch(C){s((C==null?void 0:C.message)||"TM 활동 등록 실패")}},children:"저장"})]})]})]}),E&&n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e4,pointerEvents:"none"},children:[n.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)",pointerEvents:"none"}}),n.jsxs("div",{ref:z,className:"card",style:{...Z,width:"min(880px, 96vw)",maxHeight:"86vh",overflow:"auto",padding:16,pointerEvents:"auto"},...se,children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10,cursor:"move"},...ae,children:[n.jsx("h3",{style:{margin:0},children:"잠재고객 신규"}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:()=>w(!1),children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",columnGap:10,rowGap:6},children:[n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"상태"}),n.jsxs("select",{className:"search-input",value:P.lead_status||"",onChange:C=>_(T=>({...T,lead_status:C.target.value})),children:[n.jsx("option",{value:"",children:"(선택)"}),n.jsx("option",{value:"신규등록",children:"신규등록"}),n.jsx("option",{value:"자격미달",children:"자격미달"}),n.jsx("option",{value:"접촉 중",children:"접촉 중"}),n.jsx("option",{value:"영업 접촉 중",children:"영업 접촉 중"}),n.jsx("option",{value:"전환성공",children:"전환성공"}),n.jsx("option",{value:"전환실패",children:"전환실패"})]})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"소스"}),n.jsxs("select",{className:"search-input",value:P.lead_source||"",onChange:C=>_(T=>({...T,lead_source:C.target.value})),children:[n.jsx("option",{value:"",children:"(선택)"}),n.jsx("option",{value:"목록구매",children:"목록구매"}),n.jsx("option",{value:"내부추천",children:"내부추천"}),n.jsx("option",{value:"외부추천",children:"외부추천"}),n.jsx("option",{value:"전시회/행사",children:"전시회/행사"})]})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"회사"}),n.jsx("input",{className:"search-input",type:"text",value:P.company_name||"",onChange:C=>_(T=>({...T,company_name:C.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"거래처 담당자"}),n.jsx("input",{className:"search-input",type:"text",value:P.contact_name||"",onChange:C=>_(T=>({...T,contact_name:C.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"이메일"}),n.jsx("input",{className:"search-input",type:"text",value:P.email||"",onChange:C=>_(T=>({...T,email:C.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"연락처"}),n.jsx("input",{className:"search-input",type:"text",value:P.contact_phone||"",onChange:C=>_(T=>({...T,contact_phone:C.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"대표번호"}),n.jsx("input",{className:"search-input",type:"text",value:P.office_phone||"",onChange:C=>_(T=>({...T,office_phone:C.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"업종"}),n.jsxs("select",{className:"search-input",value:P.biz_type||"",onChange:C=>_(T=>({...T,biz_type:C.target.value})),children:[n.jsx("option",{value:"",children:"(선택)"}),n.jsx("option",{value:"가공",children:"가공"}),n.jsx("option",{value:"시공",children:"시공"}),n.jsx("option",{value:"가시공",children:"가시공"}),n.jsx("option",{value:"유통",children:"유통"}),n.jsx("option",{value:"알수없음",children:"알수없음"})]})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"사업자번호"}),n.jsx("input",{className:"search-input",type:"text",value:P.biz_no||"",onChange:C=>_(T=>({...T,biz_no:C.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"지역(도/광역)"}),n.jsx("input",{className:"search-input",type:"text",value:P.addr_province_name||"",onChange:C=>_(T=>({...T,addr_province_name:C.target.value}))})]}),n.jsxs("div",{className:"field inline-field",style:{gridColumn:"1 / -1"},children:[n.jsx("label",{children:"주소"}),n.jsx("input",{className:"search-input",type:"text",value:P.address||"",onChange:C=>_(T=>({...T,address:C.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"팩스"}),n.jsx("input",{className:"search-input",type:"text",value:P.fax_no||"",onChange:C=>_(T=>({...T,fax_no:C.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"소유자"}),n.jsxs("select",{className:"search-input",value:P.assignee_id||"",onChange:C=>_(T=>({...T,assignee_id:C.target.value||null})),children:[n.jsx("option",{value:"",children:"(선택)"}),d.map(C=>n.jsxs("option",{value:C.assignee_id,children:[C.dept_name," · ",C.emp_name]},C.assignee_id))]})]}),n.jsxs("div",{className:"field inline-field",style:{gridColumn:"1 / -1"},children:[n.jsx("label",{children:"비고"}),n.jsx("textarea",{className:"search-input",value:P.note||"",onChange:C=>_(T=>({...T,note:C.target.value})),style:{minHeight:80}})]})]}),n.jsxs("div",{className:"controls",style:{justifyContent:"space-between",marginTop:10,gap:8},children:[n.jsx("div",{"aria-live":"polite",style:{fontSize:12,color:"#ef4444"},children:i||""}),n.jsxs("div",{style:{display:"flex",gap:8},children:[n.jsx("button",{className:"btn",onClick:()=>{w(!1),s(null)},children:"취소"}),n.jsx("button",{className:"btn",onClick:async()=>{try{const C={...P},T=localStorage.getItem("tnt.sales.empId")||void 0;T&&(C.created_by=T,C.updated_by=T);const W=await fetch("/api/v1/leads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)}),I=await W.json().catch(()=>({}));if(!W.ok||I&&I.error)throw new Error((I==null?void 0:I.error)||`HTTP ${W.status}`);const U=I==null?void 0:I.id;if(!U||U===-1)throw new Error("저장 실패: ID를 받지 못했습니다");const K={...P||{},id:U};try{localStorage.setItem("tnt.sales.selectedLead",JSON.stringify(K)),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:K}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:K}}))}catch{}w(!1),_({});const Y=P.company_name||"";l({open:!0,text:`${Y} 신규 생성되었습니다.`})}catch(C){s((C==null?void 0:C.message)||"저장 중 오류가 발생했습니다")}},children:"저장"})]})]})]})]}),n.jsx(dg,{open:$,onClose:()=>L(!1),leadId:(r==null?void 0:r.id)??null,leadName:(r==null?void 0:r.company_name)||""}),o.open?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:o.text}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>l({open:!1,text:""}),children:"확인"})})]})}):null]})}function Ql(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function M1({leadId:e}){const[t,r]=c.useState([]),[a,i]=c.useState(!1),[s,o]=c.useState(null),[l,d]=c.useState(()=>({open:!1,x:0,y:0})),[h,u]=c.useState(!1),[f,m]=c.useState(""),[p,x]=c.useState(""),[v,g]=c.useState(null),[b,y]=c.useState({open:!1,text:""});async function N(){if(!e){r([]);return}i(!0),o(null);try{const P=new URL("/api/v1/sales-activities",window.location.origin);P.searchParams.set("mineOnly","false"),P.searchParams.set("sfLeadId",String(e));const _=await fetch(P.toString());if(!_.ok)throw new Error(`HTTP ${_.status}`);const $=await _.json(),L=Array.isArray($)?$.map(j=>({id:Number(j==null?void 0:j.id),subject:(j==null?void 0:j.subject)??"",description:(j==null?void 0:j.description)??"",activityType:(j==null?void 0:j.activityType)??"",activityStatus:(j==null?void 0:j.activityStatus)??"",channel:(j==null?void 0:j.channel)??"",plannedStartAt:(j==null?void 0:j.plannedStartAt)??null,plannedEndAt:(j==null?void 0:j.plannedEndAt)??null,createdAt:(j==null?void 0:j.createdAt)??null,lastUpdateAt:(j==null?void 0:j.lastUpdateAt)??null,ownerName:(j==null?void 0:j.ownerName)??(j==null?void 0:j.owner_name)??""})):[];r(L)}catch(P){o((P==null?void 0:P.message)||"조회 중 오류가 발생했습니다"),r([])}finally{i(!1)}}c.useEffect(()=>{N()},[e]),c.useEffect(()=>{const P=()=>{N()};return window.addEventListener("tnt.sales.activity.updated",P),()=>window.removeEventListener("tnt.sales.activity.updated",P)},[e]),c.useEffect(()=>{if(!h)return;const P=_=>{_.key==="Escape"&&u(!1)};return window.addEventListener("keydown",P,!0),()=>window.removeEventListener("keydown",P,!0)},[h]),c.useEffect(()=>{h||(A.current=null)},[h]),c.useEffect(()=>{if(!l.open)return;const P=()=>d({open:!1,x:0,y:0}),_=$=>{$.key==="Escape"&&d({open:!1,x:0,y:0})};return window.addEventListener("click",P,!1),window.addEventListener("keydown",_,!0),()=>{window.removeEventListener("click",P,!1),window.removeEventListener("keydown",_,!0)}},[l.open]);const A=c.useRef(null);function E(P){g(P.id),A.current!==P.id&&(m(P.subject||""),x(P.description||""),A.current=P.id),u(!0)}const w=c.useMemo(()=>n.jsxs("div",{className:"table-container",style:{maxHeight:"calc(100vh - 260px)",overflow:"auto"},children:[t.length===0?n.jsx("div",{className:"empty-state",children:a?"불러오는 중…":s||"활동이 없습니다."}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:120},children:"담당자"}),n.jsx("th",{style:{width:260},children:"제목"}),n.jsx("th",{children:"활동내역"}),n.jsx("th",{style:{width:150},children:"계획일시"}),n.jsx("th",{style:{width:150},children:"종료 일시"}),n.jsx("th",{style:{width:120},children:"활동유형"}),n.jsx("th",{style:{width:120},children:"활동상태"}),n.jsx("th",{style:{width:180},children:"최종 수정일"})]})}),n.jsx("tbody",{children:t.map(P=>n.jsxs("tr",{onContextMenu:_=>{_.preventDefault(),_.stopPropagation(),d({open:!0,x:_.clientX,y:_.clientY,row:P})},children:[n.jsx("td",{title:P.ownerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:P.ownerName||""}),n.jsx("td",{title:P.subject||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:P.subject||""}),n.jsx("td",{title:P.description||"",style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:P.description||""}),n.jsx("td",{children:Ql(P.plannedStartAt)}),n.jsx("td",{children:Ql(P.plannedEndAt)}),n.jsx("td",{children:P.activityType||""}),n.jsx("td",{children:P.activityStatus||""}),n.jsx("td",{children:Ql(P.lastUpdateAt)})]},P.id))})]}),l.open&&l.row&&n.jsx("div",{className:"context-menu",style:{left:l.x+4,top:l.y+4},onClick:P=>P.stopPropagation(),children:n.jsx("button",{className:"context-item",style:{width:96,padding:"4px 6px"},onClick:P=>{P.preventDefault(),P.stopPropagation(),E(l.row),d({open:!1,x:0,y:0})},children:"수정"})})]}),[t,a,s,l]);return n.jsxs("section",{children:[w,h&&n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:2e4},children:[n.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",left:"50%",top:"20%",transform:"translateX(-50%)",width:"min(720px, 92vw)",maxHeight:"80vh",overflow:"auto",padding:16},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[n.jsx("h3",{style:{margin:0},children:"TM 활동 수정"}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:()=>u(!1),children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"제목"}),n.jsx("input",{className:"search-input",type:"text",value:f,onChange:P=>m(P.target.value),placeholder:"제목"})]}),n.jsxs("div",{className:"field inline-field row-2",children:[n.jsx("label",{children:"활동 설명"}),n.jsx("textarea",{className:"search-input",value:p,onChange:P=>x(P.target.value),placeholder:"활동 설명",style:{minHeight:100}})]}),n.jsxs("div",{className:"controls",style:{justifyContent:"flex-end",marginTop:10,gap:8},children:[n.jsx("button",{className:"btn",onClick:()=>u(!1),children:"취소"}),n.jsx("button",{className:"btn",onClick:async()=>{try{if(!v)return;const P={subject:f||"",description:p||""},_=await fetch(`/api/v1/sales-activities/${v}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)});if(!_.ok)throw new Error(`HTTP ${_.status}`);u(!1),y({open:!0,text:`${(f||"").trim()||"(제목없음)"} 변경되었습니다.`});try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated",{detail:{id:v}}))}catch{}}catch{}},children:"저장"})]})]})]}),b.open?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:b.text}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>y({open:!1,text:""}),children:"확인"})})]})}):null]})}function $1(){const[e,t]=c.useState(null);return c.useEffect(()=>{try{localStorage.removeItem("tnt.sales.selectedLead")}catch{}const r=()=>{try{const a=localStorage.getItem("tnt.sales.selectedLead");t(a?JSON.parse(a):null)}catch{t(null)}};return window.addEventListener("tnt.sales.lead.selected",r),()=>window.removeEventListener("tnt.sales.lead.selected",r)},[]),n.jsxs("section",{children:[n.jsx(D1,{}),n.jsxs("section",{className:"card",style:{marginTop:12,minHeight:240},children:[n.jsx("div",{className:"tabs c360-tabs",children:n.jsx("button",{className:"tab active",children:"활동"})}),n.jsx("div",{style:{marginTop:12},children:e!=null&&e.id?n.jsx(M1,{leadId:e.id}):n.jsx("div",{style:{minHeight:160}})})]})]})}function L1(e){if(!e)return"-";const t=new Date(e);if(Number.isNaN(t.getTime()))return"-";const r=d=>String(d).padStart(2,"0"),a=r(t.getFullYear()%100),i=r(t.getMonth()+1),s=r(t.getDate()),o=r(t.getHours()),l=r(t.getMinutes());return`${a}-${i}-${s} ${o}:${l}`}function R1(){const[e,t]=c.useState("weekly"),[r,a]=c.useState("owner"),[i,s]=c.useState(""),[o,l]=c.useState(()=>new Date().toISOString().split("T")[0]),[d,h]=c.useState([]),[u,f]=c.useState([]),[m,p]=c.useState(null),[x,v]=c.useState([]),[g,b]=c.useState(null),[y,N]=c.useState(!1),[A,E]=c.useState([]);c.useEffect(()=>{(async()=>{try{const j=await fetch("/api/v1/employees");if(!j.ok)return;const S=await j.json();if(Array.isArray(S)){let R=[...S];if(!R.some(z=>String((z==null?void 0:z.emp_name)||"")==="윤이랑"))try{const z=await fetch("/api/v1/employees?depts=all");if(z.ok){const Z=await z.json();if(Array.isArray(Z)){const ae=Z.find(se=>String((se==null?void 0:se.emp_name)||"")==="윤이랑");ae&&(R=[...R,ae])}}}catch{}E(R)}}catch{}})()},[]);function w(){const j=new Date(o);if(e==="daily"){const S=new Date(j);S.setDate(S.getDate()-1);const R=new Date(j);return R.setDate(R.getDate()+1),[{label:"전일",startDate:S.toISOString().split("T")[0],endDate:S.toISOString().split("T")[0],count:0},{label:"금일",startDate:o,endDate:o,count:0},{label:"익일",startDate:R.toISOString().split("T")[0],endDate:R.toISOString().split("T")[0],count:0}]}else if(e==="weekly"){const S=new Date(j),R=S.getDay(),O=S.getDate()-R+(R===0?-6:1),z=new Date(S.setDate(O)),Z=z.toISOString().split("T")[0],ae=new Date(z);ae.setDate(ae.getDate()+6);const se=new Date(z);se.setDate(se.getDate()-7);const H=new Date(se);H.setDate(H.getDate()+6);const q=new Date(z);q.setDate(q.getDate()+7);const C=new Date(q);return C.setDate(C.getDate()+6),[{label:"전주",startDate:se.toISOString().split("T")[0],endDate:H.toISOString().split("T")[0],count:0},{label:"금주",startDate:Z,endDate:ae.toISOString().split("T")[0],count:0},{label:"차주",startDate:q.toISOString().split("T")[0],endDate:C.toISOString().split("T")[0],count:0}]}else{const S=new Date(j),R=new Date(S.getFullYear(),S.getMonth(),1),O=new Date(S.getFullYear(),S.getMonth()+1,0),z=new Date(S.getFullYear(),S.getMonth()-1,1),Z=new Date(S.getFullYear(),S.getMonth(),0),ae=new Date(S.getFullYear(),S.getMonth()+1,1),se=new Date(S.getFullYear(),S.getMonth()+2,0);return[{label:"전월",startDate:z.toISOString().split("T")[0],endDate:Z.toISOString().split("T")[0],count:0},{label:"금월",startDate:R.toISOString().split("T")[0],endDate:O.toISOString().split("T")[0],count:0},{label:"익월",startDate:ae.toISOString().split("T")[0],endDate:se.toISOString().split("T")[0],count:0}]}}async function P(){N(!0),p(null),v([]),b(null);const j=w();try{const S={period:e,filterType:r,baseDate:o};i&&(S.empId=i);const R=new URLSearchParams(S),[O,z]=await Promise.all([fetch(`/api/v1/lead-stats/registration?${R.toString()}`),fetch(`/api/v1/lead-stats/activity?${R.toString()}`)]);if(O.ok&&z.ok){const Z=await O.json(),ae=await z.json(),se=(H,q)=>!Array.isArray(H)||H.length===0?q:H.map(C=>({label:C.label,count:Number(C.count)||0,startDate:C.startDate||o,endDate:C.endDate||o}));h(se(Z,j)),f(se(ae,j))}else{if(console.error("Failed to fetch stats. Reg:",O.status,"Act:",z.status),!O.ok){const Z=await O.text();console.error("Registration error:",Z)}if(!z.ok){const Z=await z.text();console.error("Activity error:",Z)}h(j),f(j)}}catch(S){console.error("Failed to load stats",S),h(j),f(j)}finally{N(!1)}}async function _(j){try{const S=r==="owner"&&i?`AND CAST(l.assignee_id AS TEXT) = '${i}'`:"",R=r==="creator"&&i?`AND CAST(l.created_by AS TEXT) = '${i}'`:"",O={filterType:r,startDate:j.startDate,endDate:j.endDate};i&&(O.empId=i);const z=new URLSearchParams(O),Z=await fetch(`/api/v1/lead-stats/registration/details?${z.toString()}`);if(Z.ok){const ae=await Z.json();v(ae),p(j),b(null)}}catch(S){console.error("Failed to load registration details",S)}}function $(j){const S=new Date(o);let R;e==="daily"?R=j==="prev"?new Date(S.setDate(S.getDate()-1)):new Date(S.setDate(S.getDate()+1)):e==="weekly"?R=j==="prev"?new Date(S.setDate(S.getDate()-7)):new Date(S.setDate(S.getDate()+7)):R=j==="prev"?new Date(S.setMonth(S.getMonth()-1)):new Date(S.setMonth(S.getMonth()+1));const O=R.toISOString().split("T")[0];l(O),setTimeout(()=>{L(O)},0)}async function L(j){N(!0),p(null),v([]),b(null);const R=(()=>{const O=new Date(j);if(e==="daily"){const z=new Date(O);z.setDate(z.getDate()-1);const Z=new Date(O);return Z.setDate(Z.getDate()+1),[{label:"전일",startDate:z.toISOString().split("T")[0],endDate:z.toISOString().split("T")[0],count:0},{label:"금일",startDate:j,endDate:j,count:0},{label:"익일",startDate:Z.toISOString().split("T")[0],endDate:Z.toISOString().split("T")[0],count:0}]}else if(e==="weekly"){const z=new Date(O),Z=z.getDay(),ae=z.getDate()-Z+(Z===0?-6:1),se=new Date(z.setDate(ae)),H=se.toISOString().split("T")[0],q=new Date(se);q.setDate(q.getDate()+6);const C=new Date(se);C.setDate(C.getDate()-7);const T=new Date(C);T.setDate(T.getDate()+6);const W=new Date(se);W.setDate(W.getDate()+7);const I=new Date(W);return I.setDate(I.getDate()+6),[{label:"전주",startDate:C.toISOString().split("T")[0],endDate:T.toISOString().split("T")[0],count:0},{label:"금주",startDate:H,endDate:q.toISOString().split("T")[0],count:0},{label:"차주",startDate:W.toISOString().split("T")[0],endDate:I.toISOString().split("T")[0],count:0}]}else{const z=new Date(O),Z=new Date(z.getFullYear(),z.getMonth(),1),ae=new Date(z.getFullYear(),z.getMonth()+1,0),se=new Date(z.getFullYear(),z.getMonth()-1,1),H=new Date(z.getFullYear(),z.getMonth(),0),q=new Date(z.getFullYear(),z.getMonth()+1,1),C=new Date(z.getFullYear(),z.getMonth()+2,0);return[{label:"전월",startDate:se.toISOString().split("T")[0],endDate:H.toISOString().split("T")[0],count:0},{label:"금월",startDate:Z.toISOString().split("T")[0],endDate:ae.toISOString().split("T")[0],count:0},{label:"익월",startDate:q.toISOString().split("T")[0],endDate:C.toISOString().split("T")[0],count:0}]}})();try{const O={period:e,filterType:r,baseDate:j};i&&(O.empId=i);const z=new URLSearchParams(O),[Z,ae]=await Promise.all([fetch(`/api/v1/lead-stats/registration?${z.toString()}`),fetch(`/api/v1/lead-stats/activity?${z.toString()}`)]);if(Z.ok&&ae.ok){const se=await Z.json(),H=await ae.json(),q=(C,T)=>!Array.isArray(C)||C.length===0?T:C.map(W=>({label:W.label,count:Number(W.count)||0,startDate:W.startDate||j,endDate:W.endDate||j}));h(q(se,R)),f(q(H,R))}else h(R),f(R)}catch(O){console.error("Failed to load stats",O),h(R),f(R)}finally{N(!1)}}return n.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[n.jsx("div",{style:{padding:"16px 20px",borderBottom:"1px solid var(--border)",background:"var(--panel)"},children:n.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700,color:"var(--text)"},children:"TM현황"})}),n.jsxs("div",{style:{padding:"12px 20px",borderBottom:"1px solid var(--border)",background:"var(--panel)",display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:"조회기간:"}),n.jsxs("select",{value:e,onChange:j=>t(j.target.value),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13},children:[n.jsx("option",{value:"daily",children:"일별"}),n.jsx("option",{value:"weekly",children:"주간"}),n.jsx("option",{value:"monthly",children:"월간"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:"구분:"}),n.jsxs("select",{value:r,onChange:j=>a(j.target.value),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13},children:[n.jsx("option",{value:"owner",children:"소유자"}),n.jsx("option",{value:"creator",children:"등록자"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsxs("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:[r==="owner"?"소유자":"등록자",":"]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,alignItems:"center"},children:[n.jsxs("select",{className:"search-input",value:i||"",onChange:j=>s(j.target.value||""),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13,minWidth:160},children:[n.jsx("option",{value:"",children:"전체"}),A.map(j=>n.jsxs("option",{value:j.assignee_id,children:[j.dept_name," · ",j.emp_name]},j.assignee_id))]}),n.jsx("div",{style:{whiteSpace:"nowrap",alignSelf:"center",fontSize:12,color:"var(--muted)"},children:(()=>{const j=A.find(R=>R.assignee_id===i);return`현재선택 : ${j?j.emp_name:"전체"}`})()})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:"기준일자:"}),n.jsx("input",{type:"date",value:o,onChange:j=>l(j.target.value),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13}})]}),n.jsx("button",{onClick:P,disabled:y,className:"btn btn-card btn-3d",style:{height:32,fontSize:13,padding:"0 20px",fontWeight:600},children:y?"조회 중...":"조회"}),n.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[n.jsx("button",{onClick:()=>$("prev"),className:"btn btn-card",style:{height:32,width:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center"},title:"이전",disabled:d.length===0&&u.length===0,children:n.jsx("img",{src:tg,alt:"이전",style:{width:16,height:16}})}),n.jsx("button",{onClick:()=>$("next"),className:"btn btn-card",style:{height:32,width:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center"},title:"다음",disabled:d.length===0&&u.length===0,children:n.jsx("img",{src:ng,alt:"다음",style:{width:16,height:16}})})]})]}),n.jsx("div",{style:{flex:1,minHeight:0,overflow:"auto",padding:20},children:y?n.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--muted)"},children:"데이터를 불러오는 중..."}):n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20,height:"100%"},children:[n.jsxs("div",{style:{flex:"0 0 auto",display:"flex",gap:20,flexWrap:"wrap"},children:[n.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:12},children:[n.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"var(--text)"},children:"잠재고객 등록현황"}),d.length===0?n.jsxs("div",{style:{textAlign:"center",padding:40,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8},children:[n.jsx("div",{style:{fontSize:48,marginBottom:16,opacity:.3},children:"📊"}),n.jsx("div",{style:{fontSize:15,color:"var(--muted)",marginBottom:8},children:"조회 조건을 설정하고 조회 버튼을 클릭하세요"})]}):n.jsx(n.Fragment,{children:n.jsx("div",{style:{display:"flex",gap:12},children:d.map((j,S)=>n.jsxs("button",{onClick:()=>_(j),className:"btn btn-card btn-3d",style:{flex:1,minHeight:120,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:8,background:(m==null?void 0:m.label)===j.label?"var(--primary)":"var(--panel)",color:(m==null?void 0:m.label)===j.label?"#fff":"var(--text)",border:(m==null?void 0:m.label)===j.label?"2px solid var(--primary)":"1px solid var(--border)"},children:[n.jsx("div",{style:{fontSize:14,fontWeight:600},children:j.label}),n.jsx("div",{style:{fontSize:28,fontWeight:700},children:j.count}),n.jsx("div",{style:{fontSize:11,opacity:.7},children:j.startDate===j.endDate?j.startDate:`${j.startDate} ~ ${j.endDate}`})]},S))})})]}),n.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:12},children:[n.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"var(--text)"},children:"잠재고객 활동현황"}),u.length===0?n.jsxs("div",{style:{textAlign:"center",padding:40,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8},children:[n.jsx("div",{style:{fontSize:48,marginBottom:16,opacity:.3},children:"📊"}),n.jsx("div",{style:{fontSize:15,color:"var(--muted)",marginBottom:8},children:"조회 조건을 설정하고 조회 버튼을 클릭하세요"})]}):n.jsx("div",{style:{display:"flex",gap:12},children:u.map((j,S)=>n.jsxs("div",{className:"btn-card btn-3d",style:{flex:1,minHeight:120,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:8,background:"var(--panel)",color:"var(--text)",border:"1px solid var(--border)",cursor:"default",opacity:.8},children:[n.jsx("div",{style:{fontSize:14,fontWeight:600},children:j.label}),n.jsx("div",{style:{fontSize:28,fontWeight:700},children:j.count}),n.jsx("div",{style:{fontSize:11,opacity:.7},children:j.startDate===j.endDate?j.startDate:`${j.startDate} ~ ${j.endDate}`})]},S))})]})]}),m&&x.length>0&&n.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",gap:12},children:[n.jsxs("div",{style:{flex:1,minWidth:0,overflow:"auto",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,padding:12},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[n.jsxs("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"var(--text)"},children:[m.label," 등록 목록 (",x.length,"건)"]}),n.jsx("span",{style:{fontSize:12,color:"#e11d48",fontWeight:600},children:"잠재고객 클릭시 활동 조회"})]}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:x.map(j=>n.jsxs("button",{onClick:()=>b(j.id),style:{padding:10,background:g===j.id?"var(--primary-light)":"var(--background)",border:g===j.id?"2px solid var(--primary)":"1px solid var(--border)",borderRadius:6,fontSize:13,textAlign:"left",cursor:"pointer",transition:"all 0.2s"},children:[n.jsxs("div",{style:{fontWeight:600,color:g===j.id?"var(--primary)":"var(--text)",marginBottom:4},children:[j.company_name||"-",j.activities&&j.activities.length>0&&n.jsxs("span",{style:{marginLeft:8,fontSize:11,color:"var(--muted)"},children:["(활동 ",j.activities.length,"건)"]})]}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12},children:["담당자: ",j.contact_name||"-"]}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["상태: ",j.lead_status||"-"," | 업종: ",j.biz_type||"-"]}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["지역: ",j.addr_province_name||"-"]}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["최종수정: ",L1(j.updated_at)]})]},j.id))})]}),g&&(()=>{var S;const j=x.find(R=>R.id===g);return j?n.jsxs("div",{style:{flex:1,minWidth:0,overflow:"auto",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,padding:12},children:[n.jsxs("h4",{style:{margin:"0 0 12px",fontSize:14,fontWeight:600,color:"var(--text)"},children:[j.company_name||"-"," 활동 목록 (",((S=j.activities)==null?void 0:S.length)||0,"건)"]}),!j.activities||j.activities.length===0?n.jsx("div",{style:{textAlign:"center",padding:20,color:"var(--muted)",fontSize:13},children:"활동 데이터가 없습니다"}):n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:j.activities.map(R=>n.jsxs("div",{style:{padding:10,background:"var(--background)",border:"1px solid var(--border)",borderRadius:6,fontSize:13},children:[n.jsx("div",{style:{fontWeight:600,color:"var(--text)",marginBottom:4},children:R.subject||"-"}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12},children:["유형: ",R.activity_type||"-"," | 상태: ",R.activity_status||"-"]}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["계획: ",R.planned_start_at?new Date(R.planned_start_at).toLocaleString("ko-KR"):"-"]}),R.actual_start_at&&n.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["실제: ",new Date(R.actual_start_at).toLocaleString("ko-KR")]}),R.description&&n.jsx("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:R.description}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["수정: ",R.updated_at?new Date(R.updated_at).toLocaleString("ko-KR"):"-"]})]},R.id))})]}):null})()]})]})})]})}const Jf="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cline%20x1='12'%20y1='5'%20x2='12'%20y2='19'/%3e%3cline%20x1='5'%20y1='12'%20x2='19'%20y2='12'/%3e%3c/svg%3e";function z1(){const[e,t]=c.useState(""),[r,a]=c.useState(""),[i,s]=c.useState([]),[o,l]=c.useState(!1),[d,h]=c.useState(null),[u,f]=c.useState(null),[m,p]=c.useState([]),[x,v]=c.useState(!1),[g,b]=c.useState(!1),[y,N]=c.useState({open:!1,x:0,y:0}),A=c.useRef(null);async function E(I){try{v(!0);const U=u!=null?i[u]:null,K=new URLSearchParams;K.set("q",r.trim()||e.trim());const Y=I??(U==null?void 0:U.customerSeq);Y!=null&&K.set("customerSeq",String(Y));const M=await fetch(`/api/v1/items/search?${K.toString()}`),D=M.ok?await M.json():[],oe=Array.isArray(D)?D.map(F=>({itemSeq:F==null?void 0:F.itemSeq,itemName:String((F==null?void 0:F.itemName)??""),recentInvoiceDate:(F==null?void 0:F.recentInvoiceDate)??(F==null?void 0:F.recent_invoice_date)??null,curAmt:(F==null?void 0:F.curAmt)??null,qty:(F==null?void 0:F.qty)??null,srcPri:(F==null?void 0:F.srcPri)!=null?Number(F.srcPri):void 0,itemStdUnit:(F==null?void 0:F.itemStdUnit)??(F==null?void 0:F.item_std_unit)??null,companyType:(F==null?void 0:F.companyType)||(F==null?void 0:F.company_type)||null})):[];p(oe)}catch{p([])}finally{v(!1)}}const[w,P]=c.useState(()=>({open:!1,text:""})),[_,$]=c.useState([]);async function L(I){if(!(I==null||I.itemName==null)){b(!0);try{let U,K=typeof I.itemStdUnit=="string"?I.itemStdUnit:void 0,Y,M;const D=await fetch(`/api/v1/items/spec?itemName=${encodeURIComponent(String(I.itemName))}`);if(D.ok){const de=await D.json().catch(()=>({}));de&&de.itemSpec&&(U=String(de.itemSpec)),!K&&de&&de.itemStdUnit&&(Y=String(de.itemStdUnit),K=Y),de&&de.companyType&&(M=String(de.companyType))}const oe=localStorage.getItem("tnt.sales.ordersheet.cart"),F=oe?JSON.parse(oe):[];if((Array.isArray(F)?F.findIndex(de=>String(de.itemName)===String(I.itemName)):-1)>=0){alert("이미 주문에 포함되어 있습니다."),b(!1);return}else{const de=M||I.companyType||null,be={itemSeq:I.itemSeq,itemName:I.itemName,itemSpec:U||"",qty:"",itemStdUnit:K||void 0,companyType:de};F.push(be)}localStorage.setItem("tnt.sales.ordersheet.cart",JSON.stringify(F)),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.cart.changed",{detail:{cart:F}}))}catch{}finally{b(!1)}}}function j(I){try{const K=[JSON.parse(I)];let Y=null;for(;K.length;){const M=K.shift();if(Array.isArray(M)){if(M.length&&typeof M[0]=="object"){Y=M;break}}else if(M&&typeof M=="object")for(const D of Object.keys(M))K.push(M[D])}return Y?Y.map(M=>{const D=(M==null?void 0:M.WHName)??(M==null?void 0:M.whName)??(M==null?void 0:M.warehouseName)??(M==null?void 0:M.WH_NM)??(M==null?void 0:M.wh_nm)??"",oe=Number((M==null?void 0:M.AvailStock)??(M==null?void 0:M.availStock)??(M==null?void 0:M.AVAIL_STOCK)??(M==null?void 0:M.qty)??0)||0,F=(M==null?void 0:M.UnitName)??(M==null?void 0:M.unitName)??(M==null?void 0:M.UNIT_NAME)??(M==null?void 0:M.salesMgmtUnit)??"";return{whName:String(D||""),avail:oe,unitName:String(F||"")}}):[]}catch{return[]}}async function S(I,U){const Y=I.currentTarget.getBoundingClientRect(),M=Y.right,D=Y.bottom;N({open:!0,x:M,y:D,loading:!0});try{const oe={bizUnit:"",stdDate:"",whSeq:"",itemName:String(U.itemName||""),itemNo:"",itemSeq:String(U.itemSeq||""),pageNo:"",pageSize:""},F=await fetch("/api/v1/items/avail-stock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(oe)});if(F.ok){const G=await F.json().catch(()=>({})),de=G&&(G.receivedPayload||G),be=JSON.stringify(de,null,2),ke=j(be);N({open:!0,x:M,y:D,loading:!1,error:null,rows:ke})}else N({open:!0,x:M,y:D,loading:!1,error:`HTTP ${F.status}`})}catch(oe){N({open:!0,x:M,y:D,loading:!1,error:(oe==null?void 0:oe.message)||"재고 조회 실패"})}}c.useEffect(()=>{if(!y.open)return;const I=K=>{const Y=A.current;Y&&K.target instanceof Node&&!Y.contains(K.target)&&N({open:!1,x:0,y:0})},U=K=>{K.key==="Escape"&&N({open:!1,x:0,y:0})};return document.addEventListener("mousedown",I,!0),window.addEventListener("keydown",U,!0),()=>{document.removeEventListener("mousedown",I,!0),window.removeEventListener("keydown",U,!0)}},[y.open]);async function R(){var I;l(!0),h(null);try{const U=new URLSearchParams;e.trim()&&U.set("name",e.trim()),U.set("mineOnly","false");const K=await fetch(`/api/v1/customers?${U.toString()}`);if(!K.ok)throw new Error(`HTTP ${K.status}`);const Y=await K.json(),M=Array.isArray(Y)?Y.map(D=>({customerId:(D==null?void 0:D.customerId)??"",customerName:(D==null?void 0:D.customerName)??"",bizNo:(D==null?void 0:D.bizNo)??"",ownerName:(D==null?void 0:D.ownerName)??(D==null?void 0:D.empName)??"",telNo:(D==null?void 0:D.telNo)??"",customerSeq:(D==null?void 0:D.customerSeq)!=null?Number(D.customerSeq):void 0,addrProvinceName:(D==null?void 0:D.addrProvinceName)??(D==null?void 0:D.addr_province_name)??"",addrCityName:(D==null?void 0:D.addrCityName)??(D==null?void 0:D.addr_city_name)??"",companyType:String((D==null?void 0:D.company_type)??(D==null?void 0:D.companyType)??(D==null?void 0:D.company)??"").toUpperCase(),companyCode:String((D==null?void 0:D.companyCode)??(D==null?void 0:D.company_code)??(D==null?void 0:D.company_type)??(D==null?void 0:D.companyType)??(D==null?void 0:D.company)??"").toUpperCase()})):[];if(M.sort((D,oe)=>String(D.customerName||"").localeCompare(String(oe.customerName||""),"ko-KR")),s(M),M.length>0){f(0);try{localStorage.setItem("tnt.sales.ordersheet.selectedCustomer",JSON.stringify(M[0])),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.customer.selected",{detail:{customer:M[0]}}))}catch{}await E((I=M[0])==null?void 0:I.customerSeq)}else f(null),p([])}catch(U){h((U==null?void 0:U.message)||"조회 중 오류가 발생했습니다"),s([])}finally{l(!1)}}c.useEffect(()=>{try{localStorage.removeItem("tnt.sales.ordersheet.selectedCustomer"),localStorage.removeItem("tnt.sales.ordersheet.cart"),localStorage.removeItem("tnt.sales.ordersheet.regionGroup"),localStorage.removeItem("tnt.sales.ordersheet.requests"),localStorage.removeItem("tnt.sales.ordersheet.deliveryDueDate")}catch{}},[]);function O(I,U){f(U);try{localStorage.setItem("tnt.sales.ordersheet.selectedCustomer",JSON.stringify(I)),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.customer.selected",{detail:{customer:I}}))}catch{}E(I.customerSeq),z(I.customerSeq)}async function z(I){try{$([]);const U=I!=null?Number(I):NaN;if(!Number.isFinite(U))return;const K=await fetch(`/api/v1/customers/${U}/transactions`,{cache:"no-store"});if(!K.ok)return;const Y=await K.json().catch(()=>[]);if(!Array.isArray(Y)){$([]);return}const M=Date.now()-365*24*60*60*1e3,D={};for(const F of Y){const G=String((F==null?void 0:F.itemName)??(F==null?void 0:F.item_name)??"").trim();if(!G)continue;const de=(F==null?void 0:F.itemSeq)??(F==null?void 0:F.item_seq)??null,be=(F==null?void 0:F.companyType)??(F==null?void 0:F.company_type)??null,ke=Number((F==null?void 0:F.curAmt)??(F==null?void 0:F.cur_amt)??0)||0,ye=Number((F==null?void 0:F.qty)??0)||0,Ce=String((F==null?void 0:F.invoiceDate)??(F==null?void 0:F.invoice_date)??""),J=Date.parse(Ce)||Date.parse(Ce.replace(" ","T"))||NaN;if(!Number.isFinite(J)||J<M)continue;const ge=de!=null?String(de):G,Ee=D[ge]||{itemSeq:de,itemName:G,companyType:be||null,recent:0,totalAmt:0,totalQty:0};Ee.totalAmt+=ke,Ee.totalQty+=ye,J>Ee.recent&&(Ee.recent=J),Ee.itemSeq==null&&de!=null&&(Ee.itemSeq=de),!Ee.companyType&&be&&(Ee.companyType=be),D[ge]=Ee}const oe=Object.values(D).sort((F,G)=>G.recent-F.recent||F.itemName.localeCompare(G.itemName,"ko",{sensitivity:"base"})).map(F=>({itemSeq:F.itemSeq,itemName:F.itemName,companyType:F.companyType,recentDate:new Date(F.recent).toISOString().slice(0,10),totalAmt:F.totalAmt,totalQty:F.totalQty}));$(oe)}catch{$([])}}const Z=c.useMemo(()=>n.jsx("div",{className:"table-container",style:{maxHeight:"40vh"},children:i.length===0?n.jsx("div",{className:"empty-state",children:o?"불러오는 중…":d||"데이터가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:160},children:"회사코드"}),n.jsx("th",{children:"거래처명"}),n.jsx("th",{style:{width:160},children:"대표자"}),n.jsx("th",{style:{width:180},children:"사업자번호"}),n.jsx("th",{style:{width:160},children:"대표번호"})]})}),n.jsx("tbody",{children:i.map((I,U)=>n.jsxs("tr",{className:u===U?"selected":void 0,onClick:()=>O(I,U),children:[n.jsx("td",{children:I.companyCode||I.companyType||""}),n.jsx("td",{children:I.customerName}),n.jsx("td",{children:I.ownerName}),n.jsx("td",{children:I.bizNo}),n.jsx("td",{children:I.telNo})]},U))})]})}),[i,o,d,u]),ae=c.useMemo(()=>_.length===0?null:n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",style:{fontSize:12,marginTop:8,marginBottom:4},children:"최근거래내역"}),n.jsx("div",{className:"table-container",style:{maxHeight:"24vh"},children:n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"품목"}),n.jsx("th",{style:{width:120},children:"최근거래일"}),n.jsx("th",{style:{width:140,textAlign:"right"},children:"총금액"}),n.jsx("th",{style:{width:100,textAlign:"right"},children:"총수량"}),n.jsx("th",{style:{width:80}})]})}),n.jsx("tbody",{children:_.map((I,U)=>n.jsxs("tr",{children:[n.jsx("td",{children:I.itemName}),n.jsx("td",{children:I.recentDate}),n.jsx("td",{style:{textAlign:"right"},children:Number(I.totalAmt||0).toLocaleString()}),n.jsx("td",{style:{textAlign:"right"},children:Number(I.totalQty||0).toLocaleString()}),n.jsxs("td",{children:[n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"재고 조회",title:"재고 조회",onClick:K=>q(K,I.itemName),onKeyDown:K=>{(K.key==="Enter"||K.key===" ")&&(K.preventDefault(),q(K,I.itemName))},children:n.jsx("img",{src:Ff,className:"icon",alt:"재고"})}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"담기",title:"담기",onClick:()=>C(I),onKeyDown:K=>{(K.key==="Enter"||K.key===" ")&&(K.preventDefault(),C(I))},children:n.jsx("img",{src:Jf,className:"icon",alt:"담기"})})]})]},U))})]})})]}),[_]);function se(){try{const I=localStorage.getItem("tnt.sales.ordersheet.selectedCustomer");if(!I)return null;const U=JSON.parse(I),K=Number(U==null?void 0:U.customerSeq);return Number.isFinite(K)?K:null}catch{return null}}async function H(I){const U=m.find(K=>String(K.itemName).trim()===String(I).trim());if(U&&U.itemSeq!=null)return{itemSeq:U.itemSeq,itemName:U.itemName};try{const K=new URLSearchParams;K.set("q",I);const Y=se();Y!=null&&K.set("customerSeq",String(Y));const M=await fetch(`/api/v1/items/search?${K.toString()}`),D=M.ok?await M.json():[],oe=Array.isArray(D)?D:[],F=oe.find(G=>String((G==null?void 0:G.itemName)||"").trim()===String(I).trim())||oe[0];if(F&&F.itemSeq!=null)return{itemSeq:F.itemSeq,itemName:String(F.itemName||I)}}catch{}return null}async function q(I,U){const K=await H(U);K&&await S(I,K)}async function C(I){let U=I;if(!U.itemSeq){const K=await H(I.itemName);if(!K)return;U={...U,...K}}await L({itemSeq:U.itemSeq,itemName:U.itemName,companyType:U.companyType||void 0})}const T=new Intl.NumberFormat("ko-KR"),W=c.useMemo(()=>n.jsx("div",{className:"table-container",style:{maxHeight:"32vh",marginTop:12},children:m.length===0?n.jsx("div",{className:"empty-state",children:x?"품목 불러오는 중…":"품목 데이터가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"품목명"}),n.jsx("th",{style:{width:140},children:"최근거래일시"}),n.jsx("th",{style:{width:120,textAlign:"right"},children:"총금액"}),n.jsx("th",{style:{width:100,textAlign:"right"},children:"총수량"}),n.jsx("th",{style:{width:90}})]})}),n.jsx("tbody",{children:m.map((I,U)=>n.jsxs("tr",{className:I.srcPri===0?"inv-row":void 0,onDoubleClick:()=>L(I),title:"더블클릭하면 우측 수주장에 담습니다",children:[n.jsxs("td",{style:{display:"flex",alignItems:"center",gap:6},children:[(()=>{const Y=(I.companyType||I.company_type||I.companyCode||I.company_code||"").toString().toUpperCase(),M=Y==="TNT"?"T":Y==="DYS"?"D":Y==="ALL"?"A":"",D=Y==="TNT"?"#2563eb":Y==="DYS"?"#10b981":Y==="ALL"?"#f59e0b":"#9ca3af";return M?n.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:"50%",background:D,color:"#fff",fontSize:11,fontWeight:800,boxShadow:"0 0 0 1px rgba(0,0,0,.08)"},children:M}):null})(),n.jsx("span",{children:I.itemName}),I.itemStdUnit?n.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)"},children:["(",I.itemStdUnit,")"]}):null]}),n.jsx("td",{children:I.recentInvoiceDate||""}),n.jsx("td",{style:{textAlign:"right"},children:I.curAmt!=null&&I.curAmt!==""?T.format(Number(I.curAmt)):""}),n.jsx("td",{style:{textAlign:"right"},children:I.qty!=null&&I.qty!==""?T.format(Number(I.qty)):""}),n.jsxs("td",{children:[n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"재고 조회",title:"재고 조회",onClick:K=>S(K,I),onKeyDown:K=>{(K.key==="Enter"||K.key===" ")&&(K.preventDefault(),S({currentTarget:K.currentTarget},I))},children:n.jsx("img",{src:Ff,className:"icon",alt:"재고"})}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"담기",title:"담기",onClick:()=>L(I),onKeyDown:K=>{(K.key==="Enter"||K.key===" ")&&(K.preventDefault(),L(I))},children:n.jsx("img",{src:Jf,className:"icon",alt:"담기"})})]})]},U))})]})}),[m,x]);return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",children:[n.jsx("h2",{children:"수주장"}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsx("input",{className:"search-input",type:"text",placeholder:"거래처명",value:e,onChange:I=>t(I.target.value),onKeyDown:I=>{I.key==="Enter"&&R()},style:{width:240}}),n.jsx("button",{className:"btn",onClick:R,disabled:o,children:"조회"})]})]}),Z,ae,n.jsxs("div",{className:"controls",style:{gap:8,marginTop:10},children:[n.jsx("input",{className:"search-input",type:"text",placeholder:"품목명",value:r,onChange:I=>a(I.target.value),onKeyDown:I=>{I.key==="Enter"&&E()},style:{width:240}}),n.jsx("button",{className:"btn",onClick:()=>E(),disabled:x,children:"품목 조회"})]}),W,y.open&&n.jsx("div",{ref:A,className:"context-menu",style:{left:y.x+6,top:y.y+6,position:"fixed",maxWidth:420,padding:8},onClick:I=>I.stopPropagation(),children:y.loading?n.jsx("div",{className:"muted",children:"재고 불러오는 중…"}):y.error?n.jsx("div",{className:"error",children:y.error}):!y.rows||y.rows.length===0?n.jsx("div",{className:"empty-state",children:"재고 데이터가 없습니다"}):n.jsx("div",{className:"table-container",style:{maxHeight:200,overflow:"auto",border:0},children:n.jsxs("table",{className:"table",style:{width:"100%",fontSize:12},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"창고명"}),n.jsx("th",{style:{width:100,textAlign:"right"},children:"가용재고"}),n.jsx("th",{style:{width:120},children:"단위"})]})}),n.jsx("tbody",{children:(y.rows||[]).map((I,U)=>n.jsxs("tr",{children:[n.jsx("td",{children:I.whName||"-"}),n.jsx("td",{style:{textAlign:"right"},children:Number(I.avail||0).toLocaleString()}),n.jsx("td",{children:I.unitName||""})]},U))})]})})})]})}function W1(){const e=[];for(let t=2030;t>=2026;t--)e.push(t);return e}function B1(){const[e,t]=c.useState(2026),[r,a]=c.useState(()=>{try{return localStorage.getItem("tnt.sales.assign.mode")==="Moderate"?"Moderate":"Best"}catch{return"Best"}}),[i,s]=c.useState([{company:"TNT",group:"TNT",name:"복층유리",amount:0,stage:""},{company:"TNT",group:"TNT",name:"건자재",amount:0,stage:""},{company:"DYS",group:"DYS",name:"실란트",amount:0,stage:""}]),[o,l]=c.useState(!1),[d,h]=c.useState(null),[u,f]=c.useState(null),m=new Intl.NumberFormat("ko-KR");async function p(){l(!0),h(null);try{const A=new URL("/api/v1/targets/year",window.location.origin);A.searchParams.set("year",String(e)),A.searchParams.set("versionNo",r==="Moderate"?"2":"1");const E=await fetch(A.toString()),w=E.ok?await E.json():[],P=new Map;if(Array.isArray(w))for(const _ of w){const $=String((_==null?void 0:_.company_name)||"").toUpperCase()==="DYS"?"DYS":"TNT",L=String((_==null?void 0:_.biz_area_name)||""),j=Number((_==null?void 0:_.version_no)??0),S=Number((_==null?void 0:_.target_amount_max)??(_==null?void 0:_.target_amount_min)??0),R=String((_==null?void 0:_.target_stage)??""),O=`${$}||${L}`,z=P.get(O);(!z||j>z.ver)&&P.set(O,{ver:j,amt:Number.isFinite(S)?S:0,stage:R,company:$,name:L})}P.size===0?(s(_=>_.map($=>({...$,amount:0,stage:""}))),f("영업목표가 수립되지 않았습니다.")):(s(_=>_.map($=>{const L=`${$.company}||${$.name}`,j=P.get(L);return j?{...$,amount:j.amt,stage:j.stage}:$})),f(null))}catch(A){h((A==null?void 0:A.message)||"조회 오류")}finally{l(!1)}}c.useEffect(()=>{p()},[e,r]),c.useEffect(()=>{try{localStorage.setItem("tnt.sales.assign.mode",r)}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.assign.mode.changed",{detail:{mode:r}}))}catch{}},[r]),c.useEffect(()=>{try{localStorage.setItem("tnt.sales.assign.year",String(e)),window.dispatchEvent(new CustomEvent("tnt.sales.assign.year.changed"))}catch{}},[e]);const x=c.useMemo(()=>i.filter(A=>A.company==="TNT").reduce((A,E)=>A+(Number(E.amount)||0),0),[i]),v=c.useMemo(()=>i.filter(A=>A.company==="DYS").reduce((A,E)=>A+(Number(E.amount)||0),0),[i]);c.useEffect(()=>{try{const A={tnt:Number(x)||0,dys:Number(v)||0,year:e};localStorage.setItem("tnt.sales.assign.companyTotals",JSON.stringify(A)),window.dispatchEvent(new CustomEvent("tnt.sales.assign.companyTotals.changed"))}catch{}},[x,v,e]);function g(A,E){const w=Number((E||"").replace(/[\s,]/g,""));s(P=>P.map((_,$)=>$===A?{..._,amount:Number.isFinite(w)?w:0}:_))}async function b(A=!1){try{const E=i.map($=>({targetYear:`${e}-01-01`,versionNo:1,companyName:$.company,bizAreaGroup:$.group,bizAreaName:$.name,targetAmountMin:$.amount,targetAmountMax:$.amount,targetStage:A?"확정":"기안중"})),w=localStorage.getItem("tnt.sales.empSeq")||"",P={"Content-Type":"application/json"};w&&(P["X-EMP-SEQ"]=String(w));const _=await fetch("/api/v1/targets/year/upsert",{method:"POST",headers:P,body:JSON.stringify(E)});if(!_.ok)throw new Error(`HTTP ${_.status}`);A&&await fetch(`/api/v1/targets/year/confirm?year=${e}`,{method:"POST",headers:P}),await p(),alert(A?"확정되었습니다.":"저장되었습니다.")}catch(E){alert((E==null?void 0:E.message)||"저장 중 오류")}}const y=c.useMemo(()=>{const A=i.filter(E=>E.company==="TNT").map(E=>(E.stage||"").trim());return A.includes("확정")?"확정":A.includes("기안중")?"기안중":""},[i]),N=c.useMemo(()=>{const A=i.filter(E=>E.company==="DYS").map(E=>(E.stage||"").trim());return A.includes("확정")?"확정":A.includes("기안중")?"기안중":""},[i]);return n.jsxs("section",{className:"card",style:{padding:12},children:[n.jsxs("div",{className:"page-title",style:{marginBottom:12},children:[n.jsx("h2",{style:{margin:0},children:"회사별 목표 입력"}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsxs("div",{role:"radiogroup","aria-label":"목표 산정 모드",className:"segmented",children:[n.jsxs("label",{className:`seg ${r==="Best"?"selected":""}`,children:[n.jsx("input",{type:"radio",name:"assign-mode",checked:r==="Best",onChange:()=>a("Best")}),n.jsx("span",{children:"Best"})]}),n.jsxs("label",{className:`seg ${r==="Moderate"?"selected":""}`,children:[n.jsx("input",{type:"radio",name:"assign-mode",checked:r==="Moderate",onChange:()=>a("Moderate")}),n.jsx("span",{children:"Moderate"})]})]}),n.jsx("select",{className:"search-input",value:e,onChange:A=>t(Number(A.target.value)),children:W1().map(A=>n.jsxs("option",{value:A,children:[A,"년"]},A))}),n.jsx("button",{className:"btn btn-3d btn-card",onClick:()=>b(!1),children:"저장"}),n.jsx("button",{className:"btn btn-3d btn-card",onClick:()=>b(!0),children:"확정"})]})]}),d&&n.jsx("div",{className:"error",children:d}),u&&!d&&n.jsx("div",{className:"empty-state",style:{marginBottom:12},children:u}),n.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"nowrap",width:"100%"},children:[n.jsxs("div",{className:"card",style:{padding:12,flex:"1 1 0",minWidth:0},children:[n.jsxs("div",{style:{fontWeight:700,marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[n.jsx("span",{children:"TNT"}),y?n.jsx("span",{className:"badge",children:y}):null,o&&n.jsx("span",{className:"muted",style:{marginLeft:"auto",fontSize:12},children:"불러오는 중…"})]}),i.filter(A=>A.company==="TNT").map(A=>{const E=i.findIndex(w=>w.company===A.company&&w.name===A.name);return n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr 42px",alignItems:"center",gap:8,marginBottom:8},children:[n.jsx("div",{children:n.jsx("span",{className:"muted",children:A.name})}),n.jsx("input",{className:"assign-input",style:{textAlign:"right"},value:A.amount?m.format(A.amount):"",onChange:w=>g(E,w.target.value),placeholder:"0",disabled:r==="Moderate",title:r==="Moderate"?"Moderate 모드에서는 회사별 목표 수정이 비활성화됩니다":"값을 입력하세요"}),n.jsx("div",{className:"muted",style:{textAlign:"left"},children:"억원"})]},`TNT-${A.name}`)}),n.jsxs("div",{style:{textAlign:"right",fontWeight:700},children:["합계: ",m.format(x)," 억원"]})]}),n.jsxs("div",{className:"card",style:{padding:12,flex:"1 1 0",minWidth:0},children:[n.jsxs("div",{style:{fontWeight:700,marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[n.jsx("span",{children:"DYS"}),N?n.jsx("span",{className:"badge",children:N}):null,o&&n.jsx("span",{className:"muted",style:{marginLeft:"auto",fontSize:12},children:"불러오는 중…"})]}),i.filter(A=>A.company==="DYS").map(A=>{const E=i.findIndex(w=>w.company===A.company&&w.name===A.name);return n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr 42px",alignItems:"center",gap:8,marginBottom:8},children:[n.jsx("div",{children:n.jsx("span",{className:"muted",children:A.name})}),n.jsx("input",{className:"assign-input",style:{textAlign:"right"},value:A.amount?m.format(A.amount):"",onChange:w=>g(E,w.target.value),placeholder:"0",disabled:r==="Moderate",title:r==="Moderate"?"Moderate 모드에서는 회사별 목표 수정이 비활성화됩니다":"값을 입력하세요"}),n.jsx("div",{className:"muted",style:{textAlign:"left"},children:"억원"})]},`DYS-${A.name}`)}),n.jsxs("div",{style:{textAlign:"right",fontWeight:700},children:["합계: ",m.format(v)," 억원"]})]})]})]})}const F1=["영업1본부","영업1팀","영업2본부","영업2팀"];function q1(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState(!1),[d,h]=c.useState(()=>{try{const O=localStorage.getItem("tnt.sales.assign.year");return O?Number(O):new Date().getFullYear()}catch{return new Date().getFullYear()}}),[u,f]=c.useState({}),[m,p]=c.useState(null),[x,v]=c.useState({}),[g,b]=c.useState(""),y=new Intl.NumberFormat("ko-KR"),[N,A]=c.useState(0);c.useEffect(()=>{const O=()=>A(z=>z+1);return window.addEventListener("tnt.sales.assign.mode.changed",O),()=>window.removeEventListener("tnt.sales.assign.mode.changed",O)},[]);const E=c.useMemo(()=>{try{return(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase()==="moderate"}catch{return!1}},[N]);async function w(){a(!0),s(null);try{const O=new URL("/api/v1/targets/assigned",window.location.origin);O.searchParams.set("year",String(d));try{const T=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),W=T==="moderate"?"2":T==="best"?"1":"";W&&O.searchParams.set("versionNo",W)}catch{}const z=await fetch(O.toString()),Z=z.ok?await z.json():[],ae=Array.isArray(Z)?Z:[];if(ae.length>0){const T=ae.reduce((W,I)=>{const U=String(I.emp_id??I.empId??"").trim(),K=String(I.emp_name??I.empName??"").trim(),Y=String(I.dept_name??I.deptName??""),M=U||(K?`name:${K}`:"");return M&&(W.some(D=>D.key===M)||W.push({key:M,empId:U,empName:K,deptName:Y})),W},[]);T.sort((W,I)=>(W.deptName||"").localeCompare(I.deptName||"")||(W.empName||"").localeCompare(I.empName||"")),t(T),a(!1);return}const se=new URL("/api/v1/employees",window.location.origin);se.searchParams.set("depts",F1.join(","));const H=await fetch(se.toString());if(!H.ok)throw new Error(`HTTP ${H.status}`);const q=await H.json(),C=Array.isArray(q)?q.map(T=>{const W=String(T.empId??T.emp_id??"").trim(),I=String(T.empName??T.emp_name??"").trim(),U=String(T.deptName??T.dept_name??""),K=String(T.assignee_id??T.assigneeId??"").trim()||void 0;return{key:W||K||(I?`name:${I}`:""),empId:W,empName:I,deptName:U,assigneeId:K}}).filter(T=>!!T.key):[];C.sort((T,W)=>(T.deptName||"").localeCompare(W.deptName||"")||(T.empName||"").localeCompare(W.empName||"")),t(C)}catch(O){s((O==null?void 0:O.message)||"조회 중 오류"),t([])}finally{a(!1)}}c.useEffect(()=>{w()},[]),c.useEffect(()=>{try{localStorage.setItem("tnt.sales.assign.empList",JSON.stringify(e)),window.dispatchEvent(new CustomEvent("tnt.sales.assign.emps.changed"))}catch{}},[e]),c.useEffect(()=>{const O=()=>{try{const z=localStorage.getItem("tnt.sales.assign.year");z&&h(Number(z)),v({}),b&&b("")}catch{}};return window.addEventListener("tnt.sales.assign.year.changed",O),()=>window.removeEventListener("tnt.sales.assign.year.changed",O)},[]),c.useEffect(()=>{async function O(){try{if(!e.length){v({});return}const z=new URL("/api/v1/targets/assigned",window.location.origin);z.searchParams.set("year",String(d));try{const C=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),T=C==="moderate"?"2":C==="best"?"1":"";T&&z.searchParams.set("versionNo",T)}catch{}const Z=await fetch(z.toString()),ae=Z.ok?await Z.json():[],se={};let H="";Array.isArray(ae)&&ae.forEach(C=>{const T=String(C.emp_id??C.empId??"").trim(),W=String(C.emp_name??C.empName??"").trim(),I=T||(W?`name:${W}`:"");if(!I)return;const U=String(C.company_name??C.companyName??"").toUpperCase(),K=Number(C.assigned_amount??C.assignedAmount??0),Y=String(C.target_stage??C.targetStage??"").trim(),M=se[I]||{tnt:0,dys:0};U==="TNT"?M.tnt=Math.round(K):U==="DYS"&&(M.dys=Math.round(K)),se[I]=M,Y==="확정"?H="확정":!H&&Y==="기안중"&&(H="기안중")});const q={};e.forEach(C=>{const T=se[C.key];T&&(q[C.key]={tnt:T.tnt||0,dys:T.dys||0})}),v(q),b(H)}catch{}}O()},[d,e,N]),c.useEffect(()=>{async function O(){try{const z=Array.from(new Set(e.map(C=>String(C.empName||"").trim()).filter(Boolean)));if(!z.length){f({});return}const Z=new URL("/api/v1/sales/employee-yearly",window.location.origin);Z.searchParams.set("year",String(d)),Z.searchParams.set("empNames",z.join(",")),Z.searchParams.set("joinKey","emp_name");const ae=await fetch(Z.toString()),se=ae.ok?await ae.json():[],H=Array.isArray(se)?se:Array.isArray(se==null?void 0:se.employees)?se.employees:[],q={};H.forEach(C=>{const T=String(C.emp_name??C.empName??"").trim();if(!T)return;const W=Number(C.tnt_amount??0),I=Number(C.dys_amount??0),U=q[T]||{tnt:0,dys:0};q[T]={tnt:U.tnt+(Number.isFinite(W)?W:0),dys:U.dys+(Number.isFinite(I)?I:0)}}),f(q)}catch{f({})}}O()},[d,e]);function P(O,z){const Z=Number(z);return!Number.isFinite(Z)||Z<=0?"-":`${(Math.max(0,Number(O||0))*1e8/Z*100).toFixed(1)}%`}const _=e;function $(O){p(O);try{localStorage.setItem("tnt.sales.selectedEmployee",JSON.stringify(O))}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.employee.selected"))}catch{}}function L(O,z,Z){const ae=Number((Z||"").replace(/[,\s]/g,"")),se=Number.isFinite(ae)?ae:0;v(H=>{const C={...H[O]||{tnt:0,dys:0},[z]:se};return{...H,[O]:C}})}function j(O,z){const Z=Math.max(0,Math.round(Number(O)||0)),ae=z.reduce((W,I)=>W+(Number(I.value)||0),0);if(!Number.isFinite(ae)||ae<=0||Z<=0){const W={};return z.forEach(I=>{W[I.key]=0}),W}const H=z.map(W=>({key:W.key,exact:Z*((Number(W.value)||0)/ae)})).map(W=>({key:W.key,floor:Math.floor(W.exact),frac:W.exact-Math.floor(W.exact)}));let q=H.reduce((W,I)=>W+I.floor,0),C=Z-q;H.sort((W,I)=>I.frac-W.frac);for(let W=0;W<C&&H.length>0;W++){const I=W%H.length;H[I].floor+=1}const T={};return H.forEach(W=>{T[W.key]=W.floor}),T}async function S(){if(!o){l(!0);try{let O=null;try{const oe=localStorage.getItem("tnt.sales.assign.companyTotals");O=oe?JSON.parse(oe):null}catch{}const z=Math.round(Number((O==null?void 0:O.tnt)||0)),Z=Math.round(Number((O==null?void 0:O.dys)||0));if(!Number.isFinite(z)||!Number.isFinite(Z)){alert("회사별 목표 합계를 찾을 수 없습니다. 상단 패널을 확인하세요.");return}const ae=e.map(oe=>String(oe.empName||"").trim()).filter(oe=>!!oe);if(!ae.length){alert("대상 직원이 없습니다.");return}const se=new URL("/api/v1/sales/employee-yearly",window.location.origin);se.searchParams.set("year",String(d)),se.searchParams.set("empNames",ae.join(",")),se.searchParams.set("joinKey","emp_name");const H=await fetch(se.toString()),q=H.ok?await H.json():[],C=Array.isArray(q)?q:Array.isArray(q==null?void 0:q.employees)?q.employees:[],T={};Array.isArray(C)&&C.forEach(oe=>{const F=String(oe.emp_name??oe.empName??"").trim();if(!F)return;const G=Number(oe.tnt_amount??0),de=Number(oe.dys_amount??0),be=T[F]||{tnt:0,dys:0};T[F]={tnt:be.tnt+(Number.isFinite(G)?G:0),dys:be.dys+(Number.isFinite(de)?de:0)}});const W={};e.forEach(oe=>{const F=String(oe.empName||"").trim();W[F]=(W[F]||0)+1});const I=[],U=[];e.forEach(oe=>{const F=String(oe.empName||"").trim(),G=T[F]||{tnt:0,dys:0},de=Math.max(1,W[F]||1);I.push({key:oe.key,value:G.tnt/de}),U.push({key:oe.key,value:G.dys/de})});const K=j(z,I),Y=j(Z,U);v(oe=>{const F={...oe};return e.forEach(G=>{F[G.key]={tnt:K[G.key]??0,dys:Y[G.key]??0}}),F});const M=oe=>Object.values(oe||{}).reduce((F,G)=>F+(Number(G)||0),0),D=`TNT 합계 ${y.format(M(K))} / 목표 ${y.format(z)}
DYS 합계 ${y.format(M(Y))} / 목표 ${y.format(Z)}`;M(K)!==z||M(Y)!==Z?alert(`배정 완료(합계 보정 필요):
`+D):alert(`배정이 완료되었습니다.
`+D)}catch(O){alert((O==null?void 0:O.message)||"배정 중 오류가 발생했습니다.")}finally{l(!1)}}}return n.jsxs("section",{children:[n.jsx(B1,{}),n.jsxs("div",{className:"page-title",style:{alignItems:"center",marginTop:12},children:[n.jsxs("h2",{style:{margin:0,fontSize:18,display:"flex",alignItems:"center",gap:8},children:["목표배정",g?n.jsx("span",{className:"badge",title:"해당 연도 전체 단계",children:g}):null]}),n.jsxs("div",{style:{marginLeft:"auto",display:"inline-flex",alignItems:"center",gap:8},children:[n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>S(),disabled:o,title:"전년도 매출 비율로 자동 배정",children:"할당(매출 기반)"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>R(!1),title:"현재 배정값 저장",children:"저장"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>R(!0),title:"현재 배정값 확정",children:"확정"})]})]}),i&&n.jsx("div",{className:"error",children:i}),n.jsx("div",{className:"table-container",style:{height:"calc(100vh - 140px)"},children:r?n.jsx("div",{className:"empty-state",children:"불러오는 중…"}):_.length===0?n.jsx("div",{className:"empty-state",children:"데이터가 없습니다"}):n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:140},children:"부서"}),n.jsx("th",{style:{width:140},children:"사번"}),n.jsx("th",{style:{width:180,textAlign:"left"},children:"이름"}),n.jsx("th",{style:{width:140,textAlign:"right"},children:"TNT"}),n.jsx("th",{style:{width:110,textAlign:"right"},children:"TNT 전년대비"}),n.jsx("th",{style:{width:140,textAlign:"right"},children:"DYS"}),n.jsx("th",{style:{width:110,textAlign:"right"},children:"DYS 전년대비"})]})}),n.jsx("tbody",{children:_.map((O,z)=>{var q,C;const Z=x[O.key]||{tnt:0,dys:0},ae=String(O.empName||"").trim(),se=Number(((q=u[ae])==null?void 0:q.tnt)||0),H=Number(((C=u[ae])==null?void 0:C.dys)||0);return n.jsxs("tr",{onClick:()=>$(O),"aria-selected":(m==null?void 0:m.key)===O.key?!0:void 0,style:(m==null?void 0:m.key)===O.key?{background:"rgba(59,130,246,.12)"}:void 0,children:[n.jsx("td",{children:O.deptName}),n.jsx("td",{children:O.empId}),n.jsx("td",{style:{textAlign:"left"},children:O.empName}),n.jsx("td",{style:{textAlign:"right"},children:n.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9,]*",value:Z.tnt?y.format(Z.tnt):"",onChange:T=>L(O.key,"tnt",T.target.value),placeholder:"0",style:{width:"100%",textAlign:"right"},className:"assign-input","aria-label":`TNT 목표(${O.empName})`,title:E?"Moderate 모드에서는 목표 수정이 비활성화됩니다":"TNT 매출목표",disabled:E})}),n.jsx("td",{style:{textAlign:"right"},title:"해당 직원 전년도 TNT 매출 대비 올해 목표 비율",children:n.jsx("span",{className:"muted",children:P(Z.tnt,se)})}),n.jsx("td",{style:{textAlign:"right"},children:n.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9,]*",value:Z.dys?y.format(Z.dys):"",onChange:T=>L(O.key,"dys",T.target.value),placeholder:"0",style:{width:"100%",textAlign:"right"},className:"assign-input","aria-label":`DYS 목표(${O.empName})`,title:E?"Moderate 모드에서는 목표 수정이 비활성화됩니다":"DYS 매출목표",disabled:E})}),n.jsx("td",{style:{textAlign:"right"},title:"해당 직원 전년도 DYS 매출 대비 올해 목표 비율",children:n.jsx("span",{className:"muted",children:P(Z.dys,H)})})]},z)})})]})})]});async function R(O){try{const z=O?"확정":"기안중",ae=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase()==="moderate"?2:1,se=[],H=`${d}-01-01`;e.forEach(W=>{const I=x[W.key]||{tnt:0,dys:0};se.push({targetYear:H,empName:W.empName,companyName:"TNT",targetAmount:Math.round(I.tnt||0),targetStage:z,versionNo:ae}),se.push({targetYear:H,empName:W.empName,companyName:"DYS",targetAmount:Math.round(I.dys||0),targetStage:z,versionNo:ae})});const q=localStorage.getItem("tnt.sales.empSeq")||"",C={"Content-Type":"application/json"};q&&(C["X-EMP-SEQ"]=String(q));const T=await fetch("/api/v1/targets/assigned/upsert",{method:"POST",headers:C,body:JSON.stringify(se)});if(!T.ok)throw new Error(`HTTP ${T.status}`);O&&await fetch(`/api/v1/targets/assigned/confirm?year=${d}`,{method:"POST",headers:C}),alert(O?"배정이 확정되었습니다.":"배정이 저장되었습니다.")}catch(z){alert((z==null?void 0:z.message)||"배정 저장 중 오류가 발생했습니다.")}}}function U1(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState("ALL"),[d,h]=c.useState("mine");function u(){const C=new Date,T=String(C.getFullYear()%100).padStart(2,"0"),W=String(C.getMonth()+1).padStart(2,"0"),I=String(C.getDate()).padStart(2,"0");return`${T}-${W}-${I}`}const[f,m]=c.useState(u()),[p,x]=c.useState(u()),[v,g]=c.useState(null),[b,y]=c.useState(null),N=c.useRef(null),[A,E]=c.useState(null),[w,P]=c.useState(null),[_,$]=c.useState(null),[L,j]=c.useState("");async function S(C){if(C==="ALL")return"";try{const T=typeof window<"u"&&localStorage.getItem("tnt.sales.assigneeId")||"",W=typeof window<"u"&&localStorage.getItem("tnt.sales.empId")||"",I=new URLSearchParams;T&&I.set("assigneeId",T),W&&I.set("empId",W),I.set("companyCode",C);const U=await fetch(`/api/v1/employee/by-assignee?${I.toString()}`,{cache:"no-store"});if(!U.ok)return"";const K=await U.json().catch(()=>null),Y=(K==null?void 0:K.resolvedSalesEmpSeq)??(C==="DYS"?K==null?void 0:K.dys_emp_seq:K==null?void 0:K.tnt_emp_seq);return Y!=null&&String(Y)?String(Y):""}catch{return""}}function R(C){if(!C)return"";let T=String(C).trim();const W=T.replace(/[^0-9]/g,"");if(W.length===6){const K=W.slice(0,2),Y=W.slice(2,4),M=W.slice(4,6);return O(K,Y,M)?`${K}-${Y}-${M}`:null}if(W.length===8){const K=W.slice(2,4),Y=W.slice(4,6),M=W.slice(6,8);return O(K,Y,M)?`${K}-${Y}-${M}`:null}const I=T.match(/^\s*(\d{2})[-/](\d{2})[-/](\d{2})\s*$/);if(I){const[,K,Y,M]=I;return O(K,Y,M)?`${K}-${Y}-${M}`:null}const U=T.match(/^\s*(\d{4})[-/](\d{2})[-/](\d{2})\s*$/);if(U){const[,K,Y,M]=U,D=K.slice(2);return O(D,Y,M)?`${D}-${Y}-${M}`:null}return null}function O(C,T,W){const I=Number(C),U=Number(T),K=Number(W);return!(!Number.isInteger(I)||!Number.isInteger(U)||!Number.isInteger(K)||U<1||U>12||K<1||K>31||K>[31,28,31,30,31,30,31,31,30,31,30,31][U-1])}function z(C){const T=C.match(/^(\d{2})-(\d{2})-(\d{2})$/);return T?`20${T[1]}-${T[2]}-${T[3]}`:null}function Z(C){try{let T=String(C??"");return T=T.replace(/\r\n/g,`
`).replace(/\r/g,`
`).replace(/\\n/g,`
`),T}catch{return String(C??"")}}function ae(C){const T=String(C??"").trim();if(!T)return"";const W=T.replace(/[^0-9]/g,"");return W.length===8?`${W.slice(0,4)}-${W.slice(4,6)}-${W.slice(6,8)}`:W.length===6?`20${W.slice(0,2)}-${W.slice(2,4)}-${W.slice(4,6)}`:T}async function se(C=!1){const T=f.trim(),W=p.trim();let I=T?R(T):"",U=W?R(W):"";if(P(null),$(null),T&&!I){P("형식: YY-MM-DD");return}if(W&&!U){$("형식: YY-MM-DD");return}if(typeof I=="string"&&m(I),typeof U=="string"&&x(U),I&&U){const K=z(I),Y=z(U);if(K>Y){$("종료일이 시작일보다 빠릅니다");return}}a(!0),s(null);try{const K=new URL("/api/v1/orders/external/tsl-order-text",window.location.origin);if(K.searchParams.set("company",o),I&&K.searchParams.set("fromDate",I),U&&K.searchParams.set("toDate",U),d==="mine"){const F=await S(o);F&&K.searchParams.set("salesEmpSeq",F)}const Y=await fetch(K.toString(),{cache:"no-store"});if(!Y.ok)throw new Error(`HTTP ${Y.status}`);const M=await Y.json().catch(()=>[]);let D=Array.isArray(M)?M:[];const oe=L.trim();if(oe){const F=oe.split(/\s+/).map(G=>G.toLowerCase());D=D.filter(G=>{const de=(()=>{const be=Object.entries(G);let ke=null;for(const[ye,Ce]of be){const J=String(ye).toLowerCase();if(J==="custseq"||J==="custname"||J==="customername"||J==="customer_name"){ke=Ce;break}}return String(ke??"")})().toLowerCase();return F.every(be=>de.includes(be))})}t(D)}catch(K){s((K==null?void 0:K.message)||"조회 실패"),t([])}finally{a(!1)}}c.useEffect(()=>{if(!(b!=null&&b.open))return;const C=W=>{const I=N.current;I&&W.target instanceof Node&&!I.contains(W.target)&&y(null)},T=W=>{W.key==="Escape"&&y(null)};return document.addEventListener("mousedown",C,!0),window.addEventListener("keydown",T,!0),()=>{document.removeEventListener("mousedown",C,!0),window.removeEventListener("keydown",T,!0)}},[b==null?void 0:b.open]);const H=c.useMemo(()=>{if(!e.length)return[];const C=e[0];return Object.keys(C)},[e]);function q(C){const T=(C||"").toString();return/^OrderTextNo$/i.test(T)?"수주장번호":/^OrderTextDate$/i.test(T)||/^OrderTextDat$/i.test(T)?"주문일자":/^CustSeq$/i.test(T)||/^CustName$/i.test(T)||/^CustomerName$/i.test(T)?"거래처명":/^RegionGroup$/i.test(T)||/^region_group$/i.test(T)?"지역그룹":/^SalesEmpSeq$/i.test(T)?"영업":/^OrderText$/i.test(T)?"수주내역":/^IsCancel$/i.test(T)?"중단여부":/^CancelText$/i.test(T)?"중단사유":/^Remark$/i.test(T)?"비고":/^LastDateTime$/i.test(T)?"최종수정일시":/^WHSeq$/i.test(T)?"창고번호":/^DelvDate$/i.test(T)?"납기예정일":/^CustEmpName$/i.test(T)?"거래처담당":/^IsClaim$/i.test(T)?"Claim":/^OrderRemark$/i.test(T)?"주문요청사항":/^Request(Date|Dt)$/i.test(T)||/^ReqDate$/i.test(T)?"요청일자":T}return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:18},children:"수주장 조회"}),n.jsxs("div",{style:{marginLeft:16,background:"#f3f4f6",padding:4,borderRadius:8,display:"flex",gap:0},children:[n.jsx("button",{onClick:()=>l("ALL"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:o==="ALL"?"#fff":"transparent",color:o==="ALL"?"#2563eb":"#6b7280",boxShadow:o==="ALL"?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:"ALL"}),n.jsx("button",{onClick:()=>l("TNT"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:o==="TNT"?"#fff":"transparent",color:o==="TNT"?"#2563eb":"#6b7280",boxShadow:o==="TNT"?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:"TNT"}),n.jsx("button",{onClick:()=>l("DYS"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:o==="DYS"?"#fff":"transparent",color:o==="DYS"?"#2563eb":"#6b7280",boxShadow:o==="DYS"?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:"DYS"})]}),n.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:12,fontSize:12},children:[n.jsxs("select",{className:"search-input",value:d,onChange:C=>h(C.target.value||"all"),title:"조회 범위",style:{minWidth:110},children:[n.jsx("option",{value:"mine",children:"내수주"}),n.jsx("option",{value:"all",children:"전체"})]}),n.jsx("label",{className:"muted",children:"수주일"}),n.jsx("input",{className:"search-input",placeholder:"YY-MM-DD",value:f,onChange:C=>{m(C.target.value),w&&P(null)},onBlur:C=>{const T=R(C.target.value);T===null&&C.target.value.trim()?P("형식: YY-MM-DD"):typeof T=="string"&&m(T)},style:{width:90}}),w?n.jsx("div",{className:"error",style:{fontSize:11},children:w}):null,n.jsx("span",{className:"muted",children:"~"}),n.jsx("input",{className:"search-input",placeholder:"YY-MM-DD",value:p,onChange:C=>{x(C.target.value),_&&$(null)},onBlur:C=>{const T=R(C.target.value);T===null&&C.target.value.trim()?$("형식: YY-MM-DD"):typeof T=="string"&&x(T)},style:{width:90}}),_?n.jsx("div",{className:"error",style:{fontSize:11},children:_}):null,n.jsx("label",{className:"muted",children:"거래처명"}),n.jsx("input",{className:"search-input",placeholder:"검색어(공백으로 AND)",value:L,onChange:C=>j(C.target.value),style:{width:200}}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>se(!0),disabled:!!w||!!_||r,children:"조회"})]})]}),i?n.jsx("div",{className:"error",children:i}):null,n.jsx("div",{className:"table-container",style:{height:"calc(100vh - 160px)"},children:r?n.jsx("div",{className:"empty-state",children:"불러오는 중…"}):e.length===0?n.jsx("div",{className:"empty-state",children:"데이터가 없습니다"}):n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsx("tr",{children:H.map(C=>n.jsx("th",{children:q(C)},C))})}),n.jsx("tbody",{children:e.map((C,T)=>{const W=Object.keys(C).find(U=>U.toLowerCase()==="companytype"),I=W?String(C[W]||"").trim().toUpperCase():"";return n.jsx("tr",{onMouseEnter:U=>{const K=(U.clientX||0)+12,Y=(U.clientY||0)+12;b!=null&&b.open||g({open:!0,x:K,y:Y,rec:C})},onMouseMove:U=>{if(!(v!=null&&v.open))return;const K=(U.clientX||0)+12,Y=(U.clientY||0)+12;b!=null&&b.open||g({open:!0,x:K,y:Y,rec:C})},onMouseLeave:()=>g(null),onContextMenu:U=>{U.preventDefault();const K=U.clientX,Y=U.clientY;y({open:!0,x:K,y:Y,rec:C})},children:H.map(U=>{const K=/^(CustSeq|CustName|CustomerName|customer_name)$/i.test(U)||q(U)==="거래처명",Y=String((C==null?void 0:C[U])??"");if(K&&o==="ALL"&&I){const M=I.includes("TNT"),D=I.includes("DYS"),oe=M?"T":D?"D":"",F=M?"#1d4ed8":D?"#059669":"#6b7280";return n.jsx("td",{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[oe&&n.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:"50%",background:F,color:"#fff",fontSize:11,fontWeight:700,flexShrink:0},title:I,children:oe}),n.jsx("span",{children:Y})]})},U)}return n.jsx("td",{children:Y},U)})},T)})})]})}),v!=null&&v.open&&!(b!=null&&b.open)?n.jsx("div",{role:"dialog","aria-live":"polite",style:{position:"fixed",left:Math.min(Math.max(8,v.x),window.innerWidth-460),top:Math.min(Math.max(8,v.y),window.innerHeight-300),zIndex:80,pointerEvents:"none"},children:n.jsx("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:8,minWidth:320,maxWidth:600,maxHeight:"85vh",overflow:"auto",boxShadow:"0 8px 24px rgba(0,0,0,.18)"},children:n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:H.map(C=>{const T=(v.rec||{})[C],W=Z(T);return n.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10,paddingBottom:6,borderBottom:"1px solid var(--border-light)"},children:[n.jsx("div",{style:{minWidth:120,fontWeight:600,fontSize:12,color:"var(--text-secondary)"},children:q(C)}),n.jsx("div",{style:{flex:1,whiteSpace:"pre-wrap",fontSize:12,wordBreak:"break-word"},children:W||n.jsx("span",{style:{color:"var(--text-muted)",fontStyle:"italic"},children:"-"})})]},C)})})})}):null,b!=null&&b.open?(()=>{const C=Math.min(Math.max(8,b.x),window.innerWidth-220),T=Math.min(Math.max(8,b.y),window.innerHeight-120);async function W(){try{const U=H.find(J=>/^OrderText$/i.test(J))||H.find(J=>q(J)==="수주내역"),K=H.find(J=>/^OrderRemark$/i.test(J))||H.find(J=>q(J)==="주문요청사항"),Y=H.find(J=>q(J)==="거래처명")||H.find(J=>/^(CustName|CustomerName|customer_name|CustSeq)$/i.test(J)),M=H.find(J=>/^(UserName|CreatedBy|created_by)$/i.test(J)),D=H.find(J=>/^(RegionGroup|region_group)$/i.test(J)),oe=o,F=Y?String((b.rec||{})[Y]??""):"";let G=M?String((b.rec||{})[M]??""):"",de=D?String((b.rec||{})[D]??""):"",be=U?Z((b.rec||{})[U]):"";const ke=K?Z((b.rec||{})[K]):"";if(!G){const J=H.find(ge=>q(ge)==="영업");J&&(G=String((b.rec||{})[J]??""))}if(be){const J=String(be).split(/\n/),ge=[];for(const Ee of J){const we=Ee.match(/^\s*지역\s*그룹\s*[:：]\s*(.*)\s*$/)||Ee.match(/^\s*지역그룹\s*[:：]\s*(.*)\s*$/);if(we){const He=(we[1]||"").trim();!de&&He&&(de=He)}else ge.push(Ee)}be=ge.join(`
`)}let ye=[];ye.push(`회사코드: ${oe}`),ye.push(`거래처: ${F}`),ye.push(`등록자: ${G}`),ye.push(`지역 그룹: ${de}`),ye.push("주문내용:"),ye.push(be),ye.push("요청사항:"),ye.push(ke);let Ce=ye.join(`
`);if(!be&&!ke&&(Ce=JSON.stringify(b.rec??{},null,2)),navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(Ce);else{const J=document.createElement("textarea");J.value=Ce,J.style.position="fixed",J.style.left="-9999px",document.body.appendChild(J),J.focus(),J.select(),document.execCommand("copy"),document.body.removeChild(J)}E({open:!0,x:C+8,y:T+8}),setTimeout(()=>E(null),1200)}catch{}y(null)}async function I(){try{const U=H.find(we=>/^OrderText$/i.test(we))||H.find(we=>q(we)==="수주내역"),K=H.find(we=>/^OrderRemark$/i.test(we))||H.find(we=>q(we)==="주문요청사항"),Y=H.find(we=>q(we)==="거래처명")||H.find(we=>/^(CustName|CustomerName|customer_name|CustSeq)$/i.test(we)),M=H.find(we=>q(we)==="수주장번호")||H.find(we=>/^OrderTextNo$/i.test(we)),D=[H.find(we=>q(we)==="요청일자"),H.find(we=>/^Request(Date|Dt)$/i.test(we)),H.find(we=>/^DelvDate$/i.test(we)),H.find(we=>/^OrderTextDate$/i.test(we))].filter(Boolean);let oe="";const F=H.find(we=>/^(UserName|CreatedBy|created_by)$/i.test(we));if(F&&(oe=String((b.rec||{})[F]??"")),!oe){const we=H.find(He=>q(He)==="영업");we&&(oe=String((b.rec||{})[we]??""))}let G="";const de=H.find(we=>/^(RegionGroup|region_group)$/i.test(we));de&&(G=String((b.rec||{})[de]??""));let be=U?Z((b.rec||{})[U]):"";const ke=K?Z((b.rec||{})[K]):"";if(be){const we=String(be).split(/\n/),He=[];for(const mt of we){const vt=mt.match(/^\s*지역\s*그룹\s*[:：]\s*(.*)\s*$/)||mt.match(/^\s*지역그룹\s*[:：]\s*(.*)\s*$/);if(vt){const Ot=(vt[1]||"").trim();!G&&Ot&&(G=Ot)}else He.push(mt)}be=He.join(`
`)}const ye=M?String((b.rec||{})[M]??"").trim():"";let Ce="";for(const we of D){const He=we?String((b.rec||{})[we]??"").trim():"";if(He){Ce=ae(He);break}}const J={orderNo:ye,companyCode:o,customerName:Y?String((b.rec||{})[Y]??""):"",createdBy:oe,regionGroup:G,orderText:be,orderRemark:ke,requestDate:Ce},ge=await fetch("/api/v1/slack/send-order-copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)}),Ee=await ge.json().catch(()=>({}));ge.ok&&Ee.success?(E({open:!0,x:C+8,y:T+8,message:"Slack 전송 완료"}),setTimeout(()=>E(null),1500)):alert(Ee.message||`Slack 전송 실패 (HTTP ${ge.status})`)}catch(U){console.error("Slack 전송 실패:",U),alert("Slack 전송 중 오류가 발생했습니다.")}y(null)}return n.jsx("div",{ref:N,role:"menu",style:{position:"fixed",left:C,top:T,zIndex:90,minWidth:180},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:4,border:"1px solid var(--border)",borderRadius:8,boxShadow:"0 8px 24px rgba(0,0,0,.18)",display:"flex",flexDirection:"column",gap:2,fontSize:13},children:[n.jsx("button",{className:"btn-plain",style:{width:"100%",textAlign:"left",padding:"4px 6px",fontSize:13},onClick:I,children:"Slack전송"}),n.jsx("button",{className:"btn-plain",style:{width:"100%",textAlign:"left",padding:"4px 6px",fontSize:13},onClick:W,children:"복사"})]})})})():null,A!=null&&A.open?n.jsx("div",{style:{position:"fixed",left:A.x,top:A.y,zIndex:95},children:n.jsx("div",{className:"card",style:{background:"var(--panel)",padding:"2px 6px",border:"1px solid var(--border)",borderRadius:6,fontSize:11},children:A.message||"복사했습니다"})}):null]})}const H1=["매출","가격","재고","경쟁사","Complaint","품질관리","공급사"];function Y1(){const[e,t]=c.useState(""),[r,a]=c.useState([]),[i,s]=c.useState(!1),[o,l]=c.useState(null),[d,h]=c.useState("매출"),u=new Intl.NumberFormat("ko-KR");async function f(){s(!0),l(null);try{const m=new URL("/api/v1/items/search",window.location.origin);m.searchParams.set("q",e||""),m.searchParams.set("limit","100");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const x=await p.json(),v=Array.isArray(x)?x.map(g=>({itemSeq:Number(g.itemSeq??g.item_seq??0),itemName:String(g.itemName??g.item_name??""),recentInvoiceDate:String(g.recentInvoiceDate??g.recent_invoice_date??""),curAmt:Number(g.curAmt??g.cur_amt??0),qty:Number(g.qty??0)})):[];a(v)}catch(m){l((m==null?void 0:m.message)||"조회 오류"),a([])}finally{s(!1)}}return c.useEffect(()=>{f()},[]),n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:18},children:"Item360"}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsx("input",{className:"search-input",value:e,onChange:m=>t(m.target.value),placeholder:"품목명 검색",onKeyDown:m=>{m.key==="Enter"&&f()}}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:f,disabled:i,children:"검색"})]})]}),o&&n.jsx("div",{className:"error",children:o}),n.jsx("div",{className:"table-container",style:{height:300},children:i?n.jsx("div",{className:"empty-state",children:"불러오는 중…"}):r.length===0?n.jsx("div",{className:"empty-state",children:"데이터가 없습니다"}):n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:120},children:"품목코드"}),n.jsx("th",{style:{textAlign:"left"},children:"품목명"}),n.jsx("th",{style:{width:140},children:"최근 매출일"}),n.jsx("th",{style:{width:140,textAlign:"right"},children:"매출금액"}),n.jsx("th",{style:{width:120,textAlign:"right"},children:"수량"})]})}),n.jsx("tbody",{children:r.map((m,p)=>n.jsxs("tr",{children:[n.jsx("td",{children:m.itemSeq||""}),n.jsx("td",{style:{textAlign:"left"},children:m.itemName||""}),n.jsx("td",{children:m.recentInvoiceDate||""}),n.jsxs("td",{style:{textAlign:"right"},children:[u.format(Math.round(Number(m.curAmt||0)))," 원"]}),n.jsx("td",{style:{textAlign:"right"},children:u.format(Math.round(Number(m.qty||0)))})]},p))})]})}),n.jsxs("div",{style:{marginTop:12},children:[n.jsx("div",{style:{display:"flex",gap:6,borderBottom:"1px solid var(--border)"},children:H1.map(m=>n.jsx("button",{className:"btn btn-card",style:{borderBottom:d===m?"2px solid var(--accent)":"2px solid transparent"},onClick:()=>h(m),children:m},m))}),n.jsx("div",{style:{padding:12},children:n.jsxs("div",{className:"empty-state",children:[d," 탭은 준비중입니다."]})})]})]})}const K1=["영업1본부","영업1팀","영업2본부","영업2팀"];function G1(){const[e,t]=c.useState(()=>{try{const T=localStorage.getItem("tnt.sales.assign.year");return T?Number(T):new Date().getFullYear()}catch{return new Date().getFullYear()}}),[r,a]=c.useState([]),[i,s]=c.useState(!1),[o,l]=c.useState(null),[d,h]=c.useState([]),[u,f]=c.useState(!1),m=c.useRef(null),[p,x]=c.useState([]),[v,g]=c.useState(!1),[b,y]=c.useState(null),[N,A]=c.useState({tnt:0,dys:0}),[E,w]=c.useState([]),[P,_]=c.useState(!1),[$,L]=c.useState(null),j=c.useMemo(()=>{try{let T=0,W=0;for(const I of p){const U=String((I==null?void 0:I.company_name)??(I==null?void 0:I.companyName)??"").toUpperCase(),K=Number((I==null?void 0:I.target_amount_max)??0);Number.isFinite(K)&&(U==="TNT"?T+=K:U==="DYS"&&(W+=K))}return{tnt:T,dys:W}}catch{return{tnt:0,dys:0}}},[p]),S=c.useMemo(()=>({tnt:N.tnt/1e8,dys:N.dys/1e8}),[N]),R=c.useMemo(()=>({tnt:j.tnt-S.tnt,dys:j.dys-S.dys}),[j,S]),O=c.useMemo(()=>{try{const T=Y=>p.reduce((M,D)=>{const oe=String((D==null?void 0:D.biz_area_name)??(D==null?void 0:D.bizAreaName)??""),F=Number((D==null?void 0:D.target_amount_max)??0);return M+(oe===Y&&Number.isFinite(F)?F:0)},0),W=T("복층유리"),I=T("건자재"),U=T("실란트");return(Number.isFinite(W)?W:0)+(Number.isFinite(I)?I:0)+(Number.isFinite(U)?U:0)}catch{return 0}},[p]),z=c.useMemo(()=>{const T=[];for(let W=2030;W>=2026;W--)T.push(W);return T},[]);async function Z(T){s(!0),l(null);try{const W=new URL("/api/v1/targets/assigned",window.location.origin);W.searchParams.set("year",String(T));const I=await fetch(W.toString()),U=I.ok?await I.json():[],K=Array.isArray(U)?U:[];if(K.length>0){const F=K.reduce((G,de)=>{const be=String(de.emp_id??de.empId??"").trim(),ke=String(de.emp_name??de.empName??"").trim(),ye=String(de.dept_name??de.deptName??""),Ce=be||(ke?`name:${ke}`:"");return Ce&&(G.some(J=>J.key===Ce)||G.push({key:Ce,empId:be,empName:ke,deptName:ye})),G},[]);F.sort((G,de)=>(G.deptName||"").localeCompare(de.deptName||"")||(G.empName||"").localeCompare(de.empName||"")),a(F),s(!1);return}const Y=new URL("/api/v1/employees",window.location.origin);Y.searchParams.set("depts",K1.join(","));const M=await fetch(Y.toString());if(!M.ok)throw new Error(`HTTP ${M.status}`);const D=await M.json(),oe=Array.isArray(D)?D.map(F=>{const G=String(F.empId??F.emp_id??"").trim(),de=String(F.empName??F.emp_name??"").trim(),be=String(F.deptName??F.dept_name??""),ke=String(F.assignee_id??F.assigneeId??"").trim()||void 0;return{key:G||ke||(de?`name:${de}`:""),empId:G,empName:de,deptName:be,assigneeId:ke}}).filter(F=>!!F.key):[];oe.sort((F,G)=>(F.deptName||"").localeCompare(G.deptName||"")||(F.empName||"").localeCompare(G.empName||"")),a(oe)}catch(W){l((W==null?void 0:W.message)||"조회 중 오류"),a([])}finally{s(!1)}}c.useEffect(()=>{Z(e)},[e]),c.useEffect(()=>{async function T(){g(!0),y(null);try{const W=new URL("/api/v1/targets/year",window.location.origin);W.searchParams.set("year",String(e));const I=await fetch(W.toString());if(!I.ok)throw new Error(`HTTP ${I.status}`);const U=await I.json();x(Array.isArray(U)?U:[])}catch(W){x([]),y((W==null?void 0:W.message)||"조회 오류")}finally{g(!1)}}T()},[e]),c.useEffect(()=>{async function T(){const W=d.length?r.filter(K=>d.includes(K.key)):r,I=W.map(K=>String(K.empId||"").trim()).filter(Boolean),U=W.map(K=>String(K.assigneeId||"").trim()).filter(Boolean);if(!e||I.length===0&&U.length===0){w([]),L(null);return}_(!0),L(null);try{const K=new URL("/api/v1/sales/plan/customer-counts",window.location.origin);K.searchParams.set("year",String(e)),I.length>0&&K.searchParams.set("empIds",I.join(",")),U.length>0&&K.searchParams.set("assigneeIds",U.join(","));const Y=await fetch(K.toString());if(!Y.ok)throw new Error(`HTTP ${Y.status}`);const M=await Y.json();w(Array.isArray(M)?M:[])}catch(K){w([]),L((K==null?void 0:K.message)||"고객수 요약 조회 오류")}finally{_(!1)}}T()},[e,d,r]),c.useEffect(()=>{async function T(){try{const W=new URL("/api/v1/sales/plan/totals",window.location.origin);W.searchParams.set("year",String(e));const I=await fetch(W.toString());if(!I.ok)throw new Error(`HTTP ${I.status}`);const U=await I.json().catch(()=>[]);let K=0,Y=0;Array.isArray(U)&&U.forEach(M=>{const D=String((M==null?void 0:M.company)||(M==null?void 0:M.company_type)||(M==null?void 0:M.companyName)||"").toUpperCase(),oe=Number((M==null?void 0:M.total)||(M==null?void 0:M.total_amount)||0);D==="TNT"?K+=Number.isFinite(oe)?oe:0:D==="DYS"&&(Y+=Number.isFinite(oe)?oe:0)}),A({tnt:K,dys:Y})}catch{A({tnt:0,dys:0})}}T()},[e]);function ae(T){const W=Number(T.target.value);if(!(!Number.isFinite(W)||W<=0)){t(W);try{localStorage.setItem("tnt.sales.assign.year",String(W))}catch{}}}function se(T){h(T);const W=r.filter(U=>T.includes(U.key));try{localStorage.setItem("tnt.sales.selectedEmployees",JSON.stringify(W))}catch{}const I=W[0]||null;try{I?localStorage.setItem("tnt.sales.selectedEmployee",JSON.stringify(I)):localStorage.removeItem("tnt.sales.selectedEmployee")}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.employees.selected",{detail:{items:W}}))}catch{}try{I&&window.dispatchEvent(new CustomEvent("tnt.sales.employee.selected"))}catch{}}function H(T){se(T?r.map(W=>W.key):[])}function q(T,W){const I=new Set(d);W?I.add(T):I.delete(T),se(Array.from(I))}c.useEffect(()=>{if(!u)return;const T=I=>{m.current&&(m.current.contains(I.target)||f(!1))},W=I=>{I.key==="Escape"&&f(!1)};return window.addEventListener("click",T,!0),window.addEventListener("keydown",W,!0),()=>{window.removeEventListener("click",T,!0),window.removeEventListener("keydown",W,!0)}},[u]);const C=c.useMemo(()=>{if(!d.length)return"전체";const T=r.filter(W=>d.includes(W.key)).map(W=>W.empName||W.empId||W.key);return T.length<=2?T.join(", "):`${T.slice(0,2).join(", ")} 외 ${T.length-2}명`},[d,r]);return n.jsxs("section",{children:[n.jsxs("div",{className:"card",style:{padding:8,marginBottom:12,display:"flex",alignItems:"center",gap:16,flexWrap:"wrap"},children:[n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[n.jsx("div",{className:"muted",children:"목표년도"}),n.jsx("select",{className:"search-input",value:e,onChange:ae,"aria-label":"목표년도",style:{height:28},children:z.map(T=>n.jsxs("option",{value:String(T),children:[T,"년"]},T))})]}),n.jsxs("div",{ref:m,style:{position:"relative",display:"inline-flex",alignItems:"center",gap:8},children:[n.jsx("div",{className:"muted",children:"영업사원"}),n.jsxs("button",{type:"button",className:"search-input","aria-haspopup":"listbox","aria-expanded":u,onClick:()=>f(T=>!T),style:{height:28,minWidth:260,display:"inline-flex",alignItems:"center",justifyContent:"space-between",gap:8},children:[n.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:C}),n.jsx("span",{"aria-hidden":!0,children:"▾"})]}),u&&n.jsxs("div",{role:"listbox",className:"card",style:{position:"absolute",zIndex:60,top:"100%",left:0,width:380,maxHeight:260,overflow:"auto",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,padding:8,marginTop:6,fontSize:11},children:[n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 6px"},children:[n.jsx("input",{type:"checkbox",checked:d.length===r.length&&r.length>0,onChange:T=>H(T.target.checked)}),n.jsx("span",{children:"전체"})]}),i?n.jsx("div",{className:"muted",style:{padding:"6px 6px"},children:"불러오는 중…"}):r.length===0?n.jsx("div",{className:"muted",style:{padding:"6px 6px"},children:"목록이 없습니다"}):r.map(T=>{const W=d.includes(T.key),I=`${T.deptName||"-"} / ${T.empName||""}${T.empId?` (${T.empId})`:""}`;return n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 6px",cursor:"pointer"},children:[n.jsx("input",{type:"checkbox",checked:W,onChange:U=>q(T.key,U.target.checked)}),n.jsx("span",{children:I})]},T.key)}),o?n.jsx("div",{className:"error",style:{padding:"6px 6px"},children:o}):null]})]})]}),n.jsxs("div",{className:"card",style:{padding:8},children:[b?n.jsx("div",{className:"error",style:{marginBottom:8},children:b}):null,v?n.jsx("div",{className:"muted",style:{padding:"8px 6px"},children:"불러오는 중…"}):n.jsxs("div",{style:{display:"flex",alignItems:"stretch",gap:12},children:[n.jsxs("div",{style:{flex:"1 1 auto",display:"flex",flexDirection:"column",gap:6},children:[n.jsxs("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-between",margin:"0 2px"},children:[n.jsx("div",{className:"muted",style:{fontWeight:800},children:"회사 목표"}),n.jsx("div",{style:{fontWeight:800},children:Number.isFinite(O)?`${Number(O).toLocaleString(void 0,{maximumFractionDigits:1})} 억원`:"-"})]}),(()=>{let T=0,W=0,I,U=0,K;p.forEach(D=>{const oe=String((D==null?void 0:D.company_name)??(D==null?void 0:D.companyName)??"").toUpperCase(),F=String((D==null?void 0:D.biz_area_name)??(D==null?void 0:D.bizAreaName)??""),G=Number((D==null?void 0:D.target_amount_max)??0),de=String((D==null?void 0:D.target_stage)??(D==null?void 0:D.targetStage)??"")||void 0;oe==="TNT"?(F==="복층유리"&&Number.isFinite(G)?T+=G:F==="건자재"&&Number.isFinite(G)&&(W+=G),de&&(I=de)):oe==="DYS"&&F==="실란트"&&(Number.isFinite(G)&&(U+=G),de&&(K=de))});const Y=[{company:"TNT",biz:"복층유리+건자재",max:T+W,stage:I},{company:"DYS",biz:"실란트",max:U,stage:K}];return n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:8},children:Y.map((D,oe)=>{const F=D.company,G=D.biz,de=D.max,be=D.stage||"";return n.jsx("div",{className:"card",style:{padding:8,border:"1px solid var(--border)",borderRadius:10,display:"flex",alignItems:"center",minHeight:92,position:"relative"},children:n.jsxs("div",{style:{flex:1},children:[be?n.jsx("div",{style:{position:"absolute",top:6,left:6},children:n.jsx("span",{className:"badge",style:{fontSize:8,padding:"0 4px",lineHeight:1.1,border:"1px solid var(--border)",borderRadius:6},children:be})}):null,F==="TNT"&&G==="복층유리+건자재"?(()=>{try{let ke=0,ye=0;for(const J of p){const ge=String((J==null?void 0:J.company_name)??(J==null?void 0:J.companyName)??"").toUpperCase(),Ee=String((J==null?void 0:J.biz_area_name)??(J==null?void 0:J.bizAreaName)??""),we=Number((J==null?void 0:J.target_amount_max)??0);ge==="TNT"&&Number.isFinite(we)&&(Ee==="복층유리"?ke+=we:Ee==="건자재"&&(ye+=we))}const Ce=Number.isFinite(de)?Number(de):ke+ye;return n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,textAlign:"center"},children:[n.jsxs("div",{style:{fontWeight:800,fontSize:18,lineHeight:1.1},children:["TNT ",Ce.toLocaleString(void 0,{maximumFractionDigits:1}),"억원"]}),n.jsxs("div",{className:"muted",style:{fontSize:10,lineHeight:1.1},children:["(",`복층${ke.toLocaleString(void 0,{maximumFractionDigits:1})}억원+건자재${ye.toLocaleString(void 0,{maximumFractionDigits:1})}억원`,")"]})]})}catch{return n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,textAlign:"center"},children:[n.jsx("div",{style:{fontWeight:700,fontSize:11},children:"TNT"}),n.jsx("div",{className:"muted",style:{fontSize:11,lineHeight:1.1},children:"데이터 없음"})]})}})():n.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,textAlign:"center"},children:String(F||"").toUpperCase()==="DYS"&&G==="실란트"?n.jsx(n.Fragment,{children:n.jsxs("div",{style:{fontWeight:800,fontSize:18,lineHeight:1.1},children:["DYS ",Number(de).toLocaleString(void 0,{maximumFractionDigits:1}),"억원"]})}):n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{fontWeight:700,fontSize:11},children:G||"-"}),n.jsx("div",{style:{fontSize:11,fontWeight:800,lineHeight:1.1},children:Number.isFinite(de)?`${Number(de).toLocaleString(void 0,{maximumFractionDigits:1})} 억원`:"-"})]})})]})},oe)})})})()]}),n.jsx("div",{style:{flex:"0 0 auto",width:1,background:"var(--border)"}}),n.jsxs("aside",{style:{flex:"0 0 260px",maxWidth:320,paddingLeft:8,display:"flex",flexDirection:"column",justifyContent:"center"},children:[n.jsx("div",{style:{fontWeight:800,marginBottom:8},children:"목표수립 현황"}),n.jsx("div",{className:"card",style:{padding:10,border:"1px solid var(--border)",borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",minHeight:92},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,width:"100%"},children:[n.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:n.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`TNT ${S.tnt.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})}),n.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:n.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`DYS ${S.dys.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})})]})})]}),n.jsx("div",{style:{flex:"0 0 auto",width:1,background:"var(--border)"}}),n.jsxs("aside",{style:{flex:"0 0 260px",maxWidth:320,paddingLeft:8,display:"flex",flexDirection:"column",justifyContent:"center"},children:[n.jsx("div",{style:{fontWeight:800,marginBottom:8},children:"차액"}),n.jsx("div",{className:"card",style:{padding:10,border:"1px solid var(--border)",borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",minHeight:92},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,width:"100%"},children:[n.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:n.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`TNT ${R.tnt.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})}),n.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:n.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`DYS ${R.dys.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})})]})})]})]})]}),n.jsxs("div",{className:"card",style:{padding:8,marginTop:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[n.jsx("div",{style:{fontWeight:800},children:"고객수 요약"}),P?n.jsx("div",{className:"muted",style:{fontSize:12},children:"불러오는 중…"}):null]}),$?n.jsx("div",{className:"error",style:{marginBottom:8},children:$}):null,(()=>{const T=d.length?r.filter(I=>d.includes(I.key)):r,W=new Map;for(const I of E){const U=String((I==null?void 0:I.assignee_id)||(I==null?void 0:I.emp_id)||"").trim();if(!U)continue;const K=W.get(U)||[];K.push(I),W.set(U,K)}return n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:10},children:T.map(I=>{const U=String(I.assigneeId||I.empId||I.key||""),K=W.get(U)||[],Y=["TNT","DYS"],M=[...K].sort((D,oe)=>Y.indexOf(String(D.company||"").toUpperCase())-Y.indexOf(String(oe.company||"").toUpperCase()));return n.jsxs("div",{className:"card",style:{padding:10,border:"1px solid var(--border)",borderRadius:10},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[n.jsxs("div",{style:{fontWeight:700},children:[I.deptName||"-"," / ",I.empName||I.empId||I.key]}),n.jsxs("div",{className:"muted",style:{fontSize:11},children:[e,"년"]})]}),M.length===0?n.jsx("div",{className:"muted",style:{fontSize:12},children:"데이터가 없습니다"}):n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:8},children:M.map((D,oe)=>n.jsxs("div",{className:"card",style:{padding:8,border:"1px solid var(--border)",borderRadius:8,minHeight:92,display:"flex",flexDirection:"column",justifyContent:"center"},children:[n.jsx("div",{style:{fontWeight:700,marginBottom:6},children:String(D.company||"").toUpperCase()}),n.jsxs("div",{style:{display:"flex",gap:16,fontSize:12,justifyContent:"space-between"},children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[n.jsx("span",{className:"muted",children:"수립대상"}),n.jsx("strong",{children:Number(D.total_customers||0).toLocaleString()})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[n.jsx("span",{className:"muted",children:"확정"}),n.jsx("strong",{children:Number(D.confirmed_customers||0).toLocaleString()})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[n.jsx("span",{className:"muted",children:"진행 중"}),n.jsx("strong",{children:Number(D.planning_customers||0).toLocaleString()})]})]})]},oe))})]},U)})})})()]})]})}function V1(){return n.jsxs("section",{children:[n.jsx("h1",{children:"매출관리"}),n.jsx("div",{className:"empty-state",children:"초기 스켈레톤: 매출관리 화면"})]})}const Zf="http://220.73.213.73/Angkor.Ylw.Common.HttpExecute/RestOutsideService.svc/OpenApi/IsStoredProcedure/tnt_SWAPISLCustCreditListInfo",X1={certId:"TNT_CRM",certKey:"9836164F-3601-4DBB-9D6D-54685CD89B95",dsn:"tnt_bis",dsnOper:"tnt_oper",securityType:0,CompanySeq:1},Jl=[20,50,100],yr=e=>new Intl.NumberFormat("ko-KR",{maximumFractionDigits:0}).format(Math.round(e||0)),Q1=e=>{const t=r=>{const a=Number(r);return Number.isFinite(a)?a:0};return{CustName:String(e.CustName??""),CustNo:String(e.CustNo??""),CustSeq:String(e.CustSeq??""),IsCreditCheck:e.IsCreditCheck==="Y"?"Y":e.IsCreditCheck==="N"?"N":"",CurrName:String(e.CurrName??""),PrevCreditAmt:t(e.PrevCreditAmt),SalesAmt:t(e.SalesAmt),SalesVat:t(e.SalesVat),TotSalesAmt:t(e.TotSalesAmt),ReceiptAmt:t(e.ReceiptAmt),NoReceiptAmt:t(e.NoReceiptAmt)}},J1=({stdDate:e,custSeq:t,empSeq:r,pageNo:a,pageSize:i})=>({ROOT:{...X1,data:{ROOT:{DataBlock1:{StdDate:e.replace(/-/g,""),CustSeq:t.trim()?Number(t):"",EmpSeq:r.trim()?Number(r):"",SMQryType:1078004,IncludeMiNote:1,PAGE_NO:a,PAGE_SIZE:i}}}}});function Z1(){const e=new Date().toISOString().slice(0,10),[t,r]=c.useState({stdDate:e,custSeq:"",empSeq:""}),[a,i]=c.useState(t),[s,o]=c.useState(1),[l,d]=c.useState(Jl[0]),[h,u]=c.useState([]),[f,m]=c.useState({PAGE_NO:1,PAGE_SIZE:Jl[0],TotalData:0,TotalPage:0}),[p,x]=c.useState(!1),[v,g]=c.useState(null),[b,y]=c.useState(null),[N,A]=c.useState(null),[E,w]=c.useState(!1),[P,_]=c.useState(null),$=(z,Z)=>{r(ae=>({...ae,[z]:Z}))},L=()=>{i(t),o(1)},j=z=>{d(z),o(1)},S=z=>{o(Z=>z==="next"?f.TotalPage&&Z>=f.TotalPage?Z:Z+1:Math.max(1,Z-1))},R=c.useMemo(()=>h.reduce((z,Z)=>(z.sales+=Z.SalesAmt,z.receipt+=Z.ReceiptAmt,z.noReceipt+=Z.NoReceiptAmt,z),{sales:0,receipt:0,noReceipt:0}),[h]),O=c.useCallback(async()=>{x(!0),g(null);try{const z=J1({stdDate:a.stdDate,custSeq:a.custSeq,empSeq:a.empSeq,pageNo:s,pageSize:l}),Z=JSON.stringify(z,null,2);A(Z),w(!0);const ae=await fetch(Zf,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(z)});if(!ae.ok)throw new Error(`서버 응답이 존재하지 않거나 상태값 ${ae.status}`);const se=await ae.json(),H=se==null?void 0:se.ROOT,q=H==null?void 0:H.ReturnCode;if(q!=="0000"){const W=`ReturnCode: ${q??"N/A"}${H!=null&&H.ReturnMessage?` • ${H.ReturnMessage}`:""}`;throw _(W),new Error((H==null?void 0:H.ReturnMessage)??"데이터를 불러오는 데 실패했습니다.")}_(`ReturnCode: ${q??"N/A"}${H!=null&&H.ReturnMessage?` • ${H.ReturnMessage}`:""}`);const C=Array.isArray(H==null?void 0:H.DataBlock1)?H.DataBlock1:[];u(C.map(Q1));const T=Array.isArray(H==null?void 0:H.DataBlock2)?H.DataBlock2[0]:null;m(T?{PAGE_NO:Number(T.PAGE_NO??s),PAGE_SIZE:Number(T.PAGE_SIZE??l),TotalData:Number(T.TotalData??C.length),TotalPage:Number(T.TotalPage??0)}:W=>({...W,PAGE_NO:s,PAGE_SIZE:l,TotalData:C.length,TotalPage:Math.max(1,Math.ceil(C.length/l))})),y(new Date().toLocaleString())}catch(z){g(z.message??"데이터를 불러오는 중 알 수 없는 오류가 발생했습니다."),u([])}finally{x(!1)}},[a,s,l]);return c.useEffect(()=>{O()},[O]),n.jsxs("section",{className:"receivables-page",children:[n.jsxs("div",{className:"page-title",children:[n.jsx("h1",{children:"미수현황"}),n.jsx("p",{children:"기준일/필터를 설정하고 서버에서 고객 미수/판매/수금 데이터를 조회하세요."})]}),n.jsxs("div",{className:"filters-grid",children:[n.jsxs("label",{className:"field",children:[n.jsx("span",{children:"기준일"}),n.jsx("input",{type:"date",value:t.stdDate,onChange:z=>$("stdDate",z.target.value),className:"search-input"})]}),n.jsxs("label",{className:"field",children:[n.jsx("span",{children:"거래처 코드(CustSeq)"}),n.jsx("input",{type:"number",placeholder:"전체",value:t.custSeq,min:0,onChange:z=>$("custSeq",z.target.value),className:"search-input"})]}),n.jsxs("label",{className:"field",children:[n.jsx("span",{children:"사원 코드(EmpSeq)"}),n.jsx("input",{type:"number",placeholder:"전체",value:t.empSeq,min:0,onChange:z=>$("empSeq",z.target.value),className:"search-input"})]}),n.jsxs("label",{className:"field",children:[n.jsx("span",{children:"페이지 크기"}),n.jsx("select",{value:l,onChange:z=>j(Number(z.target.value)),className:"search-input",children:Jl.map(z=>n.jsxs("option",{value:z,children:[z,"개"]},z))})]}),n.jsxs("div",{className:"field actions",children:[n.jsx("button",{type:"button",className:"btn",onClick:L,disabled:p,children:"조회하기"}),n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>o(1),disabled:s===1,children:"첫 페이지"}),n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>N&&w(!0),disabled:!N,children:"최근 전문 보기"})]})]}),n.jsxs("div",{className:"summary-cards",children:[n.jsxs("article",{className:"summary-card",children:[n.jsxs("div",{children:[n.jsx("p",{className:"muted",children:"총 데이터"}),n.jsxs("strong",{children:[f.TotalData.toLocaleString(),"건"]})]}),n.jsxs("span",{className:"muted",children:[f.PAGE_NO," / ",Math.max(1,f.TotalPage)," 페이지"]})]}),n.jsxs("article",{className:"summary-card",children:[n.jsxs("div",{children:[n.jsx("p",{className:"muted",children:"금월 판매"}),n.jsxs("strong",{children:[yr(R.sales)," 원"]})]}),n.jsx("span",{className:"muted",children:"합계"})]}),n.jsxs("article",{className:"summary-card",children:[n.jsxs("div",{children:[n.jsx("p",{className:"muted",children:"금월 수금"}),n.jsxs("strong",{children:[yr(R.receipt)," 원"]})]}),n.jsx("span",{className:"muted",children:"합계"})]}),n.jsxs("article",{className:"summary-card highlight",children:[n.jsxs("div",{children:[n.jsx("p",{className:"muted",children:"현미수액"}),n.jsxs("strong",{children:[yr(R.noReceipt)," 원"]})]}),n.jsx("span",{className:"muted",children:"수금과 대비"})]})]}),n.jsxs("div",{className:"table-panel",children:[n.jsxs("div",{className:"table-panel-header",children:[n.jsx("div",{children:n.jsxs("p",{className:"muted",children:["마지막 업데이트: ",b??"—"]})}),n.jsxs("div",{className:"pagination-controls",children:[n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>S("prev"),disabled:s===1,children:"이전"}),n.jsxs("span",{children:[s," page / ",Math.max(1,f.TotalPage)," page"]}),n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>S("next"),disabled:f.TotalPage>0?s>=f.TotalPage:h.length<l,children:"다음"})]})]}),v&&n.jsx("div",{className:"empty-state",children:v}),n.jsx("div",{className:"table-container receivables-table",children:n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"거래처 코드"}),n.jsx("th",{children:"거래처명"}),n.jsx("th",{children:"통화"}),n.jsx("th",{children:"전월이월"}),n.jsx("th",{children:"금월판매"}),n.jsx("th",{children:"부가세"}),n.jsx("th",{children:"금월판매계"}),n.jsx("th",{children:"금월수금"}),n.jsx("th",{children:"현미수액"}),n.jsx("th",{children:"미수 여부"})]})}),n.jsx("tbody",{children:p?n.jsx("tr",{children:n.jsx("td",{colSpan:10,children:n.jsx("div",{className:"empty-state",children:"데이터를 불러오는 중입니다…"})})}):h.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:10,children:n.jsx("div",{className:"empty-state",children:"조회 결과가 없습니다."})})}):h.map(z=>n.jsxs("tr",{children:[n.jsx("td",{children:z.CustSeq}),n.jsx("td",{children:z.CustName}),n.jsx("td",{children:z.CurrName}),n.jsxs("td",{children:[yr(z.PrevCreditAmt)," 원"]}),n.jsxs("td",{children:[yr(z.SalesAmt)," 원"]}),n.jsxs("td",{children:[yr(z.SalesVat)," 원"]}),n.jsxs("td",{children:[yr(z.TotSalesAmt)," 원"]}),n.jsxs("td",{children:[yr(z.ReceiptAmt)," 원"]}),n.jsxs("td",{className:"highlight-cell",children:[yr(z.NoReceiptAmt)," 원"]}),n.jsx("td",{children:z.IsCreditCheck||"N"})]},`${z.CustSeq}-${z.CustNo}`))})]})})]}),E&&N?n.jsx("div",{className:"json-modal-backdrop",role:"dialog","aria-modal":"true",children:n.jsxs("div",{className:"json-modal",children:[n.jsx("div",{className:"json-modal-header",children:n.jsx("strong",{children:"직전 요청 전문"})}),n.jsxs("p",{className:"muted",style:{fontSize:12},children:["요청 URL: ",Zf]}),n.jsx("pre",{children:N}),P?n.jsx("p",{className:"muted",style:{wordBreak:"break-all"},children:P}):null,n.jsx("div",{className:"json-modal-actions",children:n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>w(!1),children:"닫기"})})]})}):null]})}const ew="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3ccircle%20cx='12'%20cy='12'%20r='10'/%3e%3ccircle%20cx='12'%20cy='12'%20r='6'/%3e%3ccircle%20cx='12'%20cy='12'%20r='2'/%3e%3c/svg%3e";function bs({value:e,max:t,color:r,label:a}){const i=Math.max(0,Math.min(100,t>0?e/t*100:0));return n.jsxs("div",{"aria-label":a,style:{position:"relative",width:"100%",height:11,background:"rgba(0,0,0,.04)",borderRadius:999,overflow:"hidden"},children:[n.jsx("div",{style:{width:`${i}%`,height:"100%",background:r,borderRadius:999,transition:"width .2s ease"}}),n.jsx("div",{style:{position:"absolute",right:6,top:0,bottom:0,display:"flex",alignItems:"center",fontSize:10,color:"var(--text)"},children:e})]})}function tw(){const[e,t]=c.useState(!0),[r,a]=c.useState(null),[i,s]=c.useState([]),[o,l]=c.useState(0),[d,h]=c.useState("default"),[u,f]=c.useState([]),[m,p]=c.useState(!0),[x,v]=c.useState(null);c.useEffect(()=>{let j=!1;async function S(){t(!0),a(null);try{const R=await fetch("/api/v1/employees");if(!R.ok)throw new Error(`EMP HTTP ${R.status}`);const O=await R.json();if(j)return;const z=(Array.isArray(O)?O:[]).map((Z,ae)=>({id:String(Z.assignee_id??Z.emp_id??ae),name:String(Z.emp_name??""),prevWeek:{plan:0,actual:0},thisWeek:{plan:0,actual:0},nextWeek:{plan:0,actual:0}}));s(z);try{const[Z,ae]=await Promise.all([js(o),js(o-1)]);if(j)return;const se=th(Z),H=Zl(ae);s(z.map(q=>{const C=se.get(q.id),T=H.get(q.id);return{...q,prevWeek:{plan:(T==null?void 0:T.plan)??0,actual:(T==null?void 0:T.actual)??0},thisWeek:{plan:(C==null?void 0:C.thisPlan)??0,actual:(C==null?void 0:C.thisActual)??0},nextWeek:{plan:(C==null?void 0:C.nextPlan)??0,actual:(C==null?void 0:C.nextActual)??0}}}))}catch{a("주간 활동 요약을 불러오지 못했습니다")}}catch{if(j)return;a("직원 목록을 불러오지 못했습니다");try{const O=await js(o),z=await js(o-1).catch(()=>[]);if(j)return;const Z=Zl(z),ae=(Array.isArray(O)?O:[]).map((se,H)=>{var T,W,I,U;const q=String(se.assignee_id??se.emp_id??H),C=Z.get(q);return{id:q,name:String(se.emp_name??""),prevWeek:{plan:(C==null?void 0:C.plan)??0,actual:(C==null?void 0:C.actual)??0},thisWeek:{plan:Number(((T=se.thisWeek)==null?void 0:T.plan)??0),actual:Number(((W=se.thisWeek)==null?void 0:W.actual)??0)},nextWeek:{plan:Number(((I=se.nextWeek)==null?void 0:I.plan)??0),actual:Number(((U=se.nextWeek)==null?void 0:U.actual)??0)}}});s(ae)}catch{s([{id:"e01",name:"김영업",prevWeek:{plan:0,actual:0},thisWeek:{plan:0,actual:0},nextWeek:{plan:0,actual:0}},{id:"e02",name:"박세일",prevWeek:{plan:0,actual:0},thisWeek:{plan:0,actual:0},nextWeek:{plan:0,actual:0}}])}}finally{j||t(!1)}}return S(),()=>{j=!0}},[o]),c.useEffect(()=>{let j=!1;async function S(){p(!0),v(null);try{const[R,O]=await Promise.all([eh(o),eh(o-1)]);if(j)return;const z=th(R),Z=Zl(O),ae=new Set;for(const H of[...R,...O]){const q=String(H.assignee_id??H.emp_id??"");q&&ae.add(q)}const se=Array.from(ae).map(H=>{const q=z.get(H),C=Z.get(H),T=R.find(I=>String(I.assignee_id??I.emp_id)===H)||O.find(I=>String(I.assignee_id??I.emp_id)===H),W=T?String(T.emp_name??H):H;return{id:H,name:W,prevWeek:{plan:(C==null?void 0:C.plan)??0,actual:(C==null?void 0:C.actual)??0},thisWeek:{plan:(q==null?void 0:q.thisPlan)??0,actual:(q==null?void 0:q.thisActual)??0},nextWeek:{plan:(q==null?void 0:q.nextPlan)??0,actual:(q==null?void 0:q.nextActual)??0}}});se.sort((H,q)=>H.name.localeCompare(q.name)),f(se)}catch{if(j)return;v("지역 활동 계획을 불러오지 못했습니다"),f([])}finally{j||p(!1)}}return S(),()=>{j=!0}},[o]);const g=c.useMemo(()=>{let j=1;for(const S of i)j=Math.max(j,S.prevWeek.plan,S.prevWeek.actual,S.thisWeek.plan,S.thisWeek.actual,S.nextWeek.plan,S.nextWeek.actual);return j},[i]),b=c.useMemo(()=>{let j=1;for(const S of u)j=Math.max(j,S.prevWeek.plan,S.prevWeek.actual,S.thisWeek.plan,S.thisWeek.actual,S.nextWeek.plan,S.nextWeek.actual);return j},[u]),y=c.useMemo(()=>i.map(j=>{const S=j.prevWeek.plan,R=j.prevWeek.actual,O=S+R,z=O>0?R/O*100:0;return{...j,achievementRate:z,prevTotal:O}}),[i]),N=c.useMemo(()=>u.map(j=>{const S=j.prevWeek.plan,R=j.prevWeek.actual,O=S+R,z=O>0?R/O*100:0;return{...j,achievementRate:z,prevTotal:O}}),[u]),A=c.useMemo(()=>{const j=[...y];return d==="rate-high"?j.sort((S,R)=>R.achievementRate-S.achievementRate):d==="rate-low"?j.sort((S,R)=>S.achievementRate-R.achievementRate):j},[y,d]),E=c.useMemo(()=>{const j=[...N];return d==="rate-high"?j.sort((S,R)=>R.achievementRate-S.achievementRate):d==="rate-low"?j.sort((S,R)=>S.achievementRate-R.achievementRate):j},[N,d]),w="#3b82f6",P="#10b981",_=Ae.useCallback((j,S,R,O)=>{const z=Bf(o+S);try{window.dispatchEvent(new CustomEvent(O?"tnt.sales.region-plans.select":"tnt.sales.activities.select",{detail:{assigneeId:j.id,empName:j.name,startIso:z.start.toISOString(),endIso:z.end.toISOString(),label:`${j.name} · ${R} 계획/실적`,isRegion:O||!1}}))}catch{}},[o]),$=c.useMemo(()=>tj(Bf(o)),[o]);function L(j,S){const R=j>=90?"#10b981":j>=70?"#f59e0b":"#ef4444";return{display:S?`${Math.round(j)}%`:"-",color:R}}return n.jsxs("section",{className:"sales-activities-panel",style:{display:"flex",flexDirection:"column",gap:20},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:16,paddingBottom:12,borderBottom:"2px solid var(--border)"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:12},children:[n.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700},children:"활동관리"}),n.jsx("div",{className:"muted",style:{fontSize:13,fontWeight:500},children:"주간 계획·실적"})]}),n.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[n.jsxs("div",{className:"card",style:{display:"inline-flex",alignItems:"center",gap:8,padding:"0 12px",border:"1px solid var(--border)",borderRadius:10,background:"var(--panel)",boxShadow:"0 1px 3px rgba(0,0,0,.05)",height:44},children:[n.jsx("button",{className:"icon-button",title:"전주","aria-label":"전주",onClick:()=>l(j=>j-1),onKeyDown:j=>{(j.key==="Enter"||j.key===" ")&&(j.preventDefault(),l(S=>S-1))},style:{width:30,height:30,borderRadius:6},children:n.jsx("img",{src:tg,className:"icon",alt:"전주"})}),n.jsx("button",{className:"icon-button",title:"이번주로","aria-label":"이번주로",onClick:()=>l(0),onKeyDown:j=>{(j.key==="Enter"||j.key===" ")&&(j.preventDefault(),l(0))},style:{width:30,height:30,borderRadius:6},children:n.jsx("img",{src:ew,className:"icon",alt:"이번주로"})}),n.jsx("button",{className:"icon-button",title:"다음주","aria-label":"다음주",onClick:()=>l(j=>j+1),onKeyDown:j=>{(j.key==="Enter"||j.key===" ")&&(j.preventDefault(),l(S=>S+1))},style:{width:30,height:30,borderRadius:6},children:n.jsx("img",{src:ng,className:"icon",alt:"다음주"})}),n.jsx("span",{className:"muted",style:{fontSize:12,marginLeft:4,whiteSpace:"nowrap",fontWeight:600,minWidth:140,textAlign:"center"},children:$})]}),n.jsxs("div",{className:"card",style:{padding:"0 12px",border:"1px solid var(--border)",borderRadius:10,display:"inline-flex",alignItems:"center",gap:8,background:"var(--panel)",boxShadow:"0 1px 3px rgba(0,0,0,.05)",height:44},children:[n.jsx("label",{htmlFor:"sort-select",style:{fontSize:12,color:"var(--text-muted)",fontWeight:500,display:"flex",alignItems:"center"},children:"정렬"}),n.jsxs("select",{id:"sort-select",value:d,onChange:j=>h(j.target.value),style:{fontSize:12,padding:"4px 8px",border:"1px solid var(--border)",borderRadius:6,background:"var(--panel)",color:"var(--text)",cursor:"pointer",fontWeight:500},children:[n.jsx("option",{value:"default",children:"기본"}),n.jsx("option",{value:"rate-high",children:"달성률 높은순"}),n.jsx("option",{value:"rate-low",children:"달성률 낮은순"})]})]}),n.jsxs("div",{className:"card",style:{padding:"0 14px",border:"1px solid var(--border)",borderRadius:10,display:"inline-flex",alignItems:"center",gap:12,fontSize:11,background:"var(--panel)",boxShadow:"0 1px 3px rgba(0,0,0,.05)",height:44},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[n.jsx("span",{style:{width:10,height:10,background:w,borderRadius:2}}),n.jsx("span",{style:{fontWeight:500},children:"계획"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[n.jsx("span",{style:{width:10,height:10,background:P,borderRadius:2}}),n.jsx("span",{style:{fontWeight:500},children:"실적"})]})]})]})]}),e?n.jsx("div",{className:"muted",style:{padding:12,textAlign:"center",fontSize:13},children:"직원 목록을 불러오는 중…"}):null,r?n.jsx("div",{className:"error",style:{padding:12,borderRadius:8,background:"rgba(239,68,68,.1)",fontSize:13},children:r}):null,n.jsxs("div",{style:{background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,padding:20,boxShadow:"0 2px 8px rgba(0,0,0,.04)"},children:[n.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"var(--text)",marginBottom:16,paddingBottom:12,borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:8},children:[n.jsx("span",{style:{width:4,height:18,background:"#3b82f6",borderRadius:2}}),"영업 활동"]}),A.length===0?n.jsx("div",{className:"empty-state",style:{padding:16},children:"조회된 활동 데이터가 없습니다."}):n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 90px repeat(3, minmax(0, 1fr))",gap:"6px 12px",alignItems:"center"},children:[n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"영업사원"}),n.jsx("div",{className:"muted",style:{fontSize:12,textAlign:"center",fontWeight:700},children:"전주 달성률"}),n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"전주"}),n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"이번주"}),n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"차주"}),A.map(j=>{const S=L(j.achievementRate,j.prevTotal>0),R=[{key:"prev",label:"전주",data:j.prevWeek,offset:-1},{key:"this",label:"이번주",data:j.thisWeek,offset:0},{key:"next",label:"차주",data:j.nextWeek,offset:1}];return n.jsxs(Ae.Fragment,{children:[n.jsx("div",{style:{padding:"3px 0",fontWeight:600,fontSize:12},children:j.name}),n.jsx("div",{style:{padding:"3px 0",textAlign:"center",fontWeight:700,color:S.color},children:S.display}),R.map(O=>n.jsx("div",{role:"button",tabIndex:0,title:`${O.label} 계획/실적 (클릭하여 상세보기)`,style:{cursor:"pointer",padding:"3px 0"},onClick:()=>_(j,O.offset,O.label),onKeyDown:z=>{(z.key==="Enter"||z.key===" ")&&(z.preventDefault(),_(j,O.offset,O.label))},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3,pointerEvents:"none"},children:[n.jsx(bs,{value:O.data.plan,max:g,color:w,label:`${j.name} ${O.label} 계획`}),n.jsx(bs,{value:O.data.actual,max:g,color:P,label:`${j.name} ${O.label} 실적`})]})},`${j.id}-${O.key}`))]},j.id)})]})]}),n.jsxs("div",{style:{background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,padding:20,boxShadow:"0 2px 8px rgba(0,0,0,.04)"},children:[n.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"var(--text)",marginBottom:16,paddingBottom:12,borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:8},children:[n.jsx("span",{style:{width:4,height:18,background:"#10b981",borderRadius:2}}),"지역 활동 계획"]}),m?n.jsx("div",{className:"muted",style:{padding:12,textAlign:"center",fontSize:13},children:"지역 활동 계획을 불러오는 중…"}):x?n.jsx("div",{className:"error",style:{padding:12,borderRadius:8,background:"rgba(239,68,68,.1)",fontSize:13},children:x}):E.length===0?n.jsx("div",{className:"muted",style:{padding:12,textAlign:"center",fontSize:13},children:"지역 활동 계획 데이터가 없습니다."}):n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 90px repeat(3, minmax(0, 1fr))",gap:"6px 12px",alignItems:"center"},children:[n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"영업사원"}),n.jsx("div",{className:"muted",style:{fontSize:12,textAlign:"center",fontWeight:700},children:"전주 달성률"}),n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"전주"}),n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"이번주"}),n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"차주"}),E.map(j=>{const S=L(j.achievementRate,j.prevTotal>0),R=[{key:"prev",label:"전주",data:j.prevWeek,offset:-1},{key:"this",label:"이번주",data:j.thisWeek,offset:0},{key:"next",label:"차주",data:j.nextWeek,offset:1}];return n.jsxs(Ae.Fragment,{children:[n.jsx("div",{style:{padding:"3px 0",fontWeight:600,fontSize:12},children:j.name}),n.jsx("div",{style:{padding:"3px 0",textAlign:"center",fontWeight:700,color:S.color},children:S.display}),R.map(O=>n.jsx("div",{role:"button",tabIndex:0,title:`${O.label} 계획/실적 (클릭하여 상세보기)`,style:{cursor:"pointer",padding:"3px 0"},onClick:()=>_(j,O.offset,O.label,!0),onKeyDown:z=>{(z.key==="Enter"||z.key===" ")&&(z.preventDefault(),_(j,O.offset,O.label,!0))},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3,pointerEvents:"none"},children:[n.jsx(bs,{value:O.data.plan,max:b,color:w,label:`${j.name} ${O.label} 계획`}),n.jsx(bs,{value:O.data.actual,max:b,color:P,label:`${j.name} ${O.label} 실적`})]})},`${j.id}-${O.key}`))]},j.id)})]})]})]})}async function js(e){const t=await fetch(`/api/v1/sales-activities/summary/weekly?offsetWeeks=${encodeURIComponent(e)}&depts=all`);if(!t.ok)throw new Error(`SUM HTTP ${t.status}`);const r=await t.json();return Array.isArray(r)?r:[]}async function eh(e){const t=await fetch(`/api/v1/region-activity-plans/summary/weekly?offsetWeeks=${encodeURIComponent(e)}&depts=all`);if(!t.ok)throw new Error(`REGION HTTP ${t.status}`);const r=await t.json();return Array.isArray(r)?r:[]}function th(e){const t=new Map;for(const r of e){const a=String(r.assignee_id??r.emp_id??"");if(!a)continue;const i=r.thisWeek||{},s=r.nextWeek||{};t.set(a,{thisPlan:Number(i.plan??0),thisActual:Number(i.actual??0),nextPlan:Number(s.plan??0),nextActual:Number(s.actual??0)})}return t}function Zl(e){const t=new Map;for(const r of e){const a=String(r.assignee_id??r.emp_id??"");if(!a)continue;const i=r.thisWeek||{};t.set(a,{plan:Number(i.plan??0),actual:Number(i.actual??0)})}return t}const nw=({isOpen:e,onClose:t,onSelect:r})=>{const[a,i]=c.useState(""),[s,o]=c.useState(""),[l,d]=c.useState([]),[h,u]=c.useState(!1),[f,m]=c.useState([]);if(Ae.useEffect(()=>{e&&(i(""),o(""),d([]),fetch("/api/v1/inventory/subcategories-ag").then(x=>x.ok?x.json():[]).then(x=>m(x)).catch(x=>console.error("Failed to fetch subcategories",x)))},[e]),!e)return null;const p=async()=>{u(!0);try{const x=new URLSearchParams;a&&x.append("keyword",a),s&&x.append("subcategory",s);const v=await fetch(`/api/v1/inventory/items-popup?${x.toString()}`);if(v.ok){const g=await v.json();d(g)}}catch(x){console.error("Failed to search items",x)}finally{u(!1)}};return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:50,display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsxs("div",{style:{background:"#fff",borderRadius:8,boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",width:700,maxHeight:"80vh",display:"flex",flexDirection:"column",overflow:"hidden"},children:[n.jsxs("div",{style:{padding:"16px 24px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("h2",{style:{fontSize:18,fontWeight:600,color:"#111827",margin:0},children:"품목 검색"}),n.jsx("button",{onClick:t,style:{background:"none",border:"none",cursor:"pointer",color:"#6b7280",padding:4},children:n.jsx(Sd,{size:20})})]}),n.jsxs("div",{style:{padding:16,borderBottom:"1px solid #e5e7eb",background:"#f9fafb",display:"flex",gap:8},children:[n.jsxs("select",{style:{border:"1px solid #d1d5db",borderRadius:6,padding:"8px 12px",fontSize:14,flex:1,outline:"none",background:"#fff"},value:s,onChange:x=>o(x.target.value),children:[n.jsx("option",{value:"",children:"전체 중분류"}),f.map(x=>n.jsx("option",{value:x,children:x},x))]}),n.jsx("input",{style:{border:"1px solid #d1d5db",borderRadius:6,padding:"8px 12px",fontSize:14,flex:1,outline:"none"},placeholder:"품목명/품목코드",value:a,onChange:x=>i(x.target.value),onKeyDown:x=>x.key==="Enter"&&p()}),n.jsxs("button",{onClick:p,style:{background:"#2563eb",color:"#fff",padding:"8px 16px",borderRadius:6,fontSize:14,fontWeight:500,border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:6},children:[n.jsx(va,{size:16}),"검색"]})]}),n.jsx("div",{style:{flex:1,overflow:"auto"},children:n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{style:{background:"#f9fafb",position:"sticky",top:0,zIndex:10},children:n.jsxs("tr",{children:[n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",fontWeight:600,borderBottom:"1px solid #e5e7eb"},children:"중분류"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",fontWeight:600,borderBottom:"1px solid #e5e7eb"},children:"품목코드"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",fontWeight:600,borderBottom:"1px solid #e5e7eb"},children:"품목명"})]})}),n.jsx("tbody",{children:h?n.jsx("tr",{children:n.jsx("td",{colSpan:3,style:{padding:"32px",textAlign:"center",color:"#6b7280",fontSize:14},children:"검색 중..."})}):l.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:3,style:{padding:"32px",textAlign:"center",color:"#6b7280",fontSize:14},children:"검색 결과가 없습니다."})}):l.map((x,v)=>n.jsxs("tr",{onClick:()=>{r(x.itemName),t()},style:{cursor:"pointer",borderBottom:"1px solid #f3f4f6"},onMouseEnter:g=>g.currentTarget.style.background="#f9fafb",onMouseLeave:g=>g.currentTarget.style.background="transparent",children:[n.jsx("td",{style:{padding:"12px 16px",fontSize:14,color:"#6b7280"},children:x.itemSubcategory}),n.jsx("td",{style:{padding:"12px 16px",fontSize:14,color:"#6b7280"},children:x.itemNo}),n.jsx("td",{style:{padding:"12px 16px",fontSize:14,color:"#111827",fontWeight:500},children:x.itemName})]},v))})]})})]})})};function rw(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState("all"),[d,h]=c.useState("item"),[u,f]=c.useState(""),[m,p]=c.useState(""),[x,v]=c.useState(""),[g,b]=c.useState("ALL"),[y,N]=c.useState(""),[A,E]=c.useState(0),[w,P]=c.useState([]),[_,$]=c.useState(!1),L=async()=>{a(!0),s(null);try{const Y=new URLSearchParams;u&&Y.append("whName",u),m&&Y.append("itemName",m),x&&Y.append("category",x),y&&Y.append("remainDayMax",y),A>0&&Y.append("daysOffset",A.toString()),g!=="ALL"&&Y.append("bizUnit",g);const M=await fetch(`/api/v1/inventory/expiry-stock-ag?${Y.toString()}`);if(!M.ok)throw new Error(`API 호출 실패: ${M.status}`);const D=await M.json();Array.isArray(D)?t(D):D.error?(s(D.error),t([])):t([])}catch(Y){console.error("유통기한재고(AG) 조회 실패:",Y),s(Y.message||"데이터 조회 중 오류가 발생했습니다.")}finally{a(!1)}},j=async()=>{try{console.log("Fetching warehouse options...");const Y=await fetch("/api/v1/inventory/warehouses-ag");if(console.log("Warehouse response status:",Y.status),Y.ok){const M=await Y.json();console.log("Warehouse data:",M),P(M)}else console.error("Warehouse fetch failed:",Y.statusText)}catch(Y){console.error("Failed to fetch warehouse options",Y)}};c.useEffect(()=>{j()},[]),c.useEffect(()=>{L()},[]);const[S,R]=c.useState(new Set),[O,z]=c.useState(new Set),Z=Y=>{const M=new Set(S);M.has(Y)?M.delete(Y):M.add(Y),R(M)},ae=Y=>{const M=new Set(O);M.has(Y)?M.delete(Y):M.add(Y),z(M)},[se,H]=c.useState(new Set);c.useEffect(()=>{try{window.dispatchEvent(new CustomEvent("tnt.inventory.expiry.selection",{detail:{count:se.size,items:Array.from(se)}}))}catch{}},[se]),c.useEffect(()=>{const Y=M=>{var F;const D=(F=M.detail)==null?void 0:F.promotionId;if(!D)return;const oe=Array.from(se);if(oe.length===0){alert("적용할 품목을 선택하세요.");return}alert(`프로모션 ${D}을(를) ${oe.length}개 품목에 적용합니다.`)};return window.addEventListener("tnt.inventory.apply-promotion",Y),()=>window.removeEventListener("tnt.inventory.apply-promotion",Y)},[se]);const q=c.useMemo(()=>e.map(Y=>{const M=Y.remainDay||0;let D="good",oe="Normal",F=100;return M<=0?(D="expired",oe="즉시 폐기",F=0):M<=60?(D="critical",oe="긴급 처분 (Clearance)",F=20):M<=120?(D="warning",oe="집중 모니터링",F=50):oe="정상 판매",{...Y,_status:D,_action:oe,_score:F}}),[e]),C=c.useMemo(()=>q.filter(Y=>o==="disposal"?Y._status==="expired":o==="clearance"?Y._status==="critical":o==="watch"?Y._status==="warning":!0),[q,o]),T=c.useMemo(()=>{const Y={};return C.forEach(M=>{const D=M.itemName||"Unknown";Y[D]||(Y[D]=[]),Y[D].push(M)}),Object.keys(Y).forEach(M=>{Y[M].sort((D,oe)=>{const F=D.expDate||"",G=oe.expDate||"";return F.localeCompare(G)})}),Y},[C]),W=c.useMemo(()=>{const Y={};return q.forEach(M=>{const D=M.itemSubcategory||"미분류";Y[D]||(Y[D]={name:D,totalQty:0,expiredQty:0,criticalQty:0,warningQty:0,itemCount:0,totalScore:0,items:[]}),Y[D].totalQty+=M.stockQty||0,Y[D].itemCount+=1,Y[D].totalScore+=M._score,Y[D].items.push(M),M._status==="expired"&&(Y[D].expiredQty+=M.stockQty||0),M._status==="critical"&&(Y[D].criticalQty+=M.stockQty||0),M._status==="warning"&&(Y[D].warningQty+=M.stockQty||0)}),Object.values(Y).map(M=>({...M,avgScore:M.itemCount>0?Math.round(M.totalScore/M.itemCount):0,riskRatio:M.totalQty>0?Math.round((M.expiredQty+M.criticalQty)/M.totalQty*100):0,items:M.items.sort((D,oe)=>(D.itemName||"").localeCompare(oe.itemName||""))})).sort((M,D)=>D.riskRatio-M.riskRatio)},[q]),I=c.useMemo(()=>{const Y=q.reduce((F,G)=>F+(G.stockQty||0),0),M=q.filter(F=>F._status==="expired").reduce((F,G)=>F+(G.stockQty||0),0),D=q.filter(F=>F._status==="critical").reduce((F,G)=>F+(G.stockQty||0),0),oe=q.filter(F=>F._status==="warning").reduce((F,G)=>F+(G.stockQty||0),0);return{totalQty:Y,expiredQty:M,criticalQty:D,warningQty:oe}},[q]),U=Y=>Y?Number(Y).toLocaleString("ko-KR"):"-",K=Y=>{if(!Y)return"-";const M=String(Y);return M.length===8?`${M.substring(0,4)}-${M.substring(4,6)}-${M.substring(6,8)}`:M};return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[n.jsxs("div",{style:{marginBottom:24,display:"flex",alignItems:"baseline",gap:12},children:[n.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"재고 건전성 분석"}),n.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"유통기한 기반 재고 리스크 분석 및 처분 제안"})]}),n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",marginBottom:20},children:[n.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex",marginRight:12},children:["ALL","TNT","DYS"].map(Y=>n.jsx("button",{onClick:()=>b(Y),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:g===Y?"#fff":"transparent",color:g===Y?"#2563eb":"#6b7280",boxShadow:g===Y?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:Y},Y))}),n.jsxs("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex",marginRight:12},children:[n.jsxs("button",{onClick:()=>h("item"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:d==="item"?"#fff":"transparent",color:d==="item"?"#111827":"#6b7280",boxShadow:d==="item"?"0 1px 2px rgba(0,0,0,0.1)":"none",display:"flex",alignItems:"center",gap:6,whiteSpace:"nowrap"},children:[n.jsx(Aj,{size:16}),"품목별 보기"]}),n.jsxs("button",{onClick:()=>h("category"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:d==="category"?"#fff":"transparent",color:d==="category"?"#111827":"#6b7280",boxShadow:d==="category"?"0 1px 2px rgba(0,0,0,0.1)":"none",display:"flex",alignItems:"center",gap:6,whiteSpace:"nowrap"},children:[n.jsx(rg,{size:16}),"중분류 분석"]})]}),n.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[n.jsx("input",{className:"search-input",placeholder:"품목명 검색 (클릭)",value:m,readOnly:!0,onClick:()=>$(!0),style:{width:180,paddingLeft:12,paddingRight:32,cursor:"pointer"}}),n.jsx(va,{size:14,style:{position:"absolute",right:10,color:"#9ca3af",pointerEvents:"none"}})]}),n.jsx("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:n.jsxs("select",{className:"search-input",value:u,onChange:Y=>f(Y.target.value),style:{width:150},children:[n.jsx("option",{value:"",children:"전체 창고"}),w.map(Y=>n.jsx("option",{value:Y,children:Y},Y))]})}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,paddingLeft:12,borderLeft:"1px solid #e5e7eb"},children:[n.jsxs("select",{className:"search-input",value:A,onChange:Y=>E(Number(Y.target.value)),style:{width:130,color:A>0?"#ef4444":"inherit",fontWeight:A>0?600:400},children:[n.jsx("option",{value:0,children:"현재 기준"}),n.jsx("option",{value:7,children:"1주 후 예측"}),n.jsx("option",{value:14,children:"2주 후 예측"}),n.jsx("option",{value:21,children:"3주 후 예측"}),n.jsx("option",{value:28,children:"4주 후 예측"}),n.jsx("option",{value:60,children:"2개월 후 예측"}),n.jsx("option",{value:90,children:"3개월 후 예측"}),n.jsx("option",{value:180,children:"6개월 후 예측"})]}),n.jsx("input",{className:"search-input",type:"number",placeholder:"잔여일수(이하)",value:y,onChange:Y=>N(Y.target.value),style:{width:110}})]}),n.jsxs("div",{style:{display:"flex",gap:8,marginLeft:"auto"},children:[n.jsx("button",{className:"btn",onClick:L,disabled:r,style:{height:30,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",whiteSpace:"nowrap"},children:r?"분석 중...":"분석 실행"}),n.jsx("button",{className:"btn secondary",onClick:()=>{p(""),f(""),N(""),E(0),b("ALL"),L()},style:{height:30,padding:"0 12px",fontSize:13,whiteSpace:"nowrap"},children:"초기화"})]})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[n.jsx(ws,{title:"전체 재고",value:U(I.totalQty),icon:n.jsx(Zp,{size:24}),color:"#3b82f6"}),n.jsx(ws,{title:"폐기 대상 (만료)",value:U(I.expiredQty),subtext:"즉시 조치 필요",icon:n.jsx(zo,{size:24}),color:"#ef4444",active:o==="disposal"&&d==="item",onClick:()=>{l("disposal"),h("item")}}),n.jsx(ws,{title:"긴급 처분 (<60일)",value:U(I.criticalQty),subtext:"프로모션 권장",icon:n.jsx(Nj,{size:24}),color:"#f97316",active:o==="clearance"&&d==="item",onClick:()=>{l("clearance"),h("item")}}),n.jsx(ws,{title:"관심 품목 (<120일)",value:U(I.warningQty),subtext:"모니터링 필요",icon:n.jsx(wj,{size:24}),color:"#eab308",active:o==="watch"&&d==="item",onClick:()=>{l("watch"),h("item")}})]})]}),d==="item"&&n.jsx("div",{style:{padding:"0 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:n.jsxs("div",{style:{display:"flex",gap:24},children:[n.jsx(Ss,{label:"전체 목록",active:o==="all",onClick:()=>l("all")}),n.jsx(Ss,{label:"폐기 대상",count:I.expiredQty,active:o==="disposal",onClick:()=>l("disposal"),color:"#ef4444"}),n.jsx(Ss,{label:"긴급 처분",count:I.criticalQty,active:o==="clearance",onClick:()=>l("clearance"),color:"#f97316"}),n.jsx(Ss,{label:"관심 품목",count:I.warningQty,active:o==="watch",onClick:()=>l("watch"),color:"#eab308"})]})}),n.jsx("div",{style:{flex:1,padding:24,overflow:"hidden",display:"flex",gap:24},children:n.jsx("div",{className:"card",style:{flex:1,height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:i?n.jsx("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:i}):e.length===0&&!r?n.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"데이터가 없습니다."}):n.jsx("div",{style:{overflow:"auto",flex:1},children:d==="item"?n.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:n.jsxs("tr",{children:[n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"품목명 / 코드"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"중분류"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"전체 재고"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"LOT 수"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"최단 유통기한"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"위험 상태"}),n.jsx("th",{style:{width:40}})]})}),n.jsx("tbody",{children:Object.entries(T).map(([Y,M])=>{const D=M.reduce((de,be)=>de+(be.stockQty||0),0),oe=M.some(de=>de._status==="expired")?"expired":M.some(de=>de._status==="critical")?"critical":M.some(de=>de._status==="warning")?"warning":"safe",F=M[0],G=O.has(Y);return n.jsxs(Ae.Fragment,{children:[n.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb",background:G?"#f9fafb":"#fff",cursor:"pointer"},onClick:()=>ae(Y),children:[n.jsxs("td",{style:{padding:"12px 16px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[F.srcBizunit==="TNT"&&n.jsx("span",{style:{background:"#e0f2fe",color:"#0369a1",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"T"}),F.srcBizunit==="DYS"&&n.jsx("span",{style:{background:"#fce7f3",color:"#be185d",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"D"}),n.jsx("div",{style:{fontWeight:600,color:"#111827"},children:Y})]}),n.jsxs("div",{style:{fontSize:11,color:"#9ca3af",marginTop:2},children:[F.itemNo," | ",F.spec]})]}),n.jsx("td",{style:{padding:"12px 16px",color:"#4b5563",fontSize:12},children:F.itemSubcategory}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600},children:U(D)}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:"#6b7280"},children:M.length}),n.jsx("td",{style:{padding:"12px 16px",color:"#4b5563"},children:K(F.expDate)}),n.jsx("td",{style:{padding:"12px 16px"},children:n.jsx(nh,{status:oe})}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"center"},children:G?n.jsx(qf,{size:16}):n.jsx(Ti,{size:16})})]}),G&&n.jsx("tr",{children:n.jsx("td",{colSpan:7,style:{padding:0,background:"#f9fafb"},children:n.jsx("div",{style:{padding:"12px 24px",borderBottom:"1px solid #e5e7eb"},children:n.jsxs("table",{style:{width:"100%",fontSize:13},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"LOT No."}),n.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"창고명"}),n.jsx("th",{style:{textAlign:"right",padding:"8px 12px",color:"#6b7280"},children:"재고"}),n.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"유통기한"}),n.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"잔여일수"}),n.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"상태"}),n.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"건전성"})]})}),n.jsx("tbody",{children:M.map((de,be)=>n.jsxs("tr",{style:{borderTop:"1px solid #e5e7eb"},children:[n.jsx("td",{style:{padding:"8px 12px",color:"#6b7280",fontFamily:"monospace"},children:de.lotNo||"-"}),n.jsx("td",{style:{padding:"8px 12px",color:"#6b7280"},children:de.whName||"-"}),n.jsx("td",{style:{padding:"8px 12px",textAlign:"right",fontWeight:600},children:U(de.stockQty)}),n.jsx("td",{style:{padding:"8px 12px",color:"#4b5563"},children:K(de.expDate)}),n.jsx("td",{style:{padding:"8px 12px"},children:n.jsxs("span",{style:{fontWeight:600,color:de.remainDay&&de.remainDay<=60?"#ef4444":"#111827"},children:[de.remainDay,"일"]})}),n.jsx("td",{style:{padding:"8px 12px"},children:n.jsx(nh,{status:de._status})}),n.jsx("td",{style:{padding:"8px 12px"},children:n.jsx(rh,{score:de._score})})]},be))})]})})})})]},Y)})})]}):n.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:n.jsxs("tr",{children:[n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"순위"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"중분류명"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"전체 재고"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"폐기 대상"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"긴급 처분"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"관심 품목"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"리스크 비율"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"평균 건전성"}),n.jsx("th",{style:{width:40}})]})}),n.jsx("tbody",{children:W.map((Y,M)=>n.jsxs(Ae.Fragment,{children:[n.jsxs("tr",{onClick:()=>Z(Y.name),style:{borderBottom:"1px solid #f3f4f6",cursor:"pointer",background:S.has(Y.name)?"#f9fafb":"#fff"},children:[n.jsx("td",{style:{padding:"12px 16px",color:"#9ca3af",fontWeight:500},children:M+1}),n.jsx("td",{style:{padding:"12px 16px",fontWeight:600,color:"#111827"},children:Y.name}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600},children:U(Y.totalQty)}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:Y.expiredQty>0?"#ef4444":"#d1d5db",fontWeight:Y.expiredQty>0?700:400},children:U(Y.expiredQty)}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:Y.criticalQty>0?"#f97316":"#d1d5db",fontWeight:Y.criticalQty>0?700:400},children:U(Y.criticalQty)}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:Y.warningQty>0?"#eab308":"#d1d5db",fontWeight:Y.warningQty>0?700:400},children:U(Y.warningQty)}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right"},children:n.jsxs("span",{style:{color:Y.riskRatio>50?"#ef4444":Y.riskRatio>20?"#f97316":"#10b981",fontWeight:700},children:[Y.riskRatio,"%"]})}),n.jsx("td",{style:{padding:"12px 16px"},children:n.jsx(rh,{score:Y.avgScore})}),n.jsx("td",{style:{padding:"12px 16px",color:"#9ca3af"},children:S.has(Y.name)?n.jsx(qf,{size:16}):n.jsx(Ti,{size:16})})]}),S.has(Y.name)&&n.jsx("tr",{children:n.jsx("td",{colSpan:9,style:{padding:0,background:"#f9fafb"},children:n.jsx("div",{style:{padding:"12px 24px",borderBottom:"1px solid #e5e7eb"},children:n.jsxs("table",{style:{width:"100%",fontSize:13},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"품목명"}),n.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"LOT No."}),n.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"창고명"}),n.jsx("th",{style:{textAlign:"right",padding:"8px 12px",color:"#6b7280"},children:"재고"}),n.jsx("th",{style:{textAlign:"center",padding:"8px 12px",color:"#6b7280"},children:"폐기대상"}),n.jsx("th",{style:{textAlign:"center",padding:"8px 12px",color:"#6b7280"},children:"긴급처분"}),n.jsx("th",{style:{textAlign:"center",padding:"8px 12px",color:"#6b7280"},children:"관심품목"}),n.jsx("th",{style:{textAlign:"center",padding:"8px 12px",color:"#6b7280"},children:"정상재고"})]})}),n.jsx("tbody",{children:Y.items.map((D,oe)=>n.jsxs("tr",{style:{borderTop:"1px solid #e5e7eb"},children:[n.jsx("td",{style:{padding:"8px 12px",color:"#111827",fontWeight:500},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[D.srcBizunit==="TNT"&&n.jsx("span",{style:{background:"#e0f2fe",color:"#0369a1",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"T"}),D.srcBizunit==="DYS"&&n.jsx("span",{style:{background:"#fce7f3",color:"#be185d",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"D"}),D.itemName]})}),n.jsx("td",{style:{padding:"8px 12px",color:"#6b7280",fontFamily:"monospace"},children:D.lotNo||"-"}),n.jsx("td",{style:{padding:"8px 12px",color:"#6b7280"},children:D.whName||"-"}),n.jsx("td",{style:{padding:"8px 12px",textAlign:"right",fontWeight:600},children:U(D.stockQty)}),n.jsx("td",{style:{padding:"8px 12px",textAlign:"center"},children:D._status==="expired"?n.jsx("span",{style:{color:"#dc2626",fontWeight:600},children:"●"}):n.jsx("span",{style:{color:"#d1d5db"},children:"○"})}),n.jsx("td",{style:{padding:"8px 12px",textAlign:"center"},children:D._status==="critical"?n.jsx("span",{style:{color:"#ea580c",fontWeight:600},children:"●"}):n.jsx("span",{style:{color:"#d1d5db"},children:"○"})}),n.jsx("td",{style:{padding:"8px 12px",textAlign:"center"},children:D._status==="warning"?n.jsx("span",{style:{color:"#eab308",fontWeight:600},children:"●"}):n.jsx("span",{style:{color:"#d1d5db"},children:"○"})}),n.jsx("td",{style:{padding:"8px 12px",textAlign:"center"},children:D._status==="safe"||D._status==="normal"||!D._status||D._status!=="expired"&&D._status!=="critical"&&D._status!=="warning"?n.jsx("span",{style:{color:"#10b981",fontWeight:600},children:"●"}):n.jsx("span",{style:{color:"#d1d5db"},children:"○"})})]},oe))})]})})})})]},Y.name))})]})})})}),n.jsx(nw,{isOpen:_,onClose:()=>$(!1),onSelect:Y=>{p(Y)}})]})}function ws({title:e,value:t,subtext:r,icon:a,color:i,active:s,onClick:o}){return n.jsxs("div",{onClick:o,style:{background:s?`${i}10`:"#fff",border:`1px solid ${s?i:"#e5e7eb"}`,borderRadius:12,padding:20,cursor:o?"pointer":"default",transition:"all 0.2s",boxShadow:s?`0 4px 12px ${i}20`:"none"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:8},children:[n.jsx("span",{style:{fontSize:14,color:"#6b7280",fontWeight:500},children:e}),n.jsx("span",{style:{color:i},children:a})]}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:t}),r&&n.jsx("div",{style:{fontSize:12,color:i,marginTop:4,fontWeight:500},children:r})]})}function Ss({label:e,count:t,active:r,onClick:a,color:i="#3b82f6"}){return n.jsxs("button",{onClick:a,style:{padding:"16px 0",background:"none",border:"none",borderBottom:`2px solid ${r?i:"transparent"}`,color:r?i:"#6b7280",fontWeight:r?600:500,cursor:"pointer",fontSize:14,display:"flex",alignItems:"center",gap:6},children:[e,t!==void 0&&n.jsx("span",{style:{background:r?i:"#f3f4f6",color:r?"#fff":"#6b7280",padding:"2px 8px",borderRadius:99,fontSize:11,fontWeight:600},children:t>999?"999+":t})]})}function nh({status:e}){const t={expired:{bg:"#fef2f2",text:"#ef4444",label:"만료"},critical:{bg:"#fff7ed",text:"#f97316",label:"위험"},warning:{bg:"#fefce8",text:"#eab308",label:"주의"},good:{bg:"#ecfdf5",text:"#10b981",label:"정상"}},r=t[e]||t.good;return n.jsx("span",{style:{background:r.bg,color:r.text,padding:"4px 8px",borderRadius:6,fontSize:11,fontWeight:600,border:`1px solid ${r.text}20`},children:r.label})}function rh({score:e}){let t="#10b981";return e<=20?t="#ef4444":e<=50&&(t="#eab308"),n.jsx("div",{style:{width:80,height:6,background:"#e5e7eb",borderRadius:3,overflow:"hidden"},children:n.jsx("div",{style:{width:`${e}%`,height:"100%",background:t,borderRadius:3}})})}function aw(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState(null),[d,h]=c.useState(!1),[u,f]=c.useState([]);c.useEffect(()=>{let x=!0;return a(!0),s(null),fetch("/api/v1/items/unit-usage").then(async v=>{if(!v.ok)throw new Error(`HTTP ${v.status}`);return v.json()}).then(v=>{if(!x)return;const g=Array.isArray(v)?v.map(b=>({salesMgmtUnitSeq:Number(b.salesMgmtUnitSeq??0),salesMgmtUnit:String(b.salesMgmtUnit??"미지정"),itemStdUnit:String(b.itemStdUnit??"미지정"),itemUnit:String(b.itemUnit??"미지정"),itemCount:Number(b.itemCount??0)})):[];t(g)}).catch(v=>{x&&s(v.message||"조회 중 오류가 발생했습니다")}).finally(()=>{x&&a(!1)}),()=>{x=!1}},[]);const m=c.useMemo(()=>{const x={};for(const v of e){const g=v.salesMgmtUnit;x[g]||(x[g]=[]),x[g].push(v)}return Object.values(x).forEach(v=>v.sort((g,b)=>b.itemCount-g.itemCount)),Object.entries(x).sort((v,g)=>{const b=v[0],y=g[0],N=b==="미지정",A=y==="미지정";return N&&!A?1:!N&&A?-1:b.localeCompare(y)})},[e]);async function p(x,v,g){h(!0),s(null);try{const b=new URLSearchParams;b.set("salesMgmtUnit",x),v&&b.set("itemUnit",v),g&&b.set("itemStdUnit",g);const y=await fetch(`/api/v1/items/unit-usage/items?${b.toString()}`);if(!y.ok)throw new Error(`HTTP ${y.status}`);const N=await y.json(),A=Array.isArray(N)?N.map(E=>({itemSeq:E.itemSeq??null,itemName:String(E.itemName??""),itemStdUnit:String(E.itemStdUnit??"미지정"),itemUnit:String(E.itemUnit??"미지정"),salesMgmtUnitSeq:E.salesMgmtUnitSeq??null})):[];f(A)}catch(b){s((b==null?void 0:b.message)||"상세 조회 중 오류가 발생했습니다")}finally{h(!1)}}return n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[n.jsxs("div",{children:[n.jsx("h2",{style:{margin:0},children:"품목단위분석"}),n.jsx("p",{style:{margin:"4px 0 0",color:"var(--muted)"},children:"item 테이블 기준으로 영업관리단위별 사용 단위(표준단위/판매단위) 분포를 확인합니다."})]}),r?n.jsx("span",{style:{color:"var(--muted)"},children:"불러오는 중…"}):null,i?n.jsx("span",{style:{color:"crimson"},children:i}):null]}),m.length===0&&!r?n.jsx("div",{className:"empty-state",children:"데이터가 없습니다."}):n.jsx("div",{className:"card",style:{padding:12,height:"calc(100vh - 200px)",display:"flex",flexDirection:"column"},children:n.jsx("div",{style:{flex:1,minHeight:0,overflow:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"right",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"No."}),n.jsx("th",{style:{textAlign:"left",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"영업관리단위"}),n.jsx("th",{style:{textAlign:"left",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"판매단위(item_unit)"}),n.jsx("th",{style:{textAlign:"left",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"표준단위(item_std_unit)"}),n.jsx("th",{style:{textAlign:"right",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"품목수"})]})}),n.jsx("tbody",{children:m.map(([x,v],g)=>n.jsxs(Ae.Fragment,{children:[v.map((b,y)=>{const N=`${x}|${b.itemUnit}|${b.itemStdUnit}`,A=`${x}`,E=o===N,w=o===A;return n.jsxs("tr",{style:{borderTop:"1px solid var(--border)"},children:[y===0?n.jsxs(n.Fragment,{children:[n.jsx("td",{rowSpan:v.length,style:{padding:"6px 8px",textAlign:"right",color:"var(--muted)",fontVariantNumeric:"tabular-nums"},children:g+1}),n.jsxs("td",{rowSpan:v.length,style:{padding:"6px 8px",fontWeight:600,cursor:"pointer",textDecoration:w?"underline":"none"},onClick:()=>{const P=w?null:A;l(P),P&&p(x)},children:[x,n.jsx("span",{style:{marginLeft:8,fontSize:12,color:"var(--muted)"},children:w?"닫기":"전체 품목"})]})]}):null,n.jsxs("td",{style:{padding:"6px 8px",cursor:"pointer",textDecoration:E?"underline":"none"},onClick:()=>{const P=E?null:N;l(P),P&&p(x,b.itemUnit,b.itemStdUnit)},children:[b.itemUnit,n.jsx("span",{style:{marginLeft:8,fontSize:12,color:"var(--muted)"},children:E?"닫기":"품목 보기"})]}),n.jsxs("td",{style:{padding:"6px 8px",cursor:"pointer",textDecoration:E?"underline":"none"},onClick:()=>{const P=E?null:N;l(P),P&&p(x,b.itemUnit,b.itemStdUnit)},children:[b.itemStdUnit,n.jsx("span",{style:{marginLeft:8,fontSize:12,color:"var(--muted)"},children:E?"닫기":"품목 보기"})]}),n.jsx("td",{style:{padding:"6px 8px",textAlign:"right"},children:b.itemCount.toLocaleString()})]},x+y)}),o===x||v.some(b=>o===`${x}|${b.itemUnit}|${b.itemStdUnit}`)?n.jsx("tr",{style:{background:"var(--muted-bg, #fafafa)"},children:n.jsx("td",{colSpan:5,style:{padding:"8px 8px 12px"},children:d?n.jsx("div",{style:{color:"var(--muted)"},children:"품목 불러오는 중…"}):u.length===0?n.jsx("div",{style:{color:"var(--muted)"},children:"해당 영업관리단위에 품목이 없습니다."}):n.jsx("div",{style:{maxHeight:"50vh",minHeight:200,overflow:"auto",border:"1px solid var(--border)",borderRadius:6},children:n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{position:"sticky",top:0,background:"var(--bg)"},children:[n.jsx("th",{style:{textAlign:"left",padding:"6px 8px"},children:"품목명"}),n.jsx("th",{style:{textAlign:"left",padding:"6px 8px"},children:"판매단위"}),n.jsx("th",{style:{textAlign:"left",padding:"6px 8px"},children:"표준단위"}),n.jsx("th",{style:{textAlign:"right",padding:"6px 8px"},children:"품목SEQ"})]})}),n.jsx("tbody",{children:u.map((b,y)=>n.jsxs("tr",{style:{borderTop:"1px solid var(--border)"},children:[n.jsx("td",{style:{padding:"6px 8px"},children:b.itemName||"(이름 없음)"}),n.jsx("td",{style:{padding:"6px 8px"},children:b.itemUnit||"미지정"}),n.jsx("td",{style:{padding:"6px 8px"},children:b.itemStdUnit||"미지정"}),n.jsx("td",{style:{padding:"6px 8px",textAlign:"right",color:"var(--muted)"},children:b.itemSeq??""})]},(b.itemSeq??"na")+"-"+y))})]})})})}):null]},x))})]})})})]})}const iw=["TNT","DYS"];function sw(){const[e,t]=c.useState("TNT"),[r,a]=c.useState("2022"),[i,s]=c.useState([]),[o,l]=c.useState("all"),[d,h]=c.useState([]),[u,f]=c.useState([]),[m,p]=c.useState(!1),[x,v]=c.useState(null);c.useEffect(()=>{g()},[e,r]);const g=async()=>{const $=Number(r)||2022;try{const L=new URLSearchParams;L.append("companyType",e),L.append("fromYear",String($));const j=await fetch(`/api/v1/analysis/price-sim/employees?${L.toString()}`);if(!j.ok)throw new Error(`HTTP ${j.status}`);const S=await j.json();s(S),l(S.length?"all":"")}catch(L){s([]),l(""),v((L==null?void 0:L.message)||"영업사원 목록 조회 실패")}},b=async()=>{p(!0),v(null);const $=Number(r)||2022;try{const L=new URLSearchParams;e!=="ALL"&&L.append("companyType",e),L.append("fromYear",String($)),o&&o!=="all"&&L.append("empName",o);const j=await fetch(`/api/v1/analysis/price-sim?${L.toString()}`);if(!j.ok)throw new Error(`HTTP ${j.status}`);const S=await j.json();if(S.error)throw new Error(S.error);const R=Array.isArray(S.data)?S.data.map(z=>({salesYear:Number(z.salesYear??z.salesyear??0),salesUnit:String(z.salesUnit??z.salesunit??"미지정"),empName:String(z.empName??z.empname??"미지정"),salesCount:z.salesCount??z.salescount,totalQty:z.totalQty??z.totalqty,totalAmt:z.totalAmt??z.totalamt,avgPrice:(()=>{const Z=Number(z.totalQty??z.totalqty??0),ae=z.avgPrice??z.avgprice??null;if(!Number.isFinite(Z)||Z<=0)return null;const se=Number(ae);return Number.isFinite(se)?se:null})()})):[];h(R);const O=Array.isArray(S.companyAvg)?S.companyAvg.map(z=>({salesUnit:String(z.salesUnit??z.salesunit??"미지정"),avgPrice:z.avgPrice??z.avgprice??null})):[];f(O)}catch(L){h([]),f([]),v((L==null?void 0:L.message)||"조회 실패")}finally{p(!1)}},y=c.useMemo(()=>{const $=[...d];return $.sort((L,j)=>{if(j.salesYear!==L.salesYear)return j.salesYear-L.salesYear;const S=L.salesUnit||"미지정",R=j.salesUnit||"미지정",O=S==="미지정",z=R==="미지정";return O&&!z?1:!O&&z?-1:S.localeCompare(R)}),$},[d]),N=c.useMemo(()=>Array.from(new Set(y.map($=>$.salesYear))).sort(($,L)=>L-$),[y]),A=c.useMemo(()=>{const $=new Map;for(const L of u)$.set(L.salesUnit||"미지정",L.avgPrice??null);return $},[u]),E=c.useMemo(()=>{const $=new Map;for(const L of y){const j=`${L.empName}__${L.salesUnit}`;if(!$.has(j)){const R={};N.forEach(O=>{R[O]=null}),$.set(j,{empName:L.empName||"미지정",salesUnit:L.salesUnit||"미지정",yearly:R})}const S=$.get(j);S.yearly[L.salesYear]=L.avgPrice}return Array.from($.values()).sort((L,j)=>{const S=L.salesUnit==="미지정",R=j.salesUnit==="미지정";if(S&&!R)return 1;if(!S&&R)return-1;const O=L.salesUnit.localeCompare(j.salesUnit);return O!==0?O:L.empName.localeCompare(j.empName)})},[y,N]),w=c.useMemo(()=>{const $=y.reduce((R,O)=>R+(O.salesCount||0),0),L=y.reduce((R,O)=>R+(O.totalQty||0),0),j=y.reduce((R,O)=>R+(O.totalAmt||0),0),S=L>0?j/L:0;return{totalSalesCount:$,totalQty:L,totalAmt:j,avgPrice:S}},[y]),P=$=>{if($==null||$==="")return"-";const L=Number($);return Number.isFinite(L)?L.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String($)},_=$=>{if($==null||$==="")return"-";const L=Number($);return Number.isFinite(L)?L.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String($)};return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[n.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:"판매단가 시뮬레이션"}),n.jsxs("div",{style:{marginTop:16,display:"flex",gap:12,alignItems:"flex-end"},children:[n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"회사 구분"}),n.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"inline-flex",gap:2},children:iw.map($=>n.jsx("button",{onClick:()=>t($),style:{background:e===$?"#fff":"transparent",border:"none",padding:"8px 16px",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer",color:e===$?"#111827":"#6b7280",boxShadow:e===$?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:$},$))})]}),n.jsxs("div",{style:{flex:1,maxWidth:240},children:[n.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"영업사원"}),n.jsxs("select",{className:"input",value:o,onChange:$=>l($.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13,color:"#111827",background:"#fff"},children:[n.jsx("option",{value:"all",children:"전체"}),i.map($=>n.jsx("option",{value:$,children:$},$))]})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"시작 연도"}),n.jsx("input",{className:"input",type:"number",min:2e3,max:new Date().getFullYear(),value:r,onChange:$=>a($.target.value),style:{width:100,padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13,textAlign:"center",color:"#111827",background:"#fff"}})]}),n.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:n.jsxs("button",{onClick:b,disabled:m,style:{background:m?"#93c5fd":"#3b82f6",border:"none",padding:"8px 20px",borderRadius:6,fontSize:13,fontWeight:600,cursor:m?"not-allowed":"pointer",color:"#fff",display:"flex",alignItems:"center",gap:6},children:[n.jsx(Ci,{size:14}),m?"조회 중...":"분석 실행"]})})]}),d.length>0&&n.jsxs("div",{style:{marginTop:20,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[n.jsx(Ns,{title:"총 거래 건수",value:P(w.totalSalesCount),subtext:"Invoice 기준",icon:n.jsx(wd,{size:24}),color:"#3b82f6"}),n.jsx(Ns,{title:"총 판매 수량",value:P(w.totalQty),subtext:"전체 기간 합계",icon:n.jsx(Zp,{size:24}),color:"#10b981"}),n.jsx(Ns,{title:"총 판매 금액",value:P(w.totalAmt),subtext:"원화 기준",icon:n.jsx(Ci,{size:24}),color:"#f59e0b"}),n.jsx(Ns,{title:"평균 판매 단가",value:_(w.avgPrice),subtext:"금액 ÷ 수량",icon:n.jsx(Ci,{size:24}),color:"#8b5cf6"})]})]}),n.jsx("div",{style:{flex:1,padding:24,overflow:"hidden"},children:n.jsx("div",{className:"card",style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:x?n.jsx("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:x}):y.length===0?n.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"조건을 선택하고 분석을 실행하세요"}):n.jsx("div",{style:{overflow:"auto",flex:1,padding:16},children:n.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:n.jsxs("tr",{children:[n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",width:160},children:"영업사원"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",width:160},children:"영업관리단위"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280",width:120},children:"회사 평균단가"}),N.map($=>n.jsxs("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:[$,"년 평균단가"]},$))]})}),n.jsx("tbody",{children:E.map(($,L)=>n.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[n.jsx("td",{style:{padding:"12px 16px",fontWeight:500,color:"#111827"},children:$.empName||"-"}),n.jsx("td",{style:{padding:"12px 16px",color:"#4b5563"},children:$.salesUnit||"미지정"}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600,color:"#6b7280"},children:_(A.get($.salesUnit||"미지정"))}),N.map(j=>n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600,color:"#111827"},children:_($.yearly[j])},j))]},$.empName+$.salesUnit+L))})]})})})})]})}function Ns({title:e,value:t,subtext:r,icon:a,color:i}){return n.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:8,padding:12,transition:"all 0.2s"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:4},children:[n.jsx("span",{style:{fontSize:11,color:"#6b7280",fontWeight:500},children:e}),n.jsx("span",{style:{color:i},children:Ae.cloneElement(a,{size:16})})]}),n.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#111827"},children:t}),r&&n.jsx("div",{style:{fontSize:10,color:"#6b7280",marginTop:2},children:r})]})}const ow=["TNT","DYS"];function lw(){const[e,t]=c.useState("TNT"),[r,a]=c.useState("2022"),[i,s]=c.useState([]),[o,l]=c.useState(!1),[d,h]=c.useState(null);c.useEffect(()=>{u()},[]);async function u(){l(!0),h(null);try{const g=new URLSearchParams;g.append("companyType",e),g.append("fromYear",r||"2022");const b=await fetch(`/api/v1/analysis/price-sim?${g.toString()}`);if(!b.ok)throw new Error(`HTTP ${b.status}`);const y=await b.json();if(y.error)throw new Error(y.error);const N=Array.isArray(y.data)?y.data.map(A=>({salesYear:Number(A.salesYear??A.salesyear??0),salesUnit:String(A.salesUnit??A.salesunit??"미지정"),empName:String(A.empName??A.empname??"미지정"),totalQty:A.totalQty??A.totalqty,totalAmt:A.totalAmt??A.totalamt,avgPrice:A.avgPrice??A.avgprice??null})):[];s(N)}catch(g){h((g==null?void 0:g.message)||"조회 실패"),s([])}finally{l(!1)}}const f=c.useMemo(()=>Array.from(new Set(i.map(g=>g.salesYear))).sort((g,b)=>b-g),[i]),m=c.useMemo(()=>{const g=new Map;for(const y of i){const N=y.salesUnit||"미지정",A=N,E=y.salesYear;g.has(A)||g.set(A,{salesUnit:N,yearAmt:{},yearQty:{}});const w=g.get(A);w.yearAmt[E]=(w.yearAmt[E]||0)+(Number(y.totalAmt)||0),w.yearQty[E]=(w.yearQty[E]||0)+(Number(y.totalQty)||0)}const b=[];for(const{salesUnit:y,yearAmt:N,yearQty:A}of g.values()){const E={};f.forEach(w=>{const P=N[w]||0,_=A[w]||0;E[w]=_>0?P/_:null}),b.push({salesUnit:y,yearly:E})}return b.sort((y,N)=>{const A=y.salesUnit==="미지정",E=N.salesUnit==="미지정";return A&&!E?1:!A&&E?-1:y.salesUnit.localeCompare(N.salesUnit)})},[i,f]),p=c.useMemo(()=>{const g=i.reduce((N,A)=>N+(Number(A.totalAmt)||0),0),b=i.reduce((N,A)=>N+(Number(A.totalQty)||0),0),y=b>0?g/b:0;return{totalAmt:g,totalQty:b,avgPrice:y}},[i]),x=g=>{if(g==null||g==="")return"-";const b=Number(g);return Number.isFinite(b)?b.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(g)},v=g=>{if(g==null||g==="")return"-";const b=Number(g);return Number.isFinite(b)?b.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(g)};return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[n.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:"판매단가 Sim (영업관리단위)"}),n.jsx("p",{style:{margin:"4px 0 0 0",color:"#6b7280",fontSize:14},children:"영업관리단위별 연도별 평균단가 (직원 합산)"}),n.jsxs("div",{style:{marginTop:20,display:"flex",gap:12,alignItems:"flex-end"},children:[n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"회사 구분"}),n.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"inline-flex",gap:2},children:ow.map(g=>n.jsx("button",{onClick:()=>t(g),style:{background:e===g?"#fff":"transparent",border:"none",padding:"8px 16px",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer",color:e===g?"#111827":"#6b7280",boxShadow:e===g?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:g},g))})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"시작 연도"}),n.jsx("input",{className:"input",type:"number",min:2e3,max:new Date().getFullYear(),value:r,onChange:g=>a(g.target.value),style:{width:100,padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13,textAlign:"center",color:"#111827",background:"#fff"}})]}),n.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[n.jsxs("button",{onClick:()=>{t("TNT"),a("2022"),s([]),h(null)},style:{background:"#f3f4f6",border:"none",padding:"8px 16px",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",gap:6},children:[n.jsx(Oj,{size:14}),"초기화"]}),n.jsxs("button",{onClick:u,disabled:o,style:{background:o?"#93c5fd":"#3b82f6",border:"none",padding:"8px 20px",borderRadius:6,fontSize:13,fontWeight:600,cursor:o?"not-allowed":"pointer",color:"#fff",display:"flex",alignItems:"center",gap:6},children:[n.jsx(Ci,{size:14}),o?"조회 중...":"분석 실행"]})]})]}),i.length>0&&n.jsxs("div",{style:{marginTop:20,display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:16},children:[n.jsx(ec,{title:"총 판매 수량",value:x(p.totalQty),subtext:"전체 기간 합계",color:"#10b981"}),n.jsx(ec,{title:"총 판매 금액",value:x(p.totalAmt),subtext:"원화 기준",color:"#f59e0b"}),n.jsx(ec,{title:"평균 판매 단가",value:v(p.avgPrice),subtext:"금액 ÷ 수량",color:"#8b5cf6"})]})]}),n.jsx("div",{style:{flex:1,padding:24,overflow:"hidden"},children:n.jsx("div",{className:"card",style:{height:"100%",display:"flex",flexDirection:"column",overflow:"auto",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:d?n.jsx("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:d}):m.length===0?n.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"조건을 선택하고 분석을 실행하세요"}):n.jsx("div",{style:{overflow:"auto",flex:1,padding:16},children:n.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:n.jsxs("tr",{children:[n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",width:200},children:"영업관리단위"}),f.map(g=>n.jsxs("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:[g,"년 평균단가"]},g))]})}),n.jsx("tbody",{children:m.map((g,b)=>n.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[n.jsx("td",{style:{padding:"12px 16px",fontWeight:600,color:"#111827"},children:g.salesUnit}),f.map(y=>n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600,color:"#111827"},children:v(g.yearly[y])},y))]},g.salesUnit+b))})]})})})})]})}function ec({title:e,value:t,subtext:r,color:a}){return n.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,padding:20,transition:"all 0.2s"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:8},children:[n.jsx("span",{style:{fontSize:14,color:"#6b7280",fontWeight:500},children:e}),n.jsx("span",{style:{color:a},children:n.jsx(Ci,{size:20})})]}),n.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#111827"},children:t}),r&&n.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:r})]})}function cw({onClose:e,onSelect:t}){return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsxs("div",{style:{background:"#fff",borderRadius:12,width:"90%",maxWidth:1e3,height:"80vh",display:"flex",flexDirection:"column",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},children:[n.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:18},children:"거래처 검색"}),n.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer"},children:n.jsx(Sd,{size:24})})]}),n.jsx("div",{style:{flex:1,overflow:"hidden",padding:20},children:n.jsx(Nd,{compact:!0,maxHeight:"calc(80vh - 140px)",autoSelectFirst:!1,onSelect:r=>t({customerSeq:Number(r.customerSeq),customerName:r.customerName})})})]})})}function dw(){var y,N,A,E,w,P,_,$;const[e,t]=c.useState(null),[r,a]=c.useState(new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0]),[i,s]=c.useState(new Date().toISOString().split("T")[0]),[o,l]=c.useState(null),[d,h]=c.useState(!1),[u,f]=c.useState(!1),[m,p]=c.useState(50),[x,v]=c.useState(""),g=async()=>{if(e){h(!0);try{const L=await fetch(`/api/v1/lab/price-simulation/data?customerSeq=${e.seq}&startDate=${r}&endDate=${i}`);if(L.ok){const j=await L.json();l(j),p(j.assessmentScore),v(j.assessmentComment||"")}}catch(L){console.error(L)}finally{h(!1)}}},b=async()=>{if(e)try{await fetch("/api/v1/lab/price-simulation/assessment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerSeq:e.seq,assessorId:"current-user",score:m,comment:x})}),g()}catch(L){console.error(L)}};return n.jsxs("div",{className:"price-simulation",style:{padding:20,height:"100%",overflow:"auto",display:"flex",flexDirection:"column",gap:20},children:[n.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("h1",{style:{fontSize:24,fontWeight:"bold"},children:"Price Simulation"}),n.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[n.jsxs("div",{className:"input-group",style:{display:"flex",alignItems:"center",gap:8,background:"#f5f5f5",padding:"4px 12px",borderRadius:8},children:[n.jsx(Nc,{size:16}),n.jsx("input",{type:"date",value:r,onChange:L=>a(L.target.value),style:{border:"none",background:"transparent"}}),n.jsx("span",{children:"~"}),n.jsx("input",{type:"date",value:i,onChange:L=>s(L.target.value),style:{border:"none",background:"transparent"}})]}),n.jsxs("button",{onClick:()=>f(!0),style:{display:"flex",alignItems:"center",gap:8,padding:"8px 16px",background:"#333",color:"#fff",borderRadius:8,border:"none",cursor:"pointer"},children:[n.jsx(kc,{size:16}),e?e.name:"거래처 선택"]}),n.jsx("button",{onClick:g,disabled:!e||d,style:{display:"flex",alignItems:"center",gap:8,padding:"8px 16px",background:!e||d?"#ccc":"#2563eb",color:"#fff",borderRadius:8,border:"none",cursor:!e||d?"not-allowed":"pointer",fontWeight:"bold"},children:"SIMULATION"})]})]}),e&&o?n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[n.jsx(ks,{title:"거래규모 (성장성)",icon:n.jsx(eg,{color:"#4CAF50"}),score:o.volumeScore,children:n.jsxs("div",{style:{fontSize:12,color:"#666"},children:[n.jsxs("div",{children:["금년: ",(y=o.volumeCurrent)==null?void 0:y.toLocaleString()]}),n.jsxs("div",{children:["전년: ",(N=o.volumeYear1)==null?void 0:N.toLocaleString()]}),n.jsxs("div",{style:{fontWeight:"bold",color:o.volumeGrowthRate>=0?"#4CAF50":"#F44336"},children:["YoY: ",(A=o.volumeGrowthRate)==null?void 0:A.toFixed(1),"%"]})]})}),n.jsx(ks,{title:"채권 건전성",icon:n.jsx(zo,{color:"#FF9800"}),score:o.agingScore,children:n.jsxs("div",{style:{fontSize:12,color:"#666"},children:[n.jsxs("div",{children:["총채권: ",(E=o.totalAr)==null?void 0:E.toLocaleString()]}),n.jsxs("div",{children:["연체: ",(w=o.overdueAr)==null?void 0:w.toLocaleString()]}),n.jsxs("div",{style:{fontWeight:"bold",color:o.overdueRatio>0?"#F44336":"#4CAF50"},children:["연체율: ",(P=o.overdueRatio)==null?void 0:P.toFixed(1),"%"]})]})}),n.jsx(ks,{title:"대외 신용도",icon:n.jsx(lj,{color:"#2196F3"}),score:o.ratingScore,children:n.jsxs("div",{style:{fontSize:12,color:"#666"},children:[n.jsxs("div",{children:["기관: ",o.ratingAgency||"-"]}),n.jsx("div",{style:{fontSize:24,fontWeight:"bold",margin:"4px 0"},children:o.ratingGrade||"-"})]})}),n.jsx(ks,{title:"영업 정성평가",icon:n.jsx(Lj,{color:"#9C27B0"}),score:o.assessmentScore,children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[n.jsx("input",{type:"range",min:"0",max:"100",step:"20",value:m,onChange:L=>p(Number(L.target.value)),style:{width:"100%"}}),n.jsxs("div",{style:{display:"flex",gap:4},children:[n.jsx("input",{type:"text",value:x,onChange:L=>v(L.target.value),placeholder:"평가 코멘트",style:{flex:1,padding:4,borderRadius:4,border:"1px solid #ddd",fontSize:12}}),n.jsx("button",{onClick:b,style:{fontSize:10,padding:"4px 8px",background:"#333",color:"#fff",border:"none",borderRadius:4,cursor:"pointer"},children:"저장"})]})]})})]}),n.jsxs("div",{style:{background:"linear-gradient(90deg, #1a237e 0%, #283593 100%)",padding:20,borderRadius:12,color:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsxs("div",{children:[n.jsx("h2",{style:{margin:0,fontSize:18,opacity:.9},children:"Price Simulation Result"}),n.jsxs("p",{style:{margin:"4px 0 0 0",fontSize:14,opacity:.7},children:["종합 점수 ",o.totalScore,"점을 기반으로 산출된 권장 인상률입니다."]})]}),n.jsxs("div",{style:{textAlign:"right"},children:[n.jsx("div",{style:{fontSize:14,opacity:.8},children:"권장 인상률"}),n.jsxs("div",{style:{fontSize:32,fontWeight:"bold",color:"#4CAF50"},children:["+",(_=o.suggestedIncreaseRate)==null?void 0:_.toFixed(2),"%"]})]})]}),n.jsx("div",{style:{background:"#fff",borderRadius:12,border:"1px solid #eee",overflow:"hidden"},children:n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{style:{background:"#f9f9f9",borderBottom:"1px solid #eee"},children:n.jsxs("tr",{children:[n.jsx("th",{style:{padding:12,textAlign:"left",fontSize:12,color:"#666"},children:"품목명"}),n.jsx("th",{style:{padding:12,textAlign:"center",fontSize:12,color:"#666"},children:"단위"}),n.jsx("th",{style:{padding:12,textAlign:"right",fontSize:12,color:"#666"},children:"최근 판매량"}),n.jsx("th",{style:{padding:12,textAlign:"right",fontSize:12,color:"#666"},children:"최근 평균단가"}),n.jsx("th",{style:{padding:12,textAlign:"right",fontSize:12,color:"#666",background:"#e8f5e9"},children:"시뮬레이션 단가"}),n.jsx("th",{style:{padding:12,textAlign:"right",fontSize:12,color:"#666"},children:"예상 증분"})]})}),n.jsxs("tbody",{children:[($=o.items)==null?void 0:$.map(L=>{var j,S,R;return n.jsxs("tr",{style:{borderBottom:"1px solid #f5f5f5"},children:[n.jsx("td",{style:{padding:12,fontSize:14},children:L.itemName}),n.jsx("td",{style:{padding:12,textAlign:"center",fontSize:12,color:"#888"},children:L.itemUnit}),n.jsx("td",{style:{padding:12,textAlign:"right",fontSize:14},children:(j=L.recentQty)==null?void 0:j.toLocaleString()}),n.jsx("td",{style:{padding:12,textAlign:"right",fontSize:14},children:(S=L.recentUnitPrice)==null?void 0:S.toLocaleString()}),n.jsx("td",{style:{padding:12,textAlign:"right",fontSize:14,fontWeight:"bold",color:"#2E7D32",background:"#f1f8e9"},children:(R=L.simulatedUnitPrice)==null?void 0:R.toLocaleString(void 0,{maximumFractionDigits:0})}),n.jsxs("td",{style:{padding:12,textAlign:"right",fontSize:12,color:"#4CAF50"},children:["+",(L.simulatedUnitPrice-L.recentUnitPrice).toLocaleString(void 0,{maximumFractionDigits:0})]})]},L.itemSeq)}),(!o.items||o.items.length===0)&&n.jsx("tr",{children:n.jsx("td",{colSpan:6,style:{padding:40,textAlign:"center",color:"#999"},children:"해당 기간에 판매 이력이 없습니다."})})]})]})})]}):n.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#999",gap:16},children:[n.jsx("div",{style:{width:64,height:64,borderRadius:32,background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx(kc,{size:32,color:"#ccc"})}),n.jsx("p",{children:"상단에서 거래처를 선택하여 시뮬레이션을 시작하세요."})]}),u&&n.jsx(cw,{onClose:()=>f(!1),onSelect:L=>{t({seq:L.customerSeq,name:L.customerName}),f(!1)}})]})}function ks({title:e,icon:t,score:r,children:a}){return n.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:16,border:"1px solid #eee",display:"flex",flexDirection:"column",gap:12},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontWeight:"bold",fontSize:14},children:[t,e]}),n.jsxs("div",{style:{padding:"4px 8px",borderRadius:12,fontSize:12,fontWeight:"bold",background:r>=80?"#E8F5E9":r>=50?"#FFF3E0":"#FFEBEE",color:r>=80?"#2E7D32":r>=50?"#EF6C00":"#C62828"},children:[r,"점"]})]}),n.jsx("div",{style:{height:1,background:"#f0f0f0"}}),a]})}function uw(){const[e,t]=c.useState(""),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState([]),[d,h]=c.useState(!1),[u,f]=c.useState(!1),[m,p]=c.useState(null);c.useEffect(()=>{x()},[]);const x=async()=>{h(!0);try{const b=await fetch("/api/v1/nl2sql/schema");if(!b.ok)throw new Error(`HTTP ${b.status}`);const y=await b.json();y.error?p(y.error):l(y.tables||[])}catch(b){p(b.message||"스키마 조회 실패")}finally{h(!1)}},v=async b=>{if(b.preventDefault(),!!e.trim()){a(!0),p(null),s(null);try{const y=await fetch("/api/v1/nl2sql/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e.trim()})});if(!y.ok)throw new Error(`HTTP ${y.status}`);const N=await y.json();N.error?(p(N.error),N.sql&&s({...N,results:[],rowCount:0})):s(N)}catch(y){p(y.message||"쿼리 실행 실패")}finally{a(!1)}}},g=["2024년 총 매출액은?","영업사원별 매출 TOP 10","최근 3개월 신규 고객 수","제품별 판매 수량 합계"];return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n.jsxs("div",{children:[n.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:"VIBE Workspace"}),n.jsx("p",{style:{margin:"6px 0 0",color:"#6b7280",fontSize:14},children:"자연어로 데이터베이스에 질문하세요"})]}),n.jsxs("button",{onClick:()=>f(!u),style:{display:"flex",alignItems:"center",gap:6,padding:"8px 16px",background:u?"#3b82f6":"#fff",color:u?"#fff":"#374151",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer"},children:[n.jsx(yj,{size:16}),u?"스키마 숨기기":"스키마 보기"]})]}),n.jsx("form",{onSubmit:v,style:{marginTop:16},children:n.jsxs("div",{style:{display:"flex",gap:12},children:[n.jsxs("div",{style:{flex:1,position:"relative"},children:[n.jsx(va,{size:18,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}}),n.jsx("input",{type:"text",value:e,onChange:b=>t(b.target.value),placeholder:"예: 2024년 총 매출액은 얼마인가요?",disabled:r,style:{width:"100%",padding:"12px 12px 12px 40px",border:"1px solid #d1d5db",borderRadius:8,fontSize:14,color:"#111827",background:"#fff"}})]}),n.jsx("button",{type:"submit",disabled:r||!e.trim(),style:{padding:"12px 24px",background:r||!e.trim()?"#93c5fd":"#3b82f6",color:"#fff",border:"none",borderRadius:8,fontSize:14,fontWeight:600,cursor:r||!e.trim()?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:8},children:r?n.jsxs(n.Fragment,{children:[n.jsx(Uf,{size:16,style:{animation:"spin 1s linear infinite"}}),"분석 중..."]}):"질문하기"})]})}),n.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[n.jsx("span",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:"예시:"}),g.map((b,y)=>n.jsx("button",{onClick:()=>t(b),disabled:r,style:{padding:"4px 12px",background:"#f3f4f6",color:"#374151",border:"1px solid #e5e7eb",borderRadius:6,fontSize:12,cursor:"pointer"},children:b},y))]})]}),n.jsxs("div",{style:{flex:1,padding:24,overflow:"auto",display:"flex",gap:16},children:[u&&n.jsxs("div",{className:"card",style:{width:320,flexShrink:0,overflow:"auto",padding:16,background:"#fff"},children:[n.jsx("h3",{style:{margin:"0 0 12px",fontSize:16,fontWeight:600,color:"#111827"},children:"데이터베이스 스키마"}),d?n.jsx("div",{style:{textAlign:"center",padding:20,color:"#6b7280"},children:n.jsx(Uf,{size:24,style:{animation:"spin 1s linear infinite"}})}):o.length===0?n.jsx("div",{style:{textAlign:"center",padding:20,color:"#6b7280",fontSize:13},children:"스키마 정보 없음"}):n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:o.map((b,y)=>n.jsxs("details",{style:{background:"#f9fafb",padding:8,borderRadius:6},children:[n.jsxs("summary",{style:{cursor:"pointer",fontWeight:500,fontSize:13,color:"#374151",marginBottom:8},children:[b.schema,".",b.name]}),n.jsx("div",{style:{paddingLeft:12,fontSize:12,color:"#6b7280"},children:b.columns.map((N,A)=>n.jsxs("div",{style:{marginBottom:6,display:"flex",flexDirection:"column",gap:2},children:[n.jsxs("div",{children:[n.jsx("span",{style:{color:"#111827",fontWeight:500},children:N.name}),n.jsxs("span",{style:{color:"#9ca3af"},children:[" (",N.type,")"]})]}),N.description&&n.jsx("div",{style:{fontSize:11,color:"#3b82f6",fontWeight:500},children:N.description})]},A))})]},y))})]}),n.jsx("div",{className:"card",style:{flex:1,display:"flex",flexDirection:"column",background:"#fff"},children:m?n.jsxs("div",{style:{padding:40,textAlign:"center"},children:[n.jsx(zo,{size:48,style:{color:"#ef4444",marginBottom:12}}),n.jsx("div",{style:{color:"#ef4444",fontSize:16,fontWeight:600},children:m})]}):i?n.jsxs("div",{style:{padding:16,display:"flex",flexDirection:"column",gap:16,flex:1,overflow:"hidden"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:12,background:"#f0fdf4",borderRadius:8},children:[n.jsx(fj,{size:20,style:{color:"#22c55e"}}),n.jsxs("div",{children:[n.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#166534"},children:"쿼리 실행 완료"}),n.jsxs("div",{style:{fontSize:12,color:"#15803d",marginTop:2},children:[i.rowCount,"개의 결과를 찾았습니다"]})]})]}),n.jsxs("div",{children:[n.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6},children:"생성된 SQL:"}),n.jsx("pre",{style:{background:"#1f2937",color:"#f3f4f6",padding:12,borderRadius:6,fontSize:12,overflow:"auto",margin:0},children:i.sql})]}),i.results.length>0&&n.jsxs("div",{style:{flex:1,overflow:"auto"},children:[n.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8},children:"결과:"}),n.jsx("div",{style:{overflow:"auto",border:"1px solid #e5e7eb",borderRadius:6},children:n.jsxs("table",{className:"table",style:{width:"100%",fontSize:13},children:[n.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:1},children:n.jsx("tr",{children:Object.keys(i.results[0]).map(b=>n.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:600,color:"#374151"},children:b},b))})}),n.jsx("tbody",{children:i.results.map((b,y)=>n.jsx("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:Object.values(b).map((N,A)=>n.jsx("td",{style:{padding:"10px 12px",color:"#6b7280"},children:N==null?n.jsx("span",{style:{color:"#d1d5db",fontStyle:"italic"},children:"null"}):typeof N=="object"?JSON.stringify(N):String(N)},A))},y))})]})})]})]}):n.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[n.jsx(Mj,{size:64,style:{margin:"0 auto 16px",color:"#d1d5db"}}),n.jsx("div",{style:{fontSize:16,fontWeight:500,marginBottom:8},children:"질문을 입력하세요"}),n.jsx("div",{style:{fontSize:14},children:"자연어로 데이터베이스에 질문하면 자동으로 SQL을 생성하여 실행합니다"})]})})]}),n.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})}function fw(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState([]),[d,h]=c.useState([]),[u,f]=c.useState("all"),[m,p]=c.useState("all"),[x,v]=c.useState(""),[g,b]=c.useState("all"),[y,N]=c.useState("all"),[A,E]=c.useState("latest"),[w,P]=c.useState({totalAr:0,overdueAr:0,overdueCount:0,aging30Ar:0,aging30Count:0,normalAr:0}),_=async()=>{try{const O=await fetch("/api/v1/credit/sales-reps");if(!O.ok)throw new Error(`API 호출 실패: ${O.status}`);const z=await O.json();l(z.salesReps||[])}catch(O){console.error("영업사원 목록 조회 실패:",O)}},$=async()=>{try{const O=await fetch("/api/v1/credit/snapshot-dates");if(!O.ok)throw new Error(`API 호출 실패: ${O.status}`);const z=await O.json();h(z.dates||[])}catch(O){console.error("채권검토일 목록 조회 실패:",O)}},L=async()=>{a(!0),s(null);try{const O=new URLSearchParams;u!=="all"&&O.append("company",u),m!=="all"&&O.append("salesRep",m),x&&O.append("customerName",x),g!=="all"&&O.append("riskLevel",g),y!=="all"&&O.append("agingBucket",y),A!=="latest"&&O.append("snapshotDate",A),console.log("AR Aging 조회 요청:",O.toString());const z=await fetch(`/api/v1/credit/ar-aging?${O.toString()}`);if(!z.ok)throw new Error(`API 호출 실패: ${z.status}`);const Z=await z.json();console.log("AR Aging 조회 응답:",Z);const ae=(Z.items||[]).map(C=>({customerSeq:C.customer_seq,customerCode:C.customer_no,customerName:C.customer_name,companyType:C.company_type,salesRep:C.emp_name,department:C.dept_name,totalAr:C.total_ar,overdue:C.overdue,aging030:C.aging_0_30,aging3160:C.aging_31_60,aging6190:C.aging_61_90,aging91120:C.aging_91_120,aging121150:C.aging_121_150,aging151180:C.aging_151_180,aging181210:C.aging_181_210,aging211240:C.aging_211_240,aging241270:C.aging_241_270,aging271300:C.aging_271_300,aging301330:C.aging_301_330,aging331365:C.aging_331_365,agingOver365:C.aging_over_365,riskLevel:C.riskLevel,lastCollectionDate:C.last_collection_date}));t(ae);const se=ae.filter(C=>C.riskLevel==="high"),H=ae.filter(C=>C.riskLevel==="medium"),q=ae.filter(C=>C.riskLevel==="low");P({totalAr:ae.reduce((C,T)=>C+(T.totalAr||0),0),overdueAr:ae.reduce((C,T)=>C+(T.overdue||0),0),overdueCount:se.length,aging30Ar:ae.reduce((C,T)=>C+(T.aging030||0),0),aging30Count:q.length,normalAr:ae.reduce((C,T)=>C+(T.aging030||0),0)})}catch(O){console.error("AR Aging 조회 실패:",O),s(O.message||"데이터 조회 중 오류가 발생했습니다.")}finally{a(!1)}};c.useEffect(()=>{_(),$(),L()},[]);const j=O=>{if(O==null||O==="")return"-";const z=Number(O);return Number.isFinite(z)?`₩${z.toLocaleString("ko-KR")}`:String(O)},S=O=>O==="TNT"?n.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,background:"#3b82f6",color:"white",borderRadius:4,fontSize:11,fontWeight:700,marginRight:6},children:"T"}):O==="DYS"?n.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,background:"#10b981",color:"white",borderRadius:4,fontSize:11,fontWeight:700,marginRight:6},children:"D"}):null,R=O=>O==="high"?n.jsx("span",{style:{padding:"2px 8px",background:"#ef4444",color:"white",borderRadius:4,fontSize:11},children:"고위험"}):O==="medium"?n.jsx("span",{style:{padding:"2px 8px",background:"#f59e0b",color:"white",borderRadius:4,fontSize:11},children:"중위험"}):O==="low"?n.jsx("span",{style:{padding:"2px 8px",background:"#10b981",color:"white",borderRadius:4,fontSize:11},children:"저위험"}):n.jsx("span",{style:{padding:"2px 8px",background:"#6b7280",color:"white",borderRadius:4,fontSize:11},children:"-"});return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[n.jsxs("div",{style:{marginBottom:24,display:"flex",alignItems:"baseline",gap:12,justifyContent:"space-between"},children:[n.jsxs("div",{children:[n.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"연체채권 현황"}),n.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"거래처별 채권 연령 분석 및 리스크 관리"})]}),n.jsxs("div",{style:{padding:"8px 12px",background:"#f3f4f6",borderRadius:6,fontSize:12,color:"#4b5563"},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"위험도 분류 기준 (연체비율)"}),n.jsxs("div",{style:{display:"flex",gap:12},children:[n.jsxs("span",{children:[n.jsx("span",{style:{color:"#ef4444",fontWeight:600},children:"고위험"}),": 30% 초과"]}),n.jsxs("span",{children:[n.jsx("span",{style:{color:"#f59e0b",fontWeight:600},children:"중위험"}),": 10~30%"]}),n.jsxs("span",{children:[n.jsx("span",{style:{color:"#10b981",fontWeight:600},children:"저위험"}),": 10% 이하"]})]}),n.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:2},children:"※ 연체비율 = 30일 초과 연체액 / 총채권액"})]})]}),n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",marginBottom:20},children:[n.jsxs("select",{className:"search-input",value:A,onChange:O=>E(O.target.value),style:{width:150},children:[n.jsx("option",{value:"latest",children:"최신 채권검토일"}),d.map(O=>n.jsx("option",{value:O,children:O},O))]}),n.jsxs("select",{className:"search-input",value:u,onChange:O=>f(O.target.value),style:{width:120},children:[n.jsx("option",{value:"all",children:"전체 회사"}),n.jsx("option",{value:"TNT",children:"TNT"}),n.jsx("option",{value:"DYS",children:"DYS"})]}),n.jsxs("select",{className:"search-input",value:m,onChange:O=>p(O.target.value),style:{width:150},children:[n.jsx("option",{value:"all",children:"전체 영업사원"}),o.map(O=>n.jsx("option",{value:O,children:O},O))]}),n.jsx("input",{type:"text",className:"search-input",value:x,onChange:O=>v(O.target.value),placeholder:"거래처명 검색",style:{width:150}}),n.jsxs("select",{className:"search-input",value:g,onChange:O=>b(O.target.value),style:{width:120},children:[n.jsx("option",{value:"all",children:"전체 위험도"}),n.jsx("option",{value:"high",children:"고위험"}),n.jsx("option",{value:"medium",children:"중위험"}),n.jsx("option",{value:"low",children:"저위험"})]}),n.jsxs("select",{className:"search-input",value:y,onChange:O=>N(O.target.value),style:{width:120},children:[n.jsx("option",{value:"all",children:"전체 구간"}),n.jsx("option",{value:"0-30",children:"0-30일 이내"}),n.jsx("option",{value:"31-60",children:"1개월 이내"}),n.jsx("option",{value:"61-90",children:"2개월 이내"}),n.jsx("option",{value:"91-120",children:"3개월 이내"}),n.jsx("option",{value:"121-150",children:"4개월 이내"}),n.jsx("option",{value:"151-180",children:"5개월 이내"}),n.jsx("option",{value:"181-210",children:"6개월 이내"}),n.jsx("option",{value:"211-240",children:"7개월 이내"}),n.jsx("option",{value:"241-270",children:"8개월 이내"}),n.jsx("option",{value:"271-300",children:"9개월 이내"}),n.jsx("option",{value:"301-330",children:"10개월 이내"}),n.jsx("option",{value:"331-365",children:"11개월 이내"}),n.jsx("option",{value:"over-365",children:"12개월 초과"})]}),n.jsx("div",{style:{display:"flex",gap:8,marginLeft:"auto"},children:n.jsx("button",{className:"btn",onClick:L,disabled:r,style:{height:30,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",whiteSpace:"nowrap"},children:r?"조회 중...":"조회"})})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[n.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #3b82f6"},children:[n.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"총채권액"}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:j(w.totalAr)})]}),n.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #ef4444"},children:[n.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:["만기도과 (",w.overdueCount,"건)"]}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#ef4444"},children:j(w.overdueAr)})]}),n.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #f59e0b"},children:[n.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:["30일 이내 (",w.aging30Count,"건)"]}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#f59e0b"},children:j(w.aging30Ar)})]}),n.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #10b981"},children:[n.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"정상채권"}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#10b981"},children:j(w.normalAr)})]})]})]}),n.jsx("div",{style:{flex:1,overflow:"auto",padding:24},children:i?n.jsx("div",{style:{padding:16,color:"#ef4444"},children:i}):e.length===0?n.jsx("div",{className:"empty-state",children:"조회된 데이터가 없습니다"}):n.jsx("div",{className:"card",style:{overflow:"auto",height:"100%"},children:n.jsxs("table",{className:"table",style:{fontSize:12},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:40,textAlign:"center",position:"sticky",top:0,background:"#fff",zIndex:10},children:"#"}),n.jsx("th",{style:{width:80,position:"sticky",top:0,background:"#fff",zIndex:10},children:"위험도"}),n.jsx("th",{style:{minWidth:250,position:"sticky",top:0,background:"#fff",zIndex:10},children:"거래처 정보"}),n.jsx("th",{style:{minWidth:120,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"총채권액"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"0-30일"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"1개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"2개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"3개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"4개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"5개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"6개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"7개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"8개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"9개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"10개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"11개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"12개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"12개월+"}),n.jsx("th",{style:{minWidth:100,textAlign:"center",position:"sticky",top:0,background:"#fff",zIndex:10},children:"액션"})]})}),n.jsx("tbody",{children:e.map((O,z)=>n.jsxs("tr",{style:{cursor:"pointer"},children:[n.jsx("td",{style:{textAlign:"center",color:"var(--muted)"},children:z+1}),n.jsx("td",{children:R(O.riskLevel||"")}),n.jsx("td",{children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[S(O.companyType||""),n.jsx("span",{style:{fontWeight:600,fontSize:13},children:O.customerName||"-"})]}),n.jsxs("div",{style:{fontSize:11,color:"#6b7280",display:"flex",gap:8,flexWrap:"wrap"},children:[n.jsxs("span",{children:["코드: ",O.customerCode||"-"]}),n.jsxs("span",{children:["영업: ",O.salesRep||"-"]}),n.jsxs("span",{children:["부서: ",O.department||"-"]})]})]})}),n.jsx("td",{style:{textAlign:"right",fontWeight:600},children:j(O.totalAr)}),n.jsx("td",{style:{textAlign:"right"},children:j(O.aging030)}),n.jsx("td",{style:{textAlign:"right"},children:j(O.aging3160)}),n.jsx("td",{style:{textAlign:"right"},children:j(O.aging6190)}),n.jsx("td",{style:{textAlign:"right"},children:j(O.aging91120)}),n.jsx("td",{style:{textAlign:"right"},children:j(O.aging121150)}),n.jsx("td",{style:{textAlign:"right"},children:j(O.aging151180)}),n.jsx("td",{style:{textAlign:"right"},children:j(O.aging181210)}),n.jsx("td",{style:{textAlign:"right"},children:j(O.aging211240)}),n.jsx("td",{style:{textAlign:"right"},children:j(O.aging241270)}),n.jsx("td",{style:{textAlign:"right"},children:j(O.aging271300)}),n.jsx("td",{style:{textAlign:"right"},children:j(O.aging301330)}),n.jsx("td",{style:{textAlign:"right"},children:j(O.aging331365)}),n.jsx("td",{style:{textAlign:"right"},children:j(O.agingOver365)}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx("button",{className:"btn btn-sm",onClick:Z=>{Z.stopPropagation(),alert("거래처 상세 패널 구현 예정")},children:"상세"})})]},z))})]})})})]})}function fg(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=fg(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function nt(){for(var e,t,r=0,a="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=fg(e))&&(a&&(a+=" "),a+=t);return a}var hw=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Ad(e){if(typeof e!="string")return!1;var t=hw;return t.includes(e)}var mw=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function hg(e){if(typeof e!="string")return!1;var t=mw;return t.includes(e)}function mg(e){return typeof e=="string"&&e.startsWith("data-")}function _n(e){var t=Object.entries(e).filter(r=>{var[a]=r;return hg(a)||mg(a)});return Object.fromEntries(t)}function xa(e){if(e==null)return null;if(c.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return _n(t)}return typeof e=="object"&&!Array.isArray(e)?_n(e):null}function yn(e){var t=Object.entries(e).filter(r=>{var[a]=r;return hg(a)||mg(a)||Ad(a)});return Object.fromEntries(t)}function pw(e){return e==null?null:c.isValidElement(e)?yn(e.props):typeof e=="object"&&!Array.isArray(e)?yn(e):null}var gw=["children","width","height","viewBox","className","style","title","desc"];function Ac(){return Ac=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ac.apply(null,arguments)}function yw(e,t){if(e==null)return{};var r,a,i=vw(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function vw(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var pg=c.forwardRef((e,t)=>{var{children:r,width:a,height:i,viewBox:s,className:o,style:l,title:d,desc:h}=e,u=yw(e,gw),f=s||{width:a,height:i,x:0,y:0},m=nt("recharts-surface",o);return c.createElement("svg",Ac({},yn(u),{className:m,width:a,height:i,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),c.createElement("title",null,d),c.createElement("desc",null,h),r)}),xw=["children","className"];function Cc(){return Cc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Cc.apply(null,arguments)}function bw(e,t){if(e==null)return{};var r,a,i=jw(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function jw(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var en=c.forwardRef((e,t)=>{var{children:r,className:a}=e,i=bw(e,xw),s=nt("recharts-layer",a);return c.createElement("g",Cc({className:s},yn(i),{ref:t}),r)}),ww=c.createContext(null);function ft(e){return function(){return e}}const gg=Math.cos,Hs=Math.sin,Zn=Math.sqrt,Ys=Math.PI,Bo=2*Ys,Ec=Math.PI,Pc=2*Ec,oa=1e-6,Sw=Pc-oa;function yg(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function Nw(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return yg;const r=10**t;return function(a){this._+=a[0];for(let i=1,s=a.length;i<s;++i)this._+=Math.round(arguments[i]*r)/r+a[i]}}class kw{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?yg:Nw(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,a,i){this._append`Q${+t},${+r},${this._x1=+a},${this._y1=+i}`}bezierCurveTo(t,r,a,i,s,o){this._append`C${+t},${+r},${+a},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(t,r,a,i,s){if(t=+t,r=+r,a=+a,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,d=a-t,h=i-r,u=o-t,f=l-r,m=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(m>oa)if(!(Math.abs(f*d-h*u)>oa)||!s)this._append`L${this._x1=t},${this._y1=r}`;else{let p=a-o,x=i-l,v=d*d+h*h,g=p*p+x*x,b=Math.sqrt(v),y=Math.sqrt(m),N=s*Math.tan((Ec-Math.acos((v+m-g)/(2*b*y)))/2),A=N/y,E=N/b;Math.abs(A-1)>oa&&this._append`L${t+A*u},${r+A*f}`,this._append`A${s},${s},0,0,${+(f*p>u*x)},${this._x1=t+E*d},${this._y1=r+E*h}`}}arc(t,r,a,i,s,o){if(t=+t,r=+r,a=+a,o=!!o,a<0)throw new Error(`negative radius: ${a}`);let l=a*Math.cos(i),d=a*Math.sin(i),h=t+l,u=r+d,f=1^o,m=o?i-s:s-i;this._x1===null?this._append`M${h},${u}`:(Math.abs(this._x1-h)>oa||Math.abs(this._y1-u)>oa)&&this._append`L${h},${u}`,a&&(m<0&&(m=m%Pc+Pc),m>Sw?this._append`A${a},${a},0,1,${f},${t-l},${r-d}A${a},${a},0,1,${f},${this._x1=h},${this._y1=u}`:m>oa&&this._append`A${a},${a},0,${+(m>=Ec)},${f},${this._x1=t+a*Math.cos(s)},${this._y1=r+a*Math.sin(s)}`)}rect(t,r,a,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${a=+a}v${+i}h${-a}Z`}toString(){return this._}}function Cd(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const a=Math.floor(r);if(!(a>=0))throw new RangeError(`invalid digits: ${r}`);t=a}return e},()=>new kw(t)}function Ed(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function vg(e){this._context=e}vg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Fo(e){return new vg(e)}function xg(e){return e[0]}function bg(e){return e[1]}function jg(e,t){var r=ft(!0),a=null,i=Fo,s=null,o=Cd(l);e=typeof e=="function"?e:e===void 0?xg:ft(e),t=typeof t=="function"?t:t===void 0?bg:ft(t);function l(d){var h,u=(d=Ed(d)).length,f,m=!1,p;for(a==null&&(s=i(p=o())),h=0;h<=u;++h)!(h<u&&r(f=d[h],h,d))===m&&((m=!m)?s.lineStart():s.lineEnd()),m&&s.point(+e(f,h,d),+t(f,h,d));if(p)return s=null,p+""||null}return l.x=function(d){return arguments.length?(e=typeof d=="function"?d:ft(+d),l):e},l.y=function(d){return arguments.length?(t=typeof d=="function"?d:ft(+d),l):t},l.defined=function(d){return arguments.length?(r=typeof d=="function"?d:ft(!!d),l):r},l.curve=function(d){return arguments.length?(i=d,a!=null&&(s=i(a)),l):i},l.context=function(d){return arguments.length?(d==null?a=s=null:s=i(a=d),l):a},l}function As(e,t,r){var a=null,i=ft(!0),s=null,o=Fo,l=null,d=Cd(h);e=typeof e=="function"?e:e===void 0?xg:ft(+e),t=typeof t=="function"?t:ft(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?bg:ft(+r);function h(f){var m,p,x,v=(f=Ed(f)).length,g,b=!1,y,N=new Array(v),A=new Array(v);for(s==null&&(l=o(y=d())),m=0;m<=v;++m){if(!(m<v&&i(g=f[m],m,f))===b)if(b=!b)p=m,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),x=m-1;x>=p;--x)l.point(N[x],A[x]);l.lineEnd(),l.areaEnd()}b&&(N[m]=+e(g,m,f),A[m]=+t(g,m,f),l.point(a?+a(g,m,f):N[m],r?+r(g,m,f):A[m]))}if(y)return l=null,y+""||null}function u(){return jg().defined(i).curve(o).context(s)}return h.x=function(f){return arguments.length?(e=typeof f=="function"?f:ft(+f),a=null,h):e},h.x0=function(f){return arguments.length?(e=typeof f=="function"?f:ft(+f),h):e},h.x1=function(f){return arguments.length?(a=f==null?null:typeof f=="function"?f:ft(+f),h):a},h.y=function(f){return arguments.length?(t=typeof f=="function"?f:ft(+f),r=null,h):t},h.y0=function(f){return arguments.length?(t=typeof f=="function"?f:ft(+f),h):t},h.y1=function(f){return arguments.length?(r=f==null?null:typeof f=="function"?f:ft(+f),h):r},h.lineX0=h.lineY0=function(){return u().x(e).y(t)},h.lineY1=function(){return u().x(e).y(r)},h.lineX1=function(){return u().x(a).y(t)},h.defined=function(f){return arguments.length?(i=typeof f=="function"?f:ft(!!f),h):i},h.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),h):o},h.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),h):s},h}class wg{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function Aw(e){return new wg(e,!0)}function Cw(e){return new wg(e,!1)}const Pd={draw(e,t){const r=Zn(t/Ys);e.moveTo(r,0),e.arc(0,0,r,0,Bo)}},Ew={draw(e,t){const r=Zn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},Sg=Zn(1/3),Pw=Sg*2,Iw={draw(e,t){const r=Zn(t/Pw),a=r*Sg;e.moveTo(0,-r),e.lineTo(a,0),e.lineTo(0,r),e.lineTo(-a,0),e.closePath()}},Tw={draw(e,t){const r=Zn(t),a=-r/2;e.rect(a,a,r,r)}},Ow=.8908130915292852,Ng=Hs(Ys/10)/Hs(7*Ys/10),_w=Hs(Bo/10)*Ng,Dw=-gg(Bo/10)*Ng,Mw={draw(e,t){const r=Zn(t*Ow),a=_w*r,i=Dw*r;e.moveTo(0,-r),e.lineTo(a,i);for(let s=1;s<5;++s){const o=Bo*s/5,l=gg(o),d=Hs(o);e.lineTo(d*r,-l*r),e.lineTo(l*a-d*i,d*a+l*i)}e.closePath()}},tc=Zn(3),$w={draw(e,t){const r=-Zn(t/(tc*3));e.moveTo(0,r*2),e.lineTo(-tc*r,-r),e.lineTo(tc*r,-r),e.closePath()}},Rn=-.5,zn=Zn(3)/2,Ic=1/Zn(12),Lw=(Ic/2+1)*3,Rw={draw(e,t){const r=Zn(t/Lw),a=r/2,i=r*Ic,s=a,o=r*Ic+r,l=-s,d=o;e.moveTo(a,i),e.lineTo(s,o),e.lineTo(l,d),e.lineTo(Rn*a-zn*i,zn*a+Rn*i),e.lineTo(Rn*s-zn*o,zn*s+Rn*o),e.lineTo(Rn*l-zn*d,zn*l+Rn*d),e.lineTo(Rn*a+zn*i,Rn*i-zn*a),e.lineTo(Rn*s+zn*o,Rn*o-zn*s),e.lineTo(Rn*l+zn*d,Rn*d-zn*l),e.closePath()}};function zw(e,t){let r=null,a=Cd(i);e=typeof e=="function"?e:ft(e||Pd),t=typeof t=="function"?t:ft(t===void 0?64:+t);function i(){let s;if(r||(r=s=a()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),s)return r=null,s+""||null}return i.type=function(s){return arguments.length?(e=typeof s=="function"?s:ft(s),i):e},i.size=function(s){return arguments.length?(t=typeof s=="function"?s:ft(+s),i):t},i.context=function(s){return arguments.length?(r=s??null,i):r},i}function Ks(){}function Gs(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function kg(e){this._context=e}kg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Gs(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Gs(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Ww(e){return new kg(e)}function Ag(e){this._context=e}Ag.prototype={areaStart:Ks,areaEnd:Ks,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Gs(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Bw(e){return new Ag(e)}function Cg(e){this._context=e}Cg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,a):this._context.moveTo(r,a);break;case 3:this._point=4;default:Gs(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Fw(e){return new Cg(e)}function Eg(e){this._context=e}Eg.prototype={areaStart:Ks,areaEnd:Ks,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function qw(e){return new Eg(e)}function ah(e){return e<0?-1:1}function ih(e,t,r){var a=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(a||i<0&&-0),o=(r-e._y1)/(i||a<0&&-0),l=(s*i+o*a)/(a+i);return(ah(s)+ah(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function sh(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function nc(e,t,r){var a=e._x0,i=e._y0,s=e._x1,o=e._y1,l=(s-a)/3;e._context.bezierCurveTo(a+l,i+l*t,s-l,o-l*r,s,o)}function Vs(e){this._context=e}Vs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:nc(this,this._t0,sh(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,nc(this,sh(this,r=ih(this,e,t)),r);break;default:nc(this,this._t0,r=ih(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function Pg(e){this._context=new Ig(e)}(Pg.prototype=Object.create(Vs.prototype)).point=function(e,t){Vs.prototype.point.call(this,t,e)};function Ig(e){this._context=e}Ig.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,a,i,s){this._context.bezierCurveTo(t,e,a,r,s,i)}};function Uw(e){return new Vs(e)}function Hw(e){return new Pg(e)}function Tg(e){this._context=e}Tg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var a=oh(e),i=oh(t),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(a[0][s],i[0][s],a[1][s],i[1][s],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function oh(e){var t,r=e.length-1,a,i=new Array(r),s=new Array(r),o=new Array(r);for(i[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,s[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)a=i[t]/s[t-1],s[t]-=a,o[t]-=a*o[t-1];for(i[r-1]=o[r-1]/s[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/s[t];for(s[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function Yw(e){return new Tg(e)}function qo(e,t){this._context=e,this._t=t}qo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function Kw(e){return new qo(e,.5)}function Gw(e){return new qo(e,0)}function Vw(e){return new qo(e,1)}function Ya(e,t){if((o=e.length)>1)for(var r=1,a,i,s=e[t[0]],o,l=s.length;r<o;++r)for(i=s,s=e[t[r]],a=0;a<l;++a)s[a][1]+=s[a][0]=isNaN(i[a][1])?i[a][0]:i[a][1]}function Tc(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Xw(e,t){return e[t]}function Qw(e){const t=[];return t.key=e,t}function Jw(){var e=ft([]),t=Tc,r=Ya,a=Xw;function i(s){var o=Array.from(e.apply(this,arguments),Qw),l,d=o.length,h=-1,u;for(const f of s)for(l=0,++h;l<d;++l)(o[l][h]=[0,+a(f,o[l].key,h,s)]).data=f;for(l=0,u=Ed(t(o));l<d;++l)o[u[l]].index=l;return r(o,u),o}return i.keys=function(s){return arguments.length?(e=typeof s=="function"?s:ft(Array.from(s)),i):e},i.value=function(s){return arguments.length?(a=typeof s=="function"?s:ft(+s),i):a},i.order=function(s){return arguments.length?(t=s==null?Tc:typeof s=="function"?s:ft(Array.from(s)),i):t},i.offset=function(s){return arguments.length?(r=s??Ya,i):r},i}function Zw(e,t){if((a=e.length)>0){for(var r,a,i=0,s=e[0].length,o;i<s;++i){for(o=r=0;r<a;++r)o+=e[r][i][1]||0;if(o)for(r=0;r<a;++r)e[r][i][1]/=o}Ya(e,t)}}function eS(e,t){if((i=e.length)>0){for(var r=0,a=e[t[0]],i,s=a.length;r<s;++r){for(var o=0,l=0;o<i;++o)l+=e[o][r][1]||0;a[r][1]+=a[r][0]=-l/2}Ya(e,t)}}function tS(e,t){if(!(!((o=e.length)>0)||!((s=(i=e[t[0]]).length)>0))){for(var r=0,a=1,i,s,o;a<s;++a){for(var l=0,d=0,h=0;l<o;++l){for(var u=e[t[l]],f=u[a][1]||0,m=u[a-1][1]||0,p=(f-m)/2,x=0;x<l;++x){var v=e[t[x]],g=v[a][1]||0,b=v[a-1][1]||0;p+=g-b}d+=f,h+=p*f}i[a-1][1]+=i[a-1][0]=r,d&&(r-=h/d)}i[a-1][1]+=i[a-1][0]=r,Ya(e,t)}}var Uo={},Og={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Og);var Id={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Id);var Ho={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var a;return typeof r=="string"||typeof r=="symbol"?r:Object.is((a=r==null?void 0:r.valueOf)==null?void 0:a.call(r),-0)?"-0":String(r)}e.toKey=t})(Ho);var Yo={},_g={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const a=String(r);return a==="0"&&Object.is(Number(r),-0)?"-0":a}e.toString=t})(_g);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_g,r=Ho;function a(i){if(Array.isArray(i))return i.map(r.toKey);if(typeof i=="symbol")return[i];i=t.toString(i);const s=[],o=i.length;if(o===0)return s;let l=0,d="",h="",u=!1;for(i.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=i[l];h?f==="\\"&&l+1<o?(l++,d+=i[l]):f===h?h="":d+=f:u?f==='"'||f==="'"?h=f:f==="]"?(u=!1,s.push(d),d=""):d+=f:f==="["?(u=!0,d&&(s.push(d),d="")):f==="."?d&&(s.push(d),d=""):d+=f,l++}return d&&s.push(d),s}e.toPath=a})(Yo);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Og,r=Id,a=Ho,i=Yo;function s(l,d,h){if(l==null)return h;switch(typeof d){case"string":{if(t.isUnsafeProperty(d))return h;const u=l[d];return u===void 0?r.isDeepKey(d)?s(l,i.toPath(d),h):h:u}case"number":case"symbol":{typeof d=="number"&&(d=a.toKey(d));const u=l[d];return u===void 0?h:u}default:{if(Array.isArray(d))return o(l,d,h);if(Object.is(d==null?void 0:d.valueOf(),-0)?d="-0":d=String(d),t.isUnsafeProperty(d))return h;const u=l[d];return u===void 0?h:u}}}function o(l,d,h){if(d.length===0)return h;let u=l;for(let f=0;f<d.length;f++){if(u==null||t.isUnsafeProperty(d[f]))return h;u=u[d[f]]}return u===void 0?h:u}e.get=s})(Uo);var nS=Uo.get;const ba=Vr(nS);var Zt=e=>e===0?0:e>0?1:-1,Jn=e=>typeof e=="number"&&e!=+e,Nr=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Me=e=>(typeof e=="number"||e instanceof Number)&&!Jn(e),cr=e=>Me(e)||typeof e=="string",rS=0,Oi=e=>{var t=++rS;return"".concat(e||"").concat(t)},un=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Me(t)&&typeof t!="string")return a;var s;if(Nr(t)){if(r==null)return a;var o=t.indexOf("%");s=r*parseFloat(t.slice(0,o))/100}else s=+t;return Jn(s)&&(s=a),i&&r!=null&&s>r&&(s=r),s},Dg=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},a=0;a<t;a++)if(!r[e[a]])r[e[a]]=!0;else return!0;return!1};function bt(e,t,r){return Me(e)&&Me(t)?e+r*(t-e):t}function Mg(e,t,r){if(!(!e||!e.length))return e.find(a=>a&&(typeof t=="function"?t(a):ba(a,t))===r)}var St=e=>e===null||typeof e>"u",Ui=e=>St(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function aS(e){return e!=null}function Ca(){}var iS=["type","size","sizeType"];function Oc(){return Oc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Oc.apply(null,arguments)}function lh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function ch(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lh(Object(r),!0).forEach(function(a){sS(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function sS(e,t,r){return(t=oS(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function oS(e){var t=lS(e,"string");return typeof t=="symbol"?t:t+""}function lS(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cS(e,t){if(e==null)return{};var r,a,i=dS(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function dS(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var $g={symbolCircle:Pd,symbolCross:Ew,symbolDiamond:Iw,symbolSquare:Tw,symbolStar:Mw,symbolTriangle:$w,symbolWye:Rw},uS=Math.PI/180,fS=e=>{var t="symbol".concat(Ui(e));return $g[t]||Pd},hS=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var a=18*uS;return 1.25*e*e*(Math.tan(a)-Math.tan(a*2)*Math.tan(a)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},mS=(e,t)=>{$g["symbol".concat(Ui(e))]=t},Lg=e=>{var{type:t="circle",size:r=64,sizeType:a="area"}=e,i=cS(e,iS),s=ch(ch({},i),{},{type:t,size:r,sizeType:a}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var m=fS(o),p=zw().type(m).size(hS(r,a,o)),x=p();if(x!==null)return x},{className:d,cx:h,cy:u}=s,f=yn(s);return Me(h)&&Me(u)&&Me(r)?c.createElement("path",Oc({},f,{className:nt("recharts-symbols",d),transform:"translate(".concat(h,", ").concat(u,")"),d:l()})):null};Lg.registerSymbol=mS;var Rg=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,Td=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(c.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var a={};return Object.keys(r).forEach(i=>{Ad(i)&&(a[i]=s=>r[i](r,s))}),a},pS=(e,t,r)=>a=>(e(t,r,a),null),Ko=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var a=null;return Object.keys(e).forEach(i=>{var s=e[i];Ad(i)&&typeof s=="function"&&(a||(a={}),a[i]=pS(s,t,r))}),a};function dh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function gS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dh(Object(r),!0).forEach(function(a){yS(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function yS(e,t,r){return(t=vS(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vS(e){var t=xS(e,"string");return typeof t=="symbol"?t:t+""}function xS(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tn(e,t){var r=gS({},e),a=t,i=Object.keys(t),s=i.reduce((o,l)=>(o[l]===void 0&&a[l]!==void 0&&(o[l]=a[l]),o),r);return s}var zg={},Wg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a){const i=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=a(o);i.has(l)||i.set(l,o)}return Array.from(i.values())}e.uniqBy=t})(Wg);var Od={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Od);var Bg={},Go={},Fg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Fg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fg;function r(a){return a!=null&&typeof a!="function"&&t.isLength(a.length)}e.isArrayLike=r})(Go);var qg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(qg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Go,r=qg;function a(i){return r.isObjectLike(i)&&t.isArrayLike(i)}e.isArrayLikeObject=a})(Bg);var Ug={},Hg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Uo;function r(a){return function(i){return t.get(i,a)}}e.property=r})(Hg);var Yg={},_d={},Kg={},Dd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Dd);var Md={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Md);var $d={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a){return r===a||Number.isNaN(r)&&Number.isNaN(a)}e.eq=t})($d);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Dd,r=Md,a=$d;function i(u,f,m){return typeof m!="function"?i(u,f,()=>{}):s(u,f,function p(x,v,g,b,y,N){const A=m(x,v,g,b,y,N);return A!==void 0?!!A:s(x,v,p,N)},new Map)}function s(u,f,m,p){if(f===u)return!0;switch(typeof f){case"object":return o(u,f,m,p);case"function":return Object.keys(f).length>0?s(u,{...f},m,p):a.eq(u,f);default:return t.isObject(u)?typeof f=="string"?f==="":!0:a.eq(u,f)}}function o(u,f,m,p){if(f==null)return!0;if(Array.isArray(f))return d(u,f,m,p);if(f instanceof Map)return l(u,f,m,p);if(f instanceof Set)return h(u,f,m,p);const x=Object.keys(f);if(u==null)return x.length===0;if(x.length===0)return!0;if(p!=null&&p.has(f))return p.get(f)===u;p==null||p.set(f,u);try{for(let v=0;v<x.length;v++){const g=x[v];if(!r.isPrimitive(u)&&!(g in u)||f[g]===void 0&&u[g]!==void 0||f[g]===null&&u[g]!==null||!m(u[g],f[g],g,u,f,p))return!1}return!0}finally{p==null||p.delete(f)}}function l(u,f,m,p){if(f.size===0)return!0;if(!(u instanceof Map))return!1;for(const[x,v]of f.entries()){const g=u.get(x);if(m(g,v,x,u,f,p)===!1)return!1}return!0}function d(u,f,m,p){if(f.length===0)return!0;if(!Array.isArray(u))return!1;const x=new Set;for(let v=0;v<f.length;v++){const g=f[v];let b=!1;for(let y=0;y<u.length;y++){if(x.has(y))continue;const N=u[y];let A=!1;if(m(N,g,v,u,f,p)&&(A=!0),A){x.add(y),b=!0;break}}if(!b)return!1}return!0}function h(u,f,m,p){return f.size===0?!0:u instanceof Set?d([...u],[...f],m,p):!1}e.isMatchWith=i,e.isSetMatch=h})(Kg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Kg;function r(a,i){return t.isMatchWith(a,i,()=>{})}e.isMatch=r})(_d);var Gg={},Ld={},Vg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(a=>Object.prototype.propertyIsEnumerable.call(r,a))}e.getSymbols=t})(Vg);var Rd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Rd);var zd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",a="[object Number]",i="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",d="[object Map]",h="[object Set]",u="[object Array]",f="[object Function]",m="[object ArrayBuffer]",p="[object Object]",x="[object Error]",v="[object DataView]",g="[object Uint8Array]",b="[object Uint8ClampedArray]",y="[object Uint16Array]",N="[object Uint32Array]",A="[object BigUint64Array]",E="[object Int8Array]",w="[object Int16Array]",P="[object Int32Array]",_="[object BigInt64Array]",$="[object Float32Array]",L="[object Float64Array]";e.argumentsTag=s,e.arrayBufferTag=m,e.arrayTag=u,e.bigInt64ArrayTag=_,e.bigUint64ArrayTag=A,e.booleanTag=i,e.dataViewTag=v,e.dateTag=l,e.errorTag=x,e.float32ArrayTag=$,e.float64ArrayTag=L,e.functionTag=f,e.int16ArrayTag=w,e.int32ArrayTag=P,e.int8ArrayTag=E,e.mapTag=d,e.numberTag=a,e.objectTag=p,e.regexpTag=t,e.setTag=h,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=y,e.uint32ArrayTag=N,e.uint8ArrayTag=g,e.uint8ClampedArrayTag=b})(zd);var Xg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(Xg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Vg,r=Rd,a=zd,i=Md,s=Xg;function o(u,f){return l(u,void 0,u,new Map,f)}function l(u,f,m,p=new Map,x=void 0){const v=x==null?void 0:x(u,f,m,p);if(v!==void 0)return v;if(i.isPrimitive(u))return u;if(p.has(u))return p.get(u);if(Array.isArray(u)){const g=new Array(u.length);p.set(u,g);for(let b=0;b<u.length;b++)g[b]=l(u[b],b,m,p,x);return Object.hasOwn(u,"index")&&(g.index=u.index),Object.hasOwn(u,"input")&&(g.input=u.input),g}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const g=new RegExp(u.source,u.flags);return g.lastIndex=u.lastIndex,g}if(u instanceof Map){const g=new Map;p.set(u,g);for(const[b,y]of u)g.set(b,l(y,b,m,p,x));return g}if(u instanceof Set){const g=new Set;p.set(u,g);for(const b of u)g.add(l(b,void 0,m,p,x));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(s.isTypedArray(u)){const g=new(Object.getPrototypeOf(u)).constructor(u.length);p.set(u,g);for(let b=0;b<u.length;b++)g[b]=l(u[b],b,m,p,x);return g}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const g=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return p.set(u,g),d(g,u,m,p,x),g}if(typeof File<"u"&&u instanceof File){const g=new File([u],u.name,{type:u.type});return p.set(u,g),d(g,u,m,p,x),g}if(typeof Blob<"u"&&u instanceof Blob){const g=new Blob([u],{type:u.type});return p.set(u,g),d(g,u,m,p,x),g}if(u instanceof Error){const g=new u.constructor;return p.set(u,g),g.message=u.message,g.name=u.name,g.stack=u.stack,g.cause=u.cause,d(g,u,m,p,x),g}if(u instanceof Boolean){const g=new Boolean(u.valueOf());return p.set(u,g),d(g,u,m,p,x),g}if(u instanceof Number){const g=new Number(u.valueOf());return p.set(u,g),d(g,u,m,p,x),g}if(u instanceof String){const g=new String(u.valueOf());return p.set(u,g),d(g,u,m,p,x),g}if(typeof u=="object"&&h(u)){const g=Object.create(Object.getPrototypeOf(u));return p.set(u,g),d(g,u,m,p,x),g}return u}function d(u,f,m=u,p,x){const v=[...Object.keys(f),...t.getSymbols(f)];for(let g=0;g<v.length;g++){const b=v[g],y=Object.getOwnPropertyDescriptor(u,b);(y==null||y.writable)&&(u[b]=l(f[b],b,m,p,x))}}function h(u){switch(r.getTag(u)){case a.argumentsTag:case a.arrayTag:case a.arrayBufferTag:case a.dataViewTag:case a.booleanTag:case a.dateTag:case a.float32ArrayTag:case a.float64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.mapTag:case a.numberTag:case a.objectTag:case a.regexpTag:case a.setTag:case a.stringTag:case a.symbolTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=d})(Ld);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ld;function r(a){return t.cloneDeepWithImpl(a,void 0,a,new Map,void 0)}e.cloneDeep=r})(Gg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_d,r=Gg;function a(i){return i=r.cloneDeep(i),s=>t.isMatch(s,i)}e.matches=a})(Yg);var Qg={},Jg={},Zg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ld,r=zd;function a(i,s){return t.cloneDeepWith(i,(o,l,d,h)=>{const u=s==null?void 0:s(o,l,d,h);if(u!==void 0)return u;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case r.numberTag:case r.stringTag:case r.booleanTag:{const f=new i.constructor(i==null?void 0:i.valueOf());return t.copyProperties(f,i),f}case r.argumentsTag:{const f={};return t.copyProperties(f,i),f.length=i.length,f[Symbol.iterator]=i[Symbol.iterator],f}default:return}})}e.cloneDeepWith=a})(Zg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Zg;function r(a){return t.cloneDeepWith(a)}e.cloneDeep=r})(Jg);var ey={},Wd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(a,i=Number.MAX_SAFE_INTEGER){switch(typeof a){case"number":return Number.isInteger(a)&&a>=0&&a<i;case"symbol":return!1;case"string":return t.test(a)}}e.isIndex=r})(Wd);var ty={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Rd;function r(a){return a!==null&&typeof a=="object"&&t.getTag(a)==="[object Arguments]"}e.isArguments=r})(ty);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Id,r=Wd,a=ty,i=Yo;function s(o,l){let d;if(Array.isArray(l)?d=l:typeof l=="string"&&t.isDeepKey(l)&&(o==null?void 0:o[l])==null?d=i.toPath(l):d=[l],d.length===0)return!1;let h=o;for(let u=0;u<d.length;u++){const f=d[u];if((h==null||!Object.hasOwn(h,f))&&!((Array.isArray(h)||a.isArguments(h))&&r.isIndex(f)&&f<h.length))return!1;h=h[f]}return!0}e.has=s})(ey);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_d,r=Ho,a=Jg,i=Uo,s=ey;function o(l,d){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return d=a.cloneDeep(d),function(h){const u=i.get(h,l);return u===void 0?s.has(h,l):d===void 0?u===void 0:t.isMatch(u,d)}}e.matchesProperty=o})(Qg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Od,r=Hg,a=Yg,i=Qg;function s(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?i.matchesProperty(o[0],o[1]):a.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=s})(Ug);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Wg,r=Od,a=Bg,i=Ug;function s(o,l=r.identity){return a.isArrayLikeObject(o)?t.uniqBy(Array.from(o),i.iteratee(l)):[]}e.uniqBy=s})(zg);var bS=zg.uniqBy;const uh=Vr(bS);function jS(e,t,r){return t===!0?uh(e,r):typeof t=="function"?uh(e,t):e}var ny={exports:{}},ry={},ay={exports:{}},iy={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ka=c;function wS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var SS=typeof Object.is=="function"?Object.is:wS,NS=Ka.useState,kS=Ka.useEffect,AS=Ka.useLayoutEffect,CS=Ka.useDebugValue;function ES(e,t){var r=t(),a=NS({inst:{value:r,getSnapshot:t}}),i=a[0].inst,s=a[1];return AS(function(){i.value=r,i.getSnapshot=t,rc(i)&&s({inst:i})},[e,r,t]),kS(function(){return rc(i)&&s({inst:i}),e(function(){rc(i)&&s({inst:i})})},[e]),CS(r),r}function rc(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!SS(e,r)}catch{return!0}}function PS(e,t){return t()}var IS=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?PS:ES;iy.useSyncExternalStore=Ka.useSyncExternalStore!==void 0?Ka.useSyncExternalStore:IS;ay.exports=iy;var TS=ay.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vo=c,OS=TS;function _S(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var DS=typeof Object.is=="function"?Object.is:_S,MS=OS.useSyncExternalStore,$S=Vo.useRef,LS=Vo.useEffect,RS=Vo.useMemo,zS=Vo.useDebugValue;ry.useSyncExternalStoreWithSelector=function(e,t,r,a,i){var s=$S(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=RS(function(){function d(p){if(!h){if(h=!0,u=p,p=a(p),i!==void 0&&o.hasValue){var x=o.value;if(i(x,p))return f=x}return f=p}if(x=f,DS(u,p))return x;var v=a(p);return i!==void 0&&i(x,v)?(u=p,x):(u=p,f=v)}var h=!1,u,f,m=r===void 0?null:r;return[function(){return d(t())},m===null?void 0:function(){return d(m())}]},[t,r,a,i]);var l=MS(e,s[0],s[1]);return LS(function(){o.hasValue=!0,o.value=l},[l]),zS(l),l};ny.exports=ry;var WS=ny.exports,Bd=c.createContext(null),BS=e=>e,Nt=()=>{var e=c.useContext(Bd);return e?e.store.dispatch:BS},Fs=()=>{},FS=()=>Fs,qS=(e,t)=>e===t;function $e(e){var t=c.useContext(Bd);return WS.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:FS,t?t.store.getState:Fs,t?t.store.getState:Fs,t?e:Fs,qS)}function US(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function HS(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function YS(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(a=>typeof a=="function"?`function ${a.name||"unnamed"}()`:typeof a).join(", ");throw new TypeError(`${t}[${r}]`)}}var fh=e=>Array.isArray(e)?e:[e];function KS(e){const t=Array.isArray(e[0])?e[0]:e;return YS(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function GS(e,t){const r=[],{length:a}=e;for(let i=0;i<a;i++)r.push(e[i].apply(null,t));return r}var VS=class{constructor(e){this.value=e}deref(){return this.value}},XS=typeof WeakRef<"u"?WeakRef:VS,QS=0,hh=1;function Cs(){return{s:QS,v:void 0,o:null,p:null}}function sy(e,t={}){let r=Cs();const{resultEqualityCheck:a}=t;let i,s=0;function o(){var f;let l=r;const{length:d}=arguments;for(let m=0,p=d;m<p;m++){const x=arguments[m];if(typeof x=="function"||typeof x=="object"&&x!==null){let v=l.o;v===null&&(l.o=v=new WeakMap);const g=v.get(x);g===void 0?(l=Cs(),v.set(x,l)):l=g}else{let v=l.p;v===null&&(l.p=v=new Map);const g=v.get(x);g===void 0?(l=Cs(),v.set(x,l)):l=g}}const h=l;let u;if(l.s===hh)u=l.v;else if(u=e.apply(null,arguments),s++,a){const m=((f=i==null?void 0:i.deref)==null?void 0:f.call(i))??i;m!=null&&a(m,u)&&(u=m,s!==0&&s--),i=typeof u=="object"&&u!==null||typeof u=="function"?new XS(u):u}return h.s=hh,h.v=u,u}return o.clearCache=()=>{r=Cs(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function JS(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,a=(...i)=>{let s=0,o=0,l,d={},h=i.pop();typeof h=="object"&&(d=h,h=i.pop()),US(h,`createSelector expects an output function after the inputs, but received: [${typeof h}]`);const u={...r,...d},{memoize:f,memoizeOptions:m=[],argsMemoize:p=sy,argsMemoizeOptions:x=[]}=u,v=fh(m),g=fh(x),b=KS(i),y=f(function(){return s++,h.apply(null,arguments)},...v),N=p(function(){o++;const E=GS(b,arguments);return l=y.apply(null,E),l},...g);return Object.assign(N,{resultFunc:h,memoizedResultFunc:y,dependencies:b,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:p})};return Object.assign(a,{withTypes:()=>a}),a}var pe=JS(sy),ZS=Object.assign((e,t=pe)=>{HS(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),a=r.map(s=>e[s]);return t(a,(...s)=>s.reduce((o,l,d)=>(o[r[d]]=l,o),{}))},{withTypes:()=>ZS}),oy={},ly={},cy={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(a){return typeof a=="symbol"?1:a===null?2:a===void 0?3:a!==a?4:0}const r=(a,i,s)=>{if(a!==i){const o=t(a),l=t(i);if(o===l&&o===0){if(a<i)return s==="desc"?1:-1;if(a>i)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};e.compareValues=r})(cy);var dy={},Fd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(Fd);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fd,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function i(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||t.isSymbol(s)?!0:typeof s=="string"&&(a.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}e.isKey=i})(dy);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cy,r=dy,a=Yo;function i(s,o,l,d){if(s==null)return[];l=d?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(p=>String(p));const h=(p,x)=>{let v=p;for(let g=0;g<x.length&&v!=null;++g)v=v[x[g]];return v},u=(p,x)=>x==null||p==null?x:typeof p=="object"&&"key"in p?Object.hasOwn(x,p.key)?x[p.key]:h(x,p.path):typeof p=="function"?p(x):Array.isArray(p)?h(x,p):typeof x=="object"?x[p]:x,f=o.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:a.toPath(p)}));return s.map(p=>({original:p,criteria:f.map(x=>u(x,p))})).slice().sort((p,x)=>{for(let v=0;v<f.length;v++){const g=t.compareValues(p.criteria[v],x.criteria[v],l[v]);if(g!==0)return g}return 0}).map(p=>p.original)}e.orderBy=i})(ly);var uy={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a=1){const i=[],s=Math.floor(a),o=(l,d)=>{for(let h=0;h<l.length;h++){const u=l[h];Array.isArray(u)&&d<s?o(u,d+1):i.push(u)}};return o(r,0),i}e.flatten=t})(uy);var qd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Wd,r=Go,a=Dd,i=$d;function s(o,l,d){return a.isObject(d)&&(typeof l=="number"&&r.isArrayLike(d)&&t.isIndex(l)&&l<d.length||typeof l=="string"&&l in d)?i.eq(d[l],o):!1}e.isIterateeCall=s})(qd);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ly,r=uy,a=qd;function i(s,...o){const l=o.length;return l>1&&a.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&a.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(s,r.flatten(o),["asc"])}e.sortBy=i})(oy);var eN=oy.sortBy;const Xo=Vr(eN);var fy=e=>e.legend.settings,tN=e=>e.legend.size,nN=e=>e.legend.payload;pe([nN,fy],(e,t)=>{var{itemSorter:r}=t,a=e.flat(1);return r?Xo(a,r):a});var Es=1;function rN(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=c.useState({height:0,left:0,top:0,width:0}),a=c.useCallback(i=>{if(i!=null){var s=i.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-t.height)>Es||Math.abs(o.left-t.left)>Es||Math.abs(o.top-t.top)>Es||Math.abs(o.width-t.width)>Es)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,a]}function sn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var aN=typeof Symbol=="function"&&Symbol.observable||"@@observable",mh=aN,ac=()=>Math.random().toString(36).substring(7).split("").join("."),iN={INIT:`@@redux/INIT${ac()}`,REPLACE:`@@redux/REPLACE${ac()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${ac()}`},Xs=iN;function Ud(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function hy(e,t,r){if(typeof e!="function")throw new Error(sn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(sn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(sn(1));return r(hy)(e,t)}let a=e,i=t,s=new Map,o=s,l=0,d=!1;function h(){o===s&&(o=new Map,s.forEach((g,b)=>{o.set(b,g)}))}function u(){if(d)throw new Error(sn(3));return i}function f(g){if(typeof g!="function")throw new Error(sn(4));if(d)throw new Error(sn(5));let b=!0;h();const y=l++;return o.set(y,g),function(){if(b){if(d)throw new Error(sn(6));b=!1,h(),o.delete(y),s=null}}}function m(g){if(!Ud(g))throw new Error(sn(7));if(typeof g.type>"u")throw new Error(sn(8));if(typeof g.type!="string")throw new Error(sn(17));if(d)throw new Error(sn(9));try{d=!0,i=a(i,g)}finally{d=!1}return(s=o).forEach(y=>{y()}),g}function p(g){if(typeof g!="function")throw new Error(sn(10));a=g,m({type:Xs.REPLACE})}function x(){const g=f;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(sn(11));function y(){const A=b;A.next&&A.next(u())}return y(),{unsubscribe:g(y)}},[mh](){return this}}}return m({type:Xs.INIT}),{dispatch:m,subscribe:f,getState:u,replaceReducer:p,[mh]:x}}function sN(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Xs.INIT})>"u")throw new Error(sn(12));if(typeof r(void 0,{type:Xs.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(sn(13))})}function my(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const o=t[s];typeof e[o]=="function"&&(r[o]=e[o])}const a=Object.keys(r);let i;try{sN(r)}catch(s){i=s}return function(o={},l){if(i)throw i;let d=!1;const h={};for(let u=0;u<a.length;u++){const f=a[u],m=r[f],p=o[f],x=m(p,l);if(typeof x>"u")throw l&&l.type,new Error(sn(14));h[f]=x,d=d||x!==p}return d=d||a.length!==Object.keys(o).length,d?h:o}}function Qs(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...a)=>t(r(...a)))}function oN(...e){return t=>(r,a)=>{const i=t(r,a);let s=()=>{throw new Error(sn(15))};const o={getState:i.getState,dispatch:(d,...h)=>s(d,...h)},l=e.map(d=>d(o));return s=Qs(...l)(i.dispatch),{...i,dispatch:s}}}function py(e){return Ud(e)&&"type"in e&&typeof e.type=="string"}var gy=Symbol.for("immer-nothing"),ph=Symbol.for("immer-draftable"),Dn=Symbol.for("immer-state");function Xn(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var _i=Object.getPrototypeOf;function ja(e){return!!e&&!!e[Dn]}function kr(e){var t;return e?yy(e)||Array.isArray(e)||!!e[ph]||!!((t=e.constructor)!=null&&t[ph])||Hi(e)||Jo(e):!1}var lN=Object.prototype.constructor.toString(),gh=new WeakMap;function yy(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let a=gh.get(r);return a===void 0&&(a=Function.toString.call(r),gh.set(r,a)),a===lN}function Js(e,t,r=!0){Qo(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((a,i)=>t(i,a,e))}function Qo(e){const t=e[Dn];return t?t.type_:Array.isArray(e)?1:Hi(e)?2:Jo(e)?3:0}function _c(e,t){return Qo(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function vy(e,t,r){const a=Qo(e);a===2?e.set(t,r):a===3?e.add(r):e[t]=r}function cN(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Hi(e){return e instanceof Map}function Jo(e){return e instanceof Set}function la(e){return e.copy_||e.base_}function Dc(e,t){if(Hi(e))return new Map(e);if(Jo(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=yy(e);if(t===!0||t==="class_only"&&!r){const a=Object.getOwnPropertyDescriptors(e);delete a[Dn];let i=Reflect.ownKeys(a);for(let s=0;s<i.length;s++){const o=i[s],l=a[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(a[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(_i(e),a)}else{const a=_i(e);if(a!==null&&r)return{...e};const i=Object.create(a);return Object.assign(i,e)}}function Hd(e,t=!1){return Zo(e)||ja(e)||!kr(e)||(Qo(e)>1&&Object.defineProperties(e,{set:Ps,add:Ps,clear:Ps,delete:Ps}),Object.freeze(e),t&&Object.values(e).forEach(r=>Hd(r,!0))),e}function dN(){Xn(2)}var Ps={value:dN};function Zo(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var uN={};function wa(e){const t=uN[e];return t||Xn(0,e),t}var Di;function xy(){return Di}function fN(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function yh(e,t){t&&(wa("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Mc(e){$c(e),e.drafts_.forEach(hN),e.drafts_=null}function $c(e){e===Di&&(Di=e.parent_)}function vh(e){return Di=fN(Di,e)}function hN(e){const t=e[Dn];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function xh(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Dn].modified_&&(Mc(t),Xn(4)),kr(e)&&(e=Zs(t,e),t.parent_||eo(t,e)),t.patches_&&wa("Patches").generateReplacementPatches_(r[Dn].base_,e,t.patches_,t.inversePatches_)):e=Zs(t,r,[]),Mc(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==gy?e:void 0}function Zs(e,t,r){if(Zo(t))return t;const a=e.immer_.shouldUseStrictIteration(),i=t[Dn];if(!i)return Js(t,(s,o)=>bh(e,i,t,s,o,r),a),t;if(i.scope_!==e)return t;if(!i.modified_)return eo(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let o=s,l=!1;i.type_===3&&(o=new Set(s),s.clear(),l=!0),Js(o,(d,h)=>bh(e,i,s,d,h,r,l),a),eo(e,s,!1),r&&e.patches_&&wa("Patches").generatePatches_(i,r,e.patches_,e.inversePatches_)}return i.copy_}function bh(e,t,r,a,i,s,o){if(i==null||typeof i!="object"&&!o)return;const l=Zo(i);if(!(l&&!o)){if(ja(i)){const d=s&&t&&t.type_!==3&&!_c(t.assigned_,a)?s.concat(a):void 0,h=Zs(e,i,d);if(vy(r,a,h),ja(h))e.canAutoFreeze_=!1;else return}else o&&r.add(i);if(kr(i)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[a]===i&&l)return;Zs(e,i),(!t||!t.scope_.parent_)&&typeof a!="symbol"&&(Hi(r)?r.has(a):Object.prototype.propertyIsEnumerable.call(r,a))&&eo(e,i)}}}function eo(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Hd(t,r)}function mN(e,t){const r=Array.isArray(e),a={type_:r?1:0,scope_:t?t.scope_:xy(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=a,s=Yd;r&&(i=[a],s=Mi);const{revoke:o,proxy:l}=Proxy.revocable(i,s);return a.draft_=l,a.revoke_=o,l}var Yd={get(e,t){if(t===Dn)return e;const r=la(e);if(!_c(r,t))return pN(e,r,t);const a=r[t];return e.finalized_||!kr(a)?a:a===ic(e.base_,t)?(sc(e),e.copy_[t]=Rc(a,e)):a},has(e,t){return t in la(e)},ownKeys(e){return Reflect.ownKeys(la(e))},set(e,t,r){const a=by(la(e),t);if(a!=null&&a.set)return a.set.call(e.draft_,r),!0;if(!e.modified_){const i=ic(la(e),t),s=i==null?void 0:i[Dn];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(cN(r,i)&&(r!==void 0||_c(e.base_,t)))return!0;sc(e),Lc(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return ic(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,sc(e),Lc(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=la(e),a=Reflect.getOwnPropertyDescriptor(r,t);return a&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:a.enumerable,value:r[t]}},defineProperty(){Xn(11)},getPrototypeOf(e){return _i(e.base_)},setPrototypeOf(){Xn(12)}},Mi={};Js(Yd,(e,t)=>{Mi[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Mi.deleteProperty=function(e,t){return Mi.set.call(this,e,t,void 0)};Mi.set=function(e,t,r){return Yd.set.call(this,e[0],t,r,e[0])};function ic(e,t){const r=e[Dn];return(r?la(r):e)[t]}function pN(e,t,r){var i;const a=by(t,r);return a?"value"in a?a.value:(i=a.get)==null?void 0:i.call(e.draft_):void 0}function by(e,t){if(!(t in e))return;let r=_i(e);for(;r;){const a=Object.getOwnPropertyDescriptor(r,t);if(a)return a;r=_i(r)}}function Lc(e){e.modified_||(e.modified_=!0,e.parent_&&Lc(e.parent_))}function sc(e){e.copy_||(e.copy_=Dc(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var gN=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,a)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const o=this;return function(d=s,...h){return o.produce(d,u=>r.call(this,u,...h))}}typeof r!="function"&&Xn(6),a!==void 0&&typeof a!="function"&&Xn(7);let i;if(kr(t)){const s=vh(this),o=Rc(t,void 0);let l=!0;try{i=r(o),l=!1}finally{l?Mc(s):$c(s)}return yh(s,a),xh(i,s)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===gy&&(i=void 0),this.autoFreeze_&&Hd(i,!0),a){const s=[],o=[];wa("Patches").generateReplacementPatches_(t,i,s,o),a(s,o)}return i}else Xn(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,d=>t(d,...l));let a,i;return[this.produce(t,r,(o,l)=>{a=o,i=l}),a,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){kr(e)||Xn(8),ja(e)&&(e=wr(e));const t=vh(this),r=Rc(e,void 0);return r[Dn].isManual_=!0,$c(t),r}finishDraft(e,t){const r=e&&e[Dn];(!r||!r.isManual_)&&Xn(9);const{scope_:a}=r;return yh(a,t),xh(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const a=wa("Patches").applyPatches_;return ja(e)?a(e,t):this.produce(e,i=>a(i,t))}};function Rc(e,t){const r=Hi(e)?wa("MapSet").proxyMap_(e,t):Jo(e)?wa("MapSet").proxySet_(e,t):mN(e,t);return(t?t.scope_:xy()).drafts_.push(r),r}function wr(e){return ja(e)||Xn(10,e),jy(e)}function jy(e){if(!kr(e)||Zo(e))return e;const t=e[Dn];let r,a=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Dc(e,t.scope_.immer_.useStrictShallowCopy_),a=t.scope_.immer_.shouldUseStrictIteration()}else r=Dc(e,!0);return Js(r,(i,s)=>{vy(r,i,jy(s))},a),t&&(t.finalized_=!1),r}var zc=new gN,wy=zc.produce,yN=zc.setUseStrictIteration.bind(zc);function Sy(e){return({dispatch:r,getState:a})=>i=>s=>typeof s=="function"?s(r,a,e):i(s)}var vN=Sy(),xN=Sy,bN=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Qs:Qs.apply(null,arguments)};function Fn(e,t){function r(...a){if(t){let i=t(...a);if(!i)throw new Error(On(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:a[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=a=>py(a)&&a.type===e,r}var Ny=class ki extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,ki.prototype)}static get[Symbol.species](){return ki}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new ki(...t[0].concat(this)):new ki(...t.concat(this))}};function jh(e){return kr(e)?wy(e,()=>{}):e}function Is(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function jN(e){return typeof e=="boolean"}var wN=()=>function(t){const{thunk:r=!0,immutableCheck:a=!0,serializableCheck:i=!0,actionCreatorCheck:s=!0}=t??{};let o=new Ny;return r&&(jN(r)?o.push(vN):o.push(xN(r.extraArgument))),o},ky="RTK_autoBatch",Ht=()=>e=>({payload:e,meta:{[ky]:!0}}),wh=e=>t=>{setTimeout(t,e)},Ay=(e={type:"raf"})=>t=>(...r)=>{const a=t(...r);let i=!0,s=!1,o=!1;const l=new Set,d=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:wh(10):e.type==="callback"?e.queueNotification:wh(e.timeout),h=()=>{o=!1,s&&(s=!1,l.forEach(u=>u()))};return Object.assign({},a,{subscribe(u){const f=()=>i&&u(),m=a.subscribe(f);return l.add(u),()=>{m(),l.delete(u)}},dispatch(u){var f;try{return i=!((f=u==null?void 0:u.meta)!=null&&f[ky]),s=!i,s&&(o||(o=!0,d(h))),a.dispatch(u)}finally{i=!0}}})},SN=e=>function(r){const{autoBatch:a=!0}=r??{};let i=new Ny(e);return a&&i.push(Ay(typeof a=="object"?a:void 0)),i};function NN(e){const t=wN(),{reducer:r=void 0,middleware:a,devTools:i=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(Ud(r))l=my(r);else throw new Error(On(1));let d;typeof a=="function"?d=a(t):d=t();let h=Qs;i&&(h=bN({trace:!1,...typeof i=="object"&&i}));const u=oN(...d),f=SN(u);let m=typeof o=="function"?o(f):f();const p=h(...m);return hy(l,s,p)}function Cy(e){const t={},r=[];let a;const i={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(On(28));if(l in t)throw new Error(On(29));return t[l]=o,i},addAsyncThunk(s,o){return o.pending&&(t[s.pending.type]=o.pending),o.rejected&&(t[s.rejected.type]=o.rejected),o.fulfilled&&(t[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),i},addMatcher(s,o){return r.push({matcher:s,reducer:o}),i},addDefaultCase(s){return a=s,i}};return e(i),[t,r,a]}yN(!1);function kN(e){return typeof e=="function"}function AN(e,t){let[r,a,i]=Cy(t),s;if(kN(e))s=()=>jh(e());else{const l=jh(e);s=()=>l}function o(l=s(),d){let h=[r[d.type],...a.filter(({matcher:u})=>u(d)).map(({reducer:u})=>u)];return h.filter(u=>!!u).length===0&&(h=[i]),h.reduce((u,f)=>{if(f)if(ja(u)){const p=f(u,d);return p===void 0?u:p}else{if(kr(u))return wy(u,m=>f(m,d));{const m=f(u,d);if(m===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return u},l)}return o.getInitialState=s,o}var CN="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",EN=(e=21)=>{let t="",r=e;for(;r--;)t+=CN[Math.random()*64|0];return t},PN=Symbol.for("rtk-slice-createasyncthunk");function IN(e,t){return`${e}/${t}`}function TN({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[PN];return function(i){const{name:s,reducerPath:o=s}=i;if(!s)throw new Error(On(11));const l=(typeof i.reducers=="function"?i.reducers(_N()):i.reducers)||{},d=Object.keys(l),h={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(A,E){const w=typeof A=="string"?A:A.type;if(!w)throw new Error(On(12));if(w in h.sliceCaseReducersByType)throw new Error(On(13));return h.sliceCaseReducersByType[w]=E,u},addMatcher(A,E){return h.sliceMatchers.push({matcher:A,reducer:E}),u},exposeAction(A,E){return h.actionCreators[A]=E,u},exposeCaseReducer(A,E){return h.sliceCaseReducersByName[A]=E,u}};d.forEach(A=>{const E=l[A],w={reducerName:A,type:IN(s,A),createNotation:typeof i.reducers=="function"};MN(E)?LN(w,E,u,t):DN(w,E,u)});function f(){const[A={},E=[],w=void 0]=typeof i.extraReducers=="function"?Cy(i.extraReducers):[i.extraReducers],P={...A,...h.sliceCaseReducersByType};return AN(i.initialState,_=>{for(let $ in P)_.addCase($,P[$]);for(let $ of h.sliceMatchers)_.addMatcher($.matcher,$.reducer);for(let $ of E)_.addMatcher($.matcher,$.reducer);w&&_.addDefaultCase(w)})}const m=A=>A,p=new Map,x=new WeakMap;let v;function g(A,E){return v||(v=f()),v(A,E)}function b(){return v||(v=f()),v.getInitialState()}function y(A,E=!1){function w(_){let $=_[A];return typeof $>"u"&&E&&($=Is(x,w,b)),$}function P(_=m){const $=Is(p,E,()=>new WeakMap);return Is($,_,()=>{const L={};for(const[j,S]of Object.entries(i.selectors??{}))L[j]=ON(S,_,()=>Is(x,_,b),E);return L})}return{reducerPath:A,getSelectors:P,get selectors(){return P(w)},selectSlice:w}}const N={name:s,reducer:g,actions:h.actionCreators,caseReducers:h.sliceCaseReducersByName,getInitialState:b,...y(o),injectInto(A,{reducerPath:E,...w}={}){const P=E??o;return A.inject({reducerPath:P,reducer:g},w),{...N,...y(P,!0)}}};return N}}function ON(e,t,r,a){function i(s,...o){let l=t(s);return typeof l>"u"&&a&&(l=r()),e(l,...o)}return i.unwrapped=e,i}var Nn=TN();function _N(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function DN({type:e,reducerName:t,createNotation:r},a,i){let s,o;if("reducer"in a){if(r&&!$N(a))throw new Error(On(17));s=a.reducer,o=a.prepare}else s=a;i.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?Fn(e,o):Fn(e))}function MN(e){return e._reducerDefinitionType==="asyncThunk"}function $N(e){return e._reducerDefinitionType==="reducerWithPrepare"}function LN({type:e,reducerName:t},r,a,i){if(!i)throw new Error(On(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:d,settled:h,options:u}=r,f=i(e,s,u);a.exposeAction(t,f),o&&a.addCase(f.fulfilled,o),l&&a.addCase(f.pending,l),d&&a.addCase(f.rejected,d),h&&a.addMatcher(f.settled,h),a.exposeCaseReducer(t,{fulfilled:o||Ts,pending:l||Ts,rejected:d||Ts,settled:h||Ts})}function Ts(){}var RN="task",Ey="listener",Py="completed",Kd="cancelled",zN=`task-${Kd}`,WN=`task-${Py}`,Wc=`${Ey}-${Kd}`,BN=`${Ey}-${Py}`,el=class{constructor(e){Yl(this,"name","TaskAbortError");Yl(this,"message");this.code=e,this.message=`${RN} ${Kd} (reason: ${e})`}},Gd=(e,t)=>{if(typeof e!="function")throw new TypeError(On(32))},to=()=>{},Iy=(e,t=to)=>(e.catch(t),e),Ty=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),ha=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},ma=e=>{if(e.aborted){const{reason:t}=e;throw new el(t)}};function Oy(e,t){let r=to;return new Promise((a,i)=>{const s=()=>i(new el(e.reason));if(e.aborted){s();return}r=Ty(e,s),t.finally(()=>r()).then(a,i)}).finally(()=>{r=to})}var FN=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof el?"cancelled":"rejected",error:r}}finally{t==null||t()}},no=e=>t=>Iy(Oy(e,t).then(r=>(ma(e),r))),_y=e=>{const t=no(e);return r=>t(new Promise(a=>setTimeout(a,r)))},{assign:Ua}=Object,Sh={},tl="listenerMiddleware",qN=(e,t)=>{const r=a=>Ty(e,()=>ha(a,e.reason));return(a,i)=>{Gd(a);const s=new AbortController;r(s);const o=FN(async()=>{ma(e),ma(s.signal);const l=await a({pause:no(s.signal),delay:_y(s.signal),signal:s.signal});return ma(s.signal),l},()=>ha(s,WN));return i!=null&&i.autoJoin&&t.push(o.catch(to)),{result:no(e)(o),cancel(){ha(s,zN)}}}},UN=(e,t)=>{const r=async(a,i)=>{ma(t);let s=()=>{};const l=[new Promise((d,h)=>{let u=e({predicate:a,effect:(f,m)=>{m.unsubscribe(),d([f,m.getState(),m.getOriginalState()])}});s=()=>{u(),h()}})];i!=null&&l.push(new Promise(d=>setTimeout(d,i,null)));try{const d=await Oy(t,Promise.race(l));return ma(t),d}finally{s()}};return(a,i)=>Iy(r(a,i))},Dy=e=>{let{type:t,actionCreator:r,matcher:a,predicate:i,effect:s}=e;if(t)i=Fn(t).match;else if(r)t=r.type,i=r.match;else if(a)i=a;else if(!i)throw new Error(On(21));return Gd(s),{predicate:i,type:t,effect:s}},My=Ua(e=>{const{type:t,predicate:r,effect:a}=Dy(e);return{id:EN(),effect:a,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(On(22))}}},{withTypes:()=>My}),Nh=(e,t)=>{const{type:r,effect:a,predicate:i}=Dy(t);return Array.from(e.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===i)&&s.effect===a)},Bc=e=>{e.pending.forEach(t=>{ha(t,Wc)})},HN=(e,t)=>()=>{for(const r of t.keys())Bc(r);e.clear()},kh=(e,t,r)=>{try{e(t,r)}catch(a){setTimeout(()=>{throw a},0)}},$y=Ua(Fn(`${tl}/add`),{withTypes:()=>$y}),YN=Fn(`${tl}/removeAll`),Ly=Ua(Fn(`${tl}/remove`),{withTypes:()=>Ly}),KN=(...e)=>{console.error(`${tl}/error`,...e)},Yi=(e={})=>{const t=new Map,r=new Map,a=p=>{const x=r.get(p)??0;r.set(p,x+1)},i=p=>{const x=r.get(p)??1;x===1?r.delete(p):r.set(p,x-1)},{extra:s,onError:o=KN}=e;Gd(o);const l=p=>(p.unsubscribe=()=>t.delete(p.id),t.set(p.id,p),x=>{p.unsubscribe(),x!=null&&x.cancelActive&&Bc(p)}),d=p=>{const x=Nh(t,p)??My(p);return l(x)};Ua(d,{withTypes:()=>d});const h=p=>{const x=Nh(t,p);return x&&(x.unsubscribe(),p.cancelActive&&Bc(x)),!!x};Ua(h,{withTypes:()=>h});const u=async(p,x,v,g)=>{const b=new AbortController,y=UN(d,b.signal),N=[];try{p.pending.add(b),a(p),await Promise.resolve(p.effect(x,Ua({},v,{getOriginalState:g,condition:(A,E)=>y(A,E).then(Boolean),take:y,delay:_y(b.signal),pause:no(b.signal),extra:s,signal:b.signal,fork:qN(b.signal,N),unsubscribe:p.unsubscribe,subscribe:()=>{t.set(p.id,p)},cancelActiveListeners:()=>{p.pending.forEach((A,E,w)=>{A!==b&&(ha(A,Wc),w.delete(A))})},cancel:()=>{ha(b,Wc),p.pending.delete(b)},throwIfCancelled:()=>{ma(b.signal)}})))}catch(A){A instanceof el||kh(o,A,{raisedBy:"effect"})}finally{await Promise.all(N),ha(b,BN),i(p),p.pending.delete(b)}},f=HN(t,r);return{middleware:p=>x=>v=>{if(!py(v))return x(v);if($y.match(v))return d(v.payload);if(YN.match(v)){f();return}if(Ly.match(v))return h(v.payload);let g=p.getState();const b=()=>{if(g===Sh)throw new Error(On(23));return g};let y;try{if(y=x(v),t.size>0){const N=p.getState(),A=Array.from(t.values());for(const E of A){let w=!1;try{w=E.predicate(v,N,g)}catch(P){w=!1,kh(o,P,{raisedBy:"predicate"})}w&&u(E,v,p,b)}}}finally{g=Sh}return y},startListening:d,stopListening:h,clearListeners:f}};function On(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var GN={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},Ry=Nn({name:"chartLayout",initialState:GN,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,a,i,s;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(a=t.payload.right)!==null&&a!==void 0?a:0,e.margin.bottom=(i=t.payload.bottom)!==null&&i!==void 0?i:0,e.margin.left=(s=t.payload.left)!==null&&s!==void 0?s:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:VN,setLayout:XN,setChartSize:QN,setScale:JN}=Ry.actions,ZN=Ry.reducer;function zy(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Ah(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Fa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ah(Object(r),!0).forEach(function(a){e2(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ah(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function e2(e,t,r){return(t=t2(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t2(e){var t=n2(e,"string");return typeof t=="symbol"?t:t+""}function n2(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ht(e,t,r){return St(e)||St(t)?r:cr(t)?ba(e,t,r):typeof t=="function"?t(e):r}var r2=(e,t,r)=>{if(t&&r){var{width:a,height:i}=r,{align:s,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&Me(e[s]))return Fa(Fa({},e),{},{[s]:e[s]+(a||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&Me(e[o]))return Fa(Fa({},e),{},{[o]:e[o]+(i||0)})}return e},Xr=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",Wy=(e,t,r,a)=>{if(a)return e.map(l=>l.coordinate);var i,s,o=e.map(l=>(l.coordinate===t&&(i=!0),l.coordinate===r&&(s=!0),l.coordinate));return i||o.push(t),s||o.push(r),o},By=(e,t,r)=>{if(!e)return null;var{duplicateDomain:a,type:i,range:s,scale:o,realScaleType:l,isCategorical:d,categoricalDomain:h,tickCount:u,ticks:f,niceTicks:m,axisType:p}=e;if(!o)return null;var x=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,v=i==="category"&&o.bandwidth?o.bandwidth()/x:0;if(v=p==="angleAxis"&&s&&s.length>=2?Zt(s[0]-s[1])*2*v:v,f||m){var g=(f||m||[]).map((b,y)=>{var N=a?a.indexOf(b):b;return{coordinate:o(N)+v,value:b,offset:v,index:y}});return g.filter(b=>!Jn(b.coordinate))}return d&&h?h.map((b,y)=>({coordinate:o(b)+v,value:b,index:y,offset:v})):o.ticks&&u!=null?o.ticks(u).map((b,y)=>({coordinate:o(b)+v,value:b,offset:v,index:y})):o.domain().map((b,y)=>({coordinate:o(b)+v,value:a?a[b]:b,index:y,offset:v}))},Ch=1e-4,a2=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,a=e.range(),i=Math.min(a[0],a[1])-Ch,s=Math.max(a[0],a[1])+Ch,o=e(t[0]),l=e(t[r-1]);(o<i||o>s||l<i||l>s)&&e.domain([t[0],t[r-1]])}},i2=(e,t)=>{if(!t||t.length!==2||!Me(t[0])||!Me(t[1]))return e;var r=Math.min(t[0],t[1]),a=Math.max(t[0],t[1]),i=[e[0],e[1]];return(!Me(e[0])||e[0]<r)&&(i[0]=r),(!Me(e[1])||e[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<r&&(i[1]=r),i},s2=e=>{var t=e.length;if(!(t<=0))for(var r=0,a=e[0].length;r<a;++r)for(var i=0,s=0,o=0;o<t;++o){var l=Jn(e[o][r][1])?e[o][r][0]:e[o][r][1];l>=0?(e[o][r][0]=i,e[o][r][1]=i+l,i=e[o][r][1]):(e[o][r][0]=s,e[o][r][1]=s+l,s=e[o][r][1])}},o2=e=>{var t=e.length;if(!(t<=0))for(var r=0,a=e[0].length;r<a;++r)for(var i=0,s=0;s<t;++s){var o=Jn(e[s][r][1])?e[s][r][0]:e[s][r][1];o>=0?(e[s][r][0]=i,e[s][r][1]=i+o,i=e[s][r][1]):(e[s][r][0]=0,e[s][r][1]=0)}},l2={sign:s2,expand:Zw,none:Ya,silhouette:eS,wiggle:tS,positive:o2},c2=(e,t,r)=>{var a=l2[r],i=Jw().keys(t).value((s,o)=>Number(ht(s,o,0))).order(Tc).offset(a);return i(e)};function d2(e){return e==null?void 0:String(e)}function Eh(e){var{axis:t,ticks:r,bandSize:a,entry:i,index:s,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!St(i[t.dataKey])){var l=Mg(r,"value",i[t.dataKey]);if(l)return l.coordinate+a/2}return r[s]?r[s].coordinate+a/2:null}var d=ht(i,St(o)?t.dataKey:o);return St(d)?null:t.scale(d)}var Ph=e=>{var{axis:t,ticks:r,offset:a,bandSize:i,entry:s,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+a:null;var l=ht(s,t.dataKey,t.scale.domain()[o]);return St(l)?null:t.scale(l)-i/2+a},u2=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var a=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return a<=0&&i>=0?0:i<0?i:a}return r[0]},f2=e=>{var t=e.flat(2).filter(Me);return[Math.min(...t),Math.max(...t)]},h2=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],m2=(e,t,r)=>{if(e!=null)return h2(Object.keys(e).reduce((a,i)=>{var s=e[i],{stackedData:o}=s,l=o.reduce((d,h)=>{var u=zy(h,t,r),f=f2(u);return[Math.min(d[0],f[0]),Math.max(d[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],a[0]),Math.max(l[1],a[1])]},[1/0,-1/0]))},Ih=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Th=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ga=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var a=e.scale.bandwidth();if(!r||a>0)return a}if(e&&t&&t.length>=2){for(var i=Xo(t,u=>u.coordinate),s=1/0,o=1,l=i.length;o<l;o++){var d=i[o],h=i[o-1];s=Math.min((d.coordinate||0)-(h.coordinate||0),s)}return s===1/0?0:s}return r?void 0:0};function Oh(e){var{tooltipEntrySettings:t,dataKey:r,payload:a,value:i,name:s}=e;return Fa(Fa({},t),{},{dataKey:r,payload:a,value:i,name:s})}function Za(e,t){if(e)return String(e);if(typeof t=="string")return t}var p2=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},g2=(e,t)=>t==="centric"?e.angle:e.radius,Tr=e=>e.layout.width,Or=e=>e.layout.height,y2=e=>e.layout.scale,Fy=e=>e.layout.margin,nl=pe(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),rl=pe(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),qy="data-recharts-item-index",Uy="data-recharts-item-data-key",Ki=60;function _h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Os(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_h(Object(r),!0).forEach(function(a){v2(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_h(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function v2(e,t,r){return(t=x2(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x2(e){var t=b2(e,"string");return typeof t=="symbol"?t:t+""}function b2(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j2=e=>e.brush.height;function w2(e){var t=rl(e);return t.reduce((r,a)=>{if(a.orientation==="left"&&!a.mirror&&!a.hide){var i=typeof a.width=="number"?a.width:Ki;return r+i}return r},0)}function S2(e){var t=rl(e);return t.reduce((r,a)=>{if(a.orientation==="right"&&!a.mirror&&!a.hide){var i=typeof a.width=="number"?a.width:Ki;return r+i}return r},0)}function N2(e){var t=nl(e);return t.reduce((r,a)=>a.orientation==="top"&&!a.mirror&&!a.hide?r+a.height:r,0)}function k2(e){var t=nl(e);return t.reduce((r,a)=>a.orientation==="bottom"&&!a.mirror&&!a.hide?r+a.height:r,0)}var Yt=pe([Tr,Or,Fy,j2,w2,S2,N2,k2,fy,tN],(e,t,r,a,i,s,o,l,d,h)=>{var u={left:(r.left||0)+i,right:(r.right||0)+s},f={top:(r.top||0)+o,bottom:(r.bottom||0)+l},m=Os(Os({},f),u),p=m.bottom;m.bottom+=a,m=r2(m,d,h);var x=e-m.left-m.right,v=t-m.top-m.bottom;return Os(Os({brushBottom:p},m),{},{width:Math.max(x,0),height:Math.max(v,0)})}),A2=pe(Yt,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Vd=pe(Tr,Or,(e,t)=>({x:0,y:0,width:e,height:t})),C2=c.createContext(null),fn=()=>c.useContext(C2)!=null,al=e=>e.brush,il=pe([al,Yt,Fy],(e,t,r)=>({height:e.height,x:Me(e.x)?e.x:t.left,y:Me(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:Me(e.width)?e.width:t.width})),Hy={},Yy={},Ky={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a,{signal:i,edges:s}={}){let o,l=null;const d=s!=null&&s.includes("leading"),h=s==null||s.includes("trailing"),u=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},f=()=>{h&&u(),v()};let m=null;const p=()=>{m!=null&&clearTimeout(m),m=setTimeout(()=>{m=null,f()},a)},x=()=>{m!==null&&(clearTimeout(m),m=null)},v=()=>{x(),o=void 0,l=null},g=()=>{u()},b=function(...y){if(i!=null&&i.aborted)return;o=this,l=y;const N=m==null;p(),d&&N&&u()};return b.schedule=p,b.cancel=v,b.flush=g,i==null||i.addEventListener("abort",v,{once:!0}),b}e.debounce=t})(Ky);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ky;function r(a,i=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:d}=s,h=Array(2);o&&(h[0]="leading"),l&&(h[1]="trailing");let u,f=null;const m=t.debounce(function(...v){u=a.apply(this,v),f=null},i,{edges:h}),p=function(...v){return d!=null&&(f===null&&(f=Date.now()),Date.now()-f>=d)?(u=a.apply(this,v),f=Date.now(),m.cancel(),m.schedule(),u):(m.apply(this,v),u)},x=()=>(m.flush(),u);return p.cancel=m.cancel,p.flush=x,p}e.debounce=r})(Yy);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Yy;function r(a,i=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return t.debounce(a,i,{leading:o,maxWait:i,trailing:l})}e.throttle=r})(Hy);var E2=Hy.throttle;const P2=Vr(E2);var ro=function(t,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),s=2;s<a;s++)i[s-2]=arguments[s]},Gy=(e,t,r)=>{var{width:a="100%",height:i="100%",aspect:s,maxHeight:o}=r,l=Nr(a)?e:Number(a),d=Nr(i)?t:Number(i);return s&&s>0&&(l?d=l/s:d&&(l=d*s),o&&d!=null&&d>o&&(d=o)),{calculatedWidth:l,calculatedHeight:d}},I2={width:0,height:0,overflow:"visible"},T2={width:0,overflowX:"visible"},O2={height:0,overflowY:"visible"},_2={},D2=e=>{var{width:t,height:r}=e,a=Nr(t),i=Nr(r);return a&&i?I2:a?T2:i?O2:_2};function M2(e){var{width:t,height:r,aspect:a}=e,i=t,s=r;return i===void 0&&s===void 0?(i="100%",s="100%"):i===void 0?i=a&&a>0?void 0:"100%":s===void 0&&(s=a&&a>0?void 0:"100%"),{width:i,height:s}}function Lt(e){return Number.isFinite(e)}function dr(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Fc(){return Fc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Fc.apply(null,arguments)}function Dh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Mh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Dh(Object(r),!0).forEach(function(a){$2(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function $2(e,t,r){return(t=L2(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function L2(e){var t=R2(e,"string");return typeof t=="symbol"?t:t+""}function R2(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vy=c.createContext({width:-1,height:-1});function z2(e){return dr(e.width)&&dr(e.height)}function Xy(e){var{children:t,width:r,height:a}=e,i=c.useMemo(()=>({width:r,height:a}),[r,a]);return z2(i)?c.createElement(Vy.Provider,{value:i},t):null}var Xd=()=>c.useContext(Vy),W2=c.forwardRef((e,t)=>{var{aspect:r,initialDimension:a={width:-1,height:-1},width:i,height:s,minWidth:o=0,minHeight:l,maxHeight:d,children:h,debounce:u=0,id:f,className:m,onResize:p,style:x={}}=e,v=c.useRef(null),g=c.useRef();g.current=p,c.useImperativeHandle(t,()=>v.current);var[b,y]=c.useState({containerWidth:a.width,containerHeight:a.height}),N=c.useCallback((_,$)=>{y(L=>{var j=Math.round(_),S=Math.round($);return L.containerWidth===j&&L.containerHeight===S?L:{containerWidth:j,containerHeight:S}})},[]);c.useEffect(()=>{if(v.current==null||typeof ResizeObserver>"u")return Ca;var _=S=>{var R,{width:O,height:z}=S[0].contentRect;N(O,z),(R=g.current)===null||R===void 0||R.call(g,O,z)};u>0&&(_=P2(_,u,{trailing:!0,leading:!1}));var $=new ResizeObserver(_),{width:L,height:j}=v.current.getBoundingClientRect();return N(L,j),$.observe(v.current),()=>{$.disconnect()}},[N,u]);var{containerWidth:A,containerHeight:E}=b;ro(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:w,calculatedHeight:P}=Gy(A,E,{width:i,height:s,aspect:r,maxHeight:d});return ro(w!=null&&w>0||P!=null&&P>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,w,P,i,s,o,l,r),c.createElement("div",{id:f?"".concat(f):void 0,className:nt("recharts-responsive-container",m),style:Mh(Mh({},x),{},{width:i,height:s,minWidth:o,minHeight:l,maxHeight:d}),ref:v},c.createElement("div",{style:D2({width:i,height:s})},c.createElement(Xy,{width:w,height:P},h)))}),ao=c.forwardRef((e,t)=>{var r=Xd();if(dr(r.width)&&dr(r.height))return e.children;var{width:a,height:i}=M2({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:s,calculatedHeight:o}=Gy(void 0,void 0,{width:a,height:i,aspect:e.aspect,maxHeight:e.maxHeight});return Me(s)&&Me(o)?c.createElement(Xy,{width:s,height:o},e.children):c.createElement(W2,Fc({},e,{width:a,height:i,ref:t}))});function Qy(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var sl=()=>{var e,t=fn(),r=$e(A2),a=$e(il),i=(e=$e(al))===null||e===void 0?void 0:e.padding;return!t||!a||!i?r:{width:a.width-i.left-i.right,height:a.height-i.top-i.bottom,x:i.left,y:i.top}},B2={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Jy=()=>{var e;return(e=$e(Yt))!==null&&e!==void 0?e:B2},Zy=()=>$e(Tr),ev=()=>$e(Or),et=e=>e.layout.layoutType,Gi=()=>$e(et),F2=()=>{var e=Gi();return e!==void 0},ol=e=>{var t=Nt(),r=fn(),{width:a,height:i}=e,s=Xd(),o=a,l=i;return s&&(o=s.width>0?s.width:a,l=s.height>0?s.height:i),c.useEffect(()=>{!r&&dr(o)&&dr(l)&&t(QN({width:o,height:l}))},[t,r,o,l]),null},q2={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},tv=Nn({name:"legend",initialState:q2,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Ht()},removeLegendPayload:{reducer(e,t){var r=wr(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:Ht()}}}),{setLegendSize:bL,setLegendSettings:jL,addLegendPayload:nv,removeLegendPayload:rv}=tv.actions,U2=tv.reducer;function qc(){return qc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},qc.apply(null,arguments)}function $h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function oc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$h(Object(r),!0).forEach(function(a){H2(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$h(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function H2(e,t,r){return(t=Y2(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y2(e){var t=K2(e,"string");return typeof t=="symbol"?t:t+""}function K2(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function G2(e){return Array.isArray(e)&&cr(e[0])&&cr(e[1])?e.join(" ~ "):e}var V2=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:a={},labelStyle:i={},payload:s,formatter:o,itemSorter:l,wrapperClassName:d,labelClassName:h,label:u,labelFormatter:f,accessibilityLayer:m=!1}=e,p=()=>{if(s&&s.length){var E={padding:0,margin:0},w=(l?Xo(s,l):s).map((P,_)=>{if(P.type==="none")return null;var $=P.formatter||o||G2,{value:L,name:j}=P,S=L,R=j;if($){var O=$(L,j,P,_,s);if(Array.isArray(O))[S,R]=O;else if(O!=null)S=O;else return null}var z=oc({display:"block",paddingTop:4,paddingBottom:4,color:P.color||"#000"},a);return c.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(_),style:z},cr(R)?c.createElement("span",{className:"recharts-tooltip-item-name"},R):null,cr(R)?c.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,c.createElement("span",{className:"recharts-tooltip-item-value"},S),c.createElement("span",{className:"recharts-tooltip-item-unit"},P.unit||""))});return c.createElement("ul",{className:"recharts-tooltip-item-list",style:E},w)}return null},x=oc({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),v=oc({margin:0},i),g=!St(u),b=g?u:"",y=nt("recharts-default-tooltip",d),N=nt("recharts-tooltip-label",h);g&&f&&s!==void 0&&s!==null&&(b=f(u,s));var A=m?{role:"status","aria-live":"assertive"}:{};return c.createElement("div",qc({className:y,style:x},A),c.createElement("p",{className:N,style:v},c.isValidElement(b)?b:"".concat(b)),p())},yi="recharts-tooltip-wrapper",X2={visibility:"hidden"};function Q2(e){var{coordinate:t,translateX:r,translateY:a}=e;return nt(yi,{["".concat(yi,"-right")]:Me(r)&&t&&Me(t.x)&&r>=t.x,["".concat(yi,"-left")]:Me(r)&&t&&Me(t.x)&&r<t.x,["".concat(yi,"-bottom")]:Me(a)&&t&&Me(t.y)&&a>=t.y,["".concat(yi,"-top")]:Me(a)&&t&&Me(t.y)&&a<t.y})}function Lh(e){var{allowEscapeViewBox:t,coordinate:r,key:a,offsetTopLeft:i,position:s,reverseDirection:o,tooltipDimension:l,viewBox:d,viewBoxDimension:h}=e;if(s&&Me(s[a]))return s[a];var u=r[a]-l-(i>0?i:0),f=r[a]+i;if(t[a])return o[a]?u:f;var m=d[a];if(m==null)return 0;if(o[a]){var p=u,x=m;return p<x?Math.max(f,m):Math.max(u,m)}if(h==null)return 0;var v=f+l,g=m+h;return v>g?Math.max(u,m):Math.max(f,m)}function J2(e){var{translateX:t,translateY:r,useTranslate3d:a}=e;return{transform:a?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function Z2(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:a,position:i,reverseDirection:s,tooltipBox:o,useTranslate3d:l,viewBox:d}=e,h,u,f;return o.height>0&&o.width>0&&r?(u=Lh({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o.width,viewBox:d,viewBoxDimension:d.width}),f=Lh({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o.height,viewBox:d,viewBoxDimension:d.height}),h=J2({translateX:u,translateY:f,useTranslate3d:l})):h=X2,{cssProperties:h,cssClasses:Q2({translateX:u,translateY:f,coordinate:r})}}function Rh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function _s(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rh(Object(r),!0).forEach(function(a){Uc(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Uc(e,t,r){return(t=ek(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ek(e){var t=tk(e,"string");return typeof t=="symbol"?t:t+""}function tk(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class nk extends c.PureComponent{constructor(){super(...arguments),Uc(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Uc(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,a,i,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==null&&r!==void 0?r:0,y:(i=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:a,animationEasing:i,children:s,coordinate:o,hasPayload:l,isAnimationActive:d,offset:h,position:u,reverseDirection:f,useTranslate3d:m,viewBox:p,wrapperStyle:x,lastBoundingBox:v,innerRef:g,hasPortalFromProps:b}=this.props,{cssClasses:y,cssProperties:N}=Z2({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:h,position:u,reverseDirection:f,tooltipBox:{height:v.height,width:v.width},useTranslate3d:m,viewBox:p}),A=b?{}:_s(_s({transition:d&&t?"transform ".concat(a,"ms ").concat(i):void 0},N),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),E=_s(_s({},A),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},x);return c.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:E,ref:g},s)}}var rk=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Qr={devToolsEnabled:!1,isSsr:rk()},av=()=>{var e;return(e=$e(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function Hc(){return Hc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Hc.apply(null,arguments)}function zh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Wh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zh(Object(r),!0).forEach(function(a){ak(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function ak(e,t,r){return(t=ik(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ik(e){var t=sk(e,"string");return typeof t=="symbol"?t:t+""}function sk(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bh={curveBasisClosed:Bw,curveBasisOpen:Fw,curveBasis:Ww,curveBumpX:Aw,curveBumpY:Cw,curveLinearClosed:qw,curveLinear:Fo,curveMonotoneX:Uw,curveMonotoneY:Hw,curveNatural:Yw,curveStep:Kw,curveStepAfter:Vw,curveStepBefore:Gw},io=e=>Lt(e.x)&&Lt(e.y),Fh=e=>e.base!=null&&io(e.base)&&io(e),vi=e=>e.x,xi=e=>e.y,ok=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Ui(e));return(r==="curveMonotone"||r==="curveBump")&&t?Bh["".concat(r).concat(t==="vertical"?"Y":"X")]:Bh[r]||Fo},lk=e=>{var{type:t="linear",points:r=[],baseLine:a,layout:i,connectNulls:s=!1}=e,o=ok(t,i),l=s?r.filter(io):r,d;if(Array.isArray(a)){var h=r.map((p,x)=>Wh(Wh({},p),{},{base:a[x]}));i==="vertical"?d=As().y(xi).x1(vi).x0(p=>p.base.x):d=As().x(vi).y1(xi).y0(p=>p.base.y);var u=d.defined(Fh).curve(o),f=s?h.filter(Fh):h;return u(f)}i==="vertical"&&Me(a)?d=As().y(xi).x1(vi).x0(a):Me(a)?d=As().x(vi).y1(xi).y0(a):d=jg().x(vi).y(xi);var m=d.defined(io).curve(o);return m(l)},Qd=e=>{var{className:t,points:r,path:a,pathRef:i}=e;if((!r||!r.length)&&!a)return null;var s=r&&r.length?lk(e):a;return c.createElement("path",Hc({},_n(e),Td(e),{className:nt("recharts-curve",t),d:s===null?void 0:s,ref:i}))},ck=["x","y","top","left","width","height","className"];function Yc(){return Yc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Yc.apply(null,arguments)}function qh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function dk(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qh(Object(r),!0).forEach(function(a){uk(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function uk(e,t,r){return(t=fk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fk(e){var t=hk(e,"string");return typeof t=="symbol"?t:t+""}function hk(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mk(e,t){if(e==null)return{};var r,a,i=pk(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function pk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var gk=(e,t,r,a,i,s)=>"M".concat(e,",").concat(i,"v").concat(a,"M").concat(s,",").concat(t,"h").concat(r),yk=e=>{var{x:t=0,y:r=0,top:a=0,left:i=0,width:s=0,height:o=0,className:l}=e,d=mk(e,ck),h=dk({x:t,y:r,top:a,left:i,width:s,height:o},d);return!Me(t)||!Me(r)||!Me(s)||!Me(o)||!Me(a)||!Me(i)?null:c.createElement("path",Yc({},yn(h),{className:nt("recharts-cross",l),d:gk(t,r,s,o,a,i)}))};function vk(e,t,r,a){var i=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?a:r.width-1,height:e==="horizontal"?r.height-1:a}}function Uh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Hh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Uh(Object(r),!0).forEach(function(a){xk(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Uh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function xk(e,t,r){return(t=bk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bk(e){var t=jk(e,"string");return typeof t=="symbol"?t:t+""}function jk(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wk=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),iv=(e,t,r)=>e.map(a=>"".concat(wk(a)," ").concat(t,"ms ").concat(r)).join(","),Sk=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,a)=>r.filter(i=>a.includes(i))),$i=(e,t)=>Object.keys(t).reduce((r,a)=>Hh(Hh({},r),{},{[a]:e(a,t[a])}),{});function Yh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Ut(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yh(Object(r),!0).forEach(function(a){Nk(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Nk(e,t,r){return(t=kk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kk(e){var t=Ak(e,"string");return typeof t=="symbol"?t:t+""}function Ak(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var so=(e,t,r)=>e+(t-e)*r,Kc=e=>{var{from:t,to:r}=e;return t!==r},sv=(e,t,r)=>{var a=$i((i,s)=>{if(Kc(s)){var[o,l]=e(s.from,s.to,s.velocity);return Ut(Ut({},s),{},{from:o,velocity:l})}return s},t);return r<1?$i((i,s)=>Kc(s)?Ut(Ut({},s),{},{velocity:so(s.velocity,a[i].velocity,r),from:so(s.from,a[i].from,r)}):s,t):sv(e,a,r-1)};function Ck(e,t,r,a,i,s){var o,l=a.reduce((m,p)=>Ut(Ut({},m),{},{[p]:{from:e[p],velocity:0,to:t[p]}}),{}),d=()=>$i((m,p)=>p.from,l),h=()=>!Object.values(l).filter(Kc).length,u=null,f=m=>{o||(o=m);var p=m-o,x=p/r.dt;l=sv(r,l,x),i(Ut(Ut(Ut({},e),t),d())),o=m,h()||(u=s.setTimeout(f))};return()=>(u=s.setTimeout(f),()=>{var m;(m=u)===null||m===void 0||m()})}function Ek(e,t,r,a,i,s,o){var l=null,d=i.reduce((f,m)=>Ut(Ut({},f),{},{[m]:[e[m],t[m]]}),{}),h,u=f=>{h||(h=f);var m=(f-h)/a,p=$i((v,g)=>so(...g,r(m)),d);if(s(Ut(Ut(Ut({},e),t),p)),m<1)l=o.setTimeout(u);else{var x=$i((v,g)=>so(...g,r(1)),d);s(Ut(Ut(Ut({},e),t),x))}};return()=>(l=o.setTimeout(u),()=>{var f;(f=l)===null||f===void 0||f()})}const Pk=(e,t,r,a,i,s)=>{var o=Sk(e,t);return r==null?()=>(i(Ut(Ut({},e),t)),()=>{}):r.isStepper===!0?Ck(e,t,r,o,i,s):Ek(e,t,r,a,o,i,s)};var oo=1e-4,ov=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],lv=(e,t)=>e.map((r,a)=>r*t**a).reduce((r,a)=>r+a),Kh=(e,t)=>r=>{var a=ov(e,t);return lv(a,r)},Ik=(e,t)=>r=>{var a=ov(e,t),i=[...a.map((s,o)=>s*o).slice(1),0];return lv(i,r)},Tk=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i,s=r[0].split("(");if(s[0]==="cubic-bezier"&&((i=s[1])===null||i===void 0?void 0:i.split(")")[0].split(",").length)===4){var o=s[1].split(")")[0].split(",").map(l=>parseFloat(l));return[o[0],o[1],o[2],o[3]]}}}return r.length===4?r:[0,0,1,1]},Ok=(e,t,r,a)=>{var i=Kh(e,r),s=Kh(t,a),o=Ik(e,r),l=h=>h>1?1:h<0?0:h,d=h=>{for(var u=h>1?1:h,f=u,m=0;m<8;++m){var p=i(f)-u,x=o(f);if(Math.abs(p-u)<oo||x<oo)return s(f);f=l(f-p/x)}return s(f)};return d.isStepper=!1,d},Gh=function(){return Ok(...Tk(...arguments))},_k=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:a=8,dt:i=17}=t,s=(o,l,d)=>{var h=-(o-l)*r,u=d*a,f=d+(h-u)*i/1e3,m=d*i/1e3+o;return Math.abs(m-l)<oo&&Math.abs(f)<oo?[l,0]:[m,f]};return s.isStepper=!0,s.dt=i,s},Dk=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Gh(e);case"spring":return _k();default:if(e.split("(")[0]==="cubic-bezier")return Gh(e)}return typeof e=="function"?e:null};function Mk(e){var t,r=()=>null,a=!1,i=null,s=o=>{if(!a){if(Array.isArray(o)){if(!o.length)return;var l=o,[d,...h]=l;if(typeof d=="number"){i=e.setTimeout(s.bind(null,h),d);return}s(d),i=e.setTimeout(s.bind(null,h));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{a=!0},start:o=>{a=!1,i&&(i(),i=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class $k{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=performance.now(),i=null,s=o=>{o-a>=r?t(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(s))};return i=requestAnimationFrame(s),()=>{i!=null&&cancelAnimationFrame(i)}}}function Lk(){return Mk(new $k)}var Rk=c.createContext(Lk);function zk(e,t){var r=c.useContext(Rk);return c.useMemo(()=>t??r(e),[e,t,r])}var Wk={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},Vh={t:0},lc={t:1};function Vi(e){var t=tn(e,Wk),{isActive:r,canBegin:a,duration:i,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:d,children:h}=t,u=zk(t.animationId,t.animationManager),[f,m]=c.useState(r?Vh:lc),p=c.useRef(null);return c.useEffect(()=>{r||m(lc)},[r]),c.useEffect(()=>{if(!r||!a)return Ca;var x=Pk(Vh,lc,Dk(s),i,m,u.getTimeoutController()),v=()=>{p.current=x()};return u.start([d,o,v,i,l]),()=>{u.stop(),p.current&&p.current(),l()}},[r,a,i,s,o,d,l,u]),h(f.t)}function Xi(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=c.useRef(Oi(t)),a=c.useRef(e);return a.current!==e&&(r.current=Oi(t),a.current=e),r.current}var Bk=["radius"],Fk=["radius"];function Xh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Qh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xh(Object(r),!0).forEach(function(a){qk(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function qk(e,t,r){return(t=Uk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Uk(e){var t=Hk(e,"string");return typeof t=="symbol"?t:t+""}function Hk(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lo(){return lo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},lo.apply(null,arguments)}function Jh(e,t){if(e==null)return{};var r,a,i=Yk(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Yk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Zh=(e,t,r,a,i)=>{var s=Math.min(Math.abs(r)/2,Math.abs(a)/2),o=a>=0?1:-1,l=r>=0?1:-1,d=a>=0&&r>=0||a<0&&r<0?1:0,h;if(s>0&&i instanceof Array){for(var u=[0,0,0,0],f=0,m=4;f<m;f++)u[f]=i[f]>s?s:i[f];h="M".concat(e,",").concat(t+o*u[0]),u[0]>0&&(h+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(d,",").concat(e+l*u[0],",").concat(t)),h+="L ".concat(e+r-l*u[1],",").concat(t),u[1]>0&&(h+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(d,`,
        `).concat(e+r,",").concat(t+o*u[1])),h+="L ".concat(e+r,",").concat(t+a-o*u[2]),u[2]>0&&(h+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(d,`,
        `).concat(e+r-l*u[2],",").concat(t+a)),h+="L ".concat(e+l*u[3],",").concat(t+a),u[3]>0&&(h+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(d,`,
        `).concat(e,",").concat(t+a-o*u[3])),h+="Z"}else if(s>0&&i===+i&&i>0){var p=Math.min(s,i);h="M ".concat(e,",").concat(t+o*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(d,",").concat(e+l*p,",").concat(t,`
            L `).concat(e+r-l*p,",").concat(t,`
            A `).concat(p,",").concat(p,",0,0,").concat(d,",").concat(e+r,",").concat(t+o*p,`
            L `).concat(e+r,",").concat(t+a-o*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(d,",").concat(e+r-l*p,",").concat(t+a,`
            L `).concat(e+l*p,",").concat(t+a,`
            A `).concat(p,",").concat(p,",0,0,").concat(d,",").concat(e,",").concat(t+a-o*p," Z")}else h="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(a," h ").concat(-r," Z");return h},em={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},cv=e=>{var t=tn(e,em),r=c.useRef(null),[a,i]=c.useState(-1);c.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var ae=r.current.getTotalLength();ae&&i(ae)}catch{}},[]);var{x:s,y:o,width:l,height:d,radius:h,className:u}=t,{animationEasing:f,animationDuration:m,animationBegin:p,isAnimationActive:x,isUpdateAnimationActive:v}=t,g=c.useRef(l),b=c.useRef(d),y=c.useRef(s),N=c.useRef(o),A=c.useMemo(()=>({x:s,y:o,width:l,height:d,radius:h}),[s,o,l,d,h]),E=Xi(A,"rectangle-");if(s!==+s||o!==+o||l!==+l||d!==+d||l===0||d===0)return null;var w=nt("recharts-rectangle",u);if(!v){var P=yn(t),{radius:_}=P,$=Jh(P,Bk);return c.createElement("path",lo({},$,{radius:typeof h=="number"?h:void 0,className:w,d:Zh(s,o,l,d,h)}))}var L=g.current,j=b.current,S=y.current,R=N.current,O="0px ".concat(a===-1?1:a,"px"),z="".concat(a,"px 0px"),Z=iv(["strokeDasharray"],m,typeof f=="string"?f:em.animationEasing);return c.createElement(Vi,{animationId:E,key:E,canBegin:a>0,duration:m,easing:f,isActive:v,begin:p},ae=>{var se=bt(L,l,ae),H=bt(j,d,ae),q=bt(S,s,ae),C=bt(R,o,ae);r.current&&(g.current=se,b.current=H,y.current=q,N.current=C);var T;x?ae>0?T={transition:Z,strokeDasharray:z}:T={strokeDasharray:O}:T={strokeDasharray:z};var W=yn(t),{radius:I}=W,U=Jh(W,Fk);return c.createElement("path",lo({},U,{radius:typeof h=="number"?h:void 0,className:w,d:Zh(q,C,se,H,h),ref:r,style:Qh(Qh({},T),t.style)}))})};function tm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function nm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tm(Object(r),!0).forEach(function(a){Kk(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tm(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Kk(e,t,r){return(t=Gk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Gk(e){var t=Vk(e,"string");return typeof t=="symbol"?t:t+""}function Vk(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var co=Math.PI/180,Xk=e=>e*180/Math.PI,Wt=(e,t,r,a)=>({x:e+Math.cos(-co*a)*r,y:t+Math.sin(-co*a)*r}),dv=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(a.left||0)-(a.right||0)),Math.abs(r-(a.top||0)-(a.bottom||0)))/2},Qk=(e,t)=>{var{x:r,y:a}=e,{x:i,y:s}=t;return Math.sqrt((r-i)**2+(a-s)**2)},Jk=(e,t)=>{var{x:r,y:a}=e,{cx:i,cy:s}=t,o=Qk({x:r,y:a},{x:i,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-i)/o,d=Math.acos(l);return a>s&&(d=2*Math.PI-d),{radius:o,angle:Xk(d),angleInRadian:d}},Zk=e=>{var{startAngle:t,endAngle:r}=e,a=Math.floor(t/360),i=Math.floor(r/360),s=Math.min(a,i);return{startAngle:t-s*360,endAngle:r-s*360}},eA=(e,t)=>{var{startAngle:r,endAngle:a}=t,i=Math.floor(r/360),s=Math.floor(a/360),o=Math.min(i,s);return e+o*360},tA=(e,t)=>{var{chartX:r,chartY:a}=e,{radius:i,angle:s}=Jk({x:r,y:a},t),{innerRadius:o,outerRadius:l}=t;if(i<o||i>l||i===0)return null;var{startAngle:d,endAngle:h}=Zk(t),u=s,f;if(d<=h){for(;u>h;)u-=360;for(;u<d;)u+=360;f=u>=d&&u<=h}else{for(;u>d;)u-=360;for(;u<h;)u+=360;f=u>=h&&u<=d}return f?nm(nm({},t),{},{radius:i,angle:eA(u,t)}):null};function uv(e){var{cx:t,cy:r,radius:a,startAngle:i,endAngle:s}=e,o=Wt(t,r,a,i),l=Wt(t,r,a,s);return{points:[o,l],cx:t,cy:r,radius:a,startAngle:i,endAngle:s}}function Gc(){return Gc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Gc.apply(null,arguments)}var nA=(e,t)=>{var r=Zt(t-e),a=Math.min(Math.abs(t-e),359.999);return r*a},Ds=e=>{var{cx:t,cy:r,radius:a,angle:i,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:d}=e,h=l*(o?1:-1)+a,u=Math.asin(l/h)/co,f=d?i:i+s*u,m=Wt(t,r,h,f),p=Wt(t,r,a,f),x=d?i-s*u:i,v=Wt(t,r,h*Math.cos(u*co),x);return{center:m,circleTangency:p,lineTangency:v,theta:u}},fv=e=>{var{cx:t,cy:r,innerRadius:a,outerRadius:i,startAngle:s,endAngle:o}=e,l=nA(s,o),d=s+l,h=Wt(t,r,i,s),u=Wt(t,r,i,d),f="M ".concat(h.x,",").concat(h.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(s>d),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(a>0){var m=Wt(t,r,a,s),p=Wt(t,r,a,d);f+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(s<=d),`,
            `).concat(m.x,",").concat(m.y," Z")}else f+="L ".concat(t,",").concat(r," Z");return f},rA=e=>{var{cx:t,cy:r,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:d,endAngle:h}=e,u=Zt(h-d),{circleTangency:f,lineTangency:m,theta:p}=Ds({cx:t,cy:r,radius:i,angle:d,sign:u,cornerRadius:s,cornerIsExternal:l}),{circleTangency:x,lineTangency:v,theta:g}=Ds({cx:t,cy:r,radius:i,angle:h,sign:-u,cornerRadius:s,cornerIsExternal:l}),b=l?Math.abs(d-h):Math.abs(d-h)-p-g;if(b<0)return o?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):fv({cx:t,cy:r,innerRadius:a,outerRadius:i,startAngle:d,endAngle:h});var y="M ".concat(m.x,",").concat(m.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(b>180),",").concat(+(u<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
  `);if(a>0){var{circleTangency:N,lineTangency:A,theta:E}=Ds({cx:t,cy:r,radius:a,angle:d,sign:u,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:w,lineTangency:P,theta:_}=Ds({cx:t,cy:r,radius:a,angle:h,sign:-u,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),$=l?Math.abs(d-h):Math.abs(d-h)-E-_;if($<0&&s===0)return"".concat(y,"L").concat(t,",").concat(r,"Z");y+="L".concat(P.x,",").concat(P.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(w.x,",").concat(w.y,`
      A`).concat(a,",").concat(a,",0,").concat(+($>180),",").concat(+(u>0),",").concat(N.x,",").concat(N.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(A.x,",").concat(A.y,"Z")}else y+="L".concat(t,",").concat(r,"Z");return y},aA={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},hv=e=>{var t=tn(e,aA),{cx:r,cy:a,innerRadius:i,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:d,startAngle:h,endAngle:u,className:f}=t;if(s<i||h===u)return null;var m=nt("recharts-sector",f),p=s-i,x=un(o,p,0,!0),v;return x>0&&Math.abs(h-u)<360?v=rA({cx:r,cy:a,innerRadius:i,outerRadius:s,cornerRadius:Math.min(x,p/2),forceCornerRadius:l,cornerIsExternal:d,startAngle:h,endAngle:u}):v=fv({cx:r,cy:a,innerRadius:i,outerRadius:s,startAngle:h,endAngle:u}),c.createElement("path",Gc({},yn(t),{className:m,d:v}))};function iA(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(Rg(t)){if(e==="centric"){var{cx:a,cy:i,innerRadius:s,outerRadius:o,angle:l}=t,d=Wt(a,i,s,l),h=Wt(a,i,o,l);return[{x:d.x,y:d.y},{x:h.x,y:h.y}]}return uv(t)}}var mv={},pv={},gv={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fd;function r(a){return t.isSymbol(a)?NaN:Number(a)}e.toNumber=r})(gv);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gv;function r(a){return a?(a=t.toNumber(a),a===1/0||a===-1/0?(a<0?-1:1)*Number.MAX_VALUE:a===a?a:0):a===0?a:0}e.toFinite=r})(pv);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qd,r=pv;function a(i,s,o){o&&typeof o!="number"&&t.isIterateeCall(i,s,o)&&(s=o=void 0),i=r.toFinite(i),s===void 0?(s=i,i=0):s=r.toFinite(s),o=o===void 0?i<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-i)/(o||1)),0),d=new Array(l);for(let h=0;h<l;h++)d[h]=i,i+=o;return d}e.range=a})(mv);var sA=mv.range;const yv=Vr(sA);function Ur(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function oA(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Jd(e){let t,r,a;e.length!==2?(t=Ur,r=(l,d)=>Ur(e(l),d),a=(l,d)=>e(l)-d):(t=e===Ur||e===oA?e:lA,r=e,a=e);function i(l,d,h=0,u=l.length){if(h<u){if(t(d,d)!==0)return u;do{const f=h+u>>>1;r(l[f],d)<0?h=f+1:u=f}while(h<u)}return h}function s(l,d,h=0,u=l.length){if(h<u){if(t(d,d)!==0)return u;do{const f=h+u>>>1;r(l[f],d)<=0?h=f+1:u=f}while(h<u)}return h}function o(l,d,h=0,u=l.length){const f=i(l,d,h,u-1);return f>h&&a(l[f-1],d)>-a(l[f],d)?f-1:f}return{left:i,center:o,right:s}}function lA(){return 0}function vv(e){return e===null?NaN:+e}function*cA(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const dA=Jd(Ur),Qi=dA.right;Jd(vv).center;class rm extends Map{constructor(t,r=hA){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[a,i]of t)this.set(a,i)}get(t){return super.get(am(this,t))}has(t){return super.has(am(this,t))}set(t,r){return super.set(uA(this,t),r)}delete(t){return super.delete(fA(this,t))}}function am({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):r}function uA({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):(e.set(a,r),r)}function fA({_intern:e,_key:t},r){const a=t(r);return e.has(a)&&(r=e.get(a),e.delete(a)),r}function hA(e){return e!==null&&typeof e=="object"?e.valueOf():e}function mA(e=Ur){if(e===Ur)return xv;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const a=e(t,r);return a||a===0?a:(e(r,r)===0)-(e(t,t)===0)}}function xv(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const pA=Math.sqrt(50),gA=Math.sqrt(10),yA=Math.sqrt(2);function uo(e,t,r){const a=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(a)),s=a/Math.pow(10,i),o=s>=pA?10:s>=gA?5:s>=yA?2:1;let l,d,h;return i<0?(h=Math.pow(10,-i)/o,l=Math.round(e*h),d=Math.round(t*h),l/h<e&&++l,d/h>t&&--d,h=-h):(h=Math.pow(10,i)*o,l=Math.round(e/h),d=Math.round(t/h),l*h<e&&++l,d*h>t&&--d),d<l&&.5<=r&&r<2?uo(e,t,r*2):[l,d,h]}function Vc(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const a=t<e,[i,s,o]=a?uo(t,e,r):uo(e,t,r);if(!(s>=i))return[];const l=s-i+1,d=new Array(l);if(a)if(o<0)for(let h=0;h<l;++h)d[h]=(s-h)/-o;else for(let h=0;h<l;++h)d[h]=(s-h)*o;else if(o<0)for(let h=0;h<l;++h)d[h]=(i+h)/-o;else for(let h=0;h<l;++h)d[h]=(i+h)*o;return d}function Xc(e,t,r){return t=+t,e=+e,r=+r,uo(e,t,r)[2]}function Qc(e,t,r){t=+t,e=+e,r=+r;const a=t<e,i=a?Xc(t,e,r):Xc(e,t,r);return(a?-1:1)*(i<0?1/-i:i)}function im(e,t){let r;for(const a of e)a!=null&&(r<a||r===void 0&&a>=a)&&(r=a);return r}function sm(e,t){let r;for(const a of e)a!=null&&(r>a||r===void 0&&a>=a)&&(r=a);return r}function bv(e,t,r=0,a=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),a=Math.floor(Math.min(e.length-1,a)),!(r<=t&&t<=a))return e;for(i=i===void 0?xv:mA(i);a>r;){if(a-r>600){const d=a-r+1,h=t-r+1,u=Math.log(d),f=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*f*(d-f)/d)*(h-d/2<0?-1:1),p=Math.max(r,Math.floor(t-h*f/d+m)),x=Math.min(a,Math.floor(t+(d-h)*f/d+m));bv(e,t,p,x,i)}const s=e[t];let o=r,l=a;for(bi(e,r,t),i(e[a],s)>0&&bi(e,r,a);o<l;){for(bi(e,o,l),++o,--l;i(e[o],s)<0;)++o;for(;i(e[l],s)>0;)--l}i(e[r],s)===0?bi(e,r,l):(++l,bi(e,l,a)),l<=t&&(r=l+1),t<=l&&(a=l-1)}return e}function bi(e,t,r){const a=e[t];e[t]=e[r],e[r]=a}function vA(e,t,r){if(e=Float64Array.from(cA(e)),!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return sm(e);if(t>=1)return im(e);var a,i=(a-1)*t,s=Math.floor(i),o=im(bv(e,s).subarray(0,s+1)),l=sm(e.subarray(s+1));return o+(l-o)*(i-s)}}function xA(e,t,r=vv){if(!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return+r(e[0],0,e);if(t>=1)return+r(e[a-1],a-1,e);var a,i=(a-1)*t,s=Math.floor(i),o=+r(e[s],s,e),l=+r(e[s+1],s+1,e);return o+(l-o)*(i-s)}}function bA(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var a=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,s=new Array(i);++a<i;)s[a]=e+a*r;return s}function Un(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function _r(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Jc=Symbol("implicit");function Zd(){var e=new rm,t=[],r=[],a=Jc;function i(s){let o=e.get(s);if(o===void 0){if(a!==Jc)return a;e.set(s,o=t.push(s)-1)}return r[o%r.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new rm;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(s){return arguments.length?(r=Array.from(s),i):r.slice()},i.unknown=function(s){return arguments.length?(a=s,i):a},i.copy=function(){return Zd(t,r).unknown(a)},Un.apply(i,arguments),i}function eu(){var e=Zd().unknown(void 0),t=e.domain,r=e.range,a=0,i=1,s,o,l=!1,d=0,h=0,u=.5;delete e.unknown;function f(){var m=t().length,p=i<a,x=p?i:a,v=p?a:i;s=(v-x)/Math.max(1,m-d+h*2),l&&(s=Math.floor(s)),x+=(v-x-s*(m-d))*u,o=s*(1-d),l&&(x=Math.round(x),o=Math.round(o));var g=bA(m).map(function(b){return x+s*b});return r(p?g.reverse():g)}return e.domain=function(m){return arguments.length?(t(m),f()):t()},e.range=function(m){return arguments.length?([a,i]=m,a=+a,i=+i,f()):[a,i]},e.rangeRound=function(m){return[a,i]=m,a=+a,i=+i,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(m){return arguments.length?(l=!!m,f()):l},e.padding=function(m){return arguments.length?(d=Math.min(1,h=+m),f()):d},e.paddingInner=function(m){return arguments.length?(d=Math.min(1,m),f()):d},e.paddingOuter=function(m){return arguments.length?(h=+m,f()):h},e.align=function(m){return arguments.length?(u=Math.max(0,Math.min(1,m)),f()):u},e.copy=function(){return eu(t(),[a,i]).round(l).paddingInner(d).paddingOuter(h).align(u)},Un.apply(f(),arguments)}function jv(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return jv(t())},e}function jA(){return jv(eu.apply(null,arguments).paddingInner(1))}function tu(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function wv(e,t){var r=Object.create(e.prototype);for(var a in t)r[a]=t[a];return r}function Ji(){}var Li=.7,fo=1/Li,Ha="\\s*([+-]?\\d+)\\s*",Ri="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",lr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",wA=/^#([0-9a-f]{3,8})$/,SA=new RegExp(`^rgb\\(${Ha},${Ha},${Ha}\\)$`),NA=new RegExp(`^rgb\\(${lr},${lr},${lr}\\)$`),kA=new RegExp(`^rgba\\(${Ha},${Ha},${Ha},${Ri}\\)$`),AA=new RegExp(`^rgba\\(${lr},${lr},${lr},${Ri}\\)$`),CA=new RegExp(`^hsl\\(${Ri},${lr},${lr}\\)$`),EA=new RegExp(`^hsla\\(${Ri},${lr},${lr},${Ri}\\)$`),om={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};tu(Ji,zi,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:lm,formatHex:lm,formatHex8:PA,formatHsl:IA,formatRgb:cm,toString:cm});function lm(){return this.rgb().formatHex()}function PA(){return this.rgb().formatHex8()}function IA(){return Sv(this).formatHsl()}function cm(){return this.rgb().formatRgb()}function zi(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=wA.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?dm(t):r===3?new Sn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Ms(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Ms(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=SA.exec(e))?new Sn(t[1],t[2],t[3],1):(t=NA.exec(e))?new Sn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=kA.exec(e))?Ms(t[1],t[2],t[3],t[4]):(t=AA.exec(e))?Ms(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=CA.exec(e))?hm(t[1],t[2]/100,t[3]/100,1):(t=EA.exec(e))?hm(t[1],t[2]/100,t[3]/100,t[4]):om.hasOwnProperty(e)?dm(om[e]):e==="transparent"?new Sn(NaN,NaN,NaN,0):null}function dm(e){return new Sn(e>>16&255,e>>8&255,e&255,1)}function Ms(e,t,r,a){return a<=0&&(e=t=r=NaN),new Sn(e,t,r,a)}function TA(e){return e instanceof Ji||(e=zi(e)),e?(e=e.rgb(),new Sn(e.r,e.g,e.b,e.opacity)):new Sn}function Zc(e,t,r,a){return arguments.length===1?TA(e):new Sn(e,t,r,a??1)}function Sn(e,t,r,a){this.r=+e,this.g=+t,this.b=+r,this.opacity=+a}tu(Sn,Zc,wv(Ji,{brighter(e){return e=e==null?fo:Math.pow(fo,e),new Sn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Li:Math.pow(Li,e),new Sn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Sn(pa(this.r),pa(this.g),pa(this.b),ho(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:um,formatHex:um,formatHex8:OA,formatRgb:fm,toString:fm}));function um(){return`#${da(this.r)}${da(this.g)}${da(this.b)}`}function OA(){return`#${da(this.r)}${da(this.g)}${da(this.b)}${da((isNaN(this.opacity)?1:this.opacity)*255)}`}function fm(){const e=ho(this.opacity);return`${e===1?"rgb(":"rgba("}${pa(this.r)}, ${pa(this.g)}, ${pa(this.b)}${e===1?")":`, ${e})`}`}function ho(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function pa(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function da(e){return e=pa(e),(e<16?"0":"")+e.toString(16)}function hm(e,t,r,a){return a<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Qn(e,t,r,a)}function Sv(e){if(e instanceof Qn)return new Qn(e.h,e.s,e.l,e.opacity);if(e instanceof Ji||(e=zi(e)),!e)return new Qn;if(e instanceof Qn)return e;e=e.rgb();var t=e.r/255,r=e.g/255,a=e.b/255,i=Math.min(t,r,a),s=Math.max(t,r,a),o=NaN,l=s-i,d=(s+i)/2;return l?(t===s?o=(r-a)/l+(r<a)*6:r===s?o=(a-t)/l+2:o=(t-r)/l+4,l/=d<.5?s+i:2-s-i,o*=60):l=d>0&&d<1?0:o,new Qn(o,l,d,e.opacity)}function _A(e,t,r,a){return arguments.length===1?Sv(e):new Qn(e,t,r,a??1)}function Qn(e,t,r,a){this.h=+e,this.s=+t,this.l=+r,this.opacity=+a}tu(Qn,_A,wv(Ji,{brighter(e){return e=e==null?fo:Math.pow(fo,e),new Qn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Li:Math.pow(Li,e),new Qn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,a=r+(r<.5?r:1-r)*t,i=2*r-a;return new Sn(cc(e>=240?e-240:e+120,i,a),cc(e,i,a),cc(e<120?e+240:e-120,i,a),this.opacity)},clamp(){return new Qn(mm(this.h),$s(this.s),$s(this.l),ho(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ho(this.opacity);return`${e===1?"hsl(":"hsla("}${mm(this.h)}, ${$s(this.s)*100}%, ${$s(this.l)*100}%${e===1?")":`, ${e})`}`}}));function mm(e){return e=(e||0)%360,e<0?e+360:e}function $s(e){return Math.max(0,Math.min(1,e||0))}function cc(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const nu=e=>()=>e;function DA(e,t){return function(r){return e+r*t}}function MA(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(a){return Math.pow(e+a*t,r)}}function $A(e){return(e=+e)==1?Nv:function(t,r){return r-t?MA(t,r,e):nu(isNaN(t)?r:t)}}function Nv(e,t){var r=t-e;return r?DA(e,r):nu(isNaN(e)?t:e)}const pm=function e(t){var r=$A(t);function a(i,s){var o=r((i=Zc(i)).r,(s=Zc(s)).r),l=r(i.g,s.g),d=r(i.b,s.b),h=Nv(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=l(u),i.b=d(u),i.opacity=h(u),i+""}}return a.gamma=e,a}(1);function LA(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,a=t.slice(),i;return function(s){for(i=0;i<r;++i)a[i]=e[i]*(1-s)+t[i]*s;return a}}function RA(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function zA(e,t){var r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),s=new Array(r),o;for(o=0;o<a;++o)i[o]=ei(e[o],t[o]);for(;o<r;++o)s[o]=t[o];return function(l){for(o=0;o<a;++o)s[o]=i[o](l);return s}}function WA(e,t){var r=new Date;return e=+e,t=+t,function(a){return r.setTime(e*(1-a)+t*a),r}}function mo(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function BA(e,t){var r={},a={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=ei(e[i],t[i]):a[i]=t[i];return function(s){for(i in r)a[i]=r[i](s);return a}}var ed=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,dc=new RegExp(ed.source,"g");function FA(e){return function(){return e}}function qA(e){return function(t){return e(t)+""}}function UA(e,t){var r=ed.lastIndex=dc.lastIndex=0,a,i,s,o=-1,l=[],d=[];for(e=e+"",t=t+"";(a=ed.exec(e))&&(i=dc.exec(t));)(s=i.index)>r&&(s=t.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(a=a[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,d.push({i:o,x:mo(a,i)})),r=dc.lastIndex;return r<t.length&&(s=t.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?d[0]?qA(d[0].x):FA(t):(t=d.length,function(h){for(var u=0,f;u<t;++u)l[(f=d[u]).i]=f.x(h);return l.join("")})}function ei(e,t){var r=typeof t,a;return t==null||r==="boolean"?nu(t):(r==="number"?mo:r==="string"?(a=zi(t))?(t=a,pm):UA:t instanceof zi?pm:t instanceof Date?WA:RA(t)?LA:Array.isArray(t)?zA:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?BA:mo)(e,t)}function ru(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function HA(e,t){t===void 0&&(t=e,e=ei);for(var r=0,a=t.length-1,i=t[0],s=new Array(a<0?0:a);r<a;)s[r]=e(i,i=t[++r]);return function(o){var l=Math.max(0,Math.min(a-1,Math.floor(o*=a)));return s[l](o-l)}}function YA(e){return function(){return e}}function po(e){return+e}var gm=[0,1];function gn(e){return e}function td(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:YA(isNaN(t)?NaN:.5)}function KA(e,t){var r;return e>t&&(r=e,e=t,t=r),function(a){return Math.max(e,Math.min(t,a))}}function GA(e,t,r){var a=e[0],i=e[1],s=t[0],o=t[1];return i<a?(a=td(i,a),s=r(o,s)):(a=td(a,i),s=r(s,o)),function(l){return s(a(l))}}function VA(e,t,r){var a=Math.min(e.length,t.length)-1,i=new Array(a),s=new Array(a),o=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<a;)i[o]=td(e[o],e[o+1]),s[o]=r(t[o],t[o+1]);return function(l){var d=Qi(e,l,1,a)-1;return s[d](i[d](l))}}function Zi(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ll(){var e=gm,t=gm,r=ei,a,i,s,o=gn,l,d,h;function u(){var m=Math.min(e.length,t.length);return o!==gn&&(o=KA(e[0],e[m-1])),l=m>2?VA:GA,d=h=null,f}function f(m){return m==null||isNaN(m=+m)?s:(d||(d=l(e.map(a),t,r)))(a(o(m)))}return f.invert=function(m){return o(i((h||(h=l(t,e.map(a),mo)))(m)))},f.domain=function(m){return arguments.length?(e=Array.from(m,po),u()):e.slice()},f.range=function(m){return arguments.length?(t=Array.from(m),u()):t.slice()},f.rangeRound=function(m){return t=Array.from(m),r=ru,u()},f.clamp=function(m){return arguments.length?(o=m?!0:gn,u()):o!==gn},f.interpolate=function(m){return arguments.length?(r=m,u()):r},f.unknown=function(m){return arguments.length?(s=m,f):s},function(m,p){return a=m,i=p,u()}}function au(){return ll()(gn,gn)}function XA(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function go(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,a=e.slice(0,r);return[a.length>1?a[0]+a.slice(2):a,+e.slice(r+1)]}function Va(e){return e=go(Math.abs(e)),e?e[1]:NaN}function QA(e,t){return function(r,a){for(var i=r.length,s=[],o=0,l=e[0],d=0;i>0&&l>0&&(d+l+1>a&&(l=Math.max(1,a-d)),s.push(r.substring(i-=l,i+l)),!((d+=l+1)>a));)l=e[o=(o+1)%e.length];return s.reverse().join(t)}}function JA(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var ZA=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Wi(e){if(!(t=ZA.exec(e)))throw new Error("invalid format: "+e);var t;return new iu({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Wi.prototype=iu.prototype;function iu(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}iu.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function eC(e){e:for(var t=e.length,r=1,a=-1,i;r<t;++r)switch(e[r]){case".":a=i=r;break;case"0":a===0&&(a=r),i=r;break;default:if(!+e[r])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(i+1):e}var kv;function tC(e,t){var r=go(e,t);if(!r)return e+"";var a=r[0],i=r[1],s=i-(kv=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=a.length;return s===o?a:s>o?a+new Array(s-o+1).join("0"):s>0?a.slice(0,s)+"."+a.slice(s):"0."+new Array(1-s).join("0")+go(e,Math.max(0,t+s-1))[0]}function ym(e,t){var r=go(e,t);if(!r)return e+"";var a=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+a:a.length>i+1?a.slice(0,i+1)+"."+a.slice(i+1):a+new Array(i-a.length+2).join("0")}const vm={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:XA,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>ym(e*100,t),r:ym,s:tC,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function xm(e){return e}var bm=Array.prototype.map,jm=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function nC(e){var t=e.grouping===void 0||e.thousands===void 0?xm:QA(bm.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?xm:JA(bm.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"−":e.minus+"",d=e.nan===void 0?"NaN":e.nan+"";function h(f){f=Wi(f);var m=f.fill,p=f.align,x=f.sign,v=f.symbol,g=f.zero,b=f.width,y=f.comma,N=f.precision,A=f.trim,E=f.type;E==="n"?(y=!0,E="g"):vm[E]||(N===void 0&&(N=12),A=!0,E="g"),(g||m==="0"&&p==="=")&&(g=!0,m="0",p="=");var w=v==="$"?r:v==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",P=v==="$"?a:/[%p]/.test(E)?o:"",_=vm[E],$=/[defgprs%]/.test(E);N=N===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,N)):Math.max(0,Math.min(20,N));function L(j){var S=w,R=P,O,z,Z;if(E==="c")R=_(j)+R,j="";else{j=+j;var ae=j<0||1/j<0;if(j=isNaN(j)?d:_(Math.abs(j),N),A&&(j=eC(j)),ae&&+j==0&&x!=="+"&&(ae=!1),S=(ae?x==="("?x:l:x==="-"||x==="("?"":x)+S,R=(E==="s"?jm[8+kv/3]:"")+R+(ae&&x==="("?")":""),$){for(O=-1,z=j.length;++O<z;)if(Z=j.charCodeAt(O),48>Z||Z>57){R=(Z===46?i+j.slice(O+1):j.slice(O))+R,j=j.slice(0,O);break}}}y&&!g&&(j=t(j,1/0));var se=S.length+j.length+R.length,H=se<b?new Array(b-se+1).join(m):"";switch(y&&g&&(j=t(H+j,H.length?b-R.length:1/0),H=""),p){case"<":j=S+j+R+H;break;case"=":j=S+H+j+R;break;case"^":j=H.slice(0,se=H.length>>1)+S+j+R+H.slice(se);break;default:j=H+S+j+R;break}return s(j)}return L.toString=function(){return f+""},L}function u(f,m){var p=h((f=Wi(f),f.type="f",f)),x=Math.max(-8,Math.min(8,Math.floor(Va(m)/3)))*3,v=Math.pow(10,-x),g=jm[8+x/3];return function(b){return p(v*b)+g}}return{format:h,formatPrefix:u}}var Ls,su,Av;rC({thousands:",",grouping:[3],currency:["$",""]});function rC(e){return Ls=nC(e),su=Ls.format,Av=Ls.formatPrefix,Ls}function aC(e){return Math.max(0,-Va(Math.abs(e)))}function iC(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Va(t)/3)))*3-Va(Math.abs(e)))}function sC(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Va(t)-Va(e))+1}function Cv(e,t,r,a){var i=Qc(e,t,r),s;switch(a=Wi(a??",f"),a.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return a.precision==null&&!isNaN(s=iC(i,o))&&(a.precision=s),Av(a,o)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(s=sC(i,Math.max(Math.abs(e),Math.abs(t))))&&(a.precision=s-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(s=aC(i))&&(a.precision=s-(a.type==="%")*2);break}}return su(a)}function Jr(e){var t=e.domain;return e.ticks=function(r){var a=t();return Vc(a[0],a[a.length-1],r??10)},e.tickFormat=function(r,a){var i=t();return Cv(i[0],i[i.length-1],r??10,a)},e.nice=function(r){r==null&&(r=10);var a=t(),i=0,s=a.length-1,o=a[i],l=a[s],d,h,u=10;for(l<o&&(h=o,o=l,l=h,h=i,i=s,s=h);u-- >0;){if(h=Xc(o,l,r),h===d)return a[i]=o,a[s]=l,t(a);if(h>0)o=Math.floor(o/h)*h,l=Math.ceil(l/h)*h;else if(h<0)o=Math.ceil(o*h)/h,l=Math.floor(l*h)/h;else break;d=h}return e},e}function Ev(){var e=au();return e.copy=function(){return Zi(e,Ev())},Un.apply(e,arguments),Jr(e)}function Pv(e){var t;function r(a){return a==null||isNaN(a=+a)?t:a}return r.invert=r,r.domain=r.range=function(a){return arguments.length?(e=Array.from(a,po),r):e.slice()},r.unknown=function(a){return arguments.length?(t=a,r):t},r.copy=function(){return Pv(e).unknown(t)},e=arguments.length?Array.from(e,po):[0,1],Jr(r)}function Iv(e,t){e=e.slice();var r=0,a=e.length-1,i=e[r],s=e[a],o;return s<i&&(o=r,r=a,a=o,o=i,i=s,s=o),e[r]=t.floor(i),e[a]=t.ceil(s),e}function wm(e){return Math.log(e)}function Sm(e){return Math.exp(e)}function oC(e){return-Math.log(-e)}function lC(e){return-Math.exp(-e)}function cC(e){return isFinite(e)?+("1e"+e):e<0?0:e}function dC(e){return e===10?cC:e===Math.E?Math.exp:t=>Math.pow(e,t)}function uC(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Nm(e){return(t,r)=>-e(-t,r)}function ou(e){const t=e(wm,Sm),r=t.domain;let a=10,i,s;function o(){return i=uC(a),s=dC(a),r()[0]<0?(i=Nm(i),s=Nm(s),e(oC,lC)):e(wm,Sm),t}return t.base=function(l){return arguments.length?(a=+l,o()):a},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const d=r();let h=d[0],u=d[d.length-1];const f=u<h;f&&([h,u]=[u,h]);let m=i(h),p=i(u),x,v;const g=l==null?10:+l;let b=[];if(!(a%1)&&p-m<g){if(m=Math.floor(m),p=Math.ceil(p),h>0){for(;m<=p;++m)for(x=1;x<a;++x)if(v=m<0?x/s(-m):x*s(m),!(v<h)){if(v>u)break;b.push(v)}}else for(;m<=p;++m)for(x=a-1;x>=1;--x)if(v=m>0?x/s(-m):x*s(m),!(v<h)){if(v>u)break;b.push(v)}b.length*2<g&&(b=Vc(h,u,g))}else b=Vc(m,p,Math.min(p-m,g)).map(s);return f?b.reverse():b},t.tickFormat=(l,d)=>{if(l==null&&(l=10),d==null&&(d=a===10?"s":","),typeof d!="function"&&(!(a%1)&&(d=Wi(d)).precision==null&&(d.trim=!0),d=su(d)),l===1/0)return d;const h=Math.max(1,a*l/t.ticks().length);return u=>{let f=u/s(Math.round(i(u)));return f*a<a-.5&&(f*=a),f<=h?d(u):""}},t.nice=()=>r(Iv(r(),{floor:l=>s(Math.floor(i(l))),ceil:l=>s(Math.ceil(i(l)))})),t}function Tv(){const e=ou(ll()).domain([1,10]);return e.copy=()=>Zi(e,Tv()).base(e.base()),Un.apply(e,arguments),e}function km(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Am(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function lu(e){var t=1,r=e(km(t),Am(t));return r.constant=function(a){return arguments.length?e(km(t=+a),Am(t)):t},Jr(r)}function Ov(){var e=lu(ll());return e.copy=function(){return Zi(e,Ov()).constant(e.constant())},Un.apply(e,arguments)}function Cm(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function fC(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function hC(e){return e<0?-e*e:e*e}function cu(e){var t=e(gn,gn),r=1;function a(){return r===1?e(gn,gn):r===.5?e(fC,hC):e(Cm(r),Cm(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,a()):r},Jr(t)}function du(){var e=cu(ll());return e.copy=function(){return Zi(e,du()).exponent(e.exponent())},Un.apply(e,arguments),e}function mC(){return du.apply(null,arguments).exponent(.5)}function Em(e){return Math.sign(e)*e*e}function pC(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function _v(){var e=au(),t=[0,1],r=!1,a;function i(s){var o=pC(e(s));return isNaN(o)?a:r?Math.round(o):o}return i.invert=function(s){return e.invert(Em(s))},i.domain=function(s){return arguments.length?(e.domain(s),i):e.domain()},i.range=function(s){return arguments.length?(e.range((t=Array.from(s,po)).map(Em)),i):t.slice()},i.rangeRound=function(s){return i.range(s).round(!0)},i.round=function(s){return arguments.length?(r=!!s,i):r},i.clamp=function(s){return arguments.length?(e.clamp(s),i):e.clamp()},i.unknown=function(s){return arguments.length?(a=s,i):a},i.copy=function(){return _v(e.domain(),t).round(r).clamp(e.clamp()).unknown(a)},Un.apply(i,arguments),Jr(i)}function Dv(){var e=[],t=[],r=[],a;function i(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=xA(e,o/l);return s}function s(o){return o==null||isNaN(o=+o)?a:t[Qi(r,o)]}return s.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Ur),i()},s.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},s.unknown=function(o){return arguments.length?(a=o,s):a},s.quantiles=function(){return r.slice()},s.copy=function(){return Dv().domain(e).range(t).unknown(a)},Un.apply(s,arguments)}function Mv(){var e=0,t=1,r=1,a=[.5],i=[0,1],s;function o(d){return d!=null&&d<=d?i[Qi(a,d,0,r)]:s}function l(){var d=-1;for(a=new Array(r);++d<r;)a[d]=((d+1)*t-(d-r)*e)/(r+1);return o}return o.domain=function(d){return arguments.length?([e,t]=d,e=+e,t=+t,l()):[e,t]},o.range=function(d){return arguments.length?(r=(i=Array.from(d)).length-1,l()):i.slice()},o.invertExtent=function(d){var h=i.indexOf(d);return h<0?[NaN,NaN]:h<1?[e,a[0]]:h>=r?[a[r-1],t]:[a[h-1],a[h]]},o.unknown=function(d){return arguments.length&&(s=d),o},o.thresholds=function(){return a.slice()},o.copy=function(){return Mv().domain([e,t]).range(i).unknown(s)},Un.apply(Jr(o),arguments)}function $v(){var e=[.5],t=[0,1],r,a=1;function i(s){return s!=null&&s<=s?t[Qi(e,s,0,a)]:r}return i.domain=function(s){return arguments.length?(e=Array.from(s),a=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),a=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return $v().domain(e).range(t).unknown(r)},Un.apply(i,arguments)}const uc=new Date,fc=new Date;function Kt(e,t,r,a){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const o=i(s),l=i.ceil(s);return s-o<l-s?o:l},i.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,l)=>{const d=[];if(s=i.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return d;let h;do d.push(h=new Date(+s)),t(s,l),e(s);while(h<s&&s<o);return d},i.filter=s=>Kt(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!s(o););else for(;--l>=0;)for(;t(o,1),!s(o););}),r&&(i.count=(s,o)=>(uc.setTime(+s),fc.setTime(+o),e(uc),e(fc),Math.floor(r(uc,fc))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(a?o=>a(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const yo=Kt(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);yo.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Kt(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):yo);yo.range;const br=1e3,Bn=br*60,jr=Bn*60,Ar=jr*24,uu=Ar*7,Pm=Ar*30,hc=Ar*365,ua=Kt(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*br)},(e,t)=>(t-e)/br,e=>e.getUTCSeconds());ua.range;const fu=Kt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*br)},(e,t)=>{e.setTime(+e+t*Bn)},(e,t)=>(t-e)/Bn,e=>e.getMinutes());fu.range;const hu=Kt(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Bn)},(e,t)=>(t-e)/Bn,e=>e.getUTCMinutes());hu.range;const mu=Kt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*br-e.getMinutes()*Bn)},(e,t)=>{e.setTime(+e+t*jr)},(e,t)=>(t-e)/jr,e=>e.getHours());mu.range;const pu=Kt(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*jr)},(e,t)=>(t-e)/jr,e=>e.getUTCHours());pu.range;const es=Kt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Bn)/Ar,e=>e.getDate()-1);es.range;const cl=Kt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ar,e=>e.getUTCDate()-1);cl.range;const Lv=Kt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ar,e=>Math.floor(e/Ar));Lv.range;function Ea(e){return Kt(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Bn)/uu)}const dl=Ea(0),vo=Ea(1),gC=Ea(2),yC=Ea(3),Xa=Ea(4),vC=Ea(5),xC=Ea(6);dl.range;vo.range;gC.range;yC.range;Xa.range;vC.range;xC.range;function Pa(e){return Kt(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/uu)}const ul=Pa(0),xo=Pa(1),bC=Pa(2),jC=Pa(3),Qa=Pa(4),wC=Pa(5),SC=Pa(6);ul.range;xo.range;bC.range;jC.range;Qa.range;wC.range;SC.range;const gu=Kt(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());gu.range;const yu=Kt(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());yu.range;const Cr=Kt(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Cr.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Kt(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Cr.range;const Er=Kt(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Er.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Kt(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Er.range;function Rv(e,t,r,a,i,s){const o=[[ua,1,br],[ua,5,5*br],[ua,15,15*br],[ua,30,30*br],[s,1,Bn],[s,5,5*Bn],[s,15,15*Bn],[s,30,30*Bn],[i,1,jr],[i,3,3*jr],[i,6,6*jr],[i,12,12*jr],[a,1,Ar],[a,2,2*Ar],[r,1,uu],[t,1,Pm],[t,3,3*Pm],[e,1,hc]];function l(h,u,f){const m=u<h;m&&([h,u]=[u,h]);const p=f&&typeof f.range=="function"?f:d(h,u,f),x=p?p.range(h,+u+1):[];return m?x.reverse():x}function d(h,u,f){const m=Math.abs(u-h)/f,p=Jd(([,,g])=>g).right(o,m);if(p===o.length)return e.every(Qc(h/hc,u/hc,f));if(p===0)return yo.every(Math.max(Qc(h,u,f),1));const[x,v]=o[m/o[p-1][2]<o[p][2]/m?p-1:p];return x.every(v)}return[l,d]}const[NC,kC]=Rv(Er,yu,ul,Lv,pu,hu),[AC,CC]=Rv(Cr,gu,dl,es,mu,fu);function mc(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function pc(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ji(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function EC(e){var t=e.dateTime,r=e.date,a=e.time,i=e.periods,s=e.days,o=e.shortDays,l=e.months,d=e.shortMonths,h=wi(i),u=Si(i),f=wi(s),m=Si(s),p=wi(o),x=Si(o),v=wi(l),g=Si(l),b=wi(d),y=Si(d),N={a:ae,A:se,b:H,B:q,c:null,d:Mm,e:Mm,f:QC,g:oE,G:cE,H:GC,I:VC,j:XC,L:zv,m:JC,M:ZC,p:C,q:T,Q:Rm,s:zm,S:eE,u:tE,U:nE,V:rE,w:aE,W:iE,x:null,X:null,y:sE,Y:lE,Z:dE,"%":Lm},A={a:W,A:I,b:U,B:K,c:null,d:$m,e:$m,f:mE,g:NE,G:AE,H:uE,I:fE,j:hE,L:Bv,m:pE,M:gE,p:Y,q:M,Q:Rm,s:zm,S:yE,u:vE,U:xE,V:bE,w:jE,W:wE,x:null,X:null,y:SE,Y:kE,Z:CE,"%":Lm},E={a:L,A:j,b:S,B:R,c:O,d:_m,e:_m,f:UC,g:Om,G:Tm,H:Dm,I:Dm,j:WC,L:qC,m:zC,M:BC,p:$,q:RC,Q:YC,s:KC,S:FC,u:_C,U:DC,V:MC,w:OC,W:$C,x:z,X:Z,y:Om,Y:Tm,Z:LC,"%":HC};N.x=w(r,N),N.X=w(a,N),N.c=w(t,N),A.x=w(r,A),A.X=w(a,A),A.c=w(t,A);function w(D,oe){return function(F){var G=[],de=-1,be=0,ke=D.length,ye,Ce,J;for(F instanceof Date||(F=new Date(+F));++de<ke;)D.charCodeAt(de)===37&&(G.push(D.slice(be,de)),(Ce=Im[ye=D.charAt(++de)])!=null?ye=D.charAt(++de):Ce=ye==="e"?" ":"0",(J=oe[ye])&&(ye=J(F,Ce)),G.push(ye),be=de+1);return G.push(D.slice(be,de)),G.join("")}}function P(D,oe){return function(F){var G=ji(1900,void 0,1),de=_(G,D,F+="",0),be,ke;if(de!=F.length)return null;if("Q"in G)return new Date(G.Q);if("s"in G)return new Date(G.s*1e3+("L"in G?G.L:0));if(oe&&!("Z"in G)&&(G.Z=0),"p"in G&&(G.H=G.H%12+G.p*12),G.m===void 0&&(G.m="q"in G?G.q:0),"V"in G){if(G.V<1||G.V>53)return null;"w"in G||(G.w=1),"Z"in G?(be=pc(ji(G.y,0,1)),ke=be.getUTCDay(),be=ke>4||ke===0?xo.ceil(be):xo(be),be=cl.offset(be,(G.V-1)*7),G.y=be.getUTCFullYear(),G.m=be.getUTCMonth(),G.d=be.getUTCDate()+(G.w+6)%7):(be=mc(ji(G.y,0,1)),ke=be.getDay(),be=ke>4||ke===0?vo.ceil(be):vo(be),be=es.offset(be,(G.V-1)*7),G.y=be.getFullYear(),G.m=be.getMonth(),G.d=be.getDate()+(G.w+6)%7)}else("W"in G||"U"in G)&&("w"in G||(G.w="u"in G?G.u%7:"W"in G?1:0),ke="Z"in G?pc(ji(G.y,0,1)).getUTCDay():mc(ji(G.y,0,1)).getDay(),G.m=0,G.d="W"in G?(G.w+6)%7+G.W*7-(ke+5)%7:G.w+G.U*7-(ke+6)%7);return"Z"in G?(G.H+=G.Z/100|0,G.M+=G.Z%100,pc(G)):mc(G)}}function _(D,oe,F,G){for(var de=0,be=oe.length,ke=F.length,ye,Ce;de<be;){if(G>=ke)return-1;if(ye=oe.charCodeAt(de++),ye===37){if(ye=oe.charAt(de++),Ce=E[ye in Im?oe.charAt(de++):ye],!Ce||(G=Ce(D,F,G))<0)return-1}else if(ye!=F.charCodeAt(G++))return-1}return G}function $(D,oe,F){var G=h.exec(oe.slice(F));return G?(D.p=u.get(G[0].toLowerCase()),F+G[0].length):-1}function L(D,oe,F){var G=p.exec(oe.slice(F));return G?(D.w=x.get(G[0].toLowerCase()),F+G[0].length):-1}function j(D,oe,F){var G=f.exec(oe.slice(F));return G?(D.w=m.get(G[0].toLowerCase()),F+G[0].length):-1}function S(D,oe,F){var G=b.exec(oe.slice(F));return G?(D.m=y.get(G[0].toLowerCase()),F+G[0].length):-1}function R(D,oe,F){var G=v.exec(oe.slice(F));return G?(D.m=g.get(G[0].toLowerCase()),F+G[0].length):-1}function O(D,oe,F){return _(D,t,oe,F)}function z(D,oe,F){return _(D,r,oe,F)}function Z(D,oe,F){return _(D,a,oe,F)}function ae(D){return o[D.getDay()]}function se(D){return s[D.getDay()]}function H(D){return d[D.getMonth()]}function q(D){return l[D.getMonth()]}function C(D){return i[+(D.getHours()>=12)]}function T(D){return 1+~~(D.getMonth()/3)}function W(D){return o[D.getUTCDay()]}function I(D){return s[D.getUTCDay()]}function U(D){return d[D.getUTCMonth()]}function K(D){return l[D.getUTCMonth()]}function Y(D){return i[+(D.getUTCHours()>=12)]}function M(D){return 1+~~(D.getUTCMonth()/3)}return{format:function(D){var oe=w(D+="",N);return oe.toString=function(){return D},oe},parse:function(D){var oe=P(D+="",!1);return oe.toString=function(){return D},oe},utcFormat:function(D){var oe=w(D+="",A);return oe.toString=function(){return D},oe},utcParse:function(D){var oe=P(D+="",!0);return oe.toString=function(){return D},oe}}}var Im={"-":"",_:" ",0:"0"},nn=/^\s*\d+/,PC=/^%/,IC=/[\\^$*+?|[\]().{}]/g;function tt(e,t,r){var a=e<0?"-":"",i=(a?-e:e)+"",s=i.length;return a+(s<r?new Array(r-s+1).join(t)+i:i)}function TC(e){return e.replace(IC,"\\$&")}function wi(e){return new RegExp("^(?:"+e.map(TC).join("|")+")","i")}function Si(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function OC(e,t,r){var a=nn.exec(t.slice(r,r+1));return a?(e.w=+a[0],r+a[0].length):-1}function _C(e,t,r){var a=nn.exec(t.slice(r,r+1));return a?(e.u=+a[0],r+a[0].length):-1}function DC(e,t,r){var a=nn.exec(t.slice(r,r+2));return a?(e.U=+a[0],r+a[0].length):-1}function MC(e,t,r){var a=nn.exec(t.slice(r,r+2));return a?(e.V=+a[0],r+a[0].length):-1}function $C(e,t,r){var a=nn.exec(t.slice(r,r+2));return a?(e.W=+a[0],r+a[0].length):-1}function Tm(e,t,r){var a=nn.exec(t.slice(r,r+4));return a?(e.y=+a[0],r+a[0].length):-1}function Om(e,t,r){var a=nn.exec(t.slice(r,r+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),r+a[0].length):-1}function LC(e,t,r){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),r+a[0].length):-1}function RC(e,t,r){var a=nn.exec(t.slice(r,r+1));return a?(e.q=a[0]*3-3,r+a[0].length):-1}function zC(e,t,r){var a=nn.exec(t.slice(r,r+2));return a?(e.m=a[0]-1,r+a[0].length):-1}function _m(e,t,r){var a=nn.exec(t.slice(r,r+2));return a?(e.d=+a[0],r+a[0].length):-1}function WC(e,t,r){var a=nn.exec(t.slice(r,r+3));return a?(e.m=0,e.d=+a[0],r+a[0].length):-1}function Dm(e,t,r){var a=nn.exec(t.slice(r,r+2));return a?(e.H=+a[0],r+a[0].length):-1}function BC(e,t,r){var a=nn.exec(t.slice(r,r+2));return a?(e.M=+a[0],r+a[0].length):-1}function FC(e,t,r){var a=nn.exec(t.slice(r,r+2));return a?(e.S=+a[0],r+a[0].length):-1}function qC(e,t,r){var a=nn.exec(t.slice(r,r+3));return a?(e.L=+a[0],r+a[0].length):-1}function UC(e,t,r){var a=nn.exec(t.slice(r,r+6));return a?(e.L=Math.floor(a[0]/1e3),r+a[0].length):-1}function HC(e,t,r){var a=PC.exec(t.slice(r,r+1));return a?r+a[0].length:-1}function YC(e,t,r){var a=nn.exec(t.slice(r));return a?(e.Q=+a[0],r+a[0].length):-1}function KC(e,t,r){var a=nn.exec(t.slice(r));return a?(e.s=+a[0],r+a[0].length):-1}function Mm(e,t){return tt(e.getDate(),t,2)}function GC(e,t){return tt(e.getHours(),t,2)}function VC(e,t){return tt(e.getHours()%12||12,t,2)}function XC(e,t){return tt(1+es.count(Cr(e),e),t,3)}function zv(e,t){return tt(e.getMilliseconds(),t,3)}function QC(e,t){return zv(e,t)+"000"}function JC(e,t){return tt(e.getMonth()+1,t,2)}function ZC(e,t){return tt(e.getMinutes(),t,2)}function eE(e,t){return tt(e.getSeconds(),t,2)}function tE(e){var t=e.getDay();return t===0?7:t}function nE(e,t){return tt(dl.count(Cr(e)-1,e),t,2)}function Wv(e){var t=e.getDay();return t>=4||t===0?Xa(e):Xa.ceil(e)}function rE(e,t){return e=Wv(e),tt(Xa.count(Cr(e),e)+(Cr(e).getDay()===4),t,2)}function aE(e){return e.getDay()}function iE(e,t){return tt(vo.count(Cr(e)-1,e),t,2)}function sE(e,t){return tt(e.getFullYear()%100,t,2)}function oE(e,t){return e=Wv(e),tt(e.getFullYear()%100,t,2)}function lE(e,t){return tt(e.getFullYear()%1e4,t,4)}function cE(e,t){var r=e.getDay();return e=r>=4||r===0?Xa(e):Xa.ceil(e),tt(e.getFullYear()%1e4,t,4)}function dE(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+tt(t/60|0,"0",2)+tt(t%60,"0",2)}function $m(e,t){return tt(e.getUTCDate(),t,2)}function uE(e,t){return tt(e.getUTCHours(),t,2)}function fE(e,t){return tt(e.getUTCHours()%12||12,t,2)}function hE(e,t){return tt(1+cl.count(Er(e),e),t,3)}function Bv(e,t){return tt(e.getUTCMilliseconds(),t,3)}function mE(e,t){return Bv(e,t)+"000"}function pE(e,t){return tt(e.getUTCMonth()+1,t,2)}function gE(e,t){return tt(e.getUTCMinutes(),t,2)}function yE(e,t){return tt(e.getUTCSeconds(),t,2)}function vE(e){var t=e.getUTCDay();return t===0?7:t}function xE(e,t){return tt(ul.count(Er(e)-1,e),t,2)}function Fv(e){var t=e.getUTCDay();return t>=4||t===0?Qa(e):Qa.ceil(e)}function bE(e,t){return e=Fv(e),tt(Qa.count(Er(e),e)+(Er(e).getUTCDay()===4),t,2)}function jE(e){return e.getUTCDay()}function wE(e,t){return tt(xo.count(Er(e)-1,e),t,2)}function SE(e,t){return tt(e.getUTCFullYear()%100,t,2)}function NE(e,t){return e=Fv(e),tt(e.getUTCFullYear()%100,t,2)}function kE(e,t){return tt(e.getUTCFullYear()%1e4,t,4)}function AE(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Qa(e):Qa.ceil(e),tt(e.getUTCFullYear()%1e4,t,4)}function CE(){return"+0000"}function Lm(){return"%"}function Rm(e){return+e}function zm(e){return Math.floor(+e/1e3)}var za,qv,Uv;EE({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function EE(e){return za=EC(e),qv=za.format,za.parse,Uv=za.utcFormat,za.utcParse,za}function PE(e){return new Date(e)}function IE(e){return e instanceof Date?+e:+new Date(+e)}function vu(e,t,r,a,i,s,o,l,d,h){var u=au(),f=u.invert,m=u.domain,p=h(".%L"),x=h(":%S"),v=h("%I:%M"),g=h("%I %p"),b=h("%a %d"),y=h("%b %d"),N=h("%B"),A=h("%Y");function E(w){return(d(w)<w?p:l(w)<w?x:o(w)<w?v:s(w)<w?g:a(w)<w?i(w)<w?b:y:r(w)<w?N:A)(w)}return u.invert=function(w){return new Date(f(w))},u.domain=function(w){return arguments.length?m(Array.from(w,IE)):m().map(PE)},u.ticks=function(w){var P=m();return e(P[0],P[P.length-1],w??10)},u.tickFormat=function(w,P){return P==null?E:h(P)},u.nice=function(w){var P=m();return(!w||typeof w.range!="function")&&(w=t(P[0],P[P.length-1],w??10)),w?m(Iv(P,w)):u},u.copy=function(){return Zi(u,vu(e,t,r,a,i,s,o,l,d,h))},u}function TE(){return Un.apply(vu(AC,CC,Cr,gu,dl,es,mu,fu,ua,qv).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function OE(){return Un.apply(vu(NC,kC,Er,yu,ul,cl,pu,hu,ua,Uv).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function fl(){var e=0,t=1,r,a,i,s,o=gn,l=!1,d;function h(f){return f==null||isNaN(f=+f)?d:o(i===0?.5:(f=(s(f)-r)*i,l?Math.max(0,Math.min(1,f)):f))}h.domain=function(f){return arguments.length?([e,t]=f,r=s(e=+e),a=s(t=+t),i=r===a?0:1/(a-r),h):[e,t]},h.clamp=function(f){return arguments.length?(l=!!f,h):l},h.interpolator=function(f){return arguments.length?(o=f,h):o};function u(f){return function(m){var p,x;return arguments.length?([p,x]=m,o=f(p,x),h):[o(0),o(1)]}}return h.range=u(ei),h.rangeRound=u(ru),h.unknown=function(f){return arguments.length?(d=f,h):d},function(f){return s=f,r=f(e),a=f(t),i=r===a?0:1/(a-r),h}}function Zr(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Hv(){var e=Jr(fl()(gn));return e.copy=function(){return Zr(e,Hv())},_r.apply(e,arguments)}function Yv(){var e=ou(fl()).domain([1,10]);return e.copy=function(){return Zr(e,Yv()).base(e.base())},_r.apply(e,arguments)}function Kv(){var e=lu(fl());return e.copy=function(){return Zr(e,Kv()).constant(e.constant())},_r.apply(e,arguments)}function xu(){var e=cu(fl());return e.copy=function(){return Zr(e,xu()).exponent(e.exponent())},_r.apply(e,arguments)}function _E(){return xu.apply(null,arguments).exponent(.5)}function Gv(){var e=[],t=gn;function r(a){if(a!=null&&!isNaN(a=+a))return t((Qi(e,a,1)-1)/(e.length-1))}return r.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let i of a)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(Ur),r},r.interpolator=function(a){return arguments.length?(t=a,r):t},r.range=function(){return e.map((a,i)=>t(i/(e.length-1)))},r.quantiles=function(a){return Array.from({length:a+1},(i,s)=>vA(e,s/a))},r.copy=function(){return Gv(t).domain(e)},_r.apply(r,arguments)}function hl(){var e=0,t=.5,r=1,a=1,i,s,o,l,d,h=gn,u,f=!1,m;function p(v){return isNaN(v=+v)?m:(v=.5+((v=+u(v))-s)*(a*v<a*s?l:d),h(f?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t,r]=v,i=u(e=+e),s=u(t=+t),o=u(r=+r),l=i===s?0:.5/(s-i),d=s===o?0:.5/(o-s),a=s<i?-1:1,p):[e,t,r]},p.clamp=function(v){return arguments.length?(f=!!v,p):f},p.interpolator=function(v){return arguments.length?(h=v,p):h};function x(v){return function(g){var b,y,N;return arguments.length?([b,y,N]=g,h=HA(v,[b,y,N]),p):[h(0),h(.5),h(1)]}}return p.range=x(ei),p.rangeRound=x(ru),p.unknown=function(v){return arguments.length?(m=v,p):m},function(v){return u=v,i=v(e),s=v(t),o=v(r),l=i===s?0:.5/(s-i),d=s===o?0:.5/(o-s),a=s<i?-1:1,p}}function Vv(){var e=Jr(hl()(gn));return e.copy=function(){return Zr(e,Vv())},_r.apply(e,arguments)}function Xv(){var e=ou(hl()).domain([.1,1,10]);return e.copy=function(){return Zr(e,Xv()).base(e.base())},_r.apply(e,arguments)}function Qv(){var e=lu(hl());return e.copy=function(){return Zr(e,Qv()).constant(e.constant())},_r.apply(e,arguments)}function bu(){var e=cu(hl());return e.copy=function(){return Zr(e,bu()).exponent(e.exponent())},_r.apply(e,arguments)}function DE(){return bu.apply(null,arguments).exponent(.5)}const Ai=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:eu,scaleDiverging:Vv,scaleDivergingLog:Xv,scaleDivergingPow:bu,scaleDivergingSqrt:DE,scaleDivergingSymlog:Qv,scaleIdentity:Pv,scaleImplicit:Jc,scaleLinear:Ev,scaleLog:Tv,scaleOrdinal:Zd,scalePoint:jA,scalePow:du,scaleQuantile:Dv,scaleQuantize:Mv,scaleRadial:_v,scaleSequential:Hv,scaleSequentialLog:Yv,scaleSequentialPow:xu,scaleSequentialQuantile:Gv,scaleSequentialSqrt:_E,scaleSequentialSymlog:Kv,scaleSqrt:mC,scaleSymlog:Ov,scaleThreshold:$v,scaleTime:TE,scaleUtc:OE,tickFormat:Cv},Symbol.toStringTag,{value:"Module"}));var ea=e=>e.chartData,ju=pe([ea],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),ml=(e,t,r,a)=>a?ju(e):ea(e);function Sa(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Lt(t)&&Lt(r))return!0}return!1}function Wm(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function Jv(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,a]=e,i,s;if(Lt(r))i=r;else if(typeof r=="function")return;if(Lt(a))s=a;else if(typeof a=="function")return;var o=[i,s];if(Sa(o))return o}}function ME(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var a=e(t,r);if(Sa(a))return Wm(a,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[i,s]=e,o,l;if(i==="auto")t!=null&&(o=Math.min(...t));else if(Me(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[0]))}catch{}else if(typeof i=="string"&&Ih.test(i)){var d=Ih.exec(i);if(d==null||t==null)o=void 0;else{var h=+d[1];o=t[0]-h}}else o=t==null?void 0:t[0];if(s==="auto")t!=null&&(l=Math.max(...t));else if(Me(s))l=s;else if(typeof s=="function")try{t!=null&&(l=s(t==null?void 0:t[1]))}catch{}else if(typeof s=="string"&&Th.test(s)){var u=Th.exec(s);if(u==null||t==null)l=void 0;else{var f=+u[1];l=t[1]+f}}else l=t==null?void 0:t[1];var m=[o,l];if(Sa(m))return t==null?m:Wm(m,t,r)}}}var ti=1e9,$E={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Su,wt=!0,qn="[DecimalError] ",ga=qn+"Invalid argument: ",wu=qn+"Exponent out of range: ",ni=Math.floor,ca=Math.pow,LE=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Tn,Jt=1e7,yt=7,Zv=9007199254740991,bo=ni(Zv/yt),_e={};_e.absoluteValue=_e.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};_e.comparedTo=_e.cmp=function(e){var t,r,a,i,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(a=s.d.length,i=e.d.length,t=0,r=a<i?a:i;t<r;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return a===i?0:a>i^s.s<0?1:-1};_e.decimalPlaces=_e.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*yt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};_e.dividedBy=_e.div=function(e){return Sr(this,new this.constructor(e))};_e.dividedToIntegerBy=_e.idiv=function(e){var t=this,r=t.constructor;return dt(Sr(t,new r(e),0,1),r.precision)};_e.equals=_e.eq=function(e){return!this.cmp(e)};_e.exponent=function(){return Ft(this)};_e.greaterThan=_e.gt=function(e){return this.cmp(e)>0};_e.greaterThanOrEqualTo=_e.gte=function(e){return this.cmp(e)>=0};_e.isInteger=_e.isint=function(){return this.e>this.d.length-2};_e.isNegative=_e.isneg=function(){return this.s<0};_e.isPositive=_e.ispos=function(){return this.s>0};_e.isZero=function(){return this.s===0};_e.lessThan=_e.lt=function(e){return this.cmp(e)<0};_e.lessThanOrEqualTo=_e.lte=function(e){return this.cmp(e)<1};_e.logarithm=_e.log=function(e){var t,r=this,a=r.constructor,i=a.precision,s=i+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(Tn))throw Error(qn+"NaN");if(r.s<1)throw Error(qn+(r.s?"NaN":"-Infinity"));return r.eq(Tn)?new a(0):(wt=!1,t=Sr(Bi(r,s),Bi(e,s),s),wt=!0,dt(t,i))};_e.minus=_e.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?n0(t,e):e0(t,(e.s=-e.s,e))};_e.modulo=_e.mod=function(e){var t,r=this,a=r.constructor,i=a.precision;if(e=new a(e),!e.s)throw Error(qn+"NaN");return r.s?(wt=!1,t=Sr(r,e,0,1).times(e),wt=!0,r.minus(t)):dt(new a(r),i)};_e.naturalExponential=_e.exp=function(){return t0(this)};_e.naturalLogarithm=_e.ln=function(){return Bi(this)};_e.negated=_e.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};_e.plus=_e.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?e0(t,e):n0(t,(e.s=-e.s,e))};_e.precision=_e.sd=function(e){var t,r,a,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ga+e);if(t=Ft(i)+1,a=i.d.length-1,r=a*yt+1,a=i.d[a],a){for(;a%10==0;a/=10)r--;for(a=i.d[0];a>=10;a/=10)r++}return e&&t>r?t:r};_e.squareRoot=_e.sqrt=function(){var e,t,r,a,i,s,o,l=this,d=l.constructor;if(l.s<1){if(!l.s)return new d(0);throw Error(qn+"NaN")}for(e=Ft(l),wt=!1,i=Math.sqrt(+l),i==0||i==1/0?(t=or(l.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=ni((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),a=new d(t)):a=new d(i.toString()),r=d.precision,i=o=r+3;;)if(s=a,a=s.plus(Sr(l,s,o+2)).times(.5),or(s.d).slice(0,o)===(t=or(a.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(dt(s,r+1,0),s.times(s).eq(l)){a=s;break}}else if(t!="9999")break;o+=4}return wt=!0,dt(a,r)};_e.times=_e.mul=function(e){var t,r,a,i,s,o,l,d,h,u=this,f=u.constructor,m=u.d,p=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,r=u.e+e.e,d=m.length,h=p.length,d<h&&(s=m,m=p,p=s,o=d,d=h,h=o),s=[],o=d+h,a=o;a--;)s.push(0);for(a=h;--a>=0;){for(t=0,i=d+a;i>a;)l=s[i]+p[a]*m[i-a-1]+t,s[i--]=l%Jt|0,t=l/Jt|0;s[i]=(s[i]+t)%Jt|0}for(;!s[--o];)s.pop();return t?++r:s.shift(),e.d=s,e.e=r,wt?dt(e,f.precision):e};_e.toDecimalPlaces=_e.todp=function(e,t){var r=this,a=r.constructor;return r=new a(r),e===void 0?r:(ur(e,0,ti),t===void 0?t=a.rounding:ur(t,0,8),dt(r,e+Ft(r)+1,t))};_e.toExponential=function(e,t){var r,a=this,i=a.constructor;return e===void 0?r=Na(a,!0):(ur(e,0,ti),t===void 0?t=i.rounding:ur(t,0,8),a=dt(new i(a),e+1,t),r=Na(a,!0,e+1)),r};_e.toFixed=function(e,t){var r,a,i=this,s=i.constructor;return e===void 0?Na(i):(ur(e,0,ti),t===void 0?t=s.rounding:ur(t,0,8),a=dt(new s(i),e+Ft(i)+1,t),r=Na(a.abs(),!1,e+Ft(a)+1),i.isneg()&&!i.isZero()?"-"+r:r)};_e.toInteger=_e.toint=function(){var e=this,t=e.constructor;return dt(new t(e),Ft(e)+1,t.rounding)};_e.toNumber=function(){return+this};_e.toPower=_e.pow=function(e){var t,r,a,i,s,o,l=this,d=l.constructor,h=12,u=+(e=new d(e));if(!e.s)return new d(Tn);if(l=new d(l),!l.s){if(e.s<1)throw Error(qn+"Infinity");return l}if(l.eq(Tn))return l;if(a=d.precision,e.eq(Tn))return dt(l,a);if(t=e.e,r=e.d.length-1,o=t>=r,s=l.s,o){if((r=u<0?-u:u)<=Zv){for(i=new d(Tn),t=Math.ceil(a/yt+4),wt=!1;r%2&&(i=i.times(l),Fm(i.d,t)),r=ni(r/2),r!==0;)l=l.times(l),Fm(l.d,t);return wt=!0,e.s<0?new d(Tn).div(i):dt(i,a)}}else if(s<0)throw Error(qn+"NaN");return s=s<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,wt=!1,i=e.times(Bi(l,a+h)),wt=!0,i=t0(i),i.s=s,i};_e.toPrecision=function(e,t){var r,a,i=this,s=i.constructor;return e===void 0?(r=Ft(i),a=Na(i,r<=s.toExpNeg||r>=s.toExpPos)):(ur(e,1,ti),t===void 0?t=s.rounding:ur(t,0,8),i=dt(new s(i),e,t),r=Ft(i),a=Na(i,e<=r||r<=s.toExpNeg,e)),a};_e.toSignificantDigits=_e.tosd=function(e,t){var r=this,a=r.constructor;return e===void 0?(e=a.precision,t=a.rounding):(ur(e,1,ti),t===void 0?t=a.rounding:ur(t,0,8)),dt(new a(r),e,t)};_e.toString=_e.valueOf=_e.val=_e.toJSON=_e[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ft(e),r=e.constructor;return Na(e,t<=r.toExpNeg||t>=r.toExpPos)};function e0(e,t){var r,a,i,s,o,l,d,h,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),wt?dt(t,f):t;if(d=e.d,h=t.d,o=e.e,i=t.e,d=d.slice(),s=o-i,s){for(s<0?(a=d,s=-s,l=h.length):(a=h,i=o,l=d.length),o=Math.ceil(f/yt),l=o>l?o+1:l+1,s>l&&(s=l,a.length=1),a.reverse();s--;)a.push(0);a.reverse()}for(l=d.length,s=h.length,l-s<0&&(s=l,a=h,h=d,d=a),r=0;s;)r=(d[--s]=d[s]+h[s]+r)/Jt|0,d[s]%=Jt;for(r&&(d.unshift(r),++i),l=d.length;d[--l]==0;)d.pop();return t.d=d,t.e=i,wt?dt(t,f):t}function ur(e,t,r){if(e!==~~e||e<t||e>r)throw Error(ga+e)}function or(e){var t,r,a,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)a=e[t]+"",r=yt-a.length,r&&(s+=Br(r)),s+=a;o=e[t],a=o+"",r=yt-a.length,r&&(s+=Br(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Sr=function(){function e(a,i){var s,o=0,l=a.length;for(a=a.slice();l--;)s=a[l]*i+o,a[l]=s%Jt|0,o=s/Jt|0;return o&&a.unshift(o),a}function t(a,i,s,o){var l,d;if(s!=o)d=s>o?1:-1;else for(l=d=0;l<s;l++)if(a[l]!=i[l]){d=a[l]>i[l]?1:-1;break}return d}function r(a,i,s){for(var o=0;s--;)a[s]-=o,o=a[s]<i[s]?1:0,a[s]=o*Jt+a[s]-i[s];for(;!a[0]&&a.length>1;)a.shift()}return function(a,i,s,o){var l,d,h,u,f,m,p,x,v,g,b,y,N,A,E,w,P,_,$=a.constructor,L=a.s==i.s?1:-1,j=a.d,S=i.d;if(!a.s)return new $(a);if(!i.s)throw Error(qn+"Division by zero");for(d=a.e-i.e,P=S.length,E=j.length,p=new $(L),x=p.d=[],h=0;S[h]==(j[h]||0);)++h;if(S[h]>(j[h]||0)&&--d,s==null?y=s=$.precision:o?y=s+(Ft(a)-Ft(i))+1:y=s,y<0)return new $(0);if(y=y/yt+2|0,h=0,P==1)for(u=0,S=S[0],y++;(h<E||u)&&y--;h++)N=u*Jt+(j[h]||0),x[h]=N/S|0,u=N%S|0;else{for(u=Jt/(S[0]+1)|0,u>1&&(S=e(S,u),j=e(j,u),P=S.length,E=j.length),A=P,v=j.slice(0,P),g=v.length;g<P;)v[g++]=0;_=S.slice(),_.unshift(0),w=S[0],S[1]>=Jt/2&&++w;do u=0,l=t(S,v,P,g),l<0?(b=v[0],P!=g&&(b=b*Jt+(v[1]||0)),u=b/w|0,u>1?(u>=Jt&&(u=Jt-1),f=e(S,u),m=f.length,g=v.length,l=t(f,v,m,g),l==1&&(u--,r(f,P<m?_:S,m))):(u==0&&(l=u=1),f=S.slice()),m=f.length,m<g&&f.unshift(0),r(v,f,g),l==-1&&(g=v.length,l=t(S,v,P,g),l<1&&(u++,r(v,P<g?_:S,g))),g=v.length):l===0&&(u++,v=[0]),x[h++]=u,l&&v[0]?v[g++]=j[A]||0:(v=[j[A]],g=1);while((A++<E||v[0]!==void 0)&&y--)}return x[0]||x.shift(),p.e=d,dt(p,o?s+Ft(p)+1:s)}}();function t0(e,t){var r,a,i,s,o,l,d=0,h=0,u=e.constructor,f=u.precision;if(Ft(e)>16)throw Error(wu+Ft(e));if(!e.s)return new u(Tn);for(wt=!1,l=f,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),h+=5;for(a=Math.log(ca(2,h))/Math.LN10*2+5|0,l+=a,r=i=s=new u(Tn),u.precision=l;;){if(i=dt(i.times(e),l),r=r.times(++d),o=s.plus(Sr(i,r,l)),or(o.d).slice(0,l)===or(s.d).slice(0,l)){for(;h--;)s=dt(s.times(s),l);return u.precision=f,t==null?(wt=!0,dt(s,f)):s}s=o}}function Ft(e){for(var t=e.e*yt,r=e.d[0];r>=10;r/=10)t++;return t}function gc(e,t,r){if(t>e.LN10.sd())throw wt=!0,r&&(e.precision=r),Error(qn+"LN10 precision limit exceeded");return dt(new e(e.LN10),t)}function Br(e){for(var t="";e--;)t+="0";return t}function Bi(e,t){var r,a,i,s,o,l,d,h,u,f=1,m=10,p=e,x=p.d,v=p.constructor,g=v.precision;if(p.s<1)throw Error(qn+(p.s?"NaN":"-Infinity"));if(p.eq(Tn))return new v(0);if(t==null?(wt=!1,h=g):h=t,p.eq(10))return t==null&&(wt=!0),gc(v,h);if(h+=m,v.precision=h,r=or(x),a=r.charAt(0),s=Ft(p),Math.abs(s)<15e14){for(;a<7&&a!=1||a==1&&r.charAt(1)>3;)p=p.times(e),r=or(p.d),a=r.charAt(0),f++;s=Ft(p),a>1?(p=new v("0."+r),s++):p=new v(a+"."+r.slice(1))}else return d=gc(v,h+2,g).times(s+""),p=Bi(new v(a+"."+r.slice(1)),h-m).plus(d),v.precision=g,t==null?(wt=!0,dt(p,g)):p;for(l=o=p=Sr(p.minus(Tn),p.plus(Tn),h),u=dt(p.times(p),h),i=3;;){if(o=dt(o.times(u),h),d=l.plus(Sr(o,new v(i),h)),or(d.d).slice(0,h)===or(l.d).slice(0,h))return l=l.times(2),s!==0&&(l=l.plus(gc(v,h+2,g).times(s+""))),l=Sr(l,new v(f),h),v.precision=g,t==null?(wt=!0,dt(l,g)):l;l=d,i+=2}}function Bm(e,t){var r,a,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(r<0&&(r=a),r+=+t.slice(a+1),t=t.substring(0,a)):r<0&&(r=t.length),a=0;t.charCodeAt(a)===48;)++a;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(a,i),t){if(i-=a,r=r-a-1,e.e=ni(r/yt),e.d=[],a=(r+1)%yt,r<0&&(a+=yt),a<i){for(a&&e.d.push(+t.slice(0,a)),i-=yt;a<i;)e.d.push(+t.slice(a,a+=yt));t=t.slice(a),a=yt-t.length}else a-=i;for(;a--;)t+="0";if(e.d.push(+t),wt&&(e.e>bo||e.e<-bo))throw Error(wu+r)}else e.s=0,e.e=0,e.d=[0];return e}function dt(e,t,r){var a,i,s,o,l,d,h,u,f=e.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(a=t-o,a<0)a+=yt,i=t,h=f[u=0];else{if(u=Math.ceil((a+1)/yt),s=f.length,u>=s)return e;for(h=s=f[u],o=1;s>=10;s/=10)o++;a%=yt,i=a-yt+o}if(r!==void 0&&(s=ca(10,o-i-1),l=h/s%10|0,d=t<0||f[u+1]!==void 0||h%s,d=r<4?(l||d)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||d||r==6&&(a>0?i>0?h/ca(10,o-i):0:f[u-1])%10&1||r==(e.s<0?8:7))),t<1||!f[0])return d?(s=Ft(e),f.length=1,t=t-s-1,f[0]=ca(10,(yt-t%yt)%yt),e.e=ni(-t/yt)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(a==0?(f.length=u,s=1,u--):(f.length=u+1,s=ca(10,yt-a),f[u]=i>0?(h/ca(10,o-i)%ca(10,i)|0)*s:0),d)for(;;)if(u==0){(f[0]+=s)==Jt&&(f[0]=1,++e.e);break}else{if(f[u]+=s,f[u]!=Jt)break;f[u--]=0,s=1}for(a=f.length;f[--a]===0;)f.pop();if(wt&&(e.e>bo||e.e<-bo))throw Error(wu+Ft(e));return e}function n0(e,t){var r,a,i,s,o,l,d,h,u,f,m=e.constructor,p=m.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new m(e),wt?dt(t,p):t;if(d=e.d,f=t.d,a=t.e,h=e.e,d=d.slice(),o=h-a,o){for(u=o<0,u?(r=d,o=-o,l=f.length):(r=f,a=h,l=d.length),i=Math.max(Math.ceil(p/yt),l)+2,o>i&&(o=i,r.length=1),r.reverse(),i=o;i--;)r.push(0);r.reverse()}else{for(i=d.length,l=f.length,u=i<l,u&&(l=i),i=0;i<l;i++)if(d[i]!=f[i]){u=d[i]<f[i];break}o=0}for(u&&(r=d,d=f,f=r,t.s=-t.s),l=d.length,i=f.length-l;i>0;--i)d[l++]=0;for(i=f.length;i>o;){if(d[--i]<f[i]){for(s=i;s&&d[--s]===0;)d[s]=Jt-1;--d[s],d[i]+=Jt}d[i]-=f[i]}for(;d[--l]===0;)d.pop();for(;d[0]===0;d.shift())--a;return d[0]?(t.d=d,t.e=a,wt?dt(t,p):t):new m(0)}function Na(e,t,r){var a,i=Ft(e),s=or(e.d),o=s.length;return t?(r&&(a=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+Br(a):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Br(-i-1)+s,r&&(a=r-o)>0&&(s+=Br(a))):i>=o?(s+=Br(i+1-o),r&&(a=r-i-1)>0&&(s=s+"."+Br(a))):((a=i+1)<o&&(s=s.slice(0,a)+"."+s.slice(a)),r&&(a=r-o)>0&&(i+1===o&&(s+="."),s+=Br(a))),e.s<0?"-"+s:s}function Fm(e,t){if(e.length>t)return e.length=t,!0}function r0(e){var t,r,a;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(ga+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return Bm(o,s.toString())}else if(typeof s!="string")throw Error(ga+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,LE.test(s))Bm(o,s);else throw Error(ga+s)}if(i.prototype=_e,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=r0,i.config=i.set=RE,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<a.length;)e.hasOwnProperty(r=a[t++])||(e[r]=this[r]);return i.config(e),i}function RE(e){if(!e||typeof e!="object")throw Error(qn+"Object expected");var t,r,a,i=["precision",1,ti,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((a=e[r=i[t]])!==void 0)if(ni(a)===a&&a>=i[t+1]&&a<=i[t+2])this[r]=a;else throw Error(ga+r+": "+a);if((a=e[r="LN10"])!==void 0)if(a==Math.LN10)this[r]=new this(a);else throw Error(ga+r+": "+a);return this}var Su=r0($E);Tn=new Su(1);const ot=Su;var zE=e=>e,a0={},i0=e=>e===a0,qm=e=>function t(){return arguments.length===0||arguments.length===1&&i0(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},s0=(e,t)=>e===1?t:qm(function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];var s=a.filter(o=>o!==a0).length;return s>=e?t(...a):s0(e-s,qm(function(){for(var o=arguments.length,l=new Array(o),d=0;d<o;d++)l[d]=arguments[d];var h=a.map(u=>i0(u)?l.shift():u);return t(...h,...l)}))}),pl=e=>s0(e.length,e),nd=(e,t)=>{for(var r=[],a=e;a<t;++a)r[a-e]=a;return r},WE=pl((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),BE=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];if(!r.length)return zE;var i=r.reverse(),s=i[0],o=i.slice(1);return function(){return o.reduce((l,d)=>d(l),s(...arguments))}},rd=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),o0=e=>{var t=null,r=null;return function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return t&&i.every((o,l)=>{var d;return o===((d=t)===null||d===void 0?void 0:d[l])})||(t=i,r=e(...i)),r}};function l0(e){var t;return e===0?t=1:t=Math.floor(new ot(e).abs().log(10).toNumber())+1,t}function c0(e,t,r){for(var a=new ot(e),i=0,s=[];a.lt(t)&&i<1e5;)s.push(a.toNumber()),a=a.add(r),i++;return s}pl((e,t,r)=>{var a=+e,i=+t;return a+r*(i-a)});pl((e,t,r)=>{var a=t-+e;return a=a||1/0,(r-e)/a});pl((e,t,r)=>{var a=t-+e;return a=a||1/0,Math.max(0,Math.min(1,(r-e)/a))});var d0=e=>{var[t,r]=e,[a,i]=[t,r];return t>r&&([a,i]=[r,t]),[a,i]},u0=(e,t,r)=>{if(e.lte(0))return new ot(0);var a=l0(e.toNumber()),i=new ot(10).pow(a),s=e.div(i),o=a!==1?.05:.1,l=new ot(Math.ceil(s.div(o).toNumber())).add(r).mul(o),d=l.mul(i);return t?new ot(d.toNumber()):new ot(Math.ceil(d.toNumber()))},FE=(e,t,r)=>{var a=new ot(1),i=new ot(e);if(!i.isint()&&r){var s=Math.abs(e);s<1?(a=new ot(10).pow(l0(e)-1),i=new ot(Math.floor(i.div(a).toNumber())).mul(a)):s>1&&(i=new ot(Math.floor(e)))}else e===0?i=new ot(Math.floor((t-1)/2)):r||(i=new ot(Math.floor(e)));var o=Math.floor((t-1)/2),l=BE(WE(d=>i.add(new ot(d-o).mul(a)).toNumber()),nd);return l(0,t)},f0=function(t,r,a,i){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(a-1)))return{step:new ot(0),tickMin:new ot(0),tickMax:new ot(0)};var o=u0(new ot(r).sub(t).div(a-1),i,s),l;t<=0&&r>=0?l=new ot(0):(l=new ot(t).add(r).div(2),l=l.sub(new ot(l).mod(o)));var d=Math.ceil(l.sub(t).div(o).toNumber()),h=Math.ceil(new ot(r).sub(l).div(o).toNumber()),u=d+h+1;return u>a?f0(t,r,a,i,s+1):(u<a&&(h=r>0?h+(a-u):h,d=r>0?d:d+(a-u)),{step:o,tickMin:l.sub(new ot(d).mul(o)),tickMax:l.add(new ot(h).mul(o))})};function qE(e){var[t,r]=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),[o,l]=d0([t,r]);if(o===-1/0||l===1/0){var d=l===1/0?[o,...nd(0,a-1).map(()=>1/0)]:[...nd(0,a-1).map(()=>-1/0),l];return t>r?rd(d):d}if(o===l)return FE(o,a,i);var{step:h,tickMin:u,tickMax:f}=f0(o,l,s,i,0),m=c0(u,f.add(new ot(.1).mul(h)),h);return t>r?rd(m):m}function UE(e,t){var[r,a]=e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[s,o]=d0([r,a]);if(s===-1/0||o===1/0)return[r,a];if(s===o)return[s];var l=Math.max(t,2),d=u0(new ot(o).sub(s).div(l-1),i,0),h=[...c0(new ot(s),new ot(o),d),o];return i===!1&&(h=h.map(u=>Math.round(u))),r>a?rd(h):h}var HE=o0(qE),YE=o0(UE),h0=e=>e.rootProps.maxBarSize,KE=e=>e.rootProps.barGap,m0=e=>e.rootProps.barCategoryGap,GE=e=>e.rootProps.barSize,ts=e=>e.rootProps.stackOffset,Nu=e=>e.options.chartName,ku=e=>e.rootProps.syncId,p0=e=>e.rootProps.syncMethod,Au=e=>e.options.eventEmitter,Bt={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},vr={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},In={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},gl=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},VE={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:vr.angleAxisId,includeHidden:!1,name:void 0,reversed:vr.reversed,scale:vr.scale,tick:vr.tick,tickCount:void 0,ticks:void 0,type:vr.type,unit:void 0},XE={allowDataOverflow:In.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:In.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:In.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:In.scale,tick:In.tick,tickCount:In.tickCount,ticks:void 0,type:In.type,unit:void 0},QE={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:vr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:vr.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:vr.scale,tick:vr.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},JE={allowDataOverflow:In.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:In.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:In.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:In.scale,tick:In.tick,tickCount:In.tickCount,ticks:void 0,type:"category",unit:void 0},Cu=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?QE:VE,Eu=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?JE:XE,yl=e=>e.polarOptions,Pu=pe([Tr,Or,Yt],dv),g0=pe([yl,Pu],(e,t)=>{if(e!=null)return un(e.innerRadius,t,0)}),y0=pe([yl,Pu],(e,t)=>{if(e!=null)return un(e.outerRadius,t,t*.8)}),ZE=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},v0=pe([yl],ZE);pe([Cu,v0],gl);var x0=pe([Pu,g0,y0],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});pe([Eu,x0],gl);var b0=pe([et,yl,g0,y0,Tr,Or],(e,t,r,a,i,s)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||a==null)){var{cx:o,cy:l,startAngle:d,endAngle:h}=t;return{cx:un(o,i,i/2),cy:un(l,s,s/2),innerRadius:r,outerRadius:a,startAngle:d,endAngle:h,clockWise:!1}}}),kt=(e,t)=>t,ns=(e,t,r)=>r;function Iu(e){return e==null?void 0:e.id}function j0(e,t,r){var{chartData:a=[]}=t,{allowDuplicatedCategory:i,dataKey:s}=r,o=new Map;return e.forEach(l=>{var d,h=(d=l.data)!==null&&d!==void 0?d:a;if(!(h==null||h.length===0)){var u=Iu(l);h.forEach((f,m)=>{var p=s==null||i?m:String(ht(f,s,null)),x=ht(f,l.dataKey,0),v;o.has(p)?v=o.get(p):v={},Object.assign(v,{[u]:x}),o.set(p,v)})}}),Array.from(o.values())}function vl(e){return e.stackId!=null&&e.dataKey!=null}var xl=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function bl(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function eP(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var Gt=e=>{var t=et(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},ri=e=>e.tooltip.settings.axisId;function Um(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function jo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Um(Object(r),!0).forEach(function(a){tP(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Um(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function tP(e,t,r){return(t=nP(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function nP(e){var t=rP(e,"string");return typeof t=="symbol"?t:t+""}function rP(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ad=[0,"auto"],En={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},w0=(e,t)=>e.cartesianAxis.xAxis[t],Dr=(e,t)=>{var r=w0(e,t);return r??En},Pn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:ad,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Ki},S0=(e,t)=>e.cartesianAxis.yAxis[t],Mr=(e,t)=>{var r=S0(e,t);return r??Pn},aP={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Tu=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??aP},Tt=(e,t,r)=>{switch(t){case"xAxis":return Dr(e,r);case"yAxis":return Mr(e,r);case"zAxis":return Tu(e,r);case"angleAxis":return Cu(e,r);case"radiusAxis":return Eu(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},iP=(e,t,r)=>{switch(t){case"xAxis":return Dr(e,r);case"yAxis":return Mr(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},rs=(e,t,r)=>{switch(t){case"xAxis":return Dr(e,r);case"yAxis":return Mr(e,r);case"angleAxis":return Cu(e,r);case"radiusAxis":return Eu(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},N0=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Ou(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var jl=e=>e.graphicalItems.cartesianItems,sP=pe([kt,ns],Ou),_u=(e,t,r)=>e.filter(r).filter(a=>(t==null?void 0:t.includeHidden)===!0?!0:!a.hide),as=pe([jl,Tt,sP],_u,{memoizeOptions:{resultEqualityCheck:bl}}),k0=pe([as],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(vl)),A0=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),oP=pe([as],A0),Du=e=>e.map(t=>t.data).filter(Boolean).flat(1),lP=pe([as],Du,{memoizeOptions:{resultEqualityCheck:bl}}),Mu=(e,t)=>{var{chartData:r=[],dataStartIndex:a,dataEndIndex:i}=t;return e.length>0?e:r.slice(a,i+1)},$u=pe([lP,ml],Mu),Lu=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(a=>({value:ht(a,t.dataKey)})):r.length>0?r.map(a=>a.dataKey).flatMap(a=>e.map(i=>({value:ht(i,a)}))):e.map(a=>({value:a})),wl=pe([$u,Tt,as],Lu);function C0(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function qs(e){if(cr(e)||e instanceof Date){var t=Number(e);if(Lt(t))return t}}function Hm(e){if(Array.isArray(e)){var t=[qs(e[0]),qs(e[1])];return Sa(t)?t:void 0}var r=qs(e);if(r!=null)return[r,r]}function Pr(e){return e.map(qs).filter(aS)}function cP(e,t,r){return!r||typeof t!="number"||Jn(t)?[]:r.length?Pr(r.flatMap(a=>{var i=ht(e,a.dataKey),s,o;if(Array.isArray(i)?[s,o]=i:s=o=i,!(!Lt(s)||!Lt(o)))return[t-s,t+o]})):[]}var Vt=e=>{var t=Gt(e),r=ri(e);return rs(e,t,r)},E0=pe([Vt],e=>e==null?void 0:e.dataKey),dP=pe([k0,ml,Vt],j0),P0=(e,t,r)=>{var a={},i=t.reduce((s,o)=>(o.stackId==null||(s[o.stackId]==null&&(s[o.stackId]=[]),s[o.stackId].push(o)),s),a);return Object.fromEntries(Object.entries(i).map(s=>{var[o,l]=s,d=l.map(Iu);return[o,{stackedData:c2(e,d,r),graphicalItems:l}]}))},id=pe([dP,k0,ts],P0),I0=(e,t,r,a)=>{var{dataStartIndex:i,dataEndIndex:s}=t;if(a==null&&r!=="zAxis"){var o=m2(e,i,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},uP=pe([Tt],e=>e.allowDataOverflow),Ru=e=>{var t;if(e==null||!("domain"in e))return ad;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Pr(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:ad},zu=pe([Tt],Ru),Wu=pe([zu,uP],Jv),fP=pe([id,ea,kt,Wu],I0,{memoizeOptions:{resultEqualityCheck:xl}}),Sl=e=>e.errorBars,hP=(e,t,r)=>e.flatMap(a=>t[a.id]).filter(Boolean).filter(a=>C0(r,a)),wo=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var i=r.filter(Boolean);if(i.length!==0){var s=i.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},Bu=(e,t,r,a,i)=>{var s,o;if(r.length>0&&e.forEach(l=>{r.forEach(d=>{var h,u,f=(h=a[d.id])===null||h===void 0?void 0:h.filter(b=>C0(i,b)),m=ht(l,(u=t.dataKey)!==null&&u!==void 0?u:d.dataKey),p=cP(l,m,f);if(p.length>=2){var x=Math.min(...p),v=Math.max(...p);(s==null||x<s)&&(s=x),(o==null||v>o)&&(o=v)}var g=Hm(m);g!=null&&(s=s==null?g[0]:Math.min(s,g[0]),o=o==null?g[1]:Math.max(o,g[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(l=>{var d=Hm(ht(l,t.dataKey));d!=null&&(s=s==null?d[0]:Math.min(s,d[0]),o=o==null?d[1]:Math.max(o,d[1]))}),Lt(s)&&Lt(o))return[s,o]},mP=pe([$u,Tt,oP,Sl,kt],Bu,{memoizeOptions:{resultEqualityCheck:xl}});function pP(e){var{value:t}=e;if(cr(t)||t instanceof Date)return t}var gP=(e,t,r)=>{var a=e.map(pP).filter(i=>i!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&Dg(a))?yv(0,e.length):t.allowDuplicatedCategory?a:Array.from(new Set(a))},T0=e=>e.referenceElements.dots,ai=(e,t,r)=>e.filter(a=>a.ifOverflow==="extendDomain").filter(a=>t==="xAxis"?a.xAxisId===r:a.yAxisId===r),yP=pe([T0,kt,ns],ai),O0=e=>e.referenceElements.areas,vP=pe([O0,kt,ns],ai),_0=e=>e.referenceElements.lines,xP=pe([_0,kt,ns],ai),D0=(e,t)=>{var r=Pr(e.map(a=>t==="xAxis"?a.x:a.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},bP=pe(yP,kt,D0),M0=(e,t)=>{var r=Pr(e.flatMap(a=>[t==="xAxis"?a.x1:a.y1,t==="xAxis"?a.x2:a.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},jP=pe([vP,kt],M0);function wP(e){var t;if(e.x!=null)return Pr([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(a=>a.x);return r==null||r.length===0?[]:Pr(r)}function SP(e){var t;if(e.y!=null)return Pr([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(a=>a.y);return r==null||r.length===0?[]:Pr(r)}var $0=(e,t)=>{var r=e.flatMap(a=>t==="xAxis"?wP(a):SP(a));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},NP=pe([xP,kt],$0),kP=pe(bP,NP,jP,(e,t,r)=>wo(e,r,t)),Fu=(e,t,r,a,i,s,o,l)=>{if(r!=null)return r;var d=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",h=d?wo(a,s,i):wo(s,i);return ME(t,h,e.allowDataOverflow)},AP=pe([Tt,zu,Wu,fP,mP,kP,et,kt],Fu,{memoizeOptions:{resultEqualityCheck:xl}}),CP=[0,1],qu=(e,t,r,a,i,s,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:d}=e,h=Xr(t,s);if(h&&l==null){var u;return yv(0,(u=r==null?void 0:r.length)!==null&&u!==void 0?u:0)}return d==="category"?gP(a,e,h):i==="expand"?CP:o}},Uu=pe([Tt,et,$u,wl,ts,kt,AP],qu),L0=(e,t,r,a,i)=>{if(e!=null){var{scale:s,type:o}=e;if(s==="auto")return t==="radial"&&i==="radiusAxis"?"band":t==="radial"&&i==="angleAxis"?"linear":o==="category"&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof s=="string"){var l="scale".concat(Ui(s));return l in Ai?l:"point"}}},ii=pe([Tt,et,N0,Nu,kt],L0);function EP(e){if(e!=null){if(e in Ai)return Ai[e]();var t="scale".concat(Ui(e));if(t in Ai)return Ai[t]()}}function Hu(e,t,r,a){if(!(r==null||a==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(a);var i=EP(t);if(i!=null){var s=i.domain(r).range(a);return a2(s),s}}}var Yu=(e,t,r)=>{var a=Ru(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(a)&&(a[0]==="auto"||a[1]==="auto")&&Sa(e))return HE(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Sa(e))return YE(e,t.tickCount,t.allowDecimals)}},Ku=pe([Uu,rs,ii],Yu),Gu=(e,t,r,a)=>{if(a!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&Sa(t)&&Array.isArray(r)&&r.length>0){var i=t[0],s=r[0],o=t[1],l=r[r.length-1];return[Math.min(i,s),Math.max(o,l)]}return t},PP=pe([Tt,Uu,Ku,kt],Gu),IP=pe(wl,Tt,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,a=Array.from(Pr(e.map(l=>l.value))).sort((l,d)=>l-d);if(a.length<2)return 1/0;var i=a[a.length-1]-a[0];if(i===0)return 1/0;for(var s=0;s<a.length-1;s++){var o=a[s+1]-a[s];r=Math.min(r,o)}return r/i}}),R0=pe(IP,et,m0,Yt,(e,t,r,a)=>a,(e,t,r,a,i)=>{if(!Lt(e))return 0;var s=t==="vertical"?a.height:a.width;if(i==="gap")return e*s/2;if(i==="no-gap"){var o=un(r,e*s),l=e*s/2;return l-o-(l-o)/s*o}return 0}),TP=(e,t)=>{var r=Dr(e,t);return r==null||typeof r.padding!="string"?0:R0(e,"xAxis",t,r.padding)},OP=(e,t)=>{var r=Mr(e,t);return r==null||typeof r.padding!="string"?0:R0(e,"yAxis",t,r.padding)},_P=pe(Dr,TP,(e,t)=>{var r,a;if(e==null)return{left:0,right:0};var{padding:i}=e;return typeof i=="string"?{left:t,right:t}:{left:((r=i.left)!==null&&r!==void 0?r:0)+t,right:((a=i.right)!==null&&a!==void 0?a:0)+t}}),DP=pe(Mr,OP,(e,t)=>{var r,a;if(e==null)return{top:0,bottom:0};var{padding:i}=e;return typeof i=="string"?{top:t,bottom:t}:{top:((r=i.top)!==null&&r!==void 0?r:0)+t,bottom:((a=i.bottom)!==null&&a!==void 0?a:0)+t}}),MP=pe([Yt,_P,il,al,(e,t,r)=>r],(e,t,r,a,i)=>{var{padding:s}=a;return i?[s.left,r.width-s.right]:[e.left+t.left,e.left+e.width-t.right]}),$P=pe([Yt,et,DP,il,al,(e,t,r)=>r],(e,t,r,a,i,s)=>{var{padding:o}=i;return s?[a.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),is=(e,t,r,a)=>{var i;switch(t){case"xAxis":return MP(e,r,a);case"yAxis":return $P(e,r,a);case"zAxis":return(i=Tu(e,r))===null||i===void 0?void 0:i.range;case"angleAxis":return v0(e);case"radiusAxis":return x0(e,r);default:return}},z0=pe([Tt,is],gl),si=pe([Tt,ii,PP,z0],Hu);pe([as,Sl,kt],hP);function W0(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Nl=(e,t)=>t,kl=(e,t,r)=>r,LP=pe(nl,Nl,kl,(e,t,r)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===r).sort(W0)),RP=pe(rl,Nl,kl,(e,t,r)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===r).sort(W0)),B0=(e,t)=>({width:e.width,height:t.height}),zP=(e,t)=>{var r=typeof t.width=="number"?t.width:Ki;return{width:r,height:e.height}},F0=pe(Yt,Dr,B0),WP=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},BP=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},FP=pe(Or,Yt,LP,Nl,kl,(e,t,r,a,i)=>{var s={},o;return r.forEach(l=>{var d=B0(t,l);o==null&&(o=WP(t,a,e));var h=a==="top"&&!i||a==="bottom"&&i;s[l.id]=o-Number(h)*d.height,o+=(h?-1:1)*d.height}),s}),qP=pe(Tr,Yt,RP,Nl,kl,(e,t,r,a,i)=>{var s={},o;return r.forEach(l=>{var d=zP(t,l);o==null&&(o=BP(t,a,e));var h=a==="left"&&!i||a==="right"&&i;s[l.id]=o-Number(h)*d.width,o+=(h?-1:1)*d.width}),s}),UP=(e,t)=>{var r=Dr(e,t);if(r!=null)return FP(e,r.orientation,r.mirror)},HP=pe([Yt,Dr,UP,(e,t)=>t],(e,t,r,a)=>{if(t!=null){var i=r==null?void 0:r[a];return i==null?{x:e.left,y:0}:{x:e.left,y:i}}}),YP=(e,t)=>{var r=Mr(e,t);if(r!=null)return qP(e,r.orientation,r.mirror)},KP=pe([Yt,Mr,YP,(e,t)=>t],(e,t,r,a)=>{if(t!=null){var i=r==null?void 0:r[a];return i==null?{x:0,y:e.top}:{x:i,y:e.top}}}),q0=pe(Yt,Mr,(e,t)=>{var r=typeof t.width=="number"?t.width:Ki;return{width:r,height:e.height}}),Ym=(e,t,r)=>{switch(t){case"xAxis":return F0(e,r).width;case"yAxis":return q0(e,r).height;default:return}},U0=(e,t,r,a)=>{if(r!=null){var{allowDuplicatedCategory:i,type:s,dataKey:o}=r,l=Xr(e,a),d=t.map(h=>h.value);if(o&&l&&s==="category"&&i&&Dg(d))return d}},Vu=pe([et,wl,Tt,kt],U0),H0=(e,t,r,a)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:s}=r,o=Xr(e,a);if(o&&(i==="number"||s!=="auto"))return t.map(l=>l.value)}},Xu=pe([et,wl,rs,kt],H0),Km=pe([et,iP,ii,si,Vu,Xu,is,Ku,kt],(e,t,r,a,i,s,o,l,d)=>{if(t!=null){var h=Xr(e,d);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:d,categoricalDomain:s,duplicateDomain:i,isCategorical:h,niceTicks:l,range:o,realScaleType:r,scale:a}}}),GP=(e,t,r,a,i,s,o,l,d)=>{if(!(t==null||a==null)){var h=Xr(e,d),{type:u,ticks:f,tickCount:m}=t,p=r==="scaleBand"&&typeof a.bandwidth=="function"?a.bandwidth()/2:2,x=u==="category"&&a.bandwidth?a.bandwidth()/p:0;x=d==="angleAxis"&&s!=null&&s.length>=2?Zt(s[0]-s[1])*2*x:x;var v=f||i;if(v){var g=v.map((b,y)=>{var N=o?o.indexOf(b):b;return{index:y,coordinate:a(N)+x,value:b,offset:x}});return g.filter(b=>Lt(b.coordinate))}return h&&l?l.map((b,y)=>({coordinate:a(b)+x,value:b,index:y,offset:x})).filter(b=>Lt(b.coordinate)):a.ticks?a.ticks(m).map(b=>({coordinate:a(b)+x,value:b,offset:x})):a.domain().map((b,y)=>({coordinate:a(b)+x,value:o?o[b]:b,index:y,offset:x}))}},Y0=pe([et,rs,ii,si,Ku,is,Vu,Xu,kt],GP),VP=(e,t,r,a,i,s,o)=>{if(!(t==null||r==null||a==null||a[0]===a[1])){var l=Xr(e,o),{tickCount:d}=t,h=0;return h=o==="angleAxis"&&(a==null?void 0:a.length)>=2?Zt(a[0]-a[1])*2*h:h,l&&s?s.map((u,f)=>({coordinate:r(u)+h,value:u,index:f,offset:h})):r.ticks?r.ticks(d).map(u=>({coordinate:r(u)+h,value:u,offset:h})):r.domain().map((u,f)=>({coordinate:r(u)+h,value:i?i[u]:u,index:f,offset:h}))}},Hr=pe([et,rs,si,is,Vu,Xu,kt],VP),Yr=pe(Tt,si,(e,t)=>{if(!(e==null||t==null))return jo(jo({},e),{},{scale:t})}),XP=pe([Tt,ii,Uu,z0],Hu);pe((e,t,r)=>Tu(e,r),XP,(e,t)=>{if(!(e==null||t==null))return jo(jo({},e),{},{scale:t})});var QP=pe([et,nl,rl],(e,t,r)=>{switch(e){case"horizontal":return t.some(a=>a.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(a=>a.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),K0=e=>e.options.defaultTooltipEventType,G0=e=>e.options.validateTooltipEventTypes;function V0(e,t,r){if(e==null)return t;var a=e?"axis":"item";return r==null?t:r.includes(a)?a:t}function Qu(e,t){var r=K0(e),a=G0(e);return V0(t,r,a)}function JP(e){return $e(t=>Qu(t,e))}var X0=(e,t)=>{var r,a=Number(t);if(!(Jn(a)||t==null))return a>=0?e==null||(r=e[a])===null||r===void 0?void 0:r.value:void 0},ZP=e=>e.tooltip.settings,qr={active:!1,index:null,dataKey:void 0,coordinate:void 0},eI={itemInteraction:{click:qr,hover:qr},axisInteraction:{click:qr,hover:qr},keyboardInteraction:qr,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},Q0=Nn({name:"tooltip",initialState:eI,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Ht()},removeTooltipEntrySettings:{reducer(e,t){var r=wr(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:Ht()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:tI,removeTooltipEntrySettings:nI,setTooltipSettingsState:rI,setActiveMouseOverItemIndex:J0,mouseLeaveItem:aI,mouseLeaveChart:Z0,setActiveClickItemIndex:iI,setMouseOverAxisIndex:ex,setMouseClickAxisIndex:sI,setSyncInteraction:sd,setKeyboardInteraction:od}=Q0.actions,oI=Q0.reducer;function Gm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Rs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gm(Object(r),!0).forEach(function(a){lI(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gm(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function lI(e,t,r){return(t=cI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cI(e){var t=dI(e,"string");return typeof t=="symbol"?t:t+""}function dI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uI(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function fI(e){return e.index!=null}var tx=(e,t,r,a)=>{if(t==null)return qr;var i=uI(e,t,r);if(i==null)return qr;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var s=e.settings.active===!0;if(fI(i)){if(s)return Rs(Rs({},i),{},{active:!0})}else if(a!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:a};return Rs(Rs({},qr),{},{coordinate:i.coordinate})},Ju=(e,t)=>{var r=e==null?void 0:e.index;if(r==null)return null;var a=Number(r);if(!Lt(a))return r;var i=0,s=1/0;return t.length>0&&(s=t.length-1),String(Math.max(i,Math.min(a,s)))},nx=(e,t,r,a,i,s,o,l)=>{if(!(s==null||l==null)){var d=o[0],h=d==null?void 0:l(d.positions,s);if(h!=null)return h;var u=i==null?void 0:i[Number(s)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(a.top+t)/2};default:return{x:(a.left+e)/2,y:u.coordinate}}}},rx=(e,t,r,a)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var i;return r==="hover"?i=e.itemInteraction.hover.dataKey:i=e.itemInteraction.click.dataKey,i==null&&a!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(s=>{var o;return((o=s.settings)===null||o===void 0?void 0:o.dataKey)===i})},ss=e=>e.options.tooltipPayloadSearcher,oi=e=>e.tooltip;function Vm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Xm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vm(Object(r),!0).forEach(function(a){hI(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vm(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function hI(e,t,r){return(t=mI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mI(e){var t=pI(e,"string");return typeof t=="symbol"?t:t+""}function pI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gI(e,t){return e??t}var ax=(e,t,r,a,i,s,o)=>{if(!(t==null||s==null)){var{chartData:l,computedData:d,dataStartIndex:h,dataEndIndex:u}=r,f=[];return e.reduce((m,p)=>{var x,{dataDefinedOnItem:v,settings:g}=p,b=gI(v,l),y=Array.isArray(b)?zy(b,h,u):b,N=(x=g==null?void 0:g.dataKey)!==null&&x!==void 0?x:a,A=g==null?void 0:g.nameKey,E;if(a&&Array.isArray(y)&&!Array.isArray(y[0])&&o==="axis"?E=Mg(y,a,i):E=s(y,t,d,A),Array.isArray(E))E.forEach(P=>{var _=Xm(Xm({},g),{},{name:P.name,unit:P.unit,color:void 0,fill:void 0});m.push(Oh({tooltipEntrySettings:_,dataKey:P.dataKey,payload:P.payload,value:ht(P.payload,P.dataKey),name:P.name}))});else{var w;m.push(Oh({tooltipEntrySettings:g,dataKey:N,payload:E,value:ht(E,N),name:(w=ht(E,A))!==null&&w!==void 0?w:g==null?void 0:g.name}))}return m},f)}},Zu=pe([Vt,et,N0,Nu,Gt],L0),yI=pe([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),vI=pe([Gt,ri],Ou),os=pe([yI,Vt,vI],_u,{memoizeOptions:{resultEqualityCheck:bl}}),xI=pe([os],e=>e.filter(vl)),bI=pe([os],Du,{memoizeOptions:{resultEqualityCheck:bl}}),li=pe([bI,ea],Mu),jI=pe([xI,ea,Vt],j0),ef=pe([li,Vt,os],Lu),ix=pe([Vt],Ru),wI=pe([Vt],e=>e.allowDataOverflow),sx=pe([ix,wI],Jv),SI=pe([os],e=>e.filter(vl)),NI=pe([jI,SI,ts],P0),kI=pe([NI,ea,Gt,sx],I0),AI=pe([os],A0),CI=pe([li,Vt,AI,Sl,Gt],Bu,{memoizeOptions:{resultEqualityCheck:xl}}),EI=pe([T0,Gt,ri],ai),PI=pe([EI,Gt],D0),II=pe([O0,Gt,ri],ai),TI=pe([II,Gt],M0),OI=pe([_0,Gt,ri],ai),_I=pe([OI,Gt],$0),DI=pe([PI,_I,TI],wo),MI=pe([Vt,ix,sx,kI,CI,DI,et,Gt],Fu),ox=pe([Vt,et,li,ef,ts,Gt,MI],qu),$I=pe([ox,Vt,Zu],Yu),LI=pe([Vt,ox,$I,Gt],Gu),lx=e=>{var t=Gt(e),r=ri(e),a=!1;return is(e,t,r,a)},cx=pe([Vt,lx],gl),dx=pe([Vt,Zu,LI,cx],Hu),RI=pe([et,ef,Vt,Gt],U0),zI=pe([et,ef,Vt,Gt],H0),WI=(e,t,r,a,i,s,o,l)=>{if(t){var{type:d}=t,h=Xr(e,l);if(a){var u=r==="scaleBand"&&a.bandwidth?a.bandwidth()/2:2,f=d==="category"&&a.bandwidth?a.bandwidth()/u:0;return f=l==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?Zt(i[0]-i[1])*2*f:f,h&&o?o.map((m,p)=>({coordinate:a(m)+f,value:m,index:p,offset:f})):a.domain().map((m,p)=>({coordinate:a(m)+f,value:s?s[m]:m,index:p,offset:f}))}}},$r=pe([et,Vt,Zu,dx,lx,RI,zI,Gt],WI),tf=pe([K0,G0,ZP],(e,t,r)=>V0(r.shared,e,t)),ux=e=>e.tooltip.settings.trigger,nf=e=>e.tooltip.settings.defaultIndex,Al=pe([oi,tf,ux,nf],tx),Kr=pe([Al,li],Ju),fx=pe([$r,Kr],X0),hx=pe([Al],e=>{if(e)return e.dataKey}),mx=pe([oi,tf,ux,nf],rx),BI=pe([Tr,Or,et,Yt,$r,nf,mx,ss],nx),FI=pe([Al,BI],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),qI=pe([Al],e=>e.active),UI=pe([mx,Kr,ea,E0,fx,ss,tf],ax),HI=pe([UI],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function Qm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Jm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qm(Object(r),!0).forEach(function(a){YI(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qm(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function YI(e,t,r){return(t=KI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KI(e){var t=GI(e,"string");return typeof t=="symbol"?t:t+""}function GI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VI=()=>$e(Vt),XI=()=>{var e=VI(),t=$e($r),r=$e(dx);return Ga(!e||!r?void 0:Jm(Jm({},e),{},{scale:r}),t)};function Zm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Wa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zm(Object(r),!0).forEach(function(a){QI(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zm(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function QI(e,t,r){return(t=JI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JI(e){var t=ZI(e,"string");return typeof t=="symbol"?t:t+""}function ZI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eT=(e,t,r,a)=>{var i=t.find(s=>s&&s.index===r);if(i){if(e==="horizontal")return{x:i.coordinate,y:a.chartY};if(e==="vertical")return{x:a.chartX,y:i.coordinate}}return{x:0,y:0}},tT=(e,t,r,a)=>{var i=t.find(h=>h&&h.index===r);if(i){if(e==="centric"){var s=i.coordinate,{radius:o}=a;return Wa(Wa(Wa({},a),Wt(a.cx,a.cy,o,s)),{},{angle:s,radius:o})}var l=i.coordinate,{angle:d}=a;return Wa(Wa(Wa({},a),Wt(a.cx,a.cy,l,d)),{},{angle:d,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function nT(e,t){var{chartX:r,chartY:a}=e;return r>=t.left&&r<=t.left+t.width&&a>=t.top&&a<=t.top+t.height}var px=(e,t,r,a,i)=>{var s,o=-1,l=(s=t==null?void 0:t.length)!==null&&s!==void 0?s:0;if(l<=1||e==null)return 0;if(a==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var d=0;d<l;d++){var h=d>0?r[d-1].coordinate:r[l-1].coordinate,u=r[d].coordinate,f=d>=l-1?r[0].coordinate:r[d+1].coordinate,m=void 0;if(Zt(u-h)!==Zt(f-u)){var p=[];if(Zt(f-u)===Zt(i[1]-i[0])){m=f;var x=u+i[1]-i[0];p[0]=Math.min(x,(x+h)/2),p[1]=Math.max(x,(x+h)/2)}else{m=h;var v=f+i[1]-i[0];p[0]=Math.min(u,(v+u)/2),p[1]=Math.max(u,(v+u)/2)}var g=[Math.min(u,(m+u)/2),Math.max(u,(m+u)/2)];if(e>g[0]&&e<=g[1]||e>=p[0]&&e<=p[1]){({index:o}=r[d]);break}}else{var b=Math.min(h,f),y=Math.max(h,f);if(e>(b+u)/2&&e<=(y+u)/2){({index:o}=r[d]);break}}}else if(t){for(var N=0;N<l;N++)if(N===0&&e<=(t[N].coordinate+t[N+1].coordinate)/2||N>0&&N<l-1&&e>(t[N].coordinate+t[N-1].coordinate)/2&&e<=(t[N].coordinate+t[N+1].coordinate)/2||N===l-1&&e>(t[N].coordinate+t[N-1].coordinate)/2){({index:o}=t[N]);break}}return o},rT=()=>$e(Nu),rf=(e,t)=>t,gx=(e,t,r)=>r,af=(e,t,r,a)=>a,aT=pe($r,e=>Xo(e,t=>t.coordinate)),sf=pe([oi,rf,gx,af],tx),yx=pe([sf,li],Ju),iT=(e,t,r)=>{if(t!=null){var a=oi(e);return t==="axis"?r==="hover"?a.axisInteraction.hover.dataKey:a.axisInteraction.click.dataKey:r==="hover"?a.itemInteraction.hover.dataKey:a.itemInteraction.click.dataKey}},vx=pe([oi,rf,gx,af],rx),So=pe([Tr,Or,et,Yt,$r,af,vx,ss],nx),sT=pe([sf,So],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),xx=pe([$r,yx],X0),oT=pe([vx,yx,ea,E0,xx,ss,rf],ax),lT=pe([sf],e=>({isActive:e.active,activeIndex:e.index})),cT=(e,t,r,a,i,s,o)=>{if(!(!e||!r||!a||!i)&&nT(e,o)){var l=p2(e,t),d=px(l,s,i,r,a),h=eT(t,i,d,e);return{activeIndex:String(d),activeCoordinate:h}}},dT=(e,t,r,a,i,s,o)=>{if(!(!e||!a||!i||!s||!r)){var l=tA(e,r);if(l){var d=g2(l,t),h=px(d,o,s,a,i),u=tT(t,s,h,l);return{activeIndex:String(h),activeCoordinate:u}}}},uT=(e,t,r,a,i,s,o,l)=>{if(!(!e||!t||!a||!i||!s))return t==="horizontal"||t==="vertical"?cT(e,t,a,i,s,o,l):dT(e,t,r,a,i,s,o)},fT=pe(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var a=e[t];if(a!=null)return r?a.panoramaElementId:a.elementId}}),hT=pe(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(a=>parseInt(a,10)).concat(Object.values(Bt)),r=Array.from(new Set(t));return r.sort((a,i)=>a-i)},{memoizeOptions:{resultEqualityCheck:eP}});function ep(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function tp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ep(Object(r),!0).forEach(function(a){mT(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ep(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function mT(e,t,r){return(t=pT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pT(e){var t=gT(e,"string");return typeof t=="symbol"?t:t+""}function gT(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yT={},vT={zIndexMap:Object.values(Bt).reduce((e,t)=>tp(tp({},e),{},{[t]:{elementId:void 0,panoramaElementId:void 0,consumers:0}}),yT)},xT=new Set(Object.values(Bt));function bT(e){return xT.has(e)}var bx=Nn({name:"zIndex",initialState:vT,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,elementId:void 0,panoramaElementId:void 0}},prepare:Ht()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!bT(r)&&delete e.zIndexMap[r])},prepare:Ht()},registerZIndexPortalId:{reducer:(e,t)=>{var{zIndex:r,elementId:a,isPanorama:i}=t.payload;e.zIndexMap[r]?i?e.zIndexMap[r].panoramaElementId=a:e.zIndexMap[r].elementId=a:e.zIndexMap[r]={consumers:0,elementId:i?void 0:a,panoramaElementId:i?a:void 0}},prepare:Ht()},unregisterZIndexPortalId:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElementId=void 0:e.zIndexMap[r].elementId=void 0)},prepare:Ht()}}}),{registerZIndexPortal:jT,unregisterZIndexPortal:wT,registerZIndexPortalId:ST,unregisterZIndexPortalId:NT}=bx.actions,kT=bx.reducer;function kn(e){var{zIndex:t,children:r}=e,a=F2(),i=a&&t!==void 0&&t!==0,s=fn(),o=Nt();c.useLayoutEffect(()=>i?(o(jT({zIndex:t})),()=>{o(wT({zIndex:t}))}):Ca,[o,t,i]);var l=$e(h=>fT(h,t,s));if(!i)return r;if(!l)return null;var d=document.getElementById(l);return d?jd.createPortal(r,d):null}function ld(){return ld=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ld.apply(null,arguments)}function np(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function zs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?np(Object(r),!0).forEach(function(a){AT(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):np(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function AT(e,t,r){return(t=CT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CT(e){var t=ET(e,"string");return typeof t=="symbol"?t:t+""}function ET(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PT(e){var{cursor:t,cursorComp:r,cursorProps:a}=e;return c.isValidElement(t)?c.cloneElement(t,a):c.createElement(r,a)}function IT(e){var t,{coordinate:r,payload:a,index:i,offset:s,tooltipAxisBandSize:o,layout:l,cursor:d,tooltipEventType:h,chartName:u}=e,f=r,m=a,p=i;if(!d||!f||u!=="ScatterChart"&&h!=="axis")return null;var x,v,g;if(u==="ScatterChart")x=f,v=yk,g=Bt.cursorLine;else if(u==="BarChart")x=vk(l,f,s,o),v=cv,g=Bt.cursorRectangle;else if(l==="radial"&&Rg(f)){var{cx:b,cy:y,radius:N,startAngle:A,endAngle:E}=uv(f);x={cx:b,cy:y,startAngle:A,endAngle:E,innerRadius:N,outerRadius:N},v=hv,g=Bt.cursorLine}else x={points:iA(l,f,s)},v=Qd,g=Bt.cursorLine;var w=typeof d=="object"&&"className"in d?d.className:void 0,P=zs(zs(zs(zs({stroke:"#ccc",pointerEvents:"none"},s),x),xa(d)),{},{payload:m,payloadIndex:p,className:nt("recharts-tooltip-cursor",w)});return c.createElement(kn,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:g},c.createElement(PT,{cursor:d,cursorComp:v,cursorProps:P}))}function TT(e){var t=XI(),r=Jy(),a=Gi(),i=rT();return t==null||r==null||a==null||i==null?null:c.createElement(IT,ld({},e,{offset:r,layout:a,tooltipAxisBandSize:t,chartName:i}))}var jx=c.createContext(null),OT=()=>c.useContext(jx),wx={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(r=!1));function i(d,h,u){this.fn=d,this.context=h,this.once=u||!1}function s(d,h,u,f,m){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new i(u,f||d,m),x=r?r+h:h;return d._events[x]?d._events[x].fn?d._events[x]=[d._events[x],p]:d._events[x].push(p):(d._events[x]=p,d._eventsCount++),d}function o(d,h){--d._eventsCount===0?d._events=new a:delete d._events[h]}function l(){this._events=new a,this._eventsCount=0}l.prototype.eventNames=function(){var h=[],u,f;if(this._eventsCount===0)return h;for(f in u=this._events)t.call(u,f)&&h.push(r?f.slice(1):f);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(u)):h},l.prototype.listeners=function(h){var u=r?r+h:h,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var m=0,p=f.length,x=new Array(p);m<p;m++)x[m]=f[m].fn;return x},l.prototype.listenerCount=function(h){var u=r?r+h:h,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(h,u,f,m,p,x){var v=r?r+h:h;if(!this._events[v])return!1;var g=this._events[v],b=arguments.length,y,N;if(g.fn){switch(g.once&&this.removeListener(h,g.fn,void 0,!0),b){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,f),!0;case 4:return g.fn.call(g.context,u,f,m),!0;case 5:return g.fn.call(g.context,u,f,m,p),!0;case 6:return g.fn.call(g.context,u,f,m,p,x),!0}for(N=1,y=new Array(b-1);N<b;N++)y[N-1]=arguments[N];g.fn.apply(g.context,y)}else{var A=g.length,E;for(N=0;N<A;N++)switch(g[N].once&&this.removeListener(h,g[N].fn,void 0,!0),b){case 1:g[N].fn.call(g[N].context);break;case 2:g[N].fn.call(g[N].context,u);break;case 3:g[N].fn.call(g[N].context,u,f);break;case 4:g[N].fn.call(g[N].context,u,f,m);break;default:if(!y)for(E=1,y=new Array(b-1);E<b;E++)y[E-1]=arguments[E];g[N].fn.apply(g[N].context,y)}}return!0},l.prototype.on=function(h,u,f){return s(this,h,u,f,!1)},l.prototype.once=function(h,u,f){return s(this,h,u,f,!0)},l.prototype.removeListener=function(h,u,f,m){var p=r?r+h:h;if(!this._events[p])return this;if(!u)return o(this,p),this;var x=this._events[p];if(x.fn)x.fn===u&&(!m||x.once)&&(!f||x.context===f)&&o(this,p);else{for(var v=0,g=[],b=x.length;v<b;v++)(x[v].fn!==u||m&&!x[v].once||f&&x[v].context!==f)&&g.push(x[v]);g.length?this._events[p]=g.length===1?g[0]:g:o(this,p)}return this},l.prototype.removeAllListeners=function(h){var u;return h?(u=r?r+h:h,this._events[u]&&o(this,u)):(this._events=new a,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(wx);var _T=wx.exports;const DT=Vr(_T);var Fi=new DT,cd="recharts.syncEvent.tooltip",rp="recharts.syncEvent.brush";function of(e,t){if(t){var r=Number.parseInt(t,10);if(!Jn(r))return e==null?void 0:e[r]}}var MT={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},Sx=Nn({name:"options",initialState:MT,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),$T=Sx.reducer,{createEventEmitter:LT}=Sx.actions;function RT(e){return e.tooltip.syncInteraction}var zT={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},Nx=Nn({name:"chartData",initialState:zT,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:a}=t.payload;r!=null&&(e.dataStartIndex=r),a!=null&&(e.dataEndIndex=a)}}}),{setChartData:ap,setDataStartEndIndexes:WT,setComputedData:wL}=Nx.actions,BT=Nx.reducer,FT=["x","y"];function ip(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Ba(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ip(Object(r),!0).forEach(function(a){qT(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ip(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function qT(e,t,r){return(t=UT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UT(e){var t=HT(e,"string");return typeof t=="symbol"?t:t+""}function HT(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function YT(e,t){if(e==null)return{};var r,a,i=KT(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function KT(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function GT(){var e=$e(ku),t=$e(Au),r=Nt(),a=$e(p0),i=$e($r),s=Gi(),o=sl(),l=$e(d=>d.rootProps.className);c.useEffect(()=>{if(e==null)return Ca;var d=(h,u,f)=>{if(t!==f&&e===h){if(a==="index"){var m;if(o&&u!==null&&u!==void 0&&(m=u.payload)!==null&&m!==void 0&&m.coordinate&&u.payload.sourceViewBox){var p=u.payload.coordinate,{x,y:v}=p,g=YT(p,FT),{x:b,y,width:N,height:A}=u.payload.sourceViewBox,E=Ba(Ba({},g),{},{x:o.x+(N?(x-b)/N:0)*o.width,y:o.y+(A?(v-y)/A:0)*o.height});r(Ba(Ba({},u),{},{payload:Ba(Ba({},u.payload),{},{coordinate:E})}))}else r(u);return}if(i!=null){var w;if(typeof a=="function"){var P={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},_=a(i,P);w=i[_]}else a==="value"&&(w=i.find(Z=>String(Z.value)===u.payload.label));var{coordinate:$}=u.payload;if(w==null||u.payload.active===!1||$==null||o==null){r(sd({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:L,y:j}=$,S=Math.min(L,o.x+o.width),R=Math.min(j,o.y+o.height),O={x:s==="horizontal"?w.coordinate:S,y:s==="horizontal"?R:w.coordinate},z=sd({active:u.payload.active,coordinate:O,dataKey:u.payload.dataKey,index:String(w.index),label:u.payload.label,sourceViewBox:u.payload.sourceViewBox});r(z)}}};return Fi.on(cd,d),()=>{Fi.off(cd,d)}},[l,r,t,e,a,i,s,o])}function VT(){var e=$e(ku),t=$e(Au),r=Nt();c.useEffect(()=>{if(e==null)return Ca;var a=(i,s,o)=>{t!==o&&e===i&&r(WT(s))};return Fi.on(rp,a),()=>{Fi.off(rp,a)}},[r,t,e])}function XT(){var e=Nt();c.useEffect(()=>{e(LT())},[e]),GT(),VT()}function QT(e,t,r,a,i,s){var o=$e(p=>iT(p,e,t)),l=$e(Au),d=$e(ku),h=$e(p0),u=$e(RT),f=u==null?void 0:u.active,m=sl();c.useEffect(()=>{if(!f&&d!=null&&l!=null){var p=sd({active:s,coordinate:r,dataKey:o,index:i,label:typeof a=="number"?String(a):a,sourceViewBox:m});Fi.emit(cd,d,p,l)}},[f,r,o,i,a,l,d,h,s,m])}function sp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function op(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?sp(Object(r),!0).forEach(function(a){JT(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):sp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function JT(e,t,r){return(t=ZT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZT(e){var t=eO(e,"string");return typeof t=="symbol"?t:t+""}function eO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function tO(e){return e.dataKey}function nO(e,t){return c.isValidElement(e)?c.cloneElement(e,t):typeof e=="function"?c.createElement(e,t):c.createElement(V2,t)}var lp=[],rO={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Qr.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function dd(e){var t,r,a=tn(e,rO),{active:i,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:d,filterNull:h,isAnimationActive:u,offset:f,payloadUniqBy:m,position:p,reverseDirection:x,useTranslate3d:v,wrapperStyle:g,cursor:b,shared:y,trigger:N,defaultIndex:A,portal:E,axisId:w}=a,P=Nt(),_=typeof A=="number"?String(A):A;c.useEffect(()=>{P(rI({shared:y,trigger:N,axisId:w,active:i,defaultIndex:_}))},[P,y,N,w,i,_]);var $=sl(),L=av(),j=JP(y),{activeIndex:S,isActive:R}=(t=$e(Y=>lT(Y,j,N,_)))!==null&&t!==void 0?t:{},O=$e(Y=>oT(Y,j,N,_)),z=$e(Y=>xx(Y,j,N,_)),Z=$e(Y=>sT(Y,j,N,_)),ae=O,se=OT(),H=(r=i??R)!==null&&r!==void 0?r:!1,[q,C]=rN([ae,H]),T=j==="axis"?z:void 0;QT(j,N,Z,T,S,H);var W=E??se;if(W==null||$==null||j==null)return null;var I=ae??lp;H||(I=lp),h&&I.length&&(I=jS(I.filter(Y=>Y.value!=null&&(Y.hide!==!0||a.includeHidden)),m,tO));var U=I.length>0,K=c.createElement(nk,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:u,active:H,coordinate:Z,hasPayload:U,offset:f,position:p,reverseDirection:x,useTranslate3d:v,viewBox:$,wrapperStyle:g,lastBoundingBox:q,innerRef:C,hasPortalFromProps:!!E},nO(d,op(op({},a),{},{payload:I,label:T,active:H,activeIndex:S,coordinate:Z,accessibilityLayer:L})));return c.createElement(c.Fragment,null,jd.createPortal(K,W),H&&c.createElement(TT,{cursor:b,tooltipEventType:j,coordinate:Z,payload:I,index:S}))}var Ia=e=>null;Ia.displayName="Cell";function aO(e,t,r){return(t=iO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function iO(e){var t=sO(e,"string");return typeof t=="symbol"?t:t+""}function sO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class oO{constructor(t){aO(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var a=this.cache.keys().next().value;this.cache.delete(a)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function cp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function lO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cp(Object(r),!0).forEach(function(a){cO(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function cO(e,t,r){return(t=dO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dO(e){var t=uO(e,"string");return typeof t=="symbol"?t:t+""}function uO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fO={cacheSize:2e3,enableCache:!0},kx=lO({},fO),dp=new oO(kx.cacheSize),hO={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},up="recharts_measurement_span";function mO(e,t){var r=t.fontSize||"",a=t.fontFamily||"",i=t.fontWeight||"",s=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(o,"|").concat(l)}var fp=(e,t)=>{try{var r=document.getElementById(up);r||(r=document.createElement("span"),r.setAttribute("id",up),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,hO,t),r.textContent="".concat(e);var a=r.getBoundingClientRect();return{width:a.width,height:a.height}}catch{return{width:0,height:0}}},Ii=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Qr.isSsr)return{width:0,height:0};if(!kx.enableCache)return fp(t,r);var a=mO(t,r),i=dp.get(a);if(i)return i;var s=fp(t,r);return dp.set(a,s),s},hp=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,mp=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,pO=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,gO=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Ax={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},yO=Object.keys(Ax),qa="NaN";function vO(e,t){return e*Ax[t]}class jn{static parse(t){var r,[,a,i]=(r=gO.exec(t))!==null&&r!==void 0?r:[];return new jn(parseFloat(a),i??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Jn(t)&&(this.unit=""),r!==""&&!pO.test(r)&&(this.num=NaN,this.unit=""),yO.includes(r)&&(this.num=vO(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new jn(NaN,""):new jn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new jn(NaN,""):new jn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new jn(NaN,""):new jn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new jn(NaN,""):new jn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Jn(this.num)}}function Cx(e){if(e.includes(qa))return qa;for(var t=e;t.includes("*")||t.includes("/");){var r,[,a,i,s]=(r=hp.exec(t))!==null&&r!==void 0?r:[],o=jn.parse(a??""),l=jn.parse(s??""),d=i==="*"?o.multiply(l):o.divide(l);if(d.isNaN())return qa;t=t.replace(hp,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var h,[,u,f,m]=(h=mp.exec(t))!==null&&h!==void 0?h:[],p=jn.parse(u??""),x=jn.parse(m??""),v=f==="+"?p.add(x):p.subtract(x);if(v.isNaN())return qa;t=t.replace(mp,v.toString())}return t}var pp=/\(([^()]*)\)/;function xO(e){for(var t=e,r;(r=pp.exec(t))!=null;){var[,a]=r;t=t.replace(pp,Cx(a))}return t}function bO(e){var t=e.replace(/\s+/g,"");return t=xO(t),t=Cx(t),t}function jO(e){try{return bO(e)}catch{return qa}}function yc(e){var t=jO(e.slice(5,-1));return t===qa?"":t}var wO=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],SO=["dx","dy","angle","className","breakAll"];function ud(){return ud=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ud.apply(null,arguments)}function gp(e,t){if(e==null)return{};var r,a,i=NO(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function NO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ex=/[ \f\n\r\t\v\u2028\u2029]+/,Px=e=>{var{children:t,breakAll:r,style:a}=e;try{var i=[];St(t)||(r?i=t.toString().split(""):i=t.toString().split(Ex));var s=i.map(l=>({word:l,width:Ii(l,a).width})),o=r?0:Ii(" ",a).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function kO(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var Ix=(e,t,r,a)=>e.reduce((i,s)=>{var{word:o,width:l}=s,d=i[i.length-1];if(d&&l!=null&&(t==null||a||d.width+l+r<Number(t)))d.words.push(o),d.width+=l+r;else{var h={words:[o],width:l};i.push(h)}return i},[]),Tx=e=>e.reduce((t,r)=>t.width>r.width?t:r),AO="…",yp=(e,t,r,a,i,s,o,l)=>{var d=e.slice(0,t),h=Px({breakAll:r,style:a,children:d+AO});if(!h)return[!1,[]];var u=Ix(h.wordsWithComputedWidth,s,o,l),f=u.length>i||Tx(u).width>Number(s);return[f,u]},CO=(e,t,r,a,i)=>{var{maxLines:s,children:o,style:l,breakAll:d}=e,h=Me(s),u=String(o),f=Ix(t,a,r,i);if(!h||i)return f;var m=f.length>s||Tx(f).width>Number(a);if(!m)return f;for(var p=0,x=u.length-1,v=0,g;p<=x&&v<=u.length-1;){var b=Math.floor((p+x)/2),y=b-1,[N,A]=yp(u,y,d,l,s,a,r,i),[E]=yp(u,b,d,l,s,a,r,i);if(!N&&!E&&(p=b+1),N&&E&&(x=b-1),!N&&E){g=A;break}v++}return g||f},vp=e=>{var t=St(e)?[]:e.toString().split(Ex);return[{words:t,width:void 0}]},EO=e=>{var{width:t,scaleToFit:r,children:a,style:i,breakAll:s,maxLines:o}=e;if((t||r)&&!Qr.isSsr){var l,d,h=Px({breakAll:s,children:a,style:i});if(h){var{wordsWithComputedWidth:u,spaceWidth:f}=h;l=u,d=f}else return vp(a);return CO({breakAll:s,children:a,maxLines:o,style:i},l,d,t,!!r)}return vp(a)},Ox="#808080",PO={breakAll:!1,capHeight:"0.71em",fill:Ox,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},Cl=c.forwardRef((e,t)=>{var r=tn(e,PO),{x:a,y:i,lineHeight:s,capHeight:o,fill:l,scaleToFit:d,textAnchor:h,verticalAnchor:u}=r,f=gp(r,wO),m=c.useMemo(()=>EO({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:d,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,d,f.style,f.width]),{dx:p,dy:x,angle:v,className:g,breakAll:b}=f,y=gp(f,SO);if(!cr(a)||!cr(i)||m.length===0)return null;var N=Number(a)+(Me(p)?p:0),A=Number(i)+(Me(x)?x:0);if(!Lt(N)||!Lt(A))return null;var E;switch(u){case"start":E=yc("calc(".concat(o,")"));break;case"middle":E=yc("calc(".concat((m.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:E=yc("calc(".concat(m.length-1," * -").concat(s,")"));break}var w=[];if(d){var P=m[0].width,{width:_}=f;w.push("scale(".concat(Me(_)&&Me(P)?_/P:1,")"))}return v&&w.push("rotate(".concat(v,", ").concat(N,", ").concat(A,")")),w.length&&(y.transform=w.join(" ")),c.createElement("text",ud({},yn(y),{ref:t,x:N,y:A,className:nt("recharts-text",g),textAnchor:h,fill:l.includes("url")?Ox:l}),m.map(($,L)=>{var j=$.words.join(b?"":" ");return c.createElement("tspan",{x:N,dy:L===0?E:s,key:"".concat(j,"-").concat(L)},j)}))});Cl.displayName="Text";var IO=["labelRef"];function TO(e,t){if(e==null)return{};var r,a,i=OO(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function OO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function xp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function $t(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?xp(Object(r),!0).forEach(function(a){_O(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):xp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function _O(e,t,r){return(t=DO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DO(e){var t=MO(e,"string");return typeof t=="symbol"?t:t+""}function MO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function xr(){return xr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},xr.apply(null,arguments)}var _x=c.createContext(null),$O=e=>{var{x:t,y:r,upperWidth:a,lowerWidth:i,width:s,height:o,children:l}=e,d=c.useMemo(()=>({x:t,y:r,upperWidth:a,lowerWidth:i,width:s,height:o}),[t,r,a,i,s,o]);return c.createElement(_x.Provider,{value:d},l)},Dx=()=>{var e=c.useContext(_x),t=sl();return e||Qy(t)},LO=c.createContext(null),RO=()=>{var e=c.useContext(LO),t=$e(b0);return e||t},zO=e=>{var{value:t,formatter:r}=e,a=St(e.children)?t:e.children;return typeof r=="function"?r(a):a},lf=e=>e!=null&&typeof e=="function",WO=(e,t)=>{var r=Zt(t-e),a=Math.min(Math.abs(t-e),360);return r*a},BO=(e,t,r,a,i)=>{var{offset:s,className:o}=e,{cx:l,cy:d,innerRadius:h,outerRadius:u,startAngle:f,endAngle:m,clockWise:p}=i,x=(h+u)/2,v=WO(f,m),g=v>=0?1:-1,b,y;switch(t){case"insideStart":b=f+g*s,y=p;break;case"insideEnd":b=m-g*s,y=!p;break;case"end":b=m+g*s,y=p;break;default:throw new Error("Unsupported position ".concat(t))}y=v<=0?y:!y;var N=Wt(l,d,x,b),A=Wt(l,d,x,b+(y?1:-1)*359),E="M".concat(N.x,",").concat(N.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(y?0:1,`,
    `).concat(A.x,",").concat(A.y),w=St(e.id)?Oi("recharts-radial-line-"):e.id;return c.createElement("text",xr({},a,{dominantBaseline:"central",className:nt("recharts-radial-bar-label",o)}),c.createElement("defs",null,c.createElement("path",{id:w,d:E})),c.createElement("textPath",{xlinkHref:"#".concat(w)},r))},FO=(e,t,r)=>{var{cx:a,cy:i,innerRadius:s,outerRadius:o,startAngle:l,endAngle:d}=e,h=(l+d)/2;if(r==="outside"){var{x:u,y:f}=Wt(a,i,o+t,h);return{x:u,y:f,textAnchor:u>=a?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"end"};var m=(s+o)/2,{x:p,y:x}=Wt(a,i,m,h);return{x:p,y:x,textAnchor:"middle",verticalAnchor:"middle"}},fd=e=>"cx"in e&&Me(e.cx),qO=(e,t)=>{var{parentViewBox:r,offset:a,position:i}=e,s;r!=null&&!fd(r)&&(s=r);var{x:o,y:l,upperWidth:d,lowerWidth:h,height:u}=t,f=o,m=o+(d-h)/2,p=(f+m)/2,x=(d+h)/2,v=f+d/2,g=u>=0?1:-1,b=g*a,y=g>0?"end":"start",N=g>0?"start":"end",A=d>=0?1:-1,E=A*a,w=A>0?"end":"start",P=A>0?"start":"end";if(i==="top"){var _={x:f+d/2,y:l-b,textAnchor:"middle",verticalAnchor:y};return $t($t({},_),s?{height:Math.max(l-s.y,0),width:d}:{})}if(i==="bottom"){var $={x:m+h/2,y:l+u+b,textAnchor:"middle",verticalAnchor:N};return $t($t({},$),s?{height:Math.max(s.y+s.height-(l+u),0),width:h}:{})}if(i==="left"){var L={x:p-E,y:l+u/2,textAnchor:w,verticalAnchor:"middle"};return $t($t({},L),s?{width:Math.max(L.x-s.x,0),height:u}:{})}if(i==="right"){var j={x:p+x+E,y:l+u/2,textAnchor:P,verticalAnchor:"middle"};return $t($t({},j),s?{width:Math.max(s.x+s.width-j.x,0),height:u}:{})}var S=s?{width:x,height:u}:{};return i==="insideLeft"?$t({x:p+E,y:l+u/2,textAnchor:P,verticalAnchor:"middle"},S):i==="insideRight"?$t({x:p+x-E,y:l+u/2,textAnchor:w,verticalAnchor:"middle"},S):i==="insideTop"?$t({x:f+d/2,y:l+b,textAnchor:"middle",verticalAnchor:N},S):i==="insideBottom"?$t({x:m+h/2,y:l+u-b,textAnchor:"middle",verticalAnchor:y},S):i==="insideTopLeft"?$t({x:f+E,y:l+b,textAnchor:P,verticalAnchor:N},S):i==="insideTopRight"?$t({x:f+d-E,y:l+b,textAnchor:w,verticalAnchor:N},S):i==="insideBottomLeft"?$t({x:m+E,y:l+u-b,textAnchor:P,verticalAnchor:y},S):i==="insideBottomRight"?$t({x:m+h-E,y:l+u-b,textAnchor:w,verticalAnchor:y},S):i&&typeof i=="object"&&(Me(i.x)||Nr(i.x))&&(Me(i.y)||Nr(i.y))?$t({x:o+un(i.x,x),y:l+un(i.y,u),textAnchor:"end",verticalAnchor:"end"},S):$t({x:v,y:l+u/2,textAnchor:"middle",verticalAnchor:"middle"},S)},UO={offset:5,zIndex:Bt.label};function Fr(e){var t=tn(e,UO),{viewBox:r,position:a,value:i,children:s,content:o,className:l="",textBreakAll:d,labelRef:h}=t,u=RO(),f=Dx(),m=a==="center"?f:u??f,p,x,v;if(r==null?p=m:fd(r)?p=r:p=Qy(r),!p||St(i)&&St(s)&&!c.isValidElement(o)&&typeof o!="function")return null;var g=$t($t({},t),{},{viewBox:p});if(c.isValidElement(o)){var{labelRef:b}=g,y=TO(g,IO);return c.cloneElement(o,y)}if(typeof o=="function"){if(x=c.createElement(o,g),c.isValidElement(x))return x}else x=zO(t);var N=yn(t);if(fd(p)){if(a==="insideStart"||a==="insideEnd"||a==="end")return BO(t,a,x,N,p);v=FO(p,t.offset,t.position)}else v=qO(t,p);return c.createElement(kn,{zIndex:t.zIndex},c.createElement(Cl,xr({ref:h,className:nt("recharts-label",l)},N,v,{textAnchor:kO(N.textAnchor)?N.textAnchor:v.textAnchor,breakAll:d}),x))}Fr.displayName="Label";var HO=(e,t,r)=>{if(!e)return null;var a={viewBox:t,labelRef:r};return e===!0?c.createElement(Fr,xr({key:"label-implicit"},a)):cr(e)?c.createElement(Fr,xr({key:"label-implicit",value:e},a)):c.isValidElement(e)?e.type===Fr?c.cloneElement(e,$t({key:"label-implicit"},a)):c.createElement(Fr,xr({key:"label-implicit",content:e},a)):lf(e)?c.createElement(Fr,xr({key:"label-implicit",content:e},a)):e&&typeof e=="object"?c.createElement(Fr,xr({},e,{key:"label-implicit"},a)):null};function YO(e){var{label:t,labelRef:r}=e,a=Dx();return HO(t,a,r)||null}var Mx={},$x={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})($x);var Lx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(Lx);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$x,r=Lx,a=Go;function i(s){if(a.isArrayLike(s))return t.last(r.toArray(s))}e.last=i})(Mx);var KO=Mx.last;const GO=Vr(KO);var VO=["valueAccessor"],XO=["dataKey","clockWise","id","textBreakAll","zIndex"];function No(){return No=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},No.apply(null,arguments)}function bp(e,t){if(e==null)return{};var r,a,i=QO(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function QO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var JO=e=>Array.isArray(e.value)?GO(e.value):e.value,Rx=c.createContext(void 0),zx=Rx.Provider,Wx=c.createContext(void 0),ZO=Wx.Provider;function e_(){return c.useContext(Rx)}function t_(){return c.useContext(Wx)}function Us(e){var{valueAccessor:t=JO}=e,r=bp(e,VO),{dataKey:a,clockWise:i,id:s,textBreakAll:o,zIndex:l}=r,d=bp(r,XO),h=e_(),u=t_(),f=h||u;return!f||!f.length?null:c.createElement(kn,{zIndex:l??Bt.label},c.createElement(en,{className:"recharts-label-list"},f.map((m,p)=>{var x,v=St(a)?t(m,p):ht(m&&m.payload,a),g=St(s)?{}:{id:"".concat(s,"-").concat(p)};return c.createElement(Fr,No({key:"label-".concat(p)},yn(m),d,g,{fill:(x=r.fill)!==null&&x!==void 0?x:m.fill,parentViewBox:m.parentViewBox,value:v,textBreakAll:o,viewBox:m.viewBox,index:p,zIndex:0}))})))}Us.displayName="LabelList";function cf(e){var{label:t}=e;return t?t===!0?c.createElement(Us,{key:"labelList-implicit"}):c.isValidElement(t)||lf(t)?c.createElement(Us,{key:"labelList-implicit",content:t}):typeof t=="object"?c.createElement(Us,No({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function hd(){return hd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},hd.apply(null,arguments)}var Bx=e=>{var{cx:t,cy:r,r:a,className:i}=e,s=nt("recharts-dot",i);return Me(t)&&Me(r)&&Me(a)?c.createElement("circle",hd({},_n(e),Td(e),{className:s,cx:t,cy:r,r:a})):null},Fx=e=>e.graphicalItems.polarItems,n_=pe([kt,ns],Ou),El=pe([Fx,Tt,n_],_u),r_=pe([El],Du),Pl=pe([r_,ju],Mu),a_=pe([Pl,Tt,El],Lu);pe([Pl,Tt,El],(e,t,r)=>r.length>0?e.flatMap(a=>r.flatMap(i=>{var s,o=ht(a,(s=t.dataKey)!==null&&s!==void 0?s:i.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(a=>({value:ht(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]})));var jp=()=>{},i_=pe([Pl,Tt,El,Sl,kt],Bu),s_=pe([Tt,zu,Wu,jp,i_,jp,et,kt],Fu),qx=pe([Tt,et,Pl,a_,ts,kt,s_],qu),o_=pe([qx,Tt,ii],Yu);pe([Tt,qx,o_,kt],Gu);var l_={radiusAxis:{},angleAxis:{}},Ux=Nn({name:"polarAxis",initialState:l_,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:SL,removeRadiusAxis:NL,addAngleAxis:kL,removeAngleAxis:AL}=Ux.actions,c_=Ux.reducer;function wp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Sp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wp(Object(r),!0).forEach(function(a){d_(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function d_(e,t,r){return(t=u_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u_(e){var t=f_(e,"string");return typeof t=="symbol"?t:t+""}function f_(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h_=(e,t)=>t,df=pe([Fx,h_],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),m_=[],uf=(e,t,r)=>(r==null?void 0:r.length)===0?m_:r,Hx=pe([ju,df,uf],(e,t,r)=>{var{chartData:a}=e;if(t!=null){var i;if((t==null?void 0:t.data)!=null&&t.data.length>0?i=t.data:i=a,(!i||!i.length)&&r!=null&&(i=r.map(s=>Sp(Sp({},t.presentationProps),s.props))),i!=null)return i}}),p_=pe([Hx,df,uf],(e,t,r)=>{if(!(e==null||t==null))return e.map((a,i)=>{var s,o=ht(a,t.nameKey,t.name),l;return r!=null&&(s=r[i])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[i].props.fill:typeof a=="object"&&a!=null&&"fill"in a?l=a.fill:l=t.fill,{value:Za(o,t.dataKey),color:l,payload:a,type:t.legendType}})}),g_=pe([Hx,df,uf,Yt],(e,t,r,a)=>{if(!(t==null||e==null))return hD({offset:a,pieSettings:t,displayedData:e,cells:r})}),Yx={exports:{}},ut={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ff=Symbol.for("react.transitional.element"),hf=Symbol.for("react.portal"),Il=Symbol.for("react.fragment"),Tl=Symbol.for("react.strict_mode"),Ol=Symbol.for("react.profiler"),_l=Symbol.for("react.consumer"),Dl=Symbol.for("react.context"),Ml=Symbol.for("react.forward_ref"),$l=Symbol.for("react.suspense"),Ll=Symbol.for("react.suspense_list"),Rl=Symbol.for("react.memo"),zl=Symbol.for("react.lazy"),y_=Symbol.for("react.view_transition"),v_=Symbol.for("react.client.reference");function Hn(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case ff:switch(e=e.type,e){case Il:case Ol:case Tl:case $l:case Ll:case y_:return e;default:switch(e=e&&e.$$typeof,e){case Dl:case Ml:case zl:case Rl:return e;case _l:return e;default:return t}}case hf:return t}}}ut.ContextConsumer=_l;ut.ContextProvider=Dl;ut.Element=ff;ut.ForwardRef=Ml;ut.Fragment=Il;ut.Lazy=zl;ut.Memo=Rl;ut.Portal=hf;ut.Profiler=Ol;ut.StrictMode=Tl;ut.Suspense=$l;ut.SuspenseList=Ll;ut.isContextConsumer=function(e){return Hn(e)===_l};ut.isContextProvider=function(e){return Hn(e)===Dl};ut.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===ff};ut.isForwardRef=function(e){return Hn(e)===Ml};ut.isFragment=function(e){return Hn(e)===Il};ut.isLazy=function(e){return Hn(e)===zl};ut.isMemo=function(e){return Hn(e)===Rl};ut.isPortal=function(e){return Hn(e)===hf};ut.isProfiler=function(e){return Hn(e)===Ol};ut.isStrictMode=function(e){return Hn(e)===Tl};ut.isSuspense=function(e){return Hn(e)===$l};ut.isSuspenseList=function(e){return Hn(e)===Ll};ut.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Il||e===Ol||e===Tl||e===$l||e===Ll||typeof e=="object"&&e!==null&&(e.$$typeof===zl||e.$$typeof===Rl||e.$$typeof===Dl||e.$$typeof===_l||e.$$typeof===Ml||e.$$typeof===v_||e.getModuleId!==void 0)};ut.typeOf=Hn;Yx.exports=ut;var x_=Yx.exports,Np=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",kp=null,vc=null,Kx=e=>{if(e===kp&&Array.isArray(vc))return vc;var t=[];return c.Children.forEach(e,r=>{St(r)||(x_.isFragment(r)?t=t.concat(Kx(r.props.children)):t.push(r))}),vc=t,kp=e,t};function mf(e,t){var r=[],a=[];return Array.isArray(t)?a=t.map(i=>Np(i)):a=[Np(t)],Kx(e).forEach(i=>{var s=ba(i,"type.displayName")||ba(i,"type.name");s&&a.indexOf(s)!==-1&&r.push(i)}),r}var Gx=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,Vx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var i;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((i=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&i.writable)?!1:r.toString()===`[object ${s}]`}let a=r;for(;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(r)===a}e.isPlainObject=t})(Vx);var b_=Vx.isPlainObject;const j_=Vr(b_);function Ap(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Cp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ap(Object(r),!0).forEach(function(a){w_(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ap(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function w_(e,t,r){return(t=S_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S_(e){var t=N_(e,"string");return typeof t=="symbol"?t:t+""}function N_(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ko(){return ko=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ko.apply(null,arguments)}var Ep=(e,t,r,a,i)=>{var s=r-a,o;return o="M ".concat(e,",").concat(t),o+="L ".concat(e+r,",").concat(t),o+="L ".concat(e+r-s/2,",").concat(t+i),o+="L ".concat(e+r-s/2-a,",").concat(t+i),o+="L ".concat(e,",").concat(t," Z"),o},k_={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},A_=e=>{var t=tn(e,k_),{x:r,y:a,upperWidth:i,lowerWidth:s,height:o,className:l}=t,{animationEasing:d,animationDuration:h,animationBegin:u,isUpdateAnimationActive:f}=t,m=c.useRef(null),[p,x]=c.useState(-1),v=c.useRef(i),g=c.useRef(s),b=c.useRef(o),y=c.useRef(r),N=c.useRef(a),A=Xi(e,"trapezoid-");if(c.useEffect(()=>{if(m.current&&m.current.getTotalLength)try{var O=m.current.getTotalLength();O&&x(O)}catch{}},[]),r!==+r||a!==+a||i!==+i||s!==+s||o!==+o||i===0&&s===0||o===0)return null;var E=nt("recharts-trapezoid",l);if(!f)return c.createElement("g",null,c.createElement("path",ko({},yn(t),{className:E,d:Ep(r,a,i,s,o)})));var w=v.current,P=g.current,_=b.current,$=y.current,L=N.current,j="0px ".concat(p===-1?1:p,"px"),S="".concat(p,"px 0px"),R=iv(["strokeDasharray"],h,d);return c.createElement(Vi,{animationId:A,key:A,canBegin:p>0,duration:h,easing:d,isActive:f,begin:u},O=>{var z=bt(w,i,O),Z=bt(P,s,O),ae=bt(_,o,O),se=bt($,r,O),H=bt(L,a,O);m.current&&(v.current=z,g.current=Z,b.current=ae,y.current=se,N.current=H);var q=O>0?{transition:R,strokeDasharray:S}:{strokeDasharray:j};return c.createElement("path",ko({},yn(t),{className:E,d:Ep(se,H,z,Z,ae),ref:m,style:Cp(Cp({},q),t.style)}))})},C_=["option","shapeType","propTransformer","activeClassName","isActive"];function E_(e,t){if(e==null)return{};var r,a,i=P_(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function P_(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function Pp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Ao(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pp(Object(r),!0).forEach(function(a){I_(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function I_(e,t,r){return(t=T_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T_(e){var t=O_(e,"string");return typeof t=="symbol"?t:t+""}function O_(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function __(e,t){return Ao(Ao({},t),e)}function D_(e,t){return e==="symbols"}function Ip(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return c.createElement(cv,r);case"trapezoid":return c.createElement(A_,r);case"sector":return c.createElement(hv,r);case"symbols":if(D_(t))return c.createElement(Lg,r);break;case"curve":return c.createElement(Qd,r);default:return null}}function M_(e){return c.isValidElement(e)?e.props:e}function pf(e){var{option:t,shapeType:r,propTransformer:a=__,activeClassName:i="recharts-active-shape",isActive:s}=e,o=E_(e,C_),l;if(c.isValidElement(t))l=c.cloneElement(t,Ao(Ao({},o),M_(t)));else if(typeof t=="function")l=t(o);else if(j_(t)&&typeof t!="boolean"){var d=a(t,o);l=c.createElement(Ip,{shapeType:r,elementProps:d})}else{var h=o;l=c.createElement(Ip,{shapeType:r,elementProps:h})}return s?c.createElement(en,{className:i},l):l}var gf=(e,t)=>{var r=Nt();return(a,i)=>s=>{e==null||e(a,i,s),r(J0({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition}))}},yf=e=>{var t=Nt();return(r,a)=>i=>{e==null||e(r,a,i),t(aI())}},vf=(e,t)=>{var r=Nt();return(a,i)=>s=>{e==null||e(a,i,s),r(iI({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition}))}};function xf(e){var{fn:t,args:r}=e,a=Nt(),i=fn();return c.useLayoutEffect(()=>{if(!i){var s=t(r);return a(tI(s)),()=>{a(nI(s))}}},[t,r,a,i]),null}function Xx(e){var{legendPayload:t}=e,r=Nt(),a=fn();return c.useLayoutEffect(()=>a?Ca:(r(nv(t)),()=>{r(rv(t))}),[r,a,t]),null}function $_(e){var{legendPayload:t}=e,r=Nt(),a=$e(et);return c.useLayoutEffect(()=>a!=="centric"&&a!=="radial"?Ca:(r(nv(t)),()=>{r(rv(t))}),[r,a,t]),null}var xc,L_=()=>{var[e]=c.useState(()=>Oi("uid-"));return e},R_=(xc=Jb.useId)!==null&&xc!==void 0?xc:L_;function Qx(e,t){var r=R_();return t||(e?"".concat(e,"-").concat(r):r)}var z_=c.createContext(void 0),bf=e=>{var{id:t,type:r,children:a}=e,i=Qx("recharts-".concat(r),t);return c.createElement(z_.Provider,{value:i},a(i))},W_={cartesianItems:[],polarItems:[]},Jx=Nn({name:"graphicalItems",initialState:W_,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Ht()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:a}=t.payload,i=wr(e).cartesianItems.indexOf(r);i>-1&&(e.cartesianItems[i]=a)},prepare:Ht()},removeCartesianGraphicalItem:{reducer(e,t){var r=wr(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:Ht()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Ht()},removePolarGraphicalItem:{reducer(e,t){var r=wr(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:Ht()}}}),{addCartesianGraphicalItem:B_,replaceCartesianGraphicalItem:F_,removeCartesianGraphicalItem:q_,addPolarGraphicalItem:U_,removePolarGraphicalItem:H_}=Jx.actions,Y_=Jx.reducer;function Zx(e){var t=Nt(),r=c.useRef(null);return c.useLayoutEffect(()=>{r.current===null?t(B_(e)):r.current!==e&&t(F_({prev:r.current,next:e})),r.current=e},[t,e]),c.useLayoutEffect(()=>()=>{r.current&&(t(q_(r.current)),r.current=null)},[t]),null}function K_(e){var t=Nt();return c.useLayoutEffect(()=>(t(U_(e)),()=>{t(H_(e))}),[t,e]),null}var G_=["onMouseEnter","onClick","onMouseLeave"],V_=["id"],X_=["id"];function jf(e,t){if(e==null)return{};var r,a,i=Q_(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Q_(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function Tp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function jt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tp(Object(r),!0).forEach(function(a){J_(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function J_(e,t,r){return(t=Z_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z_(e){var t=eD(e,"string");return typeof t=="symbol"?t:t+""}function eD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gr(){return Gr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Gr.apply(null,arguments)}function tD(e){var t=c.useMemo(()=>mf(e.children,Ia),[e.children]),r=$e(a=>p_(a,e.id,t));return r==null?null:c.createElement($_,{legendPayload:r})}function nD(e){var{dataKey:t,nameKey:r,sectors:a,stroke:i,strokeWidth:s,fill:o,name:l,hide:d,tooltipType:h}=e;return{dataDefinedOnItem:a.map(u=>u.tooltipPayload),positions:a.map(u=>u.tooltipPosition),settings:{stroke:i,strokeWidth:s,fill:o,dataKey:t,nameKey:r,name:Za(l,t),hide:d,type:h,color:o,unit:""}}}var rD=(e,t)=>e>t?"start":e<t?"end":"middle",aD=(e,t,r)=>un(typeof t=="function"?t(e):t,r,r*.8),iD=(e,t,r)=>{var{top:a,left:i,width:s,height:o}=t,l=dv(s,o),d=i+un(e.cx,s,s/2),h=a+un(e.cy,o,o/2),u=un(e.innerRadius,l,0),f=aD(r,e.outerRadius,l),m=e.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:d,cy:h,innerRadius:u,outerRadius:f,maxRadius:m}},sD=(e,t)=>{var r=Zt(t-e),a=Math.min(Math.abs(t-e),360);return r*a};function oD(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var lD=(e,t)=>{if(c.isValidElement(e))return c.cloneElement(e,t);if(typeof e=="function")return e(t);var r=nt("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return c.createElement(Qd,Gr({},t,{type:"linear",className:r}))},cD=(e,t,r)=>{if(c.isValidElement(e))return c.cloneElement(e,t);var a=r;if(typeof e=="function"&&(a=e(t),c.isValidElement(a)))return a;var i=nt("recharts-pie-label-text",oD(e));return c.createElement(Cl,Gr({},t,{alignmentBaseline:"middle",className:i}),a)};function dD(e){var{sectors:t,props:r,showLabels:a}=e,{label:i,labelLine:s,dataKey:o}=r;if(!a||!i||!t)return null;var l=_n(r),d=xa(i),h=xa(s),u=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,f=t.map((m,p)=>{var x=(m.startAngle+m.endAngle)/2,v=Wt(m.cx,m.cy,m.outerRadius+u,x),g=jt(jt(jt(jt({},l),m),{},{stroke:"none"},d),{},{index:p,textAnchor:rD(v.x,m.cx)},v),b=jt(jt(jt(jt({},l),m),{},{fill:"none",stroke:m.fill},h),{},{index:p,points:[Wt(m.cx,m.cy,m.outerRadius,x),v],key:"line"});return c.createElement(kn,{zIndex:Bt.label,key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(p)},c.createElement(en,null,s&&lD(s,b),cD(i,g,ht(m,o))))});return c.createElement(en,{className:"recharts-pie-labels"},f)}function uD(e){var{sectors:t,props:r,showLabels:a}=e,{label:i}=r;return typeof i=="object"&&i!=null&&"position"in i?c.createElement(cf,{label:i}):c.createElement(dD,{sectors:t,props:r,showLabels:a})}function fD(e){var{sectors:t,activeShape:r,inactiveShape:a,allOtherPieProps:i}=e,s=$e(Kr),{onMouseEnter:o,onClick:l,onMouseLeave:d}=i,h=jf(i,G_),u=gf(o,i.dataKey),f=yf(d),m=vf(l,i.dataKey);return t==null||t.length===0?null:c.createElement(c.Fragment,null,t.map((p,x)=>{if((p==null?void 0:p.startAngle)===0&&(p==null?void 0:p.endAngle)===0&&t.length!==1)return null;var v=r&&String(x)===s,g=s?a:null,b=v?r:g,y=jt(jt({},p),{},{stroke:p.stroke,tabIndex:-1,[qy]:x,[Uy]:i.dataKey});return c.createElement(en,Gr({key:"sector-".concat(p==null?void 0:p.startAngle,"-").concat(p==null?void 0:p.endAngle,"-").concat(p.midAngle,"-").concat(x),tabIndex:-1,className:"recharts-pie-sector"},Ko(h,p,x),{onMouseEnter:u(p,x),onMouseLeave:f(p,x),onClick:m(p,x)}),c.createElement(pf,Gr({option:b,isActive:v,shapeType:"sector"},y)))}))}function hD(e){var t,{pieSettings:r,displayedData:a,cells:i,offset:s}=e,{cornerRadius:o,startAngle:l,endAngle:d,dataKey:h,nameKey:u,tooltipType:f}=r,m=Math.abs(r.minAngle),p=sD(l,d),x=Math.abs(p),v=a.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,g=a.filter(w=>ht(w,h,0)!==0).length,b=(x>=360?g:g-1)*v,y=x-g*m-b,N=a.reduce((w,P)=>{var _=ht(P,h,0);return w+(Me(_)?_:0)},0),A;if(N>0){var E;A=a.map((w,P)=>{var _=ht(w,h,0),$=ht(w,u,P),L=iD(r,s,w),j=(Me(_)?_:0)/N,S,R=jt(jt({},w),i&&i[P]&&i[P].props);P?S=E.endAngle+Zt(p)*v*(_!==0?1:0):S=l;var O=S+Zt(p)*((_!==0?m:0)+j*y),z=(S+O)/2,Z=(L.innerRadius+L.outerRadius)/2,ae=[{name:$,value:_,payload:R,dataKey:h,type:f}],se=Wt(L.cx,L.cy,Z,z);return E=jt(jt(jt(jt({},r.presentationProps),{},{percent:j,cornerRadius:typeof o=="string"?parseFloat(o):o,name:$,tooltipPayload:ae,midAngle:z,middleRadius:Z,tooltipPosition:se},R),L),{},{value:_,startAngle:S,endAngle:O,payload:R,paddingAngle:Zt(p)*v}),E})}return A}function mD(e){var{showLabels:t,sectors:r,children:a}=e,i=c.useMemo(()=>!t||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,t]);return c.createElement(ZO,{value:t?i:void 0},a)}function pD(e){var{props:t,previousSectorsRef:r}=e,{sectors:a,isAnimationActive:i,animationBegin:s,animationDuration:o,animationEasing:l,activeShape:d,inactiveShape:h,onAnimationStart:u,onAnimationEnd:f}=t,m=Xi(t,"recharts-pie-"),p=r.current,[x,v]=c.useState(!1),g=c.useCallback(()=>{typeof f=="function"&&f(),v(!1)},[f]),b=c.useCallback(()=>{typeof u=="function"&&u(),v(!0)},[u]);return c.createElement(mD,{showLabels:!x,sectors:a},c.createElement(Vi,{animationId:m,begin:s,duration:o,isActive:i,easing:l,onAnimationStart:b,onAnimationEnd:g,key:m},y=>{var N=[],A=a&&a[0],E=A==null?void 0:A.startAngle;return a==null||a.forEach((w,P)=>{var _=p&&p[P],$=P>0?ba(w,"paddingAngle",0):0;if(_){var L=bt(_.endAngle-_.startAngle,w.endAngle-w.startAngle,y),j=jt(jt({},w),{},{startAngle:E+$,endAngle:E+L+$});N.push(j),E=j.endAngle}else{var{endAngle:S,startAngle:R}=w,O=bt(0,S-R,y),z=jt(jt({},w),{},{startAngle:E+$,endAngle:E+O+$});N.push(z),E=z.endAngle}}),r.current=N,c.createElement(en,null,c.createElement(fD,{sectors:N,activeShape:d,inactiveShape:h,allOtherPieProps:t}))}),c.createElement(uD,{showLabels:!x,sectors:a,props:t}),t.children)}var gD={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Qr.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Bt.area};function yD(e){var{id:t}=e,r=jf(e,V_),{hide:a,className:i,rootTabIndex:s}=e,o=c.useMemo(()=>mf(e.children,Ia),[e.children]),l=$e(u=>g_(u,t,o)),d=c.useRef(null),h=nt("recharts-pie",i);return a||l==null?(d.current=null,c.createElement(en,{tabIndex:s,className:h})):c.createElement(kn,{zIndex:e.zIndex},c.createElement(xf,{fn:nD,args:jt(jt({},e),{},{sectors:l})}),c.createElement(en,{tabIndex:s,className:h},c.createElement(pD,{props:jt(jt({},r),{},{sectors:l}),previousSectorsRef:d})))}function eb(e){var t=tn(e,gD),{id:r}=t,a=jf(t,X_),i=_n(a);return c.createElement(bf,{id:r,type:"pie"},s=>c.createElement(c.Fragment,null,c.createElement(K_,{type:"pie",id:s,data:a.data,dataKey:a.dataKey,hide:a.hide,angleAxisId:0,radiusAxisId:0,name:a.name,nameKey:a.nameKey,tooltipType:a.tooltipType,legendType:a.legendType,fill:a.fill,cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,paddingAngle:a.paddingAngle,minAngle:a.minAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius,cornerRadius:a.cornerRadius,presentationProps:i,maxRadius:t.maxRadius}),c.createElement(tD,Gr({},a,{id:s})),c.createElement(yD,Gr({},a,{id:s}))))}eb.displayName="Pie";var vD=["points"];function Op(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function bc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Op(Object(r),!0).forEach(function(a){xD(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Op(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function xD(e,t,r){return(t=bD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bD(e){var t=jD(e,"string");return typeof t=="symbol"?t:t+""}function jD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Co(){return Co=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Co.apply(null,arguments)}function wD(e,t){if(e==null)return{};var r,a,i=SD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function SD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function ND(e){var{option:t,dotProps:r,className:a}=e;if(c.isValidElement(t))return c.cloneElement(t,r);if(typeof t=="function")return t(r);var i=nt(a,typeof t!="boolean"?t.className:""),s=r??{},{points:o}=s,l=wD(s,vD);return c.createElement(Bx,Co({},l,{className:i}))}function kD(e,t){return e==null?!1:t?!0:e.length===1}function AD(e){var{points:t,dot:r,className:a,dotClassName:i,dataKey:s,baseProps:o,needClip:l,clipPathId:d,zIndex:h=Bt.scatter}=e;if(!kD(t,r))return null;var u=Gx(r),f=pw(r),m=t.map((x,v)=>{var g,b,y=bc(bc(bc({r:3},o),f),{},{index:v,cx:(g=x.x)!==null&&g!==void 0?g:void 0,cy:(b=x.y)!==null&&b!==void 0?b:void 0,dataKey:s,value:x.value,payload:x.payload,points:t});return c.createElement(ND,{key:"dot-".concat(v),option:r,dotProps:y,className:i})}),p={};return l&&d!=null&&(p.clipPath="url(#clipPath-".concat(u?"":"dots-").concat(d,")")),c.createElement(kn,{zIndex:h},c.createElement(en,Co({className:a},p),m))}function _p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Dp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_p(Object(r),!0).forEach(function(a){CD(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_p(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function CD(e,t,r){return(t=ED(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ED(e){var t=PD(e,"string");return typeof t=="symbol"?t:t+""}function PD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ID={xAxis:{},yAxis:{},zAxis:{}},tb=Nn({name:"cartesianAxis",initialState:ID,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Ht()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Ht()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Ht()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Ht()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Ht()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Ht()},updateYAxisWidth(e,t){var{id:r,width:a}=t.payload,i=e.yAxis[r];if(i){var s=i.widthHistory||[];if(s.length===3&&s[0]===s[2]&&a===s[1]&&a!==i.width&&Math.abs(a-s[0])<=1)return;var o=[...s,a].slice(-3);e.yAxis[r]=Dp(Dp({},e.yAxis[r]),{},{width:a,widthHistory:o})}}}}),{addXAxis:TD,removeXAxis:OD,addYAxis:_D,removeYAxis:DD,addZAxis:CL,removeZAxis:EL,updateYAxisWidth:MD}=tb.actions,$D=tb.reducer,LD=pe([Yt],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),RD=pe([LD,Tr,Or],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),wf=()=>$e(RD),zD=()=>$e(HI);function Mp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function jc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mp(Object(r),!0).forEach(function(a){WD(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function WD(e,t,r){return(t=BD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BD(e){var t=FD(e,"string");return typeof t=="symbol"?t:t+""}function FD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qD=e=>{var{point:t,childIndex:r,mainColor:a,activeDot:i,dataKey:s}=e;if(i===!1||t.x==null||t.y==null)return null;var o={index:r,dataKey:s,cx:t.x,cy:t.y,r:4,fill:a??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},l=jc(jc(jc({},o),xa(i)),Td(i)),d;return c.isValidElement(i)?d=c.cloneElement(i,l):typeof i=="function"?d=i(l):d=c.createElement(Bx,l),c.createElement(en,{className:"recharts-active-dot"},d)};function UD(e){var{points:t,mainColor:r,activeDot:a,itemDataKey:i,zIndex:s=Bt.activeDot}=e,o=$e(Kr),l=zD();if(t==null||l==null)return null;var d=t.find(h=>l.includes(h.payload));return St(d)?null:c.createElement(kn,{zIndex:s},c.createElement(qD,{point:d,childIndex:Number(o),mainColor:r,dataKey:i,activeDot:a}))}var HD="Invariant failed";function YD(e,t){throw new Error(HD)}var KD=["x","y"];function md(){return md=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},md.apply(null,arguments)}function $p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Ni(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$p(Object(r),!0).forEach(function(a){GD(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$p(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function GD(e,t,r){return(t=VD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VD(e){var t=XD(e,"string");return typeof t=="symbol"?t:t+""}function XD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function QD(e,t){if(e==null)return{};var r,a,i=JD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function JD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function ZD(e,t){var{x:r,y:a}=e,i=QD(e,KD),s="".concat(r),o=parseInt(s,10),l="".concat(a),d=parseInt(l,10),h="".concat(t.height||i.height),u=parseInt(h,10),f="".concat(t.width||i.width),m=parseInt(f,10);return Ni(Ni(Ni(Ni(Ni({},t),i),o?{x:o}:{}),d?{y:d}:{}),{},{height:u,width:m,name:t.name,radius:t.radius})}function Eo(e){return c.createElement(pf,md({shapeType:"rectangle",propTransformer:ZD,activeClassName:"recharts-active-bar"},e))}var eM=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a,i)=>{if(Me(t))return t;var s=Me(a)||St(a);return s?t(a,i):(s||YD(),r)}},tM={},nb=Nn({name:"errorBars",initialState:tM,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:a}=t.payload;e[r]||(e[r]=[]),e[r].push(a)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:a,next:i}=t.payload;e[r]&&(e[r]=e[r].map(s=>s.dataKey===a.dataKey&&s.direction===a.direction?i:s))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:a}=t.payload;e[r]&&(e[r]=e[r].filter(i=>i.dataKey!==a.dataKey||i.direction!==a.direction))}}}),{addErrorBar:PL,replaceErrorBar:IL,removeErrorBar:TL}=nb.actions,nM=nb.reducer,rM=["children"];function aM(e,t){if(e==null)return{};var r,a,i=iM(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function iM(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var sM={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},oM=c.createContext(sM);function rb(e){var{children:t}=e,r=aM(e,rM);return c.createElement(oM.Provider,{value:r},t)}function Sf(e,t){var r,a,i=$e(h=>Dr(h,e)),s=$e(h=>Mr(h,t)),o=(r=i==null?void 0:i.allowDataOverflow)!==null&&r!==void 0?r:En.allowDataOverflow,l=(a=s==null?void 0:s.allowDataOverflow)!==null&&a!==void 0?a:Pn.allowDataOverflow,d=o||l;return{needClip:d,needClipX:o,needClipY:l}}function ab(e){var{xAxisId:t,yAxisId:r,clipPathId:a}=e,i=wf(),{needClipX:s,needClipY:o,needClip:l}=Sf(t,r);if(!l||!i)return null;var{x:d,y:h,width:u,height:f}=i;return c.createElement("clipPath",{id:"clipPath-".concat(a)},c.createElement("rect",{x:s?d:d-u/2,y:o?h:h-f/2,width:s?u:u*2,height:o?f:f*2}))}function lM(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&Lt(e.zIndex)?e.zIndex:t}var cM=["onMouseEnter","onMouseLeave","onClick"],dM=["value","background","tooltipPosition"],uM=["id"],fM=["onMouseEnter","onClick","onMouseLeave"];function Ir(){return Ir=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ir.apply(null,arguments)}function Lp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function pn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lp(Object(r),!0).forEach(function(a){hM(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function hM(e,t,r){return(t=mM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mM(e){var t=pM(e,"string");return typeof t=="symbol"?t:t+""}function pM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Po(e,t){if(e==null)return{};var r,a,i=gM(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function gM(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var yM=e=>{var{dataKey:t,name:r,fill:a,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:a,value:Za(r,t),payload:e}]};function vM(e){var{dataKey:t,stroke:r,strokeWidth:a,fill:i,name:s,hide:o,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:Za(s,t),hide:o,type:e.tooltipType,color:e.fill,unit:l}}}function xM(e){var t=$e(Kr),{data:r,dataKey:a,background:i,allOtherBarProps:s}=e,{onMouseEnter:o,onMouseLeave:l,onClick:d}=s,h=Po(s,cM),u=gf(o,a),f=yf(l),m=vf(d,a);if(!i||r==null)return null;var p=xa(i);return c.createElement(kn,{zIndex:lM(i,Bt.barBackground)},r.map((x,v)=>{var{value:g,background:b,tooltipPosition:y}=x,N=Po(x,dM);if(!b)return null;var A=u(x,v),E=f(x,v),w=m(x,v),P=pn(pn(pn(pn(pn({option:i,isActive:String(v)===t},N),{},{fill:"#eee"},b),p),Ko(h,x,v)),{},{onMouseEnter:A,onMouseLeave:E,onClick:w,dataKey:a,index:v,className:"recharts-bar-background-rectangle"});return c.createElement(Eo,Ir({key:"background-bar-".concat(v)},P))}))}function bM(e){var{showLabels:t,children:r,rects:a}=e,i=a==null?void 0:a.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return pn(pn({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return c.createElement(zx,{value:t?i:void 0},r)}function jM(e){var{shape:t,activeBar:r,baseProps:a,entry:i,index:s,dataKey:o}=e,l=$e(Kr),d=$e(hx),h=r&&String(s)===l&&(d==null||o===d),u=h?r:t;return h?c.createElement(kn,{zIndex:Bt.activeBar},c.createElement(Eo,Ir({},a,{name:String(a.name)},i,{isActive:h,option:u,index:s,dataKey:o}))):c.createElement(Eo,Ir({},a,{name:String(a.name)},i,{isActive:h,option:u,index:s,dataKey:o}))}function wM(e){var{shape:t,baseProps:r,entry:a,index:i,dataKey:s}=e;return c.createElement(Eo,Ir({},r,{name:String(r.name)},a,{isActive:!1,option:t,index:i,dataKey:s}))}function SM(e){var t,{data:r,props:a}=e,i=(t=_n(a))!==null&&t!==void 0?t:{},{id:s}=i,o=Po(i,uM),{shape:l,dataKey:d,activeBar:h}=a,{onMouseEnter:u,onClick:f,onMouseLeave:m}=a,p=Po(a,fM),x=gf(u,d),v=yf(m),g=vf(f,d);return r?c.createElement(c.Fragment,null,r.map((b,y)=>c.createElement(en,Ir({key:"rectangle-".concat(b==null?void 0:b.x,"-").concat(b==null?void 0:b.y,"-").concat(b==null?void 0:b.value,"-").concat(y),className:"recharts-bar-rectangle"},Ko(p,b,y),{onMouseEnter:x(b,y),onMouseLeave:v(b,y),onClick:g(b,y)}),h?c.createElement(jM,{shape:l,activeBar:h,baseProps:o,entry:b,index:y,dataKey:d}):c.createElement(wM,{shape:l,baseProps:o,entry:b,index:y,dataKey:d})))):null}function NM(e){var{props:t,previousRectanglesRef:r}=e,{data:a,layout:i,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:d,onAnimationEnd:h,onAnimationStart:u}=t,f=r.current,m=Xi(t,"recharts-bar-"),[p,x]=c.useState(!1),v=!p,g=c.useCallback(()=>{typeof h=="function"&&h(),x(!1)},[h]),b=c.useCallback(()=>{typeof u=="function"&&u(),x(!0)},[u]);return c.createElement(bM,{showLabels:v,rects:a},c.createElement(Vi,{animationId:m,begin:o,duration:l,isActive:s,easing:d,onAnimationEnd:g,onAnimationStart:b,key:m},y=>{var N=y===1?a:a==null?void 0:a.map((A,E)=>{var w=f&&f[E];if(w)return pn(pn({},A),{},{x:bt(w.x,A.x,y),y:bt(w.y,A.y,y),width:bt(w.width,A.width,y),height:bt(w.height,A.height,y)});if(i==="horizontal"){var P=bt(0,A.height,y),_=bt(A.stackedBarStart,A.y,y);return pn(pn({},A),{},{y:_,height:P})}var $=bt(0,A.width,y),L=bt(A.stackedBarStart,A.x,y);return pn(pn({},A),{},{width:$,x:L})});return y>0&&(r.current=N??null),N==null?null:c.createElement(en,null,c.createElement(SM,{props:t,data:N}))}),c.createElement(cf,{label:t.label}),t.children)}function kM(e){var t=c.useRef(null);return c.createElement(NM,{previousRectanglesRef:t,props:e})}var ib=0,AM=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:ht(e,t)}};class CM extends c.PureComponent{render(){var{hide:t,data:r,dataKey:a,className:i,xAxisId:s,yAxisId:o,needClip:l,background:d,id:h}=this.props;if(t||r==null)return null;var u=nt("recharts-bar",i),f=h;return c.createElement(en,{className:u,id:h},l&&c.createElement("defs",null,c.createElement(ab,{clipPathId:f,xAxisId:s,yAxisId:o})),c.createElement(en,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},c.createElement(xM,{data:r,dataKey:a,background:d,allOtherBarProps:this.props}),c.createElement(kM,this.props)))}}var EM={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Qr.isSsr,legendType:"rect",minPointSize:ib,xAxisId:0,yAxisId:0,zIndex:Bt.bar};function PM(e){var{xAxisId:t,yAxisId:r,hide:a,legendType:i,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:d,animationEasing:h,isAnimationActive:u}=e,{needClip:f}=Sf(t,r),m=Gi(),p=fn(),x=mf(e.children,Ia),v=$e(y=>r6(y,t,r,p,e.id,x));if(m!=="vertical"&&m!=="horizontal")return null;var g,b=v==null?void 0:v[0];return b==null||b.height==null||b.width==null?g=0:g=m==="vertical"?b.height/2:b.width/2,c.createElement(rb,{xAxisId:t,yAxisId:r,data:v,dataPointFormatter:AM,errorBarOffset:g},c.createElement(CM,Ir({},e,{layout:m,needClip:f,data:v,xAxisId:t,yAxisId:r,hide:a,legendType:i,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:d,animationEasing:h,isAnimationActive:u})))}function IM(e){var{layout:t,barSettings:{dataKey:r,minPointSize:a},pos:i,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:d,yAxisTicks:h,stackedData:u,displayedData:f,offset:m,cells:p,parentViewBox:x,dataStartIndex:v}=e,g=t==="horizontal"?l:o,b=u?g.scale.domain():null,y=u2({numericAxis:g}),N=g.scale(y);return f.map((A,E)=>{var w,P,_,$,L,j;u?w=i2(u[E+v],b):(w=ht(A,r),Array.isArray(w)||(w=[y,w]));var S=eM(a,ib)(w[1],E);if(t==="horizontal"){var R,[O,z]=[l.scale(w[0]),l.scale(w[1])];P=Ph({axis:o,ticks:d,bandSize:s,offset:i.offset,entry:A,index:E}),_=(R=z??O)!==null&&R!==void 0?R:void 0,$=i.size;var Z=O-z;if(L=Jn(Z)?0:Z,j={x:P,y:m.top,width:$,height:m.height},Math.abs(S)>0&&Math.abs(L)<Math.abs(S)){var ae=Zt(L||S)*(Math.abs(S)-Math.abs(L));_-=ae,L+=ae}}else{var[se,H]=[o.scale(w[0]),o.scale(w[1])];if(P=se,_=Ph({axis:l,ticks:h,bandSize:s,offset:i.offset,entry:A,index:E}),$=H-se,L=i.size,j={x:m.left,y:_,width:m.width,height:L},Math.abs(S)>0&&Math.abs($)<Math.abs(S)){var q=Zt($||S)*(Math.abs(S)-Math.abs($));$+=q}}if(P==null||_==null||$==null||L==null)return null;var C=pn(pn({},A),{},{stackedBarStart:N,x:P,y:_,width:$,height:L,value:u?w:w[1],payload:A,background:j,tooltipPosition:{x:P+$/2,y:_+L/2},parentViewBox:x},p&&p[E]&&p[E].props);return C}).filter(Boolean)}function TM(e){var t=tn(e,EM),r=fn();return c.createElement(bf,{id:t.id,type:"bar"},a=>c.createElement(c.Fragment,null,c.createElement(Xx,{legendPayload:yM(t)}),c.createElement(xf,{fn:vM,args:t}),c.createElement(Zx,{type:"bar",id:a,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:d2(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),c.createElement(kn,{zIndex:t.zIndex},c.createElement(PM,Ir({},t,{id:a})))))}var Nf=c.memo(TM);Nf.displayName="Bar";function Rp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Ws(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rp(Object(r),!0).forEach(function(a){OM(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function OM(e,t,r){return(t=_M(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _M(e){var t=DM(e,"string");return typeof t=="symbol"?t:t+""}function DM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var MM=(e,t)=>t,$M=(e,t,r)=>r,LM=(e,t,r,a)=>a,RM=(e,t,r,a,i)=>i,ls=pe([jl,RM],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),zM=pe([ls],e=>e==null?void 0:e.maxBarSize),WM=(e,t,r,a,i,s)=>s,zp=(e,t,r)=>{var a=r??e;if(!St(a))return un(a,t,0)},BM=pe([et,jl,MM,$M,LM],(e,t,r,a,i)=>t.filter(s=>e==="horizontal"?s.xAxisId===r:s.yAxisId===a).filter(s=>s.isPanorama===i).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),FM=(e,t,r,a)=>{var i=et(e);return i==="horizontal"?id(e,"yAxis",r,a):id(e,"xAxis",t,a)},qM=(e,t,r)=>{var a=et(e);return a==="horizontal"?Ym(e,"xAxis",t):Ym(e,"yAxis",r)},UM=(e,t,r)=>{var a={},i=e.filter(vl),s=e.filter(h=>h.stackId==null),o=i.reduce((h,u)=>(h[u.stackId]||(h[u.stackId]=[]),h[u.stackId].push(u),h),a),l=Object.entries(o).map(h=>{var[u,f]=h,m=f.map(x=>x.dataKey),p=zp(t,r,f[0].barSize);return{stackId:u,dataKeys:m,barSize:p}}),d=s.map(h=>{var u=[h.dataKey].filter(m=>m!=null),f=zp(t,r,h.barSize);return{stackId:void 0,dataKeys:u,barSize:f}});return[...l,...d]},HM=pe([BM,GE,qM],UM),YM=(e,t,r,a,i)=>{var s,o,l=ls(e,t,r,a,i);if(l!=null){var d=et(e),h=h0(e),{maxBarSize:u}=l,f=St(u)?h:u,m,p;return d==="horizontal"?(m=Yr(e,"xAxis",t,a),p=Hr(e,"xAxis",t,a)):(m=Yr(e,"yAxis",r,a),p=Hr(e,"yAxis",r,a)),(s=(o=Ga(m,p,!0))!==null&&o!==void 0?o:f)!==null&&s!==void 0?s:0}},sb=(e,t,r,a)=>{var i=et(e),s,o;return i==="horizontal"?(s=Yr(e,"xAxis",t,a),o=Hr(e,"xAxis",t,a)):(s=Yr(e,"yAxis",r,a),o=Hr(e,"yAxis",r,a)),Ga(s,o)};function KM(e,t,r,a,i){var s=a.length;if(!(s<1)){var o=un(e,r,0,!0),l,d=[];if(Lt(a[0].barSize)){var h=!1,u=r/s,f=a.reduce((b,y)=>b+(y.barSize||0),0);f+=(s-1)*o,f>=r&&(f-=(s-1)*o,o=0),f>=r&&u>0&&(h=!0,u*=.9,f=s*u);var m=(r-f)/2>>0,p={offset:m-o,size:0};l=a.reduce((b,y)=>{var N,A={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:p.offset+p.size+o,size:h?u:(N=y.barSize)!==null&&N!==void 0?N:0}},E=[...b,A];return p=E[E.length-1].position,E},d)}else{var x=un(t,r,0,!0);r-2*x-(s-1)*o<=0&&(o=0);var v=(r-2*x-(s-1)*o)/s;v>1&&(v>>=0);var g=Lt(i)?Math.min(v,i):v;l=a.reduce((b,y,N)=>[...b,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:x+(v+o)*N+(v-g)/2,size:g}}],d)}return l}}var GM=(e,t,r,a,i,s,o)=>{var l=St(o)?t:o,d=KM(r,a,i!==s?i:s,e,l);return i!==s&&d!=null&&(d=d.map(h=>Ws(Ws({},h),{},{position:Ws(Ws({},h.position),{},{offset:h.position.offset-i/2})}))),d},VM=pe([HM,h0,KE,m0,YM,sb,zM],GM),XM=(e,t,r,a)=>Yr(e,"xAxis",t,a),QM=(e,t,r,a)=>Yr(e,"yAxis",r,a),JM=(e,t,r,a)=>Hr(e,"xAxis",t,a),ZM=(e,t,r,a)=>Hr(e,"yAxis",r,a),e6=pe([VM,ls],(e,t)=>{if(!(e==null||t==null)){var r=e.find(a=>a.stackId===t.stackId&&t.dataKey!=null&&a.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),t6=(e,t)=>{var r=Iu(t);if(!(!e||r==null||t==null)){var{stackId:a}=t;if(a!=null){var i=e[a];if(i){var{stackedData:s}=i;if(s)return s.find(o=>o.key===r)}}}},n6=pe([FM,ls],t6),r6=pe([Yt,Vd,XM,QM,JM,ZM,e6,et,ml,sb,n6,ls,WM],(e,t,r,a,i,s,o,l,d,h,u,f,m)=>{var{chartData:p,dataStartIndex:x,dataEndIndex:v}=d;if(!(f==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||a==null||i==null||s==null||h==null)){var{data:g}=f,b;if(g!=null&&g.length>0?b=g:b=p==null?void 0:p.slice(x,v+1),b!=null)return IM({layout:l,barSettings:f,pos:o,parentViewBox:t,bandSize:h,xAxis:r,yAxis:a,xAxisTicks:i,yAxisTicks:s,stackedData:u,displayedData:b,offset:e,cells:m,dataStartIndex:x})}}),ob=e=>{var{chartData:t}=e,r=Nt(),a=fn();return c.useEffect(()=>a?()=>{}:(r(ap(t)),()=>{r(ap(void 0))}),[t,r,a]),null},Wp={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},lb=Nn({name:"brush",initialState:Wp,reducers:{setBrushSettings(e,t){return t.payload==null?Wp:t.payload}}}),{setBrushSettings:OL}=lb.actions,a6=lb.reducer;function i6(e,t,r){return(t=s6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s6(e){var t=o6(e,"string");return typeof t=="symbol"?t:t+""}function o6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class kf{static create(t){return new kf(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(a)switch(a){case"start":return this.scale(t);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(t)+s}default:return this.scale(t)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var r=this.range(),a=r[0],i=r[r.length-1];return a<=i?t>=a&&t<=i:t>=i&&t<=a}}i6(kf,"EPS",1e-4);function l6(e){return(e%180+180)%180}var c6=function(t){var{width:r,height:a}=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=l6(i),o=s*Math.PI/180,l=Math.atan(a/r),d=o>l&&o<Math.PI-l?a/Math.sin(o):r/Math.cos(o);return Math.abs(d)},d6={dots:[],areas:[],lines:[]},cb=Nn({name:"referenceElements",initialState:d6,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=wr(e).dots.findIndex(a=>a===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=wr(e).areas.findIndex(a=>a===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=wr(e).lines.findIndex(a=>a===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:_L,removeDot:DL,addArea:ML,removeArea:$L,addLine:LL,removeLine:RL}=cb.actions,u6=cb.reducer,f6=c.createContext(void 0),h6=e=>{var{children:t}=e,[r]=c.useState("".concat(Oi("recharts"),"-clip")),a=wf();if(a==null)return null;var{x:i,y:s,width:o,height:l}=a;return c.createElement(f6.Provider,{value:r},c.createElement("defs",null,c.createElement("clipPath",{id:r},c.createElement("rect",{x:i,y:s,height:l,width:o}))),t)};function Ja(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var a in t)if({}.hasOwnProperty.call(t,a)&&!{}.hasOwnProperty.call(e,a))return!1;return!0}function db(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],a=0;a<e.length;a+=t)r.push(e[a]);return r}function m6(e,t,r){var a={width:e.width+t.width,height:e.height+t.height};return c6(a,r)}function p6(e,t,r){var a=r==="width",{x:i,y:s,width:o,height:l}=e;return t===1?{start:a?i:s,end:a?i+o:s+l}:{start:a?i+o:s+l,end:a?i:s}}function Io(e,t,r,a,i){if(e*t<e*a||e*t>e*i)return!1;var s=r();return e*(t-e*s/2-a)>=0&&e*(t+e*s/2-i)<=0}function g6(e,t){return db(e,t+1)}function y6(e,t,r,a,i){for(var s=(a||[]).slice(),{start:o,end:l}=t,d=0,h=1,u=o,f=function(){var x=a==null?void 0:a[d];if(x===void 0)return{v:db(a,h)};var v=d,g,b=()=>(g===void 0&&(g=r(x,v)),g),y=x.coordinate,N=d===0||Io(e,y,b,u,l);N||(d=0,u=o,h+=1),N&&(u=y+e*(b()/2+i),d+=h)},m;h<=s.length;)if(m=f(),m)return m.v;return[]}function Bp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function cn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bp(Object(r),!0).forEach(function(a){v6(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function v6(e,t,r){return(t=x6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x6(e){var t=b6(e,"string");return typeof t=="symbol"?t:t+""}function b6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function j6(e,t,r,a,i){for(var s=(a||[]).slice(),o=s.length,{start:l}=t,{end:d}=t,h=function(m){var p=s[m],x,v=()=>(x===void 0&&(x=r(p,m)),x);if(m===o-1){var g=e*(p.coordinate+e*v()/2-d);s[m]=p=cn(cn({},p),{},{tickCoord:g>0?p.coordinate-g*e:p.coordinate})}else s[m]=p=cn(cn({},p),{},{tickCoord:p.coordinate});if(p.tickCoord!=null){var b=Io(e,p.tickCoord,v,l,d);b&&(d=p.tickCoord-e*(v()/2+i),s[m]=cn(cn({},p),{},{isShow:!0}))}},u=o-1;u>=0;u--)h(u);return s}function w6(e,t,r,a,i,s){var o=(a||[]).slice(),l=o.length,{start:d,end:h}=t;if(s){var u=a[l-1],f=r(u,l-1),m=e*(u.coordinate+e*f/2-h);if(o[l-1]=u=cn(cn({},u),{},{tickCoord:m>0?u.coordinate-m*e:u.coordinate}),u.tickCoord!=null){var p=Io(e,u.tickCoord,()=>f,d,h);p&&(h=u.tickCoord-e*(f/2+i),o[l-1]=cn(cn({},u),{},{isShow:!0}))}}for(var x=s?l-1:l,v=function(y){var N=o[y],A,E=()=>(A===void 0&&(A=r(N,y)),A);if(y===0){var w=e*(N.coordinate-e*E()/2-d);o[y]=N=cn(cn({},N),{},{tickCoord:w<0?N.coordinate-w*e:N.coordinate})}else o[y]=N=cn(cn({},N),{},{tickCoord:N.coordinate});if(N.tickCoord!=null){var P=Io(e,N.tickCoord,E,d,h);P&&(d=N.tickCoord+e*(E()/2+i),o[y]=cn(cn({},N),{},{isShow:!0}))}},g=0;g<x;g++)v(g);return o}function Af(e,t,r){var{tick:a,ticks:i,viewBox:s,minTickGap:o,orientation:l,interval:d,tickFormatter:h,unit:u,angle:f}=e;if(!i||!i.length||!a)return[];if(Me(d)||Qr.isSsr){var m;return(m=g6(i,Me(d)?d:0))!==null&&m!==void 0?m:[]}var p=[],x=l==="top"||l==="bottom"?"width":"height",v=u&&x==="width"?Ii(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=(N,A)=>{var E=typeof h=="function"?h(N.value,A):N.value;return x==="width"?m6(Ii(E,{fontSize:t,letterSpacing:r}),v,f):Ii(E,{fontSize:t,letterSpacing:r})[x]},b=i.length>=2?Zt(i[1].coordinate-i[0].coordinate):1,y=p6(s,b,x);return d==="equidistantPreserveStart"?y6(b,y,g,i,o):(d==="preserveStart"||d==="preserveStartEnd"?p=w6(b,y,g,i,o,d==="preserveStartEnd"):p=j6(b,y,g,i,o),p.filter(N=>N.isShow))}var S6=e=>{var{ticks:t,label:r,labelGapWithTick:a=5,tickSize:i=0,tickMargin:s=0}=e,o=0;if(t){Array.from(t).forEach(u=>{if(u){var f=u.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=r?r.getBoundingClientRect().width:0,d=i+s,h=o+d+l+(r?a:0);return Math.round(h)}return 0},N6=["axisLine","width","height","className","hide","ticks","axisType"],k6=["viewBox"],A6=["viewBox"];function pd(e,t){if(e==null)return{};var r,a,i=C6(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function C6(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function ka(){return ka=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ka.apply(null,arguments)}function Fp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function zt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fp(Object(r),!0).forEach(function(a){E6(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function E6(e,t,r){return(t=P6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P6(e){var t=I6(e,"string");return typeof t=="symbol"?t:t+""}function I6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Cf={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Bt.axis};function T6(e){var{x:t,y:r,width:a,height:i,orientation:s,mirror:o,axisLine:l,otherSvgProps:d}=e;if(!l)return null;var h=zt(zt(zt({},d),_n(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var u=+(s==="top"&&!o||s==="bottom"&&o);h=zt(zt({},h),{},{x1:t,y1:r+u*i,x2:t+a,y2:r+u*i})}else{var f=+(s==="left"&&!o||s==="right"&&o);h=zt(zt({},h),{},{x1:t+f*a,y1:r,x2:t+f*a,y2:r+i})}return c.createElement("line",ka({},h,{className:nt("recharts-cartesian-axis-line",ba(l,"className"))}))}function O6(e,t,r,a,i,s,o,l,d){var h,u,f,m,p,x,v=l?-1:1,g=e.tickSize||o,b=Me(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":h=u=e.coordinate,m=r+ +!l*i,f=m-v*g,x=f-v*d,p=b;break;case"left":f=m=e.coordinate,u=t+ +!l*a,h=u-v*g,p=h-v*d,x=b;break;case"right":f=m=e.coordinate,u=t+ +l*a,h=u+v*g,p=h+v*d,x=b;break;default:h=u=e.coordinate,m=r+ +l*i,f=m+v*g,x=f+v*d,p=b;break}return{line:{x1:h,y1:f,x2:u,y2:m},tick:{x:p,y:x}}}function _6(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function D6(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function M6(e){var{option:t,tickProps:r,value:a}=e,i,s=nt(r.className,"recharts-cartesian-axis-tick-value");if(c.isValidElement(t))i=c.cloneElement(t,zt(zt({},r),{},{className:s}));else if(typeof t=="function")i=t(zt(zt({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=nt(o,t==null?void 0:t.className)),i=c.createElement(Cl,ka({},r,{className:o}),a)}return i}var $6=c.forwardRef((e,t)=>{var{ticks:r=[],tick:a,tickLine:i,stroke:s,tickFormatter:o,unit:l,padding:d,tickTextProps:h,orientation:u,mirror:f,x:m,y:p,width:x,height:v,tickSize:g,tickMargin:b,fontSize:y,letterSpacing:N,getTicksConfig:A,events:E,axisType:w}=e,P=Af(zt(zt({},A),{},{ticks:r}),y,N),_=_6(u,f),$=D6(u,f),L=_n(A),j=xa(a),S={};typeof i=="object"&&(S=i);var R=zt(zt({},L),{},{fill:"none"},S),O=P.map(ae=>zt({entry:ae},O6(ae,m,p,x,v,u,g,f,b))),z=O.map(ae=>{var{entry:se,line:H}=ae;return c.createElement(en,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(se.value,"-").concat(se.coordinate,"-").concat(se.tickCoord)},i&&c.createElement("line",ka({},R,H,{className:nt("recharts-cartesian-axis-tick-line",ba(i,"className"))})))}),Z=O.map((ae,se)=>{var{entry:H,tick:q}=ae,C=zt(zt(zt(zt({textAnchor:_,verticalAnchor:$},L),{},{stroke:"none",fill:s},j),q),{},{index:se,payload:H,visibleTicksCount:P.length,tickFormatter:o,padding:d},h);return c.createElement(en,ka({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(H.value,"-").concat(H.coordinate,"-").concat(H.tickCoord)},Ko(E,H,se)),a&&c.createElement(M6,{option:a,tickProps:C,value:"".concat(typeof o=="function"?o(H.value,se):H.value).concat(l||"")}))});return c.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(w,"-ticks")},Z.length>0&&c.createElement(kn,{zIndex:Bt.label},c.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(w,"-tick-labels"),ref:t},Z)),z.length>0&&c.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(w,"-tick-lines")},z))}),L6=c.forwardRef((e,t)=>{var{axisLine:r,width:a,height:i,className:s,hide:o,ticks:l,axisType:d}=e,h=pd(e,N6),[u,f]=c.useState(""),[m,p]=c.useState(""),x=c.useRef(null);c.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var g;return S6({ticks:x.current,label:(g=e.labelRef)===null||g===void 0?void 0:g.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var v=c.useCallback(g=>{if(g){var b=g.getElementsByClassName("recharts-cartesian-axis-tick-value");x.current=b;var y=b[0];if(y){var N=window.getComputedStyle(y),A=N.fontSize,E=N.letterSpacing;(A!==u||E!==m)&&(f(A),p(E))}}},[u,m]);return o||a!=null&&a<=0||i!=null&&i<=0?null:c.createElement(kn,{zIndex:e.zIndex},c.createElement(en,{className:nt("recharts-cartesian-axis",s)},c.createElement(T6,{x:e.x,y:e.y,width:a,height:i,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:_n(e)}),c.createElement($6,{ref:v,axisType:d,events:h,fontSize:u,getTicksConfig:e,height:e.height,letterSpacing:m,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:l,unit:e.unit,width:e.width,x:e.x,y:e.y}),c.createElement($O,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},c.createElement(YO,{label:e.label,labelRef:e.labelRef}),e.children)))}),R6=c.memo(L6,(e,t)=>{var{viewBox:r}=e,a=pd(e,k6),{viewBox:i}=t,s=pd(t,A6);return Ja(r,i)&&Ja(a,s)}),Ef=c.forwardRef((e,t)=>{var r=tn(e,Cf);return c.createElement(R6,ka({},r,{ref:t}))});Ef.displayName="CartesianAxis";var z6=["x1","y1","x2","y2","key"],W6=["offset"],B6=["xAxisId","yAxisId"],F6=["xAxisId","yAxisId"];function qp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function dn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qp(Object(r),!0).forEach(function(a){q6(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function q6(e,t,r){return(t=U6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U6(e){var t=H6(e,"string");return typeof t=="symbol"?t:t+""}function H6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fa(){return fa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},fa.apply(null,arguments)}function To(e,t){if(e==null)return{};var r,a,i=Y6(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Y6(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var K6=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:a,y:i,width:s,height:o,ry:l}=e;return c.createElement("rect",{x:a,y:i,ry:l,width:s,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function ub(e){var{option:t,lineItemProps:r}=e,a;if(c.isValidElement(t))a=c.cloneElement(t,r);else if(typeof t=="function")a=t(r);else{var i,{x1:s,y1:o,x2:l,y2:d,key:h}=r,u=To(r,z6),f=(i=_n(u))!==null&&i!==void 0?i:{},{offset:m}=f,p=To(f,W6);a=c.createElement("line",fa({},p,{x1:s,y1:o,x2:l,y2:d,fill:"none",key:h}))}return a}function G6(e){var{x:t,width:r,horizontal:a=!0,horizontalPoints:i}=e;if(!a||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,l=To(e,B6),d=i.map((h,u)=>{var f=dn(dn({},l),{},{x1:t,y1:h,x2:t+r,y2:h,key:"line-".concat(u),index:u});return c.createElement(ub,{key:"line-".concat(u),option:a,lineItemProps:f})});return c.createElement("g",{className:"recharts-cartesian-grid-horizontal"},d)}function V6(e){var{y:t,height:r,vertical:a=!0,verticalPoints:i}=e;if(!a||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,l=To(e,F6),d=i.map((h,u)=>{var f=dn(dn({},l),{},{x1:h,y1:t,x2:h,y2:t+r,key:"line-".concat(u),index:u});return c.createElement(ub,{option:a,lineItemProps:f,key:"line-".concat(u)})});return c.createElement("g",{className:"recharts-cartesian-grid-vertical"},d)}function X6(e){var{horizontalFill:t,fillOpacity:r,x:a,y:i,width:s,height:o,horizontalPoints:l,horizontal:d=!0}=e;if(!d||!t||!t.length||l==null)return null;var h=l.map(f=>Math.round(f+i-i)).sort((f,m)=>f-m);i!==h[0]&&h.unshift(0);var u=h.map((f,m)=>{var p=!h[m+1],x=p?i+o-f:h[m+1]-f;if(x<=0)return null;var v=m%t.length;return c.createElement("rect",{key:"react-".concat(m),y:f,x:a,height:x,width:s,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return c.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function Q6(e){var{vertical:t=!0,verticalFill:r,fillOpacity:a,x:i,y:s,width:o,height:l,verticalPoints:d}=e;if(!t||!r||!r.length)return null;var h=d.map(f=>Math.round(f+i-i)).sort((f,m)=>f-m);i!==h[0]&&h.unshift(0);var u=h.map((f,m)=>{var p=!h[m+1],x=p?i+o-f:h[m+1]-f;if(x<=0)return null;var v=m%r.length;return c.createElement("rect",{key:"react-".concat(m),x:f,y:s,width:x,height:l,stroke:"none",fill:r[v],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return c.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var J6=(e,t)=>{var{xAxis:r,width:a,height:i,offset:s}=e;return Wy(Af(dn(dn(dn({},Cf),r),{},{ticks:By(r),viewBox:{x:0,y:0,width:a,height:i}})),s.left,s.left+s.width,t)},Z6=(e,t)=>{var{yAxis:r,width:a,height:i,offset:s}=e;return Wy(Af(dn(dn(dn({},Cf),r),{},{ticks:By(r),viewBox:{x:0,y:0,width:a,height:i}})),s.top,s.top+s.height,t)},e8={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:Bt.grid};function Oo(e){var t=Zy(),r=ev(),a=Jy(),i=dn(dn({},tn(e,e8)),{},{x:Me(e.x)?e.x:a.left,y:Me(e.y)?e.y:a.top,width:Me(e.width)?e.width:a.width,height:Me(e.height)?e.height:a.height}),{xAxisId:s,yAxisId:o,x:l,y:d,width:h,height:u,syncWithTicks:f,horizontalValues:m,verticalValues:p}=i,x=fn(),v=$e($=>Km($,"xAxis",s,x)),g=$e($=>Km($,"yAxis",o,x));if(!dr(h)||!dr(u)||!Me(l)||!Me(d))return null;var b=i.verticalCoordinatesGenerator||J6,y=i.horizontalCoordinatesGenerator||Z6,{horizontalPoints:N,verticalPoints:A}=i;if((!N||!N.length)&&typeof y=="function"){var E=m&&m.length,w=y({yAxis:g?dn(dn({},g),{},{ticks:E?m:g.ticks}):void 0,width:t??h,height:r??u,offset:a},E?!0:f);ro(Array.isArray(w),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof w,"]")),Array.isArray(w)&&(N=w)}if((!A||!A.length)&&typeof b=="function"){var P=p&&p.length,_=b({xAxis:v?dn(dn({},v),{},{ticks:P?p:v.ticks}):void 0,width:t??h,height:r??u,offset:a},P?!0:f);ro(Array.isArray(_),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof _,"]")),Array.isArray(_)&&(A=_)}return c.createElement(kn,{zIndex:i.zIndex},c.createElement("g",{className:"recharts-cartesian-grid"},c.createElement(K6,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),c.createElement(X6,fa({},i,{horizontalPoints:N})),c.createElement(Q6,fa({},i,{verticalPoints:A})),c.createElement(G6,fa({},i,{offset:a,horizontalPoints:N,xAxis:v,yAxis:g})),c.createElement(V6,fa({},i,{offset:a,verticalPoints:A,xAxis:v,yAxis:g}))))}Oo.displayName="CartesianGrid";var fb=(e,t,r,a)=>Yr(e,"xAxis",t,a),hb=(e,t,r,a)=>Hr(e,"xAxis",t,a),mb=(e,t,r,a)=>Yr(e,"yAxis",r,a),pb=(e,t,r,a)=>Hr(e,"yAxis",r,a),t8=pe([et,fb,mb,hb,pb],(e,t,r,a,i)=>Xr(e,"xAxis")?Ga(t,a,!1):Ga(r,i,!1)),n8=(e,t,r,a,i)=>i;function r8(e){return e.type==="line"}var a8=pe([jl,n8],(e,t)=>e.filter(r8).find(r=>r.id===t)),i8=pe([et,fb,mb,hb,pb,a8,t8,ml],(e,t,r,a,i,s,o,l)=>{var{chartData:d,dataStartIndex:h,dataEndIndex:u}=l;if(!(s==null||t==null||r==null||a==null||i==null||a.length===0||i.length===0||o==null)){var{dataKey:f,data:m}=s,p;if(m!=null&&m.length>0?p=m:p=d==null?void 0:d.slice(h,u+1),p!=null)return A8({layout:e,xAxis:t,yAxis:r,xAxisTicks:a,yAxisTicks:i,dataKey:f,bandSize:o,displayedData:p})}});function s8(e){var t=xa(e),r=3,a=2;if(t!=null){var{r:i,strokeWidth:s}=t,o=Number(i),l=Number(s);return(Number.isNaN(o)||o<0)&&(o=r),(Number.isNaN(l)||l<0)&&(l=a),{r:o,strokeWidth:l}}return{r,strokeWidth:a}}var o8=["id"],l8=["type","layout","connectNulls","needClip","shape"],c8=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function qi(){return qi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},qi.apply(null,arguments)}function Up(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function sr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Up(Object(r),!0).forEach(function(a){d8(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Up(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function d8(e,t,r){return(t=u8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u8(e){var t=f8(e,"string");return typeof t=="symbol"?t:t+""}function f8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Pf(e,t){if(e==null)return{};var r,a,i=h8(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function h8(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var m8=e=>{var{dataKey:t,name:r,stroke:a,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:a,value:Za(r,t),payload:e}]};function p8(e){var{dataKey:t,data:r,stroke:a,strokeWidth:i,fill:s,name:o,hide:l,unit:d}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:void 0,name:Za(o,t),hide:l,type:e.tooltipType,color:e.stroke,unit:d}}}var gb=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function g8(e,t){for(var r=e.length%2!==0?[...e,0]:e,a=[],i=0;i<t;++i)a=[...a,...r];return a}var y8=(e,t,r)=>{var a=r.reduce((f,m)=>f+m);if(!a)return gb(t,e);for(var i=Math.floor(e/a),s=e%a,o=t-e,l=[],d=0,h=0;d<r.length;h+=r[d],++d)if(h+r[d]>s){l=[...r.slice(0,d),s-h];break}var u=l.length%2===0?[0,o]:[o];return[...g8(r,i),...l,...u].map(f=>"".concat(f,"px")).join(", ")};function v8(e){var{clipPathId:t,points:r,props:a}=e,{dot:i,dataKey:s,needClip:o}=a,{id:l}=a,d=Pf(a,o8),h=_n(d);return c.createElement(AD,{points:r,dot:i,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:s,baseProps:h,needClip:o,clipPathId:t})}function x8(e){var{showLabels:t,children:r,points:a}=e,i=c.useMemo(()=>a==null?void 0:a.map(s=>{var o,l,d={x:(o=s.x)!==null&&o!==void 0?o:0,y:(l=s.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return sr(sr({},d),{},{value:s.value,payload:s.payload,viewBox:d,parentViewBox:void 0,fill:void 0})}),[a]);return c.createElement(zx,{value:t?i:void 0},r)}function Hp(e){var{clipPathId:t,pathRef:r,points:a,strokeDasharray:i,props:s}=e,{type:o,layout:l,connectNulls:d,needClip:h,shape:u}=s,f=Pf(s,l8),m=sr(sr({},yn(f)),{},{fill:"none",className:"recharts-line-curve",clipPath:h?"url(#clipPath-".concat(t,")"):void 0,points:a,type:o,layout:l,connectNulls:d,strokeDasharray:i??s.strokeDasharray});return c.createElement(c.Fragment,null,(a==null?void 0:a.length)>1&&c.createElement(pf,qi({shapeType:"curve",option:u},m,{pathRef:r})),c.createElement(v8,{points:a,clipPathId:t,props:s}))}function b8(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function j8(e){var{clipPathId:t,props:r,pathRef:a,previousPointsRef:i,longestAnimatedLengthRef:s}=e,{points:o,strokeDasharray:l,isAnimationActive:d,animationBegin:h,animationDuration:u,animationEasing:f,animateNewValues:m,width:p,height:x,onAnimationEnd:v,onAnimationStart:g}=r,b=i.current,y=Xi(r,"recharts-line-"),[N,A]=c.useState(!1),E=!N,w=c.useCallback(()=>{typeof v=="function"&&v(),A(!1)},[v]),P=c.useCallback(()=>{typeof g=="function"&&g(),A(!0)},[g]),_=b8(a.current),$=s.current;return c.createElement(x8,{points:o,showLabels:E},r.children,c.createElement(Vi,{animationId:y,begin:h,duration:u,isActive:d,easing:f,onAnimationEnd:w,onAnimationStart:P,key:y},L=>{var j=bt($,_+$,L),S=Math.min(j,_),R;if(d)if(l){var O="".concat(l).split(/[,\s]+/gim).map(ae=>parseFloat(ae));R=y8(S,_,O)}else R=gb(_,S);else R=l==null?void 0:String(l);if(b){var z=b.length/o.length,Z=L===1?o:o.map((ae,se)=>{var H=Math.floor(se*z);if(b[H]){var q=b[H];return sr(sr({},ae),{},{x:bt(q.x,ae.x,L),y:bt(q.y,ae.y,L)})}return m?sr(sr({},ae),{},{x:bt(p*2,ae.x,L),y:bt(x/2,ae.y,L)}):sr(sr({},ae),{},{x:ae.x,y:ae.y})});return i.current=Z,c.createElement(Hp,{props:r,points:Z,clipPathId:t,pathRef:a,strokeDasharray:R})}return L>0&&_>0&&(i.current=o,s.current=S),c.createElement(Hp,{props:r,points:o,clipPathId:t,pathRef:a,strokeDasharray:R})}),c.createElement(cf,{label:r.label}))}function w8(e){var{clipPathId:t,props:r}=e,a=c.useRef(null),i=c.useRef(0),s=c.useRef(null);return c.createElement(j8,{props:r,clipPathId:t,previousPointsRef:a,longestAnimatedLengthRef:i,pathRef:s})}var S8=(e,t)=>{var r,a;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(a=e.y)!==null&&a!==void 0?a:void 0,value:e.value,errorVal:ht(e.payload,t)}};class N8 extends c.Component{render(){var{hide:t,dot:r,points:a,className:i,xAxisId:s,yAxisId:o,top:l,left:d,width:h,height:u,id:f,needClip:m,zIndex:p}=this.props;if(t)return null;var x=nt("recharts-line",i),v=f,{r:g,strokeWidth:b}=s8(r),y=Gx(r),N=g*2+b;return c.createElement(kn,{zIndex:p},c.createElement(en,{className:x},m&&c.createElement("defs",null,c.createElement(ab,{clipPathId:v,xAxisId:s,yAxisId:o}),!y&&c.createElement("clipPath",{id:"clipPath-dots-".concat(v)},c.createElement("rect",{x:d-N/2,y:l-N/2,width:h+N,height:u+N}))),c.createElement(rb,{xAxisId:s,yAxisId:o,data:a,dataPointFormatter:S8,errorBarOffset:0},c.createElement(w8,{props:this.props,clipPathId:v}))),c.createElement(UD,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var yb={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Qr.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:Bt.line};function k8(e){var t=tn(e,yb),{activeDot:r,animateNewValues:a,animationBegin:i,animationDuration:s,animationEasing:o,connectNulls:l,dot:d,hide:h,isAnimationActive:u,label:f,legendType:m,xAxisId:p,yAxisId:x,id:v}=t,g=Pf(t,c8),{needClip:b}=Sf(p,x),y=wf(),N=Gi(),A=fn(),E=$e(L=>i8(L,p,x,A,v));if(N!=="horizontal"&&N!=="vertical"||E==null||y==null)return null;var{height:w,width:P,x:_,y:$}=y;return c.createElement(N8,qi({},g,{id:v,connectNulls:l,dot:d,activeDot:r,animateNewValues:a,animationBegin:i,animationDuration:s,animationEasing:o,isAnimationActive:u,hide:h,label:f,legendType:m,xAxisId:p,yAxisId:x,points:E,layout:N,height:w,width:P,left:_,top:$,needClip:b}))}function A8(e){var{layout:t,xAxis:r,yAxis:a,xAxisTicks:i,yAxisTicks:s,dataKey:o,bandSize:l,displayedData:d}=e;return d.map((h,u)=>{var f=ht(h,o);if(t==="horizontal"){var m=Eh({axis:r,ticks:i,bandSize:l,entry:h,index:u}),p=St(f)?null:a.scale(f);return{x:m,y:p,value:f,payload:h}}var x=St(f)?null:r.scale(f),v=Eh({axis:a,ticks:s,bandSize:l,entry:h,index:u});return x==null||v==null?null:{x,y:v,value:f,payload:h}}).filter(Boolean)}function C8(e){var t=tn(e,yb),r=fn();return c.createElement(bf,{id:t.id,type:"line"},a=>c.createElement(c.Fragment,null,c.createElement(Xx,{legendPayload:m8(t)}),c.createElement(xf,{fn:p8,args:t}),c.createElement(Zx,{type:"line",id:a,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),c.createElement(k8,qi({},t,{id:a}))))}var vb=c.memo(C8);vb.displayName="Line";var E8=["dangerouslySetInnerHTML","ticks"],P8=["id"],I8=["domain"],T8=["domain"];function gd(){return gd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},gd.apply(null,arguments)}function _o(e,t){if(e==null)return{};var r,a,i=O8(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function O8(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function _8(e){var t=Nt();return c.useLayoutEffect(()=>(t(TD(e)),()=>{t(OD(e))}),[e,t]),null}var D8=e=>{var{xAxisId:t,className:r}=e,a=$e(Vd),i=fn(),s="xAxis",o=$e(g=>si(g,s,t,i)),l=$e(g=>Y0(g,s,t,i)),d=$e(g=>F0(g,t)),h=$e(g=>HP(g,t)),u=$e(g=>w0(g,t));if(d==null||h==null||u==null)return null;var{dangerouslySetInnerHTML:f,ticks:m}=e,p=_o(e,E8),{id:x}=u,v=_o(u,P8);return c.createElement(Ef,gd({},p,v,{scale:o,x:h.x,y:h.y,width:d.width,height:d.height,className:nt("recharts-".concat(s," ").concat(s),r),viewBox:a,ticks:l,axisType:s}))},M8={allowDataOverflow:En.allowDataOverflow,allowDecimals:En.allowDecimals,allowDuplicatedCategory:En.allowDuplicatedCategory,height:En.height,hide:!1,mirror:En.mirror,orientation:En.orientation,padding:En.padding,reversed:En.reversed,scale:En.scale,tickCount:En.tickCount,type:En.type,xAxisId:0},$8=e=>{var t,r,a,i,s,o=tn(e,M8);return c.createElement(c.Fragment,null,c.createElement(_8,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(a=o.angle)!==null&&a!==void 0?a:0,minTickGap:(i=o.minTickGap)!==null&&i!==void 0?i:5,tick:(s=o.tick)!==null&&s!==void 0?s:!0,tickFormatter:o.tickFormatter}),c.createElement(D8,o))},L8=(e,t)=>{var{domain:r}=e,a=_o(e,I8),{domain:i}=t,s=_o(t,T8);return Ja(a,s)?Array.isArray(r)&&r.length===2&&Array.isArray(i)&&i.length===2?r[0]===i[0]&&r[1]===i[1]:Ja({domain:r},{domain:i}):!1},Do=c.memo($8,L8);Do.displayName="XAxis";var R8=["dangerouslySetInnerHTML","ticks"],z8=["id"],W8=["domain"],B8=["domain"];function yd(){return yd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},yd.apply(null,arguments)}function Mo(e,t){if(e==null)return{};var r,a,i=F8(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function F8(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function q8(e){var t=Nt();return c.useLayoutEffect(()=>(t(_D(e)),()=>{t(DD(e))}),[e,t]),null}var U8=e=>{var{yAxisId:t,className:r,width:a,label:i}=e,s=c.useRef(null),o=c.useRef(null),l=$e(Vd),d=fn(),h=Nt(),u="yAxis",f=$e(E=>si(E,u,t,d)),m=$e(E=>q0(E,t)),p=$e(E=>KP(E,t)),x=$e(E=>Y0(E,u,t,d)),v=$e(E=>S0(E,t));if(c.useLayoutEffect(()=>{if(!(a!=="auto"||!m||lf(i)||c.isValidElement(i)||v==null)){var E=s.current;if(E){var w=E.getCalculatedWidth();Math.round(m.width)!==Math.round(w)&&h(MD({id:t,width:w}))}}},[x,m,h,i,t,a,v]),m==null||p==null||v==null)return null;var{dangerouslySetInnerHTML:g,ticks:b}=e,y=Mo(e,R8),{id:N}=v,A=Mo(v,z8);return c.createElement(Ef,yd({},y,A,{ref:s,labelRef:o,scale:f,x:p.x,y:p.y,tickTextProps:a==="auto"?{width:void 0}:{width:a},width:m.width,height:m.height,className:nt("recharts-".concat(u," ").concat(u),r),viewBox:l,ticks:x,axisType:u}))},H8={allowDataOverflow:Pn.allowDataOverflow,allowDecimals:Pn.allowDecimals,allowDuplicatedCategory:Pn.allowDuplicatedCategory,hide:!1,mirror:Pn.mirror,orientation:Pn.orientation,padding:Pn.padding,reversed:Pn.reversed,scale:Pn.scale,tickCount:Pn.tickCount,type:Pn.type,width:Pn.width,yAxisId:0},Y8=e=>{var t,r,a,i,s,o=tn(e,H8);return c.createElement(c.Fragment,null,c.createElement(q8,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(a=o.angle)!==null&&a!==void 0?a:0,minTickGap:(i=o.minTickGap)!==null&&i!==void 0?i:5,tick:(s=o.tick)!==null&&s!==void 0?s:!0,tickFormatter:o.tickFormatter}),c.createElement(U8,o))},K8=(e,t)=>{var{domain:r}=e,a=Mo(e,W8),{domain:i}=t,s=Mo(t,B8);return Ja(a,s)?Array.isArray(r)&&r.length===2&&Array.isArray(i)&&i.length===2?r[0]===i[0]&&r[1]===i[1]:Ja({domain:r},{domain:i}):!1},$o=c.memo(Y8,K8);$o.displayName="YAxis";var G8={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cs=c;function V8(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var X8=typeof Object.is=="function"?Object.is:V8,Q8=cs.useSyncExternalStore,J8=cs.useRef,Z8=cs.useEffect,e$=cs.useMemo,t$=cs.useDebugValue;G8.useSyncExternalStoreWithSelector=function(e,t,r,a,i){var s=J8(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=e$(function(){function d(p){if(!h){if(h=!0,u=p,p=a(p),i!==void 0&&o.hasValue){var x=o.value;if(i(x,p))return f=x}return f=p}if(x=f,X8(u,p))return x;var v=a(p);return i!==void 0&&i(x,v)?(u=p,x):(u=p,f=v)}var h=!1,u,f,m=r===void 0?null:r;return[function(){return d(t())},m===null?void 0:function(){return d(m())}]},[t,r,a,i]);var l=Q8(e,s[0],s[1]);return Z8(function(){o.hasValue=!0,o.value=l},[l]),t$(l),l};function n$(e){e()}function r$(){let e=null,t=null;return{clear(){e=null,t=null},notify(){n$(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let a=e;for(;a;)r.push(a),a=a.next;return r},subscribe(r){let a=!0;const i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!a||e===null||(a=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var Yp={notify(){},get:()=>[]};function a$(e,t){let r,a=Yp,i=0,s=!1;function o(v){u();const g=a.subscribe(v);let b=!1;return()=>{b||(b=!0,g(),f())}}function l(){a.notify()}function d(){x.onStateChange&&x.onStateChange()}function h(){return s}function u(){i++,r||(r=e.subscribe(d),a=r$())}function f(){i--,r&&i===0&&(r(),r=void 0,a.clear(),a=Yp)}function m(){s||(s=!0,u())}function p(){s&&(s=!1,f())}const x={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:d,isSubscribed:h,trySubscribe:m,tryUnsubscribe:p,getListeners:()=>a};return x}var i$=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",s$=i$(),o$=()=>typeof navigator<"u"&&navigator.product==="ReactNative",l$=o$(),c$=()=>s$||l$?c.useLayoutEffect:c.useEffect,d$=c$(),wc=Symbol.for("react-redux-context"),Sc=typeof globalThis<"u"?globalThis:{};function u$(){if(!c.createContext)return{};const e=Sc[wc]??(Sc[wc]=new Map);let t=e.get(c.createContext);return t||(t=c.createContext(null),e.set(c.createContext,t)),t}var f$=u$();function h$(e){const{children:t,context:r,serverState:a,store:i}=e,s=c.useMemo(()=>{const d=a$(i);return{store:i,subscription:d,getServerState:a?()=>a:void 0}},[i,a]),o=c.useMemo(()=>i.getState(),[i]);d$(()=>{const{subscription:d}=s;return d.onStateChange=d.notifyNestedSubs,d.trySubscribe(),o!==i.getState()&&d.notifyNestedSubs(),()=>{d.tryUnsubscribe(),d.onStateChange=void 0}},[s,o]);const l=r||f$;return c.createElement(l.Provider,{value:s},t)}var m$=h$,p$=(e,t)=>t,If=pe([p$,et,b0,Gt,cx,$r,aT,Yt],uT),Tf=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,a=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/a)}},xb=Fn("mouseClick"),bb=Yi();bb.startListening({actionCreator:xb,effect:(e,t)=>{var r=e.payload,a=If(t.getState(),Tf(r));(a==null?void 0:a.activeIndex)!=null&&t.dispatch(sI({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}});var vd=Fn("mouseMove"),jb=Yi();jb.startListening({actionCreator:vd,effect:(e,t)=>{var r=e.payload,a=t.getState(),i=Qu(a,a.tooltip.settings.shared),s=If(a,Tf(r));i==="axis"&&((s==null?void 0:s.activeIndex)!=null?t.dispatch(ex({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate})):t.dispatch(Z0()))}});var Kp={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0},wb=Nn({name:"rootProps",initialState:Kp,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:Kp.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue}}}),g$=wb.reducer,{updateOptions:y$}=wb.actions,Sb=Nn({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:v$}=Sb.actions,x$=Sb.reducer,Nb=Fn("keyDown"),kb=Fn("focus"),Of=Yi();Of.startListening({actionCreator:Nb,effect:(e,t)=>{var r=t.getState(),a=r.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:i}=r.tooltip,s=e.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=Number(Ju(i,li(r))),l=$r(r);if(s==="Enter"){var d=So(r,"axis","hover",String(i.index));t.dispatch(od({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:d}));return}var h=QP(r),u=h==="left-to-right"?1:-1,f=s==="ArrowRight"?1:-1,m=o+f*u;if(!(l==null||m>=l.length||m<0)){var p=So(r,"axis","hover",String(m));t.dispatch(od({active:!0,activeIndex:m.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});Of.startListening({actionCreator:kb,effect:(e,t)=>{var r=t.getState(),a=r.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var s="0",o=So(r,"axis","hover",String(s));t.dispatch(od({activeDataKey:void 0,active:!0,activeIndex:s,activeCoordinate:o}))}}}});var Wn=Fn("externalEvent"),Ab=Yi();Ab.startListening({actionCreator:Wn,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),a={activeCoordinate:FI(r),activeDataKey:hx(r),activeIndex:Kr(r),activeLabel:fx(r),activeTooltipIndex:Kr(r),isTooltipActive:qI(r)};e.payload.handler(a,e.payload.reactEvent)}}});var b$=pe([oi],e=>e.tooltipItemPayloads),j$=pe([b$,ss,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,a)=>{var i=e.find(l=>l.settings.dataKey===a);if(i!=null){var{positions:s}=i;if(s!=null){var o=t(s,r);return o}}}),Cb=Fn("touchMove"),Eb=Yi();Eb.startListening({actionCreator:Cb,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var a=t.getState(),i=Qu(a,a.tooltip.settings.shared);if(i==="axis"){var s=If(a,Tf({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(s==null?void 0:s.activeIndex)!=null&&t.dispatch(ex({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}else if(i==="item"){var o,l=r.touches[0];if(document.elementFromPoint==null)return;var d=document.elementFromPoint(l.clientX,l.clientY);if(!d||!d.getAttribute)return;var h=d.getAttribute(qy),u=(o=d.getAttribute(Uy))!==null&&o!==void 0?o:void 0,f=j$(t.getState(),h,u);t.dispatch(J0({activeDataKey:u,activeIndex:h,activeCoordinate:f}))}}}});var w$=my({brush:a6,cartesianAxis:$D,chartData:BT,errorBars:nM,graphicalItems:Y_,layout:ZN,legend:U2,options:$T,polarAxis:c_,polarOptions:x$,referenceElements:u6,rootProps:g$,tooltip:oI,zIndex:kT}),S$=function(t){return NN({reducer:w$,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([bb.middleware,jb.middleware,Of.middleware,Ab.middleware,Eb.middleware]),enhancers:r=>{var a=r;return typeof r=="function"&&(a=r()),a.concat(Ay({type:"raf"}))},devTools:Qr.devToolsEnabled})};function Pb(e){var{preloadedState:t,children:r,reduxStoreName:a}=e,i=fn(),s=c.useRef(null);if(i)return r;s.current==null&&(s.current=S$(t));var o=Bd;return c.createElement(m$,{context:o,store:s.current},r)}function Ib(e){var{layout:t,margin:r}=e,a=Nt(),i=fn();return c.useEffect(()=>{i||(a(XN(t)),a(VN(r)))},[a,i,t,r]),null}function Tb(e){var t=Nt();return c.useEffect(()=>{t(y$(e))},[t,e]),null}function Gp(e){var{zIndex:t,isPanorama:r}=e,a=r?"recharts-zindex-panorama-":"recharts-zindex-",i=Qx("".concat(a).concat(t)),s=Nt();return c.useLayoutEffect(()=>(s(ST({zIndex:t,elementId:i,isPanorama:r})),()=>{s(NT({zIndex:t,isPanorama:r}))}),[s,t,i,r]),c.createElement("g",{id:i})}function Vp(e){var{children:t,isPanorama:r}=e,a=$e(hT);if(!a||a.length===0)return t;var i=a.filter(o=>o<0),s=a.filter(o=>o>0);return c.createElement(c.Fragment,null,i.map(o=>c.createElement(Gp,{key:o,zIndex:o,isPanorama:r})),t,s.map(o=>c.createElement(Gp,{key:o,zIndex:o,isPanorama:r})))}var N$=["children"];function k$(e,t){if(e==null)return{};var r,a,i=A$(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function A$(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function Lo(){return Lo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Lo.apply(null,arguments)}var C$={width:"100%",height:"100%",display:"block"},E$=c.forwardRef((e,t)=>{var r=Zy(),a=ev(),i=av();if(!dr(r)||!dr(a))return null;var{children:s,otherAttributes:o,title:l,desc:d}=e,h,u;return o!=null&&(typeof o.tabIndex=="number"?h=o.tabIndex:h=i?0:void 0,typeof o.role=="string"?u=o.role:u=i?"application":void 0),c.createElement(pg,Lo({},o,{title:l,desc:d,role:u,tabIndex:h,width:r,height:a,style:C$,ref:t}),s)}),P$=e=>{var{children:t}=e,r=$e(il);if(!r)return null;var{width:a,height:i,y:s,x:o}=r;return c.createElement(pg,{width:a,height:i,x:o,y:s},t)},Xp=c.forwardRef((e,t)=>{var{children:r}=e,a=k$(e,N$),i=fn();return i?c.createElement(P$,null,c.createElement(Vp,{isPanorama:!0},r)):c.createElement(E$,Lo({ref:t},a),c.createElement(Vp,{isPanorama:!1},r))});function I$(){var e=Nt(),[t,r]=c.useState(null),a=$e(y2);return c.useEffect(()=>{if(t!=null){var i=t.getBoundingClientRect(),s=i.width/t.offsetWidth;Lt(s)&&s!==a&&e(JN(s))}},[t,e,a]),r}function Qp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function T$(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qp(Object(r),!0).forEach(function(a){O$(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function O$(e,t,r){return(t=_$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _$(e){var t=D$(e,"string");return typeof t=="symbol"?t:t+""}function D$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Aa(){return Aa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Aa.apply(null,arguments)}var M$=()=>(XT(),null);function Ro(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var $$=c.forwardRef((e,t)=>{var r,a,i=c.useRef(null),[s,o]=c.useState({containerWidth:Ro((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Ro((a=e.style)===null||a===void 0?void 0:a.height)}),l=c.useCallback((h,u)=>{o(f=>{var m=Math.round(h),p=Math.round(u);return f.containerWidth===m&&f.containerHeight===p?f:{containerWidth:m,containerHeight:p}})},[]),d=c.useCallback(h=>{if(typeof t=="function"&&t(h),h!=null&&typeof ResizeObserver<"u"){var{width:u,height:f}=h.getBoundingClientRect();l(u,f);var m=x=>{var{width:v,height:g}=x[0].contentRect;l(v,g)},p=new ResizeObserver(m);p.observe(h),i.current=p}},[t,l]);return c.useEffect(()=>()=>{var h=i.current;h!=null&&h.disconnect()},[l]),c.createElement(c.Fragment,null,c.createElement(ol,{width:s.containerWidth,height:s.containerHeight}),c.createElement("div",Aa({ref:d},e)))}),L$=c.forwardRef((e,t)=>{var{width:r,height:a}=e,[i,s]=c.useState({containerWidth:Ro(r),containerHeight:Ro(a)}),o=c.useCallback((d,h)=>{s(u=>{var f=Math.round(d),m=Math.round(h);return u.containerWidth===f&&u.containerHeight===m?u:{containerWidth:f,containerHeight:m}})},[]),l=c.useCallback(d=>{if(typeof t=="function"&&t(d),d!=null){var{width:h,height:u}=d.getBoundingClientRect();o(h,u)}},[t,o]);return c.createElement(c.Fragment,null,c.createElement(ol,{width:i.containerWidth,height:i.containerHeight}),c.createElement("div",Aa({ref:l},e)))}),R$=c.forwardRef((e,t)=>{var{width:r,height:a}=e;return c.createElement(c.Fragment,null,c.createElement(ol,{width:r,height:a}),c.createElement("div",Aa({ref:t},e)))}),z$=c.forwardRef((e,t)=>{var{width:r,height:a}=e;return Nr(r)||Nr(a)?c.createElement(L$,Aa({},e,{ref:t})):c.createElement(R$,Aa({},e,{ref:t}))});function W$(e){return e===!0?$$:z$}var B$=c.forwardRef((e,t)=>{var{children:r,className:a,height:i,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:d,onMouseEnter:h,onMouseLeave:u,onMouseMove:f,onMouseUp:m,onTouchEnd:p,onTouchMove:x,onTouchStart:v,style:g,width:b,responsive:y,dispatchTouchEvents:N=!0}=e,A=c.useRef(null),E=Nt(),[w,P]=c.useState(null),[_,$]=c.useState(null),L=I$(),j=Xd(),S=(j==null?void 0:j.width)>0?j.width:b,R=(j==null?void 0:j.height)>0?j.height:i,O=c.useCallback(D=>{L(D),typeof t=="function"&&t(D),P(D),$(D),D!=null&&(A.current=D)},[L,t,P,$]),z=c.useCallback(D=>{E(xb(D)),E(Wn({handler:s,reactEvent:D}))},[E,s]),Z=c.useCallback(D=>{E(vd(D)),E(Wn({handler:h,reactEvent:D}))},[E,h]),ae=c.useCallback(D=>{E(Z0()),E(Wn({handler:u,reactEvent:D}))},[E,u]),se=c.useCallback(D=>{E(vd(D)),E(Wn({handler:f,reactEvent:D}))},[E,f]),H=c.useCallback(()=>{E(kb())},[E]),q=c.useCallback(D=>{E(Nb(D.key))},[E]),C=c.useCallback(D=>{E(Wn({handler:o,reactEvent:D}))},[E,o]),T=c.useCallback(D=>{E(Wn({handler:l,reactEvent:D}))},[E,l]),W=c.useCallback(D=>{E(Wn({handler:d,reactEvent:D}))},[E,d]),I=c.useCallback(D=>{E(Wn({handler:m,reactEvent:D}))},[E,m]),U=c.useCallback(D=>{E(Wn({handler:v,reactEvent:D}))},[E,v]),K=c.useCallback(D=>{N&&E(Cb(D)),E(Wn({handler:x,reactEvent:D}))},[E,N,x]),Y=c.useCallback(D=>{E(Wn({handler:p,reactEvent:D}))},[E,p]),M=W$(y);return c.createElement(jx.Provider,{value:w},c.createElement(ww.Provider,{value:_},c.createElement(M,{width:S??(g==null?void 0:g.width),height:R??(g==null?void 0:g.height),className:nt("recharts-wrapper",a),style:T$({position:"relative",cursor:"default",width:S,height:R},g),onClick:z,onContextMenu:C,onDoubleClick:T,onFocus:H,onKeyDown:q,onMouseDown:W,onMouseEnter:Z,onMouseLeave:ae,onMouseMove:se,onMouseUp:I,onTouchEnd:Y,onTouchMove:K,onTouchStart:U,ref:O},c.createElement(M$,null),r)))}),F$=["width","height","responsive","children","className","style","compact","title","desc"];function q$(e,t){if(e==null)return{};var r,a,i=U$(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function U$(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Ob=c.forwardRef((e,t)=>{var{width:r,height:a,responsive:i,children:s,className:o,style:l,compact:d,title:h,desc:u}=e,f=q$(e,F$),m=_n(f);return d?c.createElement(c.Fragment,null,c.createElement(ol,{width:r,height:a}),c.createElement(Xp,{otherAttributes:m,title:h,desc:u},s)):c.createElement(B$,{className:o,style:l,width:r,height:a,responsive:i??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},c.createElement(Xp,{otherAttributes:m,title:h,desc:u,ref:t},c.createElement(h6,null,s)))});function xd(){return xd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},xd.apply(null,arguments)}var H$={top:5,right:5,bottom:5,left:5},Y$={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:H$,reverseStackOrder:!1,syncMethod:"index",responsive:!1},_b=c.forwardRef(function(t,r){var a,i=tn(t.categoricalChartProps,Y$),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:d,categoricalChartProps:h}=t,u={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:d,eventEmitter:void 0};return c.createElement(Pb,{preloadedState:{options:u},reduxStoreName:(a=h.id)!==null&&a!==void 0?a:s},c.createElement(ob,{chartData:h.data}),c.createElement(Ib,{layout:i.layout,margin:i.margin}),c.createElement(Tb,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),c.createElement(Ob,xd({},i,{ref:r})))}),K$=["axis"],G$=c.forwardRef((e,t)=>c.createElement(_b,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:K$,tooltipPayloadSearcher:of,categoricalChartProps:e,ref:t})),V$=["axis","item"],Db=c.forwardRef((e,t)=>c.createElement(_b,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:V$,tooltipPayloadSearcher:of,categoricalChartProps:e,ref:t}));function X$(e){var t=Nt();return c.useEffect(()=>{t(v$(e))},[t,e]),null}var Q$=["layout"];function bd(){return bd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},bd.apply(null,arguments)}function J$(e,t){if(e==null)return{};var r,a,i=Z$(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Z$(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var eL={top:5,right:5,bottom:5,left:5},tL={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:eL,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},nL=c.forwardRef(function(t,r){var a,i=tn(t.categoricalChartProps,tL),{layout:s}=i,o=J$(i,Q$),{chartName:l,defaultTooltipEventType:d,validateTooltipEventTypes:h,tooltipPayloadSearcher:u}=t,f={chartName:l,defaultTooltipEventType:d,validateTooltipEventTypes:h,tooltipPayloadSearcher:u,eventEmitter:void 0};return c.createElement(Pb,{preloadedState:{options:f},reduxStoreName:(a=i.id)!==null&&a!==void 0?a:l},c.createElement(ob,{chartData:i.data}),c.createElement(Ib,{layout:s,margin:i.margin}),c.createElement(Tb,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),c.createElement(X$,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),c.createElement(Ob,bd({},o,{ref:r})))}),rL=["item"],aL={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},iL=c.forwardRef((e,t)=>{var r=tn(e,aL);return c.createElement(nL,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:rL,tooltipPayloadSearcher:of,categoricalChartProps:r,ref:t})});const Bs={high:"#ef4444",medium:"#f59e0b",low:"#10b981",default:"#e5e7eb"};function sL(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState("all"),[d,h]=c.useState(""),[u,f]=c.useState(""),[m,p]=c.useState(""),[x,v]=c.useState(!1),[g,b]=c.useState(""),[y,N]=c.useState(new Date().toISOString().split("T")[0]),[A,E]=c.useState(""),[w,P]=c.useState(!1),_=async()=>{a(!0),s(null);try{const S=new URLSearchParams;o!=="all"&&S.append("status",o),d&&S.append("fromDate",d),u&&S.append("toDate",u);const R=await fetch(`/api/v1/credit/meetings?${S.toString()}`);if(!R.ok)throw new Error(`API 호출 실패: ${R.status}`);const z=((await R.json()).meetings||[]).map(Z=>{var ae;return{id:Z.id,title:Z.meeting_name,meetingDate:Z.meeting_date,status:((ae=Z.meeting_status)==null?void 0:ae.toLowerCase())==="closed"?"completed":"in_progress",customerCount:Z.customer_count||0,highRiskCount:Z.high_risk_count||0,mediumRiskCount:Z.medium_risk_count||0,lowRiskCount:Z.low_risk_count||0,createdAt:Z.created_at}});t(z)}catch(S){console.error("채권회의 목록 조회 실패:",S),s(S.message||"데이터 조회 중 오류가 발생했습니다.")}finally{a(!1)}};c.useEffect(()=>{_()},[]);const $=S=>{if(!S)return"-";const R=new Date(S);return new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}).format(R)},L=async()=>{if(!g||!y){alert("회의명과 일자를 입력해주세요.");return}P(!0);try{const S=await fetch("/api/v1/credit/meetings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({meetingCode:`MTG-${y.replace(/-/g,"")}`,meetingName:g,meetingDate:y,remark:A})});if(!S.ok)throw new Error("회의 생성 실패");const R=await S.json();if(R.success)v(!1),b(""),E(""),_();else throw new Error(R.error||"회의 생성 실패")}catch(S){alert(S.message)}finally{P(!1)}},j=S=>{const R=`credit:meeting:${S}`;window.location.hash=R,window.dispatchEvent(new CustomEvent("tnt.sales.navigate",{detail:{key:R}}))};return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[n.jsxs("div",{style:{marginBottom:24,display:"flex",alignItems:"baseline",gap:12,justifyContent:"space-between"},children:[n.jsxs("div",{children:[n.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"채권회의"}),n.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"월별 채권 심사 및 리스크 관리 현황"})]}),n.jsxs("button",{className:"btn",onClick:()=>v(!0),style:{height:36,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",display:"flex",alignItems:"center",gap:6},children:[n.jsx(nj,{size:16}),"새 회의 생성"]})]}),n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",marginBottom:0},children:[n.jsxs("select",{className:"search-input",value:o,onChange:S=>l(S.target.value),style:{width:120},children:[n.jsx("option",{value:"all",children:"전체 상태"}),n.jsx("option",{value:"in_progress",children:"진행중"}),n.jsx("option",{value:"completed",children:"완료"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"date",className:"search-input",value:d,onChange:S=>h(S.target.value),style:{width:130}}),n.jsx("span",{style:{color:"#9ca3af"},children:"~"}),n.jsx("input",{type:"date",className:"search-input",value:u,onChange:S=>f(S.target.value),style:{width:130}})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("input",{type:"text",className:"search-input",value:m,onChange:S=>p(S.target.value),placeholder:"회의명 검색",style:{width:200,paddingLeft:30}}),n.jsx(va,{size:14,style:{position:"absolute",left:10,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}})]}),n.jsx("div",{style:{display:"flex",gap:8,marginLeft:"auto"},children:n.jsx("button",{className:"btn",onClick:_,disabled:r,style:{height:30,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",whiteSpace:"nowrap"},children:r?"조회 중...":"조회"})})]})]}),n.jsx("div",{style:{flex:1,overflow:"auto",padding:24},children:i?n.jsx("div",{style:{padding:16,color:"#ef4444",background:"#fef2f2",border:"1px solid #fee2e2",borderRadius:8},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx(zj,{size:16}),i]})}):e.length===0?n.jsxs("div",{className:"empty-state",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:300,gap:16},children:[n.jsx(Nc,{size:48,style:{opacity:.2}}),n.jsxs("div",{style:{textAlign:"center"},children:[n.jsx("p",{style:{fontSize:18,fontWeight:500,color:"#6b7280",margin:0},children:"등록된 채권회의가 없습니다."}),n.jsx("p",{style:{fontSize:14,color:"#9ca3af",marginTop:4},children:"새로운 회의를 생성하여 관리를 시작해보세요."})]})]}):n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:24},children:e.map(S=>{const R=[{name:"High",value:S.highRiskCount,color:Bs.high},{name:"Medium",value:S.mediumRiskCount,color:Bs.medium},{name:"Low",value:S.lowRiskCount,color:Bs.low}].filter(O=>O.value>0);return R.length===0&&R.push({name:"None",value:1,color:Bs.default}),n.jsxs("div",{onClick:()=>j(S.id),className:"card",style:{background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden",cursor:"pointer",transition:"all 0.2s",display:"flex",flexDirection:"column"},onMouseEnter:O=>{O.currentTarget.style.transform="translateY(-2px)",O.currentTarget.style.boxShadow="0 10px 15px -3px rgba(0, 0, 0, 0.1)",O.currentTarget.style.borderColor="#93c5fd"},onMouseLeave:O=>{O.currentTarget.style.transform="none",O.currentTarget.style.boxShadow="none",O.currentTarget.style.borderColor="#e5e7eb"},children:[n.jsxs("div",{style:{padding:20,borderBottom:"1px solid #f3f4f6",background:"linear-gradient(to right, #fff, #f9fafb)"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[S.status==="completed"?n.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,padding:"2px 8px",borderRadius:999,fontSize:11,fontWeight:600,background:"#dcfce7",color:"#15803d"},children:[n.jsx(Wo,{size:12})," 완료됨"]}):n.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,padding:"2px 8px",borderRadius:999,fontSize:11,fontWeight:600,background:"#dbeafe",color:"#1d4ed8"},children:[n.jsx(pj,{size:12})," 진행중"]}),n.jsxs("span",{style:{fontSize:11,color:"#9ca3af"},children:[S.createdAt.substring(0,10)," 생성"]})]}),n.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx(Ti,{size:16,color:"#9ca3af"})})]}),n.jsx("h3",{style:{fontSize:18,fontWeight:700,color:"#111827",margin:"0 0 8px 0",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:S.title}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:13,color:"#6b7280"},children:[n.jsx(Nc,{size:14}),$(S.meetingDate)]})]}),n.jsxs("div",{style:{padding:20,display:"flex",alignItems:"center",gap:24,flex:1},children:[n.jsxs("div",{style:{position:"relative",width:80,height:80,flexShrink:0},children:[n.jsx(ao,{width:"100%",height:"100%",children:n.jsx(iL,{children:n.jsx(eb,{data:R,innerRadius:25,outerRadius:40,paddingAngle:2,dataKey:"value",stroke:"none",children:R.map((O,z)=>n.jsx(Ia,{fill:O.color},`cell-${z}`))})})}),n.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:[n.jsx("span",{style:{fontSize:10,fontWeight:600,color:"#9ca3af"},children:"Total"}),n.jsx("span",{style:{fontSize:16,fontWeight:700,color:"#111827",lineHeight:1},children:S.customerCount})]})]}),n.jsxs("div",{style:{flex:1,display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 8px"},children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[n.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"고위험"}),n.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#ef4444"},children:S.highRiskCount})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[n.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"중위험"}),n.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#f59e0b"},children:S.mediumRiskCount})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[n.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"저위험"}),n.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#10b981"},children:S.lowRiskCount})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[n.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"심사대상"}),n.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#374151"},children:S.customerCount})]})]})]}),n.jsxs("div",{style:{padding:"12px 20px",background:"#f9fafb",borderTop:"1px solid #f3f4f6",fontSize:12,color:"#6b7280",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("span",{children:"관리자: 홍길동"}),n.jsxs("span",{style:{color:"#3b82f6",fontWeight:600,display:"flex",alignItems:"center",gap:4},children:["상세보기 ",n.jsx(Ti,{size:12})]})]})]},S.id)})})}),x&&n.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",backdropFilter:"blur(4px)",zIndex:50,display:"flex",alignItems:"center",justifyContent:"center",padding:16},children:n.jsxs("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",width:"100%",maxWidth:480,overflow:"hidden"},onClick:S=>S.stopPropagation(),children:[n.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #f3f4f6",display:"flex",justifyContent:"space-between",alignItems:"center",background:"#f9fafb"},children:[n.jsx("h3",{style:{fontSize:18,fontWeight:700,color:"#111827",margin:0},children:"새 채권회의 생성"}),n.jsx("button",{onClick:()=>v(!1),style:{background:"none",border:"none",color:"#9ca3af",cursor:"pointer",padding:4},children:n.jsx("span",{style:{fontSize:24,lineHeight:1},children:"×"})})]}),n.jsxs("div",{style:{padding:24,display:"flex",flexDirection:"column",gap:20},children:[n.jsxs("div",{children:[n.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:6},children:["회의명 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"text",value:g,onChange:S=>b(S.target.value),placeholder:"예: 2025년 1월 정기 채권회의",className:"search-input",style:{width:"100%",height:42},autoFocus:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:6},children:["회의 일자 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"date",value:y,onChange:S=>N(S.target.value),className:"search-input",style:{width:"100%",height:42}})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:6},children:"비고"}),n.jsx("textarea",{value:A,onChange:S=>E(S.target.value),rows:3,placeholder:"회의 관련 메모를 입력하세요",className:"search-input",style:{width:"100%",height:"auto",padding:"12px",resize:"none"}})]})]}),n.jsxs("div",{style:{padding:"16px 24px",background:"#f9fafb",borderTop:"1px solid #f3f4f6",display:"flex",justifyContent:"flex-end",gap:12},children:[n.jsx("button",{onClick:()=>v(!1),className:"btn",style:{background:"#f3f4f6",borderColor:"#e5e7eb",color:"#4b5563"},children:"취소"}),n.jsx("button",{onClick:L,disabled:w,className:"btn",style:{background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:w?.7:1},children:w?"생성 중...":"회의 생성"})]})]})})]})}function oL(){const t=(window.location.hash.replace("#","")||"credit:meeting:1").split(":")[2]||"1",[r,a]=c.useState(null),[i,s]=c.useState([]),[o,l]=c.useState(!1),[d,h]=c.useState("kanban"),[u,f]=c.useState(null),[m,p]=c.useState(!1),[x,v]=c.useState(""),[g,b]=c.useState("WATCH"),y=async()=>{l(!0);try{const $=await(await fetch(`/api/v1/credit/meetings/${t}`)).json();$.meeting&&a({id:$.meeting.id,meetingCode:$.meeting.meeting_code,meetingName:$.meeting.meeting_name,meetingDate:$.meeting.meeting_date,status:$.meeting.meeting_status,remark:$.meeting.remark});const L=($.customers||[]).map(j=>({id:j.id,customerSeq:j.customer_seq,customerName:j.customer_name,riskLevel:"medium",totalAr:j.total_ar,overdue:j.overdue||0,decisionCode:j.decision_code,decisionComment:j.decision_comment,reviewFlag:j.review_flag}));s(L)}catch(_){console.error(_)}finally{l(!1)}};c.useEffect(()=>{y()},[t]);const N=_=>{f(_),v(_.decisionComment||""),b(_.decisionCode||"WATCH"),p(!0)},A=async()=>{u&&(alert("의견이 저장되었습니다."),p(!1),y())},E=_=>`₩${_.toLocaleString()}`,w=[{id:"WATCH",title:"관찰 (Watch)",color:"#fef3c7",textColor:"#92400e",borderColor:"#f59e0b"},{id:"REVIEW_UNBLOCK",title:"해제 검토",color:"#dbeafe",textColor:"#1e40af",borderColor:"#3b82f6"},{id:"KEEP_BLOCK",title:"차단 유지",color:"#fee2e2",textColor:"#991b1b",borderColor:"#ef4444"},{id:"APPROVED",title:"승인",color:"#dcfce7",textColor:"#166534",borderColor:"#22c55e"}],P=()=>i.filter(_=>!_.decisionCode);return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa",overflow:"hidden",position:"relative"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb",zIndex:10},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:20},children:[n.jsx("button",{onClick:()=>window.history.back(),style:{padding:8,borderRadius:"50%",border:"none",background:"transparent",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:_=>_.currentTarget.style.background="#f3f4f6",onMouseLeave:_=>_.currentTarget.style.background="transparent",children:n.jsx(aj,{size:20,color:"#4b5563"})}),n.jsxs("div",{children:[n.jsxs("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0,display:"flex",alignItems:"center",gap:12},children:[r==null?void 0:r.meetingName,n.jsx("span",{style:{padding:"2px 10px",borderRadius:999,fontSize:12,fontWeight:600,background:(r==null?void 0:r.status)==="CLOSED"?"#dcfce7":"#dbeafe",color:(r==null?void 0:r.status)==="CLOSED"?"#15803d":"#1d4ed8"},children:r==null?void 0:r.status})]}),n.jsxs("p",{style:{margin:"4px 0 0 0",color:"#6b7280",fontSize:14},children:[r==null?void 0:r.meetingCode," · ",r==null?void 0:r.meetingDate]})]}),n.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:n.jsxs("div",{style:{display:"flex",background:"#f3f4f6",padding:4,borderRadius:8},children:[n.jsx("button",{onClick:()=>h("kanban"),style:{padding:6,borderRadius:6,border:"none",background:d==="kanban"?"#fff":"transparent",boxShadow:d==="kanban"?"0 1px 2px rgba(0,0,0,0.1)":"none",color:d==="kanban"?"#2563eb":"#6b7280",cursor:"pointer",display:"flex",alignItems:"center"},children:n.jsx(rg,{size:16})}),n.jsx("button",{onClick:()=>h("grid"),style:{padding:6,borderRadius:6,border:"none",background:d==="grid"?"#fff":"transparent",boxShadow:d==="grid"?"0 1px 2px rgba(0,0,0,0.1)":"none",color:d==="grid"?"#2563eb":"#6b7280",cursor:"pointer",display:"flex",alignItems:"center"},children:n.jsx(Pj,{size:16})})]})})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[n.jsxs("div",{style:{background:"linear-gradient(to bottom right, #eff6ff, #fff)",padding:16,borderRadius:12,border:"1px solid #dbeafe"},children:[n.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#2563eb",marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[n.jsx(eg,{size:12})," 총 채권액"]}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:E(i.reduce((_,$)=>_+$.totalAr,0))})]}),n.jsxs("div",{style:{background:"linear-gradient(to bottom right, #fef2f2, #fff)",padding:16,borderRadius:12,border:"1px solid #fee2e2"},children:[n.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#dc2626",marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[n.jsx(zo,{size:12})," 총 연체액"]}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:E(i.reduce((_,$)=>_+$.overdue,0))})]}),n.jsxs("div",{style:{background:"linear-gradient(to bottom right, #fffbeb, #fff)",padding:16,borderRadius:12,border:"1px solid #fef3c7"},children:[n.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#d97706",marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[n.jsx(kc,{size:12})," 심사 대상"]}),n.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:[i.filter(_=>_.reviewFlag).length," ",n.jsx("span",{style:{fontSize:14,fontWeight:400,color:"#6b7280"},children:"업체"})]})]}),n.jsxs("div",{style:{background:"linear-gradient(to bottom right, #ecfdf5, #fff)",padding:16,borderRadius:12,border:"1px solid #d1fae5"},children:[n.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#059669",marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[n.jsx(Wo,{size:12})," 완료율"]}),n.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:[Math.round(i.filter(_=>_.decisionCode).length/(i.length||1)*100),"%"]})]})]})]}),n.jsx("div",{style:{flex:1,overflowX:"auto",padding:24},children:d==="kanban"?n.jsxs("div",{style:{display:"flex",gap:24,height:"100%",minWidth:"max-content"},children:[n.jsxs("div",{style:{width:320,display:"flex",flexDirection:"column"},children:[n.jsxs("div",{style:{marginBottom:12,fontWeight:600,color:"#6b7280",display:"flex",justifyContent:"space-between",alignItems:"center"},children:["미결정 ",n.jsx("span",{style:{background:"#e5e7eb",padding:"2px 8px",borderRadius:999,fontSize:12},children:P().length})]}),n.jsx("div",{style:{flex:1,background:"#f3f4f6",borderRadius:12,padding:12,display:"flex",flexDirection:"column",gap:12,overflowY:"auto"},children:P().map(_=>n.jsxs("div",{onClick:()=>N(_),className:"card",style:{background:"#fff",padding:16,borderRadius:8,border:"1px solid #e5e7eb",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:$=>{$.currentTarget.style.transform="translateY(-2px)",$.currentTarget.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.1)"},onMouseLeave:$=>{$.currentTarget.style.transform="none",$.currentTarget.style.boxShadow="none"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[n.jsx("span",{style:{width:8,height:8,borderRadius:"50%",marginTop:6,background:_.riskLevel==="high"?"#ef4444":_.riskLevel==="medium"?"#f59e0b":"#10b981"}}),n.jsxs("span",{style:{fontSize:12,fontFamily:"monospace",color:"#9ca3af"},children:["#",_.customerSeq]})]}),n.jsx("h4",{style:{fontSize:16,fontWeight:700,color:"#111827",margin:"0 0 4px 0"},children:_.customerName}),n.jsxs("div",{style:{fontSize:14,color:"#6b7280",marginBottom:12},children:["채권: ",E(_.totalAr)]}),_.reviewFlag&&n.jsx("div",{style:{fontSize:12,background:"#f3e8ff",color:"#7e22ce",padding:"2px 8px",borderRadius:4,display:"inline-block"},children:"심사필요"})]},_.id))})]}),w.map(_=>{const $=i.filter(L=>L.decisionCode===_.id);return n.jsxs("div",{style:{width:320,display:"flex",flexDirection:"column"},children:[n.jsxs("div",{style:{marginBottom:12,fontWeight:600,color:"#374151",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[_.title,n.jsx("span",{style:{background:_.color,color:_.textColor,padding:"2px 8px",borderRadius:999,fontSize:12},children:$.length})]}),n.jsx("div",{style:{flex:1,background:"#f3f4f6",borderRadius:12,padding:12,display:"flex",flexDirection:"column",gap:12,overflowY:"auto"},children:$.map(L=>n.jsxs("div",{onClick:()=>N(L),className:"card",style:{background:"#fff",padding:16,borderRadius:8,border:"1px solid #e5e7eb",borderLeft:`4px solid ${_.borderColor}`,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:j=>{j.currentTarget.style.transform="translateY(-2px)",j.currentTarget.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.1)"},onMouseLeave:j=>{j.currentTarget.style.transform="none",j.currentTarget.style.boxShadow="none"},children:[n.jsx("h4",{style:{fontSize:16,fontWeight:700,color:"#111827",margin:"0 0 4px 0"},children:L.customerName}),n.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"0 0 8px 0",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:['"',L.decisionComment,'"']}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:12,color:"#9ca3af"},children:[n.jsx("span",{children:E(L.totalAr)}),n.jsx(bj,{size:16})]})]},L.id))})]},_.id)})]}):n.jsx("div",{style:{background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[n.jsx("thead",{style:{background:"#f9fafb",borderBottom:"1px solid #e5e7eb"},children:n.jsxs("tr",{children:[n.jsx("th",{style:{padding:"12px 24px",textAlign:"left",fontWeight:600,color:"#6b7280"},children:"거래처"}),n.jsx("th",{style:{padding:"12px 24px",textAlign:"right",fontWeight:600,color:"#6b7280"},children:"총 채권"}),n.jsx("th",{style:{padding:"12px 24px",textAlign:"right",fontWeight:600,color:"#6b7280"},children:"연체액"}),n.jsx("th",{style:{padding:"12px 24px",textAlign:"center",fontWeight:600,color:"#6b7280"},children:"위험도"}),n.jsx("th",{style:{padding:"12px 24px",textAlign:"left",fontWeight:600,color:"#6b7280"},children:"결정"}),n.jsx("th",{style:{padding:"12px 24px",textAlign:"left",fontWeight:600,color:"#6b7280"},children:"의견"})]})}),n.jsx("tbody",{children:i.map((_,$)=>{var L;return n.jsxs("tr",{onClick:()=>N(_),style:{borderBottom:$===i.length-1?"none":"1px solid #f3f4f6",cursor:"pointer",transition:"background 0.1s"},onMouseEnter:j=>j.currentTarget.style.background="#f9fafb",onMouseLeave:j=>j.currentTarget.style.background="#fff",children:[n.jsxs("td",{style:{padding:"16px 24px"},children:[n.jsx("div",{style:{fontWeight:600,color:"#111827"},children:_.customerName}),n.jsx("div",{style:{fontSize:12,color:"#9ca3af"},children:_.customerSeq})]}),n.jsx("td",{style:{padding:"16px 24px",textAlign:"right",fontFamily:"monospace"},children:E(_.totalAr)}),n.jsx("td",{style:{padding:"16px 24px",textAlign:"right",fontFamily:"monospace",color:"#dc2626"},children:E(_.overdue)}),n.jsx("td",{style:{padding:"16px 24px",textAlign:"center"},children:n.jsx("span",{style:{display:"inline-block",width:10,height:10,borderRadius:"50%",background:_.riskLevel==="high"?"#ef4444":_.riskLevel==="medium"?"#f59e0b":"#10b981"}})}),n.jsx("td",{style:{padding:"16px 24px"},children:_.decisionCode?n.jsx("span",{style:{padding:"2px 8px",borderRadius:4,fontSize:12,fontWeight:500,background:"#f3f4f6",color:"#374151"},children:((L=w.find(j=>j.id===_.decisionCode))==null?void 0:L.title)||_.decisionCode}):n.jsx("span",{style:{color:"#d1d5db"},children:"-"})}),n.jsx("td",{style:{padding:"16px 24px",color:"#6b7280",maxWidth:300,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:_.decisionComment||"-"})]},_.id)})})]})})}),m&&u&&n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.2)",backdropFilter:"blur(2px)",zIndex:40},onClick:()=>p(!1)}),n.jsxs("div",{style:{position:"fixed",top:0,right:0,bottom:0,width:500,background:"#fff",boxShadow:"-4px 0 24px rgba(0,0,0,0.15)",zIndex:50,display:"flex",flexDirection:"column",animation:"slideIn 0.3s ease-out"},children:[n.jsxs("div",{style:{padding:24,borderBottom:"1px solid #f3f4f6",display:"flex",justifyContent:"space-between",alignItems:"flex-start",background:"#f9fafb"},children:[n.jsxs("div",{children:[n.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#111827",margin:0},children:u.customerName}),n.jsxs("p",{style:{margin:"4px 0 0 0",fontSize:14,color:"#6b7280"},children:["#",u.customerSeq," · ",u.riskLevel.toUpperCase()," Risk"]})]}),n.jsx("button",{onClick:()=>p(!1),style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af",padding:4},children:n.jsx(Sd,{size:24})})]}),n.jsxs("div",{style:{flex:1,overflowY:"auto",padding:24,display:"flex",flexDirection:"column",gap:32},children:[n.jsxs("div",{children:[n.jsxs("h3",{style:{fontSize:14,fontWeight:700,color:"#111827",marginBottom:16,display:"flex",alignItems:"center",gap:8},children:[n.jsx(dj,{size:16,color:"#2563eb"})," 채권 Aging 분석"]}),n.jsx("div",{style:{height:200,background:"#fff",borderRadius:12,border:"1px solid #f3f4f6",padding:8},children:n.jsx(ao,{width:"100%",height:"100%",children:n.jsxs(Db,{data:[{name:"정상",value:u.totalAr-u.overdue},{name:"1개월",value:u.overdue*.5},{name:"2개월",value:u.overdue*.3},{name:"3개월+",value:u.overdue*.2}],children:[n.jsx(Oo,{strokeDasharray:"3 3",vertical:!1,stroke:"#f3f4f6"}),n.jsx(Do,{dataKey:"name",tick:{fontSize:11,fill:"#6b7280"},axisLine:!1,tickLine:!1}),n.jsx($o,{tick:{fontSize:11,fill:"#6b7280"},axisLine:!1,tickLine:!1}),n.jsx(dd,{contentStyle:{borderRadius:8,border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:12},formatter:_=>E(_)}),n.jsx(Nf,{dataKey:"value",radius:[4,4,0,0],children:[0,1,2,3].map((_,$)=>n.jsx(Ia,{fill:$===0?"#10b981":$===3?"#ef4444":"#3b82f6"},`cell-${$}`))})]})})})]}),n.jsxs("div",{style:{background:"#f9fafb",borderRadius:12,padding:20,border:"1px solid #e5e7eb"},children:[n.jsx("h3",{style:{fontSize:14,fontWeight:700,color:"#111827",marginBottom:16},children:"심사 결정 및 의견"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6},children:"결정 (Decision)"}),n.jsxs("select",{value:g,onChange:_=>b(_.target.value),className:"search-input",style:{width:"100%",padding:"8px 12px",borderRadius:8,border:"1px solid #d1d5db",fontSize:14},children:[n.jsx("option",{value:"WATCH",children:"관찰 (Watch)"}),n.jsx("option",{value:"REVIEW_UNBLOCK",children:"해제 검토"}),n.jsx("option",{value:"KEEP_BLOCK",children:"차단 유지"}),n.jsx("option",{value:"APPROVED",children:"승인"}),n.jsx("option",{value:"REJECTED",children:"거부"})]})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6},children:"의견 (Opinion)"}),n.jsx("textarea",{value:x,onChange:_=>v(_.target.value),rows:4,className:"search-input",style:{width:"100%",padding:"12px",borderRadius:8,border:"1px solid #d1d5db",fontSize:14,resize:"none"},placeholder:"심사 의견을 상세히 입력하세요..."})]})]})]})]}),n.jsx("div",{style:{padding:24,borderTop:"1px solid #f3f4f6",background:"#f9fafb"},children:n.jsx("button",{onClick:A,className:"btn",style:{width:"100%",padding:"12px",background:"#2563eb",color:"white",fontWeight:700,borderRadius:12,border:"none",fontSize:15,boxShadow:"0 4px 6px -1px rgba(37, 99, 235, 0.2)"},children:"저장하기"})})]})]}),n.jsx("style",{children:`
        @keyframes slideIn {
          from { transform: translateX(100%); }
          to { transform: translateX(0); }
        }
      `})]})}const Jp=[{id:1,title:"거래처 선택 및 현황 분석",icon:va},{id:2,title:"해제 사유 및 계획 작성",icon:wd},{id:3,title:"요청 완료",icon:Wo}];function lL(){const[e,t]=c.useState(1),[r,a]=c.useState(""),[i,s]=c.useState(null),[o,l]=c.useState(!1),[d,h]=c.useState(""),[u,f]=c.useState(""),[m,p]=c.useState(""),[x,v]=c.useState(""),[g,b]=c.useState(!1),y=async _=>{if(_){l(!0),s(null);try{const $=await fetch(`/api/v1/credit/customers/${_}`);if(!$.ok)throw new Error("거래처 정보를 찾을 수 없습니다");const L=await $.json();if(L.customer){const j=L.customer;s({customerSeq:j.customer_seq,customerName:j.customer_name,totalAr:j.total_ar||0,weightedAgingDays:45,overdue:j.overdue||0,aging0_30:j.aging_0_30||0,aging31_60:j.aging_31_60||0,aging61_90:j.aging_61_90||0,recentCollections:[{date:"2024-12-15",amount:5e6},{date:"2024-11-20",amount:3e6},{date:"2024-10-18",amount:4e6}],avgMonthlySales:25e6,lastMeetingOpinion:"고객사 자금 사정 어려움. 1월 중순 입금 약속."})}}catch($){console.error("거래처 조회 실패:",$),alert($.message)}finally{l(!1)}}},N=async()=>{if(!r||!d||!u||!m||!x){alert("모든 필수 항목을 입력해주세요");return}b(!0);try{const _=await fetch("/api/v1/credit/unblock-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerSeq:Number(r),requestCode:`REQ-${Date.now()}`,requestDate:new Date().toISOString().split("T")[0],requestReason:d,expectedCollectionDate:u,expectedAmount:Number(m),collectionPlan:x,assigneeId:"user1"})});if(!_.ok)throw new Error("요청 제출 실패");const $=await _.json();if($.success)t(3);else throw new Error($.error||"요청 제출 실패")}catch(_){alert("요청 제출 중 오류가 발생했습니다: "+_.message)}finally{b(!1)}},A=_=>`₩${_.toLocaleString("ko-KR")}`,E=()=>n.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[n.jsxs("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb"},children:[n.jsxs("h2",{style:{fontSize:18,fontWeight:700,color:"#111827",marginBottom:20,display:"flex",alignItems:"center",gap:8},children:[n.jsx(va,{size:20,color:"#3b82f6"})," 거래처 조회"]}),n.jsxs("div",{style:{display:"flex",gap:12},children:[n.jsxs("div",{style:{position:"relative",flex:1,maxWidth:400},children:[n.jsx("input",{type:"number",value:r,onChange:_=>a(_.target.value),onKeyDown:_=>_.key==="Enter"&&y(r),placeholder:"거래처 코드 (SEQ) 입력",className:"search-input",style:{width:"100%",height:42,paddingLeft:40,fontSize:14},autoFocus:!0}),n.jsx(va,{size:16,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}})]}),n.jsx("button",{onClick:()=>y(r),disabled:o||!r,className:"btn",style:{height:42,padding:"0 24px",fontSize:14,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:o||!r?.7:1},children:o?"조회 중...":"조회"})]})]}),i&&n.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:24},children:[n.jsx("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",gridColumn:"span 2"},children:n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:24},children:[n.jsxs("div",{style:{padding:16,background:"#eff6ff",borderRadius:12,border:"1px solid #dbeafe"},children:[n.jsx("div",{style:{fontSize:13,color:"#2563eb",fontWeight:600,marginBottom:4},children:"총 채권액"}),n.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:A(i.totalAr)})]}),n.jsxs("div",{style:{padding:16,background:"#fef2f2",borderRadius:12,border:"1px solid #fee2e2"},children:[n.jsx("div",{style:{fontSize:13,color:"#dc2626",fontWeight:600,marginBottom:4},children:"연체 금액"}),n.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:A(i.overdue)})]}),n.jsxs("div",{style:{padding:16,background:"#fffbeb",borderRadius:12,border:"1px solid #fef3c7"},children:[n.jsx("div",{style:{fontSize:13,color:"#d97706",fontWeight:600,marginBottom:4},children:"평균 결제일"}),n.jsxs("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:[i.weightedAgingDays,"일"]})]}),n.jsxs("div",{style:{padding:16,background:"#f9fafb",borderRadius:12,border:"1px solid #f3f4f6"},children:[n.jsx("div",{style:{fontSize:13,color:"#4b5563",fontWeight:600,marginBottom:4},children:"월 평균 매출"}),n.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:A(i.avgMonthlySales||0)})]})]})}),n.jsxs("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",height:320},children:[n.jsx("h3",{style:{fontSize:16,fontWeight:700,color:"#111827",marginBottom:16},children:"채권 연령 분석"}),n.jsx(ao,{width:"100%",height:"100%",children:n.jsxs(Db,{data:[{name:"정상",value:i.totalAr-i.overdue},{name:"1개월",value:i.aging0_30},{name:"2개월",value:i.aging31_60},{name:"3개월+",value:i.aging61_90}],margin:{top:20,right:30,left:20,bottom:5},children:[n.jsx(Oo,{strokeDasharray:"3 3",vertical:!1}),n.jsx(Do,{dataKey:"name",tick:{fontSize:12}}),n.jsx($o,{tick:{fontSize:12}}),n.jsx(dd,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:12},formatter:_=>A(_)}),n.jsx(Nf,{dataKey:"value",radius:[4,4,0,0],children:[0,1,2,3].map((_,$)=>n.jsx(Ia,{fill:$===0?"#10b981":$===3?"#ef4444":"#3b82f6"},`cell-${$}`))})]})})]}),n.jsxs("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",height:320},children:[n.jsx("h3",{style:{fontSize:16,fontWeight:700,color:"#111827",marginBottom:16},children:"최근 수금 추이"}),n.jsx(ao,{width:"100%",height:"100%",children:n.jsxs(G$,{data:i.recentCollections,margin:{top:20,right:30,left:20,bottom:5},children:[n.jsx(Oo,{strokeDasharray:"3 3",vertical:!1}),n.jsx(Do,{dataKey:"date",tick:{fontSize:12}}),n.jsx($o,{tick:{fontSize:12}}),n.jsx(dd,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:12},formatter:_=>A(_)}),n.jsx(vb,{type:"monotone",dataKey:"amount",stroke:"#8b5cf6",strokeWidth:3,dot:{r:4},activeDot:{r:6}})]})})]})]})]}),w=()=>n.jsx("div",{className:"animate-in fade-in slide-in-from-right-4 duration-300",style:{maxWidth:800,margin:"0 auto"},children:n.jsxs("div",{className:"card",style:{padding:32,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb"},children:[n.jsxs("h2",{style:{fontSize:18,fontWeight:700,color:"#111827",marginBottom:24,display:"flex",alignItems:"center",gap:8},children:[n.jsx(wd,{size:20,color:"#3b82f6"})," 해제 요청 사유 작성"]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[n.jsxs("div",{children:[n.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["요청 사유 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("textarea",{value:d,onChange:_=>h(_.target.value),rows:5,className:"search-input",style:{width:"100%",height:"auto",padding:12,resize:"none",fontSize:14},placeholder:"매출통제 해제가 필요한 구체적인 사유를 입력해주세요."})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:24},children:[n.jsxs("div",{children:[n.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["예상 수금일 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"date",value:u,onChange:_=>f(_.target.value),className:"search-input",style:{width:"100%",height:42}})]}),n.jsxs("div",{children:[n.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["예상 수금액 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("span",{style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#6b7280",fontSize:14},children:"₩"}),n.jsx("input",{type:"number",value:m,onChange:_=>p(_.target.value),className:"search-input",style:{width:"100%",height:42,paddingLeft:30},placeholder:"0"})]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["수금 계획 근거 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("textarea",{value:x,onChange:_=>v(_.target.value),rows:3,className:"search-input",style:{width:"100%",height:"auto",padding:12,resize:"none",fontSize:14},placeholder:"수금 계획의 신뢰성을 뒷받침할 근거를 입력해주세요 (예: 고객사 담당자 통화 내용, 지불각서 등)"})]})]})]})}),P=()=>n.jsxs("div",{className:"animate-in zoom-in-95 duration-500",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"60vh"},children:[n.jsx("div",{style:{width:80,height:80,background:"#dcfce7",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:24},children:n.jsx(Wo,{size:40,color:"#16a34a"})}),n.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#111827",marginBottom:8},children:"요청이 완료되었습니다!"}),n.jsx("p",{style:{fontSize:16,color:"#6b7280",marginBottom:32},children:"담당자 검토 후 승인 여부가 결정됩니다."}),n.jsx("button",{onClick:()=>{t(1),a(""),s(null),h(""),f(""),p(""),v("")},className:"btn",style:{height:48,padding:"0 32px",fontSize:15,fontWeight:700,background:"#111827",borderColor:"#111827",color:"white",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:"새로운 요청 작성하기"})]});return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb",zIndex:10},children:[n.jsxs("div",{style:{marginBottom:24},children:[n.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"매출통제 해제 요청"}),n.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"연체 거래처의 일시적 매출 허용을 위한 승인 요청"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",maxWidth:600,margin:"0 auto",position:"relative"},children:[n.jsx("div",{style:{position:"absolute",top:20,left:0,width:"100%",height:2,background:"#f3f4f6",zIndex:0}}),n.jsx("div",{style:{position:"absolute",top:20,left:0,height:2,background:"#3b82f6",zIndex:0,width:`${(e-1)/(Jp.length-1)*100}%`,transition:"width 0.3s ease"}}),Jp.map(_=>{const $=e>=_.id,L=e===_.id;return n.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",position:"relative",zIndex:1},children:[n.jsx("div",{style:{width:40,height:40,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:$?"#3b82f6":"#fff",border:$?"none":"2px solid #e5e7eb",color:$?"#fff":"#9ca3af",boxShadow:$?"0 4px 6px -1px rgba(59, 130, 246, 0.3)":"none",transition:"all 0.3s ease"},children:n.jsx(_.icon,{size:20})}),n.jsx("span",{style:{marginTop:8,fontSize:13,fontWeight:L?700:500,color:L?"#3b82f6":"#9ca3af",transition:"color 0.3s ease"},children:_.title})]},_.id)})]})]}),n.jsxs("div",{style:{flex:1,overflow:"auto",padding:32},children:[e===1&&E(),e===2&&w(),e===3&&P()]}),e<3&&n.jsxs("div",{style:{padding:"16px 32px",background:"#fff",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("button",{onClick:()=>t(_=>Math.max(1,_-1)),disabled:e===1,className:"btn",style:{background:"transparent",borderColor:"transparent",color:"#4b5563",opacity:e===1?.3:1,cursor:e===1?"not-allowed":"pointer",paddingLeft:0},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[n.jsx(Zb,{size:18})," 이전"]})}),e===1?n.jsx("button",{onClick:()=>t(2),disabled:!i,className:"btn",style:{height:42,padding:"0 24px",fontSize:14,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:i?1:.5,cursor:i?"pointer":"not-allowed"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:["다음 단계 ",n.jsx(Ti,{size:18})]})}):n.jsx("button",{onClick:N,disabled:g,className:"btn",style:{height:42,padding:"0 24px",fontSize:14,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:g?.7:1},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[g?"제출 중...":"요청 제출하기"," ",n.jsx(sj,{size:18})]})})]})]})}function zL({selectedKey:e}){return n.jsx("div",{className:"main-view",children:e==="dashboard"?n.jsx(g1,{}):e==="calendar"?n.jsx(p1,{}):e==="demand"&&ln.demandManagement?n.jsxs("section",{children:[n.jsx("h1",{children:"수요관리"}),n.jsx("p",{children:"여기에서 수요 데이터를 조회/분석/관리하는 기능이 표시됩니다."}),n.jsx("div",{className:"empty-state",children:"초기 버전: 메인 화면 스켈레톤"})]}):e==="customer"&&ln.customerManagement?n.jsxs("section",{children:[n.jsx("h1",{children:"고객관리"}),n.jsx("p",{children:"고객관리 요구사항은 별도로 정의/입력됩니다. 현재는 플레이스홀더입니다."}),n.jsx("div",{className:"empty-state",children:"초기 버전: 고객관리 화면 스켈레톤"})]}):e==="customer"&&ln.customerManagement?n.jsxs("section",{children:[n.jsx("h1",{children:"고객관리"}),n.jsx("p",{children:"고객관리 요구사항은 별도로 정의/입력됩니다. 현재는 플레이스홀더입니다."}),n.jsx("div",{className:"empty-state",children:"초기 버전: 고객관리 화면 스켈레톤"})]}):e==="customer:list"&&ln.customerManagement?n.jsx(Nd,{}):e==="customer:sales-activity-new"&&ln.customerManagement?n.jsx(Zj,{}):e==="customer:c360"&&ln.customerManagement?n.jsx(s1,{}):e==="sales-mgmt:activity-plan"?n.jsx(h1,{}):e==="customer:c360-old"&&ln.customerManagement?n.jsx(m1,{}):e==="customer:my-activities"&&ln.customerManagement?n.jsx(b1,{}):e==="lead:register"||e==="lead"?n.jsx($1,{}):e==="lead:tm-status"?n.jsx(R1,{}):e==="order-sheet"?n.jsx(z1,{}):e==="order-list"?n.jsx(U1,{}):e==="inquiry"?n.jsx(C1,{}):e==="estimate"?n.jsx(O1,{}):e==="item360"?n.jsx(Y1,{}):e==="inventory:expiry-ag"?n.jsx(rw,{}):e==="complaint"?n.jsx(j1,{}):e==="credit:ar-aging"?n.jsx(fw,{}):e==="credit:meetings"?n.jsx(sL,{}):e.startsWith("credit:meeting:")?n.jsx(oL,{}):e==="credit:unblocking"?n.jsx(lL,{}):e==="sales-receivables"?n.jsxs("section",{children:[n.jsx("h1",{children:"매출/채권"}),n.jsx("div",{className:"empty-state",children:"매출·채권 관리 화면이 준비중입니다."})]}):e==="settings"?n.jsx(_1,{}):e==="sales-mgmt:sales"?n.jsx(V1,{}):e==="sales-mgmt:receivables"?n.jsx(Z1,{}):e==="sales-mgmt:activities"?n.jsx(tw,{}):e==="lab:vibe-workspace"?n.jsx(uw,{}):e==="lab:unit-analysis"?n.jsx(aw,{}):e==="lab:price-sim"?n.jsx(sw,{}):e==="lab:price-sim-unit"?n.jsx(lw,{}):e==="lab:price-simulation"?n.jsx(dw,{}):e==="demand:list"&&ln.demandManagement?n.jsx(ej,{}):e==="sales-targets"&&ln.demandManagement?n.jsx(Yf,{}):e==="sales-dashboard"&&ln.demandManagement?n.jsx(G1,{}):e==="sales-assign"&&ln.demandManagement?n.jsx(q1,{}):e==="sales-plan"&&ln.demandManagement?n.jsx(Xj,{}):e==="sales-plan-new"&&ln.demandManagement?n.jsx(Yf,{}):e==="sales-plan-s"&&ln.demandManagement?n.jsx(Gj,{}):e==="demand:excel-upload"&&ln.demandManagement?n.jsx(Fj,{}):n.jsxs("section",{children:[n.jsx("h1",{children:e}),n.jsx("div",{className:"empty-state",children:"콘텐츠가 준비중입니다."})]})})}export{zL as MainView};
