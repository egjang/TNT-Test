var Jw=Object.defineProperty;var Zw=(e,t,n)=>t in e?Jw(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Rc=(e,t,n)=>Zw(e,typeof t!="symbol"?t+"":t,n);import{c as Ft,r as h,j as r,_ as gm,R as Te,a as $d,g as ym,b as Bc,o as eS,i as Wc,s as tS,d as Oo,e as Pr,P as jv,C as El,f as ls,F as zd,h as Iu,T as wv,k as nS,l as rS}from"./index-DnWsTnd7.js";import{DemandList as iS}from"./DemandList-CKCS0XBW.js";import{c as Wt}from"./close-CV7tuFPj.js";import{t as gt}from"./tone-B1QjB-CC.js";import{u as Dn}from"./useDraggableModal-KDJ668Qq.js";import{S as Qt,a as $i,g as vm,f as aS}from"./week-71ul24EN.js";import{c as Sv,a as Nv}from"./chevron-right-DHqVul_D.js";import{w as xm}from"./warehouse-Du5HBj7c.js";import{C as bm,P as sS}from"./plus-CzdAg9WZ.js";import"./check-CbDrRJmJ.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oS=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],lS=Ft("arrow-left",oS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],uS=Ft("arrow-right",cS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dS=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],fS=Ft("award",dS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hS=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],mS=Ft("chart-no-axes-column",hS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pS=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],gS=Ft("circle-check-big",pS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yS=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Il=Ft("circle-check",yS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vS=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],xS=Ft("clock",vS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bS=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],jS=Ft("database",bS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wS=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],ts=Ft("dollar-sign",wS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SS=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],NS=Ft("ellipsis",SS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kS=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],AS=Ft("eye",kS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CS=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],ES=Ft("flame",CS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IS=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]],PS=Ft("layout-list",IS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TS=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],kv=Ft("layout-grid",TS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OS=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],DS=Ft("list",OS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _S=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],jm=Ft("loader-circle",_S);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MS=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],LS=Ft("refresh-cw",MS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $S=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],zi=Ft("search",$S);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zS=[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]],RS=Ft("table-2",zS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BS=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],WS=Ft("thumbs-up",BS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FS=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],qS=Ft("triangle-alert",FS);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const US=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Pu=Ft("user",US);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HS=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Rd=Ft("x",HS),bn={demandManagement:!0,customerManagement:!0};function YS(){const e=h.useRef(null),[t,n]=h.useState(null),[i,a]=h.useState([]),[s,o]=h.useState(null),[l,c]=h.useState([]),[d,u]=h.useState([]),[f,m]=h.useState(null),[p,y]=h.useState(!1),[v,g]=h.useState(null),[b,x]=h.useState(0),[N,A]=h.useState(""),C=()=>{var z;return(z=e.current)==null?void 0:z.click()},w=async z=>{var k;m(null);const j=(k=z.target.files)==null?void 0:k[0];if(n(j?j.name:null),c([]),a([]),o(null),!!j)try{const L=await gm(()=>import("./xlsx-D_0l8YDs.js"),[]),T=await j.arrayBuffer(),$=L.read(T,{type:"array"}),V=$.SheetNames||[];a(V);const G=V[0];if(o(G||null),G){const ne=$.Sheets[G],U=L.utils.sheet_to_json(ne,{header:1});u(U),c(U)}}catch(L){m("엑셀 파일을 읽는 중 오류가 발생했습니다. 파일 형식을 확인해 주세요."),console.error(L)}},O=l&&l.length>0,M=h.useMemo(()=>{if(!O)return null;const z=l.reduce((j,k)=>Math.max(j,Array.isArray(k)?k.length:0),0);return r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsx("tr",{children:Array.from({length:z}).map((j,k)=>r.jsxs("th",{children:["C",k+1]},k))})}),r.jsx("tbody",{children:l.map((j,k)=>r.jsx("tr",{children:Array.from({length:z}).map((L,T)=>r.jsx("td",{children:Array.isArray(j)&&j[T]!=null?String(j[T]):""},T))},k))})]})})},[l,O]),B=async z=>{var L,T;const j=z.target.value;o(j);const k=(T=(L=e.current)==null?void 0:L.files)==null?void 0:T[0];if(k)try{const $=await gm(()=>import("./xlsx-D_0l8YDs.js"),[]),V=await k.arrayBuffer(),ne=$.read(V,{type:"array"}).Sheets[j],U=$.utils.sheet_to_json(ne,{header:1});u(U),c(U)}catch($){m("시트를 전환하는 중 오류가 발생했습니다."),console.error($)}};return r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"Excel Upload"}),r.jsx("div",{className:"muted count-text"})]}),r.jsx("p",{children:"로컬 PC에서 엑셀 파일(.xlsx, .xls)만 선택할 수 있습니다."}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("input",{ref:e,type:"file",accept:".xlsx,.xls,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",onChange:w,style:{display:"none"}}),r.jsx("button",{className:"btn",onClick:C,children:"엑셀 파일 선택"}),t&&r.jsxs("span",{className:"muted",children:["선택됨: ",t]})]}),i.length>1&&r.jsx("div",{style:{marginTop:10},children:r.jsxs("label",{children:["시트 선택: ",r.jsx("select",{value:s??"",onChange:B,children:i.map(z=>r.jsx("option",{value:z,children:z},z))})]})}),f&&r.jsx("div",{className:"error",children:f}),M,O&&r.jsxs("div",{style:{marginTop:12,display:"flex",alignItems:"center",gap:10},children:[r.jsx("button",{type:"button",className:"btn",disabled:p,onClick:async z=>{z.preventDefault(),z.stopPropagation(),g(null),m(null);try{y(!0),x(0),A("데이터 준비 중...");const j=KS(d);if(!j.length)throw new Error("업로드할 데이터가 없습니다. 엑셀 내용을 확인해 주세요.");const L=XS(j,250);let T=0,$=0,V=0;for(let G=0;G<L.length;G++){const ne=L[G];A(`업로드 중... (${G+1}/${L.length})`);const U=await fetch("/api/v1/demand/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:ne})});if(!U.ok){const P=await U.text();try{const D=JSON.parse(P),S=(D==null?void 0:D.error)||P||`Upload failed: ${U.status}`;throw new Error(S)}catch{throw new Error(`Upload failed: ${U.status} ${P}`)}}const I=await U.json();$+=Number(I.updated||0),V+=Number(I.inserted||0),T+=ne.length,x(Math.min(100,Math.round(T/j.length*100)))}A("완료"),g(`성공: 총 ${$+V}건 (업데이트 ${$}, 신규 ${V})`)}catch(j){m(j.message||"업로드 중 오류가 발생했습니다")}finally{y(!1),setTimeout(()=>{x(0),A("")},1200)}},children:"업로드"}),v&&r.jsx("span",{className:"muted",children:v})]}),p&&r.jsxs("div",{style:{marginTop:10,width:"100%"},children:[r.jsx("div",{className:"progress",children:r.jsx("div",{className:"progress-bar",style:{width:`${b}%`}})}),r.jsxs("div",{className:"muted",style:{marginTop:6},children:[N," ",b>0?`${b}%`:""]})]})]})}function KS(e){if(!e||e.length===0)return[];const t=e[0].map(v=>String(v||"").trim()),n=e.slice(1);function i(v){return t.map((g,b)=>v.some(x=>Gs(g,x))?b:-1).filter(g=>g>=0)}const a=t.findIndex(v=>["영업담당자","영업사원","sales_owner","sales_rep","sales_rep_name"].some(g=>Gs(v,g))),s=t.findIndex(v=>["거래처","고객","customer"].some(g=>Gs(v,g))),o=t.findIndex(v=>["중분류","품목중분류","종분류","category_mid","item_subcategory"].some(g=>Gs(v,g))),l=i(["공급사(tnt)","공급사 tnt","tnt","공급사","공급자","supplier"]),c=i(["영업관리단위","관리단위","mgmt_unit","sales_mgmt_unit"]),d=i(["점유율(%)","점유율","share","share_rate"]),u=Math.max(l.length,c.length,d.length),f=[];let m=null,p=null,y=null;for(const v of n){let g=na(v,a).trim(),b=na(v,s).trim(),x=na(v,o).trim();if(g||(g=m||""),b||(b=p||""),x||(x=y||""),!g||!b||!x){g&&(m=g),b&&(p=b),x&&(y=x);continue}m=g,p=b,y=x;for(let N=0;N<u;N++){const A=na(v,l[N]).trim(),C=na(v,c[N]).trim(),w=VS(na(v,d[N])),O=w!=null&&w!==0;if(!(A||C||O))continue;const M=O?w:null;f.push({salesRepName:g,customerName:b,itemSubcategory:x,supplierName:A,salesMgmtUnit:C,shareRate:M,priority:N+1})}}return f}function na(e,t){return t>=0?e[t]??"":""}function wm(e){return String(e||"").replace(/[\s\-_%()\[\]{}]/g,"").replace(/tnt/gi,"").toLowerCase()}function Gs(e,t){return wm(e)===wm(t)}function VS(e){if(e==null)return null;const t=Number(String(e).replace(/[,\s%]/g,""));return Number.isFinite(t)?t:null}function XS(e,t){const n=[];for(let i=0;i<e.length;i+=t)n.push(e.slice(i,i+t));return n}const Av="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='20'%20height='20'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20aria-hidden='true'%3e%3cpath%20d='M20.59%2013.41%2011%203H4v7l9.59%209.59a2%202%200%200%200%202.82%200l4.18-4.18a2%202%200%200%200%200-2.82Z'/%3e%3ccircle%20cx='7.5'%20cy='7.5'%20r='1.5'/%3e%3c/svg%3e";function GS(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const n=String(t.getFullYear()%100).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${n}-${i}-${a} ${s}:${o}`}function Sm(){const[e,t]=h.useState(""),[n,i]=h.useState(""),[a,s]=h.useState(""),[o,l]=h.useState(!1),[c,d]=h.useState(null),[u,f]=h.useState([]),[m,p]=h.useState(""),[y,v]=h.useState(!1),[g,b]=h.useState({open:!1,x:0,y:0}),[x,N]=h.useState(()=>new Set),[A,C]=h.useState({open:!1,x:0,y:0}),[w,O]=h.useState(void 0),[M,B]=h.useState("init"),[z,j]=h.useState({}),[k,L]=h.useState("TNT"),T=100,[$,V]=h.useState(0),[G,ne]=h.useState(!0),[U,I]=h.useState(!1),P=Te.useRef(null),[D,S]=h.useState(0),_=["init","sim","apply","confirm"],H=[{key:"init",label:"초기설정"},{key:"sim",label:"Simulation"},{key:"apply",label:"목표반영"},{key:"confirm",label:"확정"}],q=_.indexOf(M),K=()=>{const Q=Math.max(0,q-1);B(_[Q])},W=()=>{const Q=Math.min(_.length-1,q+1);B(_[Q])};function R(){const Q=[];for(let ce=2030;ce>=2026;ce--)Q.push(ce);return Q}const[oe,Y]=h.useState(""),[X,de]=h.useState(!1),[be,ke]=h.useState(null),[ve,Ie]=h.useState({tnt:0,dys:0}),[J,ge]=h.useState({tnt:0,dys:0}),[Pe,Se]=h.useState({tnt:0,dys:0}),Je=new Intl.NumberFormat("ko-KR");function yt(Q,ce){return Number.isFinite(Q)?Q:0}function jt(Q,ce){const we=Number.isFinite(Q)&&Q>0,Me=we?yt(Q):0;return r.jsxs("div",{style:{textAlign:"right",lineHeight:1.15},children:[r.jsx("div",{children:we?Q%1===0?Math.round(Q).toLocaleString():Q.toFixed(2):"-"}),r.jsx("div",{className:"muted",style:{fontSize:11},children:we?`${Je.format(Math.round(Me))} 원`:""})]})}async function It(){de(!0),ke(null);try{const Q=(localStorage.getItem("tnt.sales.empName")||"").trim();if(!Q){Ie({tnt:0,dys:0}),ke("로그인이 필요합니다");return}if(!oe||isNaN(Number(oe))){Ie({tnt:0,dys:0});return}const ce=new URL("/api/v1/targets/assigned",window.location.origin);ce.searchParams.set("year",String(oe)),ce.searchParams.set("empNames",Q);try{const Le=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),Ke=Le==="moderate"?"2":Le==="best"?"1":"";Ke&&ce.searchParams.set("versionNo",Ke)}catch{}const we=await fetch(ce.toString());if(!we.ok)throw new Error(`HTTP ${we.status}`);const Me=await we.json().catch(()=>[]),He=Array.isArray(Me)?Me.find(Le=>String(Le.company_name||"").toUpperCase()==="TNT"):null,De=Array.isArray(Me)?Me.find(Le=>String(Le.company_name||"").toUpperCase()==="DYS"):null;Ie({tnt:Math.round(Number((He==null?void 0:He.assigned_amount)||0)),dys:Math.round(Number((De==null?void 0:De.assigned_amount)||0)),tntStage:String((He==null?void 0:He.target_stage)||"").trim()||void 0,dysStage:String((De==null?void 0:De.target_stage)||"").trim()||void 0})}catch(Q){ke((Q==null?void 0:Q.message)||"조회 오류"),Ie({tnt:0,dys:0})}finally{de(!1)}}const[ye,Ae]=h.useState(0);h.useEffect(()=>{const Q=()=>Ae(ce=>ce+1);return window.addEventListener("tnt.sales.assign.mode.changed",Q),()=>window.removeEventListener("tnt.sales.assign.mode.changed",Q)},[]),h.useEffect(()=>{It()},[oe,ye]);const[Oe,Fe]=h.useState(!1),[ze,at]=h.useState(null);new Date().getFullYear();const[At,Pt]=h.useState("prev1"),[Ze,nn]=h.useState(()=>new Array(12).fill(0)),[Ht,Yt]=h.useState({loading:!1});async function Ct(){if(!(w!=null&&w.customerSeq)){nn(new Array(12).fill(0));return}Fe(!0),at(null);try{const Q=new Date().getFullYear(),ce=At==="prev1"?[Q-1]:At==="last2"?[Q-1,Q-2]:[Q-1,Q-2,Q-3],we=[];await Promise.all(ce.map(async Le=>{try{const Ke=await fetch(`/api/v1/customers/${w.customerSeq}/invoice-monthly-by-dim?year=${Le}`);if(!Ke.ok)return;const vt=await Ke.json().catch(()=>[]),rn=rt=>{const Tt=String(rt??"").trim();return Tt.toLowerCase()==="na"?"":Tt},xn=(Array.isArray(vt)?vt:[]).map(rt=>({itemSubcategorySeq:Number(rt.itemSubcategorySeq??rt.item_subcategory_seq??0),salesMgmtUnitSeq:Number(rt.salesMgmtUnitSeq??rt.sales_mgmt_unit_seq??0),itemSubcategory:rn(rt.itemSubcategory??rt.item_subcategory),salesMgmtUnit:rn(rt.salesMgmtUnit??rt.sales_mgmt_unit),month:Number(rt.month??0),amount:Number(rt.amount??0)}));we.push(...xn)}catch{}}));const Me=new Map,He=(Le,Ke)=>`${(Le||"").trim().toLowerCase()}||${(Ke||"").trim().toLowerCase()}`;for(const Le of we){const Ke=He(Le.itemSubcategory,Le.salesMgmtUnit);let vt=Me.get(Ke);vt||(vt={sub:Le.itemSubcategory||"",unit:Le.salesMgmtUnit||"",months:new Array(12).fill(0)},Me.set(Ke,vt));const rn=Math.min(12,Math.max(1,Number(Le.month)||0))-1;vt.months[rn]+=Number.isFinite(Le.amount)?Number(Le.amount):0}const De=Array.from(Me.values()).sort((Le,Ke)=>(Le.sub||"").localeCompare(Ke.sub||"")||(Le.unit||"").localeCompare(Ke.unit||""));Ji(De)}catch(Q){at(Q.message||"조회 중 오류가 발생했습니다"),Ji([])}finally{Fe(!1)}}h.useEffect(()=>{M==="init"&&Ct()},[M,w==null?void 0:w.customerSeq,At]);async function yn(){if(!(w!=null&&w.customerSeq)){Yt({loading:!1,hasRecent:void 0,error:null});return}Yt({loading:!0,hasRecent:void 0,error:null});try{const Q=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);Q.searchParams.set("custSeq",String(w.customerSeq)),Q.searchParams.set("years","2");const ce=await fetch(Q.toString());if(!ce.ok){let He=`HTTP ${ce.status}`;try{const De=await ce.json();De!=null&&De.error&&(He=De.error)}catch{}throw new Error(He)}const we=await ce.json(),Me=Array.isArray(we)&&we.some(He=>Number((He==null?void 0:He.customerSeq)||(He==null?void 0:He.customerSeqText)||0)===Number(w.customerSeq)&&!!(He!=null&&He.hasRecent));Yt({loading:!1,hasRecent:Me,error:null})}catch(Q){Yt({loading:!1,hasRecent:void 0,error:Q.message||"오류"})}}h.useEffect(()=>{M==="init"&&yn()},[M,w==null?void 0:w.customerSeq]);const[or,Ji]=h.useState([]),Zi=h.useMemo(()=>r.jsx("div",{className:"table-container",style:{border:"1px solid var(--border)",borderRadius:8,marginTop:8},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:220,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:120,textAlign:"center"},children:"목표입력"}),Array.from({length:12},(Q,ce)=>r.jsxs("th",{style:{width:90,textAlign:"right"},children:[String(ce+1).padStart(2,"0"),"월"]},ce))]})}),r.jsx("tbody",{children:or.length===0?r.jsx("tr",{children:r.jsx("td",{className:"muted",colSpan:15,style:{padding:"12px 10px"},children:Oe?"불러오는 중…":"데이터가 없습니다"})}):or.map((Q,ce)=>r.jsxs("tr",{children:[r.jsx("td",{children:Q.sub}),r.jsx("td",{children:Q.unit}),r.jsx("td",{style:{textAlign:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>Ma(Q.sub,Q.unit),children:"목표입력"})}),Q.months.map((we,Me)=>r.jsx("td",{style:{textAlign:"right"},children:Math.round(we).toLocaleString()},Me))]},ce))})]})}),[or,Oe]),[zt,pr]=h.useState({open:!1,dist:new Array(12).fill(0)});function Ma(Q,ce){pr({open:!0,sub:Q,unit:ce,month:"",qty:"",dist:new Array(12).fill(0)})}function gr(){pr({open:!1,dist:new Array(12).fill(0)})}function yr(Q,ce){const we=Number(Q),Me=Number(ce),He=new Array(12).fill(0);if(Number.isFinite(we)&&we>=1&&we<=12&&Number.isFinite(Me)&&Me>0){const De=12-we+1,Le=Me/De;for(let Ke=we-1;Ke<12;Ke++)He[Ke]=Le}pr(De=>({...De,month:Q,qty:ce,dist:He}))}const[Pn,lr]=h.useState({open:!1,rows:[]});function st(){const Q=(or||[]).map((ce,we)=>({key:`${ce.sub}||${ce.unit}||${we}`,sub:ce.sub,unit:ce.unit,month:"",qty:"",dist:new Array(12).fill(0)}));lr({open:!0,rows:Q})}function Xn(){lr({open:!1,rows:[]})}function ji(Q,ce,we){lr(Me=>{const He=Me.rows.slice(),De={...He[Q]},Le=Number(ce??De.month),Ke=Number(we??De.qty),vt=new Array(12).fill(0);if(Number.isFinite(Le)&&Le>=1&&Le<=12&&Number.isFinite(Ke)&&Ke>0){const rn=12-Le+1,xn=Ke/rn;for(let rt=Le-1;rt<12;rt++)vt[rt]=xn}return De.month=ce??De.month,De.qty=we??De.qty,De.dist=vt,He[Q]=De,{...Me,rows:He}})}function Tr(Q){try{const ce=Q.getBoundingClientRect(),we=(ce==null?void 0:ce.width)||Q.offsetWidth||600,Me=(ce==null?void 0:ce.height)||Q.offsetHeight||400,He=Math.max(0,Math.round((window.innerWidth-we)/2)),Le=Math.max(0,Math.round(window.innerHeight-Me-40));return{x:He,y:Le}}catch{const ce=Math.max(0,Math.round((window.innerWidth-600)/2)),Me=Math.max(0,Math.round(window.innerHeight-400-40));return{x:ce,y:Me}}}function La(Q){try{const ce=Q.getBoundingClientRect(),we=(ce==null?void 0:ce.width)||Q.offsetWidth||460,Me=Math.max(0,Math.round(window.innerWidth-we)),He=Math.max(0,Math.round(window.innerHeight*.17));return{x:Me,y:He}}catch{const we=Math.max(0,Math.round(window.innerWidth-460)),Me=Math.max(0,Math.round(window.innerHeight*.17));return{x:we,y:Me}}}const Or=Dn("sales-plan-target-input",!!zt.open,Tr,{persist:!1,resetOnOpen:!0}),wi=Dn("sales-plan-bulk-input",!!Pn.open,Tr,{persist:!1,resetOnOpen:!0}),[vr,Si]=h.useState({open:!1,rows:[]}),[ht,Kt]=h.useState("");function ae(){const Q=(or||[]).map((ce,we)=>({key:`${ce.sub}||${ce.unit}||${we}`,sub:ce.sub,unit:ce.unit,month:"",qty:"",dist:new Array(12).fill(0)}));Si({open:!0,rows:Q})}function je(){Si({open:!1,rows:[]})}function xe(Q,ce,we){Si(Me=>{const He=Me.rows.slice(),De={...He[Q]},Le=Number(ce??De.month),Ke=Number(we??De.qty),vt=new Array(12).fill(0);if(Number.isFinite(Le)&&Le>=1&&Le<=12&&Number.isFinite(Ke)&&Ke>0){const rn=12-Le+1,xn=Ke/rn;for(let rt=Le-1;rt<12;rt++)vt[rt]=xn}return De.month=ce??De.month,De.qty=we??De.qty,De.dist=vt,He[Q]=De,{...Me,rows:He}})}const qe=Dn("sales-plan-bulk-ratio",!!vr.open,Tr,{persist:!1,resetOnOpen:!0}),[ue,Re]=h.useState({open:!1,loading:!1,error:null,opts:[],dist:new Array(12).fill(0),rows:[]}),Ce=Dn("sales-plan-new-item",!!ue.open,Tr,{persist:!1,resetOnOpen:!0});async function Ve(){Re(Q=>({...Q,open:!0,loading:!0,error:null,unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0),rows:[]}));try{const Q=await fetch("/api/v1/items/dim"),ce=Q.ok?await Q.json():[],we=Array.isArray(ce)?ce.map(De=>({itemSubcategory:String(De.itemSubcategory||De.item_subcategory||""),salesMgmtUnit:String(De.salesMgmtUnit||De.sales_mgmt_unit||"")})):[],Me={};we.forEach(De=>{const Le=De.salesMgmtUnit.trim();Le&&!Me[Le]&&(Me[Le]=De)});const He=Object.values(Me).sort((De,Le)=>De.salesMgmtUnit.localeCompare(Le.salesMgmtUnit));Re(De=>({...De,loading:!1,opts:He}))}catch(Q){Re(ce=>({...ce,loading:!1,error:(Q==null?void 0:Q.message)||"조회 오류",opts:[]}))}}function Ge(){Re({open:!1,loading:!1,error:null,opts:[],dist:new Array(12).fill(0),rows:[]})}function nt(Q){const ce=ue.opts.find(we=>we.salesMgmtUnit===Q);Re(we=>({...we,unit:Q,sub:(ce==null?void 0:ce.itemSubcategory)||we.sub}))}function Qe(Q,ce){const we=Number(Q??ue.month),Me=Number(ce??ue.qty),He=new Array(12).fill(0);if(Number.isFinite(we)&&we>=1&&we<=12&&Number.isFinite(Me)&&Me>0){const De=12-we+1,Le=Me/De;for(let Ke=we-1;Ke<12;Ke++)He[Ke]=Le}Re(De=>({...De,month:Q??De.month,qty:ce??De.qty,dist:He}))}function Rt(){const Q=(ue.unit||"").trim(),ce=(ue.sub||"").trim(),we=ue.month,Me=ue.qty;if(!Q||!we||!Me){alert("영업관리단위, 매출월, 매출 수량을 입력하세요.");return}const He={sub:ce||"(신규)",unit:Q,months:ue.dist.slice()};Re(De=>({...De,rows:[...De.rows,He],unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0)}))}h.useEffect(()=>{if(!zt.open&&!Pn.open&&!ue.open)return;const Q=ce=>{ce.key==="Escape"&&(zt.open&&gr(),Pn.open&&Xn(),ue.open&&Ge())};return window.addEventListener("keydown",Q,!0),()=>window.removeEventListener("keydown",Q,!0)},[zt.open,Pn.open,ue.open]);async function mt(Q=!0){d(null),Q?(l(!0),V(0),ne(!0)):I(!0);try{const ce=localStorage.getItem("tnt.sales.assigneeId");if(!ce){f([]),d(gt.loginRequired);return}const we=new URL("/api/v1/customers",window.location.origin);we.searchParams.set("mineOnly","true"),we.searchParams.set("assigneeId",ce),we.searchParams.set("companyType",k),m.trim()&&we.searchParams.set("name",m.trim()),we.searchParams.set("limit",String(T)),we.searchParams.set("offset",String(Q?0:$));const Me=await fetch(we.toString());if(!Me.ok){let Le=`HTTP ${Me.status}`;try{const Ke=await Me.json();Ke!=null&&Ke.error&&(Le=Ke.error)}catch{const Ke=await Me.text();Ke&&(Le=Ke)}throw new Error(Le)}const He=await Me.json(),De=Array.isArray(He)?He:[];f(Q?De:Le=>[...Le,...De]),ne(De.length>=T),V(Le=>Q?T:Le+T);try{if(ce){const Le=new URL("/api/v1/customers/count",window.location.origin);Le.searchParams.set("mineOnly","true"),Le.searchParams.set("assigneeId",ce);const Ke=await fetch(Le.toString());if(Ke.ok){const vt=await Ke.json().catch(()=>({})),rn=Number((vt==null?void 0:vt.total)??0);S(Number.isFinite(rn)?rn:0)}else S(0)}else S(0)}catch{S(0)}try{const Le=De.map(Ke=>Number(Ke.customerSeq||0)).filter(Ke=>Number.isFinite(Ke)&&Ke>0);if(Le.length>0){const Ke=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);Ke.searchParams.set("custSeq",Array.from(new Set(Le)).join(",")),Ke.searchParams.set("years","2");const vt=await fetch(Ke.toString());if(vt.ok){const rn=await vt.json(),xn={};Array.isArray(rn)&&rn.forEach(rt=>{const Tt=Number((rt==null?void 0:rt.customerSeq)||(rt==null?void 0:rt.customerSeqText)||0);Number.isFinite(Tt)&&(xn[Tt]=!!(rt!=null&&rt.hasRecent))}),j(rt=>Q?xn:{...rt,...xn})}else Q&&j({})}else Q&&j({})}catch{j({})}}catch(ce){d(ce.message||"조회 중 오류가 발생했습니다")}finally{Q?l(!1):I(!1)}}h.useEffect(()=>{mt(!0)},[]),h.useEffect(()=>{mt(!0)},[k]),h.useEffect(()=>{if(!g.open)return;const Q=()=>b({open:!1,x:0,y:0});return window.addEventListener("click",Q),()=>window.removeEventListener("click",Q)},[g.open]),h.useEffect(()=>{if(!g.open)return;const Q=ce=>{ce.key==="Escape"&&b({open:!1,x:0,y:0})};return window.addEventListener("keydown",Q),()=>window.removeEventListener("keydown",Q)},[g.open]),h.useEffect(()=>{const Q=ce=>{((ce==null?void 0:ce.key)==="Escape"||(ce==null?void 0:ce.key)==="Esc"||(ce==null?void 0:ce.keyCode)===27)&&(b({open:!1,x:0,y:0}),C({open:!1,x:0,y:0}))};return document.addEventListener("keydown",Q,!0),()=>document.removeEventListener("keydown",Q,!0)},[]);async function dt(Q,ce){Q.preventDefault(),Q.stopPropagation(),b({open:!1,x:0,y:0});const we=Q.clientX,Me=Q.clientY;C({open:!0,x:we,y:Me,row:ce,loading:!1,error:null,data:[]})}const Dr=h.useMemo(()=>{var ce,we,Me,He,De,Le,Ke,vt,rn,xn,rt,Tt,Ni,$a,Ys;const Q=[...u].sort((An,ii)=>{const xr=Number(An.customerSeq||0),za=Number(ii.customerSeq||0),Dc=!!z[xr],it=!!z[za];if(Dc!==it)return it?1:-1;const Rn=(An.customerName||"").toString(),Ra=(ii.customerName||"").toString();return Rn.localeCompare(Ra,"ko",{sensitivity:"base"})});return r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:8},children:[r.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,cursor:"pointer"},children:[r.jsx("input",{type:"radio",name:"companyType",checked:k==="TNT",onChange:()=>L("TNT")}),r.jsx("span",{children:"TNT"})]}),r.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,cursor:"pointer"},children:[r.jsx("input",{type:"radio",name:"companyType",checked:k==="DYS",onChange:()=>L("DYS")}),r.jsx("span",{children:"DYS"})]})]}),r.jsxs("div",{ref:P,className:"table-container",onClick:()=>b({open:!1,x:0,y:0}),style:{height:"100%",overflow:"auto"},children:[Q.length===0?r.jsx("div",{className:"empty-state",children:gt.empty}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsx("tr",{children:r.jsx("th",{style:{width:"auto"},children:"거래처명"})})}),r.jsx("tbody",{children:Q.map((An,ii)=>r.jsx("tr",{onClick:xr=>{xr.preventDefault(),xr.stopPropagation(),O(An),C({open:!1,x:0,y:0})},onContextMenu:xr=>dt(xr,An),"aria-selected":(w==null?void 0:w.customerId)===An.customerId?!0:void 0,style:(w==null?void 0:w.customerId)===An.customerId?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:r.jsx("td",{children:(()=>{const xr=Number(An.customerSeq||0);return z[xr]?r.jsxs("span",{children:[An.customerName," "," ","$"]}):An.customerName})()})},ii))})]}),U&&r.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:gt.loading}),!o&&!U&&!G&&u.length>0&&r.jsx("div",{className:"muted",style:{padding:"8px 10px",textAlign:"center"},children:"마지막 데이터입니다."}),A.open&&r.jsxs("div",{className:"context-menu",style:{left:A.x+6,top:A.y+6,maxWidth:420,padding:8},onClick:An=>An.stopPropagation(),children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 상세"}),A.error?r.jsx("div",{className:"error",style:{maxWidth:380},children:A.error}):r.jsx("table",{className:"table",style:{width:"100%"},children:r.jsxs("tbody",{children:[r.jsxs("tr",{children:[r.jsx("th",{style:{width:110,textAlign:"left"},children:"거래처번호"}),r.jsx("td",{children:((ce=A.row)==null?void 0:ce.customerId)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"사업자번호"}),r.jsx("td",{children:((we=A.row)==null?void 0:we.bizNo)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"대표자명"}),r.jsx("td",{children:((Me=A.row)==null?void 0:Me.ownerName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"업태"}),r.jsx("td",{children:((He=A.row)==null?void 0:He.bizKind)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"종목"}),r.jsx("td",{children:((De=A.row)==null?void 0:De.bizType)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"전화번호"}),r.jsx("td",{children:((Le=A.row)==null?void 0:Le.telNo)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"담당자명"}),r.jsx("td",{children:((Ke=A.row)==null?void 0:Ke.empName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"부서명"}),r.jsx("td",{children:((vt=A.row)==null?void 0:vt.deptName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"시/도"}),r.jsx("td",{children:((rn=A.row)==null?void 0:rn.addrProvinceName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"시/군/구"}),r.jsx("td",{children:((xn=A.row)==null?void 0:xn.addrCityName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"고객유형"}),r.jsx("td",{children:((rt=A.row)==null?void 0:rt.customerTypeName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"비고"}),r.jsx("td",{children:((Tt=A.row)==null?void 0:Tt.customerRemark)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"생성자"}),r.jsx("td",{children:((Ni=A.row)==null?void 0:Ni.createdBy)??""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"수정자"}),r.jsx("td",{children:(($a=A.row)==null?void 0:$a.updatedBy)??""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"생성일시"}),r.jsx("td",{children:GS((Ys=A.row)==null?void 0:Ys.createdAt)})]})]})})]})]})]})},[u,g,x,A,w,z,o,U,G]);h.useEffect(()=>{const Q=P.current;if(!Q)return;function ce(){Q.scrollTop+Q.clientHeight>=Q.scrollHeight-48&&G&&!U&&!o&&mt(!1)}return Q.addEventListener("scroll",ce),()=>Q.removeEventListener("scroll",ce)},[G,U,o,$]);const[dn,ni]=h.useState({open:!1,loading:!1,error:null,rows:[]}),ri=Dn("unit-amounts-by-emp",dn.open,La,{persist:!1,resetOnOpen:!0});function Us(){ni({open:!0,loading:!0,error:null,rows:[]});const Q=(localStorage.getItem("tnt.sales.empName")||"").trim();if(!Q){ni({open:!0,loading:!1,error:"로그인이 필요합니다",rows:[]});return}const ce=new URL("/api/v1/dashboard/unit-amounts-by-emp",window.location.origin);ce.searchParams.set("empName",Q),fetch(ce.toString()).then(async we=>{if(!we.ok){let De=`HTTP ${we.status}`;try{const Le=await we.json();Le!=null&&Le.error&&(De=Le.error)}catch{const Le=await we.text();Le&&(De=Le)}throw new Error(De)}const Me=await we.json(),He=(Array.isArray(Me)?Me:[]).map(De=>({unit:String((De==null?void 0:De.sales_mgmt_unit)??(De==null?void 0:De.salesMgmtUnit)??""),amount:Number((De==null?void 0:De.amount)??0)}));ni({open:!0,loading:!1,error:null,rows:He})}).catch(we=>ni({open:!0,loading:!1,error:(we==null?void 0:we.message)||"조회 오류",rows:[]}))}function Hs(){ni(Q=>({...Q,open:!1}))}return h.useEffect(()=>{if(!dn.open)return;const Q=ce=>{ce.key==="Escape"&&Hs()};return window.addEventListener("keydown",Q,!0),()=>window.removeEventListener("keydown",Q,!0)},[dn.open]),h.useEffect(()=>{if(!zt.open)return;const Q=ce=>{ce.key==="Escape"&&gr()};return window.addEventListener("keydown",Q,!0),()=>window.removeEventListener("keydown",Q,!0)},[zt.open]),h.useEffect(()=>{if(!Pn.open)return;const Q=ce=>{ce.key==="Escape"&&Xn()};return window.addEventListener("keydown",Q,!0),()=>window.removeEventListener("keydown",Q,!0)},[Pn.open]),h.useEffect(()=>{if(!vr.open)return;const Q=ce=>{ce.key==="Escape"&&je()};return window.addEventListener("keydown",Q,!0),()=>window.removeEventListener("keydown",Q,!0)},[vr.open]),h.useEffect(()=>{if(!ue.open)return;const Q=ce=>{ce.key==="Escape"&&Ge()};return window.addEventListener("keydown",Q,!0),()=>window.removeEventListener("keydown",Q,!0)},[ue.open]),r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsxs("h2",{style:{margin:0,fontSize:18,display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:["목표 Simulation",r.jsxs("select",{className:"search-input",value:oe,onChange:Q=>Y(Q.target.value),"aria-label":"목표년도",children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),R().map(Q=>r.jsxs("option",{value:String(Q),children:[Q,"년"]},Q))]}),r.jsxs("span",{className:"badge",title:"내 목표 배정(TNT)",children:["TNT(배정): ",Je.format(ve.tnt)," 억"]}),r.jsxs("span",{className:"badge",title:"내 목표 배정(DYS)",children:["DYS(배정): ",Je.format(ve.dys)," 억"]}),r.jsx("span",{"aria-hidden":"true",style:{opacity:.4},children:"|"}),r.jsxs("span",{className:"badge",title:"내 목표 계획(TNT)",children:["TNT(계획): ",Je.format(J.tnt)," 억"]}),r.jsxs("span",{className:"badge",title:"내 목표 계획(DYS)",children:["DYS(계획): ",Je.format(J.dys)," 억"]}),r.jsx("span",{"aria-hidden":"true",style:{opacity:.4},children:"|"}),r.jsxs("span",{className:"badge",title:"내 목표 차액(TNT)",children:["TNT(차액): ",Je.format(Pe.tnt)," 억"]}),r.jsxs("span",{className:"badge",title:"내 목표 차액(DYS)",children:["DYS(차액): ",Je.format(Pe.dys)," 억"]})]}),r.jsxs("div",{className:"muted count-text",style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("button",{className:"btn-plain",title:"내 평균거래 단가",onClick:Us,"aria-label":"평균거래 단가 팝업 열기",children:r.jsx("img",{src:Av,className:"icon",alt:"단가"})}),D.toLocaleString(),"개 거래처"]})]}),c&&r.jsx("div",{className:"error",children:c||gt.errorGeneric}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[r.jsxs("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:[r.jsx("div",{className:"card",style:{padding:8,marginBottom:8},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{className:"search-input",placeholder:"거래처명",value:m,onChange:Q=>p(Q.target.value),onKeyDown:Q=>{Q.key==="Enter"&&mt(!0)},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:()=>mt(!0),disabled:o,style:{flex:"0 0 auto"},children:"조회"})]})}),Dr]}),r.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:H.map((Q,ce)=>{const we=ce<q,Me=ce===q;return r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:ce===H.length-1?"0 0 auto":"1 1 0"},children:[r.jsx("div",{title:Q.label,onClick:()=>B(Q.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:we||Me?"var(--accent)":"transparent",border:`2px solid ${we||Me?"var(--accent)":"var(--border)"}`,color:we||Me?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":Me?"step":void 0,children:we?"✓":ce+1}),r.jsx("div",{style:{fontSize:12,color:Me||we?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:Q.label}),ce<H.length-1&&r.jsx("div",{style:{height:2,background:ce<q?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},Q.key)})}),r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("button",{className:"btn btn-icon",onClick:K,disabled:q===0,"aria-label":"이전 단계",title:"이전 단계",children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:r.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),r.jsx("button",{className:"btn btn-icon",onClick:W,disabled:q===H.length-1,"aria-label":"다음 단계",title:"다음 단계",children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:r.jsx("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),M==="init"&&r.jsxs("section",{style:{marginTop:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:10},children:[r.jsx("b",{children:"기준매출"}),r.jsxs("select",{value:At,onChange:Q=>Pt(Q.target.value),style:{height:28,padding:"4px 8px",borderRadius:8,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12},"aria-label":"기준 기간 선택",children:[r.jsx("option",{value:"prev1",children:"전년"}),r.jsx("option",{value:"last2",children:"최근2년"}),r.jsx("option",{value:"last3",children:"최근3년"})]})]}),r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[ze&&r.jsx("span",{className:"error",children:ze}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:ae,children:"일괄비율"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:st,children:"일괄입력"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:Ve,children:"신규품목"})]})]}),Zi]})]})]}),zt.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:Or.ref,className:"card",style:{...Or.style,width:720,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[r.jsx("div",{...Or.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:gr,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 120px 1fr",gap:8,alignItems:"center"},children:[r.jsx("div",{className:"muted",children:"중분류"}),r.jsx("div",{children:zt.sub||""}),r.jsx("div",{className:"muted",children:"영업관리단위"}),r.jsx("div",{children:zt.unit||""}),r.jsx("div",{className:"muted",children:"매출월"}),r.jsx("div",{children:r.jsxs("select",{className:"search-input",value:zt.month||"",onChange:Q=>yr(Q.target.value,zt.qty),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(Q,ce)=>ce+1).map(Q=>r.jsxs("option",{value:String(Q),children:[Q,"월"]},Q))]})}),r.jsx("div",{className:"muted",children:"매출 수량"}),r.jsx("div",{children:r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:zt.qty||"",onChange:Q=>yr(zt.month,Q.target.value)})})]}),r.jsx("div",{style:{marginTop:12},children:r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsx("tr",{children:Array.from({length:12},(Q,ce)=>ce+1).map(Q=>r.jsxs("th",{style:{textAlign:"right"},children:[String(Q).padStart(2,"0"),"월"]},Q))})}),r.jsx("tbody",{children:r.jsx("tr",{children:zt.dist.map((Q,ce)=>r.jsx("td",{children:jt(Q)},ce))})})]})})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(단건) — 추후 구현 예정"),children:"목표등록"})})]})}),Pn.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:wi.ref,className:"card",style:{...wi.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[r.jsx("div",{...wi.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:Xn,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h2",{style:{margin:0},children:"목표 일괄입력"})}),r.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:120,textAlign:"left"},children:"매출월"}),r.jsx("th",{style:{width:120,textAlign:"left"},children:"매출 수량"}),Array.from({length:12},(Q,ce)=>ce+1).map(Q=>r.jsxs("th",{style:{textAlign:"right"},children:[String(Q).padStart(2,"0"),"월"]},Q))]})}),r.jsx("tbody",{children:Pn.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:16,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):Pn.rows.map((Q,ce)=>r.jsxs("tr",{children:[r.jsx("td",{children:Q.sub}),r.jsx("td",{children:Q.unit}),r.jsx("td",{children:r.jsxs("select",{className:"search-input",value:Q.month||"",onChange:we=>ji(ce,we.target.value,void 0),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(we,Me)=>Me+1).map(we=>r.jsxs("option",{value:String(we),children:[we,"월"]},we))]})}),r.jsx("td",{children:r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:Q.qty||"",onChange:we=>ji(ce,void 0,we.target.value)})}),Q.dist.map((we,Me)=>r.jsx("td",{children:jt(we)},Me))]},Q.key))})]})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(일괄) — 추후 구현 예정"),children:"목표등록"})})]})}),vr.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:qe.ref,className:"card",style:{...qe.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[r.jsx("div",{...qe.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:je,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsxs("div",{className:"page-title",style:{marginBottom:8,alignItems:"center"},children:[r.jsx("h2",{style:{margin:0},children:"목표 일괄비율"}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsx("span",{className:"muted",children:"적용 비율(%)"}),r.jsx("input",{className:"assign-input",type:"number",min:0,max:100,step:1,placeholder:"0",value:ht,onChange:Q=>Kt(Q.target.value),style:{width:100},"aria-label":"일괄 비율 입력"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("일괄비율 적용 — 추후 개발 예정"),children:"적용"})]})]}),r.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:120,textAlign:"left"},children:"매출월"}),r.jsx("th",{style:{width:120,textAlign:"left"},children:"매출 수량"}),Array.from({length:12},(Q,ce)=>ce+1).map(Q=>r.jsxs("th",{style:{textAlign:"right"},children:[String(Q).padStart(2,"0"),"월"]},Q))]})}),r.jsx("tbody",{children:vr.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:16,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):vr.rows.map((Q,ce)=>r.jsxs("tr",{children:[r.jsx("td",{children:Q.sub}),r.jsx("td",{children:Q.unit}),r.jsx("td",{children:r.jsxs("select",{className:"search-input",value:Q.month||"",onChange:we=>xe(ce,we.target.value,void 0),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(we,Me)=>Me+1).map(we=>r.jsxs("option",{value:String(we),children:[we,"월"]},we))]})}),r.jsx("td",{children:r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:Q.qty||"",onChange:we=>xe(ce,void 0,we.target.value)})}),Q.dist.map((we,Me)=>r.jsx("td",{children:jt(we)},Me))]},Q.key))})]})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(일괄비율) — 추후 구현 예정"),children:"목표등록"})})]})}),ue.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:Ce.ref,className:"card",style:{...Ce.style,width:820,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[r.jsx("div",{...Ce.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:Ge,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h2",{style:{margin:0},children:"신규품목"})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 120px 1fr",gap:8,alignItems:"center"},children:[r.jsx("div",{className:"muted",children:"영업관리단위"}),r.jsx("div",{children:r.jsxs("select",{className:"search-input",value:ue.unit||"",onChange:Q=>nt(Q.target.value),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),ue.opts.map((Q,ce)=>r.jsx("option",{value:Q.salesMgmtUnit,children:Q.salesMgmtUnit},ce))]})}),r.jsx("div",{className:"muted",children:"중분류"}),r.jsx("div",{children:r.jsx("input",{className:"assign-input",value:ue.sub||"",readOnly:!0,placeholder:"자동"})}),r.jsx("div",{className:"muted",children:"매출월"}),r.jsx("div",{children:r.jsxs("select",{className:"search-input",value:ue.month||"",onChange:Q=>Qe(Q.target.value,void 0),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(Q,ce)=>ce+1).map(Q=>r.jsxs("option",{value:String(Q),children:[Q,"월"]},Q))]})}),r.jsx("div",{className:"muted",children:"매출 수량"}),r.jsx("div",{children:r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:ue.qty||"",onChange:Q=>Qe(void 0,Q.target.value)})})]}),r.jsx("div",{style:{marginTop:12},children:r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsx("tr",{children:Array.from({length:12},(Q,ce)=>ce+1).map(Q=>r.jsxs("th",{style:{textAlign:"right"},children:[String(Q).padStart(2,"0"),"월"]},Q))})}),r.jsx("tbody",{children:r.jsx("tr",{children:ue.dist.map((Q,ce)=>r.jsx("td",{children:jt(Q)},ce))})})]})})}),r.jsxs("div",{style:{marginTop:12},children:[r.jsx("div",{className:"pane-header",style:{margin:0},children:"추가된 항목"}),r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),Array.from({length:12},(Q,ce)=>ce+1).map(Q=>r.jsxs("th",{style:{textAlign:"right"},children:[String(Q).padStart(2,"0"),"월"]},Q))]})}),r.jsx("tbody",{children:ue.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:14,className:"muted",style:{padding:"12px 10px"},children:"추가된 항목이 없습니다"})}):ue.rows.map((Q,ce)=>r.jsxs("tr",{children:[r.jsx("td",{children:Q.sub}),r.jsx("td",{children:Q.unit}),Q.months.map((we,Me)=>r.jsx("td",{children:jt(we)},Me))]},ce))})]})})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:[r.jsx("button",{className:"btn btn-card btn-3d",onClick:Rt,children:"추가"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(신규품목) — 추후 구현 예정"),children:"목표등록"})]})]})}),dn.open&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:60},children:r.jsxs("div",{ref:ri.ref,className:"card",style:{...ri.style,height:"66vh",width:460,maxWidth:"92vw",background:"var(--panel)",padding:12,borderLeft:"1px solid var(--border)",boxShadow:"-8px 0 24px rgba(0,0,0,0.18)",overflow:"auto"},children:[r.jsx("div",{...ri.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:Hs,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h2",{style:{margin:0},children:"내 평균거래 단가"})}),dn.error?r.jsx("div",{className:"error",style:{maxWidth:420},children:dn.error}):r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:280,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:180,textAlign:"right"},children:"합계(원)"})]})}),r.jsx("tbody",{children:dn.loading?r.jsx("tr",{children:r.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"불러오는 중…"})}):dn.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):dn.rows.map((Q,ce)=>r.jsxs("tr",{children:[r.jsx("td",{children:Q.unit||"na"}),r.jsxs("td",{style:{textAlign:"right"},children:[Je.format(Math.round(Q.amount))," 원"]})]},ce))})]})})]})})]})}function QS(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const n=String(t.getFullYear()%100).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${n}-${i}-${a} ${s}:${o}`}function JS(){const[e,t]=h.useState(""),[n,i]=h.useState(""),[a,s]=h.useState(""),[o,l]=h.useState(!1),[c,d]=h.useState(null),[u,f]=h.useState([]),[m,p]=h.useState(""),[y,v]=h.useState(!1),[g,b]=h.useState({open:!1,x:0,y:0}),[x,N]=h.useState(()=>new Set),[A,C]=h.useState({open:!1,x:0,y:0}),[w,O]=h.useState(void 0),[M,B]=h.useState("init"),[z,j]=h.useState({}),[k,L]=h.useState("TNT"),[T,$]=h.useState({}),V=100,[G,ne]=h.useState(0),[U,I]=h.useState(!0),[P,D]=h.useState(!1),S=Te.useRef(null),[_,H]=h.useState(0),[q,K]=h.useState({show:!1,name:"",tnt:0,dys:0,year:0}),[W,R]=h.useState(!1),[oe,Y]=h.useState({tnt:0,dys:0}),X=["init","sim","confirm"],de=[{key:"init",label:"초기설정"},{key:"sim",label:"계획 수립 중"},{key:"confirm",label:"확정"}],be=X.indexOf(M);function ke(){const E=[];for(let F=2030;F>=2026;F--)E.push(F);return E}const[ve,Ie]=h.useState(""),[J,ge]=h.useState(!1),[Pe,Se]=h.useState(null),[Je,yt]=h.useState({tnt:0,dys:0}),[jt,It]=h.useState({tnt:0,dys:0}),[ye,Ae]=h.useState({tnt:0,dys:0}),[Oe,Fe]=h.useState({tnt:0,dys:0}),[ze,at]=h.useState({open:!1,company:"TNT",group:"customer",loading:!1,error:null,rows:[]}),[At,Pt]=h.useState({x:0,y:0}),Ze=new Intl.NumberFormat("ko-KR"),nn=new Intl.NumberFormat("ko-KR",{minimumFractionDigits:2,maximumFractionDigits:2}),[Ht,Yt]=h.useState(null),[Ct,yn]=h.useState({val:"",loading:!1,saving:!1,error:null,success:null});async function or(){try{const E=Number(ve),F=Number((w==null?void 0:w.customerSeq)||0),ee=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!ee||!Number.isFinite(E)||E<=0||!F){yn(se=>({...se,val:"",loading:!1,error:null}));return}yn(se=>({...se,loading:!0,error:null}));const re=new URL("/api/v1/sales/plan/plan-remark",window.location.origin);re.searchParams.set("year",String(E)),re.searchParams.set("customerSeq",String(F));const te=await fetch(re.toString(),{headers:{"X-ASSIGNEE-ID":ee}});if(!te.ok)throw new Error(`HTTP ${te.status}`);const Z=await te.json().catch(()=>({})),le=String((Z==null?void 0:Z.remark)??"");yn({val:le,loading:!1,saving:!1,error:null,success:null})}catch(E){yn(F=>({...F,loading:!1,error:(E==null?void 0:E.message)||"조회 오류"}))}}async function Ji(){try{const E=Number(ve),F=Number((w==null?void 0:w.customerSeq)||0),ee=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!ee){alert("로그인이 필요합니다.");return}if(!Number.isFinite(E)||E<=0){alert("연도를 선택하세요.");return}if(!F){alert("거래처를 선택하세요.");return}yn(le=>({...le,saving:!0,error:null,success:null}));const re={"Content-Type":"application/json","X-ASSIGNEE-ID":ee},te=JSON.stringify({year:E,customerSeq:F,remark:Ct.val}),Z=await fetch("/api/v1/sales/plan/plan-remark",{method:"POST",headers:re,body:te});if(!Z.ok){let le=await Z.text().catch(()=>"");throw new Error(le||"HTTP "+Z.status)}yn(le=>({...le,saving:!1,success:"저장되었습니다."})),setTimeout(()=>yn(le=>({...le,success:null})),1200)}catch(E){yn(F=>({...F,saving:!1,error:(E==null?void 0:E.message)||"저장 오류"}))}}h.useEffect(()=>{w!=null&&w.customerSeq&&ve&&or()},[w==null?void 0:w.customerSeq,ve]);async function Zi(){try{const E=Number(ve),F=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),ee=Number((w==null?void 0:w.customerSeq)||0);if(!F){alert("로그인이 필요합니다.");return}if(!Number.isFinite(E)||E<=0){alert("연도를 선택하세요.");return}if(!ee){alert("거래처를 선택하세요.");return}const re={year:E,companyType:k,assigneeId:F,customerSeq:ee},te={"Content-Type":"application/json","X-ASSIGNEE-ID":F},Z=(localStorage.getItem("tnt.sales.empId")||"").trim();Z&&(te["X-EMP-ID"]=Z);const le=await fetch("/api/v1/sales/plan/confirm-customer",{method:"POST",headers:te,body:JSON.stringify(re)});if(!le.ok){let se=await le.text().catch(()=>"");throw new Error(se||"HTTP "+le.status)}await le.json().catch(()=>({})),B("confirm"),Si(se=>se+1);try{const se=String((w==null?void 0:w.customerName)||""),ie=String(ve||"");Yt(se&&ie?`${se} ${ie}년 목표 수립이 완료되었습니다.`:"목표 수립이 완료되었습니다.")}catch{Yt("목표 수립이 완료되었습니다.")}}catch(E){alert((E==null?void 0:E.message)||"확정 처리 중 오류가 발생했습니다")}}const[zt,pr]=h.useState(!1),[Ma,gr]=h.useState(""),[yr,Pn]=h.useState("TNT");function lr(E,F){return Number.isFinite(E)?E:0}function st(E,F,ee,re,te){const Z=Number.isFinite(E)&&E>0,le=Z&&Number.isFinite(ee),se=le?Number(ee):Z?lr(E):0,ie=Z?nn.format(Number(E)):"-",fe=Z?le?`${nn.format(Number(se))} 원`:"-":"";return r.jsxs("div",{style:{textAlign:"right",lineHeight:1.15,color:re||void 0},children:[r.jsx("div",{style:{fontWeight:te?700:void 0},children:ie}),r.jsx("div",{className:te?void 0:"muted",style:{fontSize:11,color:re||void 0,fontWeight:te?700:void 0},children:fe})]})}async function Xn(E,F){try{const ee=Number(ve),re=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!re||!Number.isFinite(ee)||ee<=0){at(ie=>({...ie,rows:[],error:null,loading:!1}));return}at(ie=>({...ie,loading:!0,error:null}));const te=new URL("/api/v1/sales/plan/totals-breakdown",window.location.origin);te.searchParams.set("year",String(ee)),te.searchParams.set("assigneeId",re),te.searchParams.set("companyType",E),te.searchParams.set("groupBy",F);const Z=await fetch(te.toString());if(!Z.ok){let ie=await Z.text().catch(()=>"");throw new Error(ie||"HTTP "+Z.status)}const le=await Z.json().catch(()=>[]),se=(Array.isArray(le)?le:[]).map(ie=>({key:String((ie==null?void 0:ie.key)??""),label:ie!=null&&ie.label?String(ie.label):void 0,amount:Number((ie==null?void 0:ie.amount)??0)}));at(ie=>({...ie,rows:se,loading:!1,error:null}))}catch(ee){at(re=>({...re,loading:!1,error:(ee==null?void 0:ee.message)||"조회 오류",rows:[]}))}}function ji(E,F){if(F)try{Pt({x:F.clientX||0,y:F.clientY||0})}catch{}at({open:!0,company:E,group:"customer",loading:!1,error:null,rows:[]}),Xn(E,"customer")}function Tr(){at(E=>({...E,open:!1}))}async function La(){ge(!0),Se(null);try{const E=(localStorage.getItem("tnt.sales.empName")||"").trim();if(!E){yt({tnt:0,dys:0}),Se("로그인이 필요합니다");return}if(!ve||isNaN(Number(ve))){yt({tnt:0,dys:0});return}const F=new URL("/api/v1/targets/assigned",window.location.origin);F.searchParams.set("year",String(ve)),F.searchParams.set("empNames",E);try{const le=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),se=le==="moderate"?"2":le==="best"?"1":"";se&&F.searchParams.set("versionNo",se)}catch{}const ee=await fetch(F.toString());if(!ee.ok)throw new Error(`HTTP ${ee.status}`);const re=await ee.json().catch(()=>[]),te=Array.isArray(re)?re.find(le=>String(le.company_name||"").toUpperCase()==="TNT"):null,Z=Array.isArray(re)?re.find(le=>String(le.company_name||"").toUpperCase()==="DYS"):null;yt({tnt:Math.round(Number((te==null?void 0:te.assigned_amount)||0)),dys:Math.round(Number((Z==null?void 0:Z.assigned_amount)||0)),tntStage:String((te==null?void 0:te.target_stage)||"").trim()||void 0,dysStage:String((Z==null?void 0:Z.target_stage)||"").trim()||void 0})}catch(E){Se((E==null?void 0:E.message)||"조회 오류"),yt({tnt:0,dys:0})}finally{ge(!1)}}const[Or,wi]=h.useState(0);h.useEffect(()=>{const E=()=>wi(F=>F+1);return window.addEventListener("tnt.sales.assign.mode.changed",E),()=>window.removeEventListener("tnt.sales.assign.mode.changed",E)},[]),h.useEffect(()=>{La()},[ve,Or]),h.useEffect(()=>{(async()=>{try{const E=Number(ve),F=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!F||!Number.isFinite(E)||E<=0){Ae({tnt:0,dys:0});return}const ee=new URL("/api/v1/sales/plan/totals-by-assignee",window.location.origin);ee.searchParams.set("year",String(E)),ee.searchParams.set("assigneeId",F);const re=await fetch(ee.toString());if(!re.ok)throw new Error(`HTTP ${re.status}`);const te=await re.json().catch(()=>[]);let Z=0,le=0;Array.isArray(te)&&te.forEach(se=>{const ie=String((se==null?void 0:se.company_type)||(se==null?void 0:se.companyType)||"").toUpperCase(),fe=Number((se==null?void 0:se.amount)||0);ie==="TNT"?Z+=fe:ie==="DYS"&&(le+=fe)}),Ae({tnt:Math.round(Z),dys:Math.round(le)})}catch{Ae({tnt:0,dys:0})}})()},[ve]),h.useEffect(()=>{async function E(){try{R(!1);const F=Number(ve);if(!Number.isFinite(F)||F<=0){K(Ye=>({...Ye,show:!1})),R(!0);return}const ee=localStorage.getItem("tnt.sales.assigneeId")||"",re=localStorage.getItem("tnt.sales.empId")||"",te=new URL("/api/v1/sales/plan/status",window.location.origin);te.searchParams.set("year",String(F)),ee?te.searchParams.set("assigneeId",ee):re&&te.searchParams.set("empId",re);const Z=await fetch(te.toString());if(!Z.ok){K(Ye=>({...Ye,show:!1})),R(!0);return}const le=await Z.json().catch(()=>({})),se=(localStorage.getItem("tnt.sales.empName")||"").trim()||"사용자",ie=Number((le==null?void 0:le.tnt)||0),fe=Number((le==null?void 0:le.dys)||0),me=!!(le!=null&&le.hasP),he=!!(le!=null&&le.hasC),_e=!!(le!=null&&le.hasI);let Ne="";he&&!me&&!_e?Ne="목표수립완료":_e&&!me&&!he?Ne="초기설정완료":(me||he&&_e)&&(Ne="계획수립 중"),K({show:!!Ne,name:se,tnt:ie,dys:fe,year:F,label:Ne,hasP:me,hasC:he,hasI:_e}),B(he&&!me&&!_e?"confirm":me?"sim":"init"),R(!0)}catch{K(ee=>({...ee,show:!1})),R(!0)}}E()},[ve]);const[vr,Si]=h.useState(0),[ht,Kt]=h.useState({loading:!1,error:null,rows:[]});h.useEffect(()=>{const E=Number((w==null?void 0:w.customerSeq)||0),F=Number(ve);if(!E||!Number.isFinite(F)||F<=0){Kt({loading:!1,error:null,rows:[]});return}let ee=!1;return(async()=>{try{Kt(ie=>({...ie,loading:!0,error:null}));const re=localStorage.getItem("tnt.sales.assigneeId")||"",te=new URL("/api/v1/sales/plan/customer-monthly-rows",window.location.origin);te.searchParams.set("year",String(F)),te.searchParams.set("customerSeq",String(E)),k&&te.searchParams.set("companyType",k),re&&te.searchParams.set("assigneeId",re);const Z=await fetch(te.toString());if(!Z.ok){let ie=`HTTP ${Z.status}`;try{const fe=await Z.json();fe!=null&&fe.error&&(ie=fe.error)}catch{}throw new Error(ie)}const le=await Z.json().catch(()=>[]),se=(Array.isArray(le)?le:[]).map(ie=>({sub:String((ie==null?void 0:ie.item_subcategory)??(ie==null?void 0:ie.itemSubcategory)??""),unit:String((ie==null?void 0:ie.sales_mgmt_unit)??(ie==null?void 0:ie.salesMgmtUnit)??""),months:Array.from({length:12},(fe,me)=>Number((ie==null?void 0:ie[`qty_${String(me+1).padStart(2,"0")}`])??0)),amounts:Array.from({length:12},(fe,me)=>Number((ie==null?void 0:ie[`amount_${String(me+1).padStart(2,"0")}`])??0)),type:String((ie==null?void 0:ie.plan_type)||(ie==null?void 0:ie.planType)||"").toUpperCase()==="P"?"P":"B",stage:String((ie==null?void 0:ie.target_stage)||(ie==null?void 0:ie.targetStage)||"").toUpperCase()||void 0}));ee||Kt({loading:!1,error:null,rows:se})}catch(re){ee||Kt({loading:!1,error:(re==null?void 0:re.message)||"오류",rows:[]})}})(),()=>{ee=!0}},[w==null?void 0:w.customerSeq,ve,k,vr]),h.useEffect(()=>{try{if(!Number((w==null?void 0:w.customerSeq)||0))return;const F=Array.isArray(ht.rows)?ht.rows:[];if(!F.length){B("init");return}const ee=F.some(Z=>String((Z==null?void 0:Z.type)||"").toUpperCase()==="P"),re=F.map(Z=>String((Z==null?void 0:Z.stage)||"").toUpperCase()).filter(Boolean),te=re.length>0&&re.every(Z=>Z==="C");B(te?"confirm":ee?"sim":"init")}catch{}},[w==null?void 0:w.customerSeq,ht.rows]);const[ae,je]=h.useState({open:!1,dist:new Array(12).fill(0),curMonths:new Array(12).fill(0),curAmounts:new Array(12).fill(0),success:null}),[xe,qe]=h.useState({}),[ue,Re]=h.useState({}),[Ce,Ve]=h.useState({});function Ge(E){return String(E||"").trim().toUpperCase()}function nt(E){try{const F=Qe(),re=(xe[F]||{})[Ge(E)];if(Number.isFinite(re)&&Number(re)>0)return Number(re);const te=mt(),le=((ue==null?void 0:ue[te])||{})[Ge(E)];return Number.isFinite(le)&&Number(le)>0?Number(le):void 0}catch{return}}function Qe(){const E=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),F=Number(ve),ee=new Date().getFullYear()-1,re=Number.isFinite(F)&&F>0?F-1:ee;return`${E}|${k||""}|${re}`}async function Rt(){try{const E=Qe();if(!E||xe[E])return;const[F,ee,re]=E.split("|"),te=Number(re);if(!F||!ee||!Number.isFinite(te)||te<=0)return;const Z=new URL("/api/v1/dashboard/avg-unit-price-by-emp",window.location.origin);Z.searchParams.set("assigneeId",F),Z.searchParams.set("companyType",ee),Z.searchParams.set("year",String(te));const le=await fetch(Z.toString());if(!le.ok)return;const se=await le.json().catch(()=>[]),ie={},fe={};Array.isArray(se)&&se.forEach(me=>{const he=Ge((me==null?void 0:me.sales_mgmt_unit)||(me==null?void 0:me.salesMgmtUnit)),_e=Number((me==null?void 0:me.avg_unit_price)||(me==null?void 0:me.avgUnitPrice)||0);he&&(ie[he]=_e),he&&(fe[he]={itemUnit:String((me==null?void 0:me.item_unit)||(me==null?void 0:me.itemUnit)||""),itemStdUnit:String((me==null?void 0:me.item_std_unit)||(me==null?void 0:me.itemStdUnit)||"")})}),qe(me=>({...me,[E]:ie})),Ve(me=>({...me,[E]:fe}))}catch{}}function mt(){const E=Number(ve),F=new Date().getFullYear()-1,ee=Number.isFinite(E)&&E>0?E-1:F;return`${k||""}|${ee}`}async function dt(){try{const E=mt();if(!E||ue[E])return;const[F,ee]=E.split("|"),re=Number(ee);if(!F||!Number.isFinite(re)||re<=0)return;const te=new URL("/api/v1/dashboard/avg-unit-price",window.location.origin);te.searchParams.set("companyType",F),te.searchParams.set("year",String(re));const Z=await fetch(te.toString());if(!Z.ok)return;const le=await Z.json().catch(()=>[]),se={};Array.isArray(le)&&le.forEach(ie=>{const fe=Ge((ie==null?void 0:ie.sales_mgmt_unit)||(ie==null?void 0:ie.salesMgmtUnit)),me=Number((ie==null?void 0:ie.avg_unit_price)||(ie==null?void 0:ie.avgUnitPrice)||0);fe&&(se[fe]=me)}),Re(ie=>({...ie,[E]:se}))}catch{}}async function Dr(E){try{await dt()}catch{}}async function dn(E){try{const F=Qe();if(!F)return;const[ee,re,te]=F.split("|"),Z=Number(te);if(!ee||!re||!Number.isFinite(Z)||Z<=0)return;const le=new URL("/api/v1/dashboard/avg-unit-price-by-emp",window.location.origin);le.searchParams.set("assigneeId",ee),le.searchParams.set("companyType",re),le.searchParams.set("year",String(Z));const se=await fetch(le.toString());if(!se.ok)return;const ie=await se.json().catch(()=>[]);let fe=null;if(Array.isArray(ie)){const me=Ge(E);fe=ie.find(he=>Ge((he==null?void 0:he.sales_mgmt_unit)||(he==null?void 0:he.salesMgmtUnit))===me)}if(fe){const me=Ge((fe==null?void 0:fe.sales_mgmt_unit)||(fe==null?void 0:fe.salesMgmtUnit)),he=Number((fe==null?void 0:fe.avg_unit_price)||(fe==null?void 0:fe.avgUnitPrice)||0),_e={itemUnit:String((fe==null?void 0:fe.item_unit)||(fe==null?void 0:fe.itemUnit)||""),itemStdUnit:String((fe==null?void 0:fe.item_std_unit)||(fe==null?void 0:fe.itemStdUnit)||"")};qe(Ne=>({...Ne,[F]:{...Ne[F]||{},[me]:he}})),Ve(Ne=>({...Ne,[F]:{...Ne[F]||{},[me]:_e}}))}}catch{}}function ni(E,F){const ee=(ht.rows||[]).find(Z=>Z.sub===E&&Z.unit===F),re=ee!=null&&ee.months?ee.months.slice():new Array(12).fill(0),te=ee!=null&&ee.amounts?ee.amounts.slice():new Array(12).fill(0);je({open:!0,sub:E,unit:F,stage:ee==null?void 0:ee.stage,month:"",qty:"",dist:new Array(12).fill(0),curMonths:re,curAmounts:te,success:null});try{Rt()}catch{}try{dt()}catch{}}function ri(){je({open:!1,dist:new Array(12).fill(0),curMonths:new Array(12).fill(0),curAmounts:new Array(12).fill(0),success:null})}function Us(E,F){const ee=Number(E),re=Number(F),te=new Array(12).fill(0);if(Number.isFinite(ee)&&ee>=1&&ee<=12&&Number.isFinite(re)&&re>0){const Z=12-ee+1,le=re/Z;for(let se=ee-1;se<12;se++)te[se]=le}je(Z=>({...Z,month:E,qty:F,dist:te}))}async function Hs(){try{const E=Number(ve),F=k,ee=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),re=Number((w==null?void 0:w.customerSeq)||0),te=(ae.sub||"").trim(),Z=(ae.unit||"").trim();if(!Number.isFinite(E)||E<=0){alert("연도를 선택하세요.");return}if(!ee){alert("로그인이 필요합니다.");return}if(!re||!te||!Z){alert("거래처/중분류/영업관리단위가 필요합니다.");return}const le=(ae.dist||[]).map(he=>{const _e=Number(he);return!Number.isFinite(_e)||_e<=0?0:Math.round(_e*100)/100});if(!le.some(he=>he>0)&&!(ae.month&&Number(ae.month)>0)){alert("매출월을 선택하세요.");return}const se={year:E,companyType:F,assigneeId:ee,customerSeq:re,itemSubcategory:te,salesMgmtUnit:Z,qty:le},ie={"Content-Type":"application/json","X-ASSIGNEE-ID":ee},fe=(localStorage.getItem("tnt.sales.empId")||"").trim();fe&&(ie["X-EMP-ID"]=fe);const me=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:ie,body:JSON.stringify(se)});if(!me.ok){let he=await me.text().catch(()=>"");throw new Error(he||"HTTP "+me.status)}je(he=>({...he,success:"목표가 변경되었습니다"}))}catch(E){alert((E==null?void 0:E.message)||"저장 중 오류가 발생했습니다")}}async function Q(){try{const E=Number(ve),F=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),ee=Number((w==null?void 0:w.customerSeq)||0);if(Number.isFinite(E)&&E>0&&F&&ee){const re=new URL("/api/v1/sales/plan/customer-monthly-rows",window.location.origin);re.searchParams.set("year",String(E)),re.searchParams.set("customerSeq",String(ee)),k&&re.searchParams.set("companyType",k),re.searchParams.set("assigneeId",F);const te=await fetch(re.toString());if(te.ok){const Z=await te.json().catch(()=>[]),le=(Array.isArray(Z)?Z:[]).map(se=>({sub:String((se==null?void 0:se.item_subcategory)??(se==null?void 0:se.itemSubcategory)??""),unit:String((se==null?void 0:se.sales_mgmt_unit)??(se==null?void 0:se.salesMgmtUnit)??""),months:Array.from({length:12},(ie,fe)=>Number((se==null?void 0:se[`qty_${String(fe+1).padStart(2,"0")}`])??0)),amounts:Array.from({length:12},(ie,fe)=>Number((se==null?void 0:se[`amount_${String(fe+1).padStart(2,"0")}`])??0)),type:String((se==null?void 0:se.plan_type)||(se==null?void 0:se.planType)||"").toUpperCase()==="P"?"P":"B",stage:String((se==null?void 0:se.target_stage)||(se==null?void 0:se.targetStage)||"").toUpperCase()||void 0}));Kt({loading:!1,error:null,rows:le})}}}catch{}ri();try{He()}catch{}try{ii()}catch{}try{Ks()}catch{}}const[ce,we]=h.useState({open:!1,rows:[],success:null});function Me(){const E=(ht.rows||[]).map((F,ee)=>({key:`${F.sub}||${F.unit}||${ee}`,sub:F.sub,unit:F.unit,stage:F.stage,type:F.type,month:"",qty:"",dist:new Array(12).fill(0),curMonths:F.months?F.months.slice():new Array(12).fill(0),curAmounts:F.amounts?F.amounts.slice():new Array(12).fill(0)}));we({open:!0,rows:E,success:null});try{Rt()}catch{}try{dt()}catch{}}function He(){we({open:!1,rows:[],success:null})}function De(E,F,ee){we(re=>{const te=re.rows.slice(),Z={...te[E]},le=Number(F??Z.month),se=Number(ee??Z.qty),ie=new Array(12).fill(0);if(Number.isFinite(le)&&le>=1&&le<=12&&Number.isFinite(se)&&se>0){const fe=12-le+1,me=se/fe;for(let he=le-1;he<12;he++)ie[he]=me}return Z.month=F??Z.month,Z.qty=ee??Z.qty,Z.dist=ie,te[E]=Z,{...re,rows:te}})}async function Le(){try{const E=Number(ve),F=k,ee=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),re=Number((w==null?void 0:w.customerSeq)||0);if(!Number.isFinite(E)||E<=0){alert("연도를 선택하세요.");return}if(!ee){alert("로그인이 필요합니다.");return}if(!re){alert("거래처를 선택하세요.");return}const te={"Content-Type":"application/json","X-ASSIGNEE-ID":ee},Z=(localStorage.getItem("tnt.sales.empId")||"").trim();Z&&(te["X-EMP-ID"]=Z);const le=(ce.rows||[]).filter(se=>!!se.month&&Number(se.month)>0);if(le.length===0){alert("매출월을 선택한 행이 없습니다.");return}for(const se of le){const ie=Number(se.month),fe=Number(se.qty||0),me=new Array(12).fill(0);if(Number.isFinite(ie)&&ie>=1&&ie<=12){const Ye=12-ie+1,Ue=Number.isFinite(fe)&&fe>0?fe/Ye:0;for(let tt=ie-1;tt<12;tt++)me[tt]=Ue}const he=me.map(Ye=>{const Ue=Number(Ye);return!Number.isFinite(Ue)||Ue<=0?0:Math.round(Ue*100)/100}),_e={year:E,companyType:F,assigneeId:ee,customerSeq:re,itemSubcategory:se.sub,salesMgmtUnit:se.unit,qty:he},Ne=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:te,body:JSON.stringify(_e)});if(!Ne.ok){let Ye=await Ne.text().catch(()=>"");throw new Error(Ye||"HTTP "+Ne.status)}}we(se=>({...se,success:"목표가 변경되었습니다"}))}catch(E){alert((E==null?void 0:E.message)||"저장 중 오류가 발생했습니다")}}function Ke(E){try{const F=E.getBoundingClientRect(),ee=(F==null?void 0:F.width)||E.offsetWidth||600,re=(F==null?void 0:F.height)||E.offsetHeight||400,te=Math.max(0,Math.round((window.innerWidth-ee)/2)),le=Math.max(0,Math.round(window.innerHeight-re-40));return{x:te,y:le}}catch{const F=Math.max(0,Math.round((window.innerWidth-600)/2)),re=Math.max(0,Math.round(window.innerHeight-400-40));return{x:F,y:re}}}function vt(E){try{const F=E.getBoundingClientRect(),ee=(F==null?void 0:F.width)||E.offsetWidth||600,re=(F==null?void 0:F.height)||E.offsetHeight||400,te=Math.max(0,Math.round((window.innerWidth-ee)/2)),Z=Math.max(0,Math.round((window.innerHeight-re)/2));return{x:te,y:Z}}catch{const re=Math.max(0,Math.round((window.innerWidth-600)/2)),te=Math.max(0,Math.round((window.innerHeight-400)/2));return{x:re,y:te}}}function rn(E){try{const F=E.getBoundingClientRect(),ee=(F==null?void 0:F.width)||E.offsetWidth||460,re=Math.max(0,Math.round(window.innerWidth-ee)),te=Math.max(0,Math.round(window.innerHeight*.17));return{x:re,y:te}}catch{const ee=Math.max(0,Math.round(window.innerWidth-460)),re=Math.max(0,Math.round(window.innerHeight*.17));return{x:ee,y:re}}}const xn=Dn("sales-plan-target-input",!!ae.open,Ke,{persist:!1,resetOnOpen:!0}),rt=Dn("sales-plan-bulk-input",!!ce.open,vt,{persist:!1,resetOnOpen:!0}),[Tt,Ni]=h.useState({open:!1,rows:[],success:null}),[$a,Ys]=h.useState("");function An(){const E=(ht.rows||[]).map((F,ee)=>({key:`${F.sub}||${F.unit}||${ee}`,sub:F.sub,unit:F.unit,stage:F.stage,type:F.type,month:"",qty:"",dist:new Array(12).fill(0),curMonths:F.months?F.months.slice():new Array(12).fill(0),curAmounts:F.amounts?F.amounts.slice():new Array(12).fill(0)}));Ni({open:!0,rows:E,success:null});try{Rt()}catch{}try{dt()}catch{}}function ii(){Ni({open:!1,rows:[],success:null})}function xr(){const E=Number($a);if(!Number.isFinite(E)){alert("적용 비율(%)을 입력하세요.");return}let F=1+E/100;(!Number.isFinite(F)||F<0)&&(F=0),Ni(ee=>{const re=(ee.rows||[]).map(te=>{const Z=te.curMonths||[],le=Array.from({length:12},(se,ie)=>{const fe=Number(Z[ie]||0);return Number.isFinite(fe)?fe*F:0});return{...te,dist:le}});return{...ee,rows:re}})}const za=Dn("sales-plan-bulk-ratio",!!Tt.open,vt,{persist:!1,resetOnOpen:!0});async function Dc(){try{const E=Number(ve),F=k,ee=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),re=Number((w==null?void 0:w.customerSeq)||0);if(!Number.isFinite(E)||E<=0){alert("연도를 선택하세요.");return}if(!ee){alert("로그인이 필요합니다.");return}if(!re){alert("거래처를 선택하세요.");return}const te={"Content-Type":"application/json","X-ASSIGNEE-ID":ee},Z=(localStorage.getItem("tnt.sales.empId")||"").trim();Z&&(te["X-EMP-ID"]=Z);const le=(Tt.rows||[]).filter(se=>(se.dist||[]).some(ie=>Number(ie)>0));if(le.length===0){alert("적용 비율을 먼저 적용하세요.");return}for(const se of le){const ie=(se.dist||[]).map(he=>{const _e=Number(he);return!Number.isFinite(_e)||_e<=0?0:Math.round(_e*100)/100}),fe={year:E,companyType:F,assigneeId:ee,customerSeq:re,itemSubcategory:se.sub,salesMgmtUnit:se.unit,qty:ie},me=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:te,body:JSON.stringify(fe)});if(!me.ok){let he=await me.text().catch(()=>"");throw new Error(he||"HTTP "+me.status)}}Ni(se=>({...se,success:"목표가 변경되었습니다"}))}catch(E){alert((E==null?void 0:E.message)||"저장 중 오류가 발생했습니다")}}const[it,Rn]=h.useState({open:!1,loading:!1,error:null,success:null,opts:[],dist:new Array(12).fill(0),rows:[]}),Ra=Dn("sales-plan-new-item",!!it.open,vt,{persist:!1,resetOnOpen:!0});function Rw(E){try{const F=E.getBoundingClientRect(),ee=(F==null?void 0:F.width)||E.offsetWidth||480,re=(F==null?void 0:F.height)||E.offsetHeight||300,te=12;let Z=Math.round(At.x-Math.min(ee/2,240)),le=Math.round(At.y+te);return Z=Math.max(8,Math.min(Z,window.innerWidth-ee-8)),le=Math.max(8,Math.min(le,window.innerHeight-re-8)),{x:Z,y:le}}catch{const F=Math.max(8,Math.min(At.x,window.innerWidth-500)),ee=Math.max(8,Math.min(At.y,window.innerHeight-320));return{x:F,y:ee}}}const _c=Dn("plan-totals-breakdown",ze.open,Rw,{persist:!1,resetOnOpen:!0});async function um(){Rn(E=>({...E,open:!0,loading:!0,error:null,unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0),rows:[]}));try{const E=await fetch("/api/v1/items/dim"),F=E.ok?await E.json():[],ee=Array.isArray(F)?F.map(Z=>({itemSubcategory:String(Z.itemSubcategory||Z.item_subcategory||""),salesMgmtUnit:String(Z.salesMgmtUnit||Z.sales_mgmt_unit||"")})):[],re={};ee.forEach(Z=>{const le=Z.salesMgmtUnit.trim();le&&!re[le]&&(re[le]=Z)});const te=Object.values(re).sort((Z,le)=>Z.salesMgmtUnit.localeCompare(le.salesMgmtUnit));Rn(Z=>({...Z,loading:!1,opts:te}));try{Rt()}catch{}}catch(E){Rn(F=>({...F,loading:!1,error:(E==null?void 0:E.message)||"조회 오류",opts:[]}))}}h.useEffect(()=>{if(it.open){try{Rt()}catch{}try{dt()}catch{}}},[it.open,ve,k]);function Ks(){Rn({open:!1,loading:!1,error:null,success:null,opts:[],dist:new Array(12).fill(0),rows:[]})}function Bw(E){const F=it.opts.find(ee=>ee.salesMgmtUnit===E);Rn(ee=>({...ee,unit:E,sub:(F==null?void 0:F.itemSubcategory)||ee.sub}));try{Rt()}catch{}try{dn(E)}catch{}try{Dr(E)}catch{}}function dm(E,F){const ee=Number(E??it.month),re=Number(F??it.qty),te=new Array(12).fill(0);if(Number.isFinite(ee)&&ee>=1&&ee<=12&&Number.isFinite(re)&&re>0){const Z=12-ee+1,le=re/Z;for(let se=ee-1;se<12;se++)te[se]=le}Rn(Z=>({...Z,month:E??Z.month,qty:F??Z.qty,dist:te}))}function Ww(){const E=(it.unit||"").trim(),F=(it.sub||"").trim(),ee=it.month,re=it.qty;if(!E||!ee||!re){alert("영업관리단위, 매출월, 매출 수량을 입력하세요.");return}const te={sub:F||"(신규)",unit:E,months:it.dist.slice()};Rn(Z=>{const le=Z.rows.slice(),se=le.findIndex(ie=>(ie.unit||"").trim()===E&&(ie.sub||"").trim()===(te.sub||"").trim());return se>=0?le[se]={...le[se],sub:te.sub,unit:te.unit,months:te.months.slice()}:le.push(te),{...Z,rows:le,unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0)}})}async function Fw(){try{const E=Number(ve),F=k,ee=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),re=Number((w==null?void 0:w.customerSeq)||0);if(!Number.isFinite(E)||E<=0){alert("연도를 선택하세요.");return}if(!ee){alert("로그인이 필요합니다.");return}if(!re){alert("거래처를 선택하세요.");return}const te=it.rows||[];if(!te.length){alert("추가된 영업관리단위가 없습니다.");return}const Z=new Set((ht.rows||[]).map(fe=>`${String(fe.sub||"").trim()}||${String(fe.unit||"").trim()}`).filter(fe=>!!fe&&fe!=="||")),le=te.map(fe=>({sub:String(fe.sub||"").trim(),unit:String(fe.unit||"").trim()})).filter(fe=>fe.sub&&fe.unit&&Z.has(`${fe.sub}||${fe.unit}`)).map(fe=>fe.unit);if(le.length>0){Rn(fe=>({...fe,error:`${le.join(", ")} 이미 목표에 등록되어 있습니다. 목표 수정을 통해 작업 하세요.`}));return}const se={"Content-Type":"application/json","X-ASSIGNEE-ID":ee},ie=(localStorage.getItem("tnt.sales.empId")||"").trim();ie&&(se["X-EMP-ID"]=ie);for(const fe of te){const me=(fe.months||[]).map(Bt=>{const ft=Number(Bt);return!Number.isFinite(ft)||ft<=0?0:Math.round(ft*100)/100}),he=String(fe.unit||"").trim(),_e=nt(he),Ne=Number.isFinite(_e)?Math.round(Number(_e)):0,Ye=me.map(Bt=>Number.isFinite(Bt)&&Ne>0?Math.round(Number(Bt)*Ne):0),Ue={year:E,companyType:F,assigneeId:ee,customerSeq:re,itemSubcategory:fe.sub,salesMgmtUnit:fe.unit,qty:me,amount:Ye},tt=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:se,body:JSON.stringify(Ue)});if(!tt.ok){let Bt=await tt.text().catch(()=>"");throw new Error(Bt||"HTTP "+tt.status)}}Rn(fe=>({...fe,success:"목표가 변경되었습니다"}))}catch(E){alert((E==null?void 0:E.message)||"저장 중 오류가 발생했습니다")}}h.useEffect(()=>{if(!ae.open&&!ce.open&&!it.open)return;const E=F=>{F.key==="Escape"&&(ae.open&&ri(),ce.open&&He(),it.open&&Ks())};return window.addEventListener("keydown",E,!0),()=>window.removeEventListener("keydown",E,!0)},[ae.open,ce.open,it.open]);async function ki(E=!0){d(null),E?(l(!0),ne(0),I(!0)):D(!0);try{const F=Number(ve);if(!Number.isFinite(F)||F<=0){E&&(f([]),I(!0),ne(0),j({}),$({}));return}const ee=localStorage.getItem("tnt.sales.assigneeId");if(!ee){f([]),d(gt.loginRequired);return}const re=new URL("/api/v1/customers",window.location.origin);re.searchParams.set("mineOnly","true"),re.searchParams.set("assigneeId",ee),re.searchParams.set("companyType",k),ve&&re.searchParams.set("year",String(ve)),m.trim()&&re.searchParams.set("name",m.trim()),re.searchParams.set("limit",String(V)),re.searchParams.set("offset",String(E?0:G));const te=await fetch(re.toString());if(!te.ok){let se=`HTTP ${te.status}`;try{const ie=await te.json();ie!=null&&ie.error&&(se=ie.error)}catch{const ie=await te.text();ie&&(se=ie)}throw new Error(se)}const Z=await te.json(),le=Array.isArray(Z)?Z:[];f(E?le:se=>[...se,...le]),I(le.length>=V),ne(se=>E?V:se+V);try{if(ee){const se=new URL("/api/v1/customers/count",window.location.origin);se.searchParams.set("mineOnly","true"),se.searchParams.set("assigneeId",ee);const ie=await fetch(se.toString());if(ie.ok){const fe=await ie.json().catch(()=>({})),me=Number((fe==null?void 0:fe.total)??0);H(Number.isFinite(me)?me:0)}else H(0)}else H(0)}catch{H(0)}try{const se=le.map(ie=>Number(ie.customerSeq||0)).filter(ie=>Number.isFinite(ie)&&ie>0);if(se.length>0){const ie=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);ie.searchParams.set("custSeq",Array.from(new Set(se)).join(",")),ie.searchParams.set("years","2");const fe=await fetch(ie.toString());if(fe.ok){const me=await fe.json(),he={};Array.isArray(me)&&me.forEach(_e=>{const Ne=Number((_e==null?void 0:_e.customerSeq)||(_e==null?void 0:_e.customerSeqText)||0);Number.isFinite(Ne)&&(he[Ne]=!!(_e!=null&&_e.hasRecent))}),j(_e=>E?he:{..._e,...he})}else E&&j({})}else E&&j({})}catch{j({})}try{const se=Number(ve),ie=Number.isFinite(se)&&se>0?se:new Date().getFullYear(),fe=localStorage.getItem("tnt.sales.assigneeId")||"",me=le.map(he=>Number(he.customerSeq||0)).filter(he=>Number.isFinite(he)&&he>0);if(fe&&me.length>0){const he=new URL("/api/v1/sales/plan/stages",window.location.origin);he.searchParams.set("year",String(ie)),k&&he.searchParams.set("companyType",k),he.searchParams.set("assigneeId",fe),he.searchParams.set("customerSeqs",Array.from(new Set(me)).join(","));const _e=await fetch(he.toString());if(_e.ok){const Ne=await _e.json(),Ye={};Array.isArray(Ne)&&Ne.forEach(Ue=>{const tt=Number((Ue==null?void 0:Ue.customer_seq)??(Ue==null?void 0:Ue.customerSeq)??0),Bt=String((Ue==null?void 0:Ue.target_stage)??(Ue==null?void 0:Ue.targetStage)??"").trim();Number.isFinite(tt)&&Bt&&(Ye[tt]=Bt)}),$(Ue=>E?Ye:{...Ue,...Ye})}else E&&$({})}else E&&$({})}catch{E&&$({})}}catch(F){d(F.message||"조회 중 오류가 발생했습니다")}finally{E?l(!1):D(!1)}}h.useEffect(()=>{ve&&ki(!0)},[ve,k]),h.useEffect(()=>{ve||(f([]),I(!0),ne(0),j({}),$({}))},[ve]),h.useEffect(()=>{async function E(){try{const F=localStorage.getItem("tnt.sales.assigneeId");if(!F){Y({tnt:0,dys:0});return}const ee=Number(ve);if(!Number.isFinite(ee)||ee<=0){Y({tnt:0,dys:0});return}const re=new URL("/api/v1/customers/with-invoice-count",window.location.origin);re.searchParams.set("assigneeId",F),re.searchParams.set("year",String(ee));const te=await fetch(re.toString());if(!te.ok){Y({tnt:0,dys:0});return}const Z=await te.json().catch(()=>({})),le=Number((Z==null?void 0:Z.tnt)??0),se=Number((Z==null?void 0:Z.dys)??0);Y({tnt:Number.isFinite(le)?le:0,dys:Number.isFinite(se)?se:0})}catch{Y({tnt:0,dys:0})}}E()},[ve]);const qw=h.useMemo(()=>{const E=Number(ve);return Number.isFinite(E)&&E>0?`${E-1}년`:"전년도"},[ve]),Uw=h.useMemo(()=>(localStorage.getItem("tnt.sales.empName")||"").trim()||"사용자",[]),Ut="#1e3a8a";h.useEffect(()=>{if(!g.open)return;const E=()=>b({open:!1,x:0,y:0});return window.addEventListener("click",E),()=>window.removeEventListener("click",E)},[g.open]),h.useEffect(()=>{if(!g.open)return;const E=F=>{F.key==="Escape"&&b({open:!1,x:0,y:0})};return window.addEventListener("keydown",E),()=>window.removeEventListener("keydown",E)},[g.open]),h.useEffect(()=>{const E=F=>{((F==null?void 0:F.key)==="Escape"||(F==null?void 0:F.key)==="Esc"||(F==null?void 0:F.keyCode)===27)&&(b({open:!1,x:0,y:0}),C({open:!1,x:0,y:0}))};return document.addEventListener("keydown",E,!0),()=>document.removeEventListener("keydown",E,!0)},[]);async function Hw(E,F){E.preventDefault(),E.stopPropagation(),b({open:!1,x:0,y:0});const ee=E.clientX,re=E.clientY;C({open:!0,x:ee,y:re,row:F,loading:!1,error:null,data:[]})}const fm=h.useMemo(()=>{var F,ee,re,te,Z,le,se,ie,fe,me,he,_e,Ne,Ye,Ue;const E=[...u].sort((tt,Bt)=>{const ft=Number(tt.customerSeq||0),Gn=Number(Bt.customerSeq||0),Qn=!!T[ft],ur=!!T[Gn];if(Qn!==ur)return Qn?-1:1;const _r=(tt.customerName||"").toString(),zc=(Bt.customerName||"").toString();return _r.localeCompare(zc,"ko",{sensitivity:"base"})});return r.jsx(r.Fragment,{children:r.jsxs("div",{ref:S,className:"table-container",onClick:()=>b({open:!1,x:0,y:0}),style:{height:"100%",overflow:"auto"},children:[E.length===0?r.jsx("div",{className:"empty-state",children:gt.empty}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsx("tr",{children:r.jsx("th",{style:{width:"auto"},children:"거래처명"})})}),r.jsx("tbody",{children:E.map((tt,Bt)=>r.jsx("tr",{onClick:ft=>{ft.preventDefault(),ft.stopPropagation(),O(tt),C({open:!1,x:0,y:0})},onContextMenu:ft=>Hw(ft,tt),"aria-selected":(w==null?void 0:w.customerId)===tt.customerId?!0:void 0,style:(w==null?void 0:w.customerId)===tt.customerId?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:r.jsx("td",{children:(()=>{const ft=Number(tt.customerSeq||0),Gn=T[ft],Qn={};return Gn==="P"&&(Qn.color="#dc2626"),Gn==="C"&&(Qn.fontWeight=700),r.jsxs("span",{children:[r.jsx("span",{style:Qn,children:tt.customerName}),Gn?r.jsx("span",{className:"badge stage-badge",style:{marginLeft:6},children:Gn}):null]})})()})},Bt))})]}),P&&r.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:gt.loading}),!o&&!P&&!U&&u.length>0&&r.jsx("div",{className:"muted",style:{padding:"8px 10px",textAlign:"center"},children:"마지막 데이터입니다."}),A.open&&r.jsxs("div",{className:"context-menu",style:{left:A.x+6,top:A.y+6,maxWidth:420,padding:8},onClick:tt=>tt.stopPropagation(),children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 상세"}),A.error?r.jsx("div",{className:"error",style:{maxWidth:380},children:A.error}):r.jsx("table",{className:"table",style:{width:"100%"},children:r.jsxs("tbody",{children:[r.jsxs("tr",{children:[r.jsx("th",{style:{width:110,textAlign:"left"},children:"거래처번호"}),r.jsx("td",{children:((F=A.row)==null?void 0:F.customerId)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"사업자번호"}),r.jsx("td",{children:((ee=A.row)==null?void 0:ee.bizNo)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"대표자명"}),r.jsx("td",{children:((re=A.row)==null?void 0:re.ownerName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"업태"}),r.jsx("td",{children:((te=A.row)==null?void 0:te.bizKind)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"종목"}),r.jsx("td",{children:((Z=A.row)==null?void 0:Z.bizType)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"전화번호"}),r.jsx("td",{children:((le=A.row)==null?void 0:le.telNo)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"담당자명"}),r.jsx("td",{children:((se=A.row)==null?void 0:se.empName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"부서명"}),r.jsx("td",{children:((ie=A.row)==null?void 0:ie.deptName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"시/도"}),r.jsx("td",{children:((fe=A.row)==null?void 0:fe.addrProvinceName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"시/군/구"}),r.jsx("td",{children:((me=A.row)==null?void 0:me.addrCityName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"고객유형"}),r.jsx("td",{children:((he=A.row)==null?void 0:he.customerTypeName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"비고"}),r.jsx("td",{children:((_e=A.row)==null?void 0:_e.customerRemark)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"생성자"}),r.jsx("td",{children:((Ne=A.row)==null?void 0:Ne.createdBy)??""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"수정자"}),r.jsx("td",{children:((Ye=A.row)==null?void 0:Ye.updatedBy)??""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"생성일시"}),r.jsx("td",{children:QS((Ue=A.row)==null?void 0:Ue.createdAt)})]})]})})]})]})})},[u,g,x,A,w,T,o,P,U]);h.useEffect(()=>{const E=S.current;if(!E)return;function F(){E.scrollTop+E.clientHeight>=E.scrollHeight-48&&U&&!P&&!o&&ki(!1)}return E.addEventListener("scroll",F),()=>E.removeEventListener("scroll",F)},[U,P,o,G]);const[cr,ea]=h.useState({open:!1,loading:!1,error:null,rows:[]}),[Mc,Yw]=h.useState(10),[ai,hm]=h.useState(""),[Ba,Lc]=h.useState("TNT"),$c=Dn("unit-amounts-by-emp",cr.open,rn,{persist:!1,resetOnOpen:!0}),[ta,Vs]=h.useState({total:0,confirmed:0,inprogress:0,loading:!1,error:null}),[Wa,Xs]=h.useState({tnt:0,dys:0,loading:!1,error:null});h.useEffect(()=>{async function E(){const F=Number(ve),ee=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),re=(localStorage.getItem("tnt.sales.empId")||"").trim();if(!Number.isFinite(F)||F<=0||!ee&&!re){Vs({total:0,confirmed:0,inprogress:0,loading:!1,error:null});return}Vs(te=>({...te,loading:!0,error:null}));try{const te=new URL("/api/v1/sales/plan/customer-counts-overall",window.location.origin);te.searchParams.set("year",String(F)),ee?te.searchParams.set("assigneeId",ee):re&&te.searchParams.set("empId",re);const Z=await fetch(te.toString());if(!Z.ok)throw new Error(`HTTP ${Z.status}`);const le=await Z.json(),se=Number((le==null?void 0:le.total_customers)??0)||0,ie=Number((le==null?void 0:le.confirmed_customers)??0)||0,fe=Number((le==null?void 0:le.inprogress_customers)??0)||0;Vs({total:se,confirmed:ie,inprogress:fe,loading:!1,error:null})}catch(te){Vs({total:0,confirmed:0,inprogress:0,loading:!1,error:(te==null?void 0:te.message)||"요약 조회 오류"})}}E()},[ve,Or]);async function Kw(){try{const E=localStorage.getItem("tnt.sales.assigneeId");if(!E||!ai){ea(he=>({...he,loading:!1}));return}const F=new URL("/api/v1/dashboard/avg-unit-price-by-emp",window.location.origin);F.searchParams.set("assigneeId",E),F.searchParams.set("companyType",Ba),F.searchParams.set("year",String(ai));const ee=await fetch(F.toString());if(!ee.ok)throw new Error(`HTTP ${ee.status}`);const re=await ee.json(),te=new URL("/api/v1/dashboard/avg-unit-price",window.location.origin);te.searchParams.set("companyType",Ba),te.searchParams.set("year",String(ai));const Z=await fetch(te.toString()),le=Z.ok?await Z.json():[],se={},ie={};Array.isArray(re)&&re.forEach(he=>{const Ne=String((he==null?void 0:he.sales_mgmt_unit)??(he==null?void 0:he.salesMgmtUnit)??"").trim().toUpperCase();Ne&&(se[Ne]={amount:Number((he==null?void 0:he.avg_unit_price)??(he==null?void 0:he.avgUnitPrice)??0),itemUnit:String((he==null?void 0:he.item_unit)??(he==null?void 0:he.itemUnit)??""),itemStdUnit:String((he==null?void 0:he.item_std_unit)??(he==null?void 0:he.itemStdUnit)??"")})}),Array.isArray(le)&&le.forEach(he=>{const Ne=String((he==null?void 0:he.sales_mgmt_unit)??(he==null?void 0:he.salesMgmtUnit)??"").trim().toUpperCase();Ne&&(ie[Ne]={amount:Number((he==null?void 0:he.avg_unit_price)??(he==null?void 0:he.avgUnitPrice)??0),itemUnit:String((he==null?void 0:he.item_unit)??(he==null?void 0:he.itemUnit)??""),itemStdUnit:String((he==null?void 0:he.item_std_unit)??(he==null?void 0:he.itemStdUnit)??"")})});const me=Array.from(new Set([...Object.keys(se),...Object.keys(ie)])).sort().map(he=>{var _e,Ne,Ye,Ue,tt,Bt;return{unit:he,amountMy:Number(((_e=se[he])==null?void 0:_e.amount)??0),amountGlobal:Number(((Ne=ie[he])==null?void 0:Ne.amount)??0),itemUnit:((Ye=se[he])==null?void 0:Ye.itemUnit)||((Ue=ie[he])==null?void 0:Ue.itemUnit)||"",itemStdUnit:((tt=se[he])==null?void 0:tt.itemStdUnit)||((Bt=ie[he])==null?void 0:Bt.itemStdUnit)||""}});ea({open:!0,loading:!1,error:null,rows:me})}catch(E){ea({open:!0,loading:!1,error:(E==null?void 0:E.message)||"조회 오류",rows:[]})}}function Vw(){ea({open:!0,loading:!0,error:null,rows:[]});const E=Number(ve),F=Number.isFinite(E)&&E>0?E-1:new Date().getFullYear()-1,ee=Math.max(2025,Math.min(2030,F));hm(ee),Lc("TNT")}function Xw(E){const F=E.target.value;Ie(F)}function mm(){ea(E=>({...E,open:!1}))}return h.useEffect(()=>{if(!cr.open)return;const E=F=>{F.key==="Escape"&&mm()};return window.addEventListener("keydown",E,!0),()=>window.removeEventListener("keydown",E,!0)},[cr.open]),h.useEffect(()=>{cr.open&&ai&&(ea(E=>({...E,loading:!0})),Kw())},[cr.open,ai,Ba]),h.useEffect(()=>{(async()=>{try{Xs(ie=>({...ie,loading:!0,error:null}));const E=Number(ve),F=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),ee=(localStorage.getItem("tnt.sales.empId")||"").trim();if(!Number.isFinite(E)||E<=0||!F&&!ee){Xs({tnt:0,dys:0,loading:!1,error:null});return}const re=new URL("/api/v1/sales/plan/totals-confirmed-by-assignee",window.location.origin);re.searchParams.set("year",String(E)),F?re.searchParams.set("assigneeId",F):ee&&re.searchParams.set("empId",ee);const te=await fetch(re.toString());if(!te.ok)throw new Error(`HTTP ${te.status}`);const Z=await te.json().catch(()=>[]);let le=0,se=0;if(Array.isArray(Z))for(const ie of Z){const fe=String((ie==null?void 0:ie.company_type)||(ie==null?void 0:ie.companyType)||"").toUpperCase(),me=Number((ie==null?void 0:ie.amount)||0);fe==="TNT"?le+=me:fe==="DYS"&&(se+=me)}Xs({tnt:Math.round(le),dys:Math.round(se),loading:!1,error:null})}catch(E){Xs({tnt:0,dys:0,loading:!1,error:(E==null?void 0:E.message)||"확정 합계 조회 오류"})}})()},[ve]),h.useEffect(()=>{if(!ae.open)return;const E=F=>{F.key==="Escape"&&ri()};return window.addEventListener("keydown",E,!0),()=>window.removeEventListener("keydown",E,!0)},[ae.open]),h.useEffect(()=>{if(!ce.open)return;const E=F=>{F.key==="Escape"&&He()};return window.addEventListener("keydown",E,!0),()=>window.removeEventListener("keydown",E,!0)},[ce.open]),h.useEffect(()=>{if(!Tt.open)return;const E=F=>{F.key==="Escape"&&ii()};return window.addEventListener("keydown",E,!0),()=>window.removeEventListener("keydown",E,!0)},[Tt.open]),h.useEffect(()=>{if(!it.open)return;const E=F=>{F.key==="Escape"&&Ks()};return window.addEventListener("keydown",E,!0),()=>window.removeEventListener("keydown",E,!0)},[it.open]),h.useEffect(()=>{if(!ze.open)return;const E=F=>{F.key==="Escape"&&Tr()};return window.addEventListener("keydown",E,!0),()=>window.removeEventListener("keydown",E,!0)},[ze.open]),r.jsxs("section",{"aria-busy":zt||void 0,children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"목표 Simulation"}),r.jsxs("div",{className:"muted count-text",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[r.jsx("span",{style:{fontWeight:700},children:"현재목표"}),r.jsxs("span",{onClick:E=>ji("TNT",E),style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #3b82f6",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent",cursor:"pointer"},title:"TNT 계획 합계 (클릭하여 상세)",children:[r.jsx("span",{style:{fontSize:12,color:"#3b82f6",fontWeight:700},children:"TNT"}),r.jsx("span",{style:{color:"#3b82f6"},children:Ze.format(ye.tnt)}),r.jsx("span",{style:{fontSize:12,color:"#3b82f6"},children:"원"})]}),r.jsxs("span",{onClick:E=>ji("DYS",E),style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #10b981",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent",cursor:"pointer"},title:"DYS 계획 합계 (클릭하여 상세)",children:[r.jsx("span",{style:{fontSize:12,color:"#10b981",fontWeight:700},children:"DYS"}),r.jsx("span",{style:{color:"#10b981"},children:Ze.format(ye.dys)}),r.jsx("span",{style:{fontSize:12,color:"#10b981"},children:"원"})]}),r.jsx("span",{"aria-hidden":!0,style:{width:1,height:20,background:"var(--border)",display:"inline-block"}}),r.jsx("span",{style:{fontWeight:700},children:"목표확정"}),Wa.loading?r.jsx("span",{className:"muted",style:{fontSize:12},children:"불러오는 중…"}):Wa.error?r.jsx("span",{className:"error",style:{fontSize:12},children:Wa.error}):r.jsxs(r.Fragment,{children:[r.jsxs("span",{title:"확정된 고객 합계 (TNT)",style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #3b82f6",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent"},children:[r.jsx("span",{style:{fontSize:12,color:"#3b82f6",fontWeight:700},children:"TNT"}),r.jsx("span",{style:{color:"#3b82f6"},children:Ze.format(Wa.tnt)}),r.jsx("span",{style:{fontSize:12,color:"#3b82f6"},children:"원"})]}),r.jsxs("span",{title:"확정된 고객 합계 (DYS)",style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #10b981",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent"},children:[r.jsx("span",{style:{fontSize:12,color:"#10b981",fontWeight:700},children:"DYS"}),r.jsx("span",{style:{color:"#10b981"},children:Ze.format(Wa.dys)}),r.jsx("span",{style:{fontSize:12,color:"#10b981"},children:"원"})]})]}),r.jsx("button",{className:"btn-plain",title:"내 평균거래 단가",onClick:Vw,"aria-label":"평균거래 단가 팝업 열기",children:r.jsx("img",{src:Av,className:"icon",alt:"단가"})}),_.toLocaleString(),"개 거래처"]})]}),r.jsxs("div",{className:"card",style:{padding:8,marginTop:8,display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[r.jsx("div",{className:"muted",children:"목표년도"}),r.jsxs("select",{className:"search-input",value:ve,onChange:Xw,"aria-label":"목표년도",style:{height:28},children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),ke().map(E=>r.jsxs("option",{value:String(E),children:[E,"년"]},E))]}),r.jsx("div",{className:"muted",style:{marginLeft:12},children:"가중치"}),r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("input",{className:"search-input",value:String(Mc),onChange:E=>{const F=Number((E.target.value||"").replace(/[^0-9]/g,""));Number.isFinite(F)&&Yw(Math.max(0,Math.min(999,F)))},inputMode:"numeric","aria-label":"가중치(%)",style:{width:72,height:28,textAlign:"right"}}),r.jsx("span",{className:"muted",children:"%"})]})]}),(()=>{const E=!!(q.hasC&&!q.hasP&&!q.hasI),F=!!(q.hasI&&!q.hasP&&!q.hasC),ee=!!(q.hasP||q.hasC&&q.hasI),re=E?"목표수립완료":F?"초기설정완료":ee?"계획수립 중":"초기설정",te=E||F||ee,Z=te||zt?{opacity:.6,cursor:"not-allowed",background:"var(--border)",color:"var(--muted)"}:void 0;return r.jsx("button",{className:"btn btn-card btn-3d",onClick:Gw,disabled:te||zt,style:Z,children:re})})(),ve?q.show?r.jsxs("div",{className:"muted",style:{display:"inline-flex",alignItems:"center",gap:6,flexWrap:"wrap",fontSize:12},children:[r.jsxs("span",{style:{fontSize:12},children:[q.name,"님"]}),r.jsxs("span",{style:{color:Ut,fontWeight:700,fontSize:14,whiteSpace:"pre"},children:[q.year,"년"]}),r.jsx("span",{style:{fontSize:12},children:" "}),r.jsxs("span",{style:{color:Ut,fontWeight:700,fontSize:14},children:["TNT ",q.tnt.toLocaleString(),"개"]}),r.jsx("span",{style:{fontSize:12},children:","}),r.jsxs("span",{style:{color:Ut,fontWeight:700,fontSize:14},children:[" DYS ",q.dys.toLocaleString(),"개"]}),r.jsx("span",{style:{fontSize:12},children:q.label||""})]}):W?r.jsxs("div",{className:"muted",style:{display:"inline-flex",alignItems:"center",gap:6,flexWrap:"wrap",fontSize:12},children:[r.jsxs("span",{style:{fontSize:12},children:[Uw,"님,"]}),r.jsx("span",{style:{color:Ut,fontWeight:700,fontSize:14},children:qw}),r.jsx("span",{style:{fontSize:12},children:"매출 기준으로 담당 거래처"}),r.jsx("span",{style:{color:Ut,fontWeight:700,fontSize:14},children:"TNT"}),r.jsx("span",{style:{color:Ut,fontWeight:700,fontSize:14},children:oe.tnt.toLocaleString()}),r.jsx("span",{style:{fontSize:12},children:"개,"}),r.jsx("span",{style:{color:Ut,fontWeight:700,fontSize:14},children:"DYS"}),r.jsx("span",{style:{color:Ut,fontWeight:700,fontSize:14},children:oe.dys.toLocaleString()}),r.jsx("span",{style:{fontSize:12},children:"개에 대해"}),r.jsxs("span",{style:{color:Ut,fontWeight:700,fontSize:14},children:[Mc,"%"]}),r.jsx("span",{style:{fontSize:12},children:"추가하여 목표 설정합니다."})]}):null:null,r.jsx("div",{className:"muted",style:{marginLeft:"auto"},children:ta.loading?"요약 불러오는 중…":ta.error?r.jsx("span",{className:"error",children:ta.error}):r.jsxs(r.Fragment,{children:["수립대상 ",ta.total.toLocaleString(),"개, 확정 ",ta.confirmed.toLocaleString(),"개, 진행 중 ",ta.inprogress.toLocaleString(),"개"]})})]}),ze.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"transparent",zIndex:60},children:r.jsxs("div",{ref:_c.ref,className:"card",style:{..._c.style,width:720,maxWidth:"92vw",background:"var(--panel)",padding:12,fontSize:12},children:[r.jsx("div",{..._c.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:Tr,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsxs("div",{className:"page-title",style:{marginBottom:8,alignItems:"center"},children:[r.jsxs("h2",{style:{margin:0},children:[ze.company," 계획 합계 상세"]}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"radio",name:"totals-group",checked:ze.group==="customer",onChange:()=>{at(E=>({...E,group:"customer"})),Xn(ze.company,"customer")}}),"거래처별"]}),r.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"radio",name:"totals-group",checked:ze.group==="unit",onChange:()=>{at(E=>({...E,group:"unit"})),Xn(ze.company,"unit")}}),"영업관리단위별"]})]})]}),ze.error?r.jsx("div",{className:"error",children:ze.error}):null,r.jsx("div",{className:"table-container",style:{maxHeight:"66vh",overflow:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",width:380},children:ze.group==="customer"?"거래처":"영업관리단위"}),r.jsx("th",{style:{textAlign:"right",width:200},children:"금액(원)"})]})}),r.jsx("tbody",{children:ze.loading?r.jsx("tr",{children:r.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"불러오는 중…"})}):ze.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):ze.rows.map((E,F)=>{const ee=ze.group==="customer"&&E.label||E.key;return r.jsxs("tr",{children:[r.jsx("td",{children:ee}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ze.format(Math.round(E.amount))})]},F)})})]})})]})}),Ht?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:80,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:280,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:Ht}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>Yt(null),children:"확인"})})]})}):null,r.jsx("div",{className:"c360-tabs",role:"tablist","aria-label":"회사 구분 탭",style:{marginTop:8},children:["TNT","DYS"].map(E=>r.jsx("button",{role:"tab","aria-selected":yr===E,className:`tab ${yr===E?"active":""}`,onClick:()=>{Pn(E);try{L(E)}catch{}},children:E},E))}),yr==="TNT"?r.jsxs(r.Fragment,{children:[c&&r.jsx("div",{className:"error",children:c||gt.errorGeneric}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[r.jsxs("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:[r.jsx("div",{className:"card",style:{padding:8,marginBottom:8},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{className:"search-input",placeholder:"거래처명",value:m,onChange:E=>p(E.target.value),onKeyDown:E=>{E.key==="Enter"&&ki(!0)},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:()=>ki(!0),disabled:o,style:{flex:"0 0 auto"},children:"조회"})]})}),ve?fm:r.jsx("div",{className:"muted",style:{padding:"12px 10px"},children:"연도를 먼저 선택하세요."})]}),r.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:de.map((E,F)=>{const ee=F<be,re=F===be;return r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:F===de.length-1?"0 0 auto":"1 1 0"},children:[r.jsx("div",{title:E.label,onClick:()=>B(E.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:ee||re?"var(--accent)":"transparent",border:`2px solid ${ee||re?"var(--accent)":"var(--border)"}`,color:ee||re?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":re?"step":void 0,children:ee?"✓":F+1}),r.jsx("div",{style:{fontSize:12,color:re||ee?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:E.label}),F<de.length-1&&r.jsx("div",{style:{height:2,background:F<be?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},E.key)})}),r.jsx("div",{children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:Zi,disabled:!(w!=null&&w.customerSeq)||!ve,title:"해당 거래처 목표 확정",children:"확정"})})]}),w!=null&&w.customerSeq&&ve?r.jsxs("div",{className:"card",style:{marginBottom:12,padding:8},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginBottom:8,gap:8,flexWrap:"wrap"},children:[r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:An,children:"일괄비율"}),r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:Me,children:"일괄입력"}),r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:um,children:"신규 영업관리단위"})]}),ht.error?r.jsx("div",{className:"error",children:ht.error}):r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",width:220},children:"중분류"}),r.jsx("th",{style:{textAlign:"left",width:220},children:"영업관리단위"}),r.jsx("th",{style:{textAlign:"center",width:120},children:"목표입력"}),r.jsx("th",{className:"sum-head",style:{textAlign:"right",width:140},children:"합계"}),Array.from({length:12},(E,F)=>F+1).map(E=>r.jsxs("th",{style:{textAlign:"right"},children:[String(E).padStart(2,"0"),"월"]},E))]})}),r.jsx("tbody",{children:ht.rows.length===0?r.jsx("tr",{children:r.jsx("td",{className:"muted",colSpan:16,style:{padding:"12px 10px"},children:ht.loading?"불러오는 중…":"데이터가 없습니다"})}):ht.rows.map((E,F)=>{const ee=(E.months||[]).reduce((te,Z)=>te+(Number.isFinite(Z)?Number(Z):0),0),re=(E.amounts||[]).reduce((te,Z)=>te+(Number.isFinite(Z)?Number(Z):0),0);return r.jsxs("tr",{children:[r.jsx("td",{children:E.sub}),r.jsxs("td",{children:[r.jsx("span",{children:E.unit}),E.stage?r.jsx("span",{className:"stage-badge",style:{marginLeft:6},title:String(E.stage),children:E.stage}):null]}),r.jsx("td",{style:{textAlign:"center"},children:r.jsx("button",{type:"button",className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:te=>{te.preventDefault(),te.stopPropagation(),ni(E.sub,E.unit)},children:"입력"})}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(ee,0,re)}),E.months.map((te,Z)=>{var le;return r.jsx("td",{style:{textAlign:"right"},children:st(te,Z,(le=E.amounts)==null?void 0:le[Z],E.stage==="P"?"#dc2626":void 0,E.stage==="C")},Z)})]},F)})}),(()=>{if(!ht.rows||ht.rows.length===0)return null;const E=Array.from({length:12},(te,Z)=>ht.rows.reduce((le,se)=>{var ie;return le+(Number((ie=se.months)==null?void 0:ie[Z])||0)},0)),F=Array.from({length:12},(te,Z)=>ht.rows.reduce((le,se)=>{var ie;return le+(Number((ie=se.amounts)==null?void 0:ie[Z])||0)},0)),ee=E.reduce((te,Z)=>te+(Number(Z)||0),0),re=F.reduce((te,Z)=>te+(Number(Z)||0),0);return r.jsx("tfoot",{children:r.jsxs("tr",{className:"sum-row",children:[r.jsx("td",{colSpan:3,style:{textAlign:"center",fontWeight:700},children:"합계"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(ee,0,re)}),E.map((te,Z)=>r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(te,Z,F[Z])},Z))]})})})()]})})]}):null]})]})]}):r.jsxs(r.Fragment,{children:[c&&r.jsx("div",{className:"error",children:c||gt.errorGeneric}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[r.jsxs("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:[r.jsx("div",{className:"card",style:{padding:8,marginBottom:8},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{className:"search-input",placeholder:"거래처명",value:m,onChange:E=>p(E.target.value),onKeyDown:E=>{E.key==="Enter"&&ki(!0)},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:()=>ki(!0),disabled:o,style:{flex:"0 0 auto"},children:"조회"})]})}),ve?fm:r.jsx("div",{className:"muted",style:{padding:"12px 10px"},children:"연도를 먼저 선택하세요."})]}),r.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:de.map((E,F)=>{const ee=F<be,re=F===be;return r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:F===de.length-1?"0 0 auto":"1 1 0"},children:[r.jsx("div",{title:E.label,onClick:()=>B(E.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:ee||re?"var(--accent)":"transparent",border:`2px solid ${ee||re?"var(--accent)":"var(--border)"}`,color:ee||re?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":re?"step":void 0,children:ee?"✓":F+1}),r.jsx("div",{style:{fontSize:12,color:re||ee?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:E.label}),F<de.length-1&&r.jsx("div",{style:{height:2,background:F<be?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},E.key)})}),r.jsx("div",{children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:Zi,disabled:!(w!=null&&w.customerSeq)||!ve,title:"해당 거래처 목표 확정",children:"확정"})})]}),w!=null&&w.customerSeq&&ve?r.jsxs("div",{className:"card",style:{marginBottom:12,padding:8},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginBottom:8,gap:8,flexWrap:"wrap"},children:[r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:An,children:"일괄비율"}),r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:Me,children:"일괄입력"}),r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:um,children:"신규 영업관리단위"})]}),ht.error?r.jsx("div",{className:"error",children:ht.error}):r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",width:220},children:"중분류"}),r.jsx("th",{style:{textAlign:"left",width:220},children:"영업관리단위"}),r.jsx("th",{style:{textAlign:"center",width:120},children:"목표입력"}),r.jsx("th",{className:"sum-head",style:{textAlign:"right",width:140},children:"합계"}),Array.from({length:12},(E,F)=>F+1).map(E=>r.jsxs("th",{style:{textAlign:"right"},children:[String(E).padStart(2,"0"),"월"]},E))]})}),r.jsx("tbody",{children:ht.rows.length===0?r.jsx("tr",{children:r.jsx("td",{className:"muted",colSpan:16,style:{padding:"12px 10px"},children:ht.loading?"불러오는 중…":"데이터가 없습니다"})}):ht.rows.map((E,F)=>{const ee=(E.months||[]).reduce((te,Z)=>te+(Number.isFinite(Z)?Number(Z):0),0),re=(E.amounts||[]).reduce((te,Z)=>te+(Number.isFinite(Z)?Number(Z):0),0);return r.jsxs("tr",{children:[r.jsx("td",{children:E.sub}),r.jsxs("td",{children:[r.jsx("span",{children:E.unit}),E.stage?r.jsx("span",{className:"badge stage-badge",style:{marginLeft:6},children:E.stage}):null]}),r.jsx("td",{style:{textAlign:"center"},children:r.jsx("button",{type:"button",className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:te=>{te.preventDefault(),te.stopPropagation(),ni(E.sub,E.unit)},children:"입력"})}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(ee,0,re)}),E.months.map((te,Z)=>{var le;return r.jsx("td",{style:{textAlign:"right"},children:st(te,Z,(le=E.amounts)==null?void 0:le[Z],E.stage==="P"?"#dc2626":void 0,E.stage==="C")},Z)})]},F)})}),(()=>{if(!ht.rows||ht.rows.length===0)return null;const E=Array.from({length:12},(te,Z)=>ht.rows.reduce((le,se)=>{var ie;return le+(Number((ie=se.months)==null?void 0:ie[Z])||0)},0)),F=Array.from({length:12},(te,Z)=>ht.rows.reduce((le,se)=>{var ie;return le+(Number((ie=se.amounts)==null?void 0:ie[Z])||0)},0)),ee=E.reduce((te,Z)=>te+(Number(Z)||0),0),re=F.reduce((te,Z)=>te+(Number(Z)||0),0);return r.jsx("tfoot",{children:r.jsxs("tr",{className:"sum-row",children:[r.jsx("td",{colSpan:3,style:{textAlign:"center",fontWeight:700},children:"합계"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(ee,0,re)}),E.map((te,Z)=>r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(te,Z,F[Z])},Z))]})})})()]})})]}):null,w!=null&&w.customerSeq&&ve?r.jsxs("div",{className:"card",style:{marginBottom:12,padding:8},children:[r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[r.jsx("div",{className:"muted",style:{fontWeight:700,lineHeight:"28px",fontSize:14},children:"목표수립의견"}),r.jsx("textarea",{className:"search-input",value:Ct.val,onChange:E=>yn(F=>({...F,val:E.target.value})),placeholder:"목표수립에 대한 의견을 입력하세요",rows:6,style:{flex:1,resize:"vertical",height:80,minHeight:80,fontSize:12}})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:8,marginTop:8},children:[Ct.loading?r.jsx("span",{className:"muted",style:{fontSize:12},children:"(읽는 중…)"}):null,Ct.error?r.jsx("span",{className:"error",style:{fontSize:12},children:Ct.error}):null,Ct.success?r.jsx("span",{style:{fontSize:12,color:"var(--accent)",fontWeight:700},children:Ct.success}):null,r.jsx("button",{className:"btn btn-card btn-3d",onClick:Ji,disabled:Ct.saving,children:Ct.saving?"저장중…":"저장"})]})]}):null]})]})]}),ae.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:xn.ref,className:"card compact",style:{...xn.style,position:"relative",width:900,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[r.jsx("div",{...xn.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:ri,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1.6fr 120px 1fr",gap:8,alignItems:"center"},children:[r.jsx("div",{className:"muted form-label",children:"영업관리단위"}),r.jsx("div",{children:ae.unit||""}),r.jsx("div",{className:"muted form-label",children:"중분류"}),r.jsx("div",{children:ae.sub||""}),r.jsx("div",{className:"muted form-label",children:"매출 수량"}),r.jsx("div",{style:{gridColumn:"2 / 5"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"nowrap",minWidth:0},children:[r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:ae.qty||"",onChange:E=>Us(ae.month,E.target.value)}),(()=>{const E=Qe(),F=(ae.unit||"").trim(),ee=Ge(F),re=xe[E]||{},te=Number(re[ee]||0),Z=mt(),le=(ue==null?void 0:ue[Z])||{},se=Number(le[ee]||0),ie=Number.isFinite(te)&&te>0?Ze.format(Math.round(te)):"-",fe=Number.isFinite(se)&&se>0?Ze.format(Math.round(se)):"-",me=Number.isFinite(te)&&Number.isFinite(se)?te>=se?Ut:"#dc2626":Ut;return r.jsxs("span",{className:"muted",style:{fontSize:12,whiteSpace:"nowrap"},children:[r.jsxs("span",{style:{color:me,fontWeight:700},children:["내단가 ",ie," 원"]})," | 전체단가 ",fe," 원/단위"]})})()]})}),r.jsx("div",{className:"muted form-label",children:"매출월"}),r.jsx("div",{children:r.jsxs("select",{className:"search-input",value:ae.month||"",onChange:E=>Us(E.target.value,ae.qty),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(E,F)=>F+1).map(E=>r.jsxs("option",{value:String(E),children:[E,"월"]},E))]})})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsx("div",{className:"pane-header",style:{margin:0},children:"현재 목표"}),r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(E,F)=>F+1).map(E=>r.jsxs("th",{style:{textAlign:"right"},children:[String(E).padStart(2,"0"),"월"]},E))]})}),r.jsx("tbody",{children:r.jsx("tr",{children:(()=>{const E=(ae.curMonths||[]).reduce((ee,re)=>ee+(Number.isFinite(re)?Number(re):0),0),F=(ae.curAmounts||[]).reduce((ee,re)=>ee+(Number.isFinite(re)?Number(re):0),0);return r.jsxs(r.Fragment,{children:[r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(E,0,F)}),ae.curMonths.map((ee,re)=>{var te;return r.jsx("td",{children:st(ee,re,(te=ae.curAmounts)==null?void 0:te[re],ae.stage==="P"?"#dc2626":void 0,ae.stage==="C")},re)})]})})()})})]})})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsx("div",{className:"pane-header",style:{margin:0},children:"분배 미리보기"}),r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(E,F)=>F+1).map(E=>r.jsxs("th",{style:{textAlign:"right"},children:[String(E).padStart(2,"0"),"월"]},E))]})}),r.jsx("tbody",{children:r.jsx("tr",{children:(()=>{const E=Qe();xe[E];const F=(ae.unit||"").trim(),ee=nt(F),re=Number.isFinite(ee)?Number(ee):0,te=(ae.dist||[]).reduce((se,ie)=>se+(Number.isFinite(ie)?Number(ie):0),0),Z=Number.isFinite(re)?Math.round(re):0,le=(ae.dist||[]).reduce((se,ie)=>se+(Number.isFinite(ie)&&Z>0?Number(ie)*Z:0),0);return r.jsxs(r.Fragment,{children:[r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(te,0,le)}),ae.dist.map((se,ie)=>{const fe=Number.isFinite(re)?Math.round(re):0,me=Number.isFinite(se)&&fe>0?Number(se)*fe:void 0;return r.jsx("td",{children:st(se,ie,me,ae.stage==="P"?"#dc2626":void 0,ae.stage==="C")},ie)})]})})()})})]})})]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:Hs,children:"목표등록"})}),ae.success?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:ae.success}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:Q,children:"확인"})})]})}):null]})}),ce.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:rt.ref,className:"card compact",style:{...rt.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[r.jsx("div",{...rt.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:He,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h2",{style:{margin:0},children:"목표 일괄입력"})}),r.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto",position:"relative"},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:68,textAlign:"center"},children:"구분"}),r.jsx("th",{style:{width:160,textAlign:"left"},children:"내 평균단가"}),r.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(E,F)=>F+1).map(E=>r.jsxs("th",{style:{textAlign:"right"},children:[String(E).padStart(2,"0"),"월"]},E))]})}),r.jsx("tbody",{children:ce.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:19,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):ce.rows.map((E,F)=>{const ee=Qe();xe[ee];const re=nt((E.unit||"").trim()),te=Number.isFinite(re)?Number(re):0,Z=Number(E.month||0),le=Number(E.qty||0),se=new Array(12).fill(0);if(Number.isFinite(Z)&&Z>=1&&Z<=12&&Number.isFinite(le)&&le>0){const Ne=12-Z+1,Ye=le/Ne;for(let Ue=Z-1;Ue<12;Ue++)se[Ue]=Ye}const ie=se,fe=(E.curMonths||[]).reduce((Ne,Ye)=>Ne+(Number.isFinite(Ye)?Number(Ye):0),0),me=(E.curAmounts||[]).reduce((Ne,Ye)=>Ne+(Number.isFinite(Ye)?Number(Ye):0),0),he=se.reduce((Ne,Ye)=>Ne+(Number.isFinite(Ye)?Number(Ye):0),0),_e=se.reduce((Ne,Ye)=>Ne+(Number.isFinite(Ye)&&Number.isFinite(te)?Number(Ye)*te:0),0);return r.jsxs(r.Fragment,{children:[r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("span",{style:{fontSize:12},children:E.sub})}),r.jsxs("td",{children:[r.jsx("span",{style:{fontSize:12},children:E.unit}),E.stage?r.jsx("span",{className:"stage-badge",style:{marginLeft:6},title:String(E.stage),children:String(E.stage)}):null]}),r.jsx("td",{style:{textAlign:"center"},className:"muted",children:"현재"}),r.jsx("td",{className:"muted",children:"-"}),r.jsx("td",{className:"muted",children:"-"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(fe,0,me)}),E.curMonths.map((Ne,Ye)=>{var Ue;return r.jsx("td",{children:st(Ne,Ye,(Ue=E.curAmounts)==null?void 0:Ue[Ye],E.stage==="P"?"#dc2626":void 0,E.stage==="C")},Ye)})]},E.key+":cur"),r.jsxs("tr",{style:{background:"var(--panel-2)"},children:[r.jsx("td",{}),r.jsx("td",{}),r.jsx("td",{style:{textAlign:"center"},className:"sum-head",children:"적용"}),r.jsx("td",{children:r.jsxs("select",{className:"search-input",value:E.month||"",onChange:Ne=>De(F,Ne.target.value,void 0),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(Ne,Ye)=>Ye+1).map(Ne=>r.jsxs("option",{value:String(Ne),children:[Ne,"월"]},Ne))]})}),r.jsx("td",{children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:E.qty||"",onChange:Ne=>De(F,void 0,Ne.target.value)}),(()=>{var pm;const Ne=Qe(),Ue=(((pm=(Ce[Ne]||{})[(E.unit||"").trim()])==null?void 0:pm.itemStdUnit)||"").trim(),tt=Ge(E.unit||""),Bt=xe[Ne]||{},ft=Number(Bt[tt]||0),Gn=mt(),Qn=(ue==null?void 0:ue[Gn])||{},ur=Number(Qn[tt]||0),_r=Number.isFinite(ft)&&ft>0?Ze.format(Math.round(ft)):"-",zc=Number.isFinite(ur)&&ur>0?Ze.format(Math.round(ur)):"-",Qw=Number.isFinite(ft)&&Number.isFinite(ur)?ft>=ur?Ut:"#dc2626":Ut;return r.jsxs("span",{className:"muted",style:{fontSize:12},children:[r.jsxs("span",{style:{color:Qw,fontWeight:700},children:["내단가 ",_r," 원"]})," | 전체단가 ",zc," 원/",Ue||"단위"]})})()]})}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(he,0,_e)}),ie.map((Ne,Ye)=>{const Ue=Number.isFinite(te)?Math.round(te):0,tt=Number.isFinite(Ne)&&Ue>0?Number(Ne)*Ue:void 0;return r.jsx("td",{children:st(Ne,Ye,tt,E.stage==="P"?"#dc2626":void 0,E.stage==="C")},Ye)})]},E.key+":prev")]})})}),(()=>{if(!ce.rows||ce.rows.length===0)return null;const E=Qe();xe[E];const F=Array.from({length:12},(fe,me)=>ce.rows.reduce((he,_e)=>{var Ne;return he+(Number((Ne=_e.curMonths)==null?void 0:Ne[me])||0)},0)),ee=Array.from({length:12},(fe,me)=>ce.rows.reduce((he,_e)=>{var Ne;return he+(Number((Ne=_e.curAmounts)==null?void 0:Ne[me])||0)},0)),re=F.reduce((fe,me)=>fe+(Number(me)||0),0),te=ee.reduce((fe,me)=>fe+(Number(me)||0),0),Z=Array.from({length:12},(fe,me)=>ce.rows.reduce((he,_e)=>{var Ne;return he+(Number((Ne=_e.dist)==null?void 0:Ne[me])||0)},0)),le=Array.from({length:12},(fe,me)=>ce.rows.reduce((he,_e)=>{var tt;const Ne=nt((_e.unit||"").trim()),Ye=Number.isFinite(Ne)?Math.round(Number(Ne)):0,Ue=Number(((tt=_e.dist)==null?void 0:tt[me])||0);return he+(Number.isFinite(Ue)&&Ye>0?Ue*Ye:0)},0)),se=Z.reduce((fe,me)=>fe+(Number(me)||0),0),ie=le.reduce((fe,me)=>fe+(Number(me)||0),0);return r.jsxs("tfoot",{children:[r.jsxs("tr",{className:"sum-row-current",children:[r.jsx("td",{colSpan:5,style:{textAlign:"center",fontWeight:700},children:"[현재] 합계"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(re,0,te)}),F.map((fe,me)=>r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(fe,me,ee[me])},me))]}),r.jsxs("tr",{className:"sum-row-apply",style:{background:"var(--panel-2)"},children:[r.jsx("td",{colSpan:5,style:{textAlign:"center",fontWeight:700},children:"[적용] 합계"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(se,0,ie)}),Z.map((fe,me)=>r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(fe,me,le[me])},me))]})]})})()]})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:Le,children:"목표등록"})}),ce.success?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"absolute",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:ce.success}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:Q,children:"확인"})})]})}):null]})}),Tt.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:za.ref,className:"card compact",style:{...za.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[r.jsx("div",{...za.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:ii,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsxs("div",{className:"page-title",style:{marginBottom:8,alignItems:"center"},children:[r.jsx("h2",{style:{margin:0},children:"목표 일괄비율"}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsx("span",{className:"muted",children:"적용 비율(%)"}),r.jsx("input",{className:"assign-input",type:"number",min:0,max:100,step:1,placeholder:"0",value:$a,onChange:E=>Ys(E.target.value),style:{width:100},"aria-label":"일괄 비율 입력"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:xr,children:"적용"})]})]}),r.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:68,textAlign:"center"},children:"구분"}),r.jsx("th",{style:{width:160,textAlign:"left"},children:"내 평균단가"}),r.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(E,F)=>F+1).map(E=>r.jsxs("th",{style:{textAlign:"right"},children:[String(E).padStart(2,"0"),"월"]},E))]})}),r.jsx("tbody",{children:Tt.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:19,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):Tt.rows.map((E,F)=>{const ee=Qe();xe[ee];const re=nt((E.unit||"").trim()),te=Number.isFinite(re)?Number(re):0,Z=Array.isArray(E.dist)?E.dist.slice():new Array(12).fill(0),le=(E.curMonths||[]).reduce((me,he)=>me+(Number.isFinite(he)?Number(he):0),0),se=(E.curAmounts||[]).reduce((me,he)=>me+(Number.isFinite(he)?Number(he):0),0),ie=Z.reduce((me,he)=>me+(Number.isFinite(he)?Number(he):0),0),fe=Z.reduce((me,he)=>me+(Number.isFinite(he)&&Number.isFinite(te)?Number(he)*te:0),0);return r.jsxs(r.Fragment,{children:[r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("span",{style:{fontSize:12},children:E.sub})}),r.jsxs("td",{children:[r.jsx("span",{style:{fontSize:12},children:E.unit}),E.stage?r.jsx("span",{className:"stage-badge",style:{marginLeft:6},title:String(E.stage),children:String(E.stage)}):null]}),r.jsx("td",{style:{textAlign:"center"},className:"muted",children:"현재"}),r.jsx("td",{className:"muted",style:{textAlign:"left"},children:(()=>{var _r;const me=Qe(),_e=(((_r=(Ce[me]||{})[(E.unit||"").trim()])==null?void 0:_r.itemStdUnit)||"").trim(),Ne=Ge(E.unit||""),Ye=xe[me]||{},Ue=Number(Ye[Ne]||0),tt=mt(),Bt=(ue==null?void 0:ue[tt])||{},ft=Number(Bt[Ne]||0),Gn=Number.isFinite(Ue)&&Ue>0?Ze.format(Math.round(Ue)):"-",Qn=Number.isFinite(ft)&&ft>0?Ze.format(Math.round(ft)):"-",ur=Number.isFinite(Ue)&&Number.isFinite(ft)?Ue>=ft?Ut:"#dc2626":Ut;return r.jsxs("span",{children:[r.jsxs("span",{style:{color:ur,fontWeight:700},children:["내단가 ",Gn," 원"]})," | 전체단가 ",Qn," 원/",_e||"단위"]})})()}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(le,0,se)}),E.curMonths.map((me,he)=>{var _e;return r.jsx("td",{children:st(me,he,(_e=E.curAmounts)==null?void 0:_e[he],E.stage==="P"?"#dc2626":void 0,E.stage==="C")},he)})]},E.key+":cur"),r.jsxs("tr",{style:{background:"var(--panel-2)"},children:[r.jsx("td",{}),r.jsx("td",{}),r.jsx("td",{style:{textAlign:"center"},className:"sum-head",children:"적용"}),r.jsx("td",{className:"muted",style:{textAlign:"left"},children:(()=>{var _r;const me=Qe(),_e=(((_r=(Ce[me]||{})[(E.unit||"").trim()])==null?void 0:_r.itemStdUnit)||"").trim(),Ne=Ge(E.unit||""),Ye=xe[me]||{},Ue=Number(Ye[Ne]||0),tt=mt(),Bt=(ue==null?void 0:ue[tt])||{},ft=Number(Bt[Ne]||0),Gn=Number.isFinite(Ue)&&Ue>0?Ze.format(Math.round(Ue)):"-",Qn=Number.isFinite(ft)&&ft>0?Ze.format(Math.round(ft)):"-",ur=Number.isFinite(Ue)&&Number.isFinite(ft)?Ue>=ft?Ut:"#dc2626":Ut;return r.jsxs("span",{children:[r.jsxs("span",{style:{color:ur,fontWeight:700},children:["내단가 ",Gn," 원"]})," | 전체단가 ",Qn," 원/",_e||"단위"]})})()}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(ie,0,fe)}),Z.map((me,he)=>{const _e=Number.isFinite(te)?Math.round(te):0,Ne=Number.isFinite(me)&&_e>0?Number(me)*_e:void 0;return r.jsx("td",{children:st(me,he,Ne,E.stage==="P"?"#dc2626":void 0,E.stage==="C")},he)})]},E.key+":prev")]})})}),(()=>{if(!Tt.rows||Tt.rows.length===0)return null;const E=Qe();xe[E];const F=Array.from({length:12},(fe,me)=>Tt.rows.reduce((he,_e)=>{var Ne;return he+(Number((Ne=_e.curMonths)==null?void 0:Ne[me])||0)},0)),ee=Array.from({length:12},(fe,me)=>Tt.rows.reduce((he,_e)=>{var Ne;return he+(Number((Ne=_e.curAmounts)==null?void 0:Ne[me])||0)},0)),re=F.reduce((fe,me)=>fe+(Number(me)||0),0),te=ee.reduce((fe,me)=>fe+(Number(me)||0),0),Z=Array.from({length:12},(fe,me)=>Tt.rows.reduce((he,_e)=>{var Ne;return he+(Number((Ne=_e.dist)==null?void 0:Ne[me])||0)},0)),le=Array.from({length:12},(fe,me)=>Tt.rows.reduce((he,_e)=>{var tt;const Ne=nt((_e.unit||"").trim()),Ye=Number.isFinite(Ne)?Math.round(Number(Ne)):0,Ue=Number(((tt=_e.dist)==null?void 0:tt[me])||0);return he+(Number.isFinite(Ue)&&Ye>0?Ue*Ye:0)},0)),se=Z.reduce((fe,me)=>fe+(Number(me)||0),0),ie=le.reduce((fe,me)=>fe+(Number(me)||0),0);return r.jsxs("tfoot",{children:[r.jsxs("tr",{className:"sum-row-current",children:[r.jsx("td",{colSpan:4,style:{textAlign:"center",fontWeight:700},children:"[현재] 합계"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(re,0,te)}),F.map((fe,me)=>r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(fe,me,ee[me])},me))]}),r.jsxs("tr",{className:"sum-row-apply",style:{background:"var(--panel-2)"},children:[r.jsx("td",{colSpan:4,style:{textAlign:"center",fontWeight:700},children:"[적용] 합계"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(se,0,ie)}),Z.map((fe,me)=>r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:st(fe,me,le[me])},me))]})]})})()]})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:Dc,children:"목표등록"})}),Tt.success?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:Tt.success}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:Q,children:"확인"})})]})}):null]})}),it.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:Ra.ref,className:"card",style:{...Ra.style,width:984,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[r.jsx("div",{...Ra.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:Ks,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h2",{style:{margin:0},children:"신규 영업관리단위"})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 120px 1fr",gap:8,alignItems:"center",fontSize:12},children:[r.jsx("div",{className:"muted",children:"영업관리단위"}),r.jsx("div",{children:r.jsxs("select",{className:"search-input",value:it.unit||"",onChange:E=>Bw(E.target.value),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),it.opts.map((E,F)=>r.jsx("option",{value:E.salesMgmtUnit,children:E.salesMgmtUnit},F))]})}),r.jsx("div",{className:"muted",children:"중분류"}),r.jsx("div",{children:r.jsx("input",{className:"assign-input",value:it.sub||"",readOnly:!0,placeholder:"자동"})}),r.jsx("div",{className:"muted",children:"매출월"}),r.jsx("div",{children:r.jsxs("select",{className:"search-input",value:it.month||"",onChange:E=>dm(E.target.value,void 0),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(E,F)=>F+1).map(E=>r.jsxs("option",{value:String(E),children:[E,"월"]},E))]})}),r.jsx("div",{className:"muted",children:"매출 수량"}),r.jsx("div",{children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:it.qty||"",onChange:E=>dm(void 0,E.target.value)}),(()=>{var Ne;const E=Qe(),F=xe[E]||{},ee=Ce[E]||{},re=(it.unit||"").trim(),te=Ge(re),Z=Number((F==null?void 0:F[te])||0),le=mt(),se=(ue==null?void 0:ue[le])||{},ie=Number(se[te]||0),fe=(((Ne=ee[re])==null?void 0:Ne.itemStdUnit)||"").trim(),me=Number.isFinite(Z)&&Z>0?Ze.format(Math.round(Z)):"-",he=Number.isFinite(ie)&&ie>0?Ze.format(Math.round(ie)):"-",_e=Number.isFinite(Z)&&Number.isFinite(ie)?Z>=ie?Ut:"#dc2626":Ut;return r.jsxs("span",{className:"muted",style:{fontSize:12,whiteSpace:"nowrap"},children:[r.jsxs("span",{style:{color:_e,fontWeight:700},children:["내단가 ",me," 원"]})," | 전체단가 ",he," 원/",fe||"단위"]})})()]})})]}),r.jsx("div",{style:{marginTop:12},children:r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsx("tr",{children:Array.from({length:12},(E,F)=>F+1).map(E=>r.jsxs("th",{style:{textAlign:"right"},children:[String(E).padStart(2,"0"),"월"]},E))})}),r.jsx("tbody",{children:r.jsx("tr",{children:it.dist.map((E,F)=>{const ee=Qe();xe[ee];const re=nt((it.unit||"").trim()),te=Number.isFinite(re)?Number(re):0,Z=Number.isFinite(te)?Math.round(te):0,le=Number.isFinite(E)&&Z>0?Number(E)*Z:void 0;return r.jsx("td",{children:st(E,F,le)},F)})})})]})})}),r.jsxs("div",{style:{marginTop:12},children:[r.jsx("div",{className:"pane-header",style:{margin:0},children:"추가된 영업관리단위"}),r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),Array.from({length:12},(E,F)=>F+1).map(E=>r.jsxs("th",{style:{textAlign:"right"},children:[String(E).padStart(2,"0"),"월"]},E))]})}),r.jsx("tbody",{children:it.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:14,className:"muted",style:{padding:"12px 10px"},children:"추가된 영업관리단위가 없습니다"})}):it.rows.map((E,F)=>r.jsxs("tr",{children:[r.jsxs("td",{children:[r.jsx("button",{className:"btn-plain","aria-label":"삭제",title:"삭제",onClick:()=>Rn(ee=>({...ee,rows:ee.rows.filter((re,te)=>te!==F)})),style:{marginRight:6,verticalAlign:"middle"},children:r.jsx("img",{src:Wt,className:"icon",alt:"삭제"})}),E.sub]}),r.jsx("td",{children:E.unit}),E.months.map((ee,re)=>{const te=Qe();xe[te];const Z=nt((E.unit||"").trim()),le=Number.isFinite(Z)?Number(Z):0,se=Number.isFinite(le)?Math.round(le):0,ie=Number.isFinite(ee)&&se>0?Number(ee)*se:void 0;return r.jsx("td",{children:st(ee,re,ie)},re)})]},F))})]})})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:[r.jsx("button",{className:"btn btn-card btn-3d",onClick:Ww,children:"추가"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:Fw,children:"목표등록"})]}),it.error?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:it.error}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>Rn(E=>({...E,error:null})),children:"확인"})})]})}):null,it.success?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:it.success}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:Q,children:"확인"})})]})}):null]})}),cr.open&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:60},children:r.jsxs("div",{ref:$c.ref,className:"card",style:{...$c.style,height:"66vh",width:760,maxWidth:"96vw",background:"var(--panel)",padding:12,borderLeft:"1px solid var(--border)",boxShadow:"-8px 0 24px rgba(0,0,0,0.18)",overflow:"hidden"},children:[r.jsx("div",{...$c.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:mm,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsxs("div",{className:"page-title",style:{marginBottom:8,display:"flex",alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,display:"flex",alignItems:"center",gap:6,fontSize:14},children:ai?r.jsxs(r.Fragment,{children:[r.jsxs("span",{style:{color:Ut,fontWeight:700,fontSize:14},children:[ai,"년"]}),r.jsx("span",{style:{fontSize:12},children:"내 평균거래 단가"})]}):r.jsx("span",{style:{fontSize:12},children:"내 평균거래 단가"})}),r.jsxs("div",{style:{marginLeft:"auto",display:"inline-flex",alignItems:"center",gap:8,flexWrap:"nowrap"},children:[r.jsx("select",{className:"search-input",value:ai,onChange:E=>hm(Number(E.target.value)),"aria-label":"평균단가 조회 연도",style:{height:28},children:[2025,2026,2027,2028,2029,2030].map(E=>r.jsxs("option",{value:E,children:[E,"년"]},E))}),r.jsxs("div",{role:"radiogroup","aria-label":"회사 구분",className:"segmented",style:{display:"inline-flex",alignItems:"center",gap:8,height:28,border:"1px solid var(--border)",borderRadius:6,padding:"0 6px"},children:[r.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:12,height:"100%"},children:[r.jsx("input",{type:"radio",name:"unit-company",value:"TNT",checked:Ba==="TNT",onChange:()=>Lc("TNT")}),r.jsx("span",{style:{fontSize:12},children:"TNT"})]}),r.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:12,height:"100%"},children:[r.jsx("input",{type:"radio",name:"unit-company",value:"DYS",checked:Ba==="DYS",onChange:()=>Lc("DYS")}),r.jsx("span",{style:{fontSize:12},children:"DYS"})]})]})]})]}),cr.error?r.jsx("div",{className:"error",style:{maxWidth:420},children:cr.error}):r.jsx("div",{className:"table-container",style:{height:"calc(66vh - 120px)",overflow:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:180,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:120,textAlign:"left"},children:"판매단위"}),r.jsx("th",{style:{width:120,textAlign:"left"},children:"표준단위"}),r.jsx("th",{style:{width:120,textAlign:"right"},children:"내평균단가(원)"}),r.jsx("th",{style:{width:120,textAlign:"right"},children:"전체단가(원)"})]})}),r.jsx("tbody",{children:cr.loading?r.jsx("tr",{children:r.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"불러오는 중…"})}):cr.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):cr.rows.map((E,F)=>r.jsxs("tr",{children:[r.jsx("td",{children:E.unit||"na"}),r.jsx("td",{children:E.itemUnit||"-"}),r.jsx("td",{children:E.itemStdUnit||"-"}),(()=>{const ee=Number(E.amountMy||0),re=Number(E.amountGlobal||0),te=Number.isFinite(ee)&&Number.isFinite(re)?ee>=re?Ut:"#dc2626":Ut;return r.jsx("td",{style:{textAlign:"right",color:te,fontWeight:700},children:Number.isFinite(ee)&&ee>0?`${Ze.format(Math.round(ee))} 원`:"-"})})(),r.jsx("td",{style:{textAlign:"right"},children:Number.isFinite(Number(E.amountGlobal))&&Number(E.amountGlobal)>0?`${Ze.format(Math.round(Number(E.amountGlobal)))} 원`:"-"})]},F))})]})})]})}),zt&&r.jsx("div",{role:"alert","aria-live":"assertive","aria-busy":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:r.jsxs("div",{className:"card",style:{padding:16,background:"var(--panel)",minWidth:280,textAlign:"center",boxShadow:"0 4px 16px rgba(0,0,0,.3)"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"초기설정 진행 중"}),r.jsx("div",{className:"muted",style:{marginBottom:12},children:Ma||"작업을 준비 중입니다…"}),r.jsx("div",{className:"muted",style:{fontSize:12},children:"작업이 완료될 때까지 다른 동작을 할 수 없습니다."})]})})]});async function Gw(){try{if(pr(!0),gr("초기설정 요청 중입니다…"),!ve||isNaN(Number(ve))){alert("연도를 선택하세요.");return}const E=localStorage.getItem("tnt.sales.assigneeId")||"";if(!E){alert("로그인이 필요합니다.");return}const F={year:Number(ve),companyType:k,upliftPercent:Math.max(0,Math.min(999,Number(Mc)||0)),versionNo:1,assigneeId:E},ee=localStorage.getItem("tnt.sales.empSeq")||"",re=localStorage.getItem("tnt.sales.empId")||"",te={"Content-Type":"application/json"};ee&&(te["X-EMP-SEQ"]=ee),re&&(te["X-EMP-ID"]=re),te["X-ASSIGNEE-ID"]=E;const Z=await fetch("/api/v1/sales/plan/init",{method:"POST",headers:te,body:JSON.stringify(F)});if(gr("초기 목표를 저장하고 있습니다…"),!Z.ok){let ie=`HTTP ${Z.status}`;try{const fe=await Z.json();fe!=null&&fe.error&&(ie=fe.error)}catch{const fe=await Z.text();fe&&(ie=fe)}throw new Error(ie)}await Z.json().catch(()=>({}));const le=(localStorage.getItem("tnt.sales.empName")||"").trim()||"사용자",se=Number(ve);K({show:!0,name:le,tnt:oe.tnt,dys:oe.dys,year:Number.isFinite(se)&&se>0?se:0,hasP:!1,hasC:!1,hasI:!0,label:"초기설정완료"});try{await ki(!0)}catch{}}catch(E){alert((E==null?void 0:E.message)||"초기설정 중 오류가 발생했습니다.")}finally{pr(!1),gr("")}}}function ZS(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const n=String(t.getFullYear()%100).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${n}-${i}-${a} ${s}:${o}`}function eN(){const[e,t]=h.useState(""),[n,i]=h.useState(""),[a,s]=h.useState(""),[o,l]=h.useState(!1),[c,d]=h.useState(null),[u,f]=h.useState([]),[m,p]=h.useState(!1),[y,v]=h.useState({open:!1,x:0,y:0}),[g,b]=h.useState(()=>new Set),[x,N]=h.useState({open:!1,x:0,y:0}),[A,C]=h.useState(void 0),[w,O]=h.useState("init"),[M,B]=h.useState({}),z=["init","sim","apply","confirm"],j=[{key:"init",label:"초기설정"},{key:"sim",label:"Simulation"},{key:"apply",label:"목표반영"},{key:"confirm",label:"확정"}],k=z.indexOf(w),L=()=>{const Y=Math.max(0,k-1);O(z[Y])},T=()=>{const Y=Math.min(z.length-1,k+1);O(z[Y])},[$,V]=h.useState(!1),[G,ne]=h.useState(null);new Date().getFullYear();const[U,I]=h.useState("prev1"),[P,D]=h.useState(()=>new Array(12).fill(0)),[S,_]=h.useState({loading:!1});async function H(){if(!(A!=null&&A.customerSeq)){D(new Array(12).fill(0));return}V(!0),ne(null);try{const Y=new Date().getFullYear(),X=U==="prev1"?[Y-1]:U==="last2"?[Y-1,Y-2]:[Y-1,Y-2,Y-3],de=[];await Promise.all(X.map(async ke=>{try{const ve=await fetch(`/api/v1/customers/${A.customerSeq}/invoice-monthly?year=${ke}`);if(!ve.ok)return;const Ie=await ve.json().catch(()=>[]),J=(Array.isArray(Ie)?Ie:[]).map(ge=>({month:Number(ge.month??0),amount:Number(ge.amount??0)}));de.push(...J)}catch{}}));const be=new Array(12).fill(0);for(const ke of de){const ve=Math.min(12,Math.max(1,Number(ke.month)||0))-1;be[ve]+=Number.isFinite(ke.amount)?Number(ke.amount):0}D(be)}catch(Y){ne(Y.message||"조회 중 오류가 발생했습니다"),D(new Array(12).fill(0))}finally{V(!1)}}h.useEffect(()=>{w==="init"&&H()},[w,A==null?void 0:A.customerSeq,U]);async function q(){if(!(A!=null&&A.customerSeq)){_({loading:!1,hasRecent:void 0,error:null});return}_({loading:!0,hasRecent:void 0,error:null});try{const Y=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);Y.searchParams.set("custSeq",String(A.customerSeq)),Y.searchParams.set("years","2");const X=await fetch(Y.toString());if(!X.ok){let ke=`HTTP ${X.status}`;try{const ve=await X.json();ve!=null&&ve.error&&(ke=ve.error)}catch{}throw new Error(ke)}const de=await X.json(),be=Array.isArray(de)&&de.some(ke=>Number((ke==null?void 0:ke.customerSeq)||(ke==null?void 0:ke.customerSeqText)||0)===Number(A.customerSeq)&&!!(ke!=null&&ke.hasRecent));_({loading:!1,hasRecent:be,error:null})}catch(Y){_({loading:!1,hasRecent:void 0,error:Y.message||"오류"})}}h.useEffect(()=>{w==="init"&&q()},[w,A==null?void 0:A.customerSeq]);const K=h.useMemo(()=>r.jsx("div",{className:"table-container",style:{border:"1px solid var(--border)",borderRadius:8,marginTop:8},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsx("tr",{children:Array.from({length:12},(Y,X)=>r.jsxs("th",{style:{width:100,textAlign:"right"},children:[String(X+1).padStart(2,"0"),"월"]},X))})}),r.jsx("tbody",{children:r.jsx("tr",{children:P.map((Y,X)=>r.jsx("td",{style:{textAlign:"right"},children:Math.round(Y).toLocaleString()},X))})})]})}),[P]);async function W(){d(null),l(!0);try{const Y=localStorage.getItem("tnt.sales.empId");if(!Y){f([]),d(gt.loginRequired);return}const X=new URL("/api/v1/customers",window.location.origin);X.searchParams.set("mineOnly","true"),X.searchParams.set("empId",Y);const de=await fetch(X.toString());if(!de.ok){let ve=`HTTP ${de.status}`;try{const Ie=await de.json();Ie!=null&&Ie.error&&(ve=Ie.error)}catch{const Ie=await de.text();Ie&&(ve=Ie)}throw new Error(ve)}const be=await de.json(),ke=Array.isArray(be)?be:[];f(ke);try{const ve=ke.map(Ie=>Number(Ie.customerSeq||0)).filter(Ie=>Number.isFinite(Ie)&&Ie>0);if(ve.length>0){const Ie=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);Ie.searchParams.set("custSeq",Array.from(new Set(ve)).join(",")),Ie.searchParams.set("years","2");const J=await fetch(Ie.toString());if(J.ok){const ge=await J.json(),Pe={};Array.isArray(ge)&&ge.forEach(Se=>{const Je=Number((Se==null?void 0:Se.customerSeq)||(Se==null?void 0:Se.customerSeqText)||0);Number.isFinite(Je)&&(Pe[Je]=!!(Se!=null&&Se.hasRecent))}),B(Pe)}else B({})}else B({})}catch{B({})}}catch(Y){d(Y.message||"조회 중 오류가 발생했습니다")}finally{l(!1)}}h.useEffect(()=>{W()},[]),h.useEffect(()=>{if(!y.open)return;const Y=()=>v({open:!1,x:0,y:0});return window.addEventListener("click",Y),()=>window.removeEventListener("click",Y)},[y.open]),h.useEffect(()=>{if(!y.open)return;const Y=X=>{X.key==="Escape"&&v({open:!1,x:0,y:0})};return window.addEventListener("keydown",Y),()=>window.removeEventListener("keydown",Y)},[y.open]),h.useEffect(()=>{const Y=X=>{((X==null?void 0:X.key)==="Escape"||(X==null?void 0:X.key)==="Esc"||(X==null?void 0:X.keyCode)===27)&&(v({open:!1,x:0,y:0}),N({open:!1,x:0,y:0}))};return document.addEventListener("keydown",Y,!0),()=>document.removeEventListener("keydown",Y,!0)},[]);async function R(Y,X){Y.preventDefault(),Y.stopPropagation(),v({open:!1,x:0,y:0});const de=Y.clientX,be=Y.clientY;N({open:!0,x:de,y:be,row:X,loading:!1,error:null,data:[]})}const oe=h.useMemo(()=>{var Y,X,de,be,ke,ve,Ie,J,ge,Pe,Se,Je,yt,jt,It;return r.jsx(r.Fragment,{children:r.jsxs("div",{className:"table-container",onClick:()=>v({open:!1,x:0,y:0}),style:{height:"100%",overflow:"auto"},children:[u.length===0?r.jsx("div",{className:"empty-state",children:gt.empty}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsx("tr",{children:r.jsx("th",{style:{width:"auto"},children:"거래처명"})})}),r.jsx("tbody",{children:u.map((ye,Ae)=>r.jsx("tr",{onClick:Oe=>{Oe.preventDefault(),Oe.stopPropagation(),C(ye),N({open:!1,x:0,y:0})},onContextMenu:Oe=>R(Oe,ye),"aria-selected":(A==null?void 0:A.customerId)===ye.customerId?!0:void 0,style:(A==null?void 0:A.customerId)===ye.customerId?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:r.jsx("td",{children:(()=>{const Oe=Number(ye.customerSeq||0);return M[Oe]?r.jsxs("span",{children:[ye.customerName," "," ","$"]}):ye.customerName})()})},Ae))})]}),x.open&&r.jsxs("div",{className:"context-menu",style:{left:x.x+6,top:x.y+6,maxWidth:420,padding:8},onClick:ye=>ye.stopPropagation(),children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 상세"}),x.error?r.jsx("div",{className:"error",style:{maxWidth:380},children:x.error}):r.jsx("table",{className:"table",style:{width:"100%"},children:r.jsxs("tbody",{children:[r.jsxs("tr",{children:[r.jsx("th",{style:{width:110,textAlign:"left"},children:"거래처번호"}),r.jsx("td",{children:((Y=x.row)==null?void 0:Y.customerId)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"사업자번호"}),r.jsx("td",{children:((X=x.row)==null?void 0:X.bizNo)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"대표자명"}),r.jsx("td",{children:((de=x.row)==null?void 0:de.ownerName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"업태"}),r.jsx("td",{children:((be=x.row)==null?void 0:be.bizKind)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"종목"}),r.jsx("td",{children:((ke=x.row)==null?void 0:ke.bizType)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"전화번호"}),r.jsx("td",{children:((ve=x.row)==null?void 0:ve.telNo)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"담당자명"}),r.jsx("td",{children:((Ie=x.row)==null?void 0:Ie.empName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"부서명"}),r.jsx("td",{children:((J=x.row)==null?void 0:J.deptName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"시/도"}),r.jsx("td",{children:((ge=x.row)==null?void 0:ge.addrProvinceName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"시/군/구"}),r.jsx("td",{children:((Pe=x.row)==null?void 0:Pe.addrCityName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"고객유형"}),r.jsx("td",{children:((Se=x.row)==null?void 0:Se.customerTypeName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"비고"}),r.jsx("td",{children:((Je=x.row)==null?void 0:Je.customerRemark)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"생성자"}),r.jsx("td",{children:((yt=x.row)==null?void 0:yt.createdBy)??""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"수정자"}),r.jsx("td",{children:((jt=x.row)==null?void 0:jt.updatedBy)??""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"생성일시"}),r.jsx("td",{children:ZS((It=x.row)==null?void 0:It.createdAt)})]})]})})]})]})})},[u,y,g,x,A,M]);return r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"목표 Simulation"}),r.jsxs("div",{className:"muted count-text",children:[u.length.toLocaleString(),"개 거래처"]})]}),c&&r.jsx("div",{className:"error",children:c||gt.errorGeneric}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[r.jsx("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:oe}),r.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:(()=>{const Y=[];for(let X=0;X<j.length;X++){const de=j[X],be=X<k,ke=X===k;Y.push(r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:X===j.length-1?"0 0 auto":"1 1 0"},children:[r.jsx("div",{title:de.label,onClick:()=>O(de.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:be||ke?"var(--accent)":"transparent",border:`2px solid ${be||ke?"var(--accent)":"var(--border)"}`,color:be||ke?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":ke?"step":void 0,children:be?"✓":X+1}),r.jsx("div",{style:{fontSize:12,color:ke||be?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:de.label}),X<j.length-1&&r.jsx("div",{style:{height:2,background:X<k?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},de.key))}return Y})()}),r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("button",{className:"btn btn-icon",onClick:L,disabled:k===0,"aria-label":"이전 단계",title:"이전 단계",children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:r.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),r.jsx("button",{className:"btn btn-icon",onClick:T,disabled:k===j.length-1,"aria-label":"다음 단계",title:"다음 단계",children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:r.jsx("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),w==="init"&&r.jsxs("section",{style:{marginTop:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:10},children:[r.jsx("b",{children:"기준매출"}),r.jsxs("select",{value:U,onChange:Y=>I(Y.target.value),style:{height:28,padding:"4px 8px",borderRadius:8,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12},"aria-label":"기준 기간 선택",children:[r.jsx("option",{value:"prev1",children:"전년"}),r.jsx("option",{value:"last2",children:"최근2년"}),r.jsx("option",{value:"last3",children:"최근3년"})]})]}),G&&r.jsx("span",{className:"error",children:G})]}),$?r.jsx("div",{className:"empty-state",style:{marginTop:8},children:"불러오는 중…"}):K]})]})]})]})}const tN="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M12%201v22'/%3e%3cpath%20d='M17%205H9.5a3.5%203.5%200%200%200%200%207H14a3.5%203.5%200%200%201%200%207H6'/%3e%3c/svg%3e",nN="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpolyline%20points='3%2017%209%2011%2013%2015%2021%207'%20/%3e%3ccircle%20cx='21'%20cy='7'%20r='1'%20/%3e%3c/svg%3e";function Qs(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const n=String(t.getFullYear()%100).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${n}-${i}-${a} ${s}:${o}`}function Bd({compact:e=!1,maxHeight:t,context:n="list",onSelect:i,autoSelectFirst:a=!0}){const[s,o]=h.useState(""),[l,c]=h.useState(""),[d,u]=h.useState(""),[f,m]=h.useState(!1),[p,y]=h.useState(null),[v,g]=h.useState([]),[b,x]=h.useState("mine"),[N,A]=h.useState({open:!1,x:0,y:0}),[C,w]=h.useState(()=>new Set),[O,M]=h.useState({open:!1,x:0,y:0}),[B,z]=h.useState({}),[j,k]=h.useState({}),[L,T]=h.useState(!1),[$,V]=h.useState(0),G=100,[ne,U]=h.useState(0),[I,P]=h.useState(!0),[D,S]=h.useState(!1),_=Te.useRef(null),[H,q]=h.useState(()=>{try{const J=localStorage.getItem("tnt.sales.selectedCustomer");if(J){const ge=JSON.parse(J),Pe=Number(ge==null?void 0:ge.customerSeq);return Number.isFinite(Pe)?Pe:null}}catch{}return null}),[K,W]=h.useState(()=>{try{const J=localStorage.getItem("tnt.sales.selectedCustomer");if(J){const ge=JSON.parse(J);return String((ge==null?void 0:ge.customerId)||"")||null}}catch{}return null}),R=h.useMemo(()=>{const J=typeof window<"u"?localStorage.getItem("tnt.sales.empName"):"",ge=typeof window<"u"?localStorage.getItem("tnt.sales.assigneeId"):"";return J||ge||""},[]);function oe(J,ge){w(Pe=>{const Se=new Set(Pe);return ge?Se.add(J):Se.delete(J),Se})}function Y(J){if(!J){w(new Set);return}const ge=new Set;v.forEach(Pe=>{Pe.customerId&&ge.add(Pe.customerId)}),w(ge)}async function X(J=!0){y(null),J?(m(!0),U(0),P(!0)):S(!0);try{const ge=localStorage.getItem("tnt.sales.assigneeId");if(!ge){g([]),y(gt.loginRequired);return}const Pe=new URL("/api/v1/customers",window.location.origin);s.trim()&&Pe.searchParams.set("name",s.trim()),l.trim()&&Pe.searchParams.set("provinceName",l.trim()),d.trim()&&Pe.searchParams.set("cityName",d.trim());const Se=b==="mine";Pe.searchParams.set("mineOnly",Se?"true":"false"),Se&&ge&&Pe.searchParams.set("assigneeId",ge),Pe.searchParams.set("limit",String(G)),Pe.searchParams.set("offset",String(J?0:ne));const Je=await fetch(Pe.toString());if(!Je.ok){let Oe=`HTTP ${Je.status}`;try{const Fe=await Je.json();Fe!=null&&Fe.error&&(Oe=Fe.error)}catch{const ze=await Je.text();ze&&(Oe=ze)}throw new Error(Oe)}const yt=await Je.json(),jt=Array.isArray(yt)?yt:[],It=[...jt].sort((Oe,Fe)=>{const ze=(Oe.customerName||"").toString(),at=(Fe.customerName||"").toString();return ze.localeCompare(at,"ko",{sensitivity:"base"})}),ye=(J?It:jt).map(Oe=>Number(Oe.customerSeq||0)).filter(Oe=>Number.isFinite(Oe)&&Oe>0),Ae=Array.from(new Set(ye)).join(",");try{if(ye.length>0){const Oe=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);Oe.searchParams.set("custSeq",Ae),Oe.searchParams.set("years","2");const Fe=new URL("/api/v1/customers/demand-flags",window.location.origin);Fe.searchParams.set("custSeq",Ae);const[ze,at]=await Promise.all([fetch(Oe.toString()),fetch(Fe.toString())]);if(ze.ok){const At=await ze.json(),Pt={};Array.isArray(At)&&At.forEach(Ze=>{const nn=Number((Ze==null?void 0:Ze.customerSeq)||0);Number.isFinite(nn)&&(Pt[nn]=!!(Ze!=null&&Ze.hasRecent))}),z(Ze=>J?Pt:{...Ze,...Pt})}else J&&z({});if(at.ok){const At=await at.json(),Pt={};Array.isArray(At)&&At.forEach(Ze=>{const nn=Number((Ze==null?void 0:Ze.customerSeq)||0);Number.isFinite(nn)&&(Pt[nn]=!!(Ze!=null&&Ze.hasDemand))}),k(Ze=>J?Pt:{...Ze,...Pt})}else J&&k({})}else J&&(z({}),k({}))}catch{J&&(z({}),k({}))}g(J?It:Oe=>[...Oe,...It]),P(jt.length>=G),U(J?G:Oe=>Oe+G),J&&!L&&It.length>0&&a&&(de(It[0]),T(!0));try{if(ge&&b==="mine"){const Oe=new URL("/api/v1/customers/count",window.location.origin);Oe.searchParams.set("mineOnly","true"),Oe.searchParams.set("assigneeId",ge);const Fe=await fetch(Oe.toString());if(Fe.ok){const ze=await Fe.json().catch(()=>({})),at=Number((ze==null?void 0:ze.total)??0);V(Number.isFinite(at)?at:0)}else V(0)}else V(0)}catch{V(0)}}catch(ge){y(ge.message||"조회 중 오류가 발생했습니다")}finally{J?m(!1):S(!1)}}h.useEffect(()=>{X(!0)},[]),h.useEffect(()=>{const J=()=>{try{const ge=localStorage.getItem("tnt.sales.selectedCustomer");if(ge){const Pe=JSON.parse(ge),Se=Number(Pe==null?void 0:Pe.customerSeq);q(Number.isFinite(Se)?Se:null),W((Pe==null?void 0:Pe.customerId)||null)}}catch{}};return window.addEventListener("tnt.sales.customer.selected",J),()=>window.removeEventListener("tnt.sales.customer.selected",J)},[]),h.useEffect(()=>{X(!0)},[b]),h.useEffect(()=>{const J=_.current;if(!J)return;function ge(){J.scrollTop+J.clientHeight>=J.scrollHeight-48&&I&&!D&&!f&&X(!1)}return J.addEventListener("scroll",ge),()=>J.removeEventListener("scroll",ge)},[I,D,f,ne,s,l,d,b]),h.useEffect(()=>{if(!N.open)return;const J=()=>A({open:!1,x:0,y:0});return window.addEventListener("click",J),()=>window.removeEventListener("click",J)},[N.open]),h.useEffect(()=>{if(!N.open)return;const J=ge=>{ge.key==="Escape"&&A({open:!1,x:0,y:0})};return window.addEventListener("keydown",J),()=>window.removeEventListener("keydown",J)},[N.open]),h.useEffect(()=>{if(!O.open)return;const J=()=>M({open:!1,x:0,y:0}),ge=Pe=>{Pe.key==="Escape"&&M({open:!1,x:0,y:0})};return window.addEventListener("click",J),window.addEventListener("keydown",ge),()=>{window.removeEventListener("click",J),window.removeEventListener("keydown",ge)}},[O.open]),h.useEffect(()=>{const J=ge=>{((ge==null?void 0:ge.key)==="Escape"||(ge==null?void 0:ge.key)==="Esc"||(ge==null?void 0:ge.keyCode)===27)&&(A({open:!1,x:0,y:0}),M({open:!1,x:0,y:0}))};return document.addEventListener("keydown",J,!0),()=>document.removeEventListener("keydown",J,!0)},[]);function de(J){try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(J||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:J}})),i&&i(J)}catch{}q((()=>{const ge=Number(J.customerSeq);return Number.isFinite(ge)?ge:null})()),W(J.customerId||null),A({open:!1,x:0,y:0}),M({open:!1,x:0,y:0})}function be(J,ge){const Pe=J.clientX,Se=J.clientY;M({open:!0,x:Pe,y:Se,row:ge,loading:!1,error:null,data:[]})}function ke(J){O.open&&M(ge=>({...ge,x:J.clientX,y:J.clientY}))}function ve(){M({open:!1,x:0,y:0})}const Ie=h.useMemo(()=>{const J=ge=>{const Pe=(ge||"").trim().toUpperCase();if(Pe!=="TNT"&&Pe!=="DYS")return null;const Se=Pe==="TNT"?"#2563eb":"#16a34a";return r.jsx("span",{"aria-label":Pe,style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:"50%",color:"#fff",fontWeight:700,fontSize:11,background:Se,flexShrink:0},children:Pe==="TNT"?"T":"D"})};return r.jsx(r.Fragment,{children:r.jsxs("div",{ref:_,className:"table-container",onClick:()=>A({open:!1,x:0,y:0}),style:{maxHeight:t??(e?"32vh":void 0),overflow:"auto"},children:[v.length===0?r.jsx("div",{className:"empty-state",children:gt.empty}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:36,textAlign:"center"},children:r.jsx("input",{type:"checkbox",checked:v.length>0&&C.size===v.length,onChange:ge=>Y(ge.target.checked)})}),r.jsx("th",{style:{width:140},children:"거래처번호"}),r.jsx("th",{style:{width:200},children:"거래처명"}),r.jsx("th",{style:{width:80},children:"추가정보"}),r.jsx("th",{style:{width:140},children:"사업자번호"}),r.jsx("th",{style:{width:120},children:"대표자명"}),r.jsx("th",{style:{width:120},children:"업태"}),r.jsx("th",{style:{width:120},children:"종목"}),r.jsx("th",{style:{width:130},children:"전화번호"}),r.jsx("th",{style:{width:120},children:"담당자명"}),r.jsx("th",{style:{width:140},children:"부서명"}),r.jsx("th",{style:{width:120},children:"시/도"}),r.jsx("th",{style:{width:120},children:"시/군/구"}),r.jsx("th",{style:{width:120},children:"고객유형"}),r.jsx("th",{children:"비고"}),r.jsx("th",{style:{width:120},children:"생성자"}),r.jsx("th",{style:{width:120},children:"수정자"}),r.jsx("th",{style:{width:180},children:"생성일시"}),r.jsx("th",{style:{width:180},children:"수정일시"})]})}),r.jsx("tbody",{children:v.map((ge,Pe)=>r.jsxs("tr",{className:Number(ge.customerSeq||0)===(H||-1)||K&&ge.customerId===K?"selected":void 0,onClick:()=>de(ge),onContextMenu:Se=>{Se.preventDefault(),Se.stopPropagation(),ve(),A({open:!0,x:Se.clientX,y:Se.clientY,row:ge})},children:[r.jsx("td",{style:{textAlign:"center"},onClick:Se=>Se.stopPropagation(),children:r.jsx("input",{type:"checkbox",checked:C.has(ge.customerId),onChange:Se=>oe(ge.customerId,Se.target.checked)})}),r.jsx("td",{onMouseEnter:Se=>be(Se,ge),onMouseMove:ke,onMouseLeave:ve,children:ge.customerId}),r.jsx("td",{children:n==="c360"?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[J(ge.companyType),r.jsx("span",{children:ge.customerName})]}):ge.customerName}),r.jsx("td",{children:(()=>{const Se=Number(ge.customerSeq||0),Je=!!B[Se],yt=!!j[Se];return!Je&&!yt?"":r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[Je&&r.jsx("img",{src:tN,className:"icon",alt:"",title:"최근2년 매출 있음",style:{width:14,height:14}}),yt&&r.jsx("img",{src:nN,className:"icon",alt:"",title:"수요 있음",style:{width:14,height:14}})]})})()}),r.jsx("td",{children:ge.bizNo||""}),r.jsx("td",{children:ge.ownerName||""}),r.jsx("td",{children:ge.bizKind||""}),r.jsx("td",{children:ge.bizType||""}),r.jsx("td",{children:ge.telNo||""}),r.jsx("td",{children:ge.empName||""}),r.jsx("td",{children:ge.deptName||""}),r.jsx("td",{children:ge.addrProvinceName||""}),r.jsx("td",{children:ge.addrCityName||""}),r.jsx("td",{children:ge.customerTypeName||""}),r.jsx("td",{children:ge.customerRemark||""}),r.jsx("td",{children:ge.createdBy??""}),r.jsx("td",{children:ge.updatedBy??""}),r.jsx("td",{children:Qs(ge.createdAt)}),r.jsx("td",{children:Qs(ge.updatedAt)})]},Pe))})]}),D&&r.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:gt.loading}),!f&&!D&&!I&&v.length>0&&r.jsx("div",{className:"muted",style:{padding:"8px 10px",textAlign:"center"},children:"마지막 데이터입니다."}),N.open&&r.jsxs("div",{className:"context-menu",style:{left:N.x+4,top:N.y+4},onClick:ge=>ge.stopPropagation(),children:[n!=="c360"?r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"context-item",onClick:()=>{try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(N.row||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:N.row}}))}catch{}const ge=document.querySelector('button[data-key="customer:c360"]');ge&&ge.click(),A({open:!1,x:0,y:0})},children:"C360"}),r.jsx("button",{className:"context-item",onClick:()=>{try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(N.row||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:N.row}}))}catch{}window.dispatchEvent(new CustomEvent("tnt.sales.navigate",{detail:{key:"sales-mgmt:receivables"}})),A({open:!1,x:0,y:0})},children:"미수현황"})]}):null,r.jsx("button",{className:"context-item",onClick:()=>{try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(N.row||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:N.row}}))}catch{}if(n==="c360")try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.create.inline",{detail:{customer:N.row}}))}catch{}else{const ge=document.querySelector('button[data-key="customer:sales-activity-new"]');ge&&ge.click()}A({open:!1,x:0,y:0})},children:"활동등록"})]}),O.open&&O.row&&r.jsxs("div",{className:"context-menu",style:{left:O.x+6,top:O.y+6,maxWidth:500,padding:10},onClick:ge=>ge.stopPropagation(),onMouseLeave:ve,children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 정보"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr",gap:6,maxWidth:480},children:[r.jsx("div",{className:"muted",children:"거래처번호"}),r.jsx("div",{children:O.row.customerId||""}),r.jsx("div",{className:"muted",children:"거래처명"}),r.jsx("div",{children:O.row.customerName||""}),O.row.customerFullName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"정식명"}),r.jsx("div",{children:O.row.customerFullName})]}):null,O.row.bizNo?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"사업자번호"}),r.jsx("div",{children:O.row.bizNo})]}):null,O.row.ownerName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"대표자명"}),r.jsx("div",{children:O.row.ownerName})]}):null,O.row.bizKind?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"업태"}),r.jsx("div",{children:O.row.bizKind})]}):null,O.row.bizType?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"종목"}),r.jsx("div",{children:O.row.bizType})]}):null,O.row.telNo?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"전화번호"}),r.jsx("div",{children:O.row.telNo})]}):null,O.row.empName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"담당자명"}),r.jsx("div",{children:O.row.empName})]}):null,O.row.deptName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"부서명"}),r.jsx("div",{children:O.row.deptName})]}):null,O.row.addrProvinceName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"시/도"}),r.jsx("div",{children:O.row.addrProvinceName})]}):null,O.row.addrCityName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"시/군/구"}),r.jsx("div",{children:O.row.addrCityName})]}):null,O.row.customerTypeName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"고객유형"}),r.jsx("div",{children:O.row.customerTypeName})]}):null,O.row.customerRemark?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"비고"}),r.jsx("div",{children:O.row.customerRemark})]}):null,O.row.createdAt?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"생성일시"}),r.jsx("div",{children:Qs(O.row.createdAt)})]}):null,O.row.updatedAt?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"수정일시"}),r.jsx("div",{children:Qs(O.row.updatedAt)})]}):null]})]})]})})},[v,N,C,O]);return r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,alignItems:"center",flex:"1 1 auto",minWidth:0},children:[r.jsxs("select",{value:b,onChange:J=>x(J.target.value),style:{height:30,padding:"2px 8px",fontSize:11,background:b==="mine"?"rgba(59,130,246,.15)":"#fff",borderRadius:8,border:b==="mine"?"1px solid var(--accent)":"1px solid var(--border)"},children:[r.jsx("option",{value:"mine",children:"내 거래처"}),r.jsx("option",{value:"hq",children:"본부 거래처"}),r.jsx("option",{value:"all",children:"전체"})]}),r.jsx("input",{className:"search-input",value:s,onChange:J=>o(J.target.value),onKeyDown:J=>{J.key==="Enter"&&X()},placeholder:"거래처명",style:{background:"#fff",borderRadius:8,border:"1px solid var(--border)"}}),r.jsx("input",{className:"search-input",value:l,onChange:J=>c(J.target.value),onKeyDown:J=>{J.key==="Enter"&&X()},placeholder:"시/도",style:{background:"#fff",borderRadius:8,border:"1px solid var(--border)",minWidth:100}}),r.jsx("input",{className:"search-input",value:d,onChange:J=>u(J.target.value),onKeyDown:J=>{J.key==="Enter"&&X()},placeholder:"시/군/구",style:{background:"#fff",borderRadius:8,border:"1px solid var(--border)",minWidth:120}}),r.jsx("button",{className:"btn",onClick:()=>X(),disabled:f,style:{height:30,padding:"0 12px"},children:"조회"}),f&&r.jsx("span",{className:"muted",style:{lineHeight:"30px"},children:gt.loading})]}),r.jsx("div",{className:"meta",style:{gap:0},children:r.jsxs("span",{className:"muted count-text",children:[b==="mine"&&R?`${R} · `:"",(b==="mine"?$:v.length).toLocaleString(),"개 거래처",C.size?` · 선택 ${C.size}건`:""]})})]}),p&&r.jsx("div",{className:"error",children:p||gt.errorGeneric}),r.jsx("div",{style:{marginTop:12},children:Ie})]})}function Mr(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const n=String(t.getFullYear()%100).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${n}-${i}-${a} ${s}:${o}`}function Wd({customerSeq:e,customerId:t,hideHeader:n=!1,hideRefresh:i=!1,enableContextMenu:a=!1}){const[s,o]=h.useState([]),[l,c]=h.useState(!1),[d,u]=h.useState(null),[f,m]=h.useState({open:!1,x:0,y:0}),p=h.useRef(null),[y,v]=h.useState(null);async function g(){u(null),c(!0);try{const C=new URL("/api/v1/sales-activities",window.location.origin);C.searchParams.set("mineOnly","false");const w=t&&t.trim()||(()=>{try{const B=localStorage.getItem("tnt.sales.selectedCustomer");if(B){const z=JSON.parse(B);return(z==null?void 0:z.customerId)||""}}catch{}return""})();C.searchParams.set("sfAccountId",w||"");const O=await fetch(C.toString());if(!O.ok){let B=`HTTP ${O.status}`;try{const z=await O.json();z!=null&&z.error&&(B=z.error)}catch{}throw new Error(B)}const M=await O.json();o(Array.isArray(M)?M:[])}catch(C){u(C.message||"조회 중 오류가 발생했습니다")}finally{c(!1)}}h.useEffect(()=>{e&&g()},[e,t]);async function b(C){try{const w=new URL("/api/v1/sales-activities",window.location.origin);w.searchParams.set("mineOnly","false");const O=t&&t.trim()||(()=>{try{const j=localStorage.getItem("tnt.sales.selectedCustomer");if(j){const k=JSON.parse(j);return(k==null?void 0:k.customerId)||""}}catch{}return""})();w.searchParams.set("sfAccountId",O||""),w.searchParams.set("parentSeq",String(C)),w.searchParams.set("includeParent","true");const M=await fetch(w.toString());if(!M.ok)return;const B=await M.json(),z=Array.isArray(B)?B:[];z.sort((j,k)=>{const L=!j.parentSeq,T=!k.parentSeq;if(L&&!T)return-1;if(!L&&T)return 1;const $=j.createdAt?new Date(j.createdAt).getTime():0;return(k.createdAt?new Date(k.createdAt).getTime():0)-$}),v(z)}catch{v([])}}h.useEffect(()=>{if(!f.open)return;const C=w=>{if(w.button!==0)return;const O=w.target;p.current&&O&&p.current.contains(O)||m({open:!1,x:0,y:0})};return window.addEventListener("mousedown",C,!0),()=>window.removeEventListener("mousedown",C,!0)},[f.open]),h.useEffect(()=>{if(!f.open)return;const C=w=>{((w==null?void 0:w.key)==="Escape"||(w==null?void 0:w.key)==="Esc"||(w==null?void 0:w.keyCode)===27)&&m({open:!1,x:0,y:0})};return document.addEventListener("keydown",C,!0),()=>document.removeEventListener("keydown",C,!0)},[f.open]),h.useEffect(()=>{if(!y)return;const C=w=>{w.key==="Escape"&&(w.preventDefault(),w.stopPropagation(),v(null))};return window.addEventListener("keydown",C,!0),()=>window.removeEventListener("keydown",C,!0)},[y]);const x=(C,w)=>C?w==="type"?{site_visit:"정기방문",opportunity:"영업기회",AR_mgmt:"채권관리",meeting:"미팅",call:"전화",email:"이메일",demo:"데모",task:"업무",other:"기타"}[C]||C:w==="status"?{scheduled:"계획",completed:"완료",canceled:"취소",postponed:"연기",no_show:"미방문"}[C]||C:w==="channel"&&{in_person:"방문",phone:"전화",email:"문자/메일/팩스",other:"기타",video:"영상",chat:"채팅",sms:"문자"}[C]||C:"",N=C=>[`제목: ${C.subject||""}`,`활동설명: ${C.description||""}`,`활동유형: ${x(C.activityType,"type")}`,`활동방법: ${x(C.channel,"channel")}`,`상태: ${x(C.activityStatus,"status")}`,`상위활동: ${C.parentSubject||""}`,`계획 일시: ${Mr(C.plannedStartAt)}`,`종료 일시: ${Mr(C.plannedEndAt)}`,`생성일시: ${Mr(C.createdAt)}`,C.customerName?`거래처명: ${C.customerName}`:""].filter(Boolean).join(`
`),A=h.useMemo(()=>r.jsxs(r.Fragment,{children:[!n&&r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[r.jsx("div",{className:"muted"}),r.jsxs("div",{className:"muted count-text",children:["총 ",s.length,"건"]})]}),r.jsx("div",{className:"table-container",children:s.length===0?r.jsx("div",{className:"empty-state",children:"활동이 없습니다."}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:240},children:"제목"}),r.jsx("th",{style:{width:280},children:"활동설명"}),r.jsx("th",{style:{width:120},children:"활동유형"}),r.jsx("th",{style:{width:120},children:"활동방법"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:220},children:"상위활동"}),r.jsx("th",{style:{width:180},children:"계획 일시"}),r.jsx("th",{style:{width:180},children:"종료 일시"}),r.jsx("th",{style:{width:180},children:"생성일시"})]})}),r.jsx("tbody",{children:s.map((C,w)=>r.jsxs("tr",{title:N(C),onContextMenu:O=>{a&&C.parentSeq&&(O.preventDefault(),O.stopPropagation(),m({open:!0,x:O.clientX,y:O.clientY,row:C}))},children:[r.jsx("td",{children:C.subject||""}),r.jsx("td",{title:C.description||"",style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:C.description||""}),r.jsx("td",{children:x(C.activityType,"type")}),r.jsx("td",{children:x(C.channel,"channel")}),r.jsx("td",{children:x(C.activityStatus,"status")}),r.jsx("td",{children:C.parentSubject||""}),r.jsx("td",{children:Mr(C.plannedStartAt)}),r.jsx("td",{children:Mr(C.plannedEndAt)}),r.jsx("td",{children:Mr(C.createdAt)})]},w))})]})})]}),[s]);return r.jsxs("section",{children:[!i&&r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("button",{className:"btn",onClick:g,disabled:l,children:l?"새로고침…":"새로고침"}),d&&r.jsx("span",{className:"error",children:d})]}),i&&d&&r.jsx("div",{className:"error",children:d}),r.jsx("div",{style:{marginTop:12},children:A}),f.open&&r.jsx("div",{ref:p,className:"context-menu",style:{left:f.x+4,top:f.y+4},onClick:C=>C.stopPropagation(),children:r.jsx("button",{className:"context-item",onClick:()=>{var C,w;(C=f.row)!=null&&C.parentSeq?b(f.row.parentSeq):(w=f.row)!=null&&w.id&&b(f.row.id),m({open:!1,x:0,y:0})},children:"관련활동"})}),y&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.4)"},onClick:()=>v(null),children:r.jsxs("div",{className:"card",style:{width:"min(1200px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:C=>C.stopPropagation(),children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsxs("div",{className:"list-title",style:{display:"flex",alignItems:"center",gap:6},children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",style:{color:"#555"},children:[r.jsx("circle",{cx:"6",cy:"6",r:"3",stroke:"currentColor",strokeWidth:"1.8"}),r.jsx("circle",{cx:"18",cy:"6",r:"3",stroke:"currentColor",strokeWidth:"1.8"}),r.jsx("circle",{cx:"12",cy:"18",r:"3",stroke:"currentColor",strokeWidth:"1.8"}),r.jsx("line",{x1:"8.5",y1:"7.4",x2:"15.5",y2:"7.4",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),r.jsx("line",{x1:"7.2",y1:"8.9",x2:"10.8",y2:"15.1",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),r.jsx("line",{x1:"16.8",y1:"8.9",x2:"13.2",y2:"15.1",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]}),r.jsx("span",{style:{fontWeight:600,fontSize:14},children:"관련활동"}),r.jsxs("span",{className:"muted count-text",style:{marginLeft:8},children:["총 ",y.length,"건"]})]}),r.jsx("button",{onClick:()=>v(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:C=>{C.currentTarget.style.background="var(--panel-2)",C.currentTarget.style.color="var(--text)"},onMouseLeave:C=>{C.currentTarget.style.background="transparent",C.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)",children:"×"})]}),r.jsx("div",{className:"table-container",children:y.length===0?r.jsx("div",{className:"empty-state",children:"관련활동이 없습니다."}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200},children:"상위활동"}),r.jsx("th",{style:{width:240},children:"제목"}),r.jsx("th",{style:{width:280},children:"활동설명"}),r.jsx("th",{style:{width:120},children:"활동유형"}),r.jsx("th",{style:{width:120},children:"활동방법"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:180},children:"계획 일시"}),r.jsx("th",{style:{width:180},children:"종료 일시"}),r.jsx("th",{style:{width:180},children:"생성일시"})]})}),r.jsx("tbody",{children:y.map((C,w)=>r.jsxs("tr",{title:N(C),className:C.parentSeq?void 0:"row-parent",children:[r.jsx("td",{children:C.parentSubject||""}),r.jsx("td",{children:C.subject||""}),r.jsx("td",{style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:C.description||""}),r.jsx("td",{children:x(C.activityType,"type")}),r.jsx("td",{children:x(C.channel,"channel")}),r.jsx("td",{children:x(C.activityStatus,"status")}),r.jsx("td",{children:Mr(C.plannedStartAt)}),r.jsx("td",{children:Mr(C.plannedEndAt)}),r.jsx("td",{children:Mr(C.createdAt)})]},`rel-${w}`))})]})})]})})]})}function rN(){const[e,t]=h.useState(null),[n,i]=h.useState("form");h.useEffect(()=>{try{const s=localStorage.getItem("tnt.sales.selectedCustomer");t(s?JSON.parse(s):null)}catch{t(null)}},[]);const a=h.useMemo(()=>e?r.jsx("section",{className:"card compact-form",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"거래처번호"}),r.jsx(Qt,{value:e.customerId||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"거래처명"}),r.jsx(Qt,{value:e.customerName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"정식명"}),r.jsx(Qt,{value:e.customerFullName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"사업자번호"}),r.jsx(Qt,{value:e.bizNo||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"대표자명"}),r.jsx(Qt,{value:e.ownerName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"고객유형"}),r.jsx(Qt,{value:e.customerTypeName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"시/도"}),r.jsx(Qt,{value:e.addrProvinceName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"시/군/구"}),r.jsx(Qt,{value:e.addrCityName||"",readOnly:!0})]}),r.jsxs("div",{className:"field row-2",children:[r.jsx("label",{children:"비고"}),r.jsx(Qt,{value:e.customerRemark||"",readOnly:!0})]})]})}):null,[e]);return r.jsxs("section",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"영업활동"}),r.jsx("div",{className:"muted count-text"})]}),a,r.jsxs("section",{className:"card sales-activity-panel",style:{marginTop:12},children:[r.jsxs("div",{className:"tabs c360-tabs",children:[r.jsx("button",{className:n==="form"?"tab active":"tab",onClick:()=>i("form"),children:"영업활동 등록"}),r.jsx("button",{className:n==="list"?"tab active":"tab",onClick:()=>i("list"),children:"영업활동"})]}),r.jsx("div",{className:"sales-activity-content",children:n==="form"?r.jsx($i,{bare:!0}):r.jsx(Wd,{customerSeq:(()=>{try{const s=localStorage.getItem("tnt.sales.selectedCustomer");if(s){const o=JSON.parse(s);return Number(o==null?void 0:o.customerSeq)||0}}catch{}return 0})(),customerId:(()=>{try{const s=localStorage.getItem("tnt.sales.selectedCustomer");if(s){const o=JSON.parse(s);return String((o==null?void 0:o.customerId)||"")}}catch{}return""})(),hideRefresh:!0,enableContextMenu:!0})})]})]})}function Cv({customerSeq:e}){const[t,n]=h.useState([]),[i,a]=h.useState(!1),[s,o]=h.useState(null),[l,c]=h.useState([]);async function d(){o(null),a(!0);try{const y=e??(()=>{try{const w=localStorage.getItem("tnt.sales.selectedCustomer");if(w){const O=JSON.parse(w);return Number(O==null?void 0:O.customerSeq)}}catch{}})();if(!y||Number.isNaN(y)){n([]),c([]),a(!1);return}const v=new URL(`/api/v1/customers/${y}/transactions`,window.location.origin),g=await fetch(v.toString());if(!g.ok){let w=`HTTP ${g.status}`;try{const O=await g.json();O!=null&&O.error&&(w=O.error)}catch{}throw new Error(w)}const b=await g.json(),x=Array.isArray(b)?b:[];n(x);let N=[];if(x.length>0){const w=new Map;x.forEach(O=>{const M=O.minorName||"na",B=w.get(M)||{qty:0,amt:0};B.qty+=Number(O.qty??O.qty??0)||0,B.amt+=Number(O.curAmt||0)||0,w.set(M,B)}),N=Array.from(w.entries()).map(([O,M])=>({name:O,qty:M.qty,amt:M.amt})),N.sort((O,M)=>M.qty-O.qty||M.amt-O.amt),c(N)}else c([]);const A=await fetch(`/api/v1/customers/${y}/transactions/summary`);let C=[];if(A.ok)try{const w=await A.json();C=(Array.isArray(w)?w:[]).map(O=>({name:O.minorName||"na",qty:Number(O.qty||0),amt:Number(O.amt||0)}))}catch{C=[]}C.sort((w,O)=>O.qty-w.qty||O.amt-w.amt),C.length>0&&c(C)}catch(y){o(y.message||"조회 중 오류가 발생했습니다")}finally{a(!1)}}h.useEffect(()=>{d()},[e]);const u=h.useMemo(()=>{const y=[...l];return y.sort((v,g)=>g.qty-v.qty||g.amt-v.amt),y},[l]),f=h.useMemo(()=>{const y=[...l];return y.sort((v,g)=>g.amt-v.amt||g.qty-v.qty),y},[l]);function m({data:y,type:v}){const b={top:10,right:10,bottom:60,left:10},x=Math.max(360,y.length*80),N=x-b.left-b.right,A=180-b.top-b.bottom,C=Math.max(1,...y.map(O=>O.value)),w=N/Math.max(1,y.length);return r.jsx("div",{style:{overflowX:"auto"},children:r.jsx("svg",{width:x,height:180,children:r.jsx("g",{transform:`translate(${b.left},${b.top})`,children:y.map((O,M)=>{const B=M*w+w*.15,z=w*.7,j=Math.max(0,O.value/C*A),k=A-j;return r.jsxs("g",{transform:`translate(${B},0)`,children:[r.jsx("rect",{x:0,y:k,width:z,height:j,fill:v==="amt"?"#4e79a7":"#f28e2b"}),r.jsx("text",{x:z/2,y:A+14,fontSize:11,textAnchor:"middle",fill:"var(--muted)",transform:`rotate(25 ${z/2},${A+14})`,children:O.name}),r.jsx("text",{x:z/2,y:k-4,fontSize:11,textAnchor:"middle",fill:"var(--text)",children:O.value.toLocaleString()})]},M)})})})})}const p=h.useMemo(()=>r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:6},children:r.jsxs("div",{className:"muted count-text",children:["총 ",t.length,"건"]})}),t.length>0&&r.jsxs("div",{className:"card",style:{padding:12,marginBottom:8},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[r.jsx("b",{children:"중분류별 금액/수량"}),r.jsx("span",{className:"muted",style:{fontSize:12},children:"가로축: 중분류"})]}),r.jsxs("div",{style:{marginTop:8},children:[r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("div",{className:"muted",style:{marginBottom:4},children:"금액"}),r.jsx(m,{type:"amt",data:f.map(y=>({name:y.name,value:y.amt}))})]}),r.jsxs("div",{children:[r.jsx("div",{className:"muted",style:{marginBottom:4},children:"수량"}),r.jsx(m,{type:"qty",data:u.map(y=>({name:y.name,value:y.qty}))})]})]})]}),r.jsx("div",{className:"table-container",children:t.length===0?r.jsx("div",{className:"empty-state",children:"거래 내역이 없습니다."}):r.jsxs("table",{className:"table transactions",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:160},children:"전표번호"}),r.jsx("th",{style:{width:160},children:"중분류"}),r.jsx("th",{children:"품목명"}),r.jsx("th",{style:{width:100,textAlign:"right"},children:"수량"}),r.jsx("th",{style:{width:160,textAlign:"right"},children:"금액"}),r.jsx("th",{style:{width:140},children:"전표일자"})]})}),r.jsx("tbody",{children:(()=>{let y="",v="",g="";const b=[];return t.forEach((x,N)=>{const A=x.invoiceNo!==y;let C="",w="",O="",M;A?(N>0&&b.push(r.jsx("tr",{className:"sep-row",children:r.jsx("td",{colSpan:6})},`sep-${N}`)),C=x.invoiceNo,w=x.invoiceDate,O=x.minorName||"na",M=void 0,y=x.invoiceNo,v=x.invoiceDate,g=x.minorName):(x.invoiceDate!==v&&(w=x.invoiceDate,v=x.invoiceDate),x.minorName!==g&&(O=x.minorName||"na",g=x.minorName),M="same-invoice"),b.push(r.jsxs("tr",{className:M,children:[r.jsx("td",{className:"col-invno",children:C}),r.jsx("td",{children:O}),r.jsx("td",{children:x.itemName}),r.jsx("td",{style:{textAlign:"right"},children:Number(x.qty??x.qty??0).toLocaleString()}),r.jsx("td",{style:{textAlign:"right"},children:Number(x.curAmt||0).toLocaleString()}),r.jsx("td",{className:"col-invdate",children:w?(()=>{const B=new Date(w);if(isNaN(B.getTime()))return w;const z=String(B.getFullYear()%100).padStart(2,"0"),j=String(B.getMonth()+1).padStart(2,"0"),k=String(B.getDate()).padStart(2,"0"),L=String(B.getHours()).padStart(2,"0"),T=String(B.getMinutes()).padStart(2,"0");return`${z}-${j}-${k} ${L}:${T}`})():""})]},`row-${N}`))}),b})()})]})})]}),[t]);return r.jsxs("div",{children:[r.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:s&&r.jsx("span",{className:"error",children:s})}),p]})}function iN(e){if(e==null)return"";const t=Number(e);return isFinite(t)?`${(t<=1?t*100:t).toLocaleString(void 0,{maximumFractionDigits:2})}%`:""}function Ev({customerName:e,refreshTick:t=0}){const[n,i]=h.useState([]),[a,s]=h.useState(!1),[o,l]=h.useState(null);async function c(){if(e!=null&&e.trim()){s(!0),l(null);try{const u=new URLSearchParams({customer:e,limit:"1000"}),f=await fetch(`/api/v1/demand?${u.toString()}`);if(!f.ok){const y=await f.json().catch(()=>({}));throw new Error((y==null?void 0:y.error)||`HTTP ${f.status}`)}const p=(await f.json()||[]).map(y=>({itemSubcategory:y.itemSubcategory??null,supplierName:y.supplierName??null,salesMgmtUnit:y.salesMgmtUnit??null,shareRate:y.shareRate??null}));i(p)}catch(u){l(u.message||"로드 중 오류가 발생했습니다")}finally{s(!1)}}}h.useEffect(()=>{c()},[e,t]);const d=h.useMemo(()=>{const u=new Set,f=new Set,m=new Map;for(const v of n){const g=v.itemSubcategory||"-",b=`${v.supplierName||"-"}|${v.salesMgmtUnit||"-"}`;u.add(g),f.add(b);const x=`${g}::${b}`;m.set(x,v.shareRate)}const p=Array.from(u).sort((v,g)=>v.localeCompare(g)),y=Array.from(f).sort((v,g)=>v.localeCompare(g));return{rows:p,cols:y,cell:m}},[n]);return r.jsxs("section",{children:[a&&r.jsx("div",{className:"muted",style:{marginBottom:8},children:"불러오는 중…"}),o&&r.jsx("div",{className:"error",style:{marginTop:8},children:o}),r.jsx("div",{className:"table-container",style:{marginTop:8,border:"1px solid var(--border)",borderRadius:8},children:r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"separate",borderSpacing:0},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{position:"sticky",left:0,background:"var(--bg)",textAlign:"left",padding:"8px 10px",zIndex:1},children:"중분류"}),d.cols.map(u=>{const[f,m]=u.split("|");return r.jsxs("th",{style:{textAlign:"center",padding:"8px 10px",whiteSpace:"nowrap"},children:[r.jsx("div",{children:f}),r.jsx("div",{className:"muted",style:{fontSize:12},children:m})]},u)})]})}),r.jsx("tbody",{children:d.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:Math.max(1,d.cols.length+1),className:"muted",style:{padding:"12px 10px"},children:a?"불러오는 중…":"데이터가 없습니다"})}):d.rows.map(u=>r.jsxs("tr",{children:[r.jsx("td",{style:{position:"sticky",left:0,background:"var(--bg)",padding:"8px 10px"},children:u}),d.cols.map(f=>{const m=`${u}::${f}`,p=d.cell.get(m)??null;return r.jsx("td",{style:{textAlign:"right",padding:"8px 10px"},children:iN(p)},f)})]},u))})]})})]})}function aN(e){if(e==null)return 0;const t=Number(e);return isFinite(t)?t<=1?t*100:t:0}const ns=["#4e79a7","#f28e2b","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab","#1f77b4","#ff7f0e"];function sN({data:e,size:t=140}){const n=t/2,i=n,a=n,s=e.filter(d=>(d.value||0)>0),o=s.reduce((d,u)=>d+Math.max(0,u.value),0)||1;if(s.length===1)return r.jsx("svg",{width:t,height:t,viewBox:`0 0 ${t} ${t}`,children:r.jsx("circle",{cx:i,cy:a,r:n,fill:ns[0],stroke:"#0b1324",strokeWidth:1})});let l=-Math.PI/2;const c=s.map((d,u)=>{const p=Math.max(0,d.value)/o*Math.PI*2,y=i+n*Math.cos(l),v=a+n*Math.sin(l),g=i+n*Math.cos(l+p),b=a+n*Math.sin(l+p),x=p>Math.PI?1:0,N=`M ${i} ${a} L ${y} ${v} A ${n} ${n} 0 ${x} 1 ${g} ${b} Z`;return l+=p,{path:N,color:ns[u%ns.length],label:d.label,value:d.value}});return r.jsx("svg",{width:t,height:t,viewBox:`0 0 ${t} ${t}`,children:c.map((d,u)=>r.jsx("path",{d:d.path,fill:d.color,stroke:"#0b1324",strokeWidth:1},u))})}function Iv({customerName:e,refreshTick:t=0}){const[n,i]=h.useState([]),[a,s]=h.useState(!1),[o,l]=h.useState(null);async function c(){s(!0),l(null);try{const u=new URLSearchParams({customer:e,limit:"1000"}),f=await fetch(`/api/v1/demand?${u.toString()}`);if(!f.ok){const y=await f.json().catch(()=>({}));throw new Error((y==null?void 0:y.error)||`HTTP ${f.status}`)}const p=(await f.json()||[]).map(y=>({itemSubcategory:y.itemSubcategory??null,supplierName:y.supplierName??null,salesMgmtUnit:y.salesMgmtUnit??null,shareRate:y.shareRate??null}));i(p)}catch(u){l(u.message||"로드 중 오류가 발생했습니다")}finally{s(!1)}}h.useEffect(()=>{e&&c()},[e,t]);const d=h.useMemo(()=>{const u=new Map;for(const f of n){const m=f.itemSubcategory||"-",p=`${f.supplierName||"-"} / ${f.salesMgmtUnit||"-"}`,y=aN(f.shareRate);u.has(m)||u.set(m,[]);const v=u.get(m),g=v.find(b=>b.label===p);g?g.value+=y:v.push({label:p,value:y})}for(const[f,m]of u)m.sort((p,y)=>y.value-p.value);return u},[n]);return e?r.jsxs("section",{className:"card",style:{marginTop:12},children:[a&&r.jsx("div",{className:"muted",children:gt.loading}),o&&r.jsx("div",{className:"error",children:o||gt.errorGeneric}),!a&&!o&&r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16},children:[Array.from(d.entries()).map(([u,f])=>r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",border:"1px solid var(--border)",borderRadius:12,padding:12,width:"calc((100% - 16px) / 2)"},children:[r.jsx("div",{style:{flex:"0 0 auto"},children:r.jsx(sN,{data:f})}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6,fontSize:13},children:u}),r.jsxs("div",{style:{fontSize:12},children:[f.slice(0,8).map((m,p)=>r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[r.jsx("span",{style:{width:10,height:10,borderRadius:2,background:ns[p%ns.length],display:"inline-block"}}),r.jsx("span",{style:{minWidth:160},children:m.label}),r.jsxs("span",{style:{color:"var(--muted)"},children:[m.value.toLocaleString(void 0,{maximumFractionDigits:2}),"%"]})]},p)),f.length>8&&r.jsxs("div",{className:"muted",children:["외 ",f.length-8,"개…"]})]})]})]},u)),d.size===0&&r.jsx("div",{className:"empty-state",children:"데이터가 없습니다"})]})]}):null}function Pv({customerName:e,customerSeq:t,empSeq:n,empName:i,onSuccess:a}){const[s,o]=h.useState([]),[l,c]=h.useState([]),[d,u]=h.useState([]),[f,m]=h.useState(""),[p,y]=h.useState(""),[v,g]=h.useState(""),[b,x]=h.useState(""),[N,A]=h.useState({subcats:!1,suppliers:!1,units:!1,submit:!1}),[C,w]=h.useState(null),[O,M]=h.useState(null);h.useEffect(()=>{async function j(){A(k=>({...k,subcats:!0})),w(null);try{const k=await fetch("/api/v1/supplier/subcategories");if(!k.ok)throw new Error(`HTTP ${k.status}`);const L=await k.json();o(L||[])}catch(k){w(k.message||"중분류 목록을 불러오지 못했습니다")}finally{A(k=>({...k,subcats:!1}))}}j()},[]),h.useEffect(()=>{if(y(""),c([]),g(""),u([]),!f)return;async function j(){A(k=>({...k,suppliers:!0})),w(null);try{const k=new URLSearchParams({subcategory:f}),L=await fetch(`/api/v1/supplier/names?${k.toString()}`);if(!L.ok)throw new Error(`HTTP ${L.status}`);const T=await L.json();c(T||[])}catch(k){w(k.message||"공급사 목록을 불러오지 못했습니다")}finally{A(k=>({...k,suppliers:!1}))}}j()},[f]),h.useEffect(()=>{if(g(""),u([]),!f||!p)return;async function j(){A(k=>({...k,units:!0})),w(null);try{const k=new URLSearchParams({subcategory:f,supplier:p}),L=await fetch(`/api/v1/supplier/units?${k.toString()}`);if(!L.ok)throw new Error(`HTTP ${L.status}`);const T=await L.json();u(T||[])}catch(k){w(k.message||"영업관리단위를 불러오지 못했습니다")}finally{A(k=>({...k,units:!1}))}}j()},[f,p]);const B=h.useMemo(()=>{if(!b)return"";const j=Number(b);if(!isFinite(j))return"숫자를 입력하세요";const k=j<=1?j*100:j;return gt.hint.sharePreview(k)},[b]);async function z(){if(M(null),w(null),!f||!p||!v){w("중분류/공급사/영업관리단위를 선택하세요");return}const j=Number(b);if(!isFinite(j)||j<=0){w("점유율을 올바르게 입력하세요");return}A(k=>({...k,submit:!0}));try{const k={customerSeq:t,customerName:e||void 0,empSeq:n&&n>0?n:void 0,empName:i||void 0,itemSubcategory:f,supplierName:p,salesMgmtUnit:v,share:j},L=await fetch("/api/v1/demand/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),T=await L.json().catch(()=>({}));if(!L.ok)throw new Error((T==null?void 0:T.error)||`HTTP ${L.status}`);M("등록되었습니다"),a&&a()}catch(k){w(k.message||"등록 중 오류가 발생했습니다")}finally{A(k=>({...k,submit:!1}))}}return r.jsxs("section",{style:{marginTop:16},children:[r.jsx("h3",{style:{marginTop:0},children:"수요등록"}),r.jsxs("div",{className:"card",style:{padding:12},children:[r.jsxs("div",{className:"form-grid",style:{gridTemplateColumns:"1fr 1fr 1fr 1fr"},children:[r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"중분류"}),r.jsxs("select",{value:f,onChange:j=>m(j.target.value),children:[r.jsx("option",{value:"",children:"선택하세요"}),s.map(j=>r.jsx("option",{value:j,children:j},j))]}),N.subcats&&r.jsx("div",{className:"muted",style:{marginTop:4},children:"불러오는 중…"})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"공급사"}),r.jsxs("select",{value:p,onChange:j=>y(j.target.value),disabled:!f||N.suppliers,children:[r.jsx("option",{value:"",children:"선택하세요"}),l.map(j=>r.jsx("option",{value:j,children:j},j))]})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"영업관리단위"}),r.jsxs("select",{value:v,onChange:j=>g(j.target.value),disabled:!f||!p||N.units,children:[r.jsx("option",{value:"",children:"선택하세요"}),d.map(j=>r.jsx("option",{value:j,children:j},j))]})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"점유율(%)"}),r.jsx(Qt,{value:b,onChange:j=>x(j),placeholder:"예: 0.25 또는 25"}),B&&r.jsx("div",{className:"muted",style:{marginTop:4},children:B})]})]}),C&&r.jsx("div",{className:"error",style:{marginTop:8},children:C||gt.errorGeneric}),O&&r.jsx("div",{className:"muted",style:{marginTop:8},children:O}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:r.jsx("button",{className:"btn",onClick:z,disabled:N.submit,children:N.submit?gt.fetching:e?`${e}에 ${gt.action.register}`:gt.action.register})})]})]})}const Tv=[{value:"Credit / Receivable",label:"신용·채권"},{value:"Pricing / Terms",label:"가격·조건"},{value:"Quality / Claim",label:"품질·클레임"},{value:"Logistics / Delivery",label:"물류·납기"},{value:"Contract / Legal",label:"계약·법무"},{value:"Relationship / Strategic",label:"관계·전략"},{value:"Operational",label:"운영 이슈"},{value:"기타",label:"기타"}],oN=e=>{if(!e)return"미정";const t=Tv.find(n=>n.value===e);return(t==null?void 0:t.label)??e},Nm={noteTitle:"",noteContent:"",noteType:"",importanceLevel:1},lN=e=>{try{const t=new Date(e),n=String(t.getFullYear()).slice(-2),i=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${n}-${i}-${a} ${s}:${o}`}catch{return e}},km=e=>e==null?"중요도 미정":["하","중","상"][Math.min(Math.max(e,0),2)];function cN({customerSeq:e,customerId:t,empName:n}){const[i,a]=h.useState([]),[s,o]=h.useState(!1),[l,c]=h.useState(null),[d,u]=h.useState(0),[f,m]=h.useState(!1),[p,y]=h.useState(!1),[v,g]=h.useState(null),[b,x]=h.useState(()=>({...Nm})),[N,A]=h.useState(null),C=h.useMemo(()=>typeof window>"u"?"":localStorage.getItem("tnt.sales.assigneeId")??"",[]),[w,O]=h.useState(null),[M,B]=h.useState(null),[z,j]=h.useState(!1);h.useEffect(()=>{if(!t){c("고객 ID가 없어 특이사항을 불러올 수 없습니다."),a([]);return}let U=!1;async function I(){o(!0),c(null);try{const P=await fetch(`/api/v1/customers/${t}/special-notes`);if(!P.ok)throw new Error(`HTTP ${P.status}`);const D=await P.json();if(U)return;const S=Array.isArray(D)?D:[];S.sort((_,H)=>new Date(H.updatedAt??H.createdAt).getTime()-new Date(_.updatedAt??_.createdAt).getTime()),a(S)}catch(P){if(U)return;c(P.message||"특이사항을 불러오지 못했습니다."),a([])}finally{U||o(!1)}}return I(),()=>{U=!0}},[t,d]);const k=async U=>{if(U.preventDefault(),!t)return;y(!0),g(null);const I=N!=null,P=C||"system";try{const D={customerId:t,customerSeq:e,noteTitle:b.noteTitle.trim()||"특이사항",noteContent:b.noteContent.trim(),noteType:b.noteType||void 0,importanceLevel:b.importanceLevel},S=I?`/api/v1/customers/${t}/special-notes/${N.id}`:`/api/v1/customers/${t}/special-notes`,_=I?"PUT":"POST";I||(D.createdBy=P),D.updatedBy=P;const H=await fetch(S,{method:_,headers:{"Content-Type":"application/json"},body:JSON.stringify(D)});if(!H.ok){const q=await H.json().catch(()=>null);throw new Error((q==null?void 0:q.error)||`HTTP ${H.status}`)}T(),u(q=>q+1)}catch(D){g(D.message||(I?"수정 중 오류가 발생했습니다.":"등록 중 오류가 발생했습니다."))}finally{y(!1)}};h.useEffect(()=>{if(!f)return;const U=I=>{I.key==="Escape"&&T()};return window.addEventListener("keydown",U),()=>window.removeEventListener("keydown",U)},[f]);const L=()=>x({...Nm}),T=()=>{m(!1),A(null),L(),g(null)},$=U=>{A(U??null),x({noteTitle:(U==null?void 0:U.noteTitle)??"",noteContent:(U==null?void 0:U.noteContent)??"",noteType:(U==null?void 0:U.noteType)??"",importanceLevel:(U==null?void 0:U.importanceLevel)??1}),g(null),m(!0)},V=U=>{O(U)},G=async()=>{if(!t||!w)return;const U=w;g(null),j(!0);try{const I=C||"system",P=await fetch(`/api/v1/customers/${t}/special-notes/${U.id}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({updatedBy:I})});if(!P.ok){const D=await P.json().catch(()=>null);throw new Error((D==null?void 0:D.error)||`HTTP ${P.status}`)}B("특이사항을 삭제했습니다."),a(D=>D.filter(S=>S.id!==U.id)),u(D=>D+1)}catch(I){g(I.message||"삭제 중 오류가 발생했습니다.")}finally{j(!1),O(null)}};h.useEffect(()=>{if(!M)return;const U=window.setTimeout(()=>B(null),4e3);return()=>window.clearTimeout(U)},[M]);const ne=U=>U==null?"unknown":U>=2?"high":U===1?"medium":"low";return r.jsxs("div",{className:"special-notes",children:[r.jsx("header",{className:"special-notes-header",children:r.jsx("button",{className:"btn btn-card btn-3d",type:"button",onClick:()=>$(),children:"신규"})}),l?r.jsx("div",{className:"empty-state",children:l}):s?r.jsx("div",{className:"empty-state",children:"특이사항을 불러오는 중입니다…"}):i.length===0?r.jsx("div",{className:"empty-state",children:"등록된 특이사항이 없습니다."}):r.jsx("div",{className:"special-notes-list",children:i.map(U=>r.jsxs("article",{className:"special-note-card",children:[r.jsxs("div",{className:"note-actions",children:[r.jsx("button",{type:"button",className:"note-edit-button","aria-label":"특이사항 수정",onClick:()=>$(U),children:"✎"}),r.jsx("button",{type:"button",className:"note-delete-button","aria-label":"특이사항 삭제",onClick:()=>V(U),children:"🗑"})]}),r.jsxs("div",{className:"note-top",children:[r.jsx("span",{className:`importance-dot level-${ne(U.importanceLevel)}`,"aria-label":`중요도 ${km(U.importanceLevel)}`,children:km(U.importanceLevel)}),r.jsxs("div",{className:"note-meta-info",children:[r.jsx("span",{className:"note-type",children:oN(U.noteType)}),r.jsx("strong",{className:"note-date",children:lN(U.updatedAt??U.createdAt)})]})]}),r.jsx("strong",{className:"note-title",children:U.noteTitle||"특이사항"}),r.jsx("p",{className:"note-content",children:U.noteContent}),r.jsxs("div",{className:"special-note-meta",children:[r.jsxs("span",{className:"meta-pill",children:[r.jsx("span",{className:"meta-icon edit-icon","aria-hidden":"true",children:"✎"}),r.jsx("span",{children:"수정자"}),r.jsx("strong",{children:U.updatedByName||U.updatedBy||"-"})]}),r.jsxs("span",{className:"meta-pill",children:[r.jsx("span",{className:"meta-icon user-icon","aria-hidden":"true",children:"👤"}),r.jsx("span",{children:"등록자"}),r.jsx("strong",{children:U.createdByName||U.createdBy})]})]})]},U.id))}),f&&r.jsx("div",{className:"overlay-modal",role:"dialog","aria-modal":"true",children:r.jsxs("div",{className:"overlay-card",children:[r.jsx("button",{type:"button",className:"modal-close","aria-label":"닫기",onClick:T,children:"×"}),r.jsx("h4",{children:"특이사항 등록"}),r.jsxs("form",{className:"special-note-form",onSubmit:k,children:[r.jsxs("label",{children:[r.jsx("span",{children:"제목"}),r.jsx("input",{type:"text",value:b.noteTitle,onChange:U=>x(I=>({...I,noteTitle:U.target.value})),placeholder:"예: 신용이슈",required:!0})]}),r.jsxs("label",{children:[r.jsx("span",{children:"유형"}),r.jsxs("select",{value:b.noteType,onChange:U=>x(I=>({...I,noteType:U.target.value})),children:[r.jsx("option",{value:"",children:"선택 안 함"}),Tv.map(U=>r.jsx("option",{value:U.value,children:U.label},U.value))]})]}),r.jsxs("label",{children:[r.jsx("span",{children:"중요도"}),r.jsxs("select",{value:b.importanceLevel,onChange:U=>x(I=>({...I,importanceLevel:Number(U.target.value)})),children:[r.jsx("option",{value:2,children:"상"}),r.jsx("option",{value:1,children:"중"}),r.jsx("option",{value:0,children:"하"})]})]}),r.jsxs("label",{children:[r.jsx("span",{children:"내용"}),r.jsx("textarea",{value:b.noteContent,onChange:U=>x(I=>({...I,noteContent:U.target.value})),rows:4,required:!0})]}),v?r.jsx("div",{className:"empty-state",children:v}):null,r.jsxs("footer",{children:[r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>m(!1),disabled:p,children:"취소"}),r.jsx("button",{type:"submit",className:"btn btn-card btn-3d",disabled:p,children:p?"등록 중…":"등록"})]})]})]})}),M&&r.jsxs("div",{className:"toast-message",children:[r.jsx("span",{children:M}),r.jsx("button",{type:"button",onClick:()=>B(null),children:"×"})]}),w&&r.jsx("div",{className:"confirm-overlay",role:"dialog","aria-modal":"true",children:r.jsxs("div",{className:"confirm-card",children:[r.jsxs("p",{children:[r.jsx("strong",{children:w.noteTitle||"특이사항"}),"을(를) 삭제하시겠습니까?",r.jsx("br",{}),"삭제하면 되돌릴 수 없습니다."]}),r.jsxs("div",{className:"confirm-actions",children:[r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>O(null),disabled:z,children:"취소"}),r.jsx("button",{type:"button",className:"btn btn-card btn-3d",onClick:G,disabled:z,children:z?"삭제 중…":"삭제"})]})]})})]})}function uN(){const[e,t]=h.useState(()=>{try{const u=localStorage.getItem("tnt.sales.selectedCustomer");return u?JSON.parse(u):null}catch{return null}}),[n,i]=h.useState("transactions"),[a,s]=h.useState(0),[o,l]=h.useState(null);h.useEffect(()=>{try{const u=localStorage.getItem("tnt.sales.selectedCustomer");t(u?JSON.parse(u):null)}catch{t(null)}},[]),h.useEffect(()=>{const u=()=>{try{const f=localStorage.getItem("tnt.sales.selectedCustomer");t(f?JSON.parse(f):null)}catch{t(null)}};return window.addEventListener("tnt.sales.customer.selected",u),()=>window.removeEventListener("tnt.sales.customer.selected",u)},[]),h.useEffect(()=>{const u=f=>{var v;const m=((v=f==null?void 0:f.detail)==null?void 0:v.customer)||e,p=(m==null?void 0:m.customerId)??(m==null?void 0:m.customer_id),y=(m==null?void 0:m.customerName)??(m==null?void 0:m.customer_name);l({sfAccountId:p?String(p):void 0,customerName:y})};return window.addEventListener("tnt.sales.activity.create.inline",u),()=>window.removeEventListener("tnt.sales.activity.create.inline",u)},[e]),h.useEffect(()=>{if(!o)return;const u=f=>{f.key==="Escape"&&(f.preventDefault(),f.stopPropagation(),l(null))};return window.addEventListener("keydown",u,!0),()=>window.removeEventListener("keydown",u,!0)},[o]);const c=h.useMemo(()=>r.jsx(Bd,{compact:!0,maxHeight:"32vh",context:"c360"}),[]),d=()=>!e||e.customerSeq==null?r.jsx("div",{className:"empty-state",children:"거래처를 선택하세요."}):n==="transactions"?r.jsx(Cv,{customerSeq:e.customerSeq}):n==="activities"?r.jsx(Wd,{customerSeq:e.customerSeq,customerId:e.customerId||"",hideRefresh:!0,enableContextMenu:!0}):n==="demand"?e.customerName?r.jsxs("div",{className:"c360-demand-stack",children:[r.jsx(Ev,{customerName:e.customerName,refreshTick:a}),r.jsx(Iv,{customerName:e.customerName,refreshTick:a}),r.jsx(Pv,{customerName:e.customerName,customerSeq:e.customerSeq,empSeq:e.empSeq,empName:e.empName||void 0,onSuccess:()=>s(u=>u+1)})]}):r.jsx("div",{className:"empty-state",children:"수요정보를 보려면 거래처명을 확인하세요."}):n==="special-notes"?r.jsx(cN,{customerSeq:e.customerSeq,customerId:e.customerId,empName:e.empName}):n==="complaint"?r.jsx("div",{className:"card",style:{padding:12},children:r.jsx("div",{className:"muted",children:"Complaint 기능은 추후 제공될 예정입니다."})}):null;return r.jsxs("section",{className:"c360",children:[c,r.jsxs("section",{className:"card c360-panel",style:{marginTop:12,minHeight:240},children:[r.jsxs("div",{className:"tabs c360-tabs",children:[r.jsx("button",{className:n==="transactions"?"tab active":"tab",onClick:()=>i("transactions"),children:"거래 내역"}),r.jsx("button",{className:n==="activities"?"tab active":"tab",onClick:()=>i("activities"),children:"영업활동"}),r.jsx("button",{className:n==="demand"?"tab active":"tab",onClick:()=>i("demand"),children:"수요정보"}),r.jsx("button",{className:n==="special-notes"?"tab active":"tab",onClick:()=>i("special-notes"),children:"특이사항"}),r.jsx("button",{className:n==="complaint"?"tab active":"tab",onClick:()=>i("complaint"),children:"Complaint"})]}),r.jsx("div",{className:`c360-tab-panel-wrapper ${n==="demand"?"c360-demand-scroll":""}`,children:r.jsx("div",{className:"c360-tab-panel",children:d()})})]}),o&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",zIndex:120,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>l(null),children:r.jsxs("div",{className:"card",style:{width:"min(920px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:u=>u.stopPropagation(),children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[r.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"영업활동 등록"}),r.jsx("button",{onClick:()=>l(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:u=>{u.currentTarget.style.background="var(--panel-2)",u.currentTarget.style.color="var(--text)"},onMouseLeave:u=>{u.currentTarget.style.background="transparent",u.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)","aria-label":"닫기",children:"×"})]}),r.jsx($i,{bare:!0,initial:o,onSaved:()=>{l(null);try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated"))}catch{}},onNoticeClose:()=>l(null)})]})})]})}function Ov({open:e,onClose:t,leadId:n,leadName:i,targetKind:a,targetCompanyType:s,editId:o,initial:l,onSaved:c}){const{ref:d,style:u,bindHeader:f,bindContainer:m}=Dn("lead.activity",e,C=>{const w=document.querySelector(".pane.center"),O=w?w.getBoundingClientRect():null,M=C.getBoundingClientRect(),B=M.width,z=M.height,j=O?O.left+(O.width-B)/2:(window.innerWidth-B)/2,k=O?O.top+Math.max(24,(O.height-z)*.2):Math.max(24,(window.innerHeight-z)*.2);return{x:j,y:k}},{persist:!1,resetOnOpen:!0});h.useEffect(()=>{if(!e)return;const C=w=>{w.key==="Escape"&&t()};return window.addEventListener("keydown",C,!0),()=>window.removeEventListener("keydown",C,!0)},[e,t]);const p=h.useCallback(()=>{o||t()},[o,t]),y=a||(n?"lead":void 0),v=(()=>{const C=(i??"").toString().trim();return C||((l==null?void 0:l.customerName)??"").toString().trim()})(),g=(s??"").toString().trim().toUpperCase(),b=y==="lead"?"잠":g.includes("TNT")?"T":g.includes("DYS")?"D":g?g.slice(0,1):"거",x=y==="lead"?"잠재고객":g||"거래처",N=y?r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:22,height:22,borderRadius:"50%",fontSize:12,fontWeight:700,background:y==="lead"?"rgba(236,72,153,.2)":"rgba(59,130,246,.2)",color:y==="lead"?"#be185d":"#1d4ed8"},title:x,children:b}):null,A=o?"영업활동":"영업활동 등록";return e?r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:11e3,pointerEvents:"none"},children:[r.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)",pointerEvents:"none"}}),r.jsxs("div",{ref:d,className:"card",style:{...u,width:"min(880px, 96vw)",maxHeight:"86vh",overflow:"auto",padding:16,pointerEvents:"auto"},...m,children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6,cursor:"move"},...f,children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[r.jsx("h3",{style:{margin:0},children:A}),v||N?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13,fontWeight:600,color:"var(--text)"},children:[v?r.jsx("span",{children:v}):null,N]}):null]}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:t,children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})})]}),r.jsx($i,{bare:!0,editId:o??void 0,leadId:n??void 0,initial:l,onNoticeClose:p,onSaved:C=>{c?c():t()}})]})]}):null}function Fa(e){if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return"";const n=t.getFullYear(),i=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0");return`${n}-${i}-${a}`}function Js(e,t=0){if(!e)return;const n=e.trim();if(!n)return;const[i,a,s]=n.split("-").map(l=>Number(l));if(!i||!a||!s)return;const o=new Date(i,a-1,s,t,0,0,0);if(!isNaN(o.getTime()))return o.toISOString()}function Am(e){if(e.type==="customer"){const t=(e.companyType??"").toString().trim(),n=t||"거래처",i=t.toUpperCase(),a=i.includes("TNT")?"T":i.includes("DYS")?"D":(i||"거")[0];return{label:n,bg:"rgba(59,130,246,.12)",color:"#1d4ed8",icon:a,iconBg:"#1d4ed8"}}return{label:"잠재",bg:"rgba(236,72,153,.12)",color:"#be185d",icon:"잠",iconBg:"#be185d"}}function dN({onClose:e,prefillAt:t}){const[n,i]=Te.useState(""),[a,s]=Te.useState([]),[o,l]=Te.useState(!1),[c,d]=Te.useState(null),[u,f]=Te.useState([]),[m,p]=Te.useState(null);async function y(){l(!0),d(null);try{const x=new URL("/api/v1/customers",window.location.origin);x.searchParams.set("mineOnly","false"),n.trim()&&x.searchParams.set("name",n.trim()),x.searchParams.set("limit","100");try{console.debug("[customer search]",x.toString())}catch{}const N=await fetch(x.toString());if(!N.ok)throw new Error(`HTTP ${N.status}`);const A=await N.json(),C=Array.isArray(A)?A.map(w=>({customerSeq:(w==null?void 0:w.customerSeq)??(w==null?void 0:w.customer_seq)??null,customerId:(w==null?void 0:w.customerId)??(w==null?void 0:w.customer_id)??null,customerName:(w==null?void 0:w.customerName)??(w==null?void 0:w.customer_name)??null,ownerName:(w==null?void 0:w.ownerName)??(w==null?void 0:w.owner_name)??null,companyType:(w==null?void 0:w.companyType)??(w==null?void 0:w.company_type)??null})).sort((w,O)=>String(w.customerName||"").localeCompare(String(O.customerName||""),"ko-KR")):[];s(C)}catch(x){d((x==null?void 0:x.message)||"조회 실패"),s([])}finally{l(!1)}}function v(x){f(N=>{const C=N.some(w=>(w.customerId||"")===(x.customerId||""))?N:[x,...N];return!m&&C.length>0&&b(C[0]),C})}function g(x){if(f(N=>N.filter(A=>(A.customerId||"")!==(x.customerId||""))),m&&(m.customerId||"")===(x.customerId||"")){const N=u.filter(A=>(A.customerId||"")!==(x.customerId||""));b(N[0]||null)}}function b(x){p(x||null);try{x&&localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify({customerId:x.customerId||"",customerName:x.customerName||""}))}catch{}}return Te.useEffect(()=>{const x=N=>{N.key==="Escape"&&e()};return window.addEventListener("keydown",x,!0),()=>window.removeEventListener("keydown",x,!0)},[e]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:12e3},children:[r.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"6%",left:"50%",transform:"translateX(-50%)",width:"min(1200px,96vw)",maxHeight:"88vh",overflow:"auto",padding:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"거래처 활동계획수립"}),r.jsx("button",{className:"btn-plain","aria-label":"닫기",title:"닫기",onClick:e,style:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:12,minHeight:520,alignItems:"start"},children:[r.jsxs("div",{className:"card",style:{padding:12,overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"거래처명",value:n,onChange:x=>i(x.target.value),onKeyDown:x=>{x.key==="Enter"&&y()},style:{flex:"0 0 220px",height:28,fontSize:12}}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button",title:"조회","aria-label":"조회",onClick:y,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("path",{d:"m21 21-4.35-4.35"})]})})]}),r.jsx("div",{className:"table-container",style:{maxHeight:240,overflowY:"auto",overflowX:"hidden",fontSize:12},children:a.length===0?r.jsx("div",{className:"empty-state",children:o?"불러오는 중…":c||"검색 결과가 없습니다"}):r.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:100},children:"회사구분"}),r.jsx("th",{style:{width:180},children:"거래처명"}),r.jsx("th",{style:{width:120},children:"대표자명"}),r.jsx("th",{style:{width:48}})]})}),r.jsx("tbody",{children:a.map((x,N)=>r.jsxs("tr",{children:[r.jsx("td",{title:x.companyType||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:x.companyType||""}),r.jsx("td",{title:x.customerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:x.customerName||""}),r.jsx("td",{title:x.ownerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:x.ownerName||""}),r.jsx("td",{style:{textAlign:"center"},children:r.jsx("span",{role:"button",tabIndex:0,className:"icon-button",title:"계획수립대상 담기","aria-label":"계획수립대상 담기",onClick:()=>v(x),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})})]},N))})]})}),r.jsxs("div",{style:{marginTop:12,fontWeight:700},children:["계획수립대상(",u.length,")"]}),r.jsx("div",{className:"table-container",style:{maxHeight:220,overflowY:"auto",overflowX:"hidden",fontSize:12},children:u.length===0?r.jsx("div",{className:"empty-state",children:"담긴 거래처가 없습니다."}):r.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:100},children:"회사구분"}),r.jsx("th",{style:{width:180},children:"거래처명"}),r.jsx("th",{style:{width:120},children:"대표자명"}),r.jsx("th",{style:{width:60},children:"작업"})]})}),r.jsx("tbody",{children:u.map((x,N)=>r.jsxs("tr",{className:m&&(m.customerId||"")===(x.customerId||"")?"selected":"",onClick:()=>b(x),children:[r.jsx("td",{title:x.companyType||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:x.companyType||""}),r.jsx("td",{title:x.customerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:x.customerName||""}),r.jsx("td",{title:x.ownerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:x.ownerName||""}),r.jsx("td",{style:{textAlign:"center"},children:r.jsx("span",{role:"button",tabIndex:0,className:"icon-button",title:"삭제","aria-label":"삭제",onClick:A=>{A.stopPropagation(),g(x)},children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})})})]},N))})]})})]}),r.jsxs("div",{className:"card plan-compact-card",style:{overflow:"auto"},children:[!m&&r.jsx("div",{className:"empty-state",children:"좌측에서 거래처를 선택해 주세요."}),r.jsx($i,{bare:!0,initial:{plannedStartAt:t||void 0,...m?{sfAccountId:m.customerId||"",customerName:m.customerName||"",subject:m!=null&&m.customerName?`${m.customerName} (활동계획) 으로 저장됩니다.`:""}:{}},lockSubject:!0,planMode:!0,multiTargets:u})]})]})]})]})}function fN(e){const t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=t.getDay()||7;return n!==1&&t.setDate(t.getDate()-(n-1)),t.setHours(0,0,0,0),t}function hN(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),n=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-n);const i=new Date(Date.UTC(t.getUTCFullYear(),0,1)),a=Math.ceil(((t.getTime()-i.getTime())/864e5+1)/7);return{year:t.getUTCFullYear(),week:a}}function mN(e){const t=e.getFullYear(),n=e.getMonth()+1;return`${t}년 ${n}월`}function pN(e){return String(e.getDate())}const gN=Array.from({length:24},(e,t)=>t),ra=60,Cm=18,Fc=18;function yN(){const[e,t]=Te.useState(()=>new Date),n=Te.useMemo(()=>hN(e),[e]),i=Te.useMemo(()=>fN(e),[e]),a=Te.useMemo(()=>{const ae=new Date(i);return ae.setDate(i.getDate()+6),ae.setHours(23,59,59,999),ae},[i]),s=Te.useMemo(()=>Array.from({length:7}).map((ae,je)=>{const xe=new Date(i);return xe.setDate(i.getDate()+je),xe}),[i]),o=Te.useRef(null),[l,c]=Te.useState(()=>({open:!1,x:0,y:0})),d=Te.useRef(null),[u,f]=Te.useState(!1),[m,p]=Te.useState(!1),[y,v]=Te.useState([]),[g,b]=Te.useState(""),[x,N]=Te.useState([]),[A,C]=Te.useState(""),[w,O]=Te.useState(""),[M,B]=Te.useState(""),[z,j]=Te.useState(""),[k,L]=Te.useState(""),[T,$]=Te.useState(""),[V,G]=Te.useState(""),[ne,U]=Te.useState(!1),[I,P]=Te.useState(null),[D,S]=Te.useState(null),[_,H]=Te.useState(null),[q,K]=Te.useState(""),[W,R]=Te.useState([]),[oe,Y]=Te.useState(!1),[X,de]=Te.useState(null),[be,ke]=Te.useState([]),[ve,Ie]=Te.useState(null),[J,ge]=Te.useState([]),[Pe,Se]=Te.useState([]),[Je,yt]=Te.useState(null),[jt,It]=Te.useState(null),[ye,Ae]=Te.useState(""),[Oe,Fe]=Te.useState(null),[ze,at]=Te.useState(""),[At,Pt]=Te.useState(void 0),[Ze,nn]=Te.useState(!1),Ht=Te.useRef(null),Yt=Te.useMemo(()=>{const ae=new Array(24).fill(0).map(()=>ra);if(!J||J.length===0)return ae;const je=new Array(24).fill(0),xe=new Date(i.getFullYear(),i.getMonth(),i.getDate());for(let qe=0;qe<24;qe++){let ue=0;for(let Re=0;Re<7;Re++){const Ce=new Date(xe);Ce.setDate(Ce.getDate()+Re);const Ve=Ce.getFullYear(),Ge=Ce.getMonth(),nt=Ce.getDate(),Qe=J.reduce((Rt,mt)=>{if(!mt.plannedStartAt)return Rt;const dt=new Date(mt.plannedStartAt);return dt.getFullYear()===Ve&&dt.getMonth()===Ge&&dt.getDate()===nt&&dt.getHours()===qe?Rt+1:Rt},0);Qe>ue&&(ue=Qe)}je[qe]=ue}for(let qe=0;qe<24;qe++){const ue=Math.max(0,je[qe]-1);ae[qe]=Math.min(ra+ue*Fc,ra+64)}return ae},[J,i]),Ct=Te.useMemo(()=>{const ae=[0];for(let je=0;je<24;je++)ae[je+1]=ae[je]+(Yt[je]||ra);return ae},[Yt]),yn=Te.useCallback(async()=>{try{const ae=localStorage.getItem("tnt.sales.assigneeId")||"",je=localStorage.getItem("tnt.sales.empId")||"",xe=new URL("/api/v1/sales-activities",window.location.origin);ae?xe.searchParams.set("assigneeId",ae):je&&xe.searchParams.set("empId",je),xe.searchParams.set("mineOnly","true"),xe.searchParams.set("start",i.toISOString()),xe.searchParams.set("end",a.toISOString()),xe.searchParams.set("_t",Date.now().toString());const qe=await fetch(xe.toString(),{cache:"no-cache"});if(!qe.ok)throw new Error(`HTTP ${qe.status}`);const ue=await qe.json(),Re=Array.isArray(ue)?ue:[];ge(Re.map(Ce=>{const Ve=Ce.plannedStartAt||Ce.planned_start_at,Ge=(Ce.activityStatus||Ce.activity_status||"").toString().toLowerCase(),nt=Ge==="completed"||Ge==="완료";return{id:Number(Ce.id),subject:Ce.subject,description:Ce.description,activityType:Ce.activityType||Ce.activity_type,activityStatus:Ce.activityStatus||Ce.activity_status,channel:Ce.channel,plannedStartAt:Ve?new Date(Ve).toISOString():void 0,plannedEndAt:Ce.plannedEndAt||Ce.planned_end_at||null,actualStartAt:Ce.actualStartAt||Ce.actual_start_at||void 0,sfAccountId:Ce.sfAccountId||Ce.sf_account_id||void 0,customerName:Ce.customerName||Ce.customer_name||"",leadId:Ce.sfLeadId||Ce.sf_lead_id||null,companyType:Ce.companyType||Ce.company_type||Ce.companyTypeName||Ce.company_type_name||null,isCompleted:nt}}))}catch{ge([])}},[i,a]),or=Te.useCallback(async()=>{try{const ae=localStorage.getItem("tnt.sales.assigneeId")||localStorage.getItem("tnt.sales.empId")||"";if(!ae){Se([]);return}const je=new URL("/api/v1/region-activity-plans",window.location.origin);je.searchParams.set("assigneeId",ae),je.searchParams.set("start",i.toISOString()),je.searchParams.set("end",a.toISOString());const xe=await fetch(je.toString());if(!xe.ok)throw new Error(`HTTP ${xe.status}`);const qe=await xe.json(),ue=Array.isArray(qe)?qe:[];Se(ue.map(Re=>({id:Number(Re.id),subject:Re.subject,plannedStartAt:Re.planned_start_at||Re.plannedStartAt||null,plannedEndAt:Re.planned_end_at||Re.plannedEndAt||null,actualStartAt:Re.actual_start_at||Re.actualStartAt||null,actualEndAt:Re.actual_end_at||Re.actualEndAt||null,isCompleted:!!(Re.actual_start_at||Re.actualStartAt||Re.actual_end_at||Re.actualEndAt)})))}catch{Se([])}},[i,a]);Te.useEffect(()=>{yn()},[yn]),Te.useEffect(()=>{or()},[or]),Te.useEffect(()=>{const ae=()=>{try{yn()}catch{}};return window.addEventListener("tnt.sales.activity.updated",ae),()=>window.removeEventListener("tnt.sales.activity.updated",ae)},[yn]);const Ji=`${n.week}주차`,Zi=mN(e),zt=Te.useCallback(()=>{t(ae=>{const je=new Date(ae);return je.setDate(je.getDate()-7),je})},[]),pr=Te.useCallback(()=>{t(ae=>{const je=new Date(ae);return je.setDate(je.getDate()+7),je})},[]),Ma=Te.useCallback(()=>{t(new Date)},[]);Te.useEffect(()=>{function ae(xe){let qe=xe;for(;qe;){const ue=(qe.tagName||"").toLowerCase();if(["input","textarea","select","button","label","a"].includes(ue)||qe!=null&&qe.isContentEditable)return!0;qe=qe.parentElement}return!1}function je(xe){const qe=xe.target;ae(qe)||ae(document.activeElement)||(xe.key==="ArrowLeft"?(xe.preventDefault(),zt()):xe.key==="ArrowRight"&&(xe.preventDefault(),pr()))}return window.addEventListener("keydown",je,!0),()=>window.removeEventListener("keydown",je,!0)},[zt,pr]);const gr=Te.useRef(!1);Te.useEffect(()=>{if(gr.current)return;const ae=o.current;if(!ae)return;const je=Ct[7]||7*ra;let xe=0;const qe=30,ue=()=>{if(ae){if(ae.scrollTop=je,xe+=1,Math.abs(ae.scrollTop-je)<2||xe>=qe){gr.current=!0;return}setTimeout(()=>requestAnimationFrame(ue),50)}};requestAnimationFrame(ue)},[Ct]),Te.useEffect(()=>{if(!l.open)return;const ae=xe=>{const qe=(xe==null?void 0:xe.target)||null;d.current&&qe&&d.current.contains(qe)||c({open:!1,x:0,y:0})},je=xe=>{xe.key==="Escape"&&ae()};return window.addEventListener("click",ae,!0),window.addEventListener("contextmenu",ae,!0),window.addEventListener("keydown",je,!0),()=>{window.removeEventListener("click",ae,!0),window.removeEventListener("contextmenu",ae,!0),window.removeEventListener("keydown",je,!0)}},[l.open]);const yr=Te.useCallback(async()=>{try{const ae=await fetch("/api/v1/address/provinces"),je=ae.ok?await ae.json():[],xe=Array.isArray(je)?je.filter(Boolean):[];v(xe)}catch{v([])}},[]),Pn=Te.useCallback(async ae=>{try{if(!ae){N([]);return}const je=new URL("/api/v1/address/districts",window.location.origin);je.searchParams.set("province",ae);const xe=await fetch(je.toString()),qe=xe.ok?await xe.json():[],ue=Array.isArray(qe)?qe.filter(Boolean):[];N(ue)}catch{N([])}},[]),lr=Te.useCallback(()=>{O(""),B(""),j(""),L(""),$(""),G(""),P(null),ke([]),H(null)},[]),st=Te.useCallback(()=>{lr();const ae=ve?Fa(ve):"";j(ae),b(""),C(""),N([]),p(!0),yr()},[ve,yr,lr]),Xn=Te.useCallback(()=>{lr(),S(null),p(!1)},[lr]);Te.useEffect(()=>{if(!m)return;const ae=je=>{je.key==="Escape"&&(je.preventDefault(),Xn())};return window.addEventListener("keydown",ae,!0),()=>window.removeEventListener("keydown",ae,!0)},[m,Xn]);const ji=Te.useCallback(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||localStorage.getItem("tnt.sales.empId")||""}catch{return""}},[]);Te.useEffect(()=>{if(!m||w&&w.trim().length>0||!g)return;const ae=A?`${g} ${A}`:g;O(`${ae} 지역활동`)},[m,w,g,A]);async function Tr(ae){try{const je=await fetch(`/api/v1/region-activity-plans/${ae}`);if(!je.ok)throw new Error(`HTTP ${je.status}`);const xe=await je.json();lr(),H(ae),O((xe==null?void 0:xe.subject)||""),B((xe==null?void 0:xe.description)||"");const qe=(xe==null?void 0:xe.addrProvinceName)||(xe==null?void 0:xe.addr_province_name)||"",ue=(xe==null?void 0:xe.addrDistrictName)||(xe==null?void 0:xe.addr_district_name)||"";await yr(),b(qe),qe?await Pn(qe):N([]),C(ue),j(xe!=null&&xe.planned_start_at?Fa(xe.planned_start_at):""),L(xe!=null&&xe.planned_end_at?Fa(xe.planned_end_at):""),$(xe!=null&&xe.actual_start_at?Fa(xe.actual_start_at):""),G(xe!=null&&xe.actual_end_at?Fa(xe.actual_end_at):"");const Re=Array.isArray(xe==null?void 0:xe.targets)?xe.targets:[];ke(Re.map((Ce,Ve)=>{const Ge=(Ce==null?void 0:Ce.customerId)||(Ce==null?void 0:Ce.customer_id)||"",nt=(Ce==null?void 0:Ce.leadId)||(Ce==null?void 0:Ce.lead_id)||"",Qe=Ge?"customer":"lead";return{key:Ge?`customer-${Ge}`:nt?`lead-${nt}`:`target-${Ve}-${ae}`,type:Qe,name:(Ce==null?void 0:Ce.displayName)||(Ce==null?void 0:Ce.display_name)||Ge||nt||"(대상)",companyType:(Ce==null?void 0:Ce.companyType)||(Ce==null?void 0:Ce.company_type)||null,customerId:Ge||void 0,leadId:nt||void 0}})),p(!0)}catch(je){window.alert((je==null?void 0:je.message)||"지역활동 계획을 불러오지 못했습니다.")}}async function La(){const ae=w.trim();if(!ae){P("제목을 입력해 주세요."),S(null);return}if(!g){P("방문 도(Province)를 선택해 주세요."),S(null);return}if(!A){P("방문 시/군/구(District)를 선택해 주세요."),S(null);return}const je=ji().trim();if(!je){P("담당자 정보를 확인할 수 없습니다. 다시 로그인해 주세요."),S(null);return}const xe={subject:ae,addrProvinceName:g,addrDistrictName:A,assigneeId:je},qe=M==null?void 0:M.trim();qe&&(xe.description=qe);const ue=Js(z,8),Re=Js(k);ue&&(xe.plannedStartAt=ue),Re&&(xe.plannedEndAt=Re);const Ce=Js(T),Ve=Js(V);Ce&&(xe.actualStartAt=Ce),Ve&&(xe.actualEndAt=Ve);const Ge=be.map(Qe=>Qe.type==="customer"&&Qe.customerId?{customerId:Qe.customerId}:Qe.type==="lead"&&Qe.leadId?{leadId:Qe.leadId}:null).filter(Boolean);Ge.length>0&&(xe.targets=Ge);const nt=Number(je);Number.isNaN(nt)||(_||(xe.createdBy=nt),xe.updatedBy=nt),U(!0),P(null),S(null);try{const Qe=_?`/api/v1/region-activity-plans/${_}`:"/api/v1/region-activity-plans",mt=await fetch(Qe,{method:_?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(xe)});let dt=null;try{dt=await mt.json()}catch{dt=null}if(!mt.ok){const dn=(dt==null?void 0:dt.message)||(dt==null?void 0:dt.error)||`HTTP ${mt.status}`;throw new Error(dn)}S(_?"지역활동 계획이 수정되었습니다.":"지역활동 계획이 등록되었습니다."),P(null),await or()}catch(Qe){P((Qe==null?void 0:Qe.message)||"등록에 실패했습니다."),S(null)}finally{U(!1)}}async function Or(){const ae=q.trim();if(!ae){de("검색어를 입력해 주세요."),R([]);return}Y(!0),de(null);try{const[je,xe]=await Promise.all([(async()=>{const ue=new URL("/api/v1/customers",window.location.origin);ue.searchParams.set("mineOnly","false"),ue.searchParams.set("limit","50"),ue.searchParams.set("name",ae);const Re=await fetch(ue.toString());if(!Re.ok)throw new Error(`거래처 조회 실패 (HTTP ${Re.status})`);const Ce=await Re.json();return Array.isArray(Ce)?Ce:[]})(),(async()=>{const ue=new URL("/api/v1/leads",window.location.origin);ue.searchParams.set("limit","50"),ue.searchParams.set("company_name",ae);const Re=await fetch(ue.toString());if(!Re.ok)throw new Error(`잠재고객 조회 실패 (HTTP ${Re.status})`);const Ce=await Re.json();return Array.isArray(Ce)?Ce:[]})()]),qe=[...je.map((ue,Re)=>{const Ce=(ue==null?void 0:ue.customerId)??(ue==null?void 0:ue.customer_id)??(ue==null?void 0:ue.customerSeq)??(ue==null?void 0:ue.customer_seq)??"",Ve=Ce!=null?String(Ce).trim():"",Ge=Ve?`customer-${Ve}`:`customer-${Re}-${Math.random().toString(36).slice(2)}`,nt=(ue==null?void 0:ue.companyType)??(ue==null?void 0:ue.company_type)??(ue==null?void 0:ue.companyTypeName)??(ue==null?void 0:ue.company_type_name)??(ue==null?void 0:ue.companyClass)??(ue==null?void 0:ue.company_class)??(ue==null?void 0:ue.companyGroup)??(ue==null?void 0:ue.company_group)??null;return{key:Ge,type:"customer",name:(ue==null?void 0:ue.customerName)??(ue==null?void 0:ue.customer_name)??"(이름 없음)",companyType:nt!=null?String(nt):null,customerId:Ve||void 0}}),...xe.map((ue,Re)=>{const Ce=(ue==null?void 0:ue.id)??(ue==null?void 0:ue.lead_id)??"",Ve=Ce!=null?String(Ce).trim():"";return{key:Ve?`lead-${Ve}`:`lead-${Re}-${Math.random().toString(36).slice(2)}`,type:"lead",name:(ue==null?void 0:ue.company_name)??(ue==null?void 0:ue.companyName)??(ue==null?void 0:ue.contact_name)??"(이름 없음)",leadId:Ve||void 0}})];R(qe),qe.length===0&&de("조회 결과가 없습니다.")}catch(je){de((je==null?void 0:je.message)||"조회에 실패했습니다."),R([])}finally{Y(!1)}}function wi(ae){ke(je=>je.some(xe=>xe.key===ae.key)?je:[...je,ae])}function vr(ae){ke(je=>je.filter(xe=>xe.key!==ae))}const Si=Te.useCallback(ae=>{yt(ae.id);const je=ae.leadId?"lead":"customer";Ht.current!==ae.id?(It(ae.leadId??null),Ae(ae.customerName||""),Fe(je),at(je==="customer"&&ae.companyType||""),Pt({id:ae.id,subject:ae.subject,description:ae.description,activityType:ae.activityType,activityStatus:ae.activityStatus,channel:ae.channel,plannedStartAt:ae.plannedStartAt,actualStartAt:ae.actualStartAt,sfAccountId:ae.sfAccountId,customerName:ae.customerName}),Ht.current=ae.id):Fe(je),nn(!0)},[]),ht=Te.useCallback(()=>{nn(!1),yt(null),It(null),Ae(""),Fe(null),at(""),Pt(void 0),Ht.current=null},[]),Kt=Te.useMemo(()=>{const ae=J.length,je=J.filter(Ve=>Ve.isCompleted).length,xe=Pe.length,qe=Pe.filter(Ve=>Ve.isCompleted).length,ue=ae+xe,Re=je+qe,Ce=ue>0?Math.round(Re/ue*100):0;return{customerTotal:ae,customerCompleted:je,regionTotal:xe,regionCompleted:qe,totalPlanned:ue,totalCompleted:Re,achievementRate:Ce}},[J,Pe]);return r.jsxs("section",{className:"activity-plan-page",children:[r.jsx("div",{className:"card",style:{padding:"12px 16px",marginBottom:12,flexShrink:0},children:r.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[r.jsx("button",{onClick:zt,title:"이전 주",style:{width:32,height:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"var(--text)",transition:"background-color 0.2s"},onMouseEnter:ae=>ae.currentTarget.style.backgroundColor="var(--hover)",onMouseLeave:ae=>ae.currentTarget.style.backgroundColor="transparent",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{onClick:pr,title:"다음 주",style:{width:32,height:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"var(--text)",transition:"background-color 0.2s"},onMouseEnter:ae=>ae.currentTarget.style.backgroundColor="var(--hover)",onMouseLeave:ae=>ae.currentTarget.style.backgroundColor="transparent",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})}),r.jsx("button",{className:"btn",onClick:Ma,style:{marginLeft:4},children:"오늘"}),r.jsxs("span",{className:"badge",style:{marginLeft:"auto"},children:[Zi," ",Ji]})]})}),r.jsxs("div",{className:"activity-kpi-grid",children:[r.jsxs("div",{className:"card kpi-card",style:{background:"linear-gradient(135deg, rgba(59,130,246,0.1) 0%, rgba(147,51,234,0.1) 100%)"},children:[r.jsx("div",{className:"kpi-label",children:"주간 달성률"}),r.jsxs("div",{className:"kpi-value",children:[r.jsx("span",{className:"kpi-number",children:Kt.achievementRate}),r.jsx("span",{className:"kpi-unit",children:"%"})]}),r.jsxs("div",{className:"kpi-desc",children:["목표 ",Kt.totalPlanned,"건 / 완료 ",Kt.totalCompleted,"건"]})]}),r.jsxs("div",{className:"card kpi-card",children:[r.jsx("div",{className:"kpi-label",children:"거래처 활동"}),r.jsxs("div",{className:"kpi-stats",children:[r.jsxs("div",{children:[r.jsx("div",{className:"kpi-stat-label",style:{color:"#dc2626"},children:"목표"}),r.jsx("div",{className:"kpi-stat-value",style:{color:"#dc2626"},children:Kt.customerTotal})]}),r.jsx("div",{className:"kpi-arrow",children:"→"}),r.jsxs("div",{children:[r.jsx("div",{className:"kpi-stat-label",style:{color:"#2563eb"},children:"완료"}),r.jsx("div",{className:"kpi-stat-value",style:{color:"#2563eb"},children:Kt.customerCompleted})]})]}),r.jsx("div",{className:"kpi-progress",children:r.jsx("div",{style:{width:`${Kt.customerTotal>0?Kt.customerCompleted/Kt.customerTotal*100:0}%`,background:"linear-gradient(90deg, #dc2626 0%, #2563eb 100%)"}})})]}),r.jsxs("div",{className:"card kpi-card",children:[r.jsx("div",{className:"kpi-label",children:"지역 활동"}),r.jsxs("div",{className:"kpi-stats",children:[r.jsxs("div",{children:[r.jsx("div",{className:"kpi-stat-label",style:{color:"#dc2626"},children:"목표"}),r.jsx("div",{className:"kpi-stat-value",style:{color:"#dc2626"},children:Kt.regionTotal})]}),r.jsx("div",{className:"kpi-arrow",children:"→"}),r.jsxs("div",{children:[r.jsx("div",{className:"kpi-stat-label",style:{color:"#10b981"},children:"완료"}),r.jsx("div",{className:"kpi-stat-value",style:{color:"#10b981"},children:Kt.regionCompleted})]})]}),r.jsx("div",{className:"kpi-progress",children:r.jsx("div",{style:{width:`${Kt.regionTotal>0?Kt.regionCompleted/Kt.regionTotal*100:0}%`,background:"linear-gradient(90deg, #dc2626 0%, #10b981 100%)"}})})]})]}),r.jsxs("div",{className:"card",style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",minHeight:0},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px repeat(7, 1fr)",background:"var(--panel)",borderBottom:"1px solid var(--border)",flex:"0 0 auto"},children:[r.jsx("div",{style:{padding:8,fontSize:12,color:"var(--text-muted)"},children:"시간"}),s.map((ae,je)=>r.jsx("div",{style:{padding:8,textAlign:"center",borderLeft:je>0?"1px solid var(--border)":"none"},children:r.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[["월","화","수","목","금","토","일"][je]," ",pN(ae)]})},je))]}),r.jsx("div",{ref:o,className:"calendar-scroll",onContextMenu:ae=>{ae.preventDefault();const je=ae.target;let xe=null,qe=null;const ue=Ve=>{var mt,dt;if(!Ve)return!1;const Ge=Ve.getAttribute("data-day")||((mt=Ve.dataset)==null?void 0:mt.day),nt=Ve.getAttribute("data-hour")||((dt=Ve.dataset)==null?void 0:dt.hour),Qe=Ge?parseInt(Ge,10):NaN,Rt=nt?parseInt(nt,10):NaN;return!Number.isNaN(Qe)&&!Number.isNaN(Rt)?(xe=Qe,qe=Rt,!0):!1},Re=je?je.closest(".week-event"):null,Ce=je?je.closest(".week-cell"):null;if(!(ue(Re)||ue(Ce))){const Ve=o.current;if(Ve){const Ge=Ve.getBoundingClientRect(),nt=ae.clientX-Ge.left,Qe=ae.clientY-Ge.top+Ve.scrollTop,Rt=nt-60,mt=Math.max(1,(Ge.width-60)/7),dt=Math.floor(Rt/mt);let Dr=0;for(let dn=0;dn<24&&Qe>=Ct[dn];dn++)Dr=dn;dt>=0&&dt<=6&&Dr>=0&&Dr<=23&&(xe=dt,qe=Dr)}}if(xe!=null&&qe!=null){const Ve=new Date(i);Ve.setDate(Ve.getDate()+xe),Ve.setHours(qe,0,0,0),Ie(new Date(Ve).toISOString())}c({open:!0,x:ae.clientX,y:ae.clientY})},style:{flex:1,overflowY:"scroll",overflowX:"hidden",minHeight:0},children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px repeat(7, 1fr)",gridTemplateRows:Yt.map(ae=>`${ae}px`).join(" "),position:"relative"},children:[gN.map(ae=>r.jsxs(Te.Fragment,{children:[r.jsxs("div",{style:{gridColumn:"1",gridRow:`${ae+1}`,height:Yt[ae]||ra,padding:"4px 8px",fontSize:11,color:"var(--text-muted)",borderTop:"1px solid var(--border)"},children:[String(ae).padStart(2,"0"),":00"]}),s.map((je,xe)=>r.jsx("div",{className:"week-cell","data-day":xe,"data-hour":ae,style:{gridColumn:`${xe+2}`,gridRow:`${ae+1}`,borderTop:"1px solid var(--border)",borderLeft:"1px solid var(--border)"}},`${ae}-${xe}`))]},ae)),(()=>{const ae=new Map,je=J.map(ue=>{if(!ue.plannedStartAt)return null;const Re=new Date(ue.plannedStartAt),Ce=Math.floor((new Date(Re.getFullYear(),Re.getMonth(),Re.getDate()).getTime()-new Date(i.getFullYear(),i.getMonth(),i.getDate()).getTime())/864e5);if(Ce<0||Ce>6)return null;const Ve=Re.getHours(),Ge=`${Ce}-${Ve}`,nt=ae.get(Ge)||0;ae.set(Ge,nt+1);const Qe=ue.isCompleted?"(완)":"(계)",Rt=ue.isCompleted?"#2563eb":"#dc2626";return r.jsxs("div",{className:"week-event","data-day":Ce,"data-hour":Ve,onDoubleClick:mt=>{mt.stopPropagation(),Si(ue)},style:{gridColumn:`${Ce+2}`,gridRow:`${Ve+1}`,height:Cm,padding:"0 6px",fontSize:10,background:"rgba(59,130,246,.12)",border:"1px solid var(--accent)",borderRadius:6,margin:1,marginTop:nt*Fc,display:"flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left"},title:`${ue.customerName||"(거래처명 없음)"} - ${ue.subject||"(제목 없음)"}`,children:[r.jsx("span",{style:{color:Rt,fontWeight:700,marginRight:4},children:Qe}),r.jsx("span",{children:ue.customerName||"(거래처명 없음)"})]},`ev-${ue.id}-${nt}`)}),xe=new Date(i.getFullYear(),i.getMonth(),i.getDate()),qe=Pe.map(ue=>{if(!ue.plannedStartAt)return null;const Re=new Date(ue.plannedStartAt);if(isNaN(Re.getTime()))return null;const Ce=Math.floor((new Date(Re.getFullYear(),Re.getMonth(),Re.getDate()).getTime()-xe.getTime())/864e5);if(Ce<0||Ce>6)return null;const Ve=Re.getHours(),Ge=`${Ce}-${Ve}`,nt=ae.get(Ge)||0;ae.set(Ge,nt+1);const Qe=ue.isCompleted||!!ue.actualEndAt,Rt=Qe?"(완)":"(계)",mt=Qe?"#2563eb":"#dc2626";return r.jsxs("div",{className:"week-event","data-day":Ce,"data-hour":Ve,onDoubleClick:dt=>{dt.stopPropagation(),Tr(ue.id)},style:{gridColumn:`${Ce+2}`,gridRow:`${Ve+1}`,height:Cm,padding:"0 6px",fontSize:10,background:"rgba(16,185,129,.18)",border:"1px solid rgba(16,185,129,.6)",borderRadius:6,margin:1,marginTop:nt*Fc,display:"flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left"},title:ue.subject||"",children:[r.jsx("span",{style:{color:mt,fontWeight:700,marginRight:4},children:Rt}),r.jsx("span",{children:ue.subject||"(지역활동)"})]},`region-${ue.id}-${Ce}-${Ve}-${nt}`)}).filter(Boolean);return[...je,...qe]})()]})})]}),l.open&&r.jsxs("div",{className:"context-menu",role:"menu",ref:d,style:{position:"fixed",left:l.x+6,top:l.y+6,zIndex:20050},children:[r.jsx("button",{className:"context-item",role:"menuitem",onClick:()=>{c({open:!1,x:0,y:0}),f(!0)},children:"거래처활동"}),r.jsx("button",{className:"context-item",role:"menuitem",onClick:()=>{c({open:!1,x:0,y:0}),st()},children:"지역활동"})]}),u&&r.jsx(dN,{onClose:()=>f(!1),prefillAt:ve}),m&&r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:13e3},children:[r.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),r.jsx("div",{style:{position:"absolute",top:"8%",left:"50%",transform:"translateX(-50%)",width:"min(920px,96vw)",maxHeight:"84vh"},children:r.jsxs("div",{className:"card plan-compact-card",style:{height:"100%",overflow:"auto",padding:12,position:"relative"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"지역활동 계획"}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:Xn,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0,1fr) minmax(0,380px)",gap:12},children:[r.jsxs("div",{className:"plan-compact",style:{display:"flex",flexDirection:"column",gap:8},children:[r.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[r.jsx("label",{children:"제목"}),r.jsx("input",{className:"subject-input",value:w,onChange:ae=>O(ae.target.value),placeholder:"예: 서울 강남구 지역활동"})]}),r.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[r.jsx("label",{children:"도 선택"}),r.jsxs("select",{value:g,onChange:ae=>{const je=ae.target.value;b(je),C(""),Pn(je)},style:{height:32},children:[r.jsx("option",{value:"",children:"— 선택 —"}),y.map((ae,je)=>r.jsx("option",{value:ae,children:ae},`${ae}-${je}`))]})]}),r.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[r.jsx("label",{children:"시군 선택"}),r.jsxs("select",{value:A,onChange:ae=>C(ae.target.value),disabled:!g,style:{height:32},children:[r.jsx("option",{value:"",children:"— 선택 —"}),x.map((ae,je)=>r.jsx("option",{value:ae,children:ae},`${ae}-${je}`))]})]}),r.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[r.jsx("label",{children:"계획 일정"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:r.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[r.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:r.jsx("input",{className:"subject-input",type:"date",value:z,onChange:ae=>j(ae.target.value),style:{flex:1}})}),r.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"~"}),r.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:r.jsx("input",{className:"subject-input",type:"date",value:k,onChange:ae=>L(ae.target.value),style:{flex:1}})})]})})]}),r.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[r.jsx("label",{children:"완료일"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:r.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[r.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:r.jsx("input",{className:"subject-input",type:"date",value:T,onChange:ae=>$(ae.target.value),style:{flex:1}})}),r.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"~"}),r.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:r.jsx("input",{className:"subject-input",type:"date",value:V,onChange:ae=>G(ae.target.value),style:{flex:1}})})]})})]}),r.jsxs("div",{className:"field",style:{display:"flex",flexDirection:"column",gap:4},children:[r.jsx("label",{children:"활동계획/설명"}),r.jsx("textarea",{value:M,onChange:ae=>B(ae.target.value),placeholder:"방문 목적, 세부 활동계획, 비고 등을 입력해 주세요.",rows:4,style:{resize:"vertical",padding:8}})]})]}),r.jsxs("div",{className:"card",style:{padding:10,background:"var(--panel-2)",borderRadius:12,display:"flex",flexDirection:"column",gap:8,minHeight:0},children:[r.jsx("div",{style:{fontWeight:600,fontSize:13},children:"영업대상 조회/등록"}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("input",{className:"subject-input",placeholder:"거래처 또는 잠재고객명으로 검색",value:q,onChange:ae=>K(ae.target.value),onKeyDown:ae=>{ae.key==="Enter"&&(ae.preventDefault(),Or())}}),r.jsx("button",{className:"btn",type:"button",onClick:Or,disabled:oe,children:"조회"})]}),r.jsx("div",{className:"table-container",style:{maxHeight:220,overflowY:"auto",overflowX:"hidden",background:"var(--panel)",borderRadius:8,padding:6},children:oe?r.jsx("div",{className:"empty-state",children:"조회 중…"}):W.length===0?r.jsx("div",{className:"empty-state",children:X||"조회 결과가 없습니다."}):W.map(ae=>{const je=Am(ae);return r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 4px",borderBottom:"1px solid var(--border)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,minWidth:0},children:[r.jsx("span",{title:ae.name,style:{fontSize:13,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:1},children:ae.name}),r.jsx("span",{title:je.label,style:{width:22,height:22,borderRadius:"50%",background:je.bg,color:je.color,fontWeight:700,display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:12},children:r.jsx("span",{style:{width:18,height:18,borderRadius:"50%",background:je.iconBg,color:"#fff",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:11},children:je.icon})})]}),r.jsx("button",{className:"btn-ghost",type:"button",onClick:()=>wi(ae),style:{width:28,height:28,display:"inline-flex",alignItems:"center",justifyContent:"center",border:"none"},"aria-label":"등록",children:r.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})]},ae.key)})}),r.jsxs("div",{style:{fontWeight:600,fontSize:12},children:["등록된 대상 (",be.length,")"]}),r.jsx("div",{className:"table-container",style:{maxHeight:140,overflowY:"auto",background:"var(--panel)",borderRadius:8,padding:6},children:be.length===0?r.jsx("div",{className:"empty-state",children:"등록된 대상이 없습니다."}):be.map(ae=>{const je=Am(ae);return r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 2px",borderBottom:"1px dashed var(--border)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,minWidth:0},children:[r.jsx("span",{title:ae.name,style:{fontSize:13,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:1},children:ae.name}),r.jsx("span",{title:je.label,style:{width:22,height:22,borderRadius:"50%",background:je.bg,color:je.color,fontWeight:700,display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:12},children:r.jsx("span",{style:{width:18,height:18,borderRadius:"50%",background:je.iconBg,color:"#fff",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:11},children:je.icon})})]}),r.jsx("button",{className:"btn-ghost",type:"button",onClick:()=>vr(ae.key),style:{width:28,height:28,display:"inline-flex",alignItems:"center",justifyContent:"center",border:"none"},"aria-label":"삭제",children:r.jsx("span",{style:{fontSize:22,lineHeight:1},children:"−"})})]},`selected-${ae.key}`)})})]})]}),I&&r.jsx("div",{style:{color:"#dc2626",fontSize:12,marginTop:8},children:I}),D&&r.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center",gap:8,border:"1px solid #10b981",background:"#ecfdf5",padding:"6px 10px",borderRadius:6},children:[r.jsx("span",{style:{color:"#047857",fontWeight:600},children:D}),r.jsx("button",{className:"btn btn-plain",type:"button",onClick:()=>S(null),style:{padding:"2px 8px",fontSize:12},children:"확인"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[r.jsx("button",{className:"btn",type:"button",onClick:Xn,children:"취소"}),r.jsx("button",{className:"btn btn-accent",type:"button",onClick:La,disabled:ne,children:ne?"저장 중…":"저장"})]})]})})]}),r.jsx(Ov,{open:Ze&&Je!=null,onClose:ht,editId:Je??void 0,leadId:jt&&/^\d+$/.test(jt)?Number(jt):void 0,leadName:ye,targetKind:Oe??void 0,targetCompanyType:ze||void 0,initial:At,onSaved:()=>{setTimeout(()=>yn(),50)}})]})}function vN(){const[e,t]=h.useState(()=>{try{const l=localStorage.getItem("tnt.sales.selectedCustomer");return l?JSON.parse(l):null}catch{return null}}),[n,i]=h.useState("transactions"),[a,s]=h.useState(0);h.useEffect(()=>{try{const l=localStorage.getItem("tnt.sales.selectedCustomer");t(l?JSON.parse(l):null)}catch{t(null)}},[]);const o=h.useMemo(()=>e?r.jsx("section",{className:"card compact-form",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"거래처번호"}),r.jsx(Qt,{value:e.customerId||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"거래처명"}),r.jsx(Qt,{value:e.customerName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"정식명"}),r.jsx(Qt,{value:e.customerFullName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"사업자번호"}),r.jsx(Qt,{value:e.bizNo||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"대표자명"}),r.jsx(Qt,{value:e.ownerName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"전화번호"}),r.jsx(Qt,{value:e.telNo||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"고객유형"}),r.jsx(Qt,{value:e.customerTypeName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"시/도"}),r.jsx(Qt,{value:e.addrProvinceName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"시/군/구"}),r.jsx(Qt,{value:e.addrCityName||"",readOnly:!0})]}),r.jsxs("div",{className:"field row-2",children:[r.jsx("label",{children:"비고"}),r.jsx(Qt,{value:e.customerRemark||"",readOnly:!0})]})]})}):r.jsx("div",{className:"empty-state",children:"선택된 거래처가 없습니다."}),[e]);return r.jsxs("section",{className:"c360",children:[r.jsx("div",{className:"page-title"}),o,r.jsxs("section",{className:"card",style:{marginTop:12,minHeight:240},children:[r.jsxs("div",{className:"tabs c360-tabs",children:[r.jsx("button",{className:n==="transactions"?"tab active":"tab",onClick:()=>i("transactions"),children:"거래 내역"}),r.jsx("button",{className:n==="activities"?"tab active":"tab",onClick:()=>i("activities"),children:"영업활동"}),r.jsx("button",{className:n==="demand"?"tab active":"tab",onClick:()=>i("demand"),children:"수요정보"})]}),r.jsxs("div",{style:{marginTop:12},children:[n==="transactions"&&(e==null?void 0:e.customerSeq)!=null&&r.jsx(Cv,{customerSeq:e.customerSeq}),n==="activities"&&(e==null?void 0:e.customerSeq)!=null&&r.jsx(Wd,{customerSeq:e.customerSeq,customerId:e.customerId||"",hideRefresh:!0,enableContextMenu:!0}),n==="demand"&&(e==null?void 0:e.customerName)&&r.jsxs(r.Fragment,{children:[r.jsx(Ev,{customerName:e.customerName,refreshTick:a}),r.jsx(Iv,{customerName:e.customerName,refreshTick:a}),r.jsx(Pv,{customerName:e.customerName,customerSeq:e.customerSeq,empSeq:e.empSeq,empName:e.empName||void 0,onSuccess:()=>s(l=>l+1)})]}),(!e||e.customerSeq==null)&&r.jsx("div",{className:"empty-state",children:"탭을 선택하세요"})]})]})]})}function Zs(e){const t=new Date(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Em(e,t){const n=new Date(e);return n.setMonth(n.getMonth()+t),n}function ia(e,t){const n=new Date(e);return n.setDate(n.getDate()+t),n}function qc(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function xN(){const[e,t]=h.useState(()=>Zs(new Date)),n=new Date,[i,a]=h.useState([]),[s,o]=h.useState([]),[l,c]=h.useState(!1),[d,u]=h.useState(null),[f,m]=h.useState("month"),[p,y]=h.useState({open:!1,x:0,y:0,event:void 0,date:void 0}),[v,g]=h.useState(0),[b,x]=h.useState(null),[N,A]=h.useState(null),[C,w]=h.useState({open:!1}),O=h.useMemo(()=>{const I=[];if(f==="month"){const P=Zs(e),D=P.getDay(),S=new Date(P);S.setDate(P.getDate()-D);for(let _=0;_<42;_++){const H=new Date(S);H.setDate(S.getDate()+_),I.push({date:H,inMonth:H.getMonth()===e.getMonth(),isToday:qc(H,n)})}}else if(f==="week"){const P=new Date(e),D=P.getDay(),S=new Date(P);S.setDate(P.getDate()-D);for(let _=0;_<7;_++){const H=new Date(S);H.setDate(S.getDate()+_),I.push({date:H,inMonth:!0,isToday:qc(H,n)})}}else{const P=new Date(e);I.push({date:P,inMonth:!0,isToday:qc(P,n)})}return I},[e,f]),M=h.useMemo(()=>{const I=e.getFullYear(),P=String(e.getMonth()+1).padStart(2,"0"),D=String(e.getDate()).padStart(2,"0");if(f==="month")return`${I}.${P}`;if(f==="week"){const S=e.getDay(),_=ia(new Date(e),-S),H=ia(new Date(_),6),q=String(_.getMonth()+1).padStart(2,"0"),K=String(_.getDate()).padStart(2,"0"),W=String(H.getMonth()+1).padStart(2,"0"),R=String(H.getDate()).padStart(2,"0");return`${I}.${q}.${K} ~ ${H.getFullYear()}.${W}.${R}`}return`${I}.${P}.${D}`},[e,f]);h.useEffect(()=>{const I=localStorage.getItem("tnt.sales.assigneeId");if(!I){u("로그인이 필요합니다"),a([]),o([]),c(!1);return}u(null),c(!0),(async()=>{const P=[],D=new Date(O[0].date);D.setHours(0,0,0,0);const S=new Date(O[O.length-1].date);S.setHours(23,59,59,999);try{const _=new URL("/api/v1/sales-activities",window.location.origin);_.searchParams.set("mineOnly","true"),_.searchParams.set("assigneeId",String(I)),_.searchParams.set("start",D.toISOString()),_.searchParams.set("end",S.toISOString());const H=await fetch(_.toString());if(!H.ok){let W=`HTTP ${H.status}`;try{const R=await H.json();R!=null&&R.error&&(W=R.error)}catch{}throw new Error(W)}const q=await H.json(),K=Array.isArray(q)?q.map(W=>({id:Number(W==null?void 0:W.id),subject:(W==null?void 0:W.subject)??void 0,customerName:(W==null?void 0:W.customerName)??(W==null?void 0:W.customer_name)??void 0,plannedStartAt:(W==null?void 0:W.plannedStartAt)??(W==null?void 0:W.planned_start_at)??void 0,plannedEndAt:(W==null?void 0:W.plannedEndAt)??(W==null?void 0:W.planned_end_at)??null,activityStatus:(W==null?void 0:W.activityStatus)??(W==null?void 0:W.activity_status)??void 0,leadId:(W==null?void 0:W.sfLeadId)??(W==null?void 0:W.sf_lead_id)??(W==null?void 0:W.leadId)??(W==null?void 0:W.lead_id)??null,source:"sales"})):[];a(K)}catch(_){P.push((_==null?void 0:_.message)||"활동 조회 중 오류가 발생했습니다"),a([])}try{const _=new URL("/api/v1/region-activity-plans",window.location.origin);_.searchParams.set("assigneeId",String(I)),_.searchParams.set("start",D.toISOString()),_.searchParams.set("end",S.toISOString());const H=await fetch(_.toString());if(!H.ok)throw new Error(`HTTP ${H.status}`);const q=await H.json(),K=Array.isArray(q)?q.map(W=>{const R=(W==null?void 0:W.plannedStartAt)??(W==null?void 0:W.planned_start_at)??null,oe=(W==null?void 0:W.plannedEndAt)??(W==null?void 0:W.planned_end_at)??null,Y=!!(W!=null&&W.actualStartAt||W!=null&&W.actual_start_at||W!=null&&W.actualEndAt||W!=null&&W.actual_end_at),X=W!=null&&W.subject?`[지역] ${W.subject}`:"지역활동";return{id:Number(W==null?void 0:W.id),subject:X,plannedStartAt:R||void 0,plannedEndAt:oe||null,activityStatus:Y?"completed":"region",leadId:null,source:"region"}}):[];o(K)}catch(_){P.push((_==null?void 0:_.message)||"지역활동 조회 중 오류가 발생했습니다"),o([])}u(P.length?P.join(" / "):null),c(!1)})()},[e,f,O,v]);const B=h.useMemo(()=>{const I=new Map,P=[...i,...s];if(!P||P.length===0)return I;const D=new Date(O[0].date),S=new Date(O[O.length-1].date);S.setHours(23,59,59,999);for(const _ of P){if(!_.plannedStartAt&&!_.plannedEndAt)continue;const H=_.plannedStartAt?new Date(_.plannedStartAt):null,q=_.plannedEndAt?new Date(_.plannedEndAt):H;if(!H)continue;const K=H,W=q||H;if(W<D||K>S)continue;const R=`${K.getFullYear()}-${String(K.getMonth()+1).padStart(2,"0")}-${String(K.getDate()).padStart(2,"0")}`,oe=K.toTimeString().slice(0,5),Y=W.toTimeString().slice(0,5),X=I.get(R)||[];X.push({id:_.id,subject:_.subject,customerName:_.customerName,time:oe,endTime:Y,status:_.activityStatus,start:K,end:W,leadId:_.leadId??null,source:_.source}),I.set(R,X)}return I},[i,s,O]);function z(I){return I.getHours()*60+I.getMinutes()}function j(I){const P=Math.floor(I/60).toString().padStart(2,"0"),D=(I%60).toString().padStart(2,"0");return`${P}:${D}`}const k=Te.useCallback(I=>{const P=new Date(I);P.setHours(0,0,0,0);const D=new Date(I);D.setHours(23,59,59,999);const S=[],_=[...i,...s];for(const H of _){const q=H.plannedStartAt?new Date(H.plannedStartAt):null,K=H.plannedEndAt?new Date(H.plannedEndAt):q;if(!q)continue;const W=K||q;if(W<P||q>D)continue;const R=q<P?P:q,oe=W>D?D:W;S.push({id:H.id,subject:H.subject,customerName:H.customerName,status:H.activityStatus,start:R,end:oe,leadId:H.leadId??null,source:H.source})}return S.sort((H,q)=>H.start.getTime()-q.start.getTime()),S},[i,s]),L=h.useCallback(()=>{y({open:!1,x:0,y:0,event:void 0,date:void 0})},[]);h.useEffect(()=>{if(!p.open)return;const I=D=>{D.target.closest(".context-menu")||L()},P=D=>{D.key==="Escape"&&L()};return window.addEventListener("click",I,!0),window.addEventListener("contextmenu",I,!1),window.addEventListener("keydown",P,!0),()=>{window.removeEventListener("click",I,!0),window.removeEventListener("contextmenu",I,!0),window.removeEventListener("keydown",P,!0)}},[p.open,L]);function T(I,P){P.source!=="region"&&(I.preventDefault(),I.stopPropagation(),y({open:!0,x:I.clientX,y:I.clientY,event:P,date:P.start}))}async function $(I){const P=I==null?void 0:I.id;if(P)try{const D=await fetch(`/api/v1/sales-activities/${P}`);if(!D.ok)throw new Error(`HTTP ${D.status}`);const S=await D.json(),_=(S==null?void 0:S.customerName)||(S==null?void 0:S.customer_name)||"";w({open:!0,event:I,customerName:_})}catch(D){console.error("활동 상세 조회 실패:",D),w({open:!0,event:I,customerName:""})}}async function V(){var P;const I=(P=C.event)==null?void 0:P.id;if(!I){w({open:!1});return}try{const D=await fetch(`/api/v1/sales-activities/${I}`,{method:"DELETE"});if(!D.ok)throw new Error(`HTTP ${D.status}`);a(S=>S.filter(_=>_.id!==I));try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated",{detail:{id:I}}))}catch{}w({open:!1}),L()}catch(D){window.alert((D==null?void 0:D.message)||"삭제 중 오류가 발생했습니다"),w({open:!1})}}function G(){w({open:!1})}h.useEffect(()=>{(f==="week"||f==="day")&&setTimeout(()=>{document.querySelectorAll(".day-timeline").forEach(I=>{I.scrollTop=7*40})},0)},[f,O]);async function ne(I){I.source!=="region"&&I!=null&&I.id&&x(I.id)}h.useEffect(()=>{if(f!=="week")return;const I=Array.from(document.querySelectorAll(".day-timeline"));if(I.length===0)return;const P=D=>{const S=D.target,_=S.scrollTop;I.forEach(H=>{H!==S&&(H.scrollTop=_)})};return I.forEach(D=>D.addEventListener("scroll",P)),()=>I.forEach(D=>D.removeEventListener("scroll",P))},[f,O]),h.useEffect(()=>{if(!b)return;const I=P=>{P.key==="Escape"&&(P.preventDefault(),P.stopPropagation(),x(null))};return window.addEventListener("keydown",I,!0),()=>window.removeEventListener("keydown",I,!0)},[b]),h.useEffect(()=>{if(!N)return;const I=P=>{P.key==="Escape"&&(P.preventDefault(),P.stopPropagation(),A(null))};return window.addEventListener("keydown",I,!0),()=>window.removeEventListener("keydown",I,!0)},[N]);const U=h.useCallback((I,P)=>{const D=new Date(I);D.setHours(9,0,0,0);const S=q=>{const K=q.getFullYear(),W=String(q.getMonth()+1).padStart(2,"0"),R=String(q.getDate()).padStart(2,"0"),oe=String(q.getHours()).padStart(2,"0"),Y=String(q.getMinutes()).padStart(2,"0");return`${K}-${W}-${R}T${oe}:${Y}`},_=(P==null?void 0:P.customerId)??(P==null?void 0:P.customer_id)??void 0,H=(P==null?void 0:P.customerName)??(P==null?void 0:P.customer_name)??void 0;A({plannedStartAt:S(D),sfAccountId:_,customerName:H})},[]);return h.useEffect(()=>{const I=P=>{var _,H;const D=(_=P==null?void 0:P.detail)!=null&&_.date?new Date(P.detail.date):new Date,S=(H=P==null?void 0:P.detail)==null?void 0:H.customer;U(D,S)};return window.addEventListener("tnt.sales.calendar.create",I),window.addEventListener("tnt.sales.activity.create.inline",I),()=>{window.removeEventListener("tnt.sales.calendar.create",I),window.removeEventListener("tnt.sales.activity.create.inline",I)}},[U]),r.jsxs(r.Fragment,{children:[r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",children:[r.jsx("h2",{children:"일정"}),r.jsx("div",{className:"meta",children:r.jsx("button",{className:"btn",onClick:()=>t(Zs(new Date)),children:"오늘"})})]}),r.jsxs("div",{className:"card",style:{padding:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("button",{className:"btn",onClick:()=>t(I=>f==="month"?Em(I,-1):f==="week"?ia(I,-7):ia(I,-1)),children:"〈"}),r.jsx("div",{style:{fontWeight:700},children:M}),r.jsx("button",{className:"btn",onClick:()=>t(I=>f==="month"?Em(I,1):f==="week"?ia(I,7):ia(I,1)),children:"〉"})]}),r.jsxs("div",{style:{display:"flex",gap:6},children:[r.jsx("button",{className:"btn",onClick:()=>{m("month"),t(Zs(new Date))},disabled:f==="month",children:"월"}),r.jsx("button",{className:"btn",onClick:()=>{m("week"),t(new Date)},disabled:f==="week",children:"주"}),r.jsx("button",{className:"btn",onClick:()=>{m("day"),t(new Date)},disabled:f==="day",children:"일"})]})]}),d&&r.jsx("div",{className:"error",style:{marginBottom:8},children:d}),l&&r.jsx("div",{className:"muted",style:{marginBottom:8},children:"활동 불러오는 중…"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:`repeat(${f==="day"?1:7}, 1fr)`,gap:4},children:[(f==="day"?[""]:["일","월","화","수","목","금","토"]).map((I,P)=>r.jsx("div",{style:{textAlign:"center",color:"var(--muted)",padding:"6px 0"},children:I},P)),f==="month"&&O.map((I,P)=>r.jsxs("div",{style:{position:"relative",border:"1px solid var(--border)",borderRadius:8,padding:8,height:120,overflow:"hidden",display:"flex",flexDirection:"column",background:I.inMonth?"transparent":"var(--panel-2)",outline:I.isToday?"2px solid var(--accent)":"none"},onContextMenu:D=>{D.preventDefault(),D.stopPropagation(),y({open:!0,x:D.clientX,y:D.clientY,date:I.date,event:void 0})},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6,opacity:I.inMonth?1:.6},children:I.date.getDate()}),(()=>{const D=`${I.date.getFullYear()}-${String(I.date.getMonth()+1).padStart(2,"0")}-${String(I.date.getDate()).padStart(2,"0")}`,S=B.get(D)||[];return S.length?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{position:"absolute",top:6,right:8,fontSize:11,fontWeight:700,color:"#dc2626"},children:S.length}),r.jsx("div",{className:"cal-events",style:{flex:1,minHeight:0,overflowY:"auto",display:"flex",flexDirection:"column",gap:4},children:S.map((_,H)=>{const q=_.customerName||_.subject||"활동",K=_.customerName&&_.subject?`${_.customerName} · ${_.subject}`:_.customerName||_.subject||"";return r.jsxs("div",{className:`cal-pill status-${(_.status||"scheduled").replaceAll(" ","_")}`,title:K,onClick:()=>{_.source!=="region"&&ne(_)},onContextMenu:W=>{_.source!=="region"&&T(W,_)},style:{cursor:_.source==="region"?"default":"pointer"},children:[r.jsx("span",{className:"time",children:_.time}),r.jsx("span",{className:"subj",children:q})]},H)})})]}):null})()]},P)),(f==="week"||f==="day")&&O.map((S,_)=>{const H=`${S.date.getFullYear()}-${String(S.date.getMonth()+1).padStart(2,"0")}-${String(S.date.getDate()).padStart(2,"0")}`,q=(B.get(H)||[]).sort((X,de)=>X.start.getTime()-de.start.getTime()),K=f==="day"?k(S.date):q,W=Array.from({length:24},()=>[]);K.forEach(X=>{const de=z(X.start),be=z(X.end),ke=be>de?be:de,ve=Math.floor(de/60),Ie=Math.floor(ke/60);for(let J=ve;J<=Math.min(Ie,23);J++)W[J].push(X)});const R=W.map(X=>X.length===0?40:40+(X.length-1)*20),oe=[0];for(let X=0;X<24;X++)oe.push(oe[X]+R[X]);const Y=oe[24];return r.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8,padding:8},onContextMenu:X=>{X.preventDefault(),X.stopPropagation(),y({open:!0,x:X.clientX,y:X.clientY,date:S.date,event:void 0})},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:S.date.getDate()}),r.jsx("div",{className:"day-timeline",style:{position:"relative",height:Y,borderTop:"1px solid var(--border)",overflowY:"auto",maxHeight:640},children:[...Array(24)].map((X,de)=>{const be=W[de],ke=oe[de],ve=R[de];return r.jsxs("div",{style:{position:"absolute",top:ke,left:0,right:0,height:ve},children:[r.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,borderTop:"1px dashed var(--border)",fontSize:10,color:"var(--muted)"},children:r.jsxs("span",{style:{position:"absolute",left:0,transform:"translateY(-50%)",paddingLeft:4},children:[de,":00"]})}),be.map((Ie,J)=>{const ge=z(Ie.start),Pe=z(Ie.end),Se=Pe>ge?Pe:ge;if(Math.floor(ge/60)!==de)return null;const It=ge%60/60*40+J*20,ye=Se-ge,Ae=ye>0?Math.max(18,ye/60*40):18,Oe=Ie.customerName||Ie.subject||"활동",Fe=Ie.customerName&&Ie.subject?`${Ie.customerName} · ${Ie.subject}`:Ie.customerName||Ie.subject||"";return r.jsxs("div",{className:`cal-pill status-${(Ie.status||"scheduled").replaceAll(" ","_")}`,style:{position:"absolute",top:It,left:"60px",width:"calc(100% - 64px)",height:Ae,zIndex:J},title:`${j(ge)}~${j(Se)} ${Fe}`,onClick:()=>{Ie.source!=="region"&&ne(Ie)},onContextMenu:ze=>{Ie.source!=="region"&&T(ze,Ie)},"aria-disabled":Ie.source==="region"?!0:void 0,children:[r.jsx("span",{className:"time",children:j(ge)}),r.jsx("span",{className:"subj",children:Oe})]},Ie.id)})]},de)})})]},_)})]}),p.open&&r.jsxs("div",{className:"context-menu",style:{left:p.x+4,top:p.y+4},onClick:I=>I.stopPropagation(),children:[r.jsx("button",{className:"context-item",onClick:()=>{p.date&&(U(p.date),L())},disabled:!p.date,children:"활동 등록"}),r.jsx("button",{className:"context-item",onClick:()=>{p.event&&(x(p.event.id),L())},disabled:!p.event,style:p.event?void 0:{opacity:.35,cursor:"not-allowed"},children:"활동 수정"}),r.jsx("button",{className:"context-item",onClick:()=>{p.event&&(L(),$(p.event))},disabled:!p.event,style:p.event?void 0:{opacity:.35,cursor:"not-allowed"},children:"활동 삭제"})]})]})]}),b&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.4)"},onClick:()=>x(null),children:r.jsxs("div",{className:"card",style:{width:"min(920px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:I=>I.stopPropagation(),children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[r.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"영업활동 수정"}),r.jsx("button",{onClick:()=>x(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:I=>{I.currentTarget.style.background="var(--panel-2)",I.currentTarget.style.color="var(--text)"},onMouseLeave:I=>{I.currentTarget.style.background="transparent",I.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)",children:"×"})]}),r.jsx($i,{bare:!0,editId:b,onSaved:()=>{x(null),g(I=>I+1)},onNoticeClose:()=>x(null)})]})}),N&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.4)"},onClick:()=>A(null),children:r.jsxs("div",{className:"card",style:{width:"min(920px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:I=>I.stopPropagation(),children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[r.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"영업활동 등록"}),r.jsx("button",{onClick:()=>A(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:I=>{I.currentTarget.style.background="var(--panel-2)",I.currentTarget.style.color="var(--text)"},onMouseLeave:I=>{I.currentTarget.style.background="transparent",I.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)",children:"×"})]}),r.jsx($i,{bare:!0,initial:N,onSaved:()=>{A(null),g(I=>I+1)},onNoticeClose:()=>A(null)})]})}),C.open&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.5)"},onClick:G,children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:20,border:"1px solid var(--border)",borderRadius:12,minWidth:320,maxWidth:"86vw",boxShadow:"0 8px 32px rgba(0,0,0,.3)"},onClick:I=>I.stopPropagation(),children:[r.jsx("div",{style:{marginBottom:16,fontSize:16,fontWeight:700,color:"var(--text)",textAlign:"center"},children:"활동 삭제"}),r.jsxs("div",{style:{marginBottom:20,fontSize:14,color:"var(--text)",textAlign:"center",lineHeight:1.6},children:[C.customerName&&r.jsx("div",{style:{marginBottom:8,fontWeight:600,color:"var(--primary)"},children:C.customerName}),r.jsx("div",{children:"정말로 삭제하시겠습니까?"})]}),r.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[r.jsx("button",{className:"btn",onClick:G,style:{minWidth:80,background:"var(--panel-2)",border:"1px solid var(--border)",color:"var(--text)",display:"flex",alignItems:"center",justifyContent:"center"},children:"취소"}),r.jsx("button",{className:"btn",onClick:V,style:{minWidth:80,background:"#dc2626",border:"1px solid #b91c1c",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center"},children:"삭제"})]})]})})]})}function Uc(e){e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),e.setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));var t=new Date(Date.UTC(e.getUTCFullYear(),0,1)),n=Math.ceil(((e.getTime()-t.getTime())/864e5+1)/7);return n}function Im(e,t){const n=new Date(e,0,1+(t-1)*7),i=n.getDay(),a=n;i<=4?a.setDate(n.getDate()-n.getDay()+1):a.setDate(n.getDate()+8-n.getDay());const s=new Date(a),o=new Date(a);return o.setDate(o.getDate()+6),{start:s,end:o}}function bN(){const e=new Date,t=e.getFullYear(),n=e.getMonth()+1,i=Uc(e),[a,s]=h.useState({year:t,month:n,week:i,activityType:"all"}),[o,l]=h.useState([]),[c,d]=h.useState([]),[u,f]=h.useState(!1);h.useEffect(()=>{async function j(){try{const k=await fetch(`/api/v1/dashboard/activity-analysis?year=${a.year}&activityType=${a.activityType.toUpperCase()}`);if(k.ok){const L=await k.json();l(Array.isArray(L)?L:[])}}catch(k){console.error(k)}}j()},[a.year,a.activityType]),h.useEffect(()=>{async function j(){f(!0);try{const{year:k,month:L,week:T}=a;if(T!=="all"){const{start:$,end:V}=Im(k,T),G=$.toISOString().split("T")[0],ne=V.toISOString().split("T")[0],U=await fetch(`/api/v1/dashboard/daily-activity?from=${G}&to=${ne}`);U.ok&&d(await U.json())}else if(L!=="all"){const $=new Date(k,L-1,1),V=new Date(k,L,0),G=$.toISOString().split("T")[0],ne=V.toISOString().split("T")[0],U=await fetch(`/api/v1/dashboard/daily-activity?from=${G}&to=${ne}`);U.ok&&d(await U.json())}else d([])}catch(k){console.error(k)}finally{f(!1)}}j()},[a]);const m=()=>{s({year:p,month:v,week:b,activityType:N})},[p,y]=h.useState(t),[v,g]=h.useState(n),[b,x]=h.useState(i),[N,A]=h.useState("all");function C(j,k){const L=[],T=new Date(j,k-1,1),$=new Date(j,k,0);for(;T<=$;){const V=Uc(T);(L.length===0||L[L.length-1]!==V)&&L.push(V),T.setDate(T.getDate()+1)}return L}const w=h.useMemo(()=>{const{year:j,month:k,week:L}=a,T=new Map;if(c.forEach($=>{var V;T.has($.empId)||T.set($.empId,[]),(V=T.get($.empId))==null||V.push($)}),L!=="all"){const{start:$}=Im(j,L),V=Array.from({length:7},(G,ne)=>{const U=new Date($);return U.setDate(U.getDate()+ne),{date:U.toISOString().split("T")[0],label:["일","월","화","수","목","금","토"][U.getDay()]}});return o.map(G=>{const ne=T.get(G.empId)||[],U=ne.reduce((D,S)=>D+S.planned,0),I=ne.reduce((D,S)=>D+S.completed,0),P=V.map(D=>{const S=ne.find(_=>_.date===D.date);return{label:D.label,value:(S==null?void 0:S.completed)||0,subValue:(S==null?void 0:S.planned)||0,tooltip:`${D.date}: ${(S==null?void 0:S.completed)||0}/${(S==null?void 0:S.planned)||0}`}});return{empId:G.empId,empName:G.empName,deptName:G.deptName,planned:U,completed:I,chartData:P}})}else if(k!=="all"){const $=C(j,k);return o.map(V=>{const G=T.get(V.empId)||[],ne=G.reduce((D,S)=>D+S.planned,0),U=G.reduce((D,S)=>D+S.completed,0),I=new Map;G.forEach(D=>{const S=Uc(new Date(D.date));I.has(S)||I.set(S,{p:0,c:0});const _=I.get(S);_.p+=D.planned,_.c+=D.completed});const P=$.map(D=>{var S,_,H,q;return{label:`${D}주차`,value:((S=I.get(D))==null?void 0:S.c)||0,subValue:((_=I.get(D))==null?void 0:_.p)||0,tooltip:`${D}주차: ${((H=I.get(D))==null?void 0:H.c)||0}/${((q=I.get(D))==null?void 0:q.p)||0}`}});return{empId:V.empId,empName:V.empName,deptName:V.deptName,planned:ne,completed:U,chartData:P}})}else return o.map($=>({empId:$.empId,empName:$.empName,deptName:$.deptName,planned:$.months.reduce((V,G)=>V+G.planned,0),completed:$.months.reduce((V,G)=>V+G.completed,0),chartData:Array.from({length:12},(V,G)=>G+1).map(V=>{const G=$.months.find(ne=>ne.month===V);return{label:`${V}월`,value:(G==null?void 0:G.completed)||0,subValue:(G==null?void 0:G.planned)||0,tooltip:`${V}월: ${(G==null?void 0:G.completed)||0}/${(G==null?void 0:G.planned)||0}`}})}))},[a,o,c]),O=w.reduce((j,k)=>j+k.planned,0),M=w.reduce((j,k)=>j+k.completed,0),B=O>0?Math.round(M/O*100):0,z=[...w].sort((j,k)=>k.completed-j.completed)[0];return r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,height:"calc(100vh - 120px)"},children:[r.jsxs("div",{className:"page-title",style:{marginBottom:0,padding:"8px 0",minHeight:"auto",height:"auto"},children:[r.jsx("h2",{style:{background:"linear-gradient(90deg, #2563eb, #9333ea)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",margin:0,fontSize:18},children:"영업 활동 분석"}),r.jsxs("div",{className:"controls",style:{display:"flex",gap:8,marginRight:380},children:[r.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex"},children:["all","sales","region"].map(j=>{const k=j==="all"?"전체":j==="sales"?"활동":"지역활동",L=N===j;return r.jsx("button",{onClick:()=>A(j),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:L?"#fff":"transparent",color:L?"#2563eb":"#6b7280",boxShadow:L?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:k},j)})}),r.jsx("select",{className:"subject-input",value:p,onChange:j=>{y(Number(j.target.value)),x("all")},style:{width:100,height:30},children:Array.from({length:5},(j,k)=>new Date().getFullYear()-2+k).map(j=>r.jsxs("option",{value:j,children:[j,"년"]},j))}),r.jsxs("select",{className:"subject-input",value:v,onChange:j=>{g(j.target.value==="all"?"all":Number(j.target.value)),x("all")},disabled:b!=="all",style:{width:100,opacity:b!=="all"?.5:1,height:30},children:[r.jsx("option",{value:"all",children:"전체 월"}),Array.from({length:12},(j,k)=>k+1).map(j=>r.jsxs("option",{value:j,children:[j,"월"]},j))]}),r.jsxs("select",{className:"subject-input",value:b,onChange:j=>{x(j.target.value==="all"?"all":Number(j.target.value))},style:{width:100,height:30},children:[r.jsx("option",{value:"all",children:"전체 주"}),v!=="all"?C(p,v).map(j=>r.jsxs("option",{value:j,children:[j,"주차"]},j)):Array.from({length:53},(j,k)=>k+1).map(j=>r.jsxs("option",{value:j,children:[j,"주차"]},j))]}),r.jsx("button",{onClick:m,disabled:u,style:{height:30,padding:"0 12px",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:4,color:"var(--text)",fontSize:12,cursor:"pointer",display:"flex",alignItems:"center",gap:4},children:u?"조회중...":"조회"})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:8},children:[r.jsx(eo,{title:"총 계획",value:O.toLocaleString(),icon:"📅",color:"#64748b"}),r.jsx(eo,{title:"총 완료",value:M.toLocaleString(),icon:"✅",color:"#2563eb"}),r.jsx(eo,{title:"달성률",value:`${B}%`,icon:"📈",color:B>=80?"#10b981":"#f59e0b"}),r.jsx(eo,{title:"최우수 사원",value:z?z.empName:"-",icon:"🏆",color:"#8b5cf6",sub:z==null?void 0:z.deptName})]}),u&&w.length===0?r.jsx("div",{className:"card",style:{padding:24,textAlign:"center",color:"#666"},children:"데이터 분석 중..."}):r.jsxs("div",{style:{flex:1,overflowY:"auto",minHeight:0,paddingRight:4},children:[r.jsxs("div",{className:"card",style:{padding:16,marginBottom:8},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsxs("h3",{style:{fontSize:14,fontWeight:600,margin:0},children:["월별 활동 히트맵 (",a.year,"년)"]}),r.jsx("div",{style:{fontSize:11,color:"#64748b"},children:"* 히트맵은 항상 연간 데이터를 표시합니다"})]}),r.jsx(jN,{data:o})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:8},children:w.map(j=>r.jsx(wN,{empName:j.empName,deptName:j.deptName,planned:j.planned,completed:j.completed,chartData:j.chartData},j.empId))})]})]})}function eo({title:e,value:t,icon:n,color:i,sub:a}){return r.jsxs("div",{className:"card",style:{padding:16,display:"flex",alignItems:"center",gap:16,borderLeft:`4px solid ${i}`},children:[r.jsx("div",{style:{fontSize:24,background:`${i}20`,width:48,height:48,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center"},children:n}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:12,color:"#64748b",fontWeight:500},children:e}),r.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#1e293b"},children:t}),a&&r.jsx("div",{style:{fontSize:11,color:"#94a3b8"},children:a})]})]})}function jN({data:e}){const t=Array.from({length:12},(a,s)=>s+1);let n=0;e.forEach(a=>{a.months.forEach(s=>{s.completed>n&&(n=s.completed)})});const i=a=>a===0?"#f1f5f9":`rgba(37, 99, 235, ${.1+Math.min(1,a/Math.max(1,n))*.9})`;return r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:8,color:"#64748b"},children:"Employee"}),t.map(a=>r.jsxs("th",{style:{padding:8,color:"#64748b"},children:[a,"월"]},a)),r.jsx("th",{style:{padding:8,color:"#64748b"},children:"Total"})]})}),r.jsx("tbody",{children:e.map(a=>{const s=a.months.reduce((o,l)=>o+l.completed,0);return r.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[r.jsxs("td",{style:{padding:"8px 12px",fontWeight:500},children:[a.empName," ",r.jsx("span",{style:{fontSize:10,color:"#94a3b8",marginLeft:4},children:a.deptName})]}),t.map(o=>{const l=a.months.find(d=>d.month===o),c=(l==null?void 0:l.completed)||0;return r.jsx("td",{style:{padding:4,textAlign:"center"},children:r.jsx("div",{style:{background:i(c),color:c>n/2?"#fff":"#1e293b",borderRadius:4,padding:"4px 0",fontSize:11,fontWeight:600},children:c>0?c:"-"})},o)}),r.jsx("td",{style:{padding:8,textAlign:"center",fontWeight:700},children:s})]},a.empId)})})]})})}function wN({empName:e,deptName:t,planned:n,completed:i,chartData:a}){const s=n>0?Math.round(i/n*100):0,o=Math.max(...a.map(l=>Math.max(l.value,l.subValue||0)),1);return r.jsxs("div",{className:"card",style:{padding:16,display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:700,fontSize:15},children:e}),r.jsx("div",{style:{fontSize:11,color:"#64748b"},children:t})]}),r.jsxs("div",{style:{background:s>=90?"#dcfce7":s>=70?"#fef9c3":"#fee2e2",color:s>=90?"#166534":s>=70?"#854d0e":"#991b1b",padding:"2px 8px",borderRadius:12,fontSize:11,fontWeight:700},children:[s,"%"]})]}),r.jsxs("div",{style:{display:"flex",gap:8,fontSize:12},children:[r.jsxs("div",{style:{flex:1,background:"#f8fafc",padding:8,borderRadius:6,textAlign:"center"},children:[r.jsx("div",{style:{color:"#64748b",fontSize:10},children:"Planned"}),r.jsx("div",{style:{fontWeight:600},children:n})]}),r.jsxs("div",{style:{flex:1,background:"#eff6ff",padding:8,borderRadius:6,textAlign:"center"},children:[r.jsx("div",{style:{color:"#3b82f6",fontSize:10},children:"Completed"}),r.jsx("div",{style:{fontWeight:600,color:"#2563eb"},children:i})]})]}),r.jsx("div",{style:{height:100,display:"flex",alignItems:"flex-end",gap:4,paddingTop:16,borderTop:"1px solid #f1f5f9"},children:a.map((l,c)=>{const d=Math.min(100,l.value/o*100);return r.jsxs("div",{style:{flex:1,height:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"center"},title:l.tooltip,children:[r.jsx("div",{style:{width:"100%",background:"#f1f5f9",height:"100%",maxHeight:80,borderRadius:4,position:"relative",overflow:"hidden"},children:r.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,background:l.value>0?"#3b82f6":"transparent",height:`${d}%`,transition:"height 0.3s ease",display:"flex",alignItems:"flex-start",justifyContent:"center",paddingTop:4},children:l.value>0&&r.jsx("span",{style:{fontSize:10,color:"#fff",fontWeight:700,lineHeight:1,textShadow:"0 1px 2px rgba(0,0,0,0.1)"},children:l.value})})}),r.jsx("div",{style:{fontSize:9,color:"#94a3b8",marginTop:4,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:l.label})]},c)})})]})}function SN(){const[e,t]=h.useState(()=>{const T=new Date;return T.setMinutes(T.getMinutes()-T.getTimezoneOffset()),T.toISOString().slice(0,10)}),[n,i]=h.useState("ALL"),[a,s]=h.useState(null),[o,l]=h.useState(new Array(12).fill(0)),[c,d]=h.useState(new Array(12).fill(0)),[u,f]=h.useState([]),[m,p]=h.useState([]),[y,v]=h.useState(!1),[g,b]=h.useState(null),[x,N]=h.useState("compare");async function A(T){v(!0),b(null);try{const $=n!=="ALL"?`&companyType=${encodeURIComponent(n)}`:"",V=await fetch(`/api/v1/dashboard/sales-summary?date=${encodeURIComponent(T)}${$}`),G=await V.json().catch(()=>({}));if(!V.ok||G&&G.error)throw new Error(G.error||`HTTP ${V.status}`);s(G);const ne=new Date(T),U=ne.getFullYear(),I=U-1,P=T,[D,S]=await Promise.all([fetch(`/api/v1/dashboard/monthly?year=${I}${$}`),fetch(`/api/v1/dashboard/monthly?year=${U}&until=${encodeURIComponent(P)}${$}`)]),_=await D.json().catch(()=>[]),H=await S.json().catch(()=>[]),q=de=>{const be=new Array(12).fill(0);return Array.isArray(de)&&de.forEach(ke=>{const ve=Number(ke==null?void 0:ke.month),Ie=Number((ke==null?void 0:ke.amount)||0);ve>=1&&ve<=12&&(be[ve-1]=Ie)}),be};l(q(_)),d(q(H));const K=ne.getMonth()+1,[W,R]=await Promise.all([fetch(`/api/v1/dashboard/daily?year=${I}&month=${K}${$}`),fetch(`/api/v1/dashboard/daily?year=${U}&month=${K}&until=${encodeURIComponent(P)}${$}`)]),oe=await W.json().catch(()=>[]),Y=await R.json().catch(()=>[]),X=(de,be,ke)=>{let ve=31;try{ve=new Date(be,ke,0).getDate()}catch{}const Ie=new Array(ve).fill(0);return Array.isArray(de)&&de.forEach(J=>{const ge=Number(J==null?void 0:J.day),Pe=Number((J==null?void 0:J.amount)||0);ge>=1&&ge<=ve&&(Ie[ge-1]=Pe)}),Ie};f(X(oe,I,K)),p(X(Y,U,K))}catch($){b(($==null?void 0:$.message)||"조회 중 오류가 발생했습니다"),s(null)}finally{v(!1)}}h.useEffect(()=>{A(e)},[n]);const C=T=>{if(T==null)return"-";try{return new Intl.NumberFormat("ko-KR").format(T)}catch{return String(T)}},w=new Date(e),O=w.getFullYear(),M=w.getMonth()+1,B=w.getDate(),z=T=>String(T).padStart(2,"0"),j=O-1,k=new Date(j,M,0).getDate(),L=Math.min(B,k);return r.jsxs("section",{style:{display:"flex",flexDirection:"column",fontSize:12},children:[r.jsxs("div",{className:"tabs",style:{display:"flex",gap:8,padding:"6px 8px",marginBottom:8},children:[r.jsx("button",{className:x==="compare"?"tab active":"tab",onClick:()=>N("compare"),children:"전년동기 매출비교"}),r.jsx("button",{className:x==="activity-ag"?"tab active":"tab",onClick:()=>N("activity-ag"),children:"활동분석"}),r.jsx("button",{className:x==="arrears"?"tab active":"tab",onClick:()=>N("arrears"),children:"미수 분석"})]}),x==="compare"?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"page-title",children:[r.jsx("h2",{children:"전년동기 매출비교"}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex"},children:["ALL","TNT","DYS"].map(T=>r.jsx("button",{onClick:()=>i(T),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:n===T?"#fff":"transparent",color:n===T?"#2563eb":"#6b7280",boxShadow:n===T?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:T},T))}),r.jsx("input",{type:"date",className:"subject-input",value:e,onChange:T=>{t(T.target.value),A(T.target.value)}})]})]}),g&&r.jsx("div",{className:"error",style:{marginBottom:8},children:g}),r.jsx("div",{className:"card",style:{padding:12},children:y?r.jsx("div",{className:"empty-state",children:"불러오는 중…"}):a?r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:12},children:[r.jsx(aa,{label:`${j} 전체`,value:C(a.prevYearTotal)}),r.jsx(aa,{label:`${j}-01-01 ~ ${j}-${z(M)}-${z(B)}`,value:C(a.prevYearToDate)}),r.jsx(aa,{label:`${O}-01-01 ~ ${O}-${z(M)}-${z(B)}`,value:C(a.currentYearToDate)}),r.jsx(aa,{label:`${j}-${z(M)} 전체`,value:C(a.prevYearMonthTotal)}),r.jsx(aa,{label:`${j}-${z(M)}-01 ~ ${j}-${z(M)}-${z(L)}`,value:C(a.prevYearMonthToDate)}),r.jsx(aa,{label:`${O}-${z(M)}-01 ~ ${O}-${z(M)}-${z(B)}`,value:C(a.currentYearMonthToDate)})]}):r.jsx("div",{className:"empty-state",children:"데이터가 없습니다"})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[r.jsxs("div",{className:"card",style:{padding:12},children:[r.jsx("div",{className:"muted",style:{marginBottom:8},children:"월별 매출 (올해 vs 전년)"}),r.jsx(NN,{prev:o,cur:c,upToMonth:new Date(e).getMonth()+1})]}),r.jsxs("div",{className:"card",style:{padding:12},children:[r.jsx("div",{className:"muted",style:{marginBottom:8},children:"일별 매출 (해당 월: 올해 vs 전년)"}),r.jsx(kN,{prev:u,cur:m,upToDay:new Date(e).getDate()})]})]}),r.jsxs("div",{className:"controls",style:{justifyContent:"flex-start",marginTop:12},children:[r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"8px 12px",borderRadius:10},onClick:async()=>{try{const T=await fetch(`/api/v1/dashboard/churn?date=${encodeURIComponent(e)}`),$=await T.json().catch(()=>[]);if(!T.ok||$&&$.error)throw new Error($.error||`HTTP ${T.status}`);try{window.dispatchEvent(new CustomEvent("tnt.sales.dashboard.churn",{detail:{items:$}}))}catch{}}catch{alert("이탈거래처 조회 실패")}},children:"이탈거래처"}),r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"8px 12px",borderRadius:10,marginLeft:12},onClick:async()=>{try{const T=await fetch(`/api/v1/dashboard/newcustomers?date=${encodeURIComponent(e)}`),$=await T.json().catch(()=>[]);if(!T.ok||$&&$.error)throw new Error($.error||`HTTP ${T.status}`);try{window.dispatchEvent(new CustomEvent("tnt.sales.dashboard.newcustomers",{detail:{items:$}}))}catch{}}catch{alert("신규 거래처 조회 실패")}},children:"신규 거래처"})]})]}):x==="arrears"?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"page-title",children:r.jsx("h2",{children:"미수 분석"})}),r.jsx("div",{className:"card",style:{padding:12},children:r.jsx("div",{className:"empty-state",children:"미수 분석 콘텐츠가 준비 중입니다."})})]}):r.jsx(bN,{})]})}function aa({label:e,value:t}){return r.jsxs("div",{className:"card",style:{padding:12},children:[r.jsx("div",{className:"muted",style:{fontSize:10,marginBottom:8},children:e}),r.jsx("div",{style:{fontSize:16,fontWeight:700},children:t})]})}function NN({prev:e,cur:t,upToMonth:n}){const o=Array.from({length:12},(g,b)=>b+1),l=Math.max(1,...e,...t),c=g=>36+g*(320-2*36)/11,d=g=>204-g/l*(240-2*36),u=(g,b)=>o.filter(N=>!b||N<=b).map((N,A)=>`${A===0?"M":"L"} ${c(N-1)} ${d(g[N-1]||0)}`).join(" "),f=4,m=Array.from({length:f},(g,b)=>Math.round((b+1)*l/f)),p=g=>`${Math.round((g||0)/1e6)}`,y=g=>new Intl.NumberFormat("ko-KR",{maximumFractionDigits:0}).format((g||0)/1e6),v={prev:"#64748b",cur:"#2563eb"};return r.jsxs("svg",{width:"100%",viewBox:"0 0 320 240",children:[r.jsx("rect",{x:0,y:0,width:320,height:240,fill:"transparent"}),m.map((g,b)=>{const x=d(g);return r.jsxs("g",{children:[r.jsx("line",{x1:36,y1:x,x2:284,y2:x,stroke:"var(--border)"}),r.jsx("text",{x:30,y:x+2,textAnchor:"end",fontSize:4,fill:"var(--muted)",children:p(g)})]},b)}),r.jsx("text",{x:4,y:10,fontSize:4,fill:"var(--muted)",children:"단위: 백만원"}),r.jsx("path",{d:u(e),fill:"none",stroke:v.prev,strokeWidth:2}),r.jsx("path",{d:u(t,n),fill:"none",stroke:v.cur,strokeWidth:2}),o.map(g=>{const b=e[g-1]||0,x=d(b)-4;return r.jsx("text",{x:c(g-1),y:x,textAnchor:"middle",fontSize:4,fill:v.prev,children:y(b)},`p-${g}`)}),o.filter(g=>g<=n).map(g=>{const b=t[g-1]||0,x=d(b)-4;return r.jsx("text",{x:c(g-1),y:x-6,textAnchor:"middle",fontSize:4,fill:v.cur,children:y(b)},`c-${g}`)}),o.map(g=>r.jsxs("text",{x:c(g-1),y:234,textAnchor:"middle",fontSize:4,fill:"var(--muted)",children:[g,"월"]},g)),r.jsxs("g",{children:[r.jsx("circle",{cx:196,cy:14,r:4,fill:v.prev}),r.jsx("text",{x:206,y:18,fontSize:4,fill:"var(--muted)",children:"전년"}),r.jsx("circle",{cx:250,cy:14,r:4,fill:v.cur}),r.jsx("text",{x:260,y:18,fontSize:4,fill:"var(--muted)",children:"올해"})]})]})}function kN({prev:e,cur:t,upToDay:n}){const l=Math.max(1,...e,...t),c=(320-2*36)/31,d=Math.max(1,Math.floor(c*.35)),u=N=>36+N*c,f=N=>204-N/l*(240-2*36),m=N=>`${Math.round((N||0)/1e6)}`,p=Array.from({length:31},(N,A)=>A+1),y=Array.from({length:4},(N,A)=>Math.round((A+1)*l/4)),[v,g]=Te.useState(null),b=N=>{const C=N.currentTarget.getBoundingClientRect(),w=N.clientX-C.left,O=Math.max(0,Math.min(320-2*36,w-36)),M=Math.max(0,Math.min(30,Math.floor(O/c)));g(M)},x={prev:"#94a3b8",cur:"#3b82f6"};return r.jsxs("svg",{width:"100%",viewBox:"0 0 320 240",onMouseMove:b,onMouseLeave:()=>g(null),children:[r.jsx("rect",{x:0,y:0,width:320,height:240,fill:"transparent"}),y.map((N,A)=>{const C=f(N);return r.jsxs("g",{children:[r.jsx("line",{x1:36,y1:C,x2:284,y2:C,stroke:"var(--border)"}),r.jsx("text",{x:30,y:C+2,textAnchor:"end",fontSize:4,fill:"var(--muted)",children:m(N)})]},A)}),r.jsx("text",{x:4,y:10,fontSize:4,fill:"var(--muted)",children:"단위: 백만원"}),Array.from({length:31},(N,A)=>A).map(N=>{const A=u(N),C=204-f(e[N]||0),w=204-f(t[N]||0);return r.jsxs("g",{children:[r.jsx("rect",{x:A-d-1,y:f(e[N]||0),width:d,height:C,fill:x.prev}),r.jsx("rect",{x:A+1,y:f(t[N]||0),width:d,height:w,fill:x.cur})]},N)}),p.map(N=>r.jsx("text",{x:u(N-1),y:232,textAnchor:"middle",fontSize:3,fill:"var(--muted)",children:N},N)),r.jsxs("g",{children:[r.jsx("rect",{x:194,y:8,width:8,height:8,fill:x.prev}),r.jsx("text",{x:208,y:16,fontSize:4,fill:"var(--muted)",children:"전년"}),r.jsx("rect",{x:244,y:8,width:8,height:8,fill:x.cur}),r.jsx("text",{x:258,y:16,fontSize:4,fill:"var(--muted)",children:"올해"})]}),v!=null&&v<31&&r.jsxs("g",{children:[r.jsx("line",{x1:u(v),y1:32,x2:u(v),y2:208,stroke:"var(--border)"}),r.jsxs("g",{transform:`translate(${Math.min(174,Math.max(36,u(v)-55))}, 36)`,children:[r.jsx("rect",{x:0,y:0,width:110,height:38,rx:6,fill:"var(--panel)",stroke:"var(--border)"}),r.jsxs("text",{x:6,y:12,fontSize:4,fill:"var(--muted)",children:[v+1,"일"]}),r.jsxs("text",{x:6,y:22,fontSize:4,fill:x.prev,children:["전년 ",m(e[v]||0)]}),r.jsxs("text",{x:6,y:32,fontSize:4,fill:x.cur,children:["올해 ",v+1<=n?m(t[v]||0):"-"]})]})]})]})}function AN({activity:e}){return r.jsxs("section",{className:"card activity-edit-panel",style:{marginTop:12,minHeight:240},children:[r.jsx("div",{className:"tabs c360-tabs",children:r.jsx("button",{className:"tab active",children:"영업활동 변경"})}),r.jsx("div",{className:"activity-form-wrapper",children:r.jsx($i,{bare:!0,editId:e==null?void 0:e.id,initial:{id:e==null?void 0:e.id,subject:(e==null?void 0:e.subject)||"",description:(e==null?void 0:e.description)||"",channel:(e==null?void 0:e.channel)||"in_person",activityType:(e==null?void 0:e.activityType)||"site_visit",activityStatus:(e==null?void 0:e.activityStatus)||"scheduled",plannedStartAt:(e==null?void 0:e.plannedStartAt)||"",plannedEndAt:(e==null?void 0:e.plannedEndAt)||"",sfAccountId:(e==null?void 0:e.sfAccountId)||"",customerName:(e==null?void 0:e.customerName)||"",parentActivitySeq:e==null?void 0:e.parentSeq,parentSubject:e==null?void 0:e.parentSubject}},`edit-${(e==null?void 0:e.id)??"new"}`)})]})}function br(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const n=String(t.getFullYear()%100).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${n}-${i}-${a} ${s}:${o}`}function CN(){const[e,t]=h.useState([]),[n,i]=h.useState(!1),[a,s]=h.useState(null),[o,l]=h.useState(()=>new Set),[c,d]=h.useState(null),[u,f]=h.useState(""),[m,p]=h.useState([]),[y,v]=h.useState(""),[g,b]=h.useState(void 0),[x,N]=h.useState({open:!1,x:0,y:0});function A(){try{const z=localStorage.getItem("tnt.sales.visitPlanActivities"),j=z?JSON.parse(z):[],k=new Set;return Array.isArray(j)&&j.forEach(L=>{(L==null?void 0:L.id)!=null&&k.add(Number(L.id))}),k}catch{return new Set}}async function C(){s(null),i(!0);try{const z=localStorage.getItem("tnt.sales.assigneeId");if(!z)throw new Error(gt.loginRequired);const j=new URL("/api/v1/sales-activities",window.location.origin);j.searchParams.set("mineOnly","true"),j.searchParams.set("assigneeId",String(z)),u&&u.trim()&&j.searchParams.set("customerName",u.trim()),y&&y.trim()&&j.searchParams.append("status",y.trim());const k=await fetch(j.toString());if(!k.ok){let G=`HTTP ${k.status}`;try{const ne=await k.json();ne!=null&&ne.error&&(G=ne.error)}catch{}throw new Error(G)}const L=await k.json(),T=Array.isArray(L)?L:[],$=A(),V=T.filter(G=>!$.has(G.id));t(V),b(G=>{if(!(!V||V.length===0))return G&&V.some(ne=>ne.id===G.id)?G:V[0]})}catch(z){s(z.message||"조회 중 오류가 발생했습니다")}finally{i(!1)}}h.useEffect(()=>{C(),(async()=>{try{const k=await fetch("/api/v1/sales-activities/statuses");if(k.ok){const L=await k.json(),T=["scheduled","completed","canceled","postponed"];Array.isArray(L)&&L.length>0?p(L):p(T)}else p(["scheduled","completed","canceled","postponed"])}catch{}})();const z=()=>{try{const k=localStorage.getItem("tnt.sales.availableActivities");if(k){const L=JSON.parse(k);if(Array.isArray(L)){const T=L;t(T),b($=>{if(!(!T||T.length===0))return $&&T.some(V=>V.id===$.id)?$:T[0]})}}}catch{}};window.addEventListener("tnt.sales.availableActivitiesUpdated",z);const j=()=>{C()};return window.addEventListener("tnt.sales.activity.updated",j),()=>window.removeEventListener("tnt.sales.availableActivitiesUpdated",z)},[]),h.useEffect(()=>{if(!x.open)return;const z=()=>N({open:!1,x:0,y:0}),j=k=>{k.key==="Escape"&&N({open:!1,x:0,y:0})};return window.addEventListener("click",z),window.addEventListener("keydown",j),()=>{window.removeEventListener("click",z),window.removeEventListener("keydown",j)}},[x.open]);function w(z,j){z.preventDefault(),z.stopPropagation();const k=(j.parentSubject||"").trim();if(!k){N({open:!1,x:0,y:0});return}const L=e.find($=>($.subject||"").trim()===k)||null,T=e.filter($=>($.parentSubject||"").trim()===k);N({open:!0,x:z.clientX,y:z.clientY,parent:L,siblings:T})}function O(){if(d(null),o.size===0){d("선택된 활동이 없습니다");return}const z=e.filter(k=>o.has(k.id)),j=e.filter(k=>!o.has(k.id));try{let k=[];try{const ne=localStorage.getItem("tnt.sales.visitPlanActivities");if(ne){const U=JSON.parse(ne);Array.isArray(U)&&(k=U)}}catch{}const L=new Map;k.forEach(ne=>L.set(ne.id,ne)),z.forEach(ne=>L.set(ne.id,ne));const T=Array.from(L.values());localStorage.setItem("tnt.sales.visitPlanActivities",JSON.stringify(T));let $=[];try{const ne=localStorage.getItem("tnt.sales.availableActivities");if(ne){const U=JSON.parse(ne);Array.isArray(U)&&($=U)}}catch{}const V=new Map;$.forEach(ne=>V.set(ne.id,ne)),j.forEach(ne=>V.set(ne.id,ne)),z.forEach(ne=>V.delete(ne.id));const G=Array.from(V.values());localStorage.setItem("tnt.sales.availableActivities",JSON.stringify(G)),window.dispatchEvent(new CustomEvent("tnt.sales.visitPlanUpdated")),window.dispatchEvent(new CustomEvent("tnt.sales.availableActivitiesUpdated")),d(`방문 일정 대상 ${z.length}건을 우측 패널에 추가했습니다`),t(G),l(new Set)}catch{d("저장 중 오류가 발생했습니다")}}const M=(z,j)=>z?j==="type"?{site_visit:"정기방문",opportunity:"영업기회",AR_mgmt:"채권관리",meeting:"미팅",call:"전화",email:"이메일",demo:"데모",task:"업무",other:"기타"}[z]||z:j==="status"?{scheduled:"계획",completed:"완료",canceled:"취소",postponed:"연기",no_show:"미방문"}[z]||z:j==="channel"&&{in_person:"방문",phone:"전화",email:"문자/메일/팩스",other:"기타",video:"영상",chat:"채팅",sms:"문자"}[z]||z:"",B=h.useMemo(()=>{const z=j=>[`제목: ${j.subject||""}`,`활동설명: ${j.description||""}`,`활동유형: ${M(j.activityType,"type")}`,`활동방법: ${M(j.channel,"channel")}`,`상태: ${M(j.activityStatus,"status")}`,`상위활동: ${j.parentSubject||""}`,`계획 일시: ${br(j.plannedStartAt)}`,`종료 일시: ${br(j.plannedEndAt)}`,`거래처명: ${j.customerName||""}`,`생성일시: ${br(j.createdAt)}`].join(`
`);return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"table-container",style:{maxHeight:"32vh"},children:e.length===0?r.jsx("div",{className:"empty-state",children:gt.empty}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:36,textAlign:"center"},children:r.jsx("input",{type:"checkbox",checked:e.length>0&&o.size===e.length,onChange:j=>{if(j.target.checked){const k=new Set;e.forEach(L=>k.add(L.id)),l(k)}else l(new Set)}})}),r.jsx("th",{style:{width:240},children:"제목"}),r.jsx("th",{style:{width:120},children:"활동방법"}),r.jsx("th",{style:{width:200},children:"거래처명"}),r.jsx("th",{style:{width:280},children:"활동설명"}),r.jsx("th",{style:{width:220},children:"상위활동"}),r.jsx("th",{style:{width:120},children:"활동유형"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:180},children:"계획 일시"}),r.jsx("th",{style:{width:180},children:"종료 일시"}),r.jsx("th",{style:{width:180},children:"생성일시"})]})}),r.jsx("tbody",{children:e.map((j,k)=>r.jsxs("tr",{title:z(j),onClick:()=>b(j),onContextMenu:L=>w(L,j),"aria-selected":(g==null?void 0:g.id)===j.id?!0:void 0,style:(g==null?void 0:g.id)===j.id?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:[r.jsx("td",{style:{textAlign:"center"},children:r.jsx("input",{type:"checkbox",checked:o.has(j.id),onChange:L=>{l(T=>{const $=new Set(T);return L.target.checked?$.add(j.id):$.delete(j.id),$})}})}),r.jsx("td",{children:j.subject||""}),r.jsx("td",{children:M(j.channel,"channel")}),r.jsx("td",{children:j.customerName||""}),r.jsx("td",{title:j.description||"",style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:j.description||""}),r.jsx("td",{children:j.parentSubject||""}),r.jsx("td",{children:M(j.activityType,"type")}),r.jsx("td",{children:M(j.activityStatus,"status")}),r.jsx("td",{children:br(j.plannedStartAt)}),r.jsx("td",{children:br(j.plannedEndAt)}),r.jsx("td",{children:br(j.createdAt)})]},k))})]})}),x.open&&r.jsxs("div",{className:"context-menu",style:{left:x.x+6,top:x.y+6,maxWidth:720,padding:10,fontSize:10},onClick:j=>j.stopPropagation(),children:[r.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"상위활동"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:8},children:[x.parent&&r.jsx("div",{className:"card",style:{padding:8},children:r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%",fontSize:10},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"제목"}),r.jsx("th",{children:"활동설명"}),r.jsx("th",{children:"활동유형"}),r.jsx("th",{children:"활동방법"}),r.jsx("th",{children:"상태"}),r.jsx("th",{children:"거래처명"}),r.jsx("th",{children:"계획 일시"}),r.jsx("th",{children:"종료 일시"})]})}),r.jsx("tbody",{children:r.jsxs("tr",{children:[r.jsx("td",{children:x.parent.subject||""}),r.jsx("td",{style:{whiteSpace:"pre-wrap",maxWidth:360},children:x.parent.description||""}),r.jsx("td",{children:M(x.parent.activityType,"type")}),r.jsx("td",{children:M(x.parent.channel,"channel")}),r.jsx("td",{children:M(x.parent.activityStatus,"status")}),r.jsx("td",{children:x.parent.customerName||""}),r.jsx("td",{children:br(x.parent.plannedStartAt)}),r.jsx("td",{children:br(x.parent.plannedEndAt)})]})})]})})}),r.jsxs("div",{className:"card",style:{padding:8},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"관련활동"}),x.siblings&&x.siblings.length>0?r.jsxs("table",{className:"table",style:{width:"100%",fontSize:10},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:240},children:"제목"}),r.jsx("th",{style:{width:120},children:"활동유형"}),r.jsx("th",{style:{width:120},children:"활동방법"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:180},children:"계획 일시"}),r.jsx("th",{style:{width:180},children:"종료 일시"})]})}),r.jsx("tbody",{children:x.siblings.map((j,k)=>r.jsxs("tr",{onClick:()=>{b(j),N({open:!1,x:0,y:0})},children:[r.jsx("td",{children:j.subject||""}),r.jsx("td",{children:M(j.activityType,"type")}),r.jsx("td",{children:M(j.channel,"channel")}),r.jsx("td",{children:M(j.activityStatus,"status")}),r.jsx("td",{children:br(j.plannedStartAt)}),r.jsx("td",{children:br(j.plannedEndAt)})]},k))})]}):r.jsx("div",{className:"muted",children:"하위 활동이 없습니다"})]})]})]})]})},[e,o,g,x]);return r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("input",{value:u,onChange:z=>f(z.target.value),onKeyDown:z=>{z.key==="Enter"&&!n&&C()},placeholder:"거래처명 입력",style:{width:220,height:28,padding:"6px 8px",borderRadius:6,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12}}),r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginLeft:8},children:[r.jsx("label",{className:"muted",style:{fontSize:12},children:"상태"}),r.jsxs("select",{value:y,onChange:z=>v(z.target.value),style:{minWidth:140,height:28,padding:"4px 8px",borderRadius:8,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12},children:[r.jsx("option",{value:"",children:"전체"}),m.map(z=>r.jsx("option",{value:z,children:M(z,"status")},z))]})]}),r.jsx("button",{className:"btn",onClick:C,disabled:n,children:n?"조회중…":"조회"}),r.jsx("button",{className:"btn",onClick:O,disabled:!0,title:"준비중 기능",style:{marginLeft:8,opacity:.6,cursor:"not-allowed"},children:gt.action.addToPlan}),a&&r.jsx("span",{className:"error",children:a||gt.errorGeneric}),c&&r.jsx("span",{className:"muted",children:c}),r.jsx("div",{style:{flex:1}}),r.jsxs("div",{className:"muted count-text",children:["총 ",e.length,"건",o.size?` · 선택 ${o.size}건`:""]})]}),r.jsx("div",{style:{marginTop:12},children:B}),r.jsx(AN,{activity:g})]})}function EN(){return r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",children:[r.jsx("h2",{children:"Complaint"}),r.jsx("div",{className:"meta",children:"준비 중"})]}),r.jsx("div",{className:"empty-state",children:"Complaint 기능은 추후 제공될 예정입니다."})]})}function IN({compact:e=!1,maxHeight:t}){const[n,i]=h.useState([]),[a,s]=h.useState(!1),[o,l]=h.useState(null),[c,d]=h.useState({open:!1,x:0,y:0}),[u,f]=h.useState(()=>{try{const v=localStorage.getItem("tnt.sales.selectedInquiry");if(v){const g=JSON.parse(v),b=Number(g==null?void 0:g.id);return Number.isFinite(b)?b:null}}catch{}return null});async function m(v){l(null),s(!0);try{let g=null;try{const x=await fetch("/api/v1/inquiries");x.ok&&(g=await x.json())}catch{}let b=[];if(Array.isArray(g)?b=g.map((x,N)=>({id:Number((x==null?void 0:x.id)??N+1),title:(x==null?void 0:x.title)!=null?String(x.title):"",customerSeq:(x==null?void 0:x.customerSeq)!=null?Number(x.customerSeq):(x==null?void 0:x.customer_seq)!=null?Number(x.customer_seq):null,customerName:(x==null?void 0:x.customerName)??(x==null?void 0:x.customer_name)??null,inquiryStatus:(x==null?void 0:x.inquiryStatus)??(x==null?void 0:x.inquiry_status)??(x==null?void 0:x.status)??"",assigneeSeq:(x==null?void 0:x.assigneeSeq)!=null?Number(x.assigneeSeq):(x==null?void 0:x.assignee_seq)!=null?Number(x.assignee_seq):null,assigneeName:(x==null?void 0:x.assigneeName)??(x==null?void 0:x.assignee_name)??null,assigneeId:(x==null?void 0:x.assigneeId)??(x==null?void 0:x.assignee_id)??null,openedAt:(x==null?void 0:x.openedAt)??(x==null?void 0:x.opened_at)??"",updatedAt:(x==null?void 0:x.updatedAt)??(x==null?void 0:x.updated_at)??"",inquiryCategory:(x==null?void 0:x.inquiryCategory)??(x==null?void 0:x.inquiry_category)??"",ownerSeq:(x==null?void 0:x.ownerSeq)!=null?Number(x.ownerSeq):(x==null?void 0:x.owner_seq)!=null?Number(x.owner_seq):null,ownerName:(x==null?void 0:x.ownerName)??(x==null?void 0:x.owner_name)??null,channel:(x==null?void 0:x.channel)??"",contactSeq:(x==null?void 0:x.contactSeq)!=null?Number(x.contactSeq):(x==null?void 0:x.contact_seq)!=null?Number(x.contact_seq):null,contactName:(x==null?void 0:x.contactName)??(x==null?void 0:x.contact_name)??null,leadId:(x==null?void 0:x.leadId)??"",severity:(x==null?void 0:x.severity)??"",closedAt:(x==null?void 0:x.closedAt)??(x==null?void 0:x.closed_at)??"",inquiryContent:(x==null?void 0:x.inquiryContent)??(x==null?void 0:x.inquiry_content)??"",answerContent:(x==null?void 0:x.answerContent)??(x==null?void 0:x.answer_content)??""})):b=[],b.sort((x,N)=>{const A=x.updatedAt?Date.parse(x.updatedAt):0,C=N.updatedAt?Date.parse(N.updatedAt):0;return C!==A?C-A:(x.title||"").localeCompare(N.title||"","ko",{sensitivity:"base"})}),i(b),v!=null){const x=b.find(N=>N.id===v);if(x){p(x);return}}b.length>0&&u==null&&p(b[0])}catch(g){l((g==null?void 0:g.message)||"조회 중 오류가 발생했습니다")}finally{s(!1)}}h.useEffect(()=>{m()},[]),h.useEffect(()=>{const v=g=>{var x;const b=((x=g==null?void 0:g.detail)==null?void 0:x.focusId)!=null?Number(g.detail.focusId):null;m(b)};return window.addEventListener("tnt.sales.inquiry.reload",v),()=>window.removeEventListener("tnt.sales.inquiry.reload",v)},[]);function p(v){f(v.id);try{localStorage.setItem("tnt.sales.selectedInquiry",JSON.stringify(v)),window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.selected",{detail:{inquiry:v}}))}catch{}}return h.useMemo(()=>r.jsxs("div",{className:"table-container",style:{height:t??(e?"32vh":void 0),maxHeight:t??(e?"32vh":void 0)},children:[n.length===0?r.jsx("div",{className:"empty-state",children:a?"불러오는 중…":o||"데이터가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"제목"}),r.jsx("th",{style:{width:200},children:"거래처명"}),r.jsx("th",{style:{width:120},children:"문의유형"}),r.jsx("th",{style:{width:120},children:"접수자"}),r.jsx("th",{style:{width:120},children:"당사담당자"}),r.jsx("th",{style:{width:160},children:"접수시간"})]})}),r.jsx("tbody",{children:n.map((v,g)=>{const b=(()=>{if(String(v.inquiryStatus||"").trim()==="완료")return!1;const N=v.openedAt?Date.parse(v.openedAt):NaN;return Number.isFinite(N)?N<=Date.now()-864e5:!1})();return r.jsxs("tr",{className:u===v.id?"selected":void 0,onClick:()=>p(v),onMouseEnter:x=>d({open:!0,x:x.clientX+8,y:x.clientY+8,row:v}),onMouseMove:x=>d(N=>({...N,x:x.clientX+8,y:x.clientY+8})),onMouseLeave:()=>d({open:!1,x:0,y:0}),style:b?{color:"#ef4444"}:void 0,children:[r.jsx("td",{children:v.title||""}),r.jsx("td",{children:v.customerName||(v.customerSeq!=null?String(v.customerSeq):"")}),r.jsx("td",{children:v.inquiryCategory||""}),r.jsx("td",{children:v.ownerName||(v.ownerSeq!=null?String(v.ownerSeq):"")}),r.jsx("td",{children:v.assigneeName||(v.assigneeSeq!=null?String(v.assigneeSeq):"")}),r.jsx("td",{children:v.openedAt?(()=>{const x=new Date(v.openedAt);if(isNaN(x.getTime()))return v.openedAt;const N=String(x.getFullYear()%100).padStart(2,"0"),A=String(x.getMonth()+1).padStart(2,"0"),C=String(x.getDate()).padStart(2,"0"),w=String(x.getHours()).padStart(2,"0"),O=String(x.getMinutes()).padStart(2,"0");return`${N}-${A}-${C} ${w}:${O}`})():""})]},g)})})]}),c.open&&c.row&&r.jsxs("div",{role:"dialog","aria-label":"문의 상세",style:{position:"fixed",left:Math.min(c.x,(typeof window<"u"?window.innerWidth:1200)-420),top:Math.min(c.y,(typeof window<"u"?window.innerHeight:800)-320),zIndex:9999,maxWidth:400,background:"var(--panel)",color:"var(--text)",border:"1px solid var(--border)",borderRadius:10,boxShadow:"0 12px 28px rgba(0,0,0,.25)",padding:10,fontSize:12,lineHeight:1.4,pointerEvents:"none"},children:[r.jsx("div",{style:{fontWeight:700,marginBottom:6},children:c.row.title||"(문의)"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr",columnGap:8,rowGap:4},children:[r.jsx("span",{className:"muted",children:"거래처"}),r.jsx("span",{children:c.row.customerName||(c.row.customerSeq!=null?String(c.row.customerSeq):"")}),r.jsx("span",{className:"muted",children:"문의유형"}),r.jsx("span",{children:c.row.inquiryCategory||""}),r.jsx("span",{className:"muted",children:"상태"}),r.jsx("span",{children:c.row.inquiryStatus||""}),r.jsx("span",{className:"muted",children:"난이도"}),r.jsx("span",{children:c.row.severity||""}),r.jsx("span",{className:"muted",children:"접수자"}),r.jsx("span",{children:c.row.ownerName||(c.row.ownerSeq!=null?String(c.row.ownerSeq):"")}),r.jsx("span",{className:"muted",children:"당사담당자"}),r.jsx("span",{children:c.row.assigneeName||(c.row.assigneeSeq!=null?String(c.row.assigneeSeq):"")}),r.jsx("span",{className:"muted",children:"리드ID"}),r.jsx("span",{children:c.row.leadId||""}),r.jsx("span",{className:"muted",children:"채널"}),r.jsx("span",{children:c.row.channel||""}),r.jsx("span",{className:"muted",children:"접수시각"}),r.jsx("span",{children:c.row.openedAt?(()=>{const v=new Date(c.row.openedAt);if(isNaN(v.getTime()))return String(c.row.openedAt);const g=String(v.getFullYear()%100).padStart(2,"0"),b=String(v.getMonth()+1).padStart(2,"0"),x=String(v.getDate()).padStart(2,"0"),N=String(v.getHours()).padStart(2,"0"),A=String(v.getMinutes()).padStart(2,"0");return`${g}-${b}-${x} ${N}:${A}`})():""}),r.jsx("span",{className:"muted",children:"종료시각"}),r.jsx("span",{children:c.row.closedAt?(()=>{const v=new Date(c.row.closedAt);if(isNaN(v.getTime()))return String(c.row.closedAt);const g=String(v.getFullYear()%100).padStart(2,"0"),b=String(v.getMonth()+1).padStart(2,"0"),x=String(v.getDate()).padStart(2,"0"),N=String(v.getHours()).padStart(2,"0"),A=String(v.getMinutes()).padStart(2,"0");return`${g}-${b}-${x} ${N}:${A}`})():""}),r.jsx("span",{className:"muted",children:"문의내용"}),r.jsx("span",{style:{whiteSpace:"pre-wrap"},children:c.row.inquiryContent||""}),r.jsx("span",{className:"muted",children:"답변내용"}),r.jsx("span",{style:{whiteSpace:"pre-wrap"},children:c.row.answerContent||""}),r.jsx("span",{className:"muted",children:"수정시각"}),r.jsx("span",{children:c.row.updatedAt?(()=>{const v=new Date(c.row.updatedAt);if(isNaN(v.getTime()))return String(c.row.updatedAt);const g=String(v.getFullYear()%100).padStart(2,"0"),b=String(v.getMonth()+1).padStart(2,"0"),x=String(v.getDate()).padStart(2,"0"),N=String(v.getHours()).padStart(2,"0"),A=String(v.getMinutes()).padStart(2,"0");return`${g}-${b}-${x} ${N}:${A}`})():""}),r.jsx("span",{className:"muted",children:"ID"}),r.jsx("span",{children:c.row.id})]})]})]}),[n,u,a,o,e,t,c])}const rs="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20width='16'%20height='16'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20aria-hidden='true'%3e%3ccircle%20cx='11'%20cy='11'%20r='7'%20/%3e%3cline%20x1='21'%20y1='21'%20x2='16.65'%20y2='16.65'%20/%3e%3c/svg%3e";function Dv({open:e,onClose:t,title:n,children:i,footer:a,width:s=380}){return h.useEffect(()=>{if(!e)return;const o=l=>{l.key==="Escape"&&t()};return window.addEventListener("keydown",o,!0),()=>window.removeEventListener("keydown",o,!0)},[e,t]),e?$d.createPortal(r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:2e3},children:[r.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"22%",left:"50%",transform:"translateX(-50%)",width:s,maxWidth:"92vw",padding:12},children:[n?r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h3",{style:{margin:0,fontSize:14},children:n})}):null,r.jsx("div",{style:{padding:"4px 2px",fontSize:13},children:i}),r.jsx("div",{className:"controls",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:a})]})]}),document.body):null}function PN({open:e,onClose:t,onSubmit:n}){const[i,a]=h.useState(""),[s,o]=h.useState(""),[l,c]=h.useState(""),[d,u]=h.useState(""),[f,m]=h.useState(""),[p,y]=h.useState(""),[v,g]=h.useState(""),[b,x]=h.useState(!1),[N,A]=h.useState(""),[C,w]=h.useState(""),[O,M]=h.useState(""),[B,z]=h.useState(""),[j,k]=h.useState(""),[L,T]=h.useState(!1),[$,V]=h.useState(""),[G,ne]=h.useState(""),[U,I]=h.useState(!1),[P,D]=h.useState(""),[S,_]=h.useState(""),[H,q]=h.useState(""),[K,W]=h.useState(""),[R,oe]=h.useState(null),Y=h.useRef(null),[X,de]=h.useState(!1),[be,ke]=h.useState({left:0,top:0});h.useEffect(()=>{if(e){const J=new Date;J.setMinutes(J.getMinutes()-J.getTimezoneOffset()),D(J.toISOString().slice(0,16)),_(""),a(""),o(""),c(""),u(""),m(""),y(""),g(""),A("");try{const ge=localStorage.getItem("tnt.sales.empName")||"",Pe=localStorage.getItem("tnt.sales.assigneeId")||"";w(ge),M(Pe)}catch{w(""),M("")}z(""),k(""),V(""),ne(""),q(""),W(""),de(!1)}},[e]),h.useEffect(()=>{if(!e)return;const J=ge=>{if(ge.key==="Escape"){if(b||U||L)return;t()}};return window.addEventListener("keydown",J,!0),()=>window.removeEventListener("keydown",J,!0)},[e,t,b,U,L]),h.useEffect(()=>{if(!R)return;const J=ge=>{ge.key==="Escape"&&oe(null)};return window.addEventListener("keydown",J,!0),()=>window.removeEventListener("keydown",J,!0)},[R]);function ve(J){var ye;J.preventDefault();const ge=(ye=Y.current)==null?void 0:ye.getBoundingClientRect(),Pe=J.clientX,Se=J.clientY,Je=ge?ge.left:be.left,yt=ge?ge.top:be.top,jt=Ae=>{const Oe=Ae.clientX-Pe,Fe=Ae.clientY-Se;ke({left:Je+Oe,top:yt+Fe}),de(!0)},It=()=>{window.removeEventListener("mousemove",jt),window.removeEventListener("mouseup",It)};window.addEventListener("mousemove",jt),window.addEventListener("mouseup",It)}if(!e)return null;function Ie(){const J=(i||"").trim().length>0,ge=(s||"").trim().length>0,Pe=!!(p&&Number(p)),Se=!!($&&String($).trim());if(!J){oe("제목을 입력해 주세요.");return}if(!ge){oe("상태를 선택해 주세요.");return}if(!(Pe||Se)){oe("거래처 또는 잠재고객 중 하나를 선택해 주세요.");return}const Je={title:i,inquiryStatus:s,severity:l,inquiryCategory:d,channel:f,customerSeq:p?Number(p):null,contactName:N||null,ownerId:O||null,assigneeId:j||null,createdBy:O||null,updatedBy:O||null,leadId:$,openedAt:P||null,closedAt:S||null,inquiryContent:H,answerContent:K};n==null||n(Je)}return r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e3},children:[r.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),r.jsxs("div",{ref:Y,className:"card",style:{position:"absolute",zIndex:1001,width:"90%",maxWidth:900,maxHeight:"90%",overflow:"auto",padding:12,left:X?be.left:"50%",top:X?be.top:"50%",transform:X?"none":"translate(-50%, -50%)"},children:[r.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsxs("div",{onMouseDown:ve,style:{display:"flex",alignItems:"center",gap:8,marginBottom:12,cursor:"move"},children:[r.jsx("span",{className:"muted",style:{fontWeight:700},children:"새 문의"}),r.jsx("div",{style:{flex:1,height:1,background:"var(--border)"}})]}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"inline-field",children:[r.jsxs("label",{children:["제목",r.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),r.jsx("input",{className:"subject-input",value:i,onChange:J=>a(J.target.value),placeholder:"제목"})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"문의유형"}),r.jsxs("select",{className:"subject-input",value:d,onChange:J=>u(J.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"제품문의",children:"제품문의"}),r.jsx("option",{value:"재고/배송문의",children:"재고/배송문의"}),r.jsx("option",{value:"가격문의",children:"가격문의"}),r.jsx("option",{value:"기타문의",children:"기타문의"})]})]}),r.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"문의내용"}),r.jsx("textarea",{className:"subject-input",value:H,onChange:J=>q(J.target.value),placeholder:"상세 설명",style:{minHeight:120}})]}),r.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"답변내용"}),r.jsx("textarea",{className:"subject-input",value:K,onChange:J=>W(J.target.value),placeholder:"답변/조치",style:{minHeight:120}})]}),r.jsxs("div",{className:"inline-field",children:[r.jsxs("label",{children:["상태",r.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),r.jsxs("select",{className:"subject-input",value:s,onChange:J=>o(J.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"신규접수",children:"신규접수"}),r.jsx("option",{value:"확인 중",children:"확인 중"}),r.jsx("option",{value:"완료",children:"완료"}),r.jsx("option",{value:"보류",children:"보류"})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"난이도"}),r.jsxs("select",{className:"subject-input",value:l,onChange:J=>c(J.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"상",children:"상"}),r.jsx("option",{value:"중",children:"중"}),r.jsx("option",{value:"하",children:"하"})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"접수경로"}),r.jsxs("select",{className:"subject-input",value:f,onChange:J=>m(J.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"전화",children:"전화"}),r.jsx("option",{value:"이메일",children:"이메일"}),r.jsx("option",{value:"고객채널",children:"고객채널"}),r.jsx("option",{value:"직접입력",children:"직접입력"})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"잠재고객"}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("input",{className:"subject-input",type:"text",value:G,onChange:J=>{ne(J.target.value),V("")},placeholder:"잠재고객명",style:{paddingRight:28}}),r.jsx("button",{type:"button","aria-label":"잠재고객 검색",title:"잠재고객 검색",onClick:()=>I(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:r.jsx("img",{src:rs,className:"icon",alt:"검색"})})]}),$&&r.jsxs("div",{className:"muted",style:{fontSize:11,marginTop:4},children:["선택됨: id ",$]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"거래처"}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("input",{className:"subject-input",type:"text",value:v,onChange:J=>{g(J.target.value),y("")},placeholder:"거래처명",style:{paddingRight:28}}),r.jsx("button",{type:"button","aria-label":"거래처 검색",title:"거래처 검색",onClick:()=>x(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:r.jsx("img",{src:rs,className:"icon",alt:"검색"})})]}),p&&r.jsxs("div",{className:"muted",style:{fontSize:11,marginTop:4},children:["선택됨: seq ",p]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"거래처 담당자"}),r.jsx("input",{className:"subject-input",type:"text",value:N,onChange:J=>A(J.target.value),placeholder:"이름"})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"접수자"}),r.jsx("input",{className:"subject-input",value:C,readOnly:!0,title:"로그인 사용자"})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"당사 담당자"}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("input",{className:"subject-input",type:"text",value:B,onChange:J=>{z(J.target.value),k("")},placeholder:"이름",style:{paddingRight:28}}),r.jsx("button",{type:"button","aria-label":"직원 검색",title:"직원 검색",onClick:()=>T(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:r.jsx("img",{src:rs,className:"icon",alt:"검색"})})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"접수시각"}),r.jsx("input",{className:"subject-input",type:"datetime-local",value:P,onChange:J=>D(J.target.value)})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"종료시각"}),r.jsx("input",{className:"subject-input",type:"datetime-local",value:S,onChange:J=>_(J.target.value)})]})]}),r.jsxs("div",{className:"controls",style:{gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{className:"btn",onClick:Ie,children:"저장"}),r.jsx("button",{className:"btn",onClick:t,children:"취소"})]})]}),b&&r.jsx(TN,{defaultQuery:v,onClose:()=>x(!1),onSelect:J=>{y(J.customerSeq?String(J.customerSeq):""),g(J.customerName||""),x(!1)}}),L&&r.jsx(DN,{defaultQuery:B,onClose:()=>T(!1),onSelect:J=>{k(J.assigneeId||""),z(J.empName||""),T(!1)}}),U&&r.jsx(ON,{defaultQuery:G,onClose:()=>I(!1),onSelect:J=>{V(J.id!=null?String(J.id):""),ne(J.companyName||""),I(!1)}}),r.jsx(Dv,{open:!!R,onClose:()=>oe(null),width:360,footer:r.jsx("button",{className:"btn",onClick:()=>oe(null),children:"확인"}),children:R})]})}function TN({defaultQuery:e,onClose:t,onSelect:n}){const[i,a]=h.useState(e||""),[s,o]=h.useState([]),[l,c]=h.useState(!1),[d,u]=h.useState(null);async function f(m=!0){c(!0),u(null);try{const p=new URL("/api/v1/customers",window.location.origin);i.trim()&&p.searchParams.set("name",i.trim()),p.searchParams.set("mineOnly","false"),p.searchParams.set("limit","100");const y=await fetch(p.toString());if(!y.ok)throw new Error(`HTTP ${y.status}`);const v=await y.json();if(Array.isArray(v)){const g=v.map(b=>({customerSeq:(b==null?void 0:b.customerSeq)??(b==null?void 0:b.customer_seq)??null,customerId:(b==null?void 0:b.customerId)??(b==null?void 0:b.customer_id)??null,customerName:(b==null?void 0:b.customerName)??(b==null?void 0:b.customer_name)??null,telNo:(b==null?void 0:b.telNo)??(b==null?void 0:b.tel_no)??null,addrProvinceName:(b==null?void 0:b.addrProvinceName)??(b==null?void 0:b.addr_province_name)??null,addrCityName:(b==null?void 0:b.addrCityName)??(b==null?void 0:b.addr_city_name)??null,companyType:(b==null?void 0:b.companyType)??(b==null?void 0:b.company_type)??null,ownerName:(b==null?void 0:b.ownerName)??(b==null?void 0:b.owner_name)??null}));o(g)}else o([])}catch(p){u((p==null?void 0:p.message)||"조회 중 오류가 발생했습니다"),o([])}finally{c(!1)}}return h.useEffect(()=>{f(!0)},[]),h.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[r.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[r.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"거래처명",value:i,onChange:m=>a(m.target.value),onKeyDown:m=>{m.key==="Enter"&&f(!0)},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:()=>f(!0),children:"조회"})]}),r.jsx("div",{className:"table-container",style:{height:360},children:s.length===0?r.jsx("div",{className:"empty-state",children:l?"불러오는 중…":d||"결과가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:220},children:"거래처명"}),r.jsx("th",{style:{width:140},children:"회사구분"}),r.jsx("th",{style:{width:140},children:"대표자명"}),r.jsx("th",{style:{width:180},children:"지역"})]})}),r.jsx("tbody",{children:s.map((m,p)=>r.jsxs("tr",{onDoubleClick:()=>n(m),onClick:()=>n(m),children:[r.jsx("td",{children:m.customerName||""}),r.jsx("td",{children:m.companyType||""}),r.jsx("td",{children:m.ownerName||""}),r.jsx("td",{children:[m.addrProvinceName,m.addrCityName].filter(Boolean).join(" ")})]},p))})]})})]})]})}function ON({defaultQuery:e,onClose:t,onSelect:n}){const[i,a]=h.useState(e||""),[s,o]=h.useState([]),[l,c]=h.useState(!1),[d,u]=h.useState(null);async function f(m=!0){c(!0),u(null);try{const p=new URL("/api/v1/leads",window.location.origin);i.trim()&&p.searchParams.set("company_name",i.trim()),p.searchParams.set("limit","100");const y=await fetch(p.toString());if(!y.ok)throw new Error(`HTTP ${y.status}`);const v=await y.json();if(Array.isArray(v)){const g=v.map(b=>({id:(b==null?void 0:b.id)!=null?Number(b.id):null,companyName:(b==null?void 0:b.company_name)??null,leadStatus:(b==null?void 0:b.lead_status)??null,ownerName:(b==null?void 0:b.owner_name)??null,addrProvinceName:(b==null?void 0:b.addr_province_name)??null}));o(g)}else o([])}catch(p){u((p==null?void 0:p.message)||"조회 중 오류가 발생했습니다"),o([])}finally{c(!1)}}return h.useEffect(()=>{f(!0)},[]),h.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[r.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[r.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"잠재고객명",value:i,onChange:m=>a(m.target.value),onKeyDown:m=>{m.key==="Enter"&&f(!0)},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:()=>f(!0),children:"조회"})]}),r.jsx("div",{className:"table-container",style:{height:360},children:s.length===0?r.jsx("div",{className:"empty-state",children:l?"불러오는 중…":d||"결과가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:220},children:"잠재고객명"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:140},children:"소유자"}),r.jsx("th",{style:{width:160},children:"지역"})]})}),r.jsx("tbody",{children:s.map((m,p)=>r.jsxs("tr",{onDoubleClick:()=>n(m),onClick:()=>n(m),children:[r.jsx("td",{children:m.companyName||""}),r.jsx("td",{children:m.leadStatus||""}),r.jsx("td",{children:m.ownerName||""}),r.jsx("td",{children:m.addrProvinceName||""})]},p))})]})})]})]})}function DN({defaultQuery:e,onClose:t,onSelect:n}){const[i,a]=h.useState(e||""),[s,o]=h.useState([]),[l,c]=h.useState(!1),[d,u]=h.useState(null);async function f(){c(!0),u(null);try{const m=new URL("/api/v1/employees",window.location.origin);m.searchParams.set("depts","all");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const y=await p.json(),v=Array.isArray(y)?y.map(x=>({empId:(x==null?void 0:x.emp_id)??null,empName:(x==null?void 0:x.emp_name)??null,deptName:(x==null?void 0:x.dept_name)??null,assigneeId:(x==null?void 0:x.assignee_id)??null})):[],g=i.trim().toLowerCase(),b=(g?v.filter(x=>(x.empName||"").toLowerCase().includes(g)||(x.empId||"").toLowerCase().includes(g)||(x.deptName||"").toLowerCase().includes(g)):v).sort((x,N)=>(x.empName||"").localeCompare(N.empName||"","ko",{sensitivity:"base"}));o(b)}catch(m){u((m==null?void 0:m.message)||"조회 실패"),o([])}finally{c(!1)}}return h.useEffect(()=>{f()},[]),h.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[r.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:700,maxHeight:"80%",overflow:"auto",padding:12},children:[r.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"이름/사번/부서",value:i,onChange:m=>a(m.target.value),onKeyDown:m=>{m.key==="Enter"&&f()},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:f,children:"조회"})]}),r.jsx("div",{className:"table-container",style:{height:320},children:s.length===0?r.jsx("div",{className:"empty-state",children:l?"불러오는 중…":d||"결과가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:160},children:"이름"}),r.jsx("th",{style:{width:160},children:"부서"}),r.jsx("th",{style:{width:140},children:"사번"}),r.jsx("th",{style:{width:140},children:"assignee_id"})]})}),r.jsx("tbody",{children:s.map((m,p)=>r.jsxs("tr",{onDoubleClick:()=>n(m),onClick:()=>n(m),children:[r.jsx("td",{children:m.empName||""}),r.jsx("td",{children:m.deptName||""}),r.jsx("td",{children:m.empId||""}),r.jsx("td",{children:m.assigneeId||""})]},p))})]})})]})]})}function _N(){const[e,t]=h.useState(()=>{try{const j=localStorage.getItem("tnt.sales.selectedInquiry");return j?JSON.parse(j):null}catch{return null}});h.useEffect(()=>{const j=()=>{try{const k=localStorage.getItem("tnt.sales.selectedInquiry");t(k?JSON.parse(k):null)}catch{t(null)}};return window.addEventListener("tnt.sales.inquiry.selected",j),()=>window.removeEventListener("tnt.sales.inquiry.selected",j)},[]);const[n,i]=h.useState(null),[a,s]=h.useState(null),[o,l]=h.useState(!1),[c,d]=h.useState(null);h.useEffect(()=>{if(!a)return;const j=k=>{k.key==="Escape"&&s(null)};return window.addEventListener("keydown",j,!0),()=>window.removeEventListener("keydown",j,!0)},[a]),h.useEffect(()=>{if(!o)return;const j=k=>{k.key==="Escape"&&l(!1)};return window.addEventListener("keydown",j,!0),()=>window.removeEventListener("keydown",j,!0)},[o]),h.useEffect(()=>{if(!c)return;const j=k=>{k.key==="Escape"&&d(null)};return window.addEventListener("keydown",j,!0),()=>window.removeEventListener("keydown",j,!0)},[c]);const u=j=>{if(!j)return"";try{const k=new Date(j);if(isNaN(k.getTime()))return"";const L=String(k.getFullYear()),T=String(k.getMonth()+1).padStart(2,"0"),$=String(k.getDate()).padStart(2,"0"),V=String(k.getHours()).padStart(2,"0"),G=String(k.getMinutes()).padStart(2,"0");return`${L}-${T}-${$}T${V}:${G}`}catch{return""}},[f,m]=h.useState({}),[p,y]=h.useState(!1),[v,g]=h.useState(!1),[b,x]=h.useState(!1);h.useEffect(()=>{if(!e){m({});return}const j=typeof window<"u"&&localStorage.getItem("tnt.sales.empName")||"",k=typeof window<"u"&&localStorage.getItem("tnt.sales.assigneeId")||"";m({title:e.title||"",inquiryCategory:e.inquiryCategory||"",inquiryContent:e.inquiryContent||"",answerContent:e.answerContent||"",inquiryStatus:e.inquiryStatus||"",severity:e.severity||"",channel:e.channel||"",leadId:e.leadId||"",leadName:"",customerSeq:e.customerSeq!=null?String(e.customerSeq):"",customerName:e.customerName||"",contactName:e.contactName||"",ownerName:j,ownerId:k,assigneeName:e.assigneeName||"",assigneeId:e.assigneeId||"",openedAt:u(e.openedAt),closedAt:u(e.closedAt)})},[e]),h.useEffect(()=>{const j=f.leadId;if(!j||f.leadName)return;let k=!1;return(async()=>{try{const L=await fetch(`/api/v1/leads/${encodeURIComponent(String(j))}`);if(!L.ok)return;const T=await L.json().catch(()=>null);!k&&T&&m($=>({...$,leadName:T.company_name||$.leadName||""}))}catch{}})(),()=>{k=!0}},[f.leadId,f.leadName]);function N(j,k){m(L=>({...L,[j]:k}))}async function A(){if(!(e!=null&&e.id))return;const j=(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||""}catch{return""}})(),k=String(f.title||"").trim().length>0,L=String(f.inquiryStatus||"").trim().length>0,T=!!(f.customerSeq&&Number(f.customerSeq)),$=!!(f.leadId&&String(f.leadId).trim());if(!k){s("제목을 입력해 주세요.");return}if(!L){s("상태를 선택해 주세요.");return}if(!(T||$)){s("거래처 또는 잠재고객 중 하나를 선택해 주세요.");return}const V={title:f.title,inquiryCategory:f.inquiryCategory,inquiryContent:f.inquiryContent,answerContent:f.answerContent,inquiryStatus:f.inquiryStatus,severity:f.severity,channel:f.channel,leadId:f.leadId,customerSeq:f.customerSeq?Number(f.customerSeq):null,contactName:f.contactName||null,ownerId:f.ownerId||null,assigneeId:f.assigneeId||null,updatedBy:j||f.ownerId||null,openedAt:f.openedAt||null,closedAt:f.closedAt||null};try{const G=await fetch(`/api/v1/inquiries/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(V)});if(!G.ok){const ne=await G.text().catch(()=>"");s("수정 실패: "+(ne||G.status));return}try{i("수정 되었습니다."),window.setTimeout(()=>i(null),3e3)}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.reload",{detail:{focusId:e.id}}))}catch{}}catch{alert("수정 중 오류가 발생했습니다")}}const C=h.useMemo(()=>r.jsx("div",{className:"card",style:{padding:12},children:e?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"inline-field",children:[r.jsxs("label",{children:["제목",r.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),r.jsx("input",{className:"subject-input",value:f.title||"",onChange:j=>N("title",j.target.value)})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"문의유형"}),r.jsxs("select",{className:"subject-input",value:f.inquiryCategory||"",onChange:j=>N("inquiryCategory",j.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"제품문의",children:"제품문의"}),r.jsx("option",{value:"재고/배송문의",children:"재고/배송문의"}),r.jsx("option",{value:"가격문의",children:"가격문의"}),r.jsx("option",{value:"기타문의",children:"기타문의"})]})]}),r.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"문의내용"}),r.jsx("textarea",{className:"subject-input",value:f.inquiryContent||"",onChange:j=>N("inquiryContent",j.target.value),style:{minHeight:80}})]}),r.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"답변내용"}),r.jsx("textarea",{className:"subject-input",value:f.answerContent||"",onChange:j=>N("answerContent",j.target.value),style:{minHeight:80}})]}),r.jsxs("div",{className:"inline-field",children:[r.jsxs("label",{children:["상태",r.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),r.jsxs("select",{className:"subject-input",value:f.inquiryStatus||"",onChange:j=>N("inquiryStatus",j.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"신규접수",children:"신규접수"}),r.jsx("option",{value:"확인 중",children:"확인 중"}),r.jsx("option",{value:"완료",children:"완료"}),r.jsx("option",{value:"보류",children:"보류"})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"난이도"}),r.jsxs("select",{className:"subject-input",value:f.severity||"",onChange:j=>N("severity",j.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"상",children:"상"}),r.jsx("option",{value:"중",children:"중"}),r.jsx("option",{value:"하",children:"하"})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"접수경로"}),r.jsxs("select",{className:"subject-input",value:f.channel||"",onChange:j=>N("channel",j.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"전화",children:"전화"}),r.jsx("option",{value:"이메일",children:"이메일"}),r.jsx("option",{value:"고객채널",children:"고객채널"}),r.jsx("option",{value:"직접입력",children:"직접입력"})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"잠재고객"}),r.jsx("input",{className:"subject-input",value:f.leadName||"",readOnly:!0,placeholder:"-"})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"거래처"}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("input",{className:"subject-input",value:f.customerName||"",onChange:j=>{N("customerName",j.target.value),N("customerSeq","")},placeholder:"거래처명",style:{paddingRight:28}}),r.jsx("button",{type:"button","aria-label":"거래처 검색",title:"거래처 검색",onClick:()=>y(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:r.jsx("img",{src:rs,className:"icon",alt:"검색"})})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"거래처 담당자"}),r.jsx("input",{className:"subject-input",value:f.contactName||"",onChange:j=>N("contactName",j.target.value),placeholder:"이름"})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"접수자"}),r.jsx("input",{className:"subject-input",value:f.ownerName||"",readOnly:!0,title:"로그인 사용자"})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"당사 담당자"}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("input",{className:"subject-input",value:f.assigneeName||"",onChange:j=>{N("assigneeName",j.target.value),N("assigneeId","")},placeholder:"이름",style:{paddingRight:28}}),r.jsx("button",{type:"button","aria-label":"직원 검색",title:"직원 검색",onClick:()=>x(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:r.jsx("img",{src:rs,className:"icon",alt:"검색"})})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"접수시각"}),r.jsx("input",{className:"subject-input",type:"datetime-local",value:f.openedAt||"",onChange:j=>N("openedAt",j.target.value)})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"종료시각"}),r.jsx("input",{className:"subject-input",type:"datetime-local",value:f.closedAt||"",onChange:j=>N("closedAt",j.target.value)})]})]}),r.jsxs("div",{className:"controls",style:{gap:8,justifyContent:"flex-end",alignItems:"center"},children:[n&&r.jsx("span",{className:"success",children:n}),r.jsx("button",{className:"btn",onClick:A,children:"저장"}),r.jsx("button",{className:"btn",onClick:z,children:"삭제"})]})]}):r.jsx("div",{className:"empty-state",children:"선택된 케이스가 없습니다."})}),[e,f,n]),[w,O]=h.useState(!1);async function M(j){try{const k=await fetch("/api/v1/inquiries",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)});if(!k.ok){const $=await k.text().catch(()=>"");alert("저장 실패: "+($||k.status));return}const L=await k.json().catch(()=>null),T=L&&L.id!=null?Number(L.id):null;O(!1);try{window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.reload",{detail:{focusId:T}}))}catch{}}catch{alert("저장 중 오류가 발생했습니다")}}async function B(){try{const j=await fetch(`/api/v1/inquiries/${e.id}`,{method:"DELETE"});if(!j.ok){const k=await j.text().catch(()=>"");s("삭제 실패: "+(k||j.status));return}try{localStorage.removeItem("tnt.sales.selectedInquiry")}catch{}t(null),d("삭제 되었습니다.");try{window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.reload",{detail:{}}))}catch{}}catch{s("삭제 중 오류가 발생했습니다")}}async function z(){e!=null&&e.id&&l(!0)}return r.jsxs(r.Fragment,{children:[r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,minWidth:0,flex:"1 1 auto"},children:[r.jsx("h2",{style:{margin:0},children:"문의"}),(()=>{const j=["신규접수","확인 중","완료"],k=String(f.inquiryStatus||"").trim(),L=k==="보류";let T=j.indexOf(k);L&&(T=1),T<0&&(T=0);const $=Math.max(0,Math.min(100,Math.round(T/Math.max(1,j.length-1)*100)));return r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,flex:"0 1 520px"},children:[r.jsx("div",{className:"progress",style:{width:"min(520px, 48vw)"},children:r.jsx("div",{className:"progress-bar",style:{width:`${$}%`,background:L?"#ef4444":"var(--accent)"}})}),r.jsx("div",{style:{display:"flex",justifyContent:"space-between",width:"min(520px, 48vw)",fontSize:11,color:"var(--muted)"},children:j.map(V=>r.jsx("span",{style:{fontWeight:k===V?700:400},children:V},V))})]})})()]}),r.jsx("div",{className:"controls",style:{gap:8},children:r.jsx("button",{className:"btn",onClick:()=>O(!0),children:"신규 등록"})})]}),p&&r.jsx(MN,{defaultQuery:f.customerName,onClose:()=>y(!1),onSelect:j=>{N("customerSeq",j.customerSeq?String(j.customerSeq):""),N("customerName",j.customerName||""),y(!1)}}),v&&r.jsx(LN,{defaultQuery:f.leadName,onClose:()=>g(!1),onSelect:j=>{N("leadId",j.id!=null?String(j.id):""),N("leadName",j.companyName||""),g(!1)}}),b&&r.jsx($N,{defaultQuery:f.assigneeName,onClose:()=>x(!1),onSelect:j=>{N("assigneeId",j.assigneeId||""),N("assigneeName",j.empName||""),x(!1)}}),r.jsx(IN,{compact:!0,maxHeight:"21vh"}),r.jsx("section",{className:"card",style:{marginTop:12,minHeight:240},children:C})]}),r.jsx(PN,{open:w,onClose:()=>O(!1),onSubmit:M}),r.jsx(Dv,{open:!!a,onClose:()=>s(null),width:380,footer:r.jsx("button",{className:"btn",onClick:()=>s(null),children:"확인"}),children:a}),o&&r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:90},children:[r.jsx("div",{onClick:()=>l(!1),style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"24%",left:"50%",transform:"translateX(-50%)",width:380,maxWidth:"92vw",padding:12},children:[r.jsx("div",{style:{padding:"4px 2px",fontSize:13},children:"선택한 문의를 삭제하시겠습니까?"}),r.jsxs("div",{className:"controls",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:[r.jsx("button",{className:"btn",onClick:()=>l(!1),children:"취소"}),r.jsx("button",{className:"btn",onClick:()=>{l(!1),B()},children:"삭제"})]})]})]}),c&&r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:90},children:[r.jsx("div",{onClick:()=>d(null),style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"20%",left:"50%",transform:"translateX(-50%)",width:360,maxWidth:"92vw",padding:12},children:[r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h3",{style:{margin:0,fontSize:14},children:"알림"})}),r.jsx("div",{style:{padding:"4px 2px",fontSize:13},children:c}),r.jsx("div",{className:"controls",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:r.jsx("button",{className:"btn",onClick:()=>d(null),children:"확인"})})]})]})]})}function MN({defaultQuery:e,onClose:t,onSelect:n}){const[i,a]=h.useState(e||""),[s,o]=h.useState([]),[l,c]=h.useState(!1),[d,u]=h.useState(null);async function f(){c(!0),u(null);try{const m=new URL("/api/v1/customers",window.location.origin);i.trim()&&m.searchParams.set("name",i.trim()),m.searchParams.set("mineOnly","false"),m.searchParams.set("limit","100");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const y=await p.json(),v=Array.isArray(y)?y.map(g=>({customerSeq:(g==null?void 0:g.customerSeq)??(g==null?void 0:g.customer_seq)??null,customerId:(g==null?void 0:g.customerId)??(g==null?void 0:g.customer_id)??null,customerName:(g==null?void 0:g.customerName)??(g==null?void 0:g.customer_name)??null,telNo:(g==null?void 0:g.telNo)??(g==null?void 0:g.tel_no)??null,addrProvinceName:(g==null?void 0:g.addrProvinceName)??(g==null?void 0:g.addr_province_name)??null,addrCityName:(g==null?void 0:g.addrCityName)??(g==null?void 0:g.addr_city_name)??null,companyType:(g==null?void 0:g.companyType)??(g==null?void 0:g.company_type)??null,ownerName:(g==null?void 0:g.ownerName)??(g==null?void 0:g.owner_name)??null})):[];o(v)}catch(m){u((m==null?void 0:m.message)||"조회 실패"),o([])}finally{c(!1)}}return h.useEffect(()=>{f()},[]),h.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[r.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[r.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"거래처명",value:i,onChange:m=>a(m.target.value),onKeyDown:m=>{m.key==="Enter"&&f()},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:f,children:"조회"})]}),r.jsx("div",{className:"table-container",style:{height:360},children:s.length===0?r.jsx("div",{className:"empty-state",children:l?"불러오는 중…":d||"결과가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:220},children:"거래처명"}),r.jsx("th",{style:{width:140},children:"회사구분"}),r.jsx("th",{style:{width:140},children:"대표자명"}),r.jsx("th",{style:{width:180},children:"지역"})]})}),r.jsx("tbody",{children:s.map((m,p)=>r.jsxs("tr",{onDoubleClick:()=>n(m),onClick:()=>n(m),children:[r.jsx("td",{children:m.customerName||""}),r.jsx("td",{children:m.companyType||""}),r.jsx("td",{children:m.ownerName||""}),r.jsx("td",{children:[m.addrProvinceName,m.addrCityName].filter(Boolean).join(" ")})]},p))})]})})]})]})}function LN({defaultQuery:e,onClose:t,onSelect:n}){const[i,a]=h.useState(e||""),[s,o]=h.useState([]),[l,c]=h.useState(!1),[d,u]=h.useState(null);async function f(){c(!0),u(null);try{const m=new URL("/api/v1/leads",window.location.origin);i.trim()&&m.searchParams.set("company_name",i.trim()),m.searchParams.set("limit","100");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const y=await p.json(),v=Array.isArray(y)?y.map(g=>({id:(g==null?void 0:g.id)!=null?Number(g.id):null,companyName:(g==null?void 0:g.company_name)??null,leadStatus:(g==null?void 0:g.lead_status)??null,ownerName:(g==null?void 0:g.owner_name)??null,addrProvinceName:(g==null?void 0:g.addr_province_name)??null})):[];o(v)}catch(m){u((m==null?void 0:m.message)||"조회 실패"),o([])}finally{c(!1)}}return h.useEffect(()=>{f()},[]),h.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[r.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[r.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"잠재고객명",value:i,onChange:m=>a(m.target.value),onKeyDown:m=>{m.key==="Enter"&&f()},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:f,children:"조회"})]}),r.jsx("div",{className:"table-container",style:{height:360},children:s.length===0?r.jsx("div",{className:"empty-state",children:l?"불러오는 중…":d||"결과가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:220},children:"잠재고객명"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:140},children:"소유자"}),r.jsx("th",{style:{width:160},children:"지역"})]})}),r.jsx("tbody",{children:s.map((m,p)=>r.jsxs("tr",{onDoubleClick:()=>n(m),onClick:()=>n(m),children:[r.jsx("td",{children:m.companyName||""}),r.jsx("td",{children:m.leadStatus||""}),r.jsx("td",{children:m.ownerName||""}),r.jsx("td",{children:m.addrProvinceName||""})]},p))})]})})]})]})}function $N({defaultQuery:e,onClose:t,onSelect:n}){const[i,a]=h.useState(e||""),[s,o]=h.useState([]),[l,c]=h.useState(!1),[d,u]=h.useState(null);async function f(){c(!0),u(null);try{const m=new URL("/api/v1/employees",window.location.origin);m.searchParams.set("depts","all");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const y=await p.json(),v=Array.isArray(y)?y.map(x=>({empId:(x==null?void 0:x.emp_id)??null,empName:(x==null?void 0:x.emp_name)??null,deptName:(x==null?void 0:x.dept_name)??null,assigneeId:(x==null?void 0:x.assignee_id)??null})):[],g=i.trim().toLowerCase(),b=(g?v.filter(x=>(x.empName||"").toLowerCase().includes(g)||(x.empId||"").toLowerCase().includes(g)||(x.deptName||"").toLowerCase().includes(g)):v).sort((x,N)=>(x.empName||"").localeCompare(N.empName||"","ko",{sensitivity:"base"}));o(b)}catch(m){u((m==null?void 0:m.message)||"조회 실패"),o([])}finally{c(!1)}}return h.useEffect(()=>{f()},[]),h.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[r.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:700,maxHeight:"80%",overflow:"auto",padding:12},children:[r.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"이름/사번/부서",value:i,onChange:m=>a(m.target.value),onKeyDown:m=>{m.key==="Enter"&&f()},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:f,children:"조회"})]}),r.jsx("div",{className:"table-container",style:{height:320},children:s.length===0?r.jsx("div",{className:"empty-state",children:l?"불러오는 중…":d||"결과가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:160},children:"이름"}),r.jsx("th",{style:{width:160},children:"부서"}),r.jsx("th",{style:{width:140},children:"사번"}),r.jsx("th",{style:{width:140},children:"assignee_id"})]})}),r.jsx("tbody",{children:s.map((m,p)=>r.jsxs("tr",{onDoubleClick:()=>n(m),onClick:()=>n(m),children:[r.jsx("td",{children:m.empName||""}),r.jsx("td",{children:m.deptName||""}),r.jsx("td",{children:m.empId||""}),r.jsx("td",{children:m.assigneeId||""})]},p))})]})})]})]})}function zN({compact:e=!1,maxHeight:t}){const[n,i]=h.useState([]),[a,s]=h.useState(!1),[o,l]=h.useState(null),[c,d]=h.useState(()=>{try{const p=localStorage.getItem("tnt.sales.selectedEstimate");if(p){const y=JSON.parse(p),v=Number(y==null?void 0:y.id);return Number.isFinite(v)?v:null}}catch{}return null});async function u(){l(null),s(!0);try{const p=["/api/v1/estimates","/api/v1/quotes"];let y=null;for(const g of p)try{const b=await fetch(g);if(b.ok){y=await b.json();break}}catch{}let v=[];Array.isArray(y)?v=y.map((g,b)=>({id:Number((g==null?void 0:g.id)??b+1),estimateNumber:String((g==null?void 0:g.estimateNumber)??(g==null?void 0:g.estimate_number)??""),title:String((g==null?void 0:g.title)??""),status:String((g==null?void 0:g.status)??""),owner:String((g==null?void 0:g.owner)??(g==null?void 0:g.ownerId)??(g==null?void 0:g.owner_id)??""),issuedAt:String((g==null?void 0:g.issuedAt)??(g==null?void 0:g.issued_at)??"")})):v=[{id:1,estimateNumber:"E-2025-0001",title:"제품 견적 A",status:"draft",owner:"kim",issuedAt:"2025-02-01T10:00:00Z"},{id:2,estimateNumber:"E-2025-0002",title:"서비스 견적 B",status:"sent",owner:"lee",issuedAt:"2025-02-03T11:00:00Z"}],v.sort((g,b)=>(g.title||"").localeCompare(b.title||"","ko",{sensitivity:"base"})),i(v),v.length>0&&c==null&&f(v[0])}catch(p){l((p==null?void 0:p.message)||"조회 중 오류가 발생했습니다")}finally{s(!1)}}h.useEffect(()=>{u()},[]);function f(p){d(p.id);try{localStorage.setItem("tnt.sales.selectedEstimate",JSON.stringify(p)),window.dispatchEvent(new CustomEvent("tnt.sales.estimate.selected",{detail:{estimate:p}}))}catch{}}return h.useMemo(()=>r.jsx("div",{className:"table-container",style:{maxHeight:t??(e?"32vh":void 0)},children:n.length===0?r.jsx("div",{className:"empty-state",children:a?"불러오는 중…":o||"데이터가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:140},children:"견적번호"}),r.jsx("th",{children:"제목"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:140},children:"소유자"}),r.jsx("th",{style:{width:180},children:"발행시각"})]})}),r.jsx("tbody",{children:n.map((p,y)=>r.jsxs("tr",{className:c===p.id?"selected":void 0,onClick:()=>f(p),children:[r.jsx("td",{children:p.estimateNumber||""}),r.jsx("td",{children:p.title||""}),r.jsx("td",{children:p.status||""}),r.jsx("td",{children:p.owner||""}),r.jsx("td",{children:p.issuedAt?(()=>{const v=new Date(p.issuedAt);if(isNaN(v.getTime()))return p.issuedAt;const g=String(v.getFullYear()%100).padStart(2,"0"),b=String(v.getMonth()+1).padStart(2,"0"),x=String(v.getDate()).padStart(2,"0"),N=String(v.getHours()).padStart(2,"0"),A=String(v.getMinutes()).padStart(2,"0");return`${g}-${b}-${x} ${N}:${A}`})():""})]},y))})]})}),[n,c,a,o,e,t])}function RN(){const[e,t]=h.useState(()=>{try{const s=localStorage.getItem("tnt.sales.selectedEstimate");return s?JSON.parse(s):null}catch{return null}});h.useEffect(()=>{const s=()=>{try{const o=localStorage.getItem("tnt.sales.selectedEstimate");t(o?JSON.parse(o):null)}catch{t(null)}};return window.addEventListener("tnt.sales.estimate.selected",s),()=>window.removeEventListener("tnt.sales.estimate.selected",s)},[]);const n=h.useMemo(()=>r.jsx("div",{className:"card",style:{padding:12},children:e?r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"견적번호"}),r.jsx("div",{className:"subject-input",children:e.estimateNumber||""})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"상태"}),r.jsx("div",{className:"subject-input",children:e.status||""})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"제목"}),r.jsx("div",{className:"subject-input",children:e.title||""})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"소유자"}),r.jsx("div",{className:"subject-input",children:e.owner||""})]})]}):r.jsx("div",{className:"empty-state",children:"선택된 견적이 없습니다."})}),[e]),[i,a]=h.useState("details");return r.jsxs("section",{children:[r.jsx("div",{className:"page-title",children:r.jsx("h2",{children:"견적"})}),r.jsx(zN,{compact:!0,maxHeight:"32vh"}),r.jsxs("section",{className:"card",style:{marginTop:12,minHeight:240},children:[r.jsxs("div",{className:"tabs c360-tabs",children:[r.jsx("button",{className:i==="details"?"tab active":"tab",onClick:()=>a("details"),children:"상세"}),r.jsx("button",{className:i==="items"?"tab active":"tab",onClick:()=>a("items"),children:"품목"}),r.jsx("button",{className:i==="attachments"?"tab active":"tab",onClick:()=>a("attachments"),children:"첨부"})]}),r.jsxs("div",{style:{marginTop:12},children:[i==="details"&&n,i==="items"&&r.jsx("div",{className:"empty-state",children:"견적 품목(추후)"}),i==="attachments"&&r.jsx("div",{className:"empty-state",children:"첨부 파일(추후)"})]})]})]})}function BN(){const[e,t]=h.useState(()=>ym()),[n,i]=h.useState(Bc());h.useEffect(()=>eS(()=>i(Bc())),[]);function a(s){const o=!Wc(s);tS(s,o),i(Bc())}return r.jsxs("section",{children:[r.jsx("h1",{children:"설정"}),r.jsx("p",{className:"muted",children:"좌측 메뉴(1, 2 레벨)를 표시/숨김으로 제어합니다. 모든 사용자에게 동일하게 적용됩니다(임시: 로컬 저장소 기반)."}),r.jsx("div",{style:{display:"flex",gap:24,alignItems:"flex-start",marginTop:12},children:r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsx("h3",{style:{margin:"12px 0"},children:"메뉴 표시 설정"}),r.jsx("button",{className:"btn",onClick:()=>t(ym()),children:"메뉴 다시 읽기"})]}),r.jsx("ul",{style:{listStyle:"none",padding:0,margin:0},children:e.map(s=>{var o;return r.jsxs("li",{style:{marginBottom:10},children:[r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{type:"checkbox",checked:Wc(s.key),onChange:()=>a(s.key)}),r.jsx("strong",{children:s.label}),r.jsxs("span",{className:"muted",style:{fontSize:12},children:["(",s.key,")"]})]}),(o=s.children)!=null&&o.length?r.jsx("ul",{style:{listStyle:"none",padding:"6px 0 0 22px",margin:0},children:s.children.map(l=>r.jsx("li",{style:{marginBottom:6},children:r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{type:"checkbox",checked:Wc(l.key),onChange:()=>a(l.key)}),r.jsx("span",{children:l.label}),r.jsxs("span",{className:"muted",style:{fontSize:12},children:["(",l.key,")"]})]})},l.key))}):null]},s.key)})})]})})]})}function WN(){const[e,t]=h.useState(null),[n,i]=h.useState({}),[a,s]=h.useState(null),[o,l]=h.useState({open:!1,text:""}),[c,d]=h.useState([]),u=h.useMemo(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||""}catch{return""}},[]),f=h.useMemo(()=>{try{return localStorage.getItem("tnt.sales.empId")||""}catch{return""}},[]);h.useEffect(()=>{const P=()=>{try{const D=localStorage.getItem("tnt.sales.selectedLead"),S=D?JSON.parse(D):null;t(S),i({...S||{}}),s(null)}catch{t(null),i({}),s(null)}};return window.addEventListener("tnt.sales.lead.selected",P),()=>window.removeEventListener("tnt.sales.lead.selected",P)},[]);function m(P,D){i(S=>({...S,[P]:D})),a&&s(null)}async function p(){if(!(!n||n.id==null))try{const P={...n};delete P.created_by_name,delete P.updated_by_name,delete P.created_at,delete P.updated_at;try{(!n.assignee_id||String(n.assignee_id).trim()==="")&&(delete P.assignee_id,delete P.owner_name,delete P.owner_id)}catch{}try{const _=localStorage.getItem("tnt.sales.assigneeId")||"";_&&(P.updated_by=_)}catch{}const D=await fetch(`/api/v1/leads/${n.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)});if(!D.ok)throw new Error(`HTTP ${D.status}`);const S=await D.json().catch(()=>({}));if(S!=null&&S.ok){const _=n.company_name||"";l({open:!0,text:`${_} 수정되었습니다.`});try{const H=await fetch(`/api/v1/leads/${n.id}`),q=H.ok?await H.json():n;i(K=>({...K,...q||{}})),t(K=>({...K||{},...q||{}})),localStorage.setItem("tnt.sales.selectedLead",JSON.stringify(q||n)),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:q||n}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:q||n}}))}catch{try{localStorage.setItem("tnt.sales.selectedLead",JSON.stringify(n)),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:n}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:n}}))}catch{}}}else throw new Error("저장 실패")}catch(P){s((P==null?void 0:P.message)||"저장 중 오류가 발생했습니다")}}h.useEffect(()=>{(async()=>{try{const P=await fetch("/api/v1/employees");if(!P.ok)return;const D=await P.json();if(Array.isArray(D)){let S=[...D];if(!S.some(H=>String((H==null?void 0:H.emp_name)||"")==="윤이랑"))try{const H=await fetch("/api/v1/employees?depts=all");if(H.ok){const q=await H.json();if(Array.isArray(q)){const K=q.find(W=>String((W==null?void 0:W.emp_name)||"")==="윤이랑");K&&(S=[...S,K])}}}catch{}d(S)}}catch{}})()},[]);const y=!n||n.id==null,[v,g]=h.useState(!1),[b,x]=h.useState(""),[N,A]=h.useState(""),[C,w]=h.useState(!1),[O,M]=h.useState({}),[B,z]=h.useState(!1),{ref:j,style:k,bindHeader:L,bindContainer:T}=Dn("lead.tm",v,P=>{const D=document.querySelector(".pane.center"),S=D?D.getBoundingClientRect():null,_=P.getBoundingClientRect(),H=_.width,q=_.height,K=S?S.left+(S.width-H)/2:(window.innerWidth-H)/2,W=Math.max(0,window.innerHeight-q-16),R=Math.min(Math.max(0,K),window.innerWidth-H),oe=Math.min(Math.max(0,W),window.innerHeight-q);return{x:R,y:oe}},{persist:!1,resetOnOpen:!0}),{ref:$,style:V,bindHeader:G,bindContainer:ne}=Dn("lead.new",C,P=>{const D=document.querySelector(".pane.center"),S=D?D.getBoundingClientRect():null,_=P.getBoundingClientRect(),H=_.width,q=_.height,K=S?S.left+(S.width-H)/2:(window.innerWidth-H)/2,W=Math.max(0,window.innerHeight*.1),R=Math.min(Math.max(0,K),window.innerWidth-H),oe=Math.min(Math.max(0,W),window.innerHeight-q);return{x:R,y:oe}},{persist:!1,resetOnOpen:!0});h.useEffect(()=>{if(!C)return;const P=D=>{D.key==="Escape"&&w(!1)};return window.addEventListener("keydown",P,!0),()=>window.removeEventListener("keydown",P,!0)},[C]),h.useEffect(()=>{if(!v)return;const P=D=>{D.key==="Escape"&&g(!1)};return window.addEventListener("keydown",P,!0),()=>window.removeEventListener("keydown",P,!0)},[v]);function U(P){if(!P)return"";const D=new Date(P);return isNaN(D.getTime())?String(P):new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).format(D)}const I=h.useMemo(()=>{const P=["신규등록","접촉 중","영업 접촉 중","전환성공"],D=((n==null?void 0:n.lead_status)||"").trim(),S=D==="자격미달"||D==="전환실패";let _=P.indexOf(D);D==="자격미달"&&(_=1),D==="전환실패"&&(_=P.length-1),_<0&&(_=0);const H=Math.max(0,Math.min(100,Math.round(_/Math.max(1,P.length-1)*100)));return r.jsxs("div",{className:"page-title",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,minWidth:0,flex:"1 1 auto"},children:[r.jsx("h2",{style:{margin:0},children:"잠재고객"}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,flex:"0 1 520px"},children:[r.jsx("div",{className:"progress",style:{width:"min(520px, 48vw)"},children:r.jsx("div",{className:"progress-bar",style:{width:`${H}%`,background:S?"#ef4444":"var(--accent)"}})}),r.jsx("div",{style:{display:"flex",justifyContent:"space-between",width:"min(520px, 48vw)",fontSize:11,color:"var(--muted)"},children:P.map(q=>r.jsx("span",{style:{fontWeight:D===q?700:400},children:q},q))})]})]}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsx("button",{className:"btn",onClick:()=>{M({}),w(!0)},children:"신규"}),r.jsx("button",{className:"btn",onClick:()=>z(!0),disabled:y,children:"영업활동 등록"}),r.jsx("button",{className:"btn",onClick:()=>{g(!0),s(null)},disabled:y,children:"TM활동 등록"})]})]})},[y,n.lead_status]);return r.jsxs("section",{children:[I,r.jsx("div",{className:"card",style:{padding:12},children:n&&n.id!=null?r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",columnGap:10,rowGap:6},children:[r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"상태"}),r.jsxs("select",{className:"search-input",value:n.lead_status||"",onChange:P=>m("lead_status",P.target.value),children:[r.jsx("option",{value:"",children:"(선택)"}),r.jsx("option",{value:"신규등록",children:"신규등록"}),r.jsx("option",{value:"자격미달",children:"자격미달"}),r.jsx("option",{value:"접촉 중",children:"접촉 중"}),r.jsx("option",{value:"영업 접촉 중",children:"영업 접촉 중"}),r.jsx("option",{value:"전환성공",children:"전환성공"}),r.jsx("option",{value:"전환실패",children:"전환실패"})]})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"소스"}),r.jsxs("select",{className:"search-input",value:n.lead_source||"",onChange:P=>m("lead_source",P.target.value),children:[r.jsx("option",{value:"",children:"(선택)"}),r.jsx("option",{value:"목록구매",children:"목록구매"}),r.jsx("option",{value:"내부추천",children:"내부추천"}),r.jsx("option",{value:"외부추천",children:"외부추천"}),r.jsx("option",{value:"전시회/행사",children:"전시회/행사"})]})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"회사"}),r.jsx("input",{className:"search-input",type:"text",value:n.company_name||"",onChange:P=>m("company_name",P.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"거래처 담당자"}),r.jsx("input",{className:"search-input",type:"text",value:n.contact_name||"",onChange:P=>m("contact_name",P.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"이메일"}),r.jsx("input",{className:"search-input",type:"text",value:n.email||"",onChange:P=>m("email",P.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"연락처"}),r.jsx("input",{className:"search-input",type:"text",value:n.contact_phone||"",onChange:P=>m("contact_phone",P.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"대표번호"}),r.jsx("input",{className:"search-input",type:"text",value:n.office_phone||"",onChange:P=>m("office_phone",P.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"업종"}),r.jsxs("select",{className:"search-input",value:n.biz_type||"",onChange:P=>m("biz_type",P.target.value),children:[r.jsx("option",{value:"",children:"(선택)"}),r.jsx("option",{value:"가공",children:"가공"}),r.jsx("option",{value:"시공",children:"시공"}),r.jsx("option",{value:"가시공",children:"가시공"}),r.jsx("option",{value:"유통",children:"유통"}),r.jsx("option",{value:"알수없음",children:"알수없음"})]})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"사업자번호"}),r.jsx("input",{className:"search-input",type:"text",value:n.biz_no||"",onChange:P=>m("biz_no",P.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"지역(도/광역)"}),r.jsx("input",{className:"search-input",type:"text",value:n.addr_province_name||"",onChange:P=>m("addr_province_name",P.target.value)})]}),r.jsxs("div",{className:"field inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"주소"}),r.jsx("input",{className:"search-input",type:"text",value:n.address||"",onChange:P=>m("address",P.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"팩스"}),r.jsx("input",{className:"search-input",type:"text",value:n.fax_no||"",onChange:P=>m("fax_no",P.target.value)})]}),r.jsxs("div",{className:"field inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"비고"}),r.jsx("textarea",{className:"search-input",value:n.note||"",onChange:P=>m("note",P.target.value),style:{minHeight:80}})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"소유자"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsxs("select",{className:"search-input",value:n.assignee_id||"",onChange:P=>m("assignee_id",P.target.value||null),style:{flex:1},children:[r.jsx("option",{value:"",children:"(선택)"}),c.map(P=>r.jsxs("option",{value:P.assignee_id,children:[P.dept_name," · ",P.emp_name]},P.assignee_id))]}),r.jsx("div",{style:{whiteSpace:"nowrap",fontSize:11,color:"var(--muted)"},children:(()=>{const P=n.owner_name&&String(n.owner_name).trim()?String(n.owner_name):"",D=n.assignee_id||"",S=c.find(H=>H.assignee_id===D);return`현재: ${P||(S?S.emp_name:"")||"-"}`})()})]})]}),r.jsxs("div",{className:"field inline-four",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"작성자"}),r.jsxs("div",{className:"subject-input",style:{padding:"6px 8px"},children:[n.created_by_name||(n.created_by??"")||u||f,n.created_at?`, ${U(n.created_at)}`:""]}),r.jsx("label",{children:"최종 수정자"}),r.jsxs("div",{className:"subject-input",style:{padding:"6px 8px"},children:[n.updated_by_name||(n.updated_by??"")||u||f,n.updated_at?`, ${U(n.updated_at)}`:""]})]})]}),r.jsxs("div",{className:"controls",style:{justifyContent:"space-between",marginTop:10,gap:8},children:[r.jsx("div",{"aria-live":"polite",style:{fontSize:12,color:"var(--accent)"},children:a||""}),r.jsx("div",{children:r.jsxs("div",{style:{display:"inline-flex",gap:8},children:[r.jsx("button",{className:"btn",onClick:p,disabled:y,children:"저장"}),y?null:r.jsx("button",{className:"btn btn-danger",onClick:async()=>{if(n!=null&&n.id){`${n.id}`;try{const P=await fetch(`/api/v1/leads/${n.id}`,{method:"DELETE"});if(!P.ok){const D=await P.json().catch(()=>null);throw new Error((D==null?void 0:D.message)||`HTTP ${P.status}`)}l({open:!0,text:"삭제되었습니다."}),i({}),t(null),localStorage.removeItem("tnt.sales.selectedLead"),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:null}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:null}}))}catch(P){s((P==null?void 0:P.message)||"삭제 중 오류가 발생했습니다")}}},children:"삭제"})]})})]})]}):r.jsx("div",{className:"empty-state",children:"우측에서 잠재고객을 선택하세요."})}),v&&r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e4,pointerEvents:"none"},children:[r.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)",pointerEvents:"none"}}),r.jsxs("div",{ref:j,className:"card",style:{...k,width:"min(720px, 92vw)",maxHeight:"80vh",overflow:"auto",padding:16,pointerEvents:"auto"},...T,children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10,cursor:"move"},...L,children:[r.jsx("h3",{style:{margin:0},children:"TM 활동 등록"}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:()=>g(!1),onKeyDown:P=>{(P.key==="Enter"||P.key===" ")&&(P.preventDefault(),g(!1))},children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"제목"}),r.jsx("input",{className:"search-input",type:"text",value:b,onChange:P=>x(P.target.value),placeholder:"제목"})]}),r.jsxs("div",{className:"field inline-field row-2",children:[r.jsx("label",{children:"활동 설명"}),r.jsx("textarea",{className:"search-input",value:N,onChange:P=>A(P.target.value),placeholder:"활동 설명",style:{minHeight:100}})]}),r.jsxs("div",{className:"field inline-field row-2",children:[r.jsx("label",{children:"잠재고객"}),r.jsxs("div",{className:"subject-input",style:{padding:"6px 8px"},children:[n.company_name||"",n.contact_name?` / ${n.contact_name}`:"",n.contact_phone?` / ${n.contact_phone}`:""]})]}),r.jsxs("div",{className:"controls",style:{justifyContent:"flex-end",marginTop:10,gap:8},children:[r.jsx("button",{className:"btn",onClick:()=>g(!1),children:"취소"}),r.jsx("button",{className:"btn",onClick:async()=>{try{const P=localStorage.getItem("tnt.sales.assigneeId")||localStorage.getItem("tnt.sales.empId")||"";if(!P){s("로그인이 필요합니다");return}const D={sfOwnerId:P,subject:b||"",description:N||"",activityType:"전화",activityStatus:"계획",channel:"전화",sfLeadId:(n==null?void 0:n.id)!=null?String(n.id):void 0,createdBy:localStorage.getItem("tnt.sales.empId")||void 0,updatedBy:localStorage.getItem("tnt.sales.empId")||void 0},S=await fetch("/api/v1/sales-activities",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)});if(!S.ok){let _=`HTTP ${S.status}`;try{const H=await S.json();H!=null&&H.error&&(_=H.error)}catch{}throw new Error(_)}g(!1),x(""),A("");try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated",{detail:{leadId:n==null?void 0:n.id}}))}catch{}l({open:!0,text:"TM 활동이 등록되었습니다."})}catch(P){s((P==null?void 0:P.message)||"TM 활동 등록 실패")}},children:"저장"})]})]})]}),C&&r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e4,pointerEvents:"none"},children:[r.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)",pointerEvents:"none"}}),r.jsxs("div",{ref:$,className:"card",style:{...V,width:"min(880px, 96vw)",maxHeight:"86vh",overflow:"auto",padding:16,pointerEvents:"auto"},...ne,children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10,cursor:"move"},...G,children:[r.jsx("h3",{style:{margin:0},children:"잠재고객 신규"}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:()=>w(!1),children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",columnGap:10,rowGap:6},children:[r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"상태"}),r.jsxs("select",{className:"search-input",value:O.lead_status||"",onChange:P=>M(D=>({...D,lead_status:P.target.value})),children:[r.jsx("option",{value:"",children:"(선택)"}),r.jsx("option",{value:"신규등록",children:"신규등록"}),r.jsx("option",{value:"자격미달",children:"자격미달"}),r.jsx("option",{value:"접촉 중",children:"접촉 중"}),r.jsx("option",{value:"영업 접촉 중",children:"영업 접촉 중"}),r.jsx("option",{value:"전환성공",children:"전환성공"}),r.jsx("option",{value:"전환실패",children:"전환실패"})]})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"소스"}),r.jsxs("select",{className:"search-input",value:O.lead_source||"",onChange:P=>M(D=>({...D,lead_source:P.target.value})),children:[r.jsx("option",{value:"",children:"(선택)"}),r.jsx("option",{value:"목록구매",children:"목록구매"}),r.jsx("option",{value:"내부추천",children:"내부추천"}),r.jsx("option",{value:"외부추천",children:"외부추천"}),r.jsx("option",{value:"전시회/행사",children:"전시회/행사"})]})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"회사"}),r.jsx("input",{className:"search-input",type:"text",value:O.company_name||"",onChange:P=>M(D=>({...D,company_name:P.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"거래처 담당자"}),r.jsx("input",{className:"search-input",type:"text",value:O.contact_name||"",onChange:P=>M(D=>({...D,contact_name:P.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"이메일"}),r.jsx("input",{className:"search-input",type:"text",value:O.email||"",onChange:P=>M(D=>({...D,email:P.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"연락처"}),r.jsx("input",{className:"search-input",type:"text",value:O.contact_phone||"",onChange:P=>M(D=>({...D,contact_phone:P.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"대표번호"}),r.jsx("input",{className:"search-input",type:"text",value:O.office_phone||"",onChange:P=>M(D=>({...D,office_phone:P.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"업종"}),r.jsxs("select",{className:"search-input",value:O.biz_type||"",onChange:P=>M(D=>({...D,biz_type:P.target.value})),children:[r.jsx("option",{value:"",children:"(선택)"}),r.jsx("option",{value:"가공",children:"가공"}),r.jsx("option",{value:"시공",children:"시공"}),r.jsx("option",{value:"가시공",children:"가시공"}),r.jsx("option",{value:"유통",children:"유통"}),r.jsx("option",{value:"알수없음",children:"알수없음"})]})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"사업자번호"}),r.jsx("input",{className:"search-input",type:"text",value:O.biz_no||"",onChange:P=>M(D=>({...D,biz_no:P.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"지역(도/광역)"}),r.jsx("input",{className:"search-input",type:"text",value:O.addr_province_name||"",onChange:P=>M(D=>({...D,addr_province_name:P.target.value}))})]}),r.jsxs("div",{className:"field inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"주소"}),r.jsx("input",{className:"search-input",type:"text",value:O.address||"",onChange:P=>M(D=>({...D,address:P.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"팩스"}),r.jsx("input",{className:"search-input",type:"text",value:O.fax_no||"",onChange:P=>M(D=>({...D,fax_no:P.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"소유자"}),r.jsxs("select",{className:"search-input",value:O.assignee_id||"",onChange:P=>M(D=>({...D,assignee_id:P.target.value||null})),children:[r.jsx("option",{value:"",children:"(선택)"}),c.map(P=>r.jsxs("option",{value:P.assignee_id,children:[P.dept_name," · ",P.emp_name]},P.assignee_id))]})]}),r.jsxs("div",{className:"field inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"비고"}),r.jsx("textarea",{className:"search-input",value:O.note||"",onChange:P=>M(D=>({...D,note:P.target.value})),style:{minHeight:80}})]})]}),r.jsxs("div",{className:"controls",style:{justifyContent:"space-between",marginTop:10,gap:8},children:[r.jsx("div",{"aria-live":"polite",style:{fontSize:12,color:"#ef4444"},children:a||""}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("button",{className:"btn",onClick:()=>{w(!1),s(null)},children:"취소"}),r.jsx("button",{className:"btn",onClick:async()=>{try{const P={...O},D=localStorage.getItem("tnt.sales.empId")||void 0;D&&(P.created_by=D,P.updated_by=D);const S=await fetch("/api/v1/leads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(P)}),_=await S.json().catch(()=>({}));if(!S.ok||_&&_.error)throw new Error((_==null?void 0:_.error)||`HTTP ${S.status}`);const H=_==null?void 0:_.id;if(!H||H===-1)throw new Error("저장 실패: ID를 받지 못했습니다");const q={...O||{},id:H};try{localStorage.setItem("tnt.sales.selectedLead",JSON.stringify(q)),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:q}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:q}}))}catch{}w(!1),M({});const K=O.company_name||"";l({open:!0,text:`${K} 신규 생성되었습니다.`})}catch(P){s((P==null?void 0:P.message)||"저장 중 오류가 발생했습니다")}},children:"저장"})]})]})]})]}),r.jsx(Ov,{open:B,onClose:()=>z(!1),leadId:(n==null?void 0:n.id)??null,leadName:(n==null?void 0:n.company_name)||""}),o.open?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:o.text}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>l({open:!1,text:""}),children:"확인"})})]})}):null]})}function Hc(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const n=String(t.getFullYear()%100).padStart(2,"0"),i=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${n}-${i}-${a} ${s}:${o}`}function FN({leadId:e}){const[t,n]=h.useState([]),[i,a]=h.useState(!1),[s,o]=h.useState(null),[l,c]=h.useState(()=>({open:!1,x:0,y:0})),[d,u]=h.useState(!1),[f,m]=h.useState(""),[p,y]=h.useState(""),[v,g]=h.useState(null),[b,x]=h.useState({open:!1,text:""});async function N(){if(!e){n([]);return}a(!0),o(null);try{const O=new URL("/api/v1/sales-activities",window.location.origin);O.searchParams.set("mineOnly","false"),O.searchParams.set("sfLeadId",String(e));const M=await fetch(O.toString());if(!M.ok)throw new Error(`HTTP ${M.status}`);const B=await M.json(),z=Array.isArray(B)?B.map(j=>({id:Number(j==null?void 0:j.id),subject:(j==null?void 0:j.subject)??"",description:(j==null?void 0:j.description)??"",activityType:(j==null?void 0:j.activityType)??"",activityStatus:(j==null?void 0:j.activityStatus)??"",channel:(j==null?void 0:j.channel)??"",plannedStartAt:(j==null?void 0:j.plannedStartAt)??null,plannedEndAt:(j==null?void 0:j.plannedEndAt)??null,createdAt:(j==null?void 0:j.createdAt)??null,lastUpdateAt:(j==null?void 0:j.lastUpdateAt)??null,ownerName:(j==null?void 0:j.ownerName)??(j==null?void 0:j.owner_name)??""})):[];n(z)}catch(O){o((O==null?void 0:O.message)||"조회 중 오류가 발생했습니다"),n([])}finally{a(!1)}}h.useEffect(()=>{N()},[e]),h.useEffect(()=>{const O=()=>{N()};return window.addEventListener("tnt.sales.activity.updated",O),()=>window.removeEventListener("tnt.sales.activity.updated",O)},[e]),h.useEffect(()=>{if(!d)return;const O=M=>{M.key==="Escape"&&u(!1)};return window.addEventListener("keydown",O,!0),()=>window.removeEventListener("keydown",O,!0)},[d]),h.useEffect(()=>{d||(A.current=null)},[d]),h.useEffect(()=>{if(!l.open)return;const O=()=>c({open:!1,x:0,y:0}),M=B=>{B.key==="Escape"&&c({open:!1,x:0,y:0})};return window.addEventListener("click",O,!1),window.addEventListener("keydown",M,!0),()=>{window.removeEventListener("click",O,!1),window.removeEventListener("keydown",M,!0)}},[l.open]);const A=h.useRef(null);function C(O){g(O.id),A.current!==O.id&&(m(O.subject||""),y(O.description||""),A.current=O.id),u(!0)}const w=h.useMemo(()=>r.jsxs("div",{className:"table-container",style:{maxHeight:"calc(100vh - 260px)",overflow:"auto"},children:[t.length===0?r.jsx("div",{className:"empty-state",children:i?"불러오는 중…":s||"활동이 없습니다."}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:120},children:"담당자"}),r.jsx("th",{style:{width:260},children:"제목"}),r.jsx("th",{children:"활동내역"}),r.jsx("th",{style:{width:150},children:"계획일시"}),r.jsx("th",{style:{width:150},children:"종료 일시"}),r.jsx("th",{style:{width:120},children:"활동유형"}),r.jsx("th",{style:{width:120},children:"활동상태"}),r.jsx("th",{style:{width:180},children:"최종 수정일"})]})}),r.jsx("tbody",{children:t.map(O=>r.jsxs("tr",{onContextMenu:M=>{M.preventDefault(),M.stopPropagation(),c({open:!0,x:M.clientX,y:M.clientY,row:O})},children:[r.jsx("td",{title:O.ownerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:O.ownerName||""}),r.jsx("td",{title:O.subject||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:O.subject||""}),r.jsx("td",{title:O.description||"",style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:O.description||""}),r.jsx("td",{children:Hc(O.plannedStartAt)}),r.jsx("td",{children:Hc(O.plannedEndAt)}),r.jsx("td",{children:O.activityType||""}),r.jsx("td",{children:O.activityStatus||""}),r.jsx("td",{children:Hc(O.lastUpdateAt)})]},O.id))})]}),l.open&&l.row&&r.jsx("div",{className:"context-menu",style:{left:l.x+4,top:l.y+4},onClick:O=>O.stopPropagation(),children:r.jsx("button",{className:"context-item",style:{width:96,padding:"4px 6px"},onClick:O=>{O.preventDefault(),O.stopPropagation(),C(l.row),c({open:!1,x:0,y:0})},children:"수정"})})]}),[t,i,s,l]);return r.jsxs("section",{children:[w,d&&r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:2e4},children:[r.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",left:"50%",top:"20%",transform:"translateX(-50%)",width:"min(720px, 92vw)",maxHeight:"80vh",overflow:"auto",padding:16},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[r.jsx("h3",{style:{margin:0},children:"TM 활동 수정"}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:()=>u(!1),children:r.jsx("img",{src:Wt,className:"icon",alt:"닫기"})})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"제목"}),r.jsx("input",{className:"search-input",type:"text",value:f,onChange:O=>m(O.target.value),placeholder:"제목"})]}),r.jsxs("div",{className:"field inline-field row-2",children:[r.jsx("label",{children:"활동 설명"}),r.jsx("textarea",{className:"search-input",value:p,onChange:O=>y(O.target.value),placeholder:"활동 설명",style:{minHeight:100}})]}),r.jsxs("div",{className:"controls",style:{justifyContent:"flex-end",marginTop:10,gap:8},children:[r.jsx("button",{className:"btn",onClick:()=>u(!1),children:"취소"}),r.jsx("button",{className:"btn",onClick:async()=>{try{if(!v)return;const O={subject:f||"",description:p||""},M=await fetch(`/api/v1/sales-activities/${v}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(O)});if(!M.ok)throw new Error(`HTTP ${M.status}`);u(!1),x({open:!0,text:`${(f||"").trim()||"(제목없음)"} 변경되었습니다.`});try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated",{detail:{id:v}}))}catch{}}catch{}},children:"저장"})]})]})]}),b.open?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:b.text}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>x({open:!1,text:""}),children:"확인"})})]})}):null]})}function qN(){const[e,t]=h.useState(null);return h.useEffect(()=>{try{localStorage.removeItem("tnt.sales.selectedLead")}catch{}const n=()=>{try{const i=localStorage.getItem("tnt.sales.selectedLead");t(i?JSON.parse(i):null)}catch{t(null)}};return window.addEventListener("tnt.sales.lead.selected",n),()=>window.removeEventListener("tnt.sales.lead.selected",n)},[]),r.jsxs("section",{children:[r.jsx(WN,{}),r.jsxs("section",{className:"card",style:{marginTop:12,minHeight:240},children:[r.jsx("div",{className:"tabs c360-tabs",children:r.jsx("button",{className:"tab active",children:"활동"})}),r.jsx("div",{style:{marginTop:12},children:e!=null&&e.id?r.jsx(FN,{leadId:e.id}):r.jsx("div",{style:{minHeight:160}})})]})]})}function UN(e){if(!e)return"-";const t=new Date(e);if(Number.isNaN(t.getTime()))return"-";const n=c=>String(c).padStart(2,"0"),i=n(t.getFullYear()%100),a=n(t.getMonth()+1),s=n(t.getDate()),o=n(t.getHours()),l=n(t.getMinutes());return`${i}-${a}-${s} ${o}:${l}`}function HN(){const[e,t]=h.useState("weekly"),[n,i]=h.useState("owner"),[a,s]=h.useState(""),[o,l]=h.useState(()=>new Date().toISOString().split("T")[0]),[c,d]=h.useState([]),[u,f]=h.useState([]),[m,p]=h.useState(null),[y,v]=h.useState([]),[g,b]=h.useState(null),[x,N]=h.useState(!1),[A,C]=h.useState([]);h.useEffect(()=>{(async()=>{try{const j=await fetch("/api/v1/employees");if(!j.ok)return;const k=await j.json();if(Array.isArray(k)){let L=[...k];if(!L.some($=>String(($==null?void 0:$.emp_name)||"")==="윤이랑"))try{const $=await fetch("/api/v1/employees?depts=all");if($.ok){const V=await $.json();if(Array.isArray(V)){const G=V.find(ne=>String((ne==null?void 0:ne.emp_name)||"")==="윤이랑");G&&(L=[...L,G])}}}catch{}C(L)}}catch{}})()},[]);function w(){const j=new Date(o);if(e==="daily"){const k=new Date(j);k.setDate(k.getDate()-1);const L=new Date(j);return L.setDate(L.getDate()+1),[{label:"전일",startDate:k.toISOString().split("T")[0],endDate:k.toISOString().split("T")[0],count:0},{label:"금일",startDate:o,endDate:o,count:0},{label:"익일",startDate:L.toISOString().split("T")[0],endDate:L.toISOString().split("T")[0],count:0}]}else if(e==="weekly"){const k=new Date(j),L=k.getDay(),T=k.getDate()-L+(L===0?-6:1),$=new Date(k.setDate(T)),V=$.toISOString().split("T")[0],G=new Date($);G.setDate(G.getDate()+6);const ne=new Date($);ne.setDate(ne.getDate()-7);const U=new Date(ne);U.setDate(U.getDate()+6);const I=new Date($);I.setDate(I.getDate()+7);const P=new Date(I);return P.setDate(P.getDate()+6),[{label:"전주",startDate:ne.toISOString().split("T")[0],endDate:U.toISOString().split("T")[0],count:0},{label:"금주",startDate:V,endDate:G.toISOString().split("T")[0],count:0},{label:"차주",startDate:I.toISOString().split("T")[0],endDate:P.toISOString().split("T")[0],count:0}]}else{const k=new Date(j),L=new Date(k.getFullYear(),k.getMonth(),1),T=new Date(k.getFullYear(),k.getMonth()+1,0),$=new Date(k.getFullYear(),k.getMonth()-1,1),V=new Date(k.getFullYear(),k.getMonth(),0),G=new Date(k.getFullYear(),k.getMonth()+1,1),ne=new Date(k.getFullYear(),k.getMonth()+2,0);return[{label:"전월",startDate:$.toISOString().split("T")[0],endDate:V.toISOString().split("T")[0],count:0},{label:"금월",startDate:L.toISOString().split("T")[0],endDate:T.toISOString().split("T")[0],count:0},{label:"익월",startDate:G.toISOString().split("T")[0],endDate:ne.toISOString().split("T")[0],count:0}]}}async function O(){N(!0),p(null),v([]),b(null);const j=w();try{const k={period:e,filterType:n,baseDate:o};a&&(k.empId=a);const L=new URLSearchParams(k),[T,$]=await Promise.all([fetch(`/api/v1/lead-stats/registration?${L.toString()}`),fetch(`/api/v1/lead-stats/activity?${L.toString()}`)]);if(T.ok&&$.ok){const V=await T.json(),G=await $.json(),ne=(U,I)=>!Array.isArray(U)||U.length===0?I:U.map(P=>({label:P.label,count:Number(P.count)||0,startDate:P.startDate||o,endDate:P.endDate||o}));d(ne(V,j)),f(ne(G,j))}else{if(console.error("Failed to fetch stats. Reg:",T.status,"Act:",$.status),!T.ok){const V=await T.text();console.error("Registration error:",V)}if(!$.ok){const V=await $.text();console.error("Activity error:",V)}d(j),f(j)}}catch(k){console.error("Failed to load stats",k),d(j),f(j)}finally{N(!1)}}async function M(j){try{const k=n==="owner"&&a?`AND CAST(l.assignee_id AS TEXT) = '${a}'`:"",L=n==="creator"&&a?`AND CAST(l.created_by AS TEXT) = '${a}'`:"",T={filterType:n,startDate:j.startDate,endDate:j.endDate};a&&(T.empId=a);const $=new URLSearchParams(T),V=await fetch(`/api/v1/lead-stats/registration/details?${$.toString()}`);if(V.ok){const G=await V.json();v(G),p(j),b(null)}}catch(k){console.error("Failed to load registration details",k)}}function B(j){const k=new Date(o);let L;e==="daily"?L=j==="prev"?new Date(k.setDate(k.getDate()-1)):new Date(k.setDate(k.getDate()+1)):e==="weekly"?L=j==="prev"?new Date(k.setDate(k.getDate()-7)):new Date(k.setDate(k.getDate()+7)):L=j==="prev"?new Date(k.setMonth(k.getMonth()-1)):new Date(k.setMonth(k.getMonth()+1));const T=L.toISOString().split("T")[0];l(T),setTimeout(()=>{z(T)},0)}async function z(j){N(!0),p(null),v([]),b(null);const L=(()=>{const T=new Date(j);if(e==="daily"){const $=new Date(T);$.setDate($.getDate()-1);const V=new Date(T);return V.setDate(V.getDate()+1),[{label:"전일",startDate:$.toISOString().split("T")[0],endDate:$.toISOString().split("T")[0],count:0},{label:"금일",startDate:j,endDate:j,count:0},{label:"익일",startDate:V.toISOString().split("T")[0],endDate:V.toISOString().split("T")[0],count:0}]}else if(e==="weekly"){const $=new Date(T),V=$.getDay(),G=$.getDate()-V+(V===0?-6:1),ne=new Date($.setDate(G)),U=ne.toISOString().split("T")[0],I=new Date(ne);I.setDate(I.getDate()+6);const P=new Date(ne);P.setDate(P.getDate()-7);const D=new Date(P);D.setDate(D.getDate()+6);const S=new Date(ne);S.setDate(S.getDate()+7);const _=new Date(S);return _.setDate(_.getDate()+6),[{label:"전주",startDate:P.toISOString().split("T")[0],endDate:D.toISOString().split("T")[0],count:0},{label:"금주",startDate:U,endDate:I.toISOString().split("T")[0],count:0},{label:"차주",startDate:S.toISOString().split("T")[0],endDate:_.toISOString().split("T")[0],count:0}]}else{const $=new Date(T),V=new Date($.getFullYear(),$.getMonth(),1),G=new Date($.getFullYear(),$.getMonth()+1,0),ne=new Date($.getFullYear(),$.getMonth()-1,1),U=new Date($.getFullYear(),$.getMonth(),0),I=new Date($.getFullYear(),$.getMonth()+1,1),P=new Date($.getFullYear(),$.getMonth()+2,0);return[{label:"전월",startDate:ne.toISOString().split("T")[0],endDate:U.toISOString().split("T")[0],count:0},{label:"금월",startDate:V.toISOString().split("T")[0],endDate:G.toISOString().split("T")[0],count:0},{label:"익월",startDate:I.toISOString().split("T")[0],endDate:P.toISOString().split("T")[0],count:0}]}})();try{const T={period:e,filterType:n,baseDate:j};a&&(T.empId=a);const $=new URLSearchParams(T),[V,G]=await Promise.all([fetch(`/api/v1/lead-stats/registration?${$.toString()}`),fetch(`/api/v1/lead-stats/activity?${$.toString()}`)]);if(V.ok&&G.ok){const ne=await V.json(),U=await G.json(),I=(P,D)=>!Array.isArray(P)||P.length===0?D:P.map(S=>({label:S.label,count:Number(S.count)||0,startDate:S.startDate||j,endDate:S.endDate||j}));d(I(ne,L)),f(I(U,L))}else d(L),f(L)}catch(T){console.error("Failed to load stats",T),d(L),f(L)}finally{N(!1)}}return r.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[r.jsx("div",{style:{padding:"16px 20px",borderBottom:"1px solid var(--border)",background:"var(--panel)"},children:r.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700,color:"var(--text)"},children:"TM현황"})}),r.jsxs("div",{style:{padding:"12px 20px",borderBottom:"1px solid var(--border)",background:"var(--panel)",display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:"조회기간:"}),r.jsxs("select",{value:e,onChange:j=>t(j.target.value),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13},children:[r.jsx("option",{value:"daily",children:"일별"}),r.jsx("option",{value:"weekly",children:"주간"}),r.jsx("option",{value:"monthly",children:"월간"})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:"구분:"}),r.jsxs("select",{value:n,onChange:j=>i(j.target.value),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13},children:[r.jsx("option",{value:"owner",children:"소유자"}),r.jsx("option",{value:"creator",children:"등록자"})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsxs("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:[n==="owner"?"소유자":"등록자",":"]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"search-input",value:a||"",onChange:j=>s(j.target.value||""),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13,minWidth:160},children:[r.jsx("option",{value:"",children:"전체"}),A.map(j=>r.jsxs("option",{value:j.assignee_id,children:[j.dept_name," · ",j.emp_name]},j.assignee_id))]}),r.jsx("div",{style:{whiteSpace:"nowrap",alignSelf:"center",fontSize:12,color:"var(--muted)"},children:(()=>{const j=A.find(L=>L.assignee_id===a);return`현재선택 : ${j?j.emp_name:"전체"}`})()})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:"기준일자:"}),r.jsx("input",{type:"date",value:o,onChange:j=>l(j.target.value),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13}})]}),r.jsx("button",{onClick:O,disabled:x,className:"btn btn-card btn-3d",style:{height:32,fontSize:13,padding:"0 20px",fontWeight:600},children:x?"조회 중...":"조회"}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[r.jsx("button",{onClick:()=>B("prev"),className:"btn btn-card",style:{height:32,width:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center"},title:"이전",disabled:c.length===0&&u.length===0,children:r.jsx("img",{src:Sv,alt:"이전",style:{width:16,height:16}})}),r.jsx("button",{onClick:()=>B("next"),className:"btn btn-card",style:{height:32,width:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center"},title:"다음",disabled:c.length===0&&u.length===0,children:r.jsx("img",{src:Nv,alt:"다음",style:{width:16,height:16}})})]})]}),r.jsx("div",{style:{flex:1,minHeight:0,overflow:"auto",padding:20},children:x?r.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--muted)"},children:"데이터를 불러오는 중..."}):r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20,height:"100%"},children:[r.jsxs("div",{style:{flex:"0 0 auto",display:"flex",gap:20,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:12},children:[r.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"var(--text)"},children:"잠재고객 등록현황"}),c.length===0?r.jsxs("div",{style:{textAlign:"center",padding:40,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8},children:[r.jsx("div",{style:{fontSize:48,marginBottom:16,opacity:.3},children:"📊"}),r.jsx("div",{style:{fontSize:15,color:"var(--muted)",marginBottom:8},children:"조회 조건을 설정하고 조회 버튼을 클릭하세요"})]}):r.jsx(r.Fragment,{children:r.jsx("div",{style:{display:"flex",gap:12},children:c.map((j,k)=>r.jsxs("button",{onClick:()=>M(j),className:"btn btn-card btn-3d",style:{flex:1,minHeight:120,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:8,background:(m==null?void 0:m.label)===j.label?"var(--primary)":"var(--panel)",color:(m==null?void 0:m.label)===j.label?"#fff":"var(--text)",border:(m==null?void 0:m.label)===j.label?"2px solid var(--primary)":"1px solid var(--border)"},children:[r.jsx("div",{style:{fontSize:14,fontWeight:600},children:j.label}),r.jsx("div",{style:{fontSize:28,fontWeight:700},children:j.count}),r.jsx("div",{style:{fontSize:11,opacity:.7},children:j.startDate===j.endDate?j.startDate:`${j.startDate} ~ ${j.endDate}`})]},k))})})]}),r.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:12},children:[r.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"var(--text)"},children:"잠재고객 활동현황"}),u.length===0?r.jsxs("div",{style:{textAlign:"center",padding:40,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8},children:[r.jsx("div",{style:{fontSize:48,marginBottom:16,opacity:.3},children:"📊"}),r.jsx("div",{style:{fontSize:15,color:"var(--muted)",marginBottom:8},children:"조회 조건을 설정하고 조회 버튼을 클릭하세요"})]}):r.jsx("div",{style:{display:"flex",gap:12},children:u.map((j,k)=>r.jsxs("div",{className:"btn-card btn-3d",style:{flex:1,minHeight:120,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:8,background:"var(--panel)",color:"var(--text)",border:"1px solid var(--border)",cursor:"default",opacity:.8},children:[r.jsx("div",{style:{fontSize:14,fontWeight:600},children:j.label}),r.jsx("div",{style:{fontSize:28,fontWeight:700},children:j.count}),r.jsx("div",{style:{fontSize:11,opacity:.7},children:j.startDate===j.endDate?j.startDate:`${j.startDate} ~ ${j.endDate}`})]},k))})]})]}),m&&y.length>0&&r.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",gap:12},children:[r.jsxs("div",{style:{flex:1,minWidth:0,overflow:"auto",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,padding:12},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsxs("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"var(--text)"},children:[m.label," 등록 목록 (",y.length,"건)"]}),r.jsx("span",{style:{fontSize:12,color:"#e11d48",fontWeight:600},children:"잠재고객 클릭시 활동 조회"})]}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:y.map(j=>r.jsxs("button",{onClick:()=>b(j.id),style:{padding:10,background:g===j.id?"var(--primary-light)":"var(--background)",border:g===j.id?"2px solid var(--primary)":"1px solid var(--border)",borderRadius:6,fontSize:13,textAlign:"left",cursor:"pointer",transition:"all 0.2s"},children:[r.jsxs("div",{style:{fontWeight:600,color:g===j.id?"var(--primary)":"var(--text)",marginBottom:4},children:[j.company_name||"-",j.activities&&j.activities.length>0&&r.jsxs("span",{style:{marginLeft:8,fontSize:11,color:"var(--muted)"},children:["(활동 ",j.activities.length,"건)"]})]}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12},children:["담당자: ",j.contact_name||"-"]}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["상태: ",j.lead_status||"-"," | 업종: ",j.biz_type||"-"]}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["지역: ",j.addr_province_name||"-"]}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["최종수정: ",UN(j.updated_at)]})]},j.id))})]}),g&&(()=>{var k;const j=y.find(L=>L.id===g);return j?r.jsxs("div",{style:{flex:1,minWidth:0,overflow:"auto",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,padding:12},children:[r.jsxs("h4",{style:{margin:"0 0 12px",fontSize:14,fontWeight:600,color:"var(--text)"},children:[j.company_name||"-"," 활동 목록 (",((k=j.activities)==null?void 0:k.length)||0,"건)"]}),!j.activities||j.activities.length===0?r.jsx("div",{style:{textAlign:"center",padding:20,color:"var(--muted)",fontSize:13},children:"활동 데이터가 없습니다"}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:j.activities.map(L=>r.jsxs("div",{style:{padding:10,background:"var(--background)",border:"1px solid var(--border)",borderRadius:6,fontSize:13},children:[r.jsx("div",{style:{fontWeight:600,color:"var(--text)",marginBottom:4},children:L.subject||"-"}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12},children:["유형: ",L.activity_type||"-"," | 상태: ",L.activity_status||"-"]}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["계획: ",L.planned_start_at?new Date(L.planned_start_at).toLocaleString("ko-KR"):"-"]}),L.actual_start_at&&r.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["실제: ",new Date(L.actual_start_at).toLocaleString("ko-KR")]}),L.description&&r.jsx("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:L.description}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["수정: ",L.updated_at?new Date(L.updated_at).toLocaleString("ko-KR"):"-"]})]},L.id))})]}):null})()]})]})})]})}const Pm="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cline%20x1='12'%20y1='5'%20x2='12'%20y2='19'/%3e%3cline%20x1='5'%20y1='12'%20x2='19'%20y2='12'/%3e%3c/svg%3e";function YN(){const[e,t]=h.useState(""),[n,i]=h.useState(""),[a,s]=h.useState([]),[o,l]=h.useState(!1),[c,d]=h.useState(null),[u,f]=h.useState(null),[m,p]=h.useState([]),[y,v]=h.useState(!1),[g,b]=h.useState(!1),[x,N]=h.useState({open:!1,x:0,y:0}),A=h.useRef(null);async function C(_){try{v(!0);const H=u!=null?a[u]:null,q=new URLSearchParams;q.set("q",n.trim()||e.trim());const K=_??(H==null?void 0:H.customerSeq);K!=null&&q.set("customerSeq",String(K));const W=await fetch(`/api/v1/items/search?${q.toString()}`),R=W.ok?await W.json():[],oe=Array.isArray(R)?R.map(Y=>({itemSeq:Y==null?void 0:Y.itemSeq,itemName:String((Y==null?void 0:Y.itemName)??""),recentInvoiceDate:(Y==null?void 0:Y.recentInvoiceDate)??(Y==null?void 0:Y.recent_invoice_date)??null,curAmt:(Y==null?void 0:Y.curAmt)??null,qty:(Y==null?void 0:Y.qty)??null,srcPri:(Y==null?void 0:Y.srcPri)!=null?Number(Y.srcPri):void 0,itemStdUnit:(Y==null?void 0:Y.itemStdUnit)??(Y==null?void 0:Y.item_std_unit)??null,companyType:(Y==null?void 0:Y.companyType)||(Y==null?void 0:Y.company_type)||null})):[];p(oe)}catch{p([])}finally{v(!1)}}const[w,O]=h.useState(()=>({open:!1,text:""})),[M,B]=h.useState([]);async function z(_){if(!(_==null||_.itemName==null)){b(!0);try{let H,q=typeof _.itemStdUnit=="string"?_.itemStdUnit:void 0,K,W;const R=await fetch(`/api/v1/items/spec?itemName=${encodeURIComponent(String(_.itemName))}`);if(R.ok){const de=await R.json().catch(()=>({}));de&&de.itemSpec&&(H=String(de.itemSpec)),!q&&de&&de.itemStdUnit&&(K=String(de.itemStdUnit),q=K),de&&de.companyType&&(W=String(de.companyType))}const oe=localStorage.getItem("tnt.sales.ordersheet.cart"),Y=oe?JSON.parse(oe):[];if((Array.isArray(Y)?Y.findIndex(de=>String(de.itemName)===String(_.itemName)):-1)>=0){alert("이미 주문에 포함되어 있습니다."),b(!1);return}else{const de=W||_.companyType||null,be={itemSeq:_.itemSeq,itemName:_.itemName,itemSpec:H||"",qty:"",itemStdUnit:q||_.itemStdUnit||void 0,companyType:de};Y.push(be)}localStorage.setItem("tnt.sales.ordersheet.cart",JSON.stringify(Y)),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.cart.changed",{detail:{cart:Y}}))}catch{}finally{b(!1)}}}function j(_){try{const q=[JSON.parse(_)];let K=null;for(;q.length;){const W=q.shift();if(Array.isArray(W)){if(W.length&&typeof W[0]=="object"){K=W;break}}else if(W&&typeof W=="object")for(const R of Object.keys(W))q.push(W[R])}return K?K.map(W=>{const R=(W==null?void 0:W.WHName)??(W==null?void 0:W.whName)??(W==null?void 0:W.warehouseName)??(W==null?void 0:W.WH_NM)??(W==null?void 0:W.wh_nm)??"",oe=Number((W==null?void 0:W.AvailStock)??(W==null?void 0:W.availStock)??(W==null?void 0:W.AVAIL_STOCK)??(W==null?void 0:W.qty)??0)||0,Y=(W==null?void 0:W.UnitName)??(W==null?void 0:W.unitName)??(W==null?void 0:W.UNIT_NAME)??(W==null?void 0:W.salesMgmtUnit)??"";return{whName:String(R||""),avail:oe,unitName:String(Y||"")}}):[]}catch{return[]}}async function k(_,H){const K=_.currentTarget.getBoundingClientRect(),W=K.right,R=K.bottom;N({open:!0,x:W,y:R,loading:!0});try{const oe={bizUnit:"",stdDate:"",whSeq:"",itemName:String(H.itemName||""),itemNo:"",itemSeq:String(H.itemSeq||""),pageNo:"",pageSize:""},Y=await fetch("/api/v1/items/avail-stock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(oe)});if(Y.ok){const X=await Y.json().catch(()=>({})),de=X&&(X.receivedPayload||X),be=JSON.stringify(de,null,2),ke=j(be);N({open:!0,x:W,y:R,loading:!1,error:null,rows:ke})}else N({open:!0,x:W,y:R,loading:!1,error:`HTTP ${Y.status}`})}catch(oe){N({open:!0,x:W,y:R,loading:!1,error:(oe==null?void 0:oe.message)||"재고 조회 실패"})}}h.useEffect(()=>{if(!x.open)return;const _=q=>{const K=A.current;K&&q.target instanceof Node&&!K.contains(q.target)&&N({open:!1,x:0,y:0})},H=q=>{q.key==="Escape"&&N({open:!1,x:0,y:0})};return document.addEventListener("mousedown",_,!0),window.addEventListener("keydown",H,!0),()=>{document.removeEventListener("mousedown",_,!0),window.removeEventListener("keydown",H,!0)}},[x.open]);async function L(){var _;l(!0),d(null);try{const H=new URLSearchParams;e.trim()&&H.set("name",e.trim()),H.set("mineOnly","false");const q=await fetch(`/api/v1/customers?${H.toString()}`);if(!q.ok)throw new Error(`HTTP ${q.status}`);const K=await q.json(),W=Array.isArray(K)?K.map(R=>({customerId:(R==null?void 0:R.customerId)??"",customerName:(R==null?void 0:R.customerName)??"",bizNo:(R==null?void 0:R.bizNo)??"",ownerName:(R==null?void 0:R.ownerName)??(R==null?void 0:R.empName)??"",telNo:(R==null?void 0:R.telNo)??"",customerSeq:(R==null?void 0:R.customerSeq)!=null?Number(R.customerSeq):void 0,addrProvinceName:(R==null?void 0:R.addrProvinceName)??(R==null?void 0:R.addr_province_name)??"",addrCityName:(R==null?void 0:R.addrCityName)??(R==null?void 0:R.addr_city_name)??"",companyType:String((R==null?void 0:R.company_type)??(R==null?void 0:R.companyType)??(R==null?void 0:R.company)??"").toUpperCase(),companyCode:String((R==null?void 0:R.companyCode)??(R==null?void 0:R.company_code)??(R==null?void 0:R.company_type)??(R==null?void 0:R.companyType)??(R==null?void 0:R.company)??"").toUpperCase()})):[];if(W.sort((R,oe)=>String(R.customerName||"").localeCompare(String(oe.customerName||""),"ko-KR")),s(W),W.length>0){f(0);try{localStorage.setItem("tnt.sales.ordersheet.selectedCustomer",JSON.stringify(W[0])),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.customer.selected",{detail:{customer:W[0]}}))}catch{}await C((_=W[0])==null?void 0:_.customerSeq)}else f(null),p([])}catch(H){d((H==null?void 0:H.message)||"조회 중 오류가 발생했습니다"),s([])}finally{l(!1)}}h.useEffect(()=>{try{localStorage.removeItem("tnt.sales.ordersheet.selectedCustomer"),localStorage.removeItem("tnt.sales.ordersheet.cart"),localStorage.removeItem("tnt.sales.ordersheet.regionGroup"),localStorage.removeItem("tnt.sales.ordersheet.requests"),localStorage.removeItem("tnt.sales.ordersheet.deliveryDueDate")}catch{}},[]);function T(_,H){f(H);try{localStorage.setItem("tnt.sales.ordersheet.selectedCustomer",JSON.stringify(_)),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.customer.selected",{detail:{customer:_}}))}catch{}C(_.customerSeq),$(_.customerSeq)}async function $(_){try{B([]);const H=_!=null?Number(_):NaN;if(!Number.isFinite(H))return;const q=await fetch(`/api/v1/customers/${H}/transactions`,{cache:"no-store"});if(!q.ok)return;const K=await q.json().catch(()=>[]);if(!Array.isArray(K)){B([]);return}const W=Date.now()-365*24*60*60*1e3,R={};for(const Y of K){const X=String((Y==null?void 0:Y.itemName)??(Y==null?void 0:Y.item_name)??"").trim();if(!X)continue;const de=(Y==null?void 0:Y.itemSeq)??(Y==null?void 0:Y.item_seq)??null,be=(Y==null?void 0:Y.companyType)??(Y==null?void 0:Y.company_type)??null,ke=Number((Y==null?void 0:Y.curAmt)??(Y==null?void 0:Y.cur_amt)??0)||0,ve=Number((Y==null?void 0:Y.qty)??0)||0,Ie=String((Y==null?void 0:Y.invoiceDate)??(Y==null?void 0:Y.invoice_date)??""),J=Date.parse(Ie)||Date.parse(Ie.replace(" ","T"))||NaN;if(!Number.isFinite(J)||J<W)continue;const ge=de!=null?String(de):X,Pe=R[ge]||{itemSeq:de,itemName:X,companyType:be||null,recent:0,totalAmt:0,totalQty:0};Pe.totalAmt+=ke,Pe.totalQty+=ve,J>Pe.recent&&(Pe.recent=J),Pe.itemSeq==null&&de!=null&&(Pe.itemSeq=de),!Pe.companyType&&be&&(Pe.companyType=be),R[ge]=Pe}const oe=Object.values(R).sort((Y,X)=>X.recent-Y.recent||Y.itemName.localeCompare(X.itemName,"ko",{sensitivity:"base"})).map(Y=>({itemSeq:Y.itemSeq,itemName:Y.itemName,companyType:Y.companyType,recentDate:new Date(Y.recent).toISOString().slice(0,10),totalAmt:Y.totalAmt,totalQty:Y.totalQty}));B(oe)}catch{B([])}}const V=h.useMemo(()=>r.jsx("div",{className:"table-container",style:{maxHeight:"40vh"},children:a.length===0?r.jsx("div",{className:"empty-state",children:o?"불러오는 중…":c||"데이터가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"거래처명"}),r.jsx("th",{style:{width:160},children:"대표자"}),r.jsx("th",{style:{width:180},children:"사업자번호"}),r.jsx("th",{style:{width:160},children:"대표번호"})]})}),r.jsx("tbody",{children:a.map((_,H)=>r.jsxs("tr",{className:u===H?"selected":void 0,onClick:()=>T(_,H),children:[r.jsxs("td",{style:{display:"flex",alignItems:"center",gap:6},children:[(()=>{const K=(_.companyType||_.companyCode||"").toUpperCase(),W=K==="TNT"?"T":K==="DYS"?"D":K==="ALL"?"A":"",R=K==="TNT"?"#2563eb":K==="DYS"?"#10b981":K==="ALL"?"#f59e0b":"#9ca3af";return W?r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:"50%",background:R,color:"#fff",fontSize:11,fontWeight:800,boxShadow:"0 0 0 1px rgba(0,0,0,.08)"},children:W}):null})(),r.jsx("span",{children:_.customerName})]}),r.jsx("td",{children:_.ownerName}),r.jsx("td",{children:_.bizNo}),r.jsx("td",{children:_.telNo})]},H))})]})}),[a,o,c,u]),G=h.useMemo(()=>M.length===0?null:r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",style:{fontSize:12,marginTop:8,marginBottom:4},children:"최근거래내역"}),r.jsx("div",{className:"table-container",style:{maxHeight:"24vh"},children:r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"품목"}),r.jsx("th",{style:{width:120},children:"최근거래일"}),r.jsx("th",{style:{width:140,textAlign:"right"},children:"총금액"}),r.jsx("th",{style:{width:100,textAlign:"right"},children:"총수량"}),r.jsx("th",{style:{width:80}})]})}),r.jsx("tbody",{children:M.map((_,H)=>r.jsxs("tr",{children:[r.jsx("td",{children:_.itemName}),r.jsx("td",{children:_.recentDate}),r.jsx("td",{style:{textAlign:"right"},children:Number(_.totalAmt||0).toLocaleString()}),r.jsx("td",{style:{textAlign:"right"},children:Number(_.totalQty||0).toLocaleString()}),r.jsxs("td",{children:[r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"재고 조회",title:"재고 조회",onClick:q=>I(q,_.itemName),onKeyDown:q=>{(q.key==="Enter"||q.key===" ")&&(q.preventDefault(),I(q,_.itemName))},children:r.jsx("img",{src:xm,className:"icon",alt:"재고"})}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"담기",title:"담기",onClick:()=>P(_),onKeyDown:q=>{(q.key==="Enter"||q.key===" ")&&(q.preventDefault(),P(_))},children:r.jsx("img",{src:Pm,className:"icon",alt:"담기"})})]})]},H))})]})})]}),[M]);function ne(){try{const _=localStorage.getItem("tnt.sales.ordersheet.selectedCustomer");if(!_)return null;const H=JSON.parse(_),q=Number(H==null?void 0:H.customerSeq);return Number.isFinite(q)?q:null}catch{return null}}async function U(_){const H=m.find(q=>String(q.itemName).trim()===String(_).trim());if(H&&H.itemSeq!=null)return{itemSeq:H.itemSeq,itemName:H.itemName};try{const q=new URLSearchParams;q.set("q",_);const K=ne();K!=null&&q.set("customerSeq",String(K));const W=await fetch(`/api/v1/items/search?${q.toString()}`),R=W.ok?await W.json():[],oe=Array.isArray(R)?R:[],Y=oe.find(X=>String((X==null?void 0:X.itemName)||"").trim()===String(_).trim())||oe[0];if(Y&&Y.itemSeq!=null)return{itemSeq:Y.itemSeq,itemName:String(Y.itemName||_)}}catch{}return null}async function I(_,H){const q=await U(H);q&&await k(_,q)}async function P(_){let H=_;if(!H.itemSeq){const q=await U(_.itemName);if(!q)return;H={...H,...q}}await z({itemSeq:H.itemSeq,itemName:H.itemName,companyType:H.companyType||void 0})}const D=new Intl.NumberFormat("ko-KR"),S=h.useMemo(()=>r.jsx("div",{className:"table-container",style:{maxHeight:"32vh",marginTop:12},children:m.length===0?r.jsx("div",{className:"empty-state",children:y?"품목 불러오는 중…":"품목 데이터가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"품목명"}),r.jsx("th",{style:{width:140},children:"최근거래일시"}),r.jsx("th",{style:{width:120,textAlign:"right"},children:"총금액"}),r.jsx("th",{style:{width:100,textAlign:"right"},children:"총수량"}),r.jsx("th",{style:{width:90}})]})}),r.jsx("tbody",{children:m.map((_,H)=>r.jsxs("tr",{className:_.srcPri===0?"inv-row":void 0,onDoubleClick:()=>z(_),title:"더블클릭하면 우측 수주장에 담습니다",children:[r.jsxs("td",{style:{display:"flex",alignItems:"center",gap:6},children:[(()=>{const K=(_.companyType||_.company_type||_.companyCode||_.company_code||"").toString().toUpperCase(),W=K==="TNT"?"T":K==="DYS"?"D":K==="ALL"?"A":"",R=K==="TNT"?"#2563eb":K==="DYS"?"#10b981":K==="ALL"?"#f59e0b":"#9ca3af";return W?r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:"50%",background:R,color:"#fff",fontSize:11,fontWeight:800,boxShadow:"0 0 0 1px rgba(0,0,0,.08)"},children:W}):null})(),r.jsx("span",{children:_.itemName}),_.itemStdUnit?r.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)"},children:["(",_.itemStdUnit,")"]}):null]}),r.jsx("td",{children:_.recentInvoiceDate||""}),r.jsx("td",{style:{textAlign:"right"},children:_.curAmt!=null&&_.curAmt!==""?D.format(Number(_.curAmt)):""}),r.jsx("td",{style:{textAlign:"right"},children:_.qty!=null&&_.qty!==""?D.format(Number(_.qty)):""}),r.jsxs("td",{children:[r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"재고 조회",title:"재고 조회",onClick:q=>k(q,_),onKeyDown:q=>{(q.key==="Enter"||q.key===" ")&&(q.preventDefault(),k({currentTarget:q.currentTarget},_))},children:r.jsx("img",{src:xm,className:"icon",alt:"재고"})}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"담기",title:"담기",onClick:()=>z(_),onKeyDown:q=>{(q.key==="Enter"||q.key===" ")&&(q.preventDefault(),z(_))},children:r.jsx("img",{src:Pm,className:"icon",alt:"담기"})})]})]},H))})]})}),[m,y]);return r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",children:[r.jsx("h2",{children:"수주장"}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsx("input",{className:"search-input",type:"text",placeholder:"거래처명",value:e,onChange:_=>t(_.target.value),onKeyDown:_=>{_.key==="Enter"&&L()},style:{width:240}}),r.jsx("button",{className:"btn",onClick:L,disabled:o,children:"조회"})]})]}),V,G,r.jsxs("div",{className:"controls",style:{gap:8,marginTop:10},children:[r.jsx("input",{className:"search-input",type:"text",placeholder:"품목명",value:n,onChange:_=>i(_.target.value),onKeyDown:_=>{_.key==="Enter"&&C()},style:{width:240}}),r.jsx("button",{className:"btn",onClick:()=>C(),disabled:y,children:"품목 조회"})]}),S,x.open&&r.jsx("div",{ref:A,className:"context-menu",style:{left:x.x+6,top:x.y+6,position:"fixed",maxWidth:420,padding:8},onClick:_=>_.stopPropagation(),children:x.loading?r.jsx("div",{className:"muted",children:"재고 불러오는 중…"}):x.error?r.jsx("div",{className:"error",children:x.error}):!x.rows||x.rows.length===0?r.jsx("div",{className:"empty-state",children:"재고 데이터가 없습니다"}):r.jsx("div",{className:"table-container",style:{maxHeight:200,overflow:"auto",border:0},children:r.jsxs("table",{className:"table",style:{width:"100%",fontSize:12},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"창고명"}),r.jsx("th",{style:{width:100,textAlign:"right"},children:"가용재고"}),r.jsx("th",{style:{width:120},children:"단위"})]})}),r.jsx("tbody",{children:(x.rows||[]).map((_,H)=>r.jsxs("tr",{children:[r.jsx("td",{children:_.whName||"-"}),r.jsx("td",{style:{textAlign:"right"},children:Number(_.avail||0).toLocaleString()}),r.jsx("td",{children:_.unitName||""})]},H))})]})})})]})}function KN(){const e=[];for(let t=2030;t>=2026;t--)e.push(t);return e}function VN(){const[e,t]=h.useState(2026),[n,i]=h.useState(()=>{try{return localStorage.getItem("tnt.sales.assign.mode")==="Moderate"?"Moderate":"Best"}catch{return"Best"}}),[a,s]=h.useState([{company:"TNT",group:"TNT",name:"복층유리",amount:0,stage:""},{company:"TNT",group:"TNT",name:"건자재",amount:0,stage:""},{company:"DYS",group:"DYS",name:"실란트",amount:0,stage:""}]),[o,l]=h.useState(!1),[c,d]=h.useState(null),[u,f]=h.useState(null),m=new Intl.NumberFormat("ko-KR");async function p(){l(!0),d(null);try{const A=new URL("/api/v1/targets/year",window.location.origin);A.searchParams.set("year",String(e)),A.searchParams.set("versionNo",n==="Moderate"?"2":"1");const C=await fetch(A.toString()),w=C.ok?await C.json():[],O=new Map;if(Array.isArray(w))for(const M of w){const B=String((M==null?void 0:M.company_name)||"").toUpperCase()==="DYS"?"DYS":"TNT",z=String((M==null?void 0:M.biz_area_name)||""),j=Number((M==null?void 0:M.version_no)??0),k=Number((M==null?void 0:M.target_amount_max)??(M==null?void 0:M.target_amount_min)??0),L=String((M==null?void 0:M.target_stage)??""),T=`${B}||${z}`,$=O.get(T);(!$||j>$.ver)&&O.set(T,{ver:j,amt:Number.isFinite(k)?k:0,stage:L,company:B,name:z})}O.size===0?(s(M=>M.map(B=>({...B,amount:0,stage:""}))),f("영업목표가 수립되지 않았습니다.")):(s(M=>M.map(B=>{const z=`${B.company}||${B.name}`,j=O.get(z);return j?{...B,amount:j.amt,stage:j.stage}:B})),f(null))}catch(A){d((A==null?void 0:A.message)||"조회 오류")}finally{l(!1)}}h.useEffect(()=>{p()},[e,n]),h.useEffect(()=>{try{localStorage.setItem("tnt.sales.assign.mode",n)}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.assign.mode.changed",{detail:{mode:n}}))}catch{}},[n]),h.useEffect(()=>{try{localStorage.setItem("tnt.sales.assign.year",String(e)),window.dispatchEvent(new CustomEvent("tnt.sales.assign.year.changed"))}catch{}},[e]);const y=h.useMemo(()=>a.filter(A=>A.company==="TNT").reduce((A,C)=>A+(Number(C.amount)||0),0),[a]),v=h.useMemo(()=>a.filter(A=>A.company==="DYS").reduce((A,C)=>A+(Number(C.amount)||0),0),[a]);h.useEffect(()=>{try{const A={tnt:Number(y)||0,dys:Number(v)||0,year:e};localStorage.setItem("tnt.sales.assign.companyTotals",JSON.stringify(A)),window.dispatchEvent(new CustomEvent("tnt.sales.assign.companyTotals.changed"))}catch{}},[y,v,e]);function g(A,C){const w=Number((C||"").replace(/[\s,]/g,""));s(O=>O.map((M,B)=>B===A?{...M,amount:Number.isFinite(w)?w:0}:M))}async function b(A=!1){try{const C=a.map(B=>({targetYear:`${e}-01-01`,versionNo:1,companyName:B.company,bizAreaGroup:B.group,bizAreaName:B.name,targetAmountMin:B.amount,targetAmountMax:B.amount,targetStage:A?"확정":"기안중"})),w=localStorage.getItem("tnt.sales.empSeq")||"",O={"Content-Type":"application/json"};w&&(O["X-EMP-SEQ"]=String(w));const M=await fetch("/api/v1/targets/year/upsert",{method:"POST",headers:O,body:JSON.stringify(C)});if(!M.ok)throw new Error(`HTTP ${M.status}`);A&&await fetch(`/api/v1/targets/year/confirm?year=${e}`,{method:"POST",headers:O}),await p(),alert(A?"확정되었습니다.":"저장되었습니다.")}catch(C){alert((C==null?void 0:C.message)||"저장 중 오류")}}const x=h.useMemo(()=>{const A=a.filter(C=>C.company==="TNT").map(C=>(C.stage||"").trim());return A.includes("확정")?"확정":A.includes("기안중")?"기안중":""},[a]),N=h.useMemo(()=>{const A=a.filter(C=>C.company==="DYS").map(C=>(C.stage||"").trim());return A.includes("확정")?"확정":A.includes("기안중")?"기안중":""},[a]);return r.jsxs("section",{className:"card",style:{padding:12},children:[r.jsxs("div",{className:"page-title",style:{marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"회사별 목표 입력"}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsxs("div",{role:"radiogroup","aria-label":"목표 산정 모드",className:"segmented",children:[r.jsxs("label",{className:`seg ${n==="Best"?"selected":""}`,children:[r.jsx("input",{type:"radio",name:"assign-mode",checked:n==="Best",onChange:()=>i("Best")}),r.jsx("span",{children:"Best"})]}),r.jsxs("label",{className:`seg ${n==="Moderate"?"selected":""}`,children:[r.jsx("input",{type:"radio",name:"assign-mode",checked:n==="Moderate",onChange:()=>i("Moderate")}),r.jsx("span",{children:"Moderate"})]})]}),r.jsx("select",{className:"search-input",value:e,onChange:A=>t(Number(A.target.value)),children:KN().map(A=>r.jsxs("option",{value:A,children:[A,"년"]},A))}),r.jsx("button",{className:"btn btn-3d btn-card",onClick:()=>b(!1),children:"저장"}),r.jsx("button",{className:"btn btn-3d btn-card",onClick:()=>b(!0),children:"확정"})]})]}),c&&r.jsx("div",{className:"error",children:c}),u&&!c&&r.jsx("div",{className:"empty-state",style:{marginBottom:12},children:u}),r.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"nowrap",width:"100%"},children:[r.jsxs("div",{className:"card",style:{padding:12,flex:"1 1 0",minWidth:0},children:[r.jsxs("div",{style:{fontWeight:700,marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{children:"TNT"}),x?r.jsx("span",{className:"badge",children:x}):null,o&&r.jsx("span",{className:"muted",style:{marginLeft:"auto",fontSize:12},children:"불러오는 중…"})]}),a.filter(A=>A.company==="TNT").map(A=>{const C=a.findIndex(w=>w.company===A.company&&w.name===A.name);return r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr 42px",alignItems:"center",gap:8,marginBottom:8},children:[r.jsx("div",{children:r.jsx("span",{className:"muted",children:A.name})}),r.jsx("input",{className:"assign-input",style:{textAlign:"right"},value:A.amount?m.format(A.amount):"",onChange:w=>g(C,w.target.value),placeholder:"0",disabled:n==="Moderate",title:n==="Moderate"?"Moderate 모드에서는 회사별 목표 수정이 비활성화됩니다":"값을 입력하세요"}),r.jsx("div",{className:"muted",style:{textAlign:"left"},children:"억원"})]},`TNT-${A.name}`)}),r.jsxs("div",{style:{textAlign:"right",fontWeight:700},children:["합계: ",m.format(y)," 억원"]})]}),r.jsxs("div",{className:"card",style:{padding:12,flex:"1 1 0",minWidth:0},children:[r.jsxs("div",{style:{fontWeight:700,marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{children:"DYS"}),N?r.jsx("span",{className:"badge",children:N}):null,o&&r.jsx("span",{className:"muted",style:{marginLeft:"auto",fontSize:12},children:"불러오는 중…"})]}),a.filter(A=>A.company==="DYS").map(A=>{const C=a.findIndex(w=>w.company===A.company&&w.name===A.name);return r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr 42px",alignItems:"center",gap:8,marginBottom:8},children:[r.jsx("div",{children:r.jsx("span",{className:"muted",children:A.name})}),r.jsx("input",{className:"assign-input",style:{textAlign:"right"},value:A.amount?m.format(A.amount):"",onChange:w=>g(C,w.target.value),placeholder:"0",disabled:n==="Moderate",title:n==="Moderate"?"Moderate 모드에서는 회사별 목표 수정이 비활성화됩니다":"값을 입력하세요"}),r.jsx("div",{className:"muted",style:{textAlign:"left"},children:"억원"})]},`DYS-${A.name}`)}),r.jsxs("div",{style:{textAlign:"right",fontWeight:700},children:["합계: ",m.format(v)," 억원"]})]})]})]})}const XN=["영업1본부","영업1팀","영업2본부","영업2팀"];function GN(){const[e,t]=h.useState([]),[n,i]=h.useState(!1),[a,s]=h.useState(null),[o,l]=h.useState(!1),[c,d]=h.useState(()=>{try{const T=localStorage.getItem("tnt.sales.assign.year");return T?Number(T):new Date().getFullYear()}catch{return new Date().getFullYear()}}),[u,f]=h.useState({}),[m,p]=h.useState(null),[y,v]=h.useState({}),[g,b]=h.useState(""),x=new Intl.NumberFormat("ko-KR"),[N,A]=h.useState(0);h.useEffect(()=>{const T=()=>A($=>$+1);return window.addEventListener("tnt.sales.assign.mode.changed",T),()=>window.removeEventListener("tnt.sales.assign.mode.changed",T)},[]);const C=h.useMemo(()=>{try{return(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase()==="moderate"}catch{return!1}},[N]);async function w(){i(!0),s(null);try{const T=new URL("/api/v1/targets/assigned",window.location.origin);T.searchParams.set("year",String(c));try{const D=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),S=D==="moderate"?"2":D==="best"?"1":"";S&&T.searchParams.set("versionNo",S)}catch{}const $=await fetch(T.toString()),V=$.ok?await $.json():[],G=Array.isArray(V)?V:[];if(G.length>0){const D=G.reduce((S,_)=>{const H=String(_.emp_id??_.empId??"").trim(),q=String(_.emp_name??_.empName??"").trim(),K=String(_.dept_name??_.deptName??""),W=H||(q?`name:${q}`:"");return W&&(S.some(R=>R.key===W)||S.push({key:W,empId:H,empName:q,deptName:K})),S},[]);D.sort((S,_)=>(S.deptName||"").localeCompare(_.deptName||"")||(S.empName||"").localeCompare(_.empName||"")),t(D),i(!1);return}const ne=new URL("/api/v1/employees",window.location.origin);ne.searchParams.set("depts",XN.join(","));const U=await fetch(ne.toString());if(!U.ok)throw new Error(`HTTP ${U.status}`);const I=await U.json(),P=Array.isArray(I)?I.map(D=>{const S=String(D.empId??D.emp_id??"").trim(),_=String(D.empName??D.emp_name??"").trim(),H=String(D.deptName??D.dept_name??""),q=String(D.assignee_id??D.assigneeId??"").trim()||void 0;return{key:S||q||(_?`name:${_}`:""),empId:S,empName:_,deptName:H,assigneeId:q}}).filter(D=>!!D.key):[];P.sort((D,S)=>(D.deptName||"").localeCompare(S.deptName||"")||(D.empName||"").localeCompare(S.empName||"")),t(P)}catch(T){s((T==null?void 0:T.message)||"조회 중 오류"),t([])}finally{i(!1)}}h.useEffect(()=>{w()},[]),h.useEffect(()=>{try{localStorage.setItem("tnt.sales.assign.empList",JSON.stringify(e)),window.dispatchEvent(new CustomEvent("tnt.sales.assign.emps.changed"))}catch{}},[e]),h.useEffect(()=>{const T=()=>{try{const $=localStorage.getItem("tnt.sales.assign.year");$&&d(Number($)),v({}),b&&b("")}catch{}};return window.addEventListener("tnt.sales.assign.year.changed",T),()=>window.removeEventListener("tnt.sales.assign.year.changed",T)},[]),h.useEffect(()=>{async function T(){try{if(!e.length){v({});return}const $=new URL("/api/v1/targets/assigned",window.location.origin);$.searchParams.set("year",String(c));try{const P=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),D=P==="moderate"?"2":P==="best"?"1":"";D&&$.searchParams.set("versionNo",D)}catch{}const V=await fetch($.toString()),G=V.ok?await V.json():[],ne={};let U="";Array.isArray(G)&&G.forEach(P=>{const D=String(P.emp_id??P.empId??"").trim(),S=String(P.emp_name??P.empName??"").trim(),_=D||(S?`name:${S}`:"");if(!_)return;const H=String(P.company_name??P.companyName??"").toUpperCase(),q=Number(P.assigned_amount??P.assignedAmount??0),K=String(P.target_stage??P.targetStage??"").trim(),W=ne[_]||{tnt:0,dys:0};H==="TNT"?W.tnt=Math.round(q):H==="DYS"&&(W.dys=Math.round(q)),ne[_]=W,K==="확정"?U="확정":!U&&K==="기안중"&&(U="기안중")});const I={};e.forEach(P=>{const D=ne[P.key];D&&(I[P.key]={tnt:D.tnt||0,dys:D.dys||0})}),v(I),b(U)}catch{}}T()},[c,e,N]),h.useEffect(()=>{async function T(){try{const $=Array.from(new Set(e.map(P=>String(P.empName||"").trim()).filter(Boolean)));if(!$.length){f({});return}const V=new URL("/api/v1/sales/employee-yearly",window.location.origin);V.searchParams.set("year",String(c)),V.searchParams.set("empNames",$.join(",")),V.searchParams.set("joinKey","emp_name");const G=await fetch(V.toString()),ne=G.ok?await G.json():[],U=Array.isArray(ne)?ne:Array.isArray(ne==null?void 0:ne.employees)?ne.employees:[],I={};U.forEach(P=>{const D=String(P.emp_name??P.empName??"").trim();if(!D)return;const S=Number(P.tnt_amount??0),_=Number(P.dys_amount??0),H=I[D]||{tnt:0,dys:0};I[D]={tnt:H.tnt+(Number.isFinite(S)?S:0),dys:H.dys+(Number.isFinite(_)?_:0)}}),f(I)}catch{f({})}}T()},[c,e]);function O(T,$){const V=Number($);return!Number.isFinite(V)||V<=0?"-":`${(Math.max(0,Number(T||0))*1e8/V*100).toFixed(1)}%`}const M=e;function B(T){p(T);try{localStorage.setItem("tnt.sales.selectedEmployee",JSON.stringify(T))}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.employee.selected"))}catch{}}function z(T,$,V){const G=Number((V||"").replace(/[,\s]/g,"")),ne=Number.isFinite(G)?G:0;v(U=>{const P={...U[T]||{tnt:0,dys:0},[$]:ne};return{...U,[T]:P}})}function j(T,$){const V=Math.max(0,Math.round(Number(T)||0)),G=$.reduce((S,_)=>S+(Number(_.value)||0),0);if(!Number.isFinite(G)||G<=0||V<=0){const S={};return $.forEach(_=>{S[_.key]=0}),S}const U=$.map(S=>({key:S.key,exact:V*((Number(S.value)||0)/G)})).map(S=>({key:S.key,floor:Math.floor(S.exact),frac:S.exact-Math.floor(S.exact)}));let I=U.reduce((S,_)=>S+_.floor,0),P=V-I;U.sort((S,_)=>_.frac-S.frac);for(let S=0;S<P&&U.length>0;S++){const _=S%U.length;U[_].floor+=1}const D={};return U.forEach(S=>{D[S.key]=S.floor}),D}async function k(){if(!o){l(!0);try{let T=null;try{const oe=localStorage.getItem("tnt.sales.assign.companyTotals");T=oe?JSON.parse(oe):null}catch{}const $=Math.round(Number((T==null?void 0:T.tnt)||0)),V=Math.round(Number((T==null?void 0:T.dys)||0));if(!Number.isFinite($)||!Number.isFinite(V)){alert("회사별 목표 합계를 찾을 수 없습니다. 상단 패널을 확인하세요.");return}const G=e.map(oe=>String(oe.empName||"").trim()).filter(oe=>!!oe);if(!G.length){alert("대상 직원이 없습니다.");return}const ne=new URL("/api/v1/sales/employee-yearly",window.location.origin);ne.searchParams.set("year",String(c)),ne.searchParams.set("empNames",G.join(",")),ne.searchParams.set("joinKey","emp_name");const U=await fetch(ne.toString()),I=U.ok?await U.json():[],P=Array.isArray(I)?I:Array.isArray(I==null?void 0:I.employees)?I.employees:[],D={};Array.isArray(P)&&P.forEach(oe=>{const Y=String(oe.emp_name??oe.empName??"").trim();if(!Y)return;const X=Number(oe.tnt_amount??0),de=Number(oe.dys_amount??0),be=D[Y]||{tnt:0,dys:0};D[Y]={tnt:be.tnt+(Number.isFinite(X)?X:0),dys:be.dys+(Number.isFinite(de)?de:0)}});const S={};e.forEach(oe=>{const Y=String(oe.empName||"").trim();S[Y]=(S[Y]||0)+1});const _=[],H=[];e.forEach(oe=>{const Y=String(oe.empName||"").trim(),X=D[Y]||{tnt:0,dys:0},de=Math.max(1,S[Y]||1);_.push({key:oe.key,value:X.tnt/de}),H.push({key:oe.key,value:X.dys/de})});const q=j($,_),K=j(V,H);v(oe=>{const Y={...oe};return e.forEach(X=>{Y[X.key]={tnt:q[X.key]??0,dys:K[X.key]??0}}),Y});const W=oe=>Object.values(oe||{}).reduce((Y,X)=>Y+(Number(X)||0),0),R=`TNT 합계 ${x.format(W(q))} / 목표 ${x.format($)}
DYS 합계 ${x.format(W(K))} / 목표 ${x.format(V)}`;W(q)!==$||W(K)!==V?alert(`배정 완료(합계 보정 필요):
`+R):alert(`배정이 완료되었습니다.
`+R)}catch(T){alert((T==null?void 0:T.message)||"배정 중 오류가 발생했습니다.")}finally{l(!1)}}}return r.jsxs("section",{children:[r.jsx(VN,{}),r.jsxs("div",{className:"page-title",style:{alignItems:"center",marginTop:12},children:[r.jsxs("h2",{style:{margin:0,fontSize:18,display:"flex",alignItems:"center",gap:8},children:["목표배정",g?r.jsx("span",{className:"badge",title:"해당 연도 전체 단계",children:g}):null]}),r.jsxs("div",{style:{marginLeft:"auto",display:"inline-flex",alignItems:"center",gap:8},children:[r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>k(),disabled:o,title:"전년도 매출 비율로 자동 배정",children:"할당(매출 기반)"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>L(!1),title:"현재 배정값 저장",children:"저장"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>L(!0),title:"현재 배정값 확정",children:"확정"})]})]}),a&&r.jsx("div",{className:"error",children:a}),r.jsx("div",{className:"table-container",style:{height:"calc(100vh - 140px)"},children:n?r.jsx("div",{className:"empty-state",children:"불러오는 중…"}):M.length===0?r.jsx("div",{className:"empty-state",children:"데이터가 없습니다"}):r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:140},children:"부서"}),r.jsx("th",{style:{width:140},children:"사번"}),r.jsx("th",{style:{width:180,textAlign:"left"},children:"이름"}),r.jsx("th",{style:{width:140,textAlign:"right"},children:"TNT"}),r.jsx("th",{style:{width:110,textAlign:"right"},children:"TNT 전년대비"}),r.jsx("th",{style:{width:140,textAlign:"right"},children:"DYS"}),r.jsx("th",{style:{width:110,textAlign:"right"},children:"DYS 전년대비"})]})}),r.jsx("tbody",{children:M.map((T,$)=>{var I,P;const V=y[T.key]||{tnt:0,dys:0},G=String(T.empName||"").trim(),ne=Number(((I=u[G])==null?void 0:I.tnt)||0),U=Number(((P=u[G])==null?void 0:P.dys)||0);return r.jsxs("tr",{onClick:()=>B(T),"aria-selected":(m==null?void 0:m.key)===T.key?!0:void 0,style:(m==null?void 0:m.key)===T.key?{background:"rgba(59,130,246,.12)"}:void 0,children:[r.jsx("td",{children:T.deptName}),r.jsx("td",{children:T.empId}),r.jsx("td",{style:{textAlign:"left"},children:T.empName}),r.jsx("td",{style:{textAlign:"right"},children:r.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9,]*",value:V.tnt?x.format(V.tnt):"",onChange:D=>z(T.key,"tnt",D.target.value),placeholder:"0",style:{width:"100%",textAlign:"right"},className:"assign-input","aria-label":`TNT 목표(${T.empName})`,title:C?"Moderate 모드에서는 목표 수정이 비활성화됩니다":"TNT 매출목표",disabled:C})}),r.jsx("td",{style:{textAlign:"right"},title:"해당 직원 전년도 TNT 매출 대비 올해 목표 비율",children:r.jsx("span",{className:"muted",children:O(V.tnt,ne)})}),r.jsx("td",{style:{textAlign:"right"},children:r.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9,]*",value:V.dys?x.format(V.dys):"",onChange:D=>z(T.key,"dys",D.target.value),placeholder:"0",style:{width:"100%",textAlign:"right"},className:"assign-input","aria-label":`DYS 목표(${T.empName})`,title:C?"Moderate 모드에서는 목표 수정이 비활성화됩니다":"DYS 매출목표",disabled:C})}),r.jsx("td",{style:{textAlign:"right"},title:"해당 직원 전년도 DYS 매출 대비 올해 목표 비율",children:r.jsx("span",{className:"muted",children:O(V.dys,U)})})]},$)})})]})})]});async function L(T){try{const $=T?"확정":"기안중",G=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase()==="moderate"?2:1,ne=[],U=`${c}-01-01`;e.forEach(S=>{const _=y[S.key]||{tnt:0,dys:0};ne.push({targetYear:U,empName:S.empName,companyName:"TNT",targetAmount:Math.round(_.tnt||0),targetStage:$,versionNo:G}),ne.push({targetYear:U,empName:S.empName,companyName:"DYS",targetAmount:Math.round(_.dys||0),targetStage:$,versionNo:G})});const I=localStorage.getItem("tnt.sales.empSeq")||"",P={"Content-Type":"application/json"};I&&(P["X-EMP-SEQ"]=String(I));const D=await fetch("/api/v1/targets/assigned/upsert",{method:"POST",headers:P,body:JSON.stringify(ne)});if(!D.ok)throw new Error(`HTTP ${D.status}`);T&&await fetch(`/api/v1/targets/assigned/confirm?year=${c}`,{method:"POST",headers:P}),alert(T?"배정이 확정되었습니다.":"배정이 저장되었습니다.")}catch($){alert(($==null?void 0:$.message)||"배정 저장 중 오류가 발생했습니다.")}}}function QN(){const[e,t]=h.useState([]),[n,i]=h.useState(!1),[a,s]=h.useState(null),[o,l]=h.useState("ALL"),[c,d]=h.useState("mine");function u(){const P=new Date,D=String(P.getFullYear()%100).padStart(2,"0"),S=String(P.getMonth()+1).padStart(2,"0"),_=String(P.getDate()).padStart(2,"0");return`${D}-${S}-${_}`}const[f,m]=h.useState(u()),[p,y]=h.useState(u()),[v,g]=h.useState(null),[b,x]=h.useState(null),N=h.useRef(null),[A,C]=h.useState(null),[w,O]=h.useState(null),[M,B]=h.useState(null),[z,j]=h.useState("");async function k(P){if(P==="ALL")return"";try{const D=typeof window<"u"&&localStorage.getItem("tnt.sales.assigneeId")||"",S=typeof window<"u"&&localStorage.getItem("tnt.sales.empId")||"",_=new URLSearchParams;D&&_.set("assigneeId",D),S&&_.set("empId",S),_.set("companyCode",P);const H=await fetch(`/api/v1/employee/by-assignee?${_.toString()}`,{cache:"no-store"});if(!H.ok)return"";const q=await H.json().catch(()=>null),K=(q==null?void 0:q.resolvedSalesEmpSeq)??(P==="DYS"?q==null?void 0:q.dys_emp_seq:q==null?void 0:q.tnt_emp_seq);return K!=null&&String(K)?String(K):""}catch{return""}}function L(P){if(!P)return"";let D=String(P).trim();const S=D.replace(/[^0-9]/g,"");if(S.length===6){const q=S.slice(0,2),K=S.slice(2,4),W=S.slice(4,6);return T(q,K,W)?`${q}-${K}-${W}`:null}if(S.length===8){const q=S.slice(2,4),K=S.slice(4,6),W=S.slice(6,8);return T(q,K,W)?`${q}-${K}-${W}`:null}const _=D.match(/^\s*(\d{2})[-/](\d{2})[-/](\d{2})\s*$/);if(_){const[,q,K,W]=_;return T(q,K,W)?`${q}-${K}-${W}`:null}const H=D.match(/^\s*(\d{4})[-/](\d{2})[-/](\d{2})\s*$/);if(H){const[,q,K,W]=H,R=q.slice(2);return T(R,K,W)?`${R}-${K}-${W}`:null}return null}function T(P,D,S){const _=Number(P),H=Number(D),q=Number(S);return!(!Number.isInteger(_)||!Number.isInteger(H)||!Number.isInteger(q)||H<1||H>12||q<1||q>31||q>[31,28,31,30,31,30,31,31,30,31,30,31][H-1])}function $(P){const D=P.match(/^(\d{2})-(\d{2})-(\d{2})$/);return D?`20${D[1]}-${D[2]}-${D[3]}`:null}function V(P){try{let D=String(P??"");return D=D.replace(/\r\n/g,`
`).replace(/\r/g,`
`).replace(/\\n/g,`
`),D}catch{return String(P??"")}}function G(P){const D=String(P??"").trim();if(!D)return"";const S=D.replace(/[^0-9]/g,"");return S.length===8?`${S.slice(0,4)}-${S.slice(4,6)}-${S.slice(6,8)}`:S.length===6?`20${S.slice(0,2)}-${S.slice(2,4)}-${S.slice(4,6)}`:D}async function ne(P=!1){const D=f.trim(),S=p.trim();let _=D?L(D):"",H=S?L(S):"";if(O(null),B(null),D&&!_){O("형식: YY-MM-DD");return}if(S&&!H){B("형식: YY-MM-DD");return}if(typeof _=="string"&&m(_),typeof H=="string"&&y(H),_&&H){const q=$(_),K=$(H);if(q>K){B("종료일이 시작일보다 빠릅니다");return}}i(!0),s(null);try{const q=new URL("/api/v1/orders/external/tsl-order-text",window.location.origin);if(q.searchParams.set("company",o),_&&q.searchParams.set("fromDate",_),H&&q.searchParams.set("toDate",H),c==="mine"){const Y=await k(o);Y&&q.searchParams.set("salesEmpSeq",Y)}const K=await fetch(q.toString(),{cache:"no-store"});if(!K.ok)throw new Error(`HTTP ${K.status}`);const W=await K.json().catch(()=>[]);let R=Array.isArray(W)?W:[];const oe=z.trim();if(oe){const Y=oe.split(/\s+/).map(X=>X.toLowerCase());R=R.filter(X=>{const de=(()=>{const be=Object.entries(X);let ke=null;for(const[ve,Ie]of be){const J=String(ve).toLowerCase();if(J==="custseq"||J==="custname"||J==="customername"||J==="customer_name"){ke=Ie;break}}return String(ke??"")})().toLowerCase();return Y.every(be=>de.includes(be))})}t(R)}catch(q){s((q==null?void 0:q.message)||"조회 실패"),t([])}finally{i(!1)}}h.useEffect(()=>{if(!(b!=null&&b.open))return;const P=S=>{const _=N.current;_&&S.target instanceof Node&&!_.contains(S.target)&&x(null)},D=S=>{S.key==="Escape"&&x(null)};return document.addEventListener("mousedown",P,!0),window.addEventListener("keydown",D,!0),()=>{document.removeEventListener("mousedown",P,!0),window.removeEventListener("keydown",D,!0)}},[b==null?void 0:b.open]);const U=h.useMemo(()=>{if(!e.length)return[];const P=e[0];return Object.keys(P)},[e]);function I(P){const D=(P||"").toString();return/^OrderTextNo$/i.test(D)?"수주장번호":/^OrderTextDate$/i.test(D)||/^OrderTextDat$/i.test(D)?"주문일자":/^CustSeq$/i.test(D)||/^CustName$/i.test(D)||/^CustomerName$/i.test(D)?"거래처명":/^RegionGroup$/i.test(D)||/^region_group$/i.test(D)?"지역그룹":/^SalesEmpSeq$/i.test(D)?"영업":/^OrderText$/i.test(D)?"수주내역":/^IsCancel$/i.test(D)?"중단여부":/^CancelText$/i.test(D)?"중단사유":/^Remark$/i.test(D)?"비고":/^LastDateTime$/i.test(D)?"최종수정일시":/^WHSeq$/i.test(D)?"창고번호":/^DelvDate$/i.test(D)?"납기예정일":/^CustEmpName$/i.test(D)?"거래처담당":/^IsClaim$/i.test(D)?"Claim":/^OrderRemark$/i.test(D)?"주문요청사항":/^Request(Date|Dt)$/i.test(D)||/^ReqDate$/i.test(D)?"요청일자":D}return r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"수주장 조회"}),r.jsxs("div",{style:{marginLeft:16,background:"#f3f4f6",padding:4,borderRadius:8,display:"flex",gap:0},children:[r.jsx("button",{onClick:()=>l("ALL"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:o==="ALL"?"#fff":"transparent",color:o==="ALL"?"#2563eb":"#6b7280",boxShadow:o==="ALL"?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:"ALL"}),r.jsx("button",{onClick:()=>l("TNT"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:o==="TNT"?"#fff":"transparent",color:o==="TNT"?"#2563eb":"#6b7280",boxShadow:o==="TNT"?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:"TNT"}),r.jsx("button",{onClick:()=>l("DYS"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:o==="DYS"?"#fff":"transparent",color:o==="DYS"?"#2563eb":"#6b7280",boxShadow:o==="DYS"?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:"DYS"})]}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:12,fontSize:12},children:[r.jsxs("select",{className:"search-input",value:c,onChange:P=>d(P.target.value||"all"),title:"조회 범위",style:{minWidth:110},children:[r.jsx("option",{value:"mine",children:"내수주"}),r.jsx("option",{value:"all",children:"전체"})]}),r.jsx("label",{className:"muted",children:"수주일"}),r.jsx("input",{className:"search-input",placeholder:"YY-MM-DD",value:f,onChange:P=>{m(P.target.value),w&&O(null)},onBlur:P=>{const D=L(P.target.value);D===null&&P.target.value.trim()?O("형식: YY-MM-DD"):typeof D=="string"&&m(D)},style:{width:90}}),w?r.jsx("div",{className:"error",style:{fontSize:11},children:w}):null,r.jsx("span",{className:"muted",children:"~"}),r.jsx("input",{className:"search-input",placeholder:"YY-MM-DD",value:p,onChange:P=>{y(P.target.value),M&&B(null)},onBlur:P=>{const D=L(P.target.value);D===null&&P.target.value.trim()?B("형식: YY-MM-DD"):typeof D=="string"&&y(D)},style:{width:90}}),M?r.jsx("div",{className:"error",style:{fontSize:11},children:M}):null,r.jsx("label",{className:"muted",children:"거래처명"}),r.jsx("input",{className:"search-input",placeholder:"검색어(공백으로 AND)",value:z,onChange:P=>j(P.target.value),style:{width:200}}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>ne(!0),disabled:!!w||!!M||n,children:"조회"})]})]}),a?r.jsx("div",{className:"error",children:a}):null,r.jsx("div",{className:"table-container",style:{height:"calc(100vh - 160px)"},children:n?r.jsx("div",{className:"empty-state",children:"불러오는 중…"}):e.length===0?r.jsx("div",{className:"empty-state",children:"데이터가 없습니다"}):r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsx("tr",{children:U.map(P=>r.jsx("th",{children:I(P)},P))})}),r.jsx("tbody",{children:e.map((P,D)=>{const S=Object.keys(P).find(H=>H.toLowerCase()==="companytype"),_=S?String(P[S]||"").trim().toUpperCase():"";return r.jsx("tr",{onMouseEnter:H=>{const q=(H.clientX||0)+12,K=(H.clientY||0)+12;b!=null&&b.open||g({open:!0,x:q,y:K,rec:P})},onMouseMove:H=>{if(!(v!=null&&v.open))return;const q=(H.clientX||0)+12,K=(H.clientY||0)+12;b!=null&&b.open||g({open:!0,x:q,y:K,rec:P})},onMouseLeave:()=>g(null),onContextMenu:H=>{H.preventDefault();const q=H.clientX,K=H.clientY;x({open:!0,x:q,y:K,rec:P})},children:U.map(H=>{const q=/^(CustSeq|CustName|CustomerName|customer_name)$/i.test(H)||I(H)==="거래처명",K=String((P==null?void 0:P[H])??"");if(q&&o==="ALL"&&_){const W=_.includes("TNT"),R=_.includes("DYS"),oe=W?"T":R?"D":"",Y=W?"#1d4ed8":R?"#059669":"#6b7280";return r.jsx("td",{children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[oe&&r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:"50%",background:Y,color:"#fff",fontSize:11,fontWeight:700,flexShrink:0},title:_,children:oe}),r.jsx("span",{children:K})]})},H)}return r.jsx("td",{children:K},H)})},D)})})]})}),v!=null&&v.open&&!(b!=null&&b.open)?r.jsx("div",{role:"dialog","aria-live":"polite",style:{position:"fixed",left:Math.min(Math.max(8,v.x),window.innerWidth-460),top:Math.min(Math.max(8,v.y),window.innerHeight-300),zIndex:80,pointerEvents:"none"},children:r.jsx("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:8,minWidth:320,maxWidth:600,maxHeight:"85vh",overflow:"auto",boxShadow:"0 8px 24px rgba(0,0,0,.18)"},children:r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:U.map(P=>{const D=(v.rec||{})[P],S=V(D);return r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10,paddingBottom:6,borderBottom:"1px solid var(--border-light)"},children:[r.jsx("div",{style:{minWidth:120,fontWeight:600,fontSize:12,color:"var(--text-secondary)"},children:I(P)}),r.jsx("div",{style:{flex:1,whiteSpace:"pre-wrap",fontSize:12,wordBreak:"break-word"},children:S||r.jsx("span",{style:{color:"var(--text-muted)",fontStyle:"italic"},children:"-"})})]},P)})})})}):null,b!=null&&b.open?(()=>{const P=Math.min(Math.max(8,b.x),window.innerWidth-220),D=Math.min(Math.max(8,b.y),window.innerHeight-120);async function S(){try{const H=U.find(J=>/^OrderText$/i.test(J))||U.find(J=>I(J)==="수주내역"),q=U.find(J=>/^OrderRemark$/i.test(J))||U.find(J=>I(J)==="주문요청사항"),K=U.find(J=>I(J)==="거래처명")||U.find(J=>/^(CustName|CustomerName|customer_name|CustSeq)$/i.test(J)),W=U.find(J=>/^(UserName|CreatedBy|created_by)$/i.test(J)),R=U.find(J=>/^(RegionGroup|region_group)$/i.test(J)),oe=o,Y=K?String((b.rec||{})[K]??""):"";let X=W?String((b.rec||{})[W]??""):"",de=R?String((b.rec||{})[R]??""):"",be=H?V((b.rec||{})[H]):"";const ke=q?V((b.rec||{})[q]):"";if(!X){const J=U.find(ge=>I(ge)==="영업");J&&(X=String((b.rec||{})[J]??""))}if(be){const J=String(be).split(/\n/),ge=[];for(const Pe of J){const Se=Pe.match(/^\s*지역\s*그룹\s*[:：]\s*(.*)\s*$/)||Pe.match(/^\s*지역그룹\s*[:：]\s*(.*)\s*$/);if(Se){const Je=(Se[1]||"").trim();!de&&Je&&(de=Je)}else ge.push(Pe)}be=ge.join(`
`)}let ve=[];ve.push(`회사코드: ${oe}`),ve.push(`거래처: ${Y}`),ve.push(`등록자: ${X}`),ve.push(`지역 그룹: ${de}`),ve.push("주문내용:"),ve.push(be),ve.push("요청사항:"),ve.push(ke);let Ie=ve.join(`
`);if(!be&&!ke&&(Ie=JSON.stringify(b.rec??{},null,2)),navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(Ie);else{const J=document.createElement("textarea");J.value=Ie,J.style.position="fixed",J.style.left="-9999px",document.body.appendChild(J),J.focus(),J.select(),document.execCommand("copy"),document.body.removeChild(J)}C({open:!0,x:P+8,y:D+8}),setTimeout(()=>C(null),1200)}catch{}x(null)}async function _(){try{const H=U.find(Se=>/^OrderText$/i.test(Se))||U.find(Se=>I(Se)==="수주내역"),q=U.find(Se=>/^OrderRemark$/i.test(Se))||U.find(Se=>I(Se)==="주문요청사항"),K=U.find(Se=>I(Se)==="거래처명")||U.find(Se=>/^(CustName|CustomerName|customer_name|CustSeq)$/i.test(Se)),W=U.find(Se=>I(Se)==="수주장번호")||U.find(Se=>/^OrderTextNo$/i.test(Se)),R=[U.find(Se=>I(Se)==="요청일자"),U.find(Se=>/^Request(Date|Dt)$/i.test(Se)),U.find(Se=>/^DelvDate$/i.test(Se)),U.find(Se=>/^OrderTextDate$/i.test(Se))].filter(Boolean);let oe="";const Y=U.find(Se=>/^(UserName|CreatedBy|created_by)$/i.test(Se));if(Y&&(oe=String((b.rec||{})[Y]??"")),!oe){const Se=U.find(Je=>I(Je)==="영업");Se&&(oe=String((b.rec||{})[Se]??""))}let X="";const de=U.find(Se=>/^(RegionGroup|region_group)$/i.test(Se));de&&(X=String((b.rec||{})[de]??""));let be=H?V((b.rec||{})[H]):"";const ke=q?V((b.rec||{})[q]):"";if(be){const Se=String(be).split(/\n/),Je=[];for(const yt of Se){const jt=yt.match(/^\s*지역\s*그룹\s*[:：]\s*(.*)\s*$/)||yt.match(/^\s*지역그룹\s*[:：]\s*(.*)\s*$/);if(jt){const It=(jt[1]||"").trim();!X&&It&&(X=It)}else Je.push(yt)}be=Je.join(`
`)}const ve=W?String((b.rec||{})[W]??"").trim():"";let Ie="";for(const Se of R){const Je=Se?String((b.rec||{})[Se]??"").trim():"";if(Je){Ie=G(Je);break}}const J={orderNo:ve,companyCode:o,customerName:K?String((b.rec||{})[K]??""):"",createdBy:oe,regionGroup:X,orderText:be,orderRemark:ke,requestDate:Ie},ge=await fetch("/api/v1/slack/send-order-copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)}),Pe=await ge.json().catch(()=>({}));ge.ok&&Pe.success?(C({open:!0,x:P+8,y:D+8,message:"Slack 전송 완료"}),setTimeout(()=>C(null),1500)):alert(Pe.message||`Slack 전송 실패 (HTTP ${ge.status})`)}catch(H){console.error("Slack 전송 실패:",H),alert("Slack 전송 중 오류가 발생했습니다.")}x(null)}return r.jsx("div",{ref:N,role:"menu",style:{position:"fixed",left:P,top:D,zIndex:90,minWidth:180},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:4,border:"1px solid var(--border)",borderRadius:8,boxShadow:"0 8px 24px rgba(0,0,0,.18)",display:"flex",flexDirection:"column",gap:2,fontSize:13},children:[r.jsx("button",{className:"btn-plain",style:{width:"100%",textAlign:"left",padding:"4px 6px",fontSize:13},onClick:_,children:"Slack전송"}),r.jsx("button",{className:"btn-plain",style:{width:"100%",textAlign:"left",padding:"4px 6px",fontSize:13},onClick:S,children:"복사"})]})})})():null,A!=null&&A.open?r.jsx("div",{style:{position:"fixed",left:A.x,top:A.y,zIndex:95},children:r.jsx("div",{className:"card",style:{background:"var(--panel)",padding:"2px 6px",border:"1px solid var(--border)",borderRadius:6,fontSize:11},children:A.message||"복사했습니다"})}):null]})}const JN=["매출","가격","재고","경쟁사","Complaint","품질관리","공급사"];function ZN(){const[e,t]=h.useState(""),[n,i]=h.useState([]),[a,s]=h.useState(!1),[o,l]=h.useState(null),[c,d]=h.useState("매출"),u=new Intl.NumberFormat("ko-KR");async function f(){s(!0),l(null);try{const m=new URL("/api/v1/items/search",window.location.origin);m.searchParams.set("q",e||""),m.searchParams.set("limit","100");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const y=await p.json(),v=Array.isArray(y)?y.map(g=>({itemSeq:Number(g.itemSeq??g.item_seq??0),itemName:String(g.itemName??g.item_name??""),recentInvoiceDate:String(g.recentInvoiceDate??g.recent_invoice_date??""),curAmt:Number(g.curAmt??g.cur_amt??0),qty:Number(g.qty??0)})):[];i(v)}catch(m){l((m==null?void 0:m.message)||"조회 오류"),i([])}finally{s(!1)}}return h.useEffect(()=>{f()},[]),r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"Item360"}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsx("input",{className:"search-input",value:e,onChange:m=>t(m.target.value),placeholder:"품목명 검색",onKeyDown:m=>{m.key==="Enter"&&f()}}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:f,disabled:a,children:"검색"})]})]}),o&&r.jsx("div",{className:"error",children:o}),r.jsx("div",{className:"table-container",style:{height:300},children:a?r.jsx("div",{className:"empty-state",children:"불러오는 중…"}):n.length===0?r.jsx("div",{className:"empty-state",children:"데이터가 없습니다"}):r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:120},children:"품목코드"}),r.jsx("th",{style:{textAlign:"left"},children:"품목명"}),r.jsx("th",{style:{width:140},children:"최근 매출일"}),r.jsx("th",{style:{width:140,textAlign:"right"},children:"매출금액"}),r.jsx("th",{style:{width:120,textAlign:"right"},children:"수량"})]})}),r.jsx("tbody",{children:n.map((m,p)=>r.jsxs("tr",{children:[r.jsx("td",{children:m.itemSeq||""}),r.jsx("td",{style:{textAlign:"left"},children:m.itemName||""}),r.jsx("td",{children:m.recentInvoiceDate||""}),r.jsxs("td",{style:{textAlign:"right"},children:[u.format(Math.round(Number(m.curAmt||0)))," 원"]}),r.jsx("td",{style:{textAlign:"right"},children:u.format(Math.round(Number(m.qty||0)))})]},p))})]})}),r.jsxs("div",{style:{marginTop:12},children:[r.jsx("div",{style:{display:"flex",gap:6,borderBottom:"1px solid var(--border)"},children:JN.map(m=>r.jsx("button",{className:"btn btn-card",style:{borderBottom:c===m?"2px solid var(--accent)":"2px solid transparent"},onClick:()=>d(m),children:m},m))}),r.jsx("div",{style:{padding:12},children:r.jsxs("div",{className:"empty-state",children:[c," 탭은 준비중입니다."]})})]})]})}const e2=["영업1본부","영업1팀","영업2본부","영업2팀"];function t2(){const[e,t]=h.useState(()=>{try{const D=localStorage.getItem("tnt.sales.assign.year");return D?Number(D):new Date().getFullYear()}catch{return new Date().getFullYear()}}),[n,i]=h.useState([]),[a,s]=h.useState(!1),[o,l]=h.useState(null),[c,d]=h.useState([]),[u,f]=h.useState(!1),m=h.useRef(null),[p,y]=h.useState([]),[v,g]=h.useState(!1),[b,x]=h.useState(null),[N,A]=h.useState({tnt:0,dys:0}),[C,w]=h.useState([]),[O,M]=h.useState(!1),[B,z]=h.useState(null),j=h.useMemo(()=>{try{let D=0,S=0;for(const _ of p){const H=String((_==null?void 0:_.company_name)??(_==null?void 0:_.companyName)??"").toUpperCase(),q=Number((_==null?void 0:_.target_amount_max)??0);Number.isFinite(q)&&(H==="TNT"?D+=q:H==="DYS"&&(S+=q))}return{tnt:D,dys:S}}catch{return{tnt:0,dys:0}}},[p]),k=h.useMemo(()=>({tnt:N.tnt/1e8,dys:N.dys/1e8}),[N]),L=h.useMemo(()=>({tnt:j.tnt-k.tnt,dys:j.dys-k.dys}),[j,k]),T=h.useMemo(()=>{try{const D=K=>p.reduce((W,R)=>{const oe=String((R==null?void 0:R.biz_area_name)??(R==null?void 0:R.bizAreaName)??""),Y=Number((R==null?void 0:R.target_amount_max)??0);return W+(oe===K&&Number.isFinite(Y)?Y:0)},0),S=D("복층유리"),_=D("건자재"),H=D("실란트");return(Number.isFinite(S)?S:0)+(Number.isFinite(_)?_:0)+(Number.isFinite(H)?H:0)}catch{return 0}},[p]),$=h.useMemo(()=>{const D=[];for(let S=2030;S>=2026;S--)D.push(S);return D},[]);async function V(D){s(!0),l(null);try{const S=new URL("/api/v1/targets/assigned",window.location.origin);S.searchParams.set("year",String(D));const _=await fetch(S.toString()),H=_.ok?await _.json():[],q=Array.isArray(H)?H:[];if(q.length>0){const Y=q.reduce((X,de)=>{const be=String(de.emp_id??de.empId??"").trim(),ke=String(de.emp_name??de.empName??"").trim(),ve=String(de.dept_name??de.deptName??""),Ie=be||(ke?`name:${ke}`:"");return Ie&&(X.some(J=>J.key===Ie)||X.push({key:Ie,empId:be,empName:ke,deptName:ve})),X},[]);Y.sort((X,de)=>(X.deptName||"").localeCompare(de.deptName||"")||(X.empName||"").localeCompare(de.empName||"")),i(Y),s(!1);return}const K=new URL("/api/v1/employees",window.location.origin);K.searchParams.set("depts",e2.join(","));const W=await fetch(K.toString());if(!W.ok)throw new Error(`HTTP ${W.status}`);const R=await W.json(),oe=Array.isArray(R)?R.map(Y=>{const X=String(Y.empId??Y.emp_id??"").trim(),de=String(Y.empName??Y.emp_name??"").trim(),be=String(Y.deptName??Y.dept_name??""),ke=String(Y.assignee_id??Y.assigneeId??"").trim()||void 0;return{key:X||ke||(de?`name:${de}`:""),empId:X,empName:de,deptName:be,assigneeId:ke}}).filter(Y=>!!Y.key):[];oe.sort((Y,X)=>(Y.deptName||"").localeCompare(X.deptName||"")||(Y.empName||"").localeCompare(X.empName||"")),i(oe)}catch(S){l((S==null?void 0:S.message)||"조회 중 오류"),i([])}finally{s(!1)}}h.useEffect(()=>{V(e)},[e]),h.useEffect(()=>{async function D(){g(!0),x(null);try{const S=new URL("/api/v1/targets/year",window.location.origin);S.searchParams.set("year",String(e));const _=await fetch(S.toString());if(!_.ok)throw new Error(`HTTP ${_.status}`);const H=await _.json();y(Array.isArray(H)?H:[])}catch(S){y([]),x((S==null?void 0:S.message)||"조회 오류")}finally{g(!1)}}D()},[e]),h.useEffect(()=>{async function D(){const S=c.length?n.filter(q=>c.includes(q.key)):n,_=S.map(q=>String(q.empId||"").trim()).filter(Boolean),H=S.map(q=>String(q.assigneeId||"").trim()).filter(Boolean);if(!e||_.length===0&&H.length===0){w([]),z(null);return}M(!0),z(null);try{const q=new URL("/api/v1/sales/plan/customer-counts",window.location.origin);q.searchParams.set("year",String(e)),_.length>0&&q.searchParams.set("empIds",_.join(",")),H.length>0&&q.searchParams.set("assigneeIds",H.join(","));const K=await fetch(q.toString());if(!K.ok)throw new Error(`HTTP ${K.status}`);const W=await K.json();w(Array.isArray(W)?W:[])}catch(q){w([]),z((q==null?void 0:q.message)||"고객수 요약 조회 오류")}finally{M(!1)}}D()},[e,c,n]),h.useEffect(()=>{async function D(){try{const S=new URL("/api/v1/sales/plan/totals",window.location.origin);S.searchParams.set("year",String(e));const _=await fetch(S.toString());if(!_.ok)throw new Error(`HTTP ${_.status}`);const H=await _.json().catch(()=>[]);let q=0,K=0;Array.isArray(H)&&H.forEach(W=>{const R=String((W==null?void 0:W.company)||(W==null?void 0:W.company_type)||(W==null?void 0:W.companyName)||"").toUpperCase(),oe=Number((W==null?void 0:W.total)||(W==null?void 0:W.total_amount)||0);R==="TNT"?q+=Number.isFinite(oe)?oe:0:R==="DYS"&&(K+=Number.isFinite(oe)?oe:0)}),A({tnt:q,dys:K})}catch{A({tnt:0,dys:0})}}D()},[e]);function G(D){const S=Number(D.target.value);if(!(!Number.isFinite(S)||S<=0)){t(S);try{localStorage.setItem("tnt.sales.assign.year",String(S))}catch{}}}function ne(D){d(D);const S=n.filter(H=>D.includes(H.key));try{localStorage.setItem("tnt.sales.selectedEmployees",JSON.stringify(S))}catch{}const _=S[0]||null;try{_?localStorage.setItem("tnt.sales.selectedEmployee",JSON.stringify(_)):localStorage.removeItem("tnt.sales.selectedEmployee")}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.employees.selected",{detail:{items:S}}))}catch{}try{_&&window.dispatchEvent(new CustomEvent("tnt.sales.employee.selected"))}catch{}}function U(D){ne(D?n.map(S=>S.key):[])}function I(D,S){const _=new Set(c);S?_.add(D):_.delete(D),ne(Array.from(_))}h.useEffect(()=>{if(!u)return;const D=_=>{m.current&&(m.current.contains(_.target)||f(!1))},S=_=>{_.key==="Escape"&&f(!1)};return window.addEventListener("click",D,!0),window.addEventListener("keydown",S,!0),()=>{window.removeEventListener("click",D,!0),window.removeEventListener("keydown",S,!0)}},[u]);const P=h.useMemo(()=>{if(!c.length)return"전체";const D=n.filter(S=>c.includes(S.key)).map(S=>S.empName||S.empId||S.key);return D.length<=2?D.join(", "):`${D.slice(0,2).join(", ")} 외 ${D.length-2}명`},[c,n]);return r.jsxs("section",{children:[r.jsxs("div",{className:"card",style:{padding:8,marginBottom:12,display:"flex",alignItems:"center",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[r.jsx("div",{className:"muted",children:"목표년도"}),r.jsx("select",{className:"search-input",value:e,onChange:G,"aria-label":"목표년도",style:{height:28},children:$.map(D=>r.jsxs("option",{value:String(D),children:[D,"년"]},D))})]}),r.jsxs("div",{ref:m,style:{position:"relative",display:"inline-flex",alignItems:"center",gap:8},children:[r.jsx("div",{className:"muted",children:"영업사원"}),r.jsxs("button",{type:"button",className:"search-input","aria-haspopup":"listbox","aria-expanded":u,onClick:()=>f(D=>!D),style:{height:28,minWidth:260,display:"inline-flex",alignItems:"center",justifyContent:"space-between",gap:8},children:[r.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:P}),r.jsx("span",{"aria-hidden":!0,children:"▾"})]}),u&&r.jsxs("div",{role:"listbox",className:"card",style:{position:"absolute",zIndex:60,top:"100%",left:0,width:380,maxHeight:260,overflow:"auto",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,padding:8,marginTop:6,fontSize:11},children:[r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 6px"},children:[r.jsx("input",{type:"checkbox",checked:c.length===n.length&&n.length>0,onChange:D=>U(D.target.checked)}),r.jsx("span",{children:"전체"})]}),a?r.jsx("div",{className:"muted",style:{padding:"6px 6px"},children:"불러오는 중…"}):n.length===0?r.jsx("div",{className:"muted",style:{padding:"6px 6px"},children:"목록이 없습니다"}):n.map(D=>{const S=c.includes(D.key),_=`${D.deptName||"-"} / ${D.empName||""}${D.empId?` (${D.empId})`:""}`;return r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 6px",cursor:"pointer"},children:[r.jsx("input",{type:"checkbox",checked:S,onChange:H=>I(D.key,H.target.checked)}),r.jsx("span",{children:_})]},D.key)}),o?r.jsx("div",{className:"error",style:{padding:"6px 6px"},children:o}):null]})]})]}),r.jsxs("div",{className:"card",style:{padding:8},children:[b?r.jsx("div",{className:"error",style:{marginBottom:8},children:b}):null,v?r.jsx("div",{className:"muted",style:{padding:"8px 6px"},children:"불러오는 중…"}):r.jsxs("div",{style:{display:"flex",alignItems:"stretch",gap:12},children:[r.jsxs("div",{style:{flex:"1 1 auto",display:"flex",flexDirection:"column",gap:6},children:[r.jsxs("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-between",margin:"0 2px"},children:[r.jsx("div",{className:"muted",style:{fontWeight:800},children:"회사 목표"}),r.jsx("div",{style:{fontWeight:800},children:Number.isFinite(T)?`${Number(T).toLocaleString(void 0,{maximumFractionDigits:1})} 억원`:"-"})]}),(()=>{let D=0,S=0,_,H=0,q;p.forEach(R=>{const oe=String((R==null?void 0:R.company_name)??(R==null?void 0:R.companyName)??"").toUpperCase(),Y=String((R==null?void 0:R.biz_area_name)??(R==null?void 0:R.bizAreaName)??""),X=Number((R==null?void 0:R.target_amount_max)??0),de=String((R==null?void 0:R.target_stage)??(R==null?void 0:R.targetStage)??"")||void 0;oe==="TNT"?(Y==="복층유리"&&Number.isFinite(X)?D+=X:Y==="건자재"&&Number.isFinite(X)&&(S+=X),de&&(_=de)):oe==="DYS"&&Y==="실란트"&&(Number.isFinite(X)&&(H+=X),de&&(q=de))});const K=[{company:"TNT",biz:"복층유리+건자재",max:D+S,stage:_},{company:"DYS",biz:"실란트",max:H,stage:q}];return r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:8},children:K.map((R,oe)=>{const Y=R.company,X=R.biz,de=R.max,be=R.stage||"";return r.jsx("div",{className:"card",style:{padding:8,border:"1px solid var(--border)",borderRadius:10,display:"flex",alignItems:"center",minHeight:92,position:"relative"},children:r.jsxs("div",{style:{flex:1},children:[be?r.jsx("div",{style:{position:"absolute",top:6,left:6},children:r.jsx("span",{className:"badge",style:{fontSize:8,padding:"0 4px",lineHeight:1.1,border:"1px solid var(--border)",borderRadius:6},children:be})}):null,Y==="TNT"&&X==="복층유리+건자재"?(()=>{try{let ke=0,ve=0;for(const J of p){const ge=String((J==null?void 0:J.company_name)??(J==null?void 0:J.companyName)??"").toUpperCase(),Pe=String((J==null?void 0:J.biz_area_name)??(J==null?void 0:J.bizAreaName)??""),Se=Number((J==null?void 0:J.target_amount_max)??0);ge==="TNT"&&Number.isFinite(Se)&&(Pe==="복층유리"?ke+=Se:Pe==="건자재"&&(ve+=Se))}const Ie=Number.isFinite(de)?Number(de):ke+ve;return r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,textAlign:"center"},children:[r.jsxs("div",{style:{fontWeight:800,fontSize:18,lineHeight:1.1},children:["TNT ",Ie.toLocaleString(void 0,{maximumFractionDigits:1}),"억원"]}),r.jsxs("div",{className:"muted",style:{fontSize:10,lineHeight:1.1},children:["(",`복층${ke.toLocaleString(void 0,{maximumFractionDigits:1})}억원+건자재${ve.toLocaleString(void 0,{maximumFractionDigits:1})}억원`,")"]})]})}catch{return r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,textAlign:"center"},children:[r.jsx("div",{style:{fontWeight:700,fontSize:11},children:"TNT"}),r.jsx("div",{className:"muted",style:{fontSize:11,lineHeight:1.1},children:"데이터 없음"})]})}})():r.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,textAlign:"center"},children:String(Y||"").toUpperCase()==="DYS"&&X==="실란트"?r.jsx(r.Fragment,{children:r.jsxs("div",{style:{fontWeight:800,fontSize:18,lineHeight:1.1},children:["DYS ",Number(de).toLocaleString(void 0,{maximumFractionDigits:1}),"억원"]})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontWeight:700,fontSize:11},children:X||"-"}),r.jsx("div",{style:{fontSize:11,fontWeight:800,lineHeight:1.1},children:Number.isFinite(de)?`${Number(de).toLocaleString(void 0,{maximumFractionDigits:1})} 억원`:"-"})]})})]})},oe)})})})()]}),r.jsx("div",{style:{flex:"0 0 auto",width:1,background:"var(--border)"}}),r.jsxs("aside",{style:{flex:"0 0 260px",maxWidth:320,paddingLeft:8,display:"flex",flexDirection:"column",justifyContent:"center"},children:[r.jsx("div",{style:{fontWeight:800,marginBottom:8},children:"목표수립 현황"}),r.jsx("div",{className:"card",style:{padding:10,border:"1px solid var(--border)",borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",minHeight:92},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,width:"100%"},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:r.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`TNT ${k.tnt.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})}),r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:r.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`DYS ${k.dys.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})})]})})]}),r.jsx("div",{style:{flex:"0 0 auto",width:1,background:"var(--border)"}}),r.jsxs("aside",{style:{flex:"0 0 260px",maxWidth:320,paddingLeft:8,display:"flex",flexDirection:"column",justifyContent:"center"},children:[r.jsx("div",{style:{fontWeight:800,marginBottom:8},children:"차액"}),r.jsx("div",{className:"card",style:{padding:10,border:"1px solid var(--border)",borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",minHeight:92},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,width:"100%"},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:r.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`TNT ${L.tnt.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})}),r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:r.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`DYS ${L.dys.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})})]})})]})]})]}),r.jsxs("div",{className:"card",style:{padding:8,marginTop:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[r.jsx("div",{style:{fontWeight:800},children:"고객수 요약"}),O?r.jsx("div",{className:"muted",style:{fontSize:12},children:"불러오는 중…"}):null]}),B?r.jsx("div",{className:"error",style:{marginBottom:8},children:B}):null,(()=>{const D=c.length?n.filter(_=>c.includes(_.key)):n,S=new Map;for(const _ of C){const H=String((_==null?void 0:_.assignee_id)||(_==null?void 0:_.emp_id)||"").trim();if(!H)continue;const q=S.get(H)||[];q.push(_),S.set(H,q)}return r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:10},children:D.map(_=>{const H=String(_.assigneeId||_.empId||_.key||""),q=S.get(H)||[],K=["TNT","DYS"],W=[...q].sort((R,oe)=>K.indexOf(String(R.company||"").toUpperCase())-K.indexOf(String(oe.company||"").toUpperCase()));return r.jsxs("div",{className:"card",style:{padding:10,border:"1px solid var(--border)",borderRadius:10},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[r.jsxs("div",{style:{fontWeight:700},children:[_.deptName||"-"," / ",_.empName||_.empId||_.key]}),r.jsxs("div",{className:"muted",style:{fontSize:11},children:[e,"년"]})]}),W.length===0?r.jsx("div",{className:"muted",style:{fontSize:12},children:"데이터가 없습니다"}):r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:8},children:W.map((R,oe)=>r.jsxs("div",{className:"card",style:{padding:8,border:"1px solid var(--border)",borderRadius:8,minHeight:92,display:"flex",flexDirection:"column",justifyContent:"center"},children:[r.jsx("div",{style:{fontWeight:700,marginBottom:6},children:String(R.company||"").toUpperCase()}),r.jsxs("div",{style:{display:"flex",gap:16,fontSize:12,justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[r.jsx("span",{className:"muted",children:"수립대상"}),r.jsx("strong",{children:Number(R.total_customers||0).toLocaleString()})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[r.jsx("span",{className:"muted",children:"확정"}),r.jsx("strong",{children:Number(R.confirmed_customers||0).toLocaleString()})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[r.jsx("span",{className:"muted",children:"진행 중"}),r.jsx("strong",{children:Number(R.planning_customers||0).toLocaleString()})]})]})]},oe))})]},H)})})})()]})]})}function n2(){return r.jsxs("section",{children:[r.jsx("h1",{children:"매출관리"}),r.jsx("div",{className:"empty-state",children:"초기 스켈레톤: 매출관리 화면"})]})}const Tm="http://220.73.213.73/Angkor.Ylw.Common.HttpExecute/RestOutsideService.svc/OpenApi/IsStoredProcedure/tnt_SWAPISLCustCreditListInfo",r2={certId:"TNT_CRM",certKey:"9836164F-3601-4DBB-9D6D-54685CD89B95",dsn:"tnt_bis",dsnOper:"tnt_oper",securityType:0,CompanySeq:1},Yc=[20,50,100],Lr=e=>new Intl.NumberFormat("ko-KR",{maximumFractionDigits:0}).format(Math.round(e||0)),i2=e=>{const t=n=>{const i=Number(n);return Number.isFinite(i)?i:0};return{CustName:String(e.CustName??""),CustNo:String(e.CustNo??""),CustSeq:String(e.CustSeq??""),IsCreditCheck:e.IsCreditCheck==="Y"?"Y":e.IsCreditCheck==="N"?"N":"",CurrName:String(e.CurrName??""),PrevCreditAmt:t(e.PrevCreditAmt),SalesAmt:t(e.SalesAmt),SalesVat:t(e.SalesVat),TotSalesAmt:t(e.TotSalesAmt),ReceiptAmt:t(e.ReceiptAmt),NoReceiptAmt:t(e.NoReceiptAmt)}},a2=({stdDate:e,custSeq:t,empSeq:n,pageNo:i,pageSize:a})=>({ROOT:{...r2,data:{ROOT:{DataBlock1:{StdDate:e.replace(/-/g,""),CustSeq:t.trim()?Number(t):"",EmpSeq:n.trim()?Number(n):"",SMQryType:1078004,IncludeMiNote:1,PAGE_NO:i,PAGE_SIZE:a}}}}});function s2(){const e=new Date().toISOString().slice(0,10),[t,n]=h.useState({stdDate:e,custSeq:"",empSeq:""}),[i,a]=h.useState(t),[s,o]=h.useState(1),[l,c]=h.useState(Yc[0]),[d,u]=h.useState([]),[f,m]=h.useState({PAGE_NO:1,PAGE_SIZE:Yc[0],TotalData:0,TotalPage:0}),[p,y]=h.useState(!1),[v,g]=h.useState(null),[b,x]=h.useState(null),[N,A]=h.useState(null),[C,w]=h.useState(!1),[O,M]=h.useState(null),B=($,V)=>{n(G=>({...G,[$]:V}))},z=()=>{a(t),o(1)},j=$=>{c($),o(1)},k=$=>{o(V=>$==="next"?f.TotalPage&&V>=f.TotalPage?V:V+1:Math.max(1,V-1))},L=h.useMemo(()=>d.reduce(($,V)=>($.sales+=V.SalesAmt,$.receipt+=V.ReceiptAmt,$.noReceipt+=V.NoReceiptAmt,$),{sales:0,receipt:0,noReceipt:0}),[d]),T=h.useCallback(async()=>{y(!0),g(null);try{const $=a2({stdDate:i.stdDate,custSeq:i.custSeq,empSeq:i.empSeq,pageNo:s,pageSize:l}),V=JSON.stringify($,null,2);A(V),w(!0);const G=await fetch(Tm,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify($)});if(!G.ok)throw new Error(`서버 응답이 존재하지 않거나 상태값 ${G.status}`);const ne=await G.json(),U=ne==null?void 0:ne.ROOT,I=U==null?void 0:U.ReturnCode;if(I!=="0000"){const S=`ReturnCode: ${I??"N/A"}${U!=null&&U.ReturnMessage?` • ${U.ReturnMessage}`:""}`;throw M(S),new Error((U==null?void 0:U.ReturnMessage)??"데이터를 불러오는 데 실패했습니다.")}M(`ReturnCode: ${I??"N/A"}${U!=null&&U.ReturnMessage?` • ${U.ReturnMessage}`:""}`);const P=Array.isArray(U==null?void 0:U.DataBlock1)?U.DataBlock1:[];u(P.map(i2));const D=Array.isArray(U==null?void 0:U.DataBlock2)?U.DataBlock2[0]:null;m(D?{PAGE_NO:Number(D.PAGE_NO??s),PAGE_SIZE:Number(D.PAGE_SIZE??l),TotalData:Number(D.TotalData??P.length),TotalPage:Number(D.TotalPage??0)}:S=>({...S,PAGE_NO:s,PAGE_SIZE:l,TotalData:P.length,TotalPage:Math.max(1,Math.ceil(P.length/l))})),x(new Date().toLocaleString())}catch($){g($.message??"데이터를 불러오는 중 알 수 없는 오류가 발생했습니다."),u([])}finally{y(!1)}},[i,s,l]);return h.useEffect(()=>{T()},[T]),r.jsxs("section",{className:"receivables-page",children:[r.jsxs("div",{className:"page-title",children:[r.jsx("h1",{children:"미수현황"}),r.jsx("p",{children:"기준일/필터를 설정하고 서버에서 고객 미수/판매/수금 데이터를 조회하세요."})]}),r.jsxs("div",{className:"filters-grid",children:[r.jsxs("label",{className:"field",children:[r.jsx("span",{children:"기준일"}),r.jsx("input",{type:"date",value:t.stdDate,onChange:$=>B("stdDate",$.target.value),className:"search-input"})]}),r.jsxs("label",{className:"field",children:[r.jsx("span",{children:"거래처 코드(CustSeq)"}),r.jsx("input",{type:"number",placeholder:"전체",value:t.custSeq,min:0,onChange:$=>B("custSeq",$.target.value),className:"search-input"})]}),r.jsxs("label",{className:"field",children:[r.jsx("span",{children:"사원 코드(EmpSeq)"}),r.jsx("input",{type:"number",placeholder:"전체",value:t.empSeq,min:0,onChange:$=>B("empSeq",$.target.value),className:"search-input"})]}),r.jsxs("label",{className:"field",children:[r.jsx("span",{children:"페이지 크기"}),r.jsx("select",{value:l,onChange:$=>j(Number($.target.value)),className:"search-input",children:Yc.map($=>r.jsxs("option",{value:$,children:[$,"개"]},$))})]}),r.jsxs("div",{className:"field actions",children:[r.jsx("button",{type:"button",className:"btn",onClick:z,disabled:p,children:"조회하기"}),r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>o(1),disabled:s===1,children:"첫 페이지"}),r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>N&&w(!0),disabled:!N,children:"최근 전문 보기"})]})]}),r.jsxs("div",{className:"summary-cards",children:[r.jsxs("article",{className:"summary-card",children:[r.jsxs("div",{children:[r.jsx("p",{className:"muted",children:"총 데이터"}),r.jsxs("strong",{children:[f.TotalData.toLocaleString(),"건"]})]}),r.jsxs("span",{className:"muted",children:[f.PAGE_NO," / ",Math.max(1,f.TotalPage)," 페이지"]})]}),r.jsxs("article",{className:"summary-card",children:[r.jsxs("div",{children:[r.jsx("p",{className:"muted",children:"금월 판매"}),r.jsxs("strong",{children:[Lr(L.sales)," 원"]})]}),r.jsx("span",{className:"muted",children:"합계"})]}),r.jsxs("article",{className:"summary-card",children:[r.jsxs("div",{children:[r.jsx("p",{className:"muted",children:"금월 수금"}),r.jsxs("strong",{children:[Lr(L.receipt)," 원"]})]}),r.jsx("span",{className:"muted",children:"합계"})]}),r.jsxs("article",{className:"summary-card highlight",children:[r.jsxs("div",{children:[r.jsx("p",{className:"muted",children:"현미수액"}),r.jsxs("strong",{children:[Lr(L.noReceipt)," 원"]})]}),r.jsx("span",{className:"muted",children:"수금과 대비"})]})]}),r.jsxs("div",{className:"table-panel",children:[r.jsxs("div",{className:"table-panel-header",children:[r.jsx("div",{children:r.jsxs("p",{className:"muted",children:["마지막 업데이트: ",b??"—"]})}),r.jsxs("div",{className:"pagination-controls",children:[r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>k("prev"),disabled:s===1,children:"이전"}),r.jsxs("span",{children:[s," page / ",Math.max(1,f.TotalPage)," page"]}),r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>k("next"),disabled:f.TotalPage>0?s>=f.TotalPage:d.length<l,children:"다음"})]})]}),v&&r.jsx("div",{className:"empty-state",children:v}),r.jsx("div",{className:"table-container receivables-table",children:r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"거래처 코드"}),r.jsx("th",{children:"거래처명"}),r.jsx("th",{children:"통화"}),r.jsx("th",{children:"전월이월"}),r.jsx("th",{children:"금월판매"}),r.jsx("th",{children:"부가세"}),r.jsx("th",{children:"금월판매계"}),r.jsx("th",{children:"금월수금"}),r.jsx("th",{children:"현미수액"}),r.jsx("th",{children:"미수 여부"})]})}),r.jsx("tbody",{children:p?r.jsx("tr",{children:r.jsx("td",{colSpan:10,children:r.jsx("div",{className:"empty-state",children:"데이터를 불러오는 중입니다…"})})}):d.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:10,children:r.jsx("div",{className:"empty-state",children:"조회 결과가 없습니다."})})}):d.map($=>r.jsxs("tr",{children:[r.jsx("td",{children:$.CustSeq}),r.jsx("td",{children:$.CustName}),r.jsx("td",{children:$.CurrName}),r.jsxs("td",{children:[Lr($.PrevCreditAmt)," 원"]}),r.jsxs("td",{children:[Lr($.SalesAmt)," 원"]}),r.jsxs("td",{children:[Lr($.SalesVat)," 원"]}),r.jsxs("td",{children:[Lr($.TotSalesAmt)," 원"]}),r.jsxs("td",{children:[Lr($.ReceiptAmt)," 원"]}),r.jsxs("td",{className:"highlight-cell",children:[Lr($.NoReceiptAmt)," 원"]}),r.jsx("td",{children:$.IsCreditCheck||"N"})]},`${$.CustSeq}-${$.CustNo}`))})]})})]}),C&&N?r.jsx("div",{className:"json-modal-backdrop",role:"dialog","aria-modal":"true",children:r.jsxs("div",{className:"json-modal",children:[r.jsx("div",{className:"json-modal-header",children:r.jsx("strong",{children:"직전 요청 전문"})}),r.jsxs("p",{className:"muted",style:{fontSize:12},children:["요청 URL: ",Tm]}),r.jsx("pre",{children:N}),O?r.jsx("p",{className:"muted",style:{wordBreak:"break-all"},children:O}):null,r.jsx("div",{className:"json-modal-actions",children:r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>w(!1),children:"닫기"})})]})}):null]})}const o2="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3ccircle%20cx='12'%20cy='12'%20r='10'/%3e%3ccircle%20cx='12'%20cy='12'%20r='6'/%3e%3ccircle%20cx='12'%20cy='12'%20r='2'/%3e%3c/svg%3e",l2="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='20'%20height='20'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M12%203L14%208L19%2010L14%2012L12%2017L10%2012L5%2010L10%208L12%203Z'/%3e%3cpath%20d='M19%204L19.5%205.5L21%206L19.5%206.5L19%208L18.5%206.5L17%206L18.5%205.5L19%204Z'/%3e%3cpath%20d='M19%2016L19.5%2017.5L21%2018L19.5%2018.5L19%2020L18.5%2018.5L17%2018L18.5%2017.5L19%2016Z'/%3e%3c/svg%3e";function c2(e,t){const n={};return(e[e.length-1]===""?[...e,""]:e).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const u2=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,d2=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,f2={};function Om(e,t){return(f2.jsx?d2:u2).test(e)}const h2=/[ \t\n\f\r]/g;function m2(e){return typeof e=="object"?e.type==="text"?Dm(e.value):!1:Dm(e)}function Dm(e){return e.replace(h2,"")===""}class ws{constructor(t,n,i){this.normal=n,this.property=t,i&&(this.space=i)}}ws.prototype.normal={};ws.prototype.property={};ws.prototype.space=void 0;function _v(e,t){const n={},i={};for(const a of e)Object.assign(n,a.property),Object.assign(i,a.normal);return new ws(n,i,t)}function Tu(e){return e.toLowerCase()}class Ln{constructor(t,n){this.attribute=n,this.property=t}}Ln.prototype.attribute="";Ln.prototype.booleanish=!1;Ln.prototype.boolean=!1;Ln.prototype.commaOrSpaceSeparated=!1;Ln.prototype.commaSeparated=!1;Ln.prototype.defined=!1;Ln.prototype.mustUseProperty=!1;Ln.prototype.number=!1;Ln.prototype.overloadedBoolean=!1;Ln.prototype.property="";Ln.prototype.spaceSeparated=!1;Ln.prototype.space=void 0;let p2=0;const et=Ki(),Gt=Ki(),Ou=Ki(),Ee=Ki(),wt=Ki(),fa=Ki(),Bn=Ki();function Ki(){return 2**++p2}const Du=Object.freeze(Object.defineProperty({__proto__:null,boolean:et,booleanish:Gt,commaOrSpaceSeparated:Bn,commaSeparated:fa,number:Ee,overloadedBoolean:Ou,spaceSeparated:wt},Symbol.toStringTag,{value:"Module"})),Kc=Object.keys(Du);class Fd extends Ln{constructor(t,n,i,a){let s=-1;if(super(t,n),_m(this,"space",a),typeof i=="number")for(;++s<Kc.length;){const o=Kc[s];_m(this,Kc[s],(i&Du[o])===Du[o])}}}Fd.prototype.defined=!0;function _m(e,t,n){n&&(e[t]=n)}function Sa(e){const t={},n={};for(const[i,a]of Object.entries(e.properties)){const s=new Fd(i,e.transform(e.attributes||{},i),a,e.space);e.mustUseProperty&&e.mustUseProperty.includes(i)&&(s.mustUseProperty=!0),t[i]=s,n[Tu(i)]=i,n[Tu(s.attribute)]=i}return new ws(t,n,e.space)}const Mv=Sa({properties:{ariaActiveDescendant:null,ariaAtomic:Gt,ariaAutoComplete:null,ariaBusy:Gt,ariaChecked:Gt,ariaColCount:Ee,ariaColIndex:Ee,ariaColSpan:Ee,ariaControls:wt,ariaCurrent:null,ariaDescribedBy:wt,ariaDetails:null,ariaDisabled:Gt,ariaDropEffect:wt,ariaErrorMessage:null,ariaExpanded:Gt,ariaFlowTo:wt,ariaGrabbed:Gt,ariaHasPopup:null,ariaHidden:Gt,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:wt,ariaLevel:Ee,ariaLive:null,ariaModal:Gt,ariaMultiLine:Gt,ariaMultiSelectable:Gt,ariaOrientation:null,ariaOwns:wt,ariaPlaceholder:null,ariaPosInSet:Ee,ariaPressed:Gt,ariaReadOnly:Gt,ariaRelevant:null,ariaRequired:Gt,ariaRoleDescription:wt,ariaRowCount:Ee,ariaRowIndex:Ee,ariaRowSpan:Ee,ariaSelected:Gt,ariaSetSize:Ee,ariaSort:null,ariaValueMax:Ee,ariaValueMin:Ee,ariaValueNow:Ee,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function Lv(e,t){return t in e?e[t]:t}function $v(e,t){return Lv(e,t.toLowerCase())}const g2=Sa({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:fa,acceptCharset:wt,accessKey:wt,action:null,allow:null,allowFullScreen:et,allowPaymentRequest:et,allowUserMedia:et,alt:null,as:null,async:et,autoCapitalize:null,autoComplete:wt,autoFocus:et,autoPlay:et,blocking:wt,capture:null,charSet:null,checked:et,cite:null,className:wt,cols:Ee,colSpan:null,content:null,contentEditable:Gt,controls:et,controlsList:wt,coords:Ee|fa,crossOrigin:null,data:null,dateTime:null,decoding:null,default:et,defer:et,dir:null,dirName:null,disabled:et,download:Ou,draggable:Gt,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:et,formTarget:null,headers:wt,height:Ee,hidden:Ou,high:Ee,href:null,hrefLang:null,htmlFor:wt,httpEquiv:wt,id:null,imageSizes:null,imageSrcSet:null,inert:et,inputMode:null,integrity:null,is:null,isMap:et,itemId:null,itemProp:wt,itemRef:wt,itemScope:et,itemType:wt,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:et,low:Ee,manifest:null,max:null,maxLength:Ee,media:null,method:null,min:null,minLength:Ee,multiple:et,muted:et,name:null,nonce:null,noModule:et,noValidate:et,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:et,optimum:Ee,pattern:null,ping:wt,placeholder:null,playsInline:et,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:et,referrerPolicy:null,rel:wt,required:et,reversed:et,rows:Ee,rowSpan:Ee,sandbox:wt,scope:null,scoped:et,seamless:et,selected:et,shadowRootClonable:et,shadowRootDelegatesFocus:et,shadowRootMode:null,shape:null,size:Ee,sizes:null,slot:null,span:Ee,spellCheck:Gt,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Ee,step:null,style:null,tabIndex:Ee,target:null,title:null,translate:null,type:null,typeMustMatch:et,useMap:null,value:Gt,width:Ee,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:wt,axis:null,background:null,bgColor:null,border:Ee,borderColor:null,bottomMargin:Ee,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:et,declare:et,event:null,face:null,frame:null,frameBorder:null,hSpace:Ee,leftMargin:Ee,link:null,longDesc:null,lowSrc:null,marginHeight:Ee,marginWidth:Ee,noResize:et,noHref:et,noShade:et,noWrap:et,object:null,profile:null,prompt:null,rev:null,rightMargin:Ee,rules:null,scheme:null,scrolling:Gt,standby:null,summary:null,text:null,topMargin:Ee,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Ee,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:et,disableRemotePlayback:et,prefix:null,property:null,results:Ee,security:null,unselectable:null},space:"html",transform:$v}),y2=Sa({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Bn,accentHeight:Ee,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Ee,amplitude:Ee,arabicForm:null,ascent:Ee,attributeName:null,attributeType:null,azimuth:Ee,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Ee,by:null,calcMode:null,capHeight:Ee,className:wt,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Ee,diffuseConstant:Ee,direction:null,display:null,dur:null,divisor:Ee,dominantBaseline:null,download:et,dx:null,dy:null,edgeMode:null,editable:null,elevation:Ee,enableBackground:null,end:null,event:null,exponent:Ee,externalResourcesRequired:null,fill:null,fillOpacity:Ee,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:fa,g2:fa,glyphName:fa,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Ee,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Ee,horizOriginX:Ee,horizOriginY:Ee,id:null,ideographic:Ee,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Ee,k:Ee,k1:Ee,k2:Ee,k3:Ee,k4:Ee,kernelMatrix:Bn,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Ee,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Ee,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Ee,overlineThickness:Ee,paintOrder:null,panose1:null,path:null,pathLength:Ee,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:wt,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Ee,pointsAtY:Ee,pointsAtZ:Ee,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Bn,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Bn,rev:Bn,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Bn,requiredFeatures:Bn,requiredFonts:Bn,requiredFormats:Bn,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Ee,specularExponent:Ee,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Ee,strikethroughThickness:Ee,string:null,stroke:null,strokeDashArray:Bn,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Ee,strokeOpacity:Ee,strokeWidth:null,style:null,surfaceScale:Ee,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Bn,tabIndex:Ee,tableValues:null,target:null,targetX:Ee,targetY:Ee,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Bn,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Ee,underlineThickness:Ee,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Ee,values:null,vAlphabetic:Ee,vMathematical:Ee,vectorEffect:null,vHanging:Ee,vIdeographic:Ee,version:null,vertAdvY:Ee,vertOriginX:Ee,vertOriginY:Ee,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Ee,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:Lv}),zv=Sa({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),Rv=Sa({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:$v}),Bv=Sa({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),v2={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},x2=/[A-Z]/g,Mm=/-[a-z]/g,b2=/^data[-\w.:]+$/i;function j2(e,t){const n=Tu(t);let i=t,a=Ln;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&b2.test(t)){if(t.charAt(4)==="-"){const s=t.slice(5).replace(Mm,S2);i="data"+s.charAt(0).toUpperCase()+s.slice(1)}else{const s=t.slice(4);if(!Mm.test(s)){let o=s.replace(x2,w2);o.charAt(0)!=="-"&&(o="-"+o),t="data"+o}}a=Fd}return new a(i,t)}function w2(e){return"-"+e.toLowerCase()}function S2(e){return e.charAt(1).toUpperCase()}const N2=_v([Mv,g2,zv,Rv,Bv],"html"),qd=_v([Mv,y2,zv,Rv,Bv],"svg");function k2(e){return e.join(" ").trim()}var Ud={},Lm=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,A2=/\n/g,C2=/^\s*/,E2=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,I2=/^:\s*/,P2=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,T2=/^[;\s]*/,O2=/^\s+|\s+$/g,D2=`
`,$m="/",zm="*",Ii="",_2="comment",M2="declaration";function L2(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var n=1,i=1;function a(y){var v=y.match(A2);v&&(n+=v.length);var g=y.lastIndexOf(D2);i=~g?y.length-g:i+y.length}function s(){var y={line:n,column:i};return function(v){return v.position=new o(y),d(),v}}function o(y){this.start=y,this.end={line:n,column:i},this.source=t.source}o.prototype.content=e;function l(y){var v=new Error(t.source+":"+n+":"+i+": "+y);if(v.reason=y,v.filename=t.source,v.line=n,v.column=i,v.source=e,!t.silent)throw v}function c(y){var v=y.exec(e);if(v){var g=v[0];return a(g),e=e.slice(g.length),v}}function d(){c(C2)}function u(y){var v;for(y=y||[];v=f();)v!==!1&&y.push(v);return y}function f(){var y=s();if(!($m!=e.charAt(0)||zm!=e.charAt(1))){for(var v=2;Ii!=e.charAt(v)&&(zm!=e.charAt(v)||$m!=e.charAt(v+1));)++v;if(v+=2,Ii===e.charAt(v-1))return l("End of comment missing");var g=e.slice(2,v-2);return i+=2,a(g),e=e.slice(v),i+=2,y({type:_2,comment:g})}}function m(){var y=s(),v=c(E2);if(v){if(f(),!c(I2))return l("property missing ':'");var g=c(P2),b=y({type:M2,property:Rm(v[0].replace(Lm,Ii)),value:g?Rm(g[0].replace(Lm,Ii)):Ii});return c(T2),b}}function p(){var y=[];u(y);for(var v;v=m();)v!==!1&&(y.push(v),u(y));return y}return d(),p()}function Rm(e){return e?e.replace(O2,Ii):Ii}var $2=L2,z2=Oo&&Oo.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ud,"__esModule",{value:!0});Ud.default=B2;const R2=z2($2);function B2(e,t){let n=null;if(!e||typeof e!="string")return n;const i=(0,R2.default)(e),a=typeof t=="function";return i.forEach(s=>{if(s.type!=="declaration")return;const{property:o,value:l}=s;a?t(o,l,s):l&&(n=n||{},n[o]=l)}),n}var Pl={};Object.defineProperty(Pl,"__esModule",{value:!0});Pl.camelCase=void 0;var W2=/^--[a-zA-Z0-9_-]+$/,F2=/-([a-z])/g,q2=/^[^-]+$/,U2=/^-(webkit|moz|ms|o|khtml)-/,H2=/^-(ms)-/,Y2=function(e){return!e||q2.test(e)||W2.test(e)},K2=function(e,t){return t.toUpperCase()},Bm=function(e,t){return"".concat(t,"-")},V2=function(e,t){return t===void 0&&(t={}),Y2(e)?e:(e=e.toLowerCase(),t.reactCompat?e=e.replace(H2,Bm):e=e.replace(U2,Bm),e.replace(F2,K2))};Pl.camelCase=V2;var X2=Oo&&Oo.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},G2=X2(Ud),Q2=Pl;function _u(e,t){var n={};return!e||typeof e!="string"||(0,G2.default)(e,function(i,a){i&&a&&(n[(0,Q2.camelCase)(i,t)]=a)}),n}_u.default=_u;var J2=_u;const Z2=Pr(J2),Wv=Fv("end"),Hd=Fv("start");function Fv(e){return t;function t(n){const i=n&&n.position&&n.position[e]||{};if(typeof i.line=="number"&&i.line>0&&typeof i.column=="number"&&i.column>0)return{line:i.line,column:i.column,offset:typeof i.offset=="number"&&i.offset>-1?i.offset:void 0}}}function ek(e){const t=Hd(e),n=Wv(e);if(t&&n)return{start:t,end:n}}function is(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?Wm(e.position):"start"in e||"end"in e?Wm(e):"line"in e||"column"in e?Mu(e):""}function Mu(e){return Fm(e&&e.line)+":"+Fm(e&&e.column)}function Wm(e){return Mu(e&&e.start)+"-"+Mu(e&&e.end)}function Fm(e){return e&&typeof e=="number"?e:1}class Nn extends Error{constructor(t,n,i){super(),typeof n=="string"&&(i=n,n=void 0);let a="",s={},o=!1;if(n&&("line"in n&&"column"in n?s={place:n}:"start"in n&&"end"in n?s={place:n}:"type"in n?s={ancestors:[n],place:n.position}:s={...n}),typeof t=="string"?a=t:!s.cause&&t&&(o=!0,a=t.message,s.cause=t),!s.ruleId&&!s.source&&typeof i=="string"){const c=i.indexOf(":");c===-1?s.ruleId=i:(s.source=i.slice(0,c),s.ruleId=i.slice(c+1))}if(!s.place&&s.ancestors&&s.ancestors){const c=s.ancestors[s.ancestors.length-1];c&&(s.place=c.position)}const l=s.place&&"start"in s.place?s.place.start:s.place;this.ancestors=s.ancestors||void 0,this.cause=s.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file="",this.message=a,this.line=l?l.line:void 0,this.name=is(s.place)||"1:1",this.place=s.place||void 0,this.reason=this.message,this.ruleId=s.ruleId||void 0,this.source=s.source||void 0,this.stack=o&&s.cause&&typeof s.cause.stack=="string"?s.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}Nn.prototype.file="";Nn.prototype.name="";Nn.prototype.reason="";Nn.prototype.message="";Nn.prototype.stack="";Nn.prototype.column=void 0;Nn.prototype.line=void 0;Nn.prototype.ancestors=void 0;Nn.prototype.cause=void 0;Nn.prototype.fatal=void 0;Nn.prototype.place=void 0;Nn.prototype.ruleId=void 0;Nn.prototype.source=void 0;const Yd={}.hasOwnProperty,tk=new Map,nk=/[A-Z]/g,rk=new Set(["table","tbody","thead","tfoot","tr"]),ik=new Set(["td","th"]),qv="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function ak(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let i;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");i=hk(n,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");i=fk(n,t.jsx,t.jsxs)}const a={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:i,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?qd:N2,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},s=Uv(a,e,void 0);return s&&typeof s!="string"?s:a.create(e,a.Fragment,{children:s||void 0},void 0)}function Uv(e,t,n){if(t.type==="element")return sk(e,t,n);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return ok(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return ck(e,t,n);if(t.type==="mdxjsEsm")return lk(e,t);if(t.type==="root")return uk(e,t,n);if(t.type==="text")return dk(e,t)}function sk(e,t,n){const i=e.schema;let a=i;t.tagName.toLowerCase()==="svg"&&i.space==="html"&&(a=qd,e.schema=a),e.ancestors.push(t);const s=Yv(e,t.tagName,!1),o=mk(e,t);let l=Vd(e,t);return rk.has(t.tagName)&&(l=l.filter(function(c){return typeof c=="string"?!m2(c):!0})),Hv(e,o,s,t),Kd(o,l),e.ancestors.pop(),e.schema=i,e.create(t,s,o,n)}function ok(e,t){if(t.data&&t.data.estree&&e.evaluater){const i=t.data.estree.body[0];return i.type,e.evaluater.evaluateExpression(i.expression)}cs(e,t.position)}function lk(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);cs(e,t.position)}function ck(e,t,n){const i=e.schema;let a=i;t.name==="svg"&&i.space==="html"&&(a=qd,e.schema=a),e.ancestors.push(t);const s=t.name===null?e.Fragment:Yv(e,t.name,!0),o=pk(e,t),l=Vd(e,t);return Hv(e,o,s,t),Kd(o,l),e.ancestors.pop(),e.schema=i,e.create(t,s,o,n)}function uk(e,t,n){const i={};return Kd(i,Vd(e,t)),e.create(t,e.Fragment,i,n)}function dk(e,t){return t.value}function Hv(e,t,n,i){typeof n!="string"&&n!==e.Fragment&&e.passNode&&(t.node=i)}function Kd(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function fk(e,t,n){return i;function i(a,s,o,l){const d=Array.isArray(o.children)?n:t;return l?d(s,o,l):d(s,o)}}function hk(e,t){return n;function n(i,a,s,o){const l=Array.isArray(s.children),c=Hd(i);return t(a,s,o,l,{columnNumber:c?c.column-1:void 0,fileName:e,lineNumber:c?c.line:void 0},void 0)}}function mk(e,t){const n={};let i,a;for(a in t.properties)if(a!=="children"&&Yd.call(t.properties,a)){const s=gk(e,a,t.properties[a]);if(s){const[o,l]=s;e.tableCellAlignToStyle&&o==="align"&&typeof l=="string"&&ik.has(t.tagName)?i=l:n[o]=l}}if(i){const s=n.style||(n.style={});s[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=i}return n}function pk(e,t){const n={};for(const i of t.attributes)if(i.type==="mdxJsxExpressionAttribute")if(i.data&&i.data.estree&&e.evaluater){const s=i.data.estree.body[0];s.type;const o=s.expression;o.type;const l=o.properties[0];l.type,Object.assign(n,e.evaluater.evaluateExpression(l.argument))}else cs(e,t.position);else{const a=i.name;let s;if(i.value&&typeof i.value=="object")if(i.value.data&&i.value.data.estree&&e.evaluater){const l=i.value.data.estree.body[0];l.type,s=e.evaluater.evaluateExpression(l.expression)}else cs(e,t.position);else s=i.value===null?!0:i.value;n[a]=s}return n}function Vd(e,t){const n=[];let i=-1;const a=e.passKeys?new Map:tk;for(;++i<t.children.length;){const s=t.children[i];let o;if(e.passKeys){const c=s.type==="element"?s.tagName:s.type==="mdxJsxFlowElement"||s.type==="mdxJsxTextElement"?s.name:void 0;if(c){const d=a.get(c)||0;o=c+"-"+d,a.set(c,d+1)}}const l=Uv(e,s,o);l!==void 0&&n.push(l)}return n}function gk(e,t,n){const i=j2(e.schema,t);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=i.commaSeparated?c2(n):k2(n)),i.property==="style"){let a=typeof n=="object"?n:yk(e,String(n));return e.stylePropertyNameCase==="css"&&(a=vk(a)),["style",a]}return[e.elementAttributeNameCase==="react"&&i.space?v2[i.property]||i.property:i.attribute,n]}}function yk(e,t){try{return Z2(t,{reactCompat:!0})}catch(n){if(e.ignoreInvalidStyle)return{};const i=n,a=new Nn("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:i,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw a.file=e.filePath||void 0,a.url=qv+"#cannot-parse-style-attribute",a}}function Yv(e,t,n){let i;if(!n)i={type:"Literal",value:t};else if(t.includes(".")){const a=t.split(".");let s=-1,o;for(;++s<a.length;){const l=Om(a[s])?{type:"Identifier",name:a[s]}:{type:"Literal",value:a[s]};o=o?{type:"MemberExpression",object:o,property:l,computed:!!(s&&l.type==="Literal"),optional:!1}:l}i=o}else i=Om(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(i.type==="Literal"){const a=i.value;return Yd.call(e.components,a)?e.components[a]:a}if(e.evaluater)return e.evaluater.evaluateExpression(i);cs(e)}function cs(e,t){const n=new Nn("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=qv+"#cannot-handle-mdx-estrees-without-createevaluater",n}function vk(e){const t={};let n;for(n in e)Yd.call(e,n)&&(t[xk(n)]=e[n]);return t}function xk(e){let t=e.replace(nk,bk);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function bk(e){return"-"+e.toLowerCase()}const Vc={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},jk={};function wk(e,t){const n=jk,i=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,a=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return Kv(e,i,a)}function Kv(e,t,n){if(Sk(e)){if("value"in e)return e.type==="html"&&!n?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return qm(e.children,t,n)}return Array.isArray(e)?qm(e,t,n):""}function qm(e,t,n){const i=[];let a=-1;for(;++a<e.length;)i[a]=Kv(e[a],t,n);return i.join("")}function Sk(e){return!!(e&&typeof e=="object")}const Um=document.createElement("i");function Xd(e){const t="&"+e+";";Um.innerHTML=t;const n=Um.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function Ar(e,t,n,i){const a=e.length;let s=0,o;if(t<0?t=-t>a?0:a+t:t=t>a?a:t,n=n>0?n:0,i.length<1e4)o=Array.from(i),o.unshift(t,n),e.splice(...o);else for(n&&e.splice(t,n);s<i.length;)o=i.slice(s,s+1e4),o.unshift(t,0),e.splice(...o),s+=1e4,t+=1e4}function tr(e,t){return e.length>0?(Ar(e,e.length,0,t),e):t}const Hm={}.hasOwnProperty;function Nk(e){const t={};let n=-1;for(;++n<e.length;)kk(t,e[n]);return t}function kk(e,t){let n;for(n in t){const a=(Hm.call(e,n)?e[n]:void 0)||(e[n]={}),s=t[n];let o;if(s)for(o in s){Hm.call(a,o)||(a[o]=[]);const l=s[o];Ak(a[o],Array.isArray(l)?l:l?[l]:[])}}}function Ak(e,t){let n=-1;const i=[];for(;++n<t.length;)(t[n].add==="after"?e:i).push(t[n]);Ar(e,0,0,i)}function Vv(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"�":String.fromCodePoint(n)}function ha(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const Sr=pi(/[A-Za-z]/),Hn=pi(/[\dA-Za-z]/),Ck=pi(/[#-'*+\--9=?A-Z^-~]/);function Lu(e){return e!==null&&(e<32||e===127)}const $u=pi(/\d/),Ek=pi(/[\dA-Fa-f]/),Ik=pi(/[!-/:-@[-`{-~]/);function Xe(e){return e!==null&&e<-2}function Mn(e){return e!==null&&(e<0||e===32)}function ct(e){return e===-2||e===-1||e===32}const Pk=pi(new RegExp("\\p{P}|\\p{S}","u")),Tk=pi(/\s/);function pi(e){return t;function t(n){return n!==null&&n>-1&&e.test(String.fromCharCode(n))}}function Na(e){const t=[];let n=-1,i=0,a=0;for(;++n<e.length;){const s=e.charCodeAt(n);let o="";if(s===37&&Hn(e.charCodeAt(n+1))&&Hn(e.charCodeAt(n+2)))a=2;else if(s<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(s))||(o=String.fromCharCode(s));else if(s>55295&&s<57344){const l=e.charCodeAt(n+1);s<56320&&l>56319&&l<57344?(o=String.fromCharCode(s,l),a=1):o="�"}else o=String.fromCharCode(s);o&&(t.push(e.slice(i,n),encodeURIComponent(o)),i=n+a+1,o=""),a&&(n+=a,a=0)}return t.join("")+e.slice(i)}function Nt(e,t,n,i){const a=i?i-1:Number.POSITIVE_INFINITY;let s=0;return o;function o(c){return ct(c)?(e.enter(n),l(c)):t(c)}function l(c){return ct(c)&&s++<a?(e.consume(c),l):(e.exit(n),t(c))}}const Ok={tokenize:Dk};function Dk(e){const t=e.attempt(this.parser.constructs.contentInitial,i,a);let n;return t;function i(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),Nt(e,t,"linePrefix")}function a(l){return e.enter("paragraph"),s(l)}function s(l){const c=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=c),n=c,o(l)}function o(l){if(l===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(l);return}return Xe(l)?(e.consume(l),e.exit("chunkText"),s):(e.consume(l),o)}}const _k={tokenize:Mk},Ym={tokenize:Lk};function Mk(e){const t=this,n=[];let i=0,a,s,o;return l;function l(N){if(i<n.length){const A=n[i];return t.containerState=A[1],e.attempt(A[0].continuation,c,d)(N)}return d(N)}function c(N){if(i++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,a&&x();const A=t.events.length;let C=A,w;for(;C--;)if(t.events[C][0]==="exit"&&t.events[C][1].type==="chunkFlow"){w=t.events[C][1].end;break}b(i);let O=A;for(;O<t.events.length;)t.events[O][1].end={...w},O++;return Ar(t.events,C+1,0,t.events.slice(A)),t.events.length=O,d(N)}return l(N)}function d(N){if(i===n.length){if(!a)return m(N);if(a.currentConstruct&&a.currentConstruct.concrete)return y(N);t.interrupt=!!(a.currentConstruct&&!a._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(Ym,u,f)(N)}function u(N){return a&&x(),b(i),m(N)}function f(N){return t.parser.lazy[t.now().line]=i!==n.length,o=t.now().offset,y(N)}function m(N){return t.containerState={},e.attempt(Ym,p,y)(N)}function p(N){return i++,n.push([t.currentConstruct,t.containerState]),m(N)}function y(N){if(N===null){a&&x(),b(0),e.consume(N);return}return a=a||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:a,contentType:"flow",previous:s}),v(N)}function v(N){if(N===null){g(e.exit("chunkFlow"),!0),b(0),e.consume(N);return}return Xe(N)?(e.consume(N),g(e.exit("chunkFlow")),i=0,t.interrupt=void 0,l):(e.consume(N),v)}function g(N,A){const C=t.sliceStream(N);if(A&&C.push(null),N.previous=s,s&&(s.next=N),s=N,a.defineSkip(N.start),a.write(C),t.parser.lazy[N.start.line]){let w=a.events.length;for(;w--;)if(a.events[w][1].start.offset<o&&(!a.events[w][1].end||a.events[w][1].end.offset>o))return;const O=t.events.length;let M=O,B,z;for(;M--;)if(t.events[M][0]==="exit"&&t.events[M][1].type==="chunkFlow"){if(B){z=t.events[M][1].end;break}B=!0}for(b(i),w=O;w<t.events.length;)t.events[w][1].end={...z},w++;Ar(t.events,M+1,0,t.events.slice(O)),t.events.length=w}}function b(N){let A=n.length;for(;A-- >N;){const C=n[A];t.containerState=C[1],C[0].exit.call(t,e)}n.length=N}function x(){a.write([null]),s=void 0,a=void 0,t.containerState._closeFlow=void 0}}function Lk(e,t,n){return Nt(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Km(e){if(e===null||Mn(e)||Tk(e))return 1;if(Pk(e))return 2}function Gd(e,t,n){const i=[];let a=-1;for(;++a<e.length;){const s=e[a].resolveAll;s&&!i.includes(s)&&(t=s(t,n),i.push(s))}return t}const zu={name:"attention",resolveAll:$k,tokenize:zk};function $k(e,t){let n=-1,i,a,s,o,l,c,d,u;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(i=n;i--;)if(e[i][0]==="exit"&&e[i][1].type==="attentionSequence"&&e[i][1]._open&&t.sliceSerialize(e[i][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[i][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[i][1].end.offset-e[i][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;c=e[i][1].end.offset-e[i][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const f={...e[i][1].end},m={...e[n][1].start};Vm(f,-c),Vm(m,c),o={type:c>1?"strongSequence":"emphasisSequence",start:f,end:{...e[i][1].end}},l={type:c>1?"strongSequence":"emphasisSequence",start:{...e[n][1].start},end:m},s={type:c>1?"strongText":"emphasisText",start:{...e[i][1].end},end:{...e[n][1].start}},a={type:c>1?"strong":"emphasis",start:{...o.start},end:{...l.end}},e[i][1].end={...o.start},e[n][1].start={...l.end},d=[],e[i][1].end.offset-e[i][1].start.offset&&(d=tr(d,[["enter",e[i][1],t],["exit",e[i][1],t]])),d=tr(d,[["enter",a,t],["enter",o,t],["exit",o,t],["enter",s,t]]),d=tr(d,Gd(t.parser.constructs.insideSpan.null,e.slice(i+1,n),t)),d=tr(d,[["exit",s,t],["enter",l,t],["exit",l,t],["exit",a,t]]),e[n][1].end.offset-e[n][1].start.offset?(u=2,d=tr(d,[["enter",e[n][1],t],["exit",e[n][1],t]])):u=0,Ar(e,i-1,n-i+3,d),n=i+d.length-u-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function zk(e,t){const n=this.parser.constructs.attentionMarkers.null,i=this.previous,a=Km(i);let s;return o;function o(c){return s=c,e.enter("attentionSequence"),l(c)}function l(c){if(c===s)return e.consume(c),l;const d=e.exit("attentionSequence"),u=Km(c),f=!u||u===2&&a||n.includes(c),m=!a||a===2&&u||n.includes(i);return d._open=!!(s===42?f:f&&(a||!m)),d._close=!!(s===42?m:m&&(u||!f)),t(c)}}function Vm(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const Rk={name:"autolink",tokenize:Bk};function Bk(e,t,n){let i=0;return a;function a(p){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),s}function s(p){return Sr(p)?(e.consume(p),o):p===64?n(p):d(p)}function o(p){return p===43||p===45||p===46||Hn(p)?(i=1,l(p)):d(p)}function l(p){return p===58?(e.consume(p),i=0,c):(p===43||p===45||p===46||Hn(p))&&i++<32?(e.consume(p),l):(i=0,d(p))}function c(p){return p===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.exit("autolink"),t):p===null||p===32||p===60||Lu(p)?n(p):(e.consume(p),c)}function d(p){return p===64?(e.consume(p),u):Ck(p)?(e.consume(p),d):n(p)}function u(p){return Hn(p)?f(p):n(p)}function f(p){return p===46?(e.consume(p),i=0,u):p===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(p),e.exit("autolinkMarker"),e.exit("autolink"),t):m(p)}function m(p){if((p===45||Hn(p))&&i++<63){const y=p===45?m:f;return e.consume(p),y}return n(p)}}const Tl={partial:!0,tokenize:Wk};function Wk(e,t,n){return i;function i(s){return ct(s)?Nt(e,a,"linePrefix")(s):a(s)}function a(s){return s===null||Xe(s)?t(s):n(s)}}const Xv={continuation:{tokenize:qk},exit:Uk,name:"blockQuote",tokenize:Fk};function Fk(e,t,n){const i=this;return a;function a(o){if(o===62){const l=i.containerState;return l.open||(e.enter("blockQuote",{_container:!0}),l.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),s}return n(o)}function s(o){return ct(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(o))}}function qk(e,t,n){const i=this;return a;function a(o){return ct(o)?Nt(e,s,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):s(o)}function s(o){return e.attempt(Xv,t,n)(o)}}function Uk(e){e.exit("blockQuote")}const Gv={name:"characterEscape",tokenize:Hk};function Hk(e,t,n){return i;function i(s){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(s),e.exit("escapeMarker"),a}function a(s){return Ik(s)?(e.enter("characterEscapeValue"),e.consume(s),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(s)}}const Qv={name:"characterReference",tokenize:Yk};function Yk(e,t,n){const i=this;let a=0,s,o;return l;function l(f){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(f),e.exit("characterReferenceMarker"),c}function c(f){return f===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(f),e.exit("characterReferenceMarkerNumeric"),d):(e.enter("characterReferenceValue"),s=31,o=Hn,u(f))}function d(f){return f===88||f===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(f),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),s=6,o=Ek,u):(e.enter("characterReferenceValue"),s=7,o=$u,u(f))}function u(f){if(f===59&&a){const m=e.exit("characterReferenceValue");return o===Hn&&!Xd(i.sliceSerialize(m))?n(f):(e.enter("characterReferenceMarker"),e.consume(f),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return o(f)&&a++<s?(e.consume(f),u):n(f)}}const Xm={partial:!0,tokenize:Vk},Gm={concrete:!0,name:"codeFenced",tokenize:Kk};function Kk(e,t,n){const i=this,a={partial:!0,tokenize:C};let s=0,o=0,l;return c;function c(w){return d(w)}function d(w){const O=i.events[i.events.length-1];return s=O&&O[1].type==="linePrefix"?O[2].sliceSerialize(O[1],!0).length:0,l=w,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),u(w)}function u(w){return w===l?(o++,e.consume(w),u):o<3?n(w):(e.exit("codeFencedFenceSequence"),ct(w)?Nt(e,f,"whitespace")(w):f(w))}function f(w){return w===null||Xe(w)?(e.exit("codeFencedFence"),i.interrupt?t(w):e.check(Xm,v,A)(w)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),m(w))}function m(w){return w===null||Xe(w)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),f(w)):ct(w)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),Nt(e,p,"whitespace")(w)):w===96&&w===l?n(w):(e.consume(w),m)}function p(w){return w===null||Xe(w)?f(w):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),y(w))}function y(w){return w===null||Xe(w)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),f(w)):w===96&&w===l?n(w):(e.consume(w),y)}function v(w){return e.attempt(a,A,g)(w)}function g(w){return e.enter("lineEnding"),e.consume(w),e.exit("lineEnding"),b}function b(w){return s>0&&ct(w)?Nt(e,x,"linePrefix",s+1)(w):x(w)}function x(w){return w===null||Xe(w)?e.check(Xm,v,A)(w):(e.enter("codeFlowValue"),N(w))}function N(w){return w===null||Xe(w)?(e.exit("codeFlowValue"),x(w)):(e.consume(w),N)}function A(w){return e.exit("codeFenced"),t(w)}function C(w,O,M){let B=0;return z;function z($){return w.enter("lineEnding"),w.consume($),w.exit("lineEnding"),j}function j($){return w.enter("codeFencedFence"),ct($)?Nt(w,k,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)($):k($)}function k($){return $===l?(w.enter("codeFencedFenceSequence"),L($)):M($)}function L($){return $===l?(B++,w.consume($),L):B>=o?(w.exit("codeFencedFenceSequence"),ct($)?Nt(w,T,"whitespace")($):T($)):M($)}function T($){return $===null||Xe($)?(w.exit("codeFencedFence"),O($)):M($)}}}function Vk(e,t,n){const i=this;return a;function a(o){return o===null?n(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),s)}function s(o){return i.parser.lazy[i.now().line]?n(o):t(o)}}const Xc={name:"codeIndented",tokenize:Gk},Xk={partial:!0,tokenize:Qk};function Gk(e,t,n){const i=this;return a;function a(d){return e.enter("codeIndented"),Nt(e,s,"linePrefix",5)(d)}function s(d){const u=i.events[i.events.length-1];return u&&u[1].type==="linePrefix"&&u[2].sliceSerialize(u[1],!0).length>=4?o(d):n(d)}function o(d){return d===null?c(d):Xe(d)?e.attempt(Xk,o,c)(d):(e.enter("codeFlowValue"),l(d))}function l(d){return d===null||Xe(d)?(e.exit("codeFlowValue"),o(d)):(e.consume(d),l)}function c(d){return e.exit("codeIndented"),t(d)}}function Qk(e,t,n){const i=this;return a;function a(o){return i.parser.lazy[i.now().line]?n(o):Xe(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),a):Nt(e,s,"linePrefix",5)(o)}function s(o){const l=i.events[i.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(o):Xe(o)?a(o):n(o)}}const Jk={name:"codeText",previous:eA,resolve:Zk,tokenize:tA};function Zk(e){let t=e.length-4,n=3,i,a;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(i=n;++i<t;)if(e[i][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(i=n-1,t++;++i<=t;)a===void 0?i!==t&&e[i][1].type!=="lineEnding"&&(a=i):(i===t||e[i][1].type==="lineEnding")&&(e[a][1].type="codeTextData",i!==a+2&&(e[a][1].end=e[i-1][1].end,e.splice(a+2,i-a-2),t-=i-a-2,i=a+2),a=void 0);return e}function eA(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function tA(e,t,n){let i=0,a,s;return o;function o(f){return e.enter("codeText"),e.enter("codeTextSequence"),l(f)}function l(f){return f===96?(e.consume(f),i++,l):(e.exit("codeTextSequence"),c(f))}function c(f){return f===null?n(f):f===32?(e.enter("space"),e.consume(f),e.exit("space"),c):f===96?(s=e.enter("codeTextSequence"),a=0,u(f)):Xe(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),c):(e.enter("codeTextData"),d(f))}function d(f){return f===null||f===32||f===96||Xe(f)?(e.exit("codeTextData"),c(f)):(e.consume(f),d)}function u(f){return f===96?(e.consume(f),a++,u):a===i?(e.exit("codeTextSequence"),e.exit("codeText"),t(f)):(s.type="codeTextData",d(f))}}class nA{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,n){const i=n??Number.POSITIVE_INFINITY;return i<this.left.length?this.left.slice(t,i):t>this.left.length?this.right.slice(this.right.length-i+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-i+this.left.length).reverse())}splice(t,n,i){const a=n||0;this.setCursor(Math.trunc(t));const s=this.right.splice(this.right.length-a,Number.POSITIVE_INFINITY);return i&&qa(this.left,i),s.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),qa(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),qa(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const n=this.left.splice(t,Number.POSITIVE_INFINITY);qa(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);qa(this.left,n.reverse())}}}function qa(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function Jv(e){const t={};let n=-1,i,a,s,o,l,c,d;const u=new nA(e);for(;++n<u.length;){for(;n in t;)n=t[n];if(i=u.get(n),n&&i[1].type==="chunkFlow"&&u.get(n-1)[1].type==="listItemPrefix"&&(c=i[1]._tokenizer.events,s=0,s<c.length&&c[s][1].type==="lineEndingBlank"&&(s+=2),s<c.length&&c[s][1].type==="content"))for(;++s<c.length&&c[s][1].type!=="content";)c[s][1].type==="chunkText"&&(c[s][1]._isInFirstContentOfListItem=!0,s++);if(i[0]==="enter")i[1].contentType&&(Object.assign(t,rA(u,n)),n=t[n],d=!0);else if(i[1]._container){for(s=n,a=void 0;s--;)if(o=u.get(s),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(a&&(u.get(a)[1].type="lineEndingBlank"),o[1].type="lineEnding",a=s);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;a&&(i[1].end={...u.get(a)[1].start},l=u.slice(a,n),l.unshift(i),u.splice(a,n-a+1,l))}}return Ar(e,0,Number.POSITIVE_INFINITY,u.slice(0)),!d}function rA(e,t){const n=e.get(t)[1],i=e.get(t)[2];let a=t-1;const s=[];let o=n._tokenizer;o||(o=i.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const l=o.events,c=[],d={};let u,f,m=-1,p=n,y=0,v=0;const g=[v];for(;p;){for(;e.get(++a)[1]!==p;);s.push(a),p._tokenizer||(u=i.sliceStream(p),p.next||u.push(null),f&&o.defineSkip(p.start),p._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(u),p._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),f=p,p=p.next}for(p=n;++m<l.length;)l[m][0]==="exit"&&l[m-1][0]==="enter"&&l[m][1].type===l[m-1][1].type&&l[m][1].start.line!==l[m][1].end.line&&(v=m+1,g.push(v),p._tokenizer=void 0,p.previous=void 0,p=p.next);for(o.events=[],p?(p._tokenizer=void 0,p.previous=void 0):g.pop(),m=g.length;m--;){const b=l.slice(g[m],g[m+1]),x=s.pop();c.push([x,x+b.length-1]),e.splice(x,2,b)}for(c.reverse(),m=-1;++m<c.length;)d[y+c[m][0]]=y+c[m][1],y+=c[m][1]-c[m][0]-1;return d}const iA={resolve:sA,tokenize:oA},aA={partial:!0,tokenize:lA};function sA(e){return Jv(e),e}function oA(e,t){let n;return i;function i(l){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),a(l)}function a(l){return l===null?s(l):Xe(l)?e.check(aA,o,s)(l):(e.consume(l),a)}function s(l){return e.exit("chunkContent"),e.exit("content"),t(l)}function o(l){return e.consume(l),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,a}}function lA(e,t,n){const i=this;return a;function a(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),Nt(e,s,"linePrefix")}function s(o){if(o===null||Xe(o))return n(o);const l=i.events[i.events.length-1];return!i.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(o):e.interrupt(i.parser.constructs.flow,n,t)(o)}}function Zv(e,t,n,i,a,s,o,l,c){const d=c||Number.POSITIVE_INFINITY;let u=0;return f;function f(b){return b===60?(e.enter(i),e.enter(a),e.enter(s),e.consume(b),e.exit(s),m):b===null||b===32||b===41||Lu(b)?n(b):(e.enter(i),e.enter(o),e.enter(l),e.enter("chunkString",{contentType:"string"}),v(b))}function m(b){return b===62?(e.enter(s),e.consume(b),e.exit(s),e.exit(a),e.exit(i),t):(e.enter(l),e.enter("chunkString",{contentType:"string"}),p(b))}function p(b){return b===62?(e.exit("chunkString"),e.exit(l),m(b)):b===null||b===60||Xe(b)?n(b):(e.consume(b),b===92?y:p)}function y(b){return b===60||b===62||b===92?(e.consume(b),p):p(b)}function v(b){return!u&&(b===null||b===41||Mn(b))?(e.exit("chunkString"),e.exit(l),e.exit(o),e.exit(i),t(b)):u<d&&b===40?(e.consume(b),u++,v):b===41?(e.consume(b),u--,v):b===null||b===32||b===40||Lu(b)?n(b):(e.consume(b),b===92?g:v)}function g(b){return b===40||b===41||b===92?(e.consume(b),v):v(b)}}function ex(e,t,n,i,a,s){const o=this;let l=0,c;return d;function d(p){return e.enter(i),e.enter(a),e.consume(p),e.exit(a),e.enter(s),u}function u(p){return l>999||p===null||p===91||p===93&&!c||p===94&&!l&&"_hiddenFootnoteSupport"in o.parser.constructs?n(p):p===93?(e.exit(s),e.enter(a),e.consume(p),e.exit(a),e.exit(i),t):Xe(p)?(e.enter("lineEnding"),e.consume(p),e.exit("lineEnding"),u):(e.enter("chunkString",{contentType:"string"}),f(p))}function f(p){return p===null||p===91||p===93||Xe(p)||l++>999?(e.exit("chunkString"),u(p)):(e.consume(p),c||(c=!ct(p)),p===92?m:f)}function m(p){return p===91||p===92||p===93?(e.consume(p),l++,f):f(p)}}function tx(e,t,n,i,a,s){let o;return l;function l(m){return m===34||m===39||m===40?(e.enter(i),e.enter(a),e.consume(m),e.exit(a),o=m===40?41:m,c):n(m)}function c(m){return m===o?(e.enter(a),e.consume(m),e.exit(a),e.exit(i),t):(e.enter(s),d(m))}function d(m){return m===o?(e.exit(s),c(o)):m===null?n(m):Xe(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),Nt(e,d,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),u(m))}function u(m){return m===o||m===null||Xe(m)?(e.exit("chunkString"),d(m)):(e.consume(m),m===92?f:u)}function f(m){return m===o||m===92?(e.consume(m),u):u(m)}}function as(e,t){let n;return i;function i(a){return Xe(a)?(e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),n=!0,i):ct(a)?Nt(e,i,n?"linePrefix":"lineSuffix")(a):t(a)}}const cA={name:"definition",tokenize:dA},uA={partial:!0,tokenize:fA};function dA(e,t,n){const i=this;let a;return s;function s(p){return e.enter("definition"),o(p)}function o(p){return ex.call(i,e,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(p)}function l(p){return a=ha(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)),p===58?(e.enter("definitionMarker"),e.consume(p),e.exit("definitionMarker"),c):n(p)}function c(p){return Mn(p)?as(e,d)(p):d(p)}function d(p){return Zv(e,u,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(p)}function u(p){return e.attempt(uA,f,f)(p)}function f(p){return ct(p)?Nt(e,m,"whitespace")(p):m(p)}function m(p){return p===null||Xe(p)?(e.exit("definition"),i.parser.defined.push(a),t(p)):n(p)}}function fA(e,t,n){return i;function i(l){return Mn(l)?as(e,a)(l):n(l)}function a(l){return tx(e,s,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function s(l){return ct(l)?Nt(e,o,"whitespace")(l):o(l)}function o(l){return l===null||Xe(l)?t(l):n(l)}}const hA={name:"hardBreakEscape",tokenize:mA};function mA(e,t,n){return i;function i(s){return e.enter("hardBreakEscape"),e.consume(s),a}function a(s){return Xe(s)?(e.exit("hardBreakEscape"),t(s)):n(s)}}const pA={name:"headingAtx",resolve:gA,tokenize:yA};function gA(e,t){let n=e.length-2,i=3,a,s;return e[i][1].type==="whitespace"&&(i+=2),n-2>i&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(i===n-1||n-4>i&&e[n-2][1].type==="whitespace")&&(n-=i+1===n?2:4),n>i&&(a={type:"atxHeadingText",start:e[i][1].start,end:e[n][1].end},s={type:"chunkText",start:e[i][1].start,end:e[n][1].end,contentType:"text"},Ar(e,i,n-i+1,[["enter",a,t],["enter",s,t],["exit",s,t],["exit",a,t]])),e}function yA(e,t,n){let i=0;return a;function a(u){return e.enter("atxHeading"),s(u)}function s(u){return e.enter("atxHeadingSequence"),o(u)}function o(u){return u===35&&i++<6?(e.consume(u),o):u===null||Mn(u)?(e.exit("atxHeadingSequence"),l(u)):n(u)}function l(u){return u===35?(e.enter("atxHeadingSequence"),c(u)):u===null||Xe(u)?(e.exit("atxHeading"),t(u)):ct(u)?Nt(e,l,"whitespace")(u):(e.enter("atxHeadingText"),d(u))}function c(u){return u===35?(e.consume(u),c):(e.exit("atxHeadingSequence"),l(u))}function d(u){return u===null||u===35||Mn(u)?(e.exit("atxHeadingText"),l(u)):(e.consume(u),d)}}const vA=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],Qm=["pre","script","style","textarea"],xA={concrete:!0,name:"htmlFlow",resolveTo:wA,tokenize:SA},bA={partial:!0,tokenize:kA},jA={partial:!0,tokenize:NA};function wA(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function SA(e,t,n){const i=this;let a,s,o,l,c;return d;function d(S){return u(S)}function u(S){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(S),f}function f(S){return S===33?(e.consume(S),m):S===47?(e.consume(S),s=!0,v):S===63?(e.consume(S),a=3,i.interrupt?t:I):Sr(S)?(e.consume(S),o=String.fromCharCode(S),g):n(S)}function m(S){return S===45?(e.consume(S),a=2,p):S===91?(e.consume(S),a=5,l=0,y):Sr(S)?(e.consume(S),a=4,i.interrupt?t:I):n(S)}function p(S){return S===45?(e.consume(S),i.interrupt?t:I):n(S)}function y(S){const _="CDATA[";return S===_.charCodeAt(l++)?(e.consume(S),l===_.length?i.interrupt?t:k:y):n(S)}function v(S){return Sr(S)?(e.consume(S),o=String.fromCharCode(S),g):n(S)}function g(S){if(S===null||S===47||S===62||Mn(S)){const _=S===47,H=o.toLowerCase();return!_&&!s&&Qm.includes(H)?(a=1,i.interrupt?t(S):k(S)):vA.includes(o.toLowerCase())?(a=6,_?(e.consume(S),b):i.interrupt?t(S):k(S)):(a=7,i.interrupt&&!i.parser.lazy[i.now().line]?n(S):s?x(S):N(S))}return S===45||Hn(S)?(e.consume(S),o+=String.fromCharCode(S),g):n(S)}function b(S){return S===62?(e.consume(S),i.interrupt?t:k):n(S)}function x(S){return ct(S)?(e.consume(S),x):z(S)}function N(S){return S===47?(e.consume(S),z):S===58||S===95||Sr(S)?(e.consume(S),A):ct(S)?(e.consume(S),N):z(S)}function A(S){return S===45||S===46||S===58||S===95||Hn(S)?(e.consume(S),A):C(S)}function C(S){return S===61?(e.consume(S),w):ct(S)?(e.consume(S),C):N(S)}function w(S){return S===null||S===60||S===61||S===62||S===96?n(S):S===34||S===39?(e.consume(S),c=S,O):ct(S)?(e.consume(S),w):M(S)}function O(S){return S===c?(e.consume(S),c=null,B):S===null||Xe(S)?n(S):(e.consume(S),O)}function M(S){return S===null||S===34||S===39||S===47||S===60||S===61||S===62||S===96||Mn(S)?C(S):(e.consume(S),M)}function B(S){return S===47||S===62||ct(S)?N(S):n(S)}function z(S){return S===62?(e.consume(S),j):n(S)}function j(S){return S===null||Xe(S)?k(S):ct(S)?(e.consume(S),j):n(S)}function k(S){return S===45&&a===2?(e.consume(S),V):S===60&&a===1?(e.consume(S),G):S===62&&a===4?(e.consume(S),P):S===63&&a===3?(e.consume(S),I):S===93&&a===5?(e.consume(S),U):Xe(S)&&(a===6||a===7)?(e.exit("htmlFlowData"),e.check(bA,D,L)(S)):S===null||Xe(S)?(e.exit("htmlFlowData"),L(S)):(e.consume(S),k)}function L(S){return e.check(jA,T,D)(S)}function T(S){return e.enter("lineEnding"),e.consume(S),e.exit("lineEnding"),$}function $(S){return S===null||Xe(S)?L(S):(e.enter("htmlFlowData"),k(S))}function V(S){return S===45?(e.consume(S),I):k(S)}function G(S){return S===47?(e.consume(S),o="",ne):k(S)}function ne(S){if(S===62){const _=o.toLowerCase();return Qm.includes(_)?(e.consume(S),P):k(S)}return Sr(S)&&o.length<8?(e.consume(S),o+=String.fromCharCode(S),ne):k(S)}function U(S){return S===93?(e.consume(S),I):k(S)}function I(S){return S===62?(e.consume(S),P):S===45&&a===2?(e.consume(S),I):k(S)}function P(S){return S===null||Xe(S)?(e.exit("htmlFlowData"),D(S)):(e.consume(S),P)}function D(S){return e.exit("htmlFlow"),t(S)}}function NA(e,t,n){const i=this;return a;function a(o){return Xe(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),s):n(o)}function s(o){return i.parser.lazy[i.now().line]?n(o):t(o)}}function kA(e,t,n){return i;function i(a){return e.enter("lineEnding"),e.consume(a),e.exit("lineEnding"),e.attempt(Tl,t,n)}}const AA={name:"htmlText",tokenize:CA};function CA(e,t,n){const i=this;let a,s,o;return l;function l(I){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(I),c}function c(I){return I===33?(e.consume(I),d):I===47?(e.consume(I),C):I===63?(e.consume(I),N):Sr(I)?(e.consume(I),M):n(I)}function d(I){return I===45?(e.consume(I),u):I===91?(e.consume(I),s=0,y):Sr(I)?(e.consume(I),x):n(I)}function u(I){return I===45?(e.consume(I),p):n(I)}function f(I){return I===null?n(I):I===45?(e.consume(I),m):Xe(I)?(o=f,G(I)):(e.consume(I),f)}function m(I){return I===45?(e.consume(I),p):f(I)}function p(I){return I===62?V(I):I===45?m(I):f(I)}function y(I){const P="CDATA[";return I===P.charCodeAt(s++)?(e.consume(I),s===P.length?v:y):n(I)}function v(I){return I===null?n(I):I===93?(e.consume(I),g):Xe(I)?(o=v,G(I)):(e.consume(I),v)}function g(I){return I===93?(e.consume(I),b):v(I)}function b(I){return I===62?V(I):I===93?(e.consume(I),b):v(I)}function x(I){return I===null||I===62?V(I):Xe(I)?(o=x,G(I)):(e.consume(I),x)}function N(I){return I===null?n(I):I===63?(e.consume(I),A):Xe(I)?(o=N,G(I)):(e.consume(I),N)}function A(I){return I===62?V(I):N(I)}function C(I){return Sr(I)?(e.consume(I),w):n(I)}function w(I){return I===45||Hn(I)?(e.consume(I),w):O(I)}function O(I){return Xe(I)?(o=O,G(I)):ct(I)?(e.consume(I),O):V(I)}function M(I){return I===45||Hn(I)?(e.consume(I),M):I===47||I===62||Mn(I)?B(I):n(I)}function B(I){return I===47?(e.consume(I),V):I===58||I===95||Sr(I)?(e.consume(I),z):Xe(I)?(o=B,G(I)):ct(I)?(e.consume(I),B):V(I)}function z(I){return I===45||I===46||I===58||I===95||Hn(I)?(e.consume(I),z):j(I)}function j(I){return I===61?(e.consume(I),k):Xe(I)?(o=j,G(I)):ct(I)?(e.consume(I),j):B(I)}function k(I){return I===null||I===60||I===61||I===62||I===96?n(I):I===34||I===39?(e.consume(I),a=I,L):Xe(I)?(o=k,G(I)):ct(I)?(e.consume(I),k):(e.consume(I),T)}function L(I){return I===a?(e.consume(I),a=void 0,$):I===null?n(I):Xe(I)?(o=L,G(I)):(e.consume(I),L)}function T(I){return I===null||I===34||I===39||I===60||I===61||I===96?n(I):I===47||I===62||Mn(I)?B(I):(e.consume(I),T)}function $(I){return I===47||I===62||Mn(I)?B(I):n(I)}function V(I){return I===62?(e.consume(I),e.exit("htmlTextData"),e.exit("htmlText"),t):n(I)}function G(I){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(I),e.exit("lineEnding"),ne}function ne(I){return ct(I)?Nt(e,U,"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(I):U(I)}function U(I){return e.enter("htmlTextData"),o(I)}}const Qd={name:"labelEnd",resolveAll:TA,resolveTo:OA,tokenize:DA},EA={tokenize:_A},IA={tokenize:MA},PA={tokenize:LA};function TA(e){let t=-1;const n=[];for(;++t<e.length;){const i=e[t][1];if(n.push(e[t]),i.type==="labelImage"||i.type==="labelLink"||i.type==="labelEnd"){const a=i.type==="labelImage"?4:2;i.type="data",t+=a}}return e.length!==n.length&&Ar(e,0,e.length,n),e}function OA(e,t){let n=e.length,i=0,a,s,o,l;for(;n--;)if(a=e[n][1],s){if(a.type==="link"||a.type==="labelLink"&&a._inactive)break;e[n][0]==="enter"&&a.type==="labelLink"&&(a._inactive=!0)}else if(o){if(e[n][0]==="enter"&&(a.type==="labelImage"||a.type==="labelLink")&&!a._balanced&&(s=n,a.type!=="labelLink")){i=2;break}}else a.type==="labelEnd"&&(o=n);const c={type:e[s][1].type==="labelLink"?"link":"image",start:{...e[s][1].start},end:{...e[e.length-1][1].end}},d={type:"label",start:{...e[s][1].start},end:{...e[o][1].end}},u={type:"labelText",start:{...e[s+i+2][1].end},end:{...e[o-2][1].start}};return l=[["enter",c,t],["enter",d,t]],l=tr(l,e.slice(s+1,s+i+3)),l=tr(l,[["enter",u,t]]),l=tr(l,Gd(t.parser.constructs.insideSpan.null,e.slice(s+i+4,o-3),t)),l=tr(l,[["exit",u,t],e[o-2],e[o-1],["exit",d,t]]),l=tr(l,e.slice(o+1)),l=tr(l,[["exit",c,t]]),Ar(e,s,e.length,l),e}function DA(e,t,n){const i=this;let a=i.events.length,s,o;for(;a--;)if((i.events[a][1].type==="labelImage"||i.events[a][1].type==="labelLink")&&!i.events[a][1]._balanced){s=i.events[a][1];break}return l;function l(m){return s?s._inactive?f(m):(o=i.parser.defined.includes(ha(i.sliceSerialize({start:s.end,end:i.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(m),e.exit("labelMarker"),e.exit("labelEnd"),c):n(m)}function c(m){return m===40?e.attempt(EA,u,o?u:f)(m):m===91?e.attempt(IA,u,o?d:f)(m):o?u(m):f(m)}function d(m){return e.attempt(PA,u,f)(m)}function u(m){return t(m)}function f(m){return s._balanced=!0,n(m)}}function _A(e,t,n){return i;function i(f){return e.enter("resource"),e.enter("resourceMarker"),e.consume(f),e.exit("resourceMarker"),a}function a(f){return Mn(f)?as(e,s)(f):s(f)}function s(f){return f===41?u(f):Zv(e,o,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(f)}function o(f){return Mn(f)?as(e,c)(f):u(f)}function l(f){return n(f)}function c(f){return f===34||f===39||f===40?tx(e,d,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(f):u(f)}function d(f){return Mn(f)?as(e,u)(f):u(f)}function u(f){return f===41?(e.enter("resourceMarker"),e.consume(f),e.exit("resourceMarker"),e.exit("resource"),t):n(f)}}function MA(e,t,n){const i=this;return a;function a(l){return ex.call(i,e,s,o,"reference","referenceMarker","referenceString")(l)}function s(l){return i.parser.defined.includes(ha(i.sliceSerialize(i.events[i.events.length-1][1]).slice(1,-1)))?t(l):n(l)}function o(l){return n(l)}}function LA(e,t,n){return i;function i(s){return e.enter("reference"),e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),a}function a(s){return s===93?(e.enter("referenceMarker"),e.consume(s),e.exit("referenceMarker"),e.exit("reference"),t):n(s)}}const $A={name:"labelStartImage",resolveAll:Qd.resolveAll,tokenize:zA};function zA(e,t,n){const i=this;return a;function a(l){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(l),e.exit("labelImageMarker"),s}function s(l){return l===91?(e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelImage"),o):n(l)}function o(l){return l===94&&"_hiddenFootnoteSupport"in i.parser.constructs?n(l):t(l)}}const RA={name:"labelStartLink",resolveAll:Qd.resolveAll,tokenize:BA};function BA(e,t,n){const i=this;return a;function a(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),s}function s(o){return o===94&&"_hiddenFootnoteSupport"in i.parser.constructs?n(o):t(o)}}const Gc={name:"lineEnding",tokenize:WA};function WA(e,t){return n;function n(i){return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),Nt(e,t,"linePrefix")}}const Co={name:"thematicBreak",tokenize:FA};function FA(e,t,n){let i=0,a;return s;function s(d){return e.enter("thematicBreak"),o(d)}function o(d){return a=d,l(d)}function l(d){return d===a?(e.enter("thematicBreakSequence"),c(d)):i>=3&&(d===null||Xe(d))?(e.exit("thematicBreak"),t(d)):n(d)}function c(d){return d===a?(e.consume(d),i++,c):(e.exit("thematicBreakSequence"),ct(d)?Nt(e,l,"whitespace")(d):l(d))}}const Tn={continuation:{tokenize:YA},exit:VA,name:"list",tokenize:HA},qA={partial:!0,tokenize:XA},UA={partial:!0,tokenize:KA};function HA(e,t,n){const i=this,a=i.events[i.events.length-1];let s=a&&a[1].type==="linePrefix"?a[2].sliceSerialize(a[1],!0).length:0,o=0;return l;function l(p){const y=i.containerState.type||(p===42||p===43||p===45?"listUnordered":"listOrdered");if(y==="listUnordered"?!i.containerState.marker||p===i.containerState.marker:$u(p)){if(i.containerState.type||(i.containerState.type=y,e.enter(y,{_container:!0})),y==="listUnordered")return e.enter("listItemPrefix"),p===42||p===45?e.check(Co,n,d)(p):d(p);if(!i.interrupt||p===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),c(p)}return n(p)}function c(p){return $u(p)&&++o<10?(e.consume(p),c):(!i.interrupt||o<2)&&(i.containerState.marker?p===i.containerState.marker:p===41||p===46)?(e.exit("listItemValue"),d(p)):n(p)}function d(p){return e.enter("listItemMarker"),e.consume(p),e.exit("listItemMarker"),i.containerState.marker=i.containerState.marker||p,e.check(Tl,i.interrupt?n:u,e.attempt(qA,m,f))}function u(p){return i.containerState.initialBlankLine=!0,s++,m(p)}function f(p){return ct(p)?(e.enter("listItemPrefixWhitespace"),e.consume(p),e.exit("listItemPrefixWhitespace"),m):n(p)}function m(p){return i.containerState.size=s+i.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(p)}}function YA(e,t,n){const i=this;return i.containerState._closeFlow=void 0,e.check(Tl,a,s);function a(l){return i.containerState.furtherBlankLines=i.containerState.furtherBlankLines||i.containerState.initialBlankLine,Nt(e,t,"listItemIndent",i.containerState.size+1)(l)}function s(l){return i.containerState.furtherBlankLines||!ct(l)?(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,o(l)):(i.containerState.furtherBlankLines=void 0,i.containerState.initialBlankLine=void 0,e.attempt(UA,t,o)(l))}function o(l){return i.containerState._closeFlow=!0,i.interrupt=void 0,Nt(e,e.attempt(Tn,t,n),"linePrefix",i.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function KA(e,t,n){const i=this;return Nt(e,a,"listItemIndent",i.containerState.size+1);function a(s){const o=i.events[i.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===i.containerState.size?t(s):n(s)}}function VA(e){e.exit(this.containerState.type)}function XA(e,t,n){const i=this;return Nt(e,a,"listItemPrefixWhitespace",i.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function a(s){const o=i.events[i.events.length-1];return!ct(s)&&o&&o[1].type==="listItemPrefixWhitespace"?t(s):n(s)}}const Jm={name:"setextUnderline",resolveTo:GA,tokenize:QA};function GA(e,t){let n=e.length,i,a,s;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){i=n;break}e[n][1].type==="paragraph"&&(a=n)}else e[n][1].type==="content"&&e.splice(n,1),!s&&e[n][1].type==="definition"&&(s=n);const o={type:"setextHeading",start:{...e[i][1].start},end:{...e[e.length-1][1].end}};return e[a][1].type="setextHeadingText",s?(e.splice(a,0,["enter",o,t]),e.splice(s+1,0,["exit",e[i][1],t]),e[i][1].end={...e[s][1].end}):e[i][1]=o,e.push(["exit",o,t]),e}function QA(e,t,n){const i=this;let a;return s;function s(d){let u=i.events.length,f;for(;u--;)if(i.events[u][1].type!=="lineEnding"&&i.events[u][1].type!=="linePrefix"&&i.events[u][1].type!=="content"){f=i.events[u][1].type==="paragraph";break}return!i.parser.lazy[i.now().line]&&(i.interrupt||f)?(e.enter("setextHeadingLine"),a=d,o(d)):n(d)}function o(d){return e.enter("setextHeadingLineSequence"),l(d)}function l(d){return d===a?(e.consume(d),l):(e.exit("setextHeadingLineSequence"),ct(d)?Nt(e,c,"lineSuffix")(d):c(d))}function c(d){return d===null||Xe(d)?(e.exit("setextHeadingLine"),t(d)):n(d)}}const JA={tokenize:ZA};function ZA(e){const t=this,n=e.attempt(Tl,i,e.attempt(this.parser.constructs.flowInitial,a,Nt(e,e.attempt(this.parser.constructs.flow,a,e.attempt(iA,a)),"linePrefix")));return n;function i(s){if(s===null){e.consume(s);return}return e.enter("lineEndingBlank"),e.consume(s),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function a(s){if(s===null){e.consume(s);return}return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const eC={resolveAll:rx()},tC=nx("string"),nC=nx("text");function nx(e){return{resolveAll:rx(e==="text"?rC:void 0),tokenize:t};function t(n){const i=this,a=this.parser.constructs[e],s=n.attempt(a,o,l);return o;function o(u){return d(u)?s(u):l(u)}function l(u){if(u===null){n.consume(u);return}return n.enter("data"),n.consume(u),c}function c(u){return d(u)?(n.exit("data"),s(u)):(n.consume(u),c)}function d(u){if(u===null)return!0;const f=a[u];let m=-1;if(f)for(;++m<f.length;){const p=f[m];if(!p.previous||p.previous.call(i,i.previous))return!0}return!1}}}function rx(e){return t;function t(n,i){let a=-1,s;for(;++a<=n.length;)s===void 0?n[a]&&n[a][1].type==="data"&&(s=a,a++):(!n[a]||n[a][1].type!=="data")&&(a!==s+2&&(n[s][1].end=n[a-1][1].end,n.splice(s+2,a-s-2),a=s+2),s=void 0);return e?e(n,i):n}}function rC(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const i=e[n-1][1],a=t.sliceStream(i);let s=a.length,o=-1,l=0,c;for(;s--;){const d=a[s];if(typeof d=="string"){for(o=d.length;d.charCodeAt(o-1)===32;)l++,o--;if(o)break;o=-1}else if(d===-2)c=!0,l++;else if(d!==-1){s++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(l=0),l){const d={type:n===e.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:s?o:i.start._bufferIndex+o,_index:i.start._index+s,line:i.end.line,column:i.end.column-l,offset:i.end.offset-l},end:{...i.end}};i.end={...d.start},i.start.offset===i.end.offset?Object.assign(i,d):(e.splice(n,0,["enter",d,t],["exit",d,t]),n+=2)}n++}return e}const iC={42:Tn,43:Tn,45:Tn,48:Tn,49:Tn,50:Tn,51:Tn,52:Tn,53:Tn,54:Tn,55:Tn,56:Tn,57:Tn,62:Xv},aC={91:cA},sC={[-2]:Xc,[-1]:Xc,32:Xc},oC={35:pA,42:Co,45:[Jm,Co],60:xA,61:Jm,95:Co,96:Gm,126:Gm},lC={38:Qv,92:Gv},cC={[-5]:Gc,[-4]:Gc,[-3]:Gc,33:$A,38:Qv,42:zu,60:[Rk,AA],91:RA,92:[hA,Gv],93:Qd,95:zu,96:Jk},uC={null:[zu,eC]},dC={null:[42,95]},fC={null:[]},hC=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:dC,contentInitial:aC,disable:fC,document:iC,flow:oC,flowInitial:sC,insideSpan:uC,string:lC,text:cC},Symbol.toStringTag,{value:"Module"}));function mC(e,t,n){let i={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const a={},s=[];let o=[],l=[];const c={attempt:O(C),check:O(w),consume:x,enter:N,exit:A,interrupt:O(w,{interrupt:!0})},d={code:null,containerState:{},defineSkip:v,events:[],now:y,parser:e,previous:null,sliceSerialize:m,sliceStream:p,write:f};let u=t.tokenize.call(d,c);return t.resolveAll&&s.push(t),d;function f(j){return o=tr(o,j),g(),o[o.length-1]!==null?[]:(M(t,0),d.events=Gd(s,d.events,d),d.events)}function m(j,k){return gC(p(j),k)}function p(j){return pC(o,j)}function y(){const{_bufferIndex:j,_index:k,line:L,column:T,offset:$}=i;return{_bufferIndex:j,_index:k,line:L,column:T,offset:$}}function v(j){a[j.line]=j.column,z()}function g(){let j;for(;i._index<o.length;){const k=o[i._index];if(typeof k=="string")for(j=i._index,i._bufferIndex<0&&(i._bufferIndex=0);i._index===j&&i._bufferIndex<k.length;)b(k.charCodeAt(i._bufferIndex));else b(k)}}function b(j){u=u(j)}function x(j){Xe(j)?(i.line++,i.column=1,i.offset+=j===-3?2:1,z()):j!==-1&&(i.column++,i.offset++),i._bufferIndex<0?i._index++:(i._bufferIndex++,i._bufferIndex===o[i._index].length&&(i._bufferIndex=-1,i._index++)),d.previous=j}function N(j,k){const L=k||{};return L.type=j,L.start=y(),d.events.push(["enter",L,d]),l.push(L),L}function A(j){const k=l.pop();return k.end=y(),d.events.push(["exit",k,d]),k}function C(j,k){M(j,k.from)}function w(j,k){k.restore()}function O(j,k){return L;function L(T,$,V){let G,ne,U,I;return Array.isArray(T)?D(T):"tokenize"in T?D([T]):P(T);function P(q){return K;function K(W){const R=W!==null&&q[W],oe=W!==null&&q.null,Y=[...Array.isArray(R)?R:R?[R]:[],...Array.isArray(oe)?oe:oe?[oe]:[]];return D(Y)(W)}}function D(q){return G=q,ne=0,q.length===0?V:S(q[ne])}function S(q){return K;function K(W){return I=B(),U=q,q.partial||(d.currentConstruct=q),q.name&&d.parser.constructs.disable.null.includes(q.name)?H():q.tokenize.call(k?Object.assign(Object.create(d),k):d,c,_,H)(W)}}function _(q){return j(U,I),$}function H(q){return I.restore(),++ne<G.length?S(G[ne]):V}}}function M(j,k){j.resolveAll&&!s.includes(j)&&s.push(j),j.resolve&&Ar(d.events,k,d.events.length-k,j.resolve(d.events.slice(k),d)),j.resolveTo&&(d.events=j.resolveTo(d.events,d))}function B(){const j=y(),k=d.previous,L=d.currentConstruct,T=d.events.length,$=Array.from(l);return{from:T,restore:V};function V(){i=j,d.previous=k,d.currentConstruct=L,d.events.length=T,l=$,z()}}function z(){i.line in a&&i.column<2&&(i.column=a[i.line],i.offset+=a[i.line]-1)}}function pC(e,t){const n=t.start._index,i=t.start._bufferIndex,a=t.end._index,s=t.end._bufferIndex;let o;if(n===a)o=[e[n].slice(i,s)];else{if(o=e.slice(n,a),i>-1){const l=o[0];typeof l=="string"?o[0]=l.slice(i):o.shift()}s>0&&o.push(e[a].slice(0,s))}return o}function gC(e,t){let n=-1;const i=[];let a;for(;++n<e.length;){const s=e[n];let o;if(typeof s=="string")o=s;else switch(s){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=t?" ":"	";break}case-1:{if(!t&&a)continue;o=" ";break}default:o=String.fromCharCode(s)}a=s===-2,i.push(o)}return i.join("")}function yC(e){const i={constructs:Nk([hC,...(e||{}).extensions||[]]),content:a(Ok),defined:[],document:a(_k),flow:a(JA),lazy:{},string:a(tC),text:a(nC)};return i;function a(s){return o;function o(l){return mC(i,s,l)}}}function vC(e){for(;!Jv(e););return e}const Zm=/[\0\t\n\r]/g;function xC(){let e=1,t="",n=!0,i;return a;function a(s,o,l){const c=[];let d,u,f,m,p;for(s=t+(typeof s=="string"?s.toString():new TextDecoder(o||void 0).decode(s)),f=0,t="",n&&(s.charCodeAt(0)===65279&&f++,n=void 0);f<s.length;){if(Zm.lastIndex=f,d=Zm.exec(s),m=d&&d.index!==void 0?d.index:s.length,p=s.charCodeAt(m),!d){t=s.slice(f);break}if(p===10&&f===m&&i)c.push(-3),i=void 0;else switch(i&&(c.push(-5),i=void 0),f<m&&(c.push(s.slice(f,m)),e+=m-f),p){case 0:{c.push(65533),e++;break}case 9:{for(u=Math.ceil(e/4)*4,c.push(-2);e++<u;)c.push(-1);break}case 10:{c.push(-4),e=1;break}default:i=!0,e=1}f=m+1}return l&&(i&&c.push(-5),t&&c.push(t),c.push(null)),c}}const bC=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function jC(e){return e.replace(bC,wC)}function wC(e,t,n){if(t)return t;if(n.charCodeAt(0)===35){const a=n.charCodeAt(1),s=a===120||a===88;return Vv(n.slice(s?2:1),s?16:10)}return Xd(n)||e}const ix={}.hasOwnProperty;function SC(e,t,n){return typeof t!="string"&&(n=t,t=void 0),NC(n)(vC(yC(n).document().write(xC()(e,t,!0))))}function NC(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:s(ge),autolinkProtocol:B,autolinkEmail:B,atxHeading:s(ke),blockQuote:s(oe),characterEscape:B,characterReference:B,codeFenced:s(Y),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:s(Y,o),codeText:s(X,o),codeTextData:B,data:B,codeFlowValue:B,definition:s(de),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:s(be),hardBreakEscape:s(ve),hardBreakTrailing:s(ve),htmlFlow:s(Ie,o),htmlFlowData:B,htmlText:s(Ie,o),htmlTextData:B,image:s(J),label:o,link:s(ge),listItem:s(Se),listItemValue:m,listOrdered:s(Pe,f),listUnordered:s(Pe),paragraph:s(Je),reference:S,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:s(ke),strong:s(yt),thematicBreak:s(It)},exit:{atxHeading:c(),atxHeadingSequence:C,autolink:c(),autolinkEmail:R,autolinkProtocol:W,blockQuote:c(),characterEscapeValue:z,characterReferenceMarkerHexadecimal:H,characterReferenceMarkerNumeric:H,characterReferenceValue:q,characterReference:K,codeFenced:c(g),codeFencedFence:v,codeFencedFenceInfo:p,codeFencedFenceMeta:y,codeFlowValue:z,codeIndented:c(b),codeText:c($),codeTextData:z,data:z,definition:c(),definitionDestinationString:A,definitionLabelString:x,definitionTitleString:N,emphasis:c(),hardBreakEscape:c(k),hardBreakTrailing:c(k),htmlFlow:c(L),htmlFlowData:z,htmlText:c(T),htmlTextData:z,image:c(G),label:U,labelText:ne,lineEnding:j,link:c(V),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:_,resourceDestinationString:I,resourceTitleString:P,resource:D,setextHeading:c(M),setextHeadingLineSequence:O,setextHeadingText:w,strong:c(),thematicBreak:c()}};ax(t,(e||{}).mdastExtensions||[]);const n={};return i;function i(ye){let Ae={type:"root",children:[]};const Oe={stack:[Ae],tokenStack:[],config:t,enter:l,exit:d,buffer:o,resume:u,data:n},Fe=[];let ze=-1;for(;++ze<ye.length;)if(ye[ze][1].type==="listOrdered"||ye[ze][1].type==="listUnordered")if(ye[ze][0]==="enter")Fe.push(ze);else{const at=Fe.pop();ze=a(ye,at,ze)}for(ze=-1;++ze<ye.length;){const at=t[ye[ze][0]];ix.call(at,ye[ze][1].type)&&at[ye[ze][1].type].call(Object.assign({sliceSerialize:ye[ze][2].sliceSerialize},Oe),ye[ze][1])}if(Oe.tokenStack.length>0){const at=Oe.tokenStack[Oe.tokenStack.length-1];(at[1]||ep).call(Oe,void 0,at[0])}for(Ae.position={start:si(ye.length>0?ye[0][1].start:{line:1,column:1,offset:0}),end:si(ye.length>0?ye[ye.length-2][1].end:{line:1,column:1,offset:0})},ze=-1;++ze<t.transforms.length;)Ae=t.transforms[ze](Ae)||Ae;return Ae}function a(ye,Ae,Oe){let Fe=Ae-1,ze=-1,at=!1,At,Pt,Ze,nn;for(;++Fe<=Oe;){const Ht=ye[Fe];switch(Ht[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Ht[0]==="enter"?ze++:ze--,nn=void 0;break}case"lineEndingBlank":{Ht[0]==="enter"&&(At&&!nn&&!ze&&!Ze&&(Ze=Fe),nn=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:nn=void 0}if(!ze&&Ht[0]==="enter"&&Ht[1].type==="listItemPrefix"||ze===-1&&Ht[0]==="exit"&&(Ht[1].type==="listUnordered"||Ht[1].type==="listOrdered")){if(At){let Yt=Fe;for(Pt=void 0;Yt--;){const Ct=ye[Yt];if(Ct[1].type==="lineEnding"||Ct[1].type==="lineEndingBlank"){if(Ct[0]==="exit")continue;Pt&&(ye[Pt][1].type="lineEndingBlank",at=!0),Ct[1].type="lineEnding",Pt=Yt}else if(!(Ct[1].type==="linePrefix"||Ct[1].type==="blockQuotePrefix"||Ct[1].type==="blockQuotePrefixWhitespace"||Ct[1].type==="blockQuoteMarker"||Ct[1].type==="listItemIndent"))break}Ze&&(!Pt||Ze<Pt)&&(At._spread=!0),At.end=Object.assign({},Pt?ye[Pt][1].start:Ht[1].end),ye.splice(Pt||Fe,0,["exit",At,Ht[2]]),Fe++,Oe++}if(Ht[1].type==="listItemPrefix"){const Yt={type:"listItem",_spread:!1,start:Object.assign({},Ht[1].start),end:void 0};At=Yt,ye.splice(Fe,0,["enter",Yt,Ht[2]]),Fe++,Oe++,Ze=void 0,nn=!0}}}return ye[Ae][1]._spread=at,Oe}function s(ye,Ae){return Oe;function Oe(Fe){l.call(this,ye(Fe),Fe),Ae&&Ae.call(this,Fe)}}function o(){this.stack.push({type:"fragment",children:[]})}function l(ye,Ae,Oe){this.stack[this.stack.length-1].children.push(ye),this.stack.push(ye),this.tokenStack.push([Ae,Oe||void 0]),ye.position={start:si(Ae.start),end:void 0}}function c(ye){return Ae;function Ae(Oe){ye&&ye.call(this,Oe),d.call(this,Oe)}}function d(ye,Ae){const Oe=this.stack.pop(),Fe=this.tokenStack.pop();if(Fe)Fe[0].type!==ye.type&&(Ae?Ae.call(this,ye,Fe[0]):(Fe[1]||ep).call(this,ye,Fe[0]));else throw new Error("Cannot close `"+ye.type+"` ("+is({start:ye.start,end:ye.end})+"): it’s not open");Oe.position.end=si(ye.end)}function u(){return wk(this.stack.pop())}function f(){this.data.expectingFirstListItemValue=!0}function m(ye){if(this.data.expectingFirstListItemValue){const Ae=this.stack[this.stack.length-2];Ae.start=Number.parseInt(this.sliceSerialize(ye),10),this.data.expectingFirstListItemValue=void 0}}function p(){const ye=this.resume(),Ae=this.stack[this.stack.length-1];Ae.lang=ye}function y(){const ye=this.resume(),Ae=this.stack[this.stack.length-1];Ae.meta=ye}function v(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function g(){const ye=this.resume(),Ae=this.stack[this.stack.length-1];Ae.value=ye.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function b(){const ye=this.resume(),Ae=this.stack[this.stack.length-1];Ae.value=ye.replace(/(\r?\n|\r)$/g,"")}function x(ye){const Ae=this.resume(),Oe=this.stack[this.stack.length-1];Oe.label=Ae,Oe.identifier=ha(this.sliceSerialize(ye)).toLowerCase()}function N(){const ye=this.resume(),Ae=this.stack[this.stack.length-1];Ae.title=ye}function A(){const ye=this.resume(),Ae=this.stack[this.stack.length-1];Ae.url=ye}function C(ye){const Ae=this.stack[this.stack.length-1];if(!Ae.depth){const Oe=this.sliceSerialize(ye).length;Ae.depth=Oe}}function w(){this.data.setextHeadingSlurpLineEnding=!0}function O(ye){const Ae=this.stack[this.stack.length-1];Ae.depth=this.sliceSerialize(ye).codePointAt(0)===61?1:2}function M(){this.data.setextHeadingSlurpLineEnding=void 0}function B(ye){const Oe=this.stack[this.stack.length-1].children;let Fe=Oe[Oe.length-1];(!Fe||Fe.type!=="text")&&(Fe=jt(),Fe.position={start:si(ye.start),end:void 0},Oe.push(Fe)),this.stack.push(Fe)}function z(ye){const Ae=this.stack.pop();Ae.value+=this.sliceSerialize(ye),Ae.position.end=si(ye.end)}function j(ye){const Ae=this.stack[this.stack.length-1];if(this.data.atHardBreak){const Oe=Ae.children[Ae.children.length-1];Oe.position.end=si(ye.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(Ae.type)&&(B.call(this,ye),z.call(this,ye))}function k(){this.data.atHardBreak=!0}function L(){const ye=this.resume(),Ae=this.stack[this.stack.length-1];Ae.value=ye}function T(){const ye=this.resume(),Ae=this.stack[this.stack.length-1];Ae.value=ye}function $(){const ye=this.resume(),Ae=this.stack[this.stack.length-1];Ae.value=ye}function V(){const ye=this.stack[this.stack.length-1];if(this.data.inReference){const Ae=this.data.referenceType||"shortcut";ye.type+="Reference",ye.referenceType=Ae,delete ye.url,delete ye.title}else delete ye.identifier,delete ye.label;this.data.referenceType=void 0}function G(){const ye=this.stack[this.stack.length-1];if(this.data.inReference){const Ae=this.data.referenceType||"shortcut";ye.type+="Reference",ye.referenceType=Ae,delete ye.url,delete ye.title}else delete ye.identifier,delete ye.label;this.data.referenceType=void 0}function ne(ye){const Ae=this.sliceSerialize(ye),Oe=this.stack[this.stack.length-2];Oe.label=jC(Ae),Oe.identifier=ha(Ae).toLowerCase()}function U(){const ye=this.stack[this.stack.length-1],Ae=this.resume(),Oe=this.stack[this.stack.length-1];if(this.data.inReference=!0,Oe.type==="link"){const Fe=ye.children;Oe.children=Fe}else Oe.alt=Ae}function I(){const ye=this.resume(),Ae=this.stack[this.stack.length-1];Ae.url=ye}function P(){const ye=this.resume(),Ae=this.stack[this.stack.length-1];Ae.title=ye}function D(){this.data.inReference=void 0}function S(){this.data.referenceType="collapsed"}function _(ye){const Ae=this.resume(),Oe=this.stack[this.stack.length-1];Oe.label=Ae,Oe.identifier=ha(this.sliceSerialize(ye)).toLowerCase(),this.data.referenceType="full"}function H(ye){this.data.characterReferenceType=ye.type}function q(ye){const Ae=this.sliceSerialize(ye),Oe=this.data.characterReferenceType;let Fe;Oe?(Fe=Vv(Ae,Oe==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):Fe=Xd(Ae);const ze=this.stack[this.stack.length-1];ze.value+=Fe}function K(ye){const Ae=this.stack.pop();Ae.position.end=si(ye.end)}function W(ye){z.call(this,ye);const Ae=this.stack[this.stack.length-1];Ae.url=this.sliceSerialize(ye)}function R(ye){z.call(this,ye);const Ae=this.stack[this.stack.length-1];Ae.url="mailto:"+this.sliceSerialize(ye)}function oe(){return{type:"blockquote",children:[]}}function Y(){return{type:"code",lang:null,meta:null,value:""}}function X(){return{type:"inlineCode",value:""}}function de(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function be(){return{type:"emphasis",children:[]}}function ke(){return{type:"heading",depth:0,children:[]}}function ve(){return{type:"break"}}function Ie(){return{type:"html",value:""}}function J(){return{type:"image",title:null,url:"",alt:null}}function ge(){return{type:"link",title:null,url:"",children:[]}}function Pe(ye){return{type:"list",ordered:ye.type==="listOrdered",start:null,spread:ye._spread,children:[]}}function Se(ye){return{type:"listItem",spread:ye._spread,checked:null,children:[]}}function Je(){return{type:"paragraph",children:[]}}function yt(){return{type:"strong",children:[]}}function jt(){return{type:"text",value:""}}function It(){return{type:"thematicBreak"}}}function si(e){return{line:e.line,column:e.column,offset:e.offset}}function ax(e,t){let n=-1;for(;++n<t.length;){const i=t[n];Array.isArray(i)?ax(e,i):kC(e,i)}}function kC(e,t){let n;for(n in t)if(ix.call(t,n))switch(n){case"canContainEols":{const i=t[n];i&&e[n].push(...i);break}case"transforms":{const i=t[n];i&&e[n].push(...i);break}case"enter":case"exit":{const i=t[n];i&&Object.assign(e[n],i);break}}}function ep(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+is({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+is({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+is({start:t.start,end:t.end})+") is still open")}function AC(e){const t=this;t.parser=n;function n(i){return SC(i,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function CC(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)}function EC(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:`
`}]}function IC(e,t){const n=t.value?t.value+`
`:"",i={},a=t.lang?t.lang.split(/\s+/):[];a.length>0&&(i.className=["language-"+a[0]]);let s={type:"element",tagName:"code",properties:i,children:[{type:"text",value:n}]};return t.meta&&(s.data={meta:t.meta}),e.patch(t,s),s=e.applyData(t,s),s={type:"element",tagName:"pre",properties:{},children:[s]},e.patch(t,s),s}function PC(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function TC(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function OC(e,t){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",i=String(t.identifier).toUpperCase(),a=Na(i.toLowerCase()),s=e.footnoteOrder.indexOf(i);let o,l=e.footnoteCounts.get(i);l===void 0?(l=0,e.footnoteOrder.push(i),o=e.footnoteOrder.length):o=s+1,l+=1,e.footnoteCounts.set(i,l);const c={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+a,id:n+"fnref-"+a+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(t,c);const d={type:"element",tagName:"sup",properties:{},children:[c]};return e.patch(t,d),e.applyData(t,d)}function DC(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function _C(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}}function sx(e,t){const n=t.referenceType;let i="]";if(n==="collapsed"?i+="[]":n==="full"&&(i+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+i}];const a=e.all(t),s=a[0];s&&s.type==="text"?s.value="["+s.value:a.unshift({type:"text",value:"["});const o=a[a.length-1];return o&&o.type==="text"?o.value+=i:a.push({type:"text",value:i}),a}function MC(e,t){const n=String(t.identifier).toUpperCase(),i=e.definitionById.get(n);if(!i)return sx(e,t);const a={src:Na(i.url||""),alt:t.alt};i.title!==null&&i.title!==void 0&&(a.title=i.title);const s={type:"element",tagName:"img",properties:a,children:[]};return e.patch(t,s),e.applyData(t,s)}function LC(e,t){const n={src:Na(t.url)};t.alt!==null&&t.alt!==void 0&&(n.alt=t.alt),t.title!==null&&t.title!==void 0&&(n.title=t.title);const i={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,i),e.applyData(t,i)}function $C(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const i={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,i),e.applyData(t,i)}function zC(e,t){const n=String(t.identifier).toUpperCase(),i=e.definitionById.get(n);if(!i)return sx(e,t);const a={href:Na(i.url||"")};i.title!==null&&i.title!==void 0&&(a.title=i.title);const s={type:"element",tagName:"a",properties:a,children:e.all(t)};return e.patch(t,s),e.applyData(t,s)}function RC(e,t){const n={href:Na(t.url)};t.title!==null&&t.title!==void 0&&(n.title=t.title);const i={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function BC(e,t,n){const i=e.all(t),a=n?WC(n):ox(t),s={},o=[];if(typeof t.checked=="boolean"){const u=i[0];let f;u&&u.type==="element"&&u.tagName==="p"?f=u:(f={type:"element",tagName:"p",properties:{},children:[]},i.unshift(f)),f.children.length>0&&f.children.unshift({type:"text",value:" "}),f.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),s.className=["task-list-item"]}let l=-1;for(;++l<i.length;){const u=i[l];(a||l!==0||u.type!=="element"||u.tagName!=="p")&&o.push({type:"text",value:`
`}),u.type==="element"&&u.tagName==="p"&&!a?o.push(...u.children):o.push(u)}const c=i[i.length-1];c&&(a||c.type!=="element"||c.tagName!=="p")&&o.push({type:"text",value:`
`});const d={type:"element",tagName:"li",properties:s,children:o};return e.patch(t,d),e.applyData(t,d)}function WC(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const n=e.children;let i=-1;for(;!t&&++i<n.length;)t=ox(n[i])}return t}function ox(e){const t=e.spread;return t??e.children.length>1}function FC(e,t){const n={},i=e.all(t);let a=-1;for(typeof t.start=="number"&&t.start!==1&&(n.start=t.start);++a<i.length;){const o=i[a];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const s={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(i,!0)};return e.patch(t,s),e.applyData(t,s)}function qC(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function UC(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)}function HC(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function YC(e,t){const n=e.all(t),i=n.shift(),a=[];if(i){const o={type:"element",tagName:"thead",properties:{},children:e.wrap([i],!0)};e.patch(t.children[0],o),a.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},l=Hd(t.children[1]),c=Wv(t.children[t.children.length-1]);l&&c&&(o.position={start:l,end:c}),a.push(o)}const s={type:"element",tagName:"table",properties:{},children:e.wrap(a,!0)};return e.patch(t,s),e.applyData(t,s)}function KC(e,t,n){const i=n?n.children:void 0,s=(i?i.indexOf(t):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,l=o?o.length:t.children.length;let c=-1;const d=[];for(;++c<l;){const f=t.children[c],m={},p=o?o[c]:void 0;p&&(m.align=p);let y={type:"element",tagName:s,properties:m,children:[]};f&&(y.children=e.all(f),e.patch(f,y),y=e.applyData(f,y)),d.push(y)}const u={type:"element",tagName:"tr",properties:{},children:e.wrap(d,!0)};return e.patch(t,u),e.applyData(t,u)}function VC(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}const tp=9,np=32;function XC(e){const t=String(e),n=/\r?\n|\r/g;let i=n.exec(t),a=0;const s=[];for(;i;)s.push(rp(t.slice(a,i.index),a>0,!0),i[0]),a=i.index+i[0].length,i=n.exec(t);return s.push(rp(t.slice(a),a>0,!1)),s.join("")}function rp(e,t,n){let i=0,a=e.length;if(t){let s=e.codePointAt(i);for(;s===tp||s===np;)i++,s=e.codePointAt(i)}if(n){let s=e.codePointAt(a-1);for(;s===tp||s===np;)a--,s=e.codePointAt(a-1)}return a>i?e.slice(i,a):""}function GC(e,t){const n={type:"text",value:XC(String(t.value))};return e.patch(t,n),e.applyData(t,n)}function QC(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)}const JC={blockquote:CC,break:EC,code:IC,delete:PC,emphasis:TC,footnoteReference:OC,heading:DC,html:_C,imageReference:MC,image:LC,inlineCode:$C,linkReference:zC,link:RC,listItem:BC,list:FC,paragraph:qC,root:UC,strong:HC,table:YC,tableCell:VC,tableRow:KC,text:GC,thematicBreak:QC,toml:to,yaml:to,definition:to,footnoteDefinition:to};function to(){}const lx=-1,Ol=0,ss=1,Do=2,Jd=3,Zd=4,ef=5,tf=6,cx=7,ux=8,ip=typeof self=="object"?self:globalThis,ZC=(e,t)=>{const n=(a,s)=>(e.set(s,a),a),i=a=>{if(e.has(a))return e.get(a);const[s,o]=t[a];switch(s){case Ol:case lx:return n(o,a);case ss:{const l=n([],a);for(const c of o)l.push(i(c));return l}case Do:{const l=n({},a);for(const[c,d]of o)l[i(c)]=i(d);return l}case Jd:return n(new Date(o),a);case Zd:{const{source:l,flags:c}=o;return n(new RegExp(l,c),a)}case ef:{const l=n(new Map,a);for(const[c,d]of o)l.set(i(c),i(d));return l}case tf:{const l=n(new Set,a);for(const c of o)l.add(i(c));return l}case cx:{const{name:l,message:c}=o;return n(new ip[l](c),a)}case ux:return n(BigInt(o),a);case"BigInt":return n(Object(BigInt(o)),a);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:l}=new Uint8Array(o);return n(new DataView(l),o)}}return n(new ip[s](o),a)};return i},ap=e=>ZC(new Map,e)(0),sa="",{toString:eE}={},{keys:tE}=Object,Ua=e=>{const t=typeof e;if(t!=="object"||!e)return[Ol,t];const n=eE.call(e).slice(8,-1);switch(n){case"Array":return[ss,sa];case"Object":return[Do,sa];case"Date":return[Jd,sa];case"RegExp":return[Zd,sa];case"Map":return[ef,sa];case"Set":return[tf,sa];case"DataView":return[ss,n]}return n.includes("Array")?[ss,n]:n.includes("Error")?[cx,n]:[Do,n]},no=([e,t])=>e===Ol&&(t==="function"||t==="symbol"),nE=(e,t,n,i)=>{const a=(o,l)=>{const c=i.push(o)-1;return n.set(l,c),c},s=o=>{if(n.has(o))return n.get(o);let[l,c]=Ua(o);switch(l){case Ol:{let u=o;switch(c){case"bigint":l=ux,u=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+c);u=null;break;case"undefined":return a([lx],o)}return a([l,u],o)}case ss:{if(c){let m=o;return c==="DataView"?m=new Uint8Array(o.buffer):c==="ArrayBuffer"&&(m=new Uint8Array(o)),a([c,[...m]],o)}const u=[],f=a([l,u],o);for(const m of o)u.push(s(m));return f}case Do:{if(c)switch(c){case"BigInt":return a([c,o.toString()],o);case"Boolean":case"Number":case"String":return a([c,o.valueOf()],o)}if(t&&"toJSON"in o)return s(o.toJSON());const u=[],f=a([l,u],o);for(const m of tE(o))(e||!no(Ua(o[m])))&&u.push([s(m),s(o[m])]);return f}case Jd:return a([l,o.toISOString()],o);case Zd:{const{source:u,flags:f}=o;return a([l,{source:u,flags:f}],o)}case ef:{const u=[],f=a([l,u],o);for(const[m,p]of o)(e||!(no(Ua(m))||no(Ua(p))))&&u.push([s(m),s(p)]);return f}case tf:{const u=[],f=a([l,u],o);for(const m of o)(e||!no(Ua(m)))&&u.push(s(m));return f}}const{message:d}=o;return a([l,{name:c,message:d}],o)};return s},sp=(e,{json:t,lossy:n}={})=>{const i=[];return nE(!(t||n),!!t,new Map,i)(e),i},_o=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?ap(sp(e,t)):structuredClone(e):(e,t)=>ap(sp(e,t));function rE(e,t){const n=[{type:"text",value:"↩"}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function iE(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function aE(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||rE,i=e.options.footnoteBackLabel||iE,a=e.options.footnoteLabel||"Footnotes",s=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<e.footnoteOrder.length;){const d=e.footnoteById.get(e.footnoteOrder[c]);if(!d)continue;const u=e.all(d),f=String(d.identifier).toUpperCase(),m=Na(f.toLowerCase());let p=0;const y=[],v=e.footnoteCounts.get(f);for(;v!==void 0&&++p<=v;){y.length>0&&y.push({type:"text",value:" "});let x=typeof n=="string"?n:n(c,p);typeof x=="string"&&(x={type:"text",value:x}),y.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+m+(p>1?"-"+p:""),dataFootnoteBackref:"",ariaLabel:typeof i=="string"?i:i(c,p),className:["data-footnote-backref"]},children:Array.isArray(x)?x:[x]})}const g=u[u.length-1];if(g&&g.type==="element"&&g.tagName==="p"){const x=g.children[g.children.length-1];x&&x.type==="text"?x.value+=" ":g.children.push({type:"text",value:" "}),g.children.push(...y)}else u.push(...y);const b={type:"element",tagName:"li",properties:{id:t+"fn-"+m},children:e.wrap(u,!0)};e.patch(d,b),l.push(b)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:s,properties:{..._o(o),id:"footnote-label"},children:[{type:"text",value:a}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(l,!0)},{type:"text",value:`
`}]}}const dx=function(e){if(e==null)return cE;if(typeof e=="function")return Dl(e);if(typeof e=="object")return Array.isArray(e)?sE(e):oE(e);if(typeof e=="string")return lE(e);throw new Error("Expected function, string, or object as test")};function sE(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=dx(e[n]);return Dl(i);function i(...a){let s=-1;for(;++s<t.length;)if(t[s].apply(this,a))return!0;return!1}}function oE(e){const t=e;return Dl(n);function n(i){const a=i;let s;for(s in e)if(a[s]!==t[s])return!1;return!0}}function lE(e){return Dl(t);function t(n){return n&&n.type===e}}function Dl(e){return t;function t(n,i,a){return!!(uE(n)&&e.call(this,n,typeof i=="number"?i:void 0,a||void 0))}}function cE(){return!0}function uE(e){return e!==null&&typeof e=="object"&&"type"in e}const fx=[],dE=!0,op=!1,fE="skip";function hE(e,t,n,i){let a;typeof t=="function"&&typeof n!="function"?(i=n,n=t):a=t;const s=dx(a),o=i?-1:1;l(e,void 0,[])();function l(c,d,u){const f=c&&typeof c=="object"?c:{};if(typeof f.type=="string"){const p=typeof f.tagName=="string"?f.tagName:typeof f.name=="string"?f.name:void 0;Object.defineProperty(m,"name",{value:"node ("+(c.type+(p?"<"+p+">":""))+")"})}return m;function m(){let p=fx,y,v,g;if((!t||s(c,d,u[u.length-1]||void 0))&&(p=mE(n(c,u)),p[0]===op))return p;if("children"in c&&c.children){const b=c;if(b.children&&p[0]!==fE)for(v=(i?b.children.length:-1)+o,g=u.concat(b);v>-1&&v<b.children.length;){const x=b.children[v];if(y=l(x,v,g)(),y[0]===op)return y;v=typeof y[1]=="number"?y[1]:v+o}}return p}}}function mE(e){return Array.isArray(e)?e:typeof e=="number"?[dE,e]:e==null?fx:[e]}function hx(e,t,n,i){let a,s,o;typeof t=="function"&&typeof n!="function"?(s=void 0,o=t,a=n):(s=t,o=n,a=i),hE(e,s,l,a);function l(c,d){const u=d[d.length-1],f=u?u.children.indexOf(c):void 0;return o(c,f,u)}}const Ru={}.hasOwnProperty,pE={};function gE(e,t){const n=t||pE,i=new Map,a=new Map,s=new Map,o={...JC,...n.handlers},l={all:d,applyData:vE,definitionById:i,footnoteById:a,footnoteCounts:s,footnoteOrder:[],handlers:o,one:c,options:n,patch:yE,wrap:bE};return hx(e,function(u){if(u.type==="definition"||u.type==="footnoteDefinition"){const f=u.type==="definition"?i:a,m=String(u.identifier).toUpperCase();f.has(m)||f.set(m,u)}}),l;function c(u,f){const m=u.type,p=l.handlers[m];if(Ru.call(l.handlers,m)&&p)return p(l,u,f);if(l.options.passThrough&&l.options.passThrough.includes(m)){if("children"in u){const{children:v,...g}=u,b=_o(g);return b.children=l.all(u),b}return _o(u)}return(l.options.unknownHandler||xE)(l,u,f)}function d(u){const f=[];if("children"in u){const m=u.children;let p=-1;for(;++p<m.length;){const y=l.one(m[p],u);if(y){if(p&&m[p-1].type==="break"&&(!Array.isArray(y)&&y.type==="text"&&(y.value=lp(y.value)),!Array.isArray(y)&&y.type==="element")){const v=y.children[0];v&&v.type==="text"&&(v.value=lp(v.value))}Array.isArray(y)?f.push(...y):f.push(y)}}}return f}}function yE(e,t){e.position&&(t.position=ek(e))}function vE(e,t){let n=t;if(e&&e.data){const i=e.data.hName,a=e.data.hChildren,s=e.data.hProperties;if(typeof i=="string")if(n.type==="element")n.tagName=i;else{const o="children"in n?n.children:[n];n={type:"element",tagName:i,properties:{},children:o}}n.type==="element"&&s&&Object.assign(n.properties,_o(s)),"children"in n&&n.children&&a!==null&&a!==void 0&&(n.children=a)}return n}function xE(e,t){const n=t.data||{},i="value"in t&&!(Ru.call(n,"hProperties")||Ru.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function bE(e,t){const n=[];let i=-1;for(t&&n.push({type:"text",value:`
`});++i<e.length;)i&&n.push({type:"text",value:`
`}),n.push(e[i]);return t&&e.length>0&&n.push({type:"text",value:`
`}),n}function lp(e){let t=0,n=e.charCodeAt(t);for(;n===9||n===32;)t++,n=e.charCodeAt(t);return e.slice(t)}function cp(e,t){const n=gE(e,t),i=n.one(e,void 0),a=aE(n),s=Array.isArray(i)?{type:"root",children:i}:i||{type:"root",children:[]};return a&&s.children.push({type:"text",value:`
`},a),s}function jE(e,t){return e&&"run"in e?async function(n,i){const a=cp(n,{file:i,...t});await e.run(a,i)}:function(n,i){return cp(n,{file:i,...e||t})}}function up(e){if(e)throw e}var Eo=Object.prototype.hasOwnProperty,mx=Object.prototype.toString,dp=Object.defineProperty,fp=Object.getOwnPropertyDescriptor,hp=function(t){return typeof Array.isArray=="function"?Array.isArray(t):mx.call(t)==="[object Array]"},mp=function(t){if(!t||mx.call(t)!=="[object Object]")return!1;var n=Eo.call(t,"constructor"),i=t.constructor&&t.constructor.prototype&&Eo.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!i)return!1;var a;for(a in t);return typeof a>"u"||Eo.call(t,a)},pp=function(t,n){dp&&n.name==="__proto__"?dp(t,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):t[n.name]=n.newValue},gp=function(t,n){if(n==="__proto__")if(Eo.call(t,n)){if(fp)return fp(t,n).value}else return;return t[n]},wE=function e(){var t,n,i,a,s,o,l=arguments[0],c=1,d=arguments.length,u=!1;for(typeof l=="boolean"&&(u=l,l=arguments[1]||{},c=2),(l==null||typeof l!="object"&&typeof l!="function")&&(l={});c<d;++c)if(t=arguments[c],t!=null)for(n in t)i=gp(l,n),a=gp(t,n),l!==a&&(u&&a&&(mp(a)||(s=hp(a)))?(s?(s=!1,o=i&&hp(i)?i:[]):o=i&&mp(i)?i:{},pp(l,{name:n,newValue:e(u,o,a)})):typeof a<"u"&&pp(l,{name:n,newValue:a}));return l};const Qc=Pr(wE);function Bu(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function SE(){const e=[],t={run:n,use:i};return t;function n(...a){let s=-1;const o=a.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);l(null,...a);function l(c,...d){const u=e[++s];let f=-1;if(c){o(c);return}for(;++f<a.length;)(d[f]===null||d[f]===void 0)&&(d[f]=a[f]);a=d,u?NE(u,l)(...d):o(null,...d)}}function i(a){if(typeof a!="function")throw new TypeError("Expected `middelware` to be a function, not "+a);return e.push(a),t}}function NE(e,t){let n;return i;function i(...o){const l=e.length>o.length;let c;l&&o.push(a);try{c=e.apply(this,o)}catch(d){const u=d;if(l&&n)throw u;return a(u)}l||(c&&c.then&&typeof c.then=="function"?c.then(s,a):c instanceof Error?a(c):s(c))}function a(o,...l){n||(n=!0,t(o,...l))}function s(o){a(null,o)}}const jr={basename:kE,dirname:AE,extname:CE,join:EE,sep:"/"};function kE(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');Ss(e);let n=0,i=-1,a=e.length,s;if(t===void 0||t.length===0||t.length>e.length){for(;a--;)if(e.codePointAt(a)===47){if(s){n=a+1;break}}else i<0&&(s=!0,i=a+1);return i<0?"":e.slice(n,i)}if(t===e)return"";let o=-1,l=t.length-1;for(;a--;)if(e.codePointAt(a)===47){if(s){n=a+1;break}}else o<0&&(s=!0,o=a+1),l>-1&&(e.codePointAt(a)===t.codePointAt(l--)?l<0&&(i=a):(l=-1,i=o));return n===i?i=o:i<0&&(i=e.length),e.slice(n,i)}function AE(e){if(Ss(e),e.length===0)return".";let t=-1,n=e.length,i;for(;--n;)if(e.codePointAt(n)===47){if(i){t=n;break}}else i||(i=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function CE(e){Ss(e);let t=e.length,n=-1,i=0,a=-1,s=0,o;for(;t--;){const l=e.codePointAt(t);if(l===47){if(o){i=t+1;break}continue}n<0&&(o=!0,n=t+1),l===46?a<0?a=t:s!==1&&(s=1):a>-1&&(s=-1)}return a<0||n<0||s===0||s===1&&a===n-1&&a===i+1?"":e.slice(a,n)}function EE(...e){let t=-1,n;for(;++t<e.length;)Ss(e[t]),e[t]&&(n=n===void 0?e[t]:n+"/"+e[t]);return n===void 0?".":IE(n)}function IE(e){Ss(e);const t=e.codePointAt(0)===47;let n=PE(e,!t);return n.length===0&&!t&&(n="."),n.length>0&&e.codePointAt(e.length-1)===47&&(n+="/"),t?"/"+n:n}function PE(e,t){let n="",i=0,a=-1,s=0,o=-1,l,c;for(;++o<=e.length;){if(o<e.length)l=e.codePointAt(o);else{if(l===47)break;l=47}if(l===47){if(!(a===o-1||s===1))if(a!==o-1&&s===2){if(n.length<2||i!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(c=n.lastIndexOf("/"),c!==n.length-1){c<0?(n="",i=0):(n=n.slice(0,c),i=n.length-1-n.lastIndexOf("/")),a=o,s=0;continue}}else if(n.length>0){n="",i=0,a=o,s=0;continue}}t&&(n=n.length>0?n+"/..":"..",i=2)}else n.length>0?n+="/"+e.slice(a+1,o):n=e.slice(a+1,o),i=o-a-1;a=o,s=0}else l===46&&s>-1?s++:s=-1}return n}function Ss(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const TE={cwd:OE};function OE(){return"/"}function Wu(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function DE(e){if(typeof e=="string")e=new URL(e);else if(!Wu(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return _E(e)}function _E(e){if(e.hostname!==""){const i=new TypeError('File URL host must be "localhost" or empty on darwin');throw i.code="ERR_INVALID_FILE_URL_HOST",i}const t=e.pathname;let n=-1;for(;++n<t.length;)if(t.codePointAt(n)===37&&t.codePointAt(n+1)===50){const i=t.codePointAt(n+2);if(i===70||i===102){const a=new TypeError("File URL path must not include encoded / characters");throw a.code="ERR_INVALID_FILE_URL_PATH",a}}return decodeURIComponent(t)}const Jc=["history","path","basename","stem","extname","dirname"];class px{constructor(t){let n;t?Wu(t)?n={path:t}:typeof t=="string"||ME(t)?n={value:t}:n=t:n={},this.cwd="cwd"in n?"":TE.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let i=-1;for(;++i<Jc.length;){const s=Jc[i];s in n&&n[s]!==void 0&&n[s]!==null&&(this[s]=s==="history"?[...n[s]]:n[s])}let a;for(a in n)Jc.includes(a)||(this[a]=n[a])}get basename(){return typeof this.path=="string"?jr.basename(this.path):void 0}set basename(t){eu(t,"basename"),Zc(t,"basename"),this.path=jr.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?jr.dirname(this.path):void 0}set dirname(t){yp(this.basename,"dirname"),this.path=jr.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?jr.extname(this.path):void 0}set extname(t){if(Zc(t,"extname"),yp(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=jr.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){Wu(t)&&(t=DE(t)),eu(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?jr.basename(this.path,this.extname):void 0}set stem(t){eu(t,"stem"),Zc(t,"stem"),this.path=jr.join(this.dirname||"",t+(this.extname||""))}fail(t,n,i){const a=this.message(t,n,i);throw a.fatal=!0,a}info(t,n,i){const a=this.message(t,n,i);return a.fatal=void 0,a}message(t,n,i){const a=new Nn(t,n,i);return this.path&&(a.name=this.path+":"+a.name,a.file=this.path),a.fatal=!1,this.messages.push(a),a}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function Zc(e,t){if(e&&e.includes(jr.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+jr.sep+"`")}function eu(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function yp(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function ME(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const LE=function(e){const i=this.constructor.prototype,a=i[e],s=function(){return a.apply(s,arguments)};return Object.setPrototypeOf(s,i),s},$E={}.hasOwnProperty;class nf extends LE{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=SE()}copy(){const t=new nf;let n=-1;for(;++n<this.attachers.length;){const i=this.attachers[n];t.use(...i)}return t.data(Qc(!0,{},this.namespace)),t}data(t,n){return typeof t=="string"?arguments.length===2?(ru("data",this.frozen),this.namespace[t]=n,this):$E.call(this.namespace,t)&&this.namespace[t]||void 0:t?(ru("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...i]=this.attachers[this.freezeIndex];if(i[0]===!1)continue;i[0]===!0&&(i[0]=void 0);const a=n.call(t,...i);typeof a=="function"&&this.transformers.use(a)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const n=ro(t),i=this.parser||this.Parser;return tu("parse",i),i(String(n),n)}process(t,n){const i=this;return this.freeze(),tu("process",this.parser||this.Parser),nu("process",this.compiler||this.Compiler),n?a(void 0,n):new Promise(a);function a(s,o){const l=ro(t),c=i.parse(l);i.run(c,l,function(u,f,m){if(u||!f||!m)return d(u);const p=f,y=i.stringify(p,m);BE(y)?m.value=y:m.result=y,d(u,m)});function d(u,f){u||!f?o(u):s?s(f):n(void 0,f)}}}processSync(t){let n=!1,i;return this.freeze(),tu("processSync",this.parser||this.Parser),nu("processSync",this.compiler||this.Compiler),this.process(t,a),xp("processSync","process",n),i;function a(s,o){n=!0,up(s),i=o}}run(t,n,i){vp(t),this.freeze();const a=this.transformers;return!i&&typeof n=="function"&&(i=n,n=void 0),i?s(void 0,i):new Promise(s);function s(o,l){const c=ro(n);a.run(t,c,d);function d(u,f,m){const p=f||t;u?l(u):o?o(p):i(void 0,p,m)}}}runSync(t,n){let i=!1,a;return this.run(t,n,s),xp("runSync","run",i),a;function s(o,l){up(o),a=l,i=!0}}stringify(t,n){this.freeze();const i=ro(n),a=this.compiler||this.Compiler;return nu("stringify",a),vp(t),a(t,i)}use(t,...n){const i=this.attachers,a=this.namespace;if(ru("use",this.frozen),t!=null)if(typeof t=="function")c(t,n);else if(typeof t=="object")Array.isArray(t)?l(t):o(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function s(d){if(typeof d=="function")c(d,[]);else if(typeof d=="object")if(Array.isArray(d)){const[u,...f]=d;c(u,f)}else o(d);else throw new TypeError("Expected usable value, not `"+d+"`")}function o(d){if(!("plugins"in d)&&!("settings"in d))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(d.plugins),d.settings&&(a.settings=Qc(!0,a.settings,d.settings))}function l(d){let u=-1;if(d!=null)if(Array.isArray(d))for(;++u<d.length;){const f=d[u];s(f)}else throw new TypeError("Expected a list of plugins, not `"+d+"`")}function c(d,u){let f=-1,m=-1;for(;++f<i.length;)if(i[f][0]===d){m=f;break}if(m===-1)i.push([d,...u]);else if(u.length>0){let[p,...y]=u;const v=i[m][1];Bu(v)&&Bu(p)&&(p=Qc(!0,v,p)),i[m]=[d,p,...y]}}}}const zE=new nf().freeze();function tu(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function nu(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function ru(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function vp(e){if(!Bu(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function xp(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function ro(e){return RE(e)?e:new px(e)}function RE(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function BE(e){return typeof e=="string"||WE(e)}function WE(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const FE="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",bp=[],jp={allowDangerousHtml:!0},qE=/^(https?|ircs?|mailto|xmpp)$/i,UE=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function HE(e){const t=YE(e),n=KE(e);return VE(t.runSync(t.parse(n),n),e)}function YE(e){const t=e.rehypePlugins||bp,n=e.remarkPlugins||bp,i=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...jp}:jp;return zE().use(AC).use(n).use(jE,i).use(t)}function KE(e){const t=e.children||"",n=new px;return typeof t=="string"&&(n.value=t),n}function VE(e,t){const n=t.allowedElements,i=t.allowElement,a=t.components,s=t.disallowedElements,o=t.skipHtml,l=t.unwrapDisallowed,c=t.urlTransform||XE;for(const u of UE)Object.hasOwn(t,u.from)&&(""+u.from+(u.to?"use `"+u.to+"` instead":"remove it")+FE+u.id,void 0);return hx(e,d),ak(e,{Fragment:r.Fragment,components:a,ignoreInvalidStyle:!0,jsx:r.jsx,jsxs:r.jsxs,passKeys:!0,passNode:!0});function d(u,f,m){if(u.type==="raw"&&m&&typeof f=="number")return o?m.children.splice(f,1):m.children[f]={type:"text",value:u.value},f;if(u.type==="element"){let p;for(p in Vc)if(Object.hasOwn(Vc,p)&&Object.hasOwn(u.properties,p)){const y=u.properties[p],v=Vc[p];(v===null||v.includes(u.tagName))&&(u.properties[p]=c(String(y||""),p,u))}}if(u.type==="element"){let p=n?!n.includes(u.tagName):s?s.includes(u.tagName):!1;if(!p&&i&&typeof f=="number"&&(p=!i(u,f,m)),p&&m&&typeof f=="number")return l&&u.children?m.children.splice(f,1,...u.children):m.children.splice(f,1),f}}}function XE(e){const t=e.indexOf(":"),n=e.indexOf("?"),i=e.indexOf("#"),a=e.indexOf("/");return t===-1||a!==-1&&t>a||n!==-1&&t>n||i!==-1&&t>i||qE.test(e.slice(0,t))?e:""}function GE({isOpen:e,onClose:t}){const[n,i]=h.useState(!1),[a,s]=h.useState(null),[o,l]=h.useState(""),[c,d]=h.useState("");h.useEffect(()=>{e&&(d(""),l(""),s(null))},[e]);const u=async()=>{if(!c.trim()){s("질문을 입력해주세요.");return}i(!0),s(null),l("");try{const m=await fetch("/api/v1/activity-analysis-ai/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:c.trim()})});if(!m.ok)throw new Error(`HTTP ${m.status}`);const p=await m.json();p.error?s(p.error):p.analysis?l(p.analysis):s("분석 결과를 받지 못했습니다.")}catch(m){s(m.message||"분석 중 오류가 발생했습니다.")}finally{i(!1)}},f=m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),u())};return e?r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:t,children:r.jsxs("div",{style:{background:"var(--panel)",borderRadius:16,boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",width:"90%",maxWidth:1e3,maxHeight:"90vh",display:"flex",flexDirection:"column"},onClick:m=>m.stopPropagation(),children:[r.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"16px 16px 0 0"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"rgba(255, 255, 255, 0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("span",{style:{fontSize:24},children:"🤖"})}),r.jsxs("div",{children:[r.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"white"},children:"활동분석 AI Agent"}),r.jsx("p",{style:{margin:"4px 0 0 0",fontSize:13,color:"rgba(255, 255, 255, 0.8)"},children:"AI가 활동 데이터를 분석하여 인사이트를 제공합니다"})]})]}),r.jsx("button",{onClick:t,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:8,width:36,height:36,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"white",fontSize:20,fontWeight:"bold"},children:"×"})]}),r.jsx("div",{style:{padding:"20px 24px",borderBottom:"1px solid var(--border)",background:"var(--background)"},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13,color:"var(--text)",display:"block",marginBottom:8,fontWeight:600},children:"무엇을 분석해드릴까요?"}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("textarea",{value:c,onChange:m=>d(m.target.value),onKeyPress:f,placeholder:`예: 이번 주 김철수 사원의 활동을 분석해줘
예: 지난달 우리 팀의 주요 활동은 무엇이었나요?
예: 최근 2주간 미완료된 활동들을 요약해줘`,disabled:n,style:{flex:1,padding:"12px 16px",border:"1px solid var(--border)",borderRadius:10,fontSize:14,background:"var(--panel)",color:"var(--text)",resize:"vertical",minHeight:80,fontFamily:"inherit",lineHeight:1.5}}),r.jsx("button",{onClick:u,disabled:n||!c.trim(),style:{padding:"12px 24px",background:n||!c.trim()?"#ccc":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:10,color:"white",fontSize:14,fontWeight:600,cursor:n||!c.trim()?"not-allowed":"pointer",whiteSpace:"nowrap",boxShadow:n||!c.trim()?"none":"0 2px 8px rgba(102, 126, 234, 0.3)",transition:"all 0.2s ease"},children:n?"분석 중...":"분석하기"})]})]}),r.jsxs("div",{style:{fontSize:12,color:"var(--muted)",display:"flex",gap:8,flexWrap:"wrap"},children:[r.jsx("span",{children:"💡 예시:"}),r.jsx("button",{onClick:()=>d("이번 주 활동을 요약해줘"),disabled:n,style:{background:"none",border:"1px solid var(--border)",borderRadius:6,padding:"4px 10px",fontSize:11,color:"var(--text)",cursor:"pointer"},children:"이번 주 활동 요약"}),r.jsx("button",{onClick:()=>d("지난주 달성률은 어떻게 되나요?"),disabled:n,style:{background:"none",border:"1px solid var(--border)",borderRadius:6,padding:"4px 10px",fontSize:11,color:"var(--text)",cursor:"pointer"},children:"지난주 달성률"}),r.jsx("button",{onClick:()=>d("최근 한 달간 주요 고객 방문 내역을 알려줘"),disabled:n,style:{background:"none",border:"1px solid var(--border)",borderRadius:6,padding:"4px 10px",fontSize:11,color:"var(--text)",cursor:"pointer"},children:"최근 고객 방문"})]})]})}),r.jsxs("div",{style:{flex:1,overflow:"auto",padding:24},children:[n&&r.jsxs("div",{style:{textAlign:"center",padding:40},children:[r.jsx("div",{style:{width:40,height:40,border:"4px solid var(--border)",borderTop:"4px solid #667eea",borderRadius:"50%",margin:"0 auto 16px",animation:"spin 1s linear infinite"}}),r.jsx("p",{style:{color:"var(--muted)",fontSize:14},children:"AI가 활동 데이터를 분석하고 있습니다..."}),r.jsx("style",{children:`
                @keyframes spin {
                  0% { transform: rotate(0deg); }
                  100% { transform: rotate(360deg); }
                }
              `})]}),a&&r.jsxs("div",{style:{padding:16,background:"#fee",border:"1px solid #fcc",borderRadius:8,color:"#c33",fontSize:14},children:[r.jsx("strong",{children:"오류:"})," ",a]}),!n&&!a&&o&&r.jsx("div",{style:{fontSize:14,lineHeight:1.7,color:"var(--text)"},className:"markdown-content",children:r.jsx(HE,{children:o})}),!n&&!a&&!o&&r.jsxs("div",{style:{textAlign:"center",padding:40,color:"var(--muted)"},children:[r.jsx("div",{style:{fontSize:48,marginBottom:16},children:"💬"}),r.jsx("p",{style:{fontSize:15,marginBottom:8},children:"활동 분석에 대해 무엇이든 물어보세요!"}),r.jsx("p",{style:{fontSize:13},children:"자연어로 질문하시면 AI가 활동 데이터를 분석하여 답변해드립니다."})]})]})]})}):null}function io({value:e,max:t,color:n,label:i}){const a=Math.max(0,Math.min(100,t>0?e/t*100:0));return r.jsxs("div",{"aria-label":i,style:{position:"relative",width:"100%",height:11,background:"rgba(0,0,0,.04)",borderRadius:999,overflow:"hidden"},children:[r.jsx("div",{style:{width:`${a}%`,height:"100%",background:n,borderRadius:999,transition:"width .2s ease"}}),r.jsx("div",{style:{position:"absolute",right:6,top:0,bottom:0,display:"flex",alignItems:"center",fontSize:10,color:"var(--text)"},children:e})]})}function QE(){const[e,t]=h.useState(!0),[n,i]=h.useState(null),[a,s]=h.useState([]),[o,l]=h.useState(0),[c,d]=h.useState("default"),[u,f]=h.useState(!1),[m,p]=h.useState([]),[y,v]=h.useState(!0),[g,b]=h.useState(null);h.useEffect(()=>{let L=!1;async function T(){t(!0),i(null);try{const $=await fetch("/api/v1/employees");if(!$.ok)throw new Error(`EMP HTTP ${$.status}`);const V=await $.json();if(L)return;const G=(Array.isArray(V)?V:[]).map((ne,U)=>({id:String(ne.assignee_id??ne.emp_id??U),name:String(ne.emp_name??""),prevWeek:{plan:0,actual:0},thisWeek:{plan:0,actual:0},nextWeek:{plan:0,actual:0}}));s(G);try{const[ne,U]=await Promise.all([ao(o),ao(o-1)]);if(L)return;const I=Sp(ne),P=iu(U);s(G.map(D=>{const S=I.get(D.id),_=P.get(D.id);return{...D,prevWeek:{plan:(_==null?void 0:_.plan)??0,actual:(_==null?void 0:_.actual)??0},thisWeek:{plan:(S==null?void 0:S.thisPlan)??0,actual:(S==null?void 0:S.thisActual)??0},nextWeek:{plan:(S==null?void 0:S.nextPlan)??0,actual:(S==null?void 0:S.nextActual)??0}}}))}catch{i("주간 활동 요약을 불러오지 못했습니다")}}catch{if(L)return;i("직원 목록을 불러오지 못했습니다");try{const V=await ao(o),G=await ao(o-1).catch(()=>[]);if(L)return;const ne=iu(G),U=(Array.isArray(V)?V:[]).map((I,P)=>{var _,H,q,K;const D=String(I.assignee_id??I.emp_id??P),S=ne.get(D);return{id:D,name:String(I.emp_name??""),prevWeek:{plan:(S==null?void 0:S.plan)??0,actual:(S==null?void 0:S.actual)??0},thisWeek:{plan:Number(((_=I.thisWeek)==null?void 0:_.plan)??0),actual:Number(((H=I.thisWeek)==null?void 0:H.actual)??0)},nextWeek:{plan:Number(((q=I.nextWeek)==null?void 0:q.plan)??0),actual:Number(((K=I.nextWeek)==null?void 0:K.actual)??0)}}});s(U)}catch{s([{id:"e01",name:"김영업",prevWeek:{plan:0,actual:0},thisWeek:{plan:0,actual:0},nextWeek:{plan:0,actual:0}},{id:"e02",name:"박세일",prevWeek:{plan:0,actual:0},thisWeek:{plan:0,actual:0},nextWeek:{plan:0,actual:0}}])}}finally{L||t(!1)}}return T(),()=>{L=!0}},[o]),h.useEffect(()=>{let L=!1;async function T(){v(!0),b(null);try{const[$,V]=await Promise.all([wp(o),wp(o-1)]);if(L)return;const G=Sp($),ne=iu(V),U=new Set;for(const P of[...$,...V]){const D=String(P.assignee_id??P.emp_id??"");D&&U.add(D)}const I=Array.from(U).map(P=>{const D=G.get(P),S=ne.get(P),_=$.find(q=>String(q.assignee_id??q.emp_id)===P)||V.find(q=>String(q.assignee_id??q.emp_id)===P),H=_?String(_.emp_name??P):P;return{id:P,name:H,prevWeek:{plan:(S==null?void 0:S.plan)??0,actual:(S==null?void 0:S.actual)??0},thisWeek:{plan:(D==null?void 0:D.thisPlan)??0,actual:(D==null?void 0:D.thisActual)??0},nextWeek:{plan:(D==null?void 0:D.nextPlan)??0,actual:(D==null?void 0:D.nextActual)??0}}});I.sort((P,D)=>P.name.localeCompare(D.name)),p(I)}catch{if(L)return;b("지역 활동 계획을 불러오지 못했습니다"),p([])}finally{L||v(!1)}}return T(),()=>{L=!0}},[o]);const x=h.useMemo(()=>{let L=1;for(const T of a)L=Math.max(L,T.prevWeek.plan,T.prevWeek.actual,T.thisWeek.plan,T.thisWeek.actual,T.nextWeek.plan,T.nextWeek.actual);return L},[a]),N=h.useMemo(()=>{let L=1;for(const T of m)L=Math.max(L,T.prevWeek.plan,T.prevWeek.actual,T.thisWeek.plan,T.thisWeek.actual,T.nextWeek.plan,T.nextWeek.actual);return L},[m]),A=h.useMemo(()=>a.map(L=>{const T=L.prevWeek.plan,$=L.prevWeek.actual,V=T>0?$/T*100:0;return{...L,achievementRate:V,prevTotal:T}}),[a]),C=h.useMemo(()=>m.map(L=>{const T=L.prevWeek.plan,$=L.prevWeek.actual,V=T>0?$/T*100:0;return{...L,achievementRate:V,prevTotal:T}}),[m]),w=h.useMemo(()=>{const L=[...A];return c==="rate-high"?L.sort((T,$)=>$.achievementRate-T.achievementRate):c==="rate-low"?L.sort((T,$)=>T.achievementRate-$.achievementRate):L},[A,c]),O=h.useMemo(()=>{const L=[...C];return c==="rate-high"?L.sort((T,$)=>$.achievementRate-T.achievementRate):c==="rate-low"?L.sort((T,$)=>T.achievementRate-$.achievementRate):L},[C,c]),M="#3b82f6",B="#10b981",z=Te.useCallback((L,T,$,V)=>{const G=vm(o+T);try{window.dispatchEvent(new CustomEvent(V?"tnt.sales.region-plans.select":"tnt.sales.activities.select",{detail:{assigneeId:L.id,empName:L.name,startIso:G.start.toISOString(),endIso:G.end.toISOString(),label:`${L.name} · ${$} 계획/실적`,isRegion:V||!1}}))}catch{}},[o]),j=h.useMemo(()=>aS(vm(o)),[o]);function k(L,T){const $=L>=90?"#10b981":L>=70?"#f59e0b":"#ef4444";return{display:T?`${Math.round(L)}%`:"-",color:$}}return r.jsxs("section",{className:"sales-activities-panel",style:{display:"flex",flexDirection:"column",gap:20},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:16,paddingBottom:12,borderBottom:"2px solid var(--border)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:12},children:[r.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700},children:"활동관리"}),r.jsx("div",{className:"muted",style:{fontSize:13,fontWeight:500},children:"주간 계획·실적"})]}),r.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[r.jsxs("div",{className:"card",style:{display:"inline-flex",alignItems:"center",gap:8,padding:"0 12px",border:"1px solid var(--border)",borderRadius:10,background:"var(--panel)",boxShadow:"0 1px 3px rgba(0,0,0,.05)",height:44},children:[r.jsx("button",{className:"icon-button",title:"전주","aria-label":"전주",onClick:()=>l(L=>L-1),onKeyDown:L=>{(L.key==="Enter"||L.key===" ")&&(L.preventDefault(),l(T=>T-1))},style:{width:30,height:30,borderRadius:6},children:r.jsx("img",{src:Sv,className:"icon",alt:"전주"})}),r.jsx("button",{className:"icon-button",title:"이번주로","aria-label":"이번주로",onClick:()=>l(0),onKeyDown:L=>{(L.key==="Enter"||L.key===" ")&&(L.preventDefault(),l(0))},style:{width:30,height:30,borderRadius:6},children:r.jsx("img",{src:o2,className:"icon",alt:"이번주로"})}),r.jsx("button",{className:"icon-button",title:"다음주","aria-label":"다음주",onClick:()=>l(L=>L+1),onKeyDown:L=>{(L.key==="Enter"||L.key===" ")&&(L.preventDefault(),l(T=>T+1))},style:{width:30,height:30,borderRadius:6},children:r.jsx("img",{src:Nv,className:"icon",alt:"다음주"})}),r.jsx("span",{className:"muted",style:{fontSize:12,marginLeft:4,whiteSpace:"nowrap",fontWeight:600,minWidth:140,textAlign:"center"},children:j})]}),r.jsxs("div",{className:"card",style:{padding:"0 12px",border:"1px solid var(--border)",borderRadius:10,display:"inline-flex",alignItems:"center",gap:8,background:"var(--panel)",boxShadow:"0 1px 3px rgba(0,0,0,.05)",height:44},children:[r.jsx("label",{htmlFor:"sort-select",style:{fontSize:12,color:"var(--text-muted)",fontWeight:500,display:"flex",alignItems:"center"},children:"정렬"}),r.jsxs("select",{id:"sort-select",value:c,onChange:L=>d(L.target.value),style:{fontSize:12,padding:"4px 8px",border:"1px solid var(--border)",borderRadius:6,background:"var(--panel)",color:"var(--text)",cursor:"pointer",fontWeight:500},children:[r.jsx("option",{value:"default",children:"기본"}),r.jsx("option",{value:"rate-high",children:"달성률 높은순"}),r.jsx("option",{value:"rate-low",children:"달성률 낮은순"})]})]}),r.jsxs("div",{className:"card",style:{padding:"0 14px",border:"1px solid var(--border)",borderRadius:10,display:"inline-flex",alignItems:"center",gap:12,fontSize:11,background:"var(--panel)",boxShadow:"0 1px 3px rgba(0,0,0,.05)",height:44},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{width:10,height:10,background:M,borderRadius:2}}),r.jsx("span",{style:{fontWeight:500},children:"계획"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{width:10,height:10,background:B,borderRadius:2}}),r.jsx("span",{style:{fontWeight:500},children:"실적"})]})]}),r.jsxs("button",{className:"btn",onClick:()=>f(!0),style:{display:"inline-flex",alignItems:"center",gap:8,padding:"0 16px",height:44,border:"1px solid var(--accent)",borderRadius:10,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontSize:13,fontWeight:600,cursor:"pointer",boxShadow:"0 2px 8px rgba(102, 126, 234, 0.3)",transition:"all 0.2s ease"},onMouseEnter:L=>{L.currentTarget.style.transform="translateY(-1px)",L.currentTarget.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.4)"},onMouseLeave:L=>{L.currentTarget.style.transform="translateY(0)",L.currentTarget.style.boxShadow="0 2px 8px rgba(102, 126, 234, 0.3)"},children:[r.jsx("img",{src:l2,className:"icon",alt:"AI",style:{filter:"brightness(0) invert(1)",width:18,height:18}}),r.jsx("span",{children:"AI Agent(Beta)"})]})]})]}),e?r.jsx("div",{className:"muted",style:{padding:12,textAlign:"center",fontSize:13},children:"직원 목록을 불러오는 중…"}):null,n?r.jsx("div",{className:"error",style:{padding:12,borderRadius:8,background:"rgba(239,68,68,.1)",fontSize:13},children:n}):null,r.jsxs("div",{style:{background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,padding:20,boxShadow:"0 2px 8px rgba(0,0,0,.04)"},children:[r.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"var(--text)",marginBottom:16,paddingBottom:12,borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{style:{width:4,height:18,background:"#3b82f6",borderRadius:2}}),"영업 활동"]}),w.length===0?r.jsx("div",{className:"empty-state",style:{padding:16},children:"조회된 활동 데이터가 없습니다."}):r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 90px repeat(3, minmax(0, 1fr))",gap:"6px 12px",alignItems:"center"},children:[r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"영업사원"}),r.jsx("div",{className:"muted",style:{fontSize:12,textAlign:"center",fontWeight:700},children:"전주 달성률"}),r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"전주"}),r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"이번주"}),r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"차주"}),w.map(L=>{const T=k(L.achievementRate,L.prevTotal>0),$=[{key:"prev",label:"전주",data:L.prevWeek,offset:-1},{key:"this",label:"이번주",data:L.thisWeek,offset:0},{key:"next",label:"차주",data:L.nextWeek,offset:1}];return r.jsxs(Te.Fragment,{children:[r.jsx("div",{style:{padding:"3px 0",fontWeight:600,fontSize:12},children:L.name}),r.jsx("div",{style:{padding:"3px 0",textAlign:"center",fontWeight:700,color:T.color},children:T.display}),$.map(V=>r.jsx("div",{role:"button",tabIndex:0,title:`${V.label} 계획/실적 (클릭하여 상세보기)`,style:{cursor:"pointer",padding:"3px 0"},onClick:()=>z(L,V.offset,V.label),onKeyDown:G=>{(G.key==="Enter"||G.key===" ")&&(G.preventDefault(),z(L,V.offset,V.label))},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3,pointerEvents:"none"},children:[r.jsx(io,{value:V.data.plan,max:x,color:M,label:`${L.name} ${V.label} 계획`}),r.jsx(io,{value:V.data.actual,max:x,color:B,label:`${L.name} ${V.label} 실적`})]})},`${L.id}-${V.key}`))]},L.id)})]})]}),r.jsxs("div",{style:{background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,padding:20,boxShadow:"0 2px 8px rgba(0,0,0,.04)"},children:[r.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"var(--text)",marginBottom:16,paddingBottom:12,borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{style:{width:4,height:18,background:"#10b981",borderRadius:2}}),"지역 활동 계획"]}),y?r.jsx("div",{className:"muted",style:{padding:12,textAlign:"center",fontSize:13},children:"지역 활동 계획을 불러오는 중…"}):g?r.jsx("div",{className:"error",style:{padding:12,borderRadius:8,background:"rgba(239,68,68,.1)",fontSize:13},children:g}):O.length===0?r.jsx("div",{className:"muted",style:{padding:12,textAlign:"center",fontSize:13},children:"지역 활동 계획 데이터가 없습니다."}):r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 90px repeat(3, minmax(0, 1fr))",gap:"6px 12px",alignItems:"center"},children:[r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"영업사원"}),r.jsx("div",{className:"muted",style:{fontSize:12,textAlign:"center",fontWeight:700},children:"전주 달성률"}),r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"전주"}),r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"이번주"}),r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"차주"}),O.map(L=>{const T=k(L.achievementRate,L.prevTotal>0),$=[{key:"prev",label:"전주",data:L.prevWeek,offset:-1},{key:"this",label:"이번주",data:L.thisWeek,offset:0},{key:"next",label:"차주",data:L.nextWeek,offset:1}];return r.jsxs(Te.Fragment,{children:[r.jsx("div",{style:{padding:"3px 0",fontWeight:600,fontSize:12},children:L.name}),r.jsx("div",{style:{padding:"3px 0",textAlign:"center",fontWeight:700,color:T.color},children:T.display}),$.map(V=>r.jsx("div",{role:"button",tabIndex:0,title:`${V.label} 계획/실적 (클릭하여 상세보기)`,style:{cursor:"pointer",padding:"3px 0"},onClick:()=>z(L,V.offset,V.label,!0),onKeyDown:G=>{(G.key==="Enter"||G.key===" ")&&(G.preventDefault(),z(L,V.offset,V.label,!0))},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3,pointerEvents:"none"},children:[r.jsx(io,{value:V.data.plan,max:N,color:M,label:`${L.name} ${V.label} 계획`}),r.jsx(io,{value:V.data.actual,max:N,color:B,label:`${L.name} ${V.label} 실적`})]})},`${L.id}-${V.key}`))]},L.id)})]})]}),r.jsx(GE,{isOpen:u,onClose:()=>f(!1)})]})}async function ao(e){const t=await fetch(`/api/v1/sales-activities/summary/weekly?offsetWeeks=${encodeURIComponent(e)}&depts=all`);if(!t.ok)throw new Error(`SUM HTTP ${t.status}`);const n=await t.json();return Array.isArray(n)?n:[]}async function wp(e){const t=await fetch(`/api/v1/region-activity-plans/summary/weekly?offsetWeeks=${encodeURIComponent(e)}&depts=all`);if(!t.ok)throw new Error(`REGION HTTP ${t.status}`);const n=await t.json();return Array.isArray(n)?n:[]}function Sp(e){const t=new Map;for(const n of e){const i=String(n.assignee_id??n.emp_id??"");if(!i)continue;const a=n.thisWeek||{},s=n.nextWeek||{};t.set(i,{thisPlan:Number(a.plan??0),thisActual:Number(a.actual??0),nextPlan:Number(s.plan??0),nextActual:Number(s.actual??0)})}return t}function iu(e){const t=new Map;for(const n of e){const i=String(n.assignee_id??n.emp_id??"");if(!i)continue;const a=n.thisWeek||{};t.set(i,{plan:Number(a.plan??0),actual:Number(a.actual??0)})}return t}const JE=({isOpen:e,onClose:t,onSelect:n})=>{const[i,a]=h.useState(""),[s,o]=h.useState(""),[l,c]=h.useState([]),[d,u]=h.useState(!1),[f,m]=h.useState([]);if(Te.useEffect(()=>{e&&(a(""),o(""),c([]),fetch("/api/v1/inventory/subcategories-ag").then(y=>y.ok?y.json():[]).then(y=>m(y)).catch(y=>console.error("Failed to fetch subcategories",y)))},[e]),!e)return null;const p=async()=>{u(!0);try{const y=new URLSearchParams;i&&y.append("keyword",i),s&&y.append("subcategory",s);const v=await fetch(`/api/v1/inventory/items-popup?${y.toString()}`);if(v.ok){const g=await v.json();c(g)}}catch(y){console.error("Failed to search items",y)}finally{u(!1)}};return r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:50,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:8,boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",width:700,maxHeight:"80vh",display:"flex",flexDirection:"column",overflow:"hidden"},children:[r.jsxs("div",{style:{padding:"16px 24px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h2",{style:{fontSize:18,fontWeight:600,color:"#111827",margin:0},children:"품목 검색"}),r.jsx("button",{onClick:t,style:{background:"none",border:"none",cursor:"pointer",color:"#6b7280",padding:4},children:r.jsx(Rd,{size:20})})]}),r.jsxs("div",{style:{padding:16,borderBottom:"1px solid #e5e7eb",background:"#f9fafb",display:"flex",gap:8},children:[r.jsxs("select",{style:{border:"1px solid #d1d5db",borderRadius:6,padding:"8px 12px",fontSize:14,flex:1,outline:"none",background:"#fff"},value:s,onChange:y=>o(y.target.value),children:[r.jsx("option",{value:"",children:"전체 중분류"}),f.map(y=>r.jsx("option",{value:y,children:y},y))]}),r.jsx("input",{style:{border:"1px solid #d1d5db",borderRadius:6,padding:"8px 12px",fontSize:14,flex:1,outline:"none"},placeholder:"품목명/품목코드",value:i,onChange:y=>a(y.target.value),onKeyDown:y=>y.key==="Enter"&&p()}),r.jsxs("button",{onClick:p,style:{background:"#2563eb",color:"#fff",padding:"8px 16px",borderRadius:6,fontSize:14,fontWeight:500,border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:6},children:[r.jsx(zi,{size:16}),"검색"]})]}),r.jsx("div",{style:{flex:1,overflow:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f9fafb",position:"sticky",top:0,zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",fontWeight:600,borderBottom:"1px solid #e5e7eb"},children:"중분류"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",fontWeight:600,borderBottom:"1px solid #e5e7eb"},children:"품목코드"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",fontWeight:600,borderBottom:"1px solid #e5e7eb"},children:"품목명"})]})}),r.jsx("tbody",{children:d?r.jsx("tr",{children:r.jsx("td",{colSpan:3,style:{padding:"32px",textAlign:"center",color:"#6b7280",fontSize:14},children:"검색 중..."})}):l.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:3,style:{padding:"32px",textAlign:"center",color:"#6b7280",fontSize:14},children:"검색 결과가 없습니다."})}):l.map((y,v)=>r.jsxs("tr",{onClick:()=>{n(y.itemName),t()},style:{cursor:"pointer",borderBottom:"1px solid #f3f4f6"},onMouseEnter:g=>g.currentTarget.style.background="#f9fafb",onMouseLeave:g=>g.currentTarget.style.background="transparent",children:[r.jsx("td",{style:{padding:"12px 16px",fontSize:14,color:"#6b7280"},children:y.itemSubcategory}),r.jsx("td",{style:{padding:"12px 16px",fontSize:14,color:"#6b7280"},children:y.itemNo}),r.jsx("td",{style:{padding:"12px 16px",fontSize:14,color:"#111827",fontWeight:500},children:y.itemName})]},v))})]})})]})})};function ZE(){const[e,t]=h.useState([]),[n,i]=h.useState(!1),[a,s]=h.useState(null),[o,l]=h.useState("all"),[c,d]=h.useState("item"),[u,f]=h.useState(""),[m,p]=h.useState(""),[y,v]=h.useState(""),[g,b]=h.useState("ALL"),[x,N]=h.useState(""),[A,C]=h.useState(0),[w,O]=h.useState([]),[M,B]=h.useState(!1),z=async()=>{i(!0),s(null);try{const K=new URLSearchParams;u&&K.append("whName",u),m&&K.append("itemName",m),y&&K.append("category",y),x&&K.append("remainDayMax",x),A>0&&K.append("daysOffset",A.toString()),g!=="ALL"&&K.append("bizUnit",g);const W=await fetch(`/api/v1/inventory/expiry-stock-ag?${K.toString()}`);if(!W.ok)throw new Error(`API 호출 실패: ${W.status}`);const R=await W.json();Array.isArray(R)?t(R):R.error?(s(R.error),t([])):t([])}catch(K){console.error("유통기한재고(AG) 조회 실패:",K),s(K.message||"데이터 조회 중 오류가 발생했습니다.")}finally{i(!1)}},j=async()=>{try{console.log("Fetching warehouse options...");const K=await fetch("/api/v1/inventory/warehouses-ag");if(console.log("Warehouse response status:",K.status),K.ok){const W=await K.json();console.log("Warehouse data:",W),O(W)}else console.error("Warehouse fetch failed:",K.statusText)}catch(K){console.error("Failed to fetch warehouse options",K)}};h.useEffect(()=>{j()},[]),h.useEffect(()=>{z()},[]);const[k,L]=h.useState(new Set),[T,$]=h.useState(new Set),V=K=>{const W=new Set(k);W.has(K)?W.delete(K):W.add(K),L(W)},G=K=>{const W=new Set(T);W.has(K)?W.delete(K):W.add(K),$(W)},[ne,U]=h.useState(new Set);h.useEffect(()=>{try{window.dispatchEvent(new CustomEvent("tnt.inventory.expiry.selection",{detail:{count:ne.size,items:Array.from(ne)}}))}catch{}},[ne]),h.useEffect(()=>{const K=W=>{var Y;const R=(Y=W.detail)==null?void 0:Y.promotionId;if(!R)return;const oe=Array.from(ne);if(oe.length===0){alert("적용할 품목을 선택하세요.");return}alert(`프로모션 ${R}을(를) ${oe.length}개 품목에 적용합니다.`)};return window.addEventListener("tnt.inventory.apply-promotion",K),()=>window.removeEventListener("tnt.inventory.apply-promotion",K)},[ne]);const I=h.useMemo(()=>e.map(K=>{const W=K.remainDay||0;let R="good",oe="Normal",Y=100;return W<=0?(R="expired",oe="즉시 폐기",Y=0):W<=60?(R="critical",oe="긴급 처분 (Clearance)",Y=20):W<=120?(R="warning",oe="집중 모니터링",Y=50):oe="정상 판매",{...K,_status:R,_action:oe,_score:Y}}),[e]),P=h.useMemo(()=>I.filter(K=>o==="disposal"?K._status==="expired":o==="clearance"?K._status==="critical":o==="watch"?K._status==="warning":!0),[I,o]),D=h.useMemo(()=>{const K={};return P.forEach(W=>{const R=W.itemName||"Unknown";K[R]||(K[R]=[]),K[R].push(W)}),Object.keys(K).forEach(W=>{K[W].sort((R,oe)=>{const Y=R.expDate||"",X=oe.expDate||"";return Y.localeCompare(X)})}),K},[P]),S=h.useMemo(()=>{const K={};return I.forEach(W=>{const R=W.itemSubcategory||"미분류";K[R]||(K[R]={name:R,totalQty:0,expiredQty:0,criticalQty:0,warningQty:0,itemCount:0,totalScore:0,items:[]}),K[R].totalQty+=W.stockQty||0,K[R].itemCount+=1,K[R].totalScore+=W._score,K[R].items.push(W),W._status==="expired"&&(K[R].expiredQty+=W.stockQty||0),W._status==="critical"&&(K[R].criticalQty+=W.stockQty||0),W._status==="warning"&&(K[R].warningQty+=W.stockQty||0)}),Object.values(K).map(W=>({...W,avgScore:W.itemCount>0?Math.round(W.totalScore/W.itemCount):0,riskRatio:W.totalQty>0?Math.round((W.expiredQty+W.criticalQty)/W.totalQty*100):0,items:W.items.sort((R,oe)=>(R.itemName||"").localeCompare(oe.itemName||""))})).sort((W,R)=>R.riskRatio-W.riskRatio)},[I]),_=h.useMemo(()=>{const K=I.reduce((Y,X)=>Y+(X.stockQty||0),0),W=I.filter(Y=>Y._status==="expired").reduce((Y,X)=>Y+(X.stockQty||0),0),R=I.filter(Y=>Y._status==="critical").reduce((Y,X)=>Y+(X.stockQty||0),0),oe=I.filter(Y=>Y._status==="warning").reduce((Y,X)=>Y+(X.stockQty||0),0);return{totalQty:K,expiredQty:W,criticalQty:R,warningQty:oe}},[I]),H=K=>K?Number(K).toLocaleString("ko-KR"):"-",q=K=>{if(!K)return"-";const W=String(K);return W.length===8?`${W.substring(0,4)}-${W.substring(4,6)}-${W.substring(6,8)}`:W};return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{marginBottom:24,display:"flex",alignItems:"baseline",gap:12},children:[r.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"재고 건전성 분석"}),r.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"유통기한 기반 재고 리스크 분석 및 처분 제안"})]}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",marginBottom:20},children:[r.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex",marginRight:12},children:["ALL","TNT","DYS"].map(K=>r.jsx("button",{onClick:()=>b(K),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:g===K?"#fff":"transparent",color:g===K?"#2563eb":"#6b7280",boxShadow:g===K?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:K},K))}),r.jsxs("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex",marginRight:12},children:[r.jsxs("button",{onClick:()=>d("item"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:c==="item"?"#fff":"transparent",color:c==="item"?"#111827":"#6b7280",boxShadow:c==="item"?"0 1px 2px rgba(0,0,0,0.1)":"none",display:"flex",alignItems:"center",gap:6,whiteSpace:"nowrap"},children:[r.jsx(PS,{size:16}),"품목별 보기"]}),r.jsxs("button",{onClick:()=>d("category"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:c==="category"?"#fff":"transparent",color:c==="category"?"#111827":"#6b7280",boxShadow:c==="category"?"0 1px 2px rgba(0,0,0,0.1)":"none",display:"flex",alignItems:"center",gap:6,whiteSpace:"nowrap"},children:[r.jsx(kv,{size:16}),"중분류 분석"]})]}),r.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[r.jsx("input",{className:"search-input",placeholder:"품목명 검색 (클릭)",value:m,readOnly:!0,onClick:()=>B(!0),style:{width:180,paddingLeft:12,paddingRight:32,cursor:"pointer"}}),r.jsx(zi,{size:14,style:{position:"absolute",right:10,color:"#9ca3af",pointerEvents:"none"}})]}),r.jsx("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:r.jsxs("select",{className:"search-input",value:u,onChange:K=>f(K.target.value),style:{width:150},children:[r.jsx("option",{value:"",children:"전체 창고"}),w.map(K=>r.jsx("option",{value:K,children:K},K))]})}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,paddingLeft:12,borderLeft:"1px solid #e5e7eb"},children:[r.jsxs("select",{className:"search-input",value:A,onChange:K=>C(Number(K.target.value)),style:{width:130,color:A>0?"#ef4444":"inherit",fontWeight:A>0?600:400},children:[r.jsx("option",{value:0,children:"현재 기준"}),r.jsx("option",{value:7,children:"1주 후 예측"}),r.jsx("option",{value:14,children:"2주 후 예측"}),r.jsx("option",{value:21,children:"3주 후 예측"}),r.jsx("option",{value:28,children:"4주 후 예측"}),r.jsx("option",{value:60,children:"2개월 후 예측"}),r.jsx("option",{value:90,children:"3개월 후 예측"}),r.jsx("option",{value:180,children:"6개월 후 예측"})]}),r.jsx("input",{className:"search-input",type:"number",placeholder:"잔여일수(이하)",value:x,onChange:K=>N(K.target.value),style:{width:110}})]}),r.jsxs("div",{style:{display:"flex",gap:8,marginLeft:"auto"},children:[r.jsx("button",{className:"btn",onClick:z,disabled:n,style:{height:30,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",whiteSpace:"nowrap"},children:n?"분석 중...":"분석 실행"}),r.jsx("button",{className:"btn secondary",onClick:()=>{p(""),f(""),N(""),C(0),b("ALL"),z()},style:{height:30,padding:"0 12px",fontSize:13,whiteSpace:"nowrap"},children:"초기화"})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[r.jsx(so,{title:"전체 재고",value:H(_.totalQty),icon:r.jsx(jv,{size:24}),color:"#3b82f6"}),r.jsx(so,{title:"폐기 대상 (만료)",value:H(_.expiredQty),subtext:"즉시 조치 필요",icon:r.jsx(El,{size:24}),color:"#ef4444",active:o==="disposal"&&c==="item",onClick:()=>{l("disposal"),d("item")}}),r.jsx(so,{title:"긴급 처분 (<60일)",value:H(_.criticalQty),subtext:"프로모션 권장",icon:r.jsx(ES,{size:24}),color:"#f97316",active:o==="clearance"&&c==="item",onClick:()=>{l("clearance"),d("item")}}),r.jsx(so,{title:"관심 품목 (<120일)",value:H(_.warningQty),subtext:"모니터링 필요",icon:r.jsx(AS,{size:24}),color:"#eab308",active:o==="watch"&&c==="item",onClick:()=>{l("watch"),d("item")}})]})]}),c==="item"&&r.jsx("div",{style:{padding:"0 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:r.jsxs("div",{style:{display:"flex",gap:24},children:[r.jsx(oo,{label:"전체 목록",active:o==="all",onClick:()=>l("all")}),r.jsx(oo,{label:"폐기 대상",count:_.expiredQty,active:o==="disposal",onClick:()=>l("disposal"),color:"#ef4444"}),r.jsx(oo,{label:"긴급 처분",count:_.criticalQty,active:o==="clearance",onClick:()=>l("clearance"),color:"#f97316"}),r.jsx(oo,{label:"관심 품목",count:_.warningQty,active:o==="watch",onClick:()=>l("watch"),color:"#eab308"})]})}),r.jsx("div",{style:{flex:1,padding:24,overflow:"hidden",display:"flex",gap:24},children:r.jsx("div",{className:"card",style:{flex:1,height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:a?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:a}):e.length===0&&!n?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"데이터가 없습니다."}):r.jsx("div",{style:{overflow:"auto",flex:1},children:c==="item"?r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"품목명 / 코드"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"중분류"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"전체 재고"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"LOT 수"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"최단 유통기한"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"위험 상태"}),r.jsx("th",{style:{width:40}})]})}),r.jsx("tbody",{children:Object.entries(D).map(([K,W])=>{const R=W.reduce((de,be)=>de+(be.stockQty||0),0),oe=W.some(de=>de._status==="expired")?"expired":W.some(de=>de._status==="critical")?"critical":W.some(de=>de._status==="warning")?"warning":"safe",Y=W[0],X=T.has(K);return r.jsxs(Te.Fragment,{children:[r.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb",background:X?"#f9fafb":"#fff",cursor:"pointer"},onClick:()=>G(K),children:[r.jsxs("td",{style:{padding:"12px 16px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[Y.srcBizunit==="TNT"&&r.jsx("span",{style:{background:"#e0f2fe",color:"#0369a1",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"T"}),Y.srcBizunit==="DYS"&&r.jsx("span",{style:{background:"#fce7f3",color:"#be185d",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"D"}),r.jsx("div",{style:{fontWeight:600,color:"#111827"},children:K})]}),r.jsxs("div",{style:{fontSize:11,color:"#9ca3af",marginTop:2},children:[Y.itemNo," | ",Y.spec]})]}),r.jsx("td",{style:{padding:"12px 16px",color:"#4b5563",fontSize:12},children:Y.itemSubcategory}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600},children:H(R)}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:"#6b7280"},children:W.length}),r.jsx("td",{style:{padding:"12px 16px",color:"#4b5563"},children:q(Y.expDate)}),r.jsx("td",{style:{padding:"12px 16px"},children:r.jsx(Np,{status:oe})}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"center"},children:X?r.jsx(bm,{size:16}):r.jsx(ls,{size:16})})]}),X&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,style:{padding:0,background:"#f9fafb"},children:r.jsx("div",{style:{padding:"12px 24px",borderBottom:"1px solid #e5e7eb"},children:r.jsxs("table",{style:{width:"100%",fontSize:13},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"LOT No."}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"창고명"}),r.jsx("th",{style:{textAlign:"right",padding:"8px 12px",color:"#6b7280"},children:"재고"}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"유통기한"}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"잔여일수"}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"상태"}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"건전성"})]})}),r.jsx("tbody",{children:W.map((de,be)=>r.jsxs("tr",{style:{borderTop:"1px solid #e5e7eb"},children:[r.jsx("td",{style:{padding:"8px 12px",color:"#6b7280",fontFamily:"monospace"},children:de.lotNo||"-"}),r.jsx("td",{style:{padding:"8px 12px",color:"#6b7280"},children:de.whName||"-"}),r.jsx("td",{style:{padding:"8px 12px",textAlign:"right",fontWeight:600},children:H(de.stockQty)}),r.jsx("td",{style:{padding:"8px 12px",color:"#4b5563"},children:q(de.expDate)}),r.jsx("td",{style:{padding:"8px 12px"},children:r.jsxs("span",{style:{fontWeight:600,color:de.remainDay&&de.remainDay<=60?"#ef4444":"#111827"},children:[de.remainDay,"일"]})}),r.jsx("td",{style:{padding:"8px 12px"},children:r.jsx(Np,{status:de._status})}),r.jsx("td",{style:{padding:"8px 12px"},children:r.jsx(kp,{score:de._score})})]},be))})]})})})})]},K)})})]}):r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"순위"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"중분류명"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"전체 재고"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"폐기 대상"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"긴급 처분"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"관심 품목"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"리스크 비율"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"평균 건전성"}),r.jsx("th",{style:{width:40}})]})}),r.jsx("tbody",{children:S.map((K,W)=>r.jsxs(Te.Fragment,{children:[r.jsxs("tr",{onClick:()=>V(K.name),style:{borderBottom:"1px solid #f3f4f6",cursor:"pointer",background:k.has(K.name)?"#f9fafb":"#fff"},children:[r.jsx("td",{style:{padding:"12px 16px",color:"#9ca3af",fontWeight:500},children:W+1}),r.jsx("td",{style:{padding:"12px 16px",fontWeight:600,color:"#111827"},children:K.name}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600},children:H(K.totalQty)}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:K.expiredQty>0?"#ef4444":"#d1d5db",fontWeight:K.expiredQty>0?700:400},children:H(K.expiredQty)}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:K.criticalQty>0?"#f97316":"#d1d5db",fontWeight:K.criticalQty>0?700:400},children:H(K.criticalQty)}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:K.warningQty>0?"#eab308":"#d1d5db",fontWeight:K.warningQty>0?700:400},children:H(K.warningQty)}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right"},children:r.jsxs("span",{style:{color:K.riskRatio>50?"#ef4444":K.riskRatio>20?"#f97316":"#10b981",fontWeight:700},children:[K.riskRatio,"%"]})}),r.jsx("td",{style:{padding:"12px 16px"},children:r.jsx(kp,{score:K.avgScore})}),r.jsx("td",{style:{padding:"12px 16px",color:"#9ca3af"},children:k.has(K.name)?r.jsx(bm,{size:16}):r.jsx(ls,{size:16})})]}),k.has(K.name)&&r.jsx("tr",{children:r.jsx("td",{colSpan:9,style:{padding:0,background:"#f9fafb"},children:r.jsx("div",{style:{padding:"12px 24px",borderBottom:"1px solid #e5e7eb"},children:r.jsxs("table",{style:{width:"100%",fontSize:13},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"품목명"}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"LOT No."}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"창고명"}),r.jsx("th",{style:{textAlign:"right",padding:"8px 12px",color:"#6b7280"},children:"재고"}),r.jsx("th",{style:{textAlign:"center",padding:"8px 12px",color:"#6b7280"},children:"폐기대상"}),r.jsx("th",{style:{textAlign:"center",padding:"8px 12px",color:"#6b7280"},children:"긴급처분"}),r.jsx("th",{style:{textAlign:"center",padding:"8px 12px",color:"#6b7280"},children:"관심품목"}),r.jsx("th",{style:{textAlign:"center",padding:"8px 12px",color:"#6b7280"},children:"정상재고"})]})}),r.jsx("tbody",{children:K.items.map((R,oe)=>r.jsxs("tr",{style:{borderTop:"1px solid #e5e7eb"},children:[r.jsx("td",{style:{padding:"8px 12px",color:"#111827",fontWeight:500},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[R.srcBizunit==="TNT"&&r.jsx("span",{style:{background:"#e0f2fe",color:"#0369a1",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"T"}),R.srcBizunit==="DYS"&&r.jsx("span",{style:{background:"#fce7f3",color:"#be185d",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"D"}),R.itemName]})}),r.jsx("td",{style:{padding:"8px 12px",color:"#6b7280",fontFamily:"monospace"},children:R.lotNo||"-"}),r.jsx("td",{style:{padding:"8px 12px",color:"#6b7280"},children:R.whName||"-"}),r.jsx("td",{style:{padding:"8px 12px",textAlign:"right",fontWeight:600},children:H(R.stockQty)}),r.jsx("td",{style:{padding:"8px 12px",textAlign:"center"},children:R._status==="expired"?r.jsx("span",{style:{color:"#dc2626",fontWeight:600},children:"●"}):r.jsx("span",{style:{color:"#d1d5db"},children:"○"})}),r.jsx("td",{style:{padding:"8px 12px",textAlign:"center"},children:R._status==="critical"?r.jsx("span",{style:{color:"#ea580c",fontWeight:600},children:"●"}):r.jsx("span",{style:{color:"#d1d5db"},children:"○"})}),r.jsx("td",{style:{padding:"8px 12px",textAlign:"center"},children:R._status==="warning"?r.jsx("span",{style:{color:"#eab308",fontWeight:600},children:"●"}):r.jsx("span",{style:{color:"#d1d5db"},children:"○"})}),r.jsx("td",{style:{padding:"8px 12px",textAlign:"center"},children:R._status==="safe"||R._status==="normal"||!R._status||R._status!=="expired"&&R._status!=="critical"&&R._status!=="warning"?r.jsx("span",{style:{color:"#10b981",fontWeight:600},children:"●"}):r.jsx("span",{style:{color:"#d1d5db"},children:"○"})})]},oe))})]})})})})]},K.name))})]})})})}),r.jsx(JE,{isOpen:M,onClose:()=>B(!1),onSelect:K=>{p(K)}})]})}function so({title:e,value:t,subtext:n,icon:i,color:a,active:s,onClick:o}){return r.jsxs("div",{onClick:o,style:{background:s?`${a}10`:"#fff",border:`1px solid ${s?a:"#e5e7eb"}`,borderRadius:12,padding:20,cursor:o?"pointer":"default",transition:"all 0.2s",boxShadow:s?`0 4px 12px ${a}20`:"none"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:8},children:[r.jsx("span",{style:{fontSize:14,color:"#6b7280",fontWeight:500},children:e}),r.jsx("span",{style:{color:a},children:i})]}),r.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:t}),n&&r.jsx("div",{style:{fontSize:12,color:a,marginTop:4,fontWeight:500},children:n})]})}function oo({label:e,count:t,active:n,onClick:i,color:a="#3b82f6"}){return r.jsxs("button",{onClick:i,style:{padding:"16px 0",background:"none",border:"none",borderBottom:`2px solid ${n?a:"transparent"}`,color:n?a:"#6b7280",fontWeight:n?600:500,cursor:"pointer",fontSize:14,display:"flex",alignItems:"center",gap:6},children:[e,t!==void 0&&r.jsx("span",{style:{background:n?a:"#f3f4f6",color:n?"#fff":"#6b7280",padding:"2px 8px",borderRadius:99,fontSize:11,fontWeight:600},children:t>999?"999+":t})]})}function Np({status:e}){const t={expired:{bg:"#fef2f2",text:"#ef4444",label:"만료"},critical:{bg:"#fff7ed",text:"#f97316",label:"위험"},warning:{bg:"#fefce8",text:"#eab308",label:"주의"},good:{bg:"#ecfdf5",text:"#10b981",label:"정상"}},n=t[e]||t.good;return r.jsx("span",{style:{background:n.bg,color:n.text,padding:"4px 8px",borderRadius:6,fontSize:11,fontWeight:600,border:`1px solid ${n.text}20`},children:n.label})}function kp({score:e}){let t="#10b981";return e<=20?t="#ef4444":e<=50&&(t="#eab308"),r.jsx("div",{style:{width:80,height:6,background:"#e5e7eb",borderRadius:3,overflow:"hidden"},children:r.jsx("div",{style:{width:`${e}%`,height:"100%",background:t,borderRadius:3}})})}function eI(){const[e,t]=h.useState([]),[n,i]=h.useState(!1),[a,s]=h.useState(null),[o,l]=h.useState(null),[c,d]=h.useState(!1),[u,f]=h.useState([]);h.useEffect(()=>{let y=!0;return i(!0),s(null),fetch("/api/v1/items/unit-usage").then(async v=>{if(!v.ok)throw new Error(`HTTP ${v.status}`);return v.json()}).then(v=>{if(!y)return;const g=Array.isArray(v)?v.map(b=>({salesMgmtUnitSeq:Number(b.salesMgmtUnitSeq??0),salesMgmtUnit:String(b.salesMgmtUnit??"미지정"),itemStdUnit:String(b.itemStdUnit??"미지정"),itemUnit:String(b.itemUnit??"미지정"),itemCount:Number(b.itemCount??0)})):[];t(g)}).catch(v=>{y&&s(v.message||"조회 중 오류가 발생했습니다")}).finally(()=>{y&&i(!1)}),()=>{y=!1}},[]);const m=h.useMemo(()=>{const y={};for(const v of e){const g=v.salesMgmtUnit;y[g]||(y[g]=[]),y[g].push(v)}return Object.values(y).forEach(v=>v.sort((g,b)=>b.itemCount-g.itemCount)),Object.entries(y).sort((v,g)=>{const b=v[0],x=g[0],N=b==="미지정",A=x==="미지정";return N&&!A?1:!N&&A?-1:b.localeCompare(x)})},[e]);async function p(y,v,g){d(!0),s(null);try{const b=new URLSearchParams;b.set("salesMgmtUnit",y),v&&b.set("itemUnit",v),g&&b.set("itemStdUnit",g);const x=await fetch(`/api/v1/items/unit-usage/items?${b.toString()}`);if(!x.ok)throw new Error(`HTTP ${x.status}`);const N=await x.json(),A=Array.isArray(N)?N.map(C=>({itemSeq:C.itemSeq??null,itemName:String(C.itemName??""),itemStdUnit:String(C.itemStdUnit??"미지정"),itemUnit:String(C.itemUnit??"미지정"),salesMgmtUnitSeq:C.salesMgmtUnitSeq??null})):[];f(A)}catch(b){s((b==null?void 0:b.message)||"상세 조회 중 오류가 발생했습니다")}finally{d(!1)}}return r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsxs("div",{children:[r.jsx("h2",{style:{margin:0},children:"품목단위분석"}),r.jsx("p",{style:{margin:"4px 0 0",color:"var(--muted)"},children:"item 테이블 기준으로 영업관리단위별 사용 단위(표준단위/판매단위) 분포를 확인합니다."})]}),n?r.jsx("span",{style:{color:"var(--muted)"},children:"불러오는 중…"}):null,a?r.jsx("span",{style:{color:"crimson"},children:a}):null]}),m.length===0&&!n?r.jsx("div",{className:"empty-state",children:"데이터가 없습니다."}):r.jsx("div",{className:"card",style:{padding:12,height:"calc(100vh - 200px)",display:"flex",flexDirection:"column"},children:r.jsx("div",{style:{flex:1,minHeight:0,overflow:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"right",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"No."}),r.jsx("th",{style:{textAlign:"left",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"영업관리단위"}),r.jsx("th",{style:{textAlign:"left",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"판매단위(item_unit)"}),r.jsx("th",{style:{textAlign:"left",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"표준단위(item_std_unit)"}),r.jsx("th",{style:{textAlign:"right",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"품목수"})]})}),r.jsx("tbody",{children:m.map(([y,v],g)=>r.jsxs(Te.Fragment,{children:[v.map((b,x)=>{const N=`${y}|${b.itemUnit}|${b.itemStdUnit}`,A=`${y}`,C=o===N,w=o===A;return r.jsxs("tr",{style:{borderTop:"1px solid var(--border)"},children:[x===0?r.jsxs(r.Fragment,{children:[r.jsx("td",{rowSpan:v.length,style:{padding:"6px 8px",textAlign:"right",color:"var(--muted)",fontVariantNumeric:"tabular-nums"},children:g+1}),r.jsxs("td",{rowSpan:v.length,style:{padding:"6px 8px",fontWeight:600,cursor:"pointer",textDecoration:w?"underline":"none"},onClick:()=>{const O=w?null:A;l(O),O&&p(y)},children:[y,r.jsx("span",{style:{marginLeft:8,fontSize:12,color:"var(--muted)"},children:w?"닫기":"전체 품목"})]})]}):null,r.jsxs("td",{style:{padding:"6px 8px",cursor:"pointer",textDecoration:C?"underline":"none"},onClick:()=>{const O=C?null:N;l(O),O&&p(y,b.itemUnit,b.itemStdUnit)},children:[b.itemUnit,r.jsx("span",{style:{marginLeft:8,fontSize:12,color:"var(--muted)"},children:C?"닫기":"품목 보기"})]}),r.jsxs("td",{style:{padding:"6px 8px",cursor:"pointer",textDecoration:C?"underline":"none"},onClick:()=>{const O=C?null:N;l(O),O&&p(y,b.itemUnit,b.itemStdUnit)},children:[b.itemStdUnit,r.jsx("span",{style:{marginLeft:8,fontSize:12,color:"var(--muted)"},children:C?"닫기":"품목 보기"})]}),r.jsx("td",{style:{padding:"6px 8px",textAlign:"right"},children:b.itemCount.toLocaleString()})]},y+x)}),o===y||v.some(b=>o===`${y}|${b.itemUnit}|${b.itemStdUnit}`)?r.jsx("tr",{style:{background:"var(--muted-bg, #fafafa)"},children:r.jsx("td",{colSpan:5,style:{padding:"8px 8px 12px"},children:c?r.jsx("div",{style:{color:"var(--muted)"},children:"품목 불러오는 중…"}):u.length===0?r.jsx("div",{style:{color:"var(--muted)"},children:"해당 영업관리단위에 품목이 없습니다."}):r.jsx("div",{style:{maxHeight:"50vh",minHeight:200,overflow:"auto",border:"1px solid var(--border)",borderRadius:6},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{position:"sticky",top:0,background:"var(--bg)"},children:[r.jsx("th",{style:{textAlign:"left",padding:"6px 8px"},children:"품목명"}),r.jsx("th",{style:{textAlign:"left",padding:"6px 8px"},children:"판매단위"}),r.jsx("th",{style:{textAlign:"left",padding:"6px 8px"},children:"표준단위"}),r.jsx("th",{style:{textAlign:"right",padding:"6px 8px"},children:"품목SEQ"})]})}),r.jsx("tbody",{children:u.map((b,x)=>r.jsxs("tr",{style:{borderTop:"1px solid var(--border)"},children:[r.jsx("td",{style:{padding:"6px 8px"},children:b.itemName||"(이름 없음)"}),r.jsx("td",{style:{padding:"6px 8px"},children:b.itemUnit||"미지정"}),r.jsx("td",{style:{padding:"6px 8px"},children:b.itemStdUnit||"미지정"}),r.jsx("td",{style:{padding:"6px 8px",textAlign:"right",color:"var(--muted)"},children:b.itemSeq??""})]},(b.itemSeq??"na")+"-"+x))})]})})})}):null]},y))})]})})})]})}const tI=["TNT","DYS"];function nI(){const[e,t]=h.useState("TNT"),[n,i]=h.useState("2022"),[a,s]=h.useState([]),[o,l]=h.useState("all"),[c,d]=h.useState([]),[u,f]=h.useState([]),[m,p]=h.useState(!1),[y,v]=h.useState(null);h.useEffect(()=>{g()},[e,n]);const g=async()=>{const B=Number(n)||2022;try{const z=new URLSearchParams;z.append("companyType",e),z.append("fromYear",String(B));const j=await fetch(`/api/v1/analysis/price-sim/employees?${z.toString()}`);if(!j.ok)throw new Error(`HTTP ${j.status}`);const k=await j.json();s(k),l(k.length?"all":"")}catch(z){s([]),l(""),v((z==null?void 0:z.message)||"영업사원 목록 조회 실패")}},b=async()=>{p(!0),v(null);const B=Number(n)||2022;try{const z=new URLSearchParams;e!=="ALL"&&z.append("companyType",e),z.append("fromYear",String(B)),o&&o!=="all"&&z.append("empName",o);const j=await fetch(`/api/v1/analysis/price-sim?${z.toString()}`);if(!j.ok)throw new Error(`HTTP ${j.status}`);const k=await j.json();if(k.error)throw new Error(k.error);const L=Array.isArray(k.data)?k.data.map($=>({salesYear:Number($.salesYear??$.salesyear??0),salesUnit:String($.salesUnit??$.salesunit??"미지정"),empName:String($.empName??$.empname??"미지정"),salesCount:$.salesCount??$.salescount,totalQty:$.totalQty??$.totalqty,totalAmt:$.totalAmt??$.totalamt,avgPrice:(()=>{const V=Number($.totalQty??$.totalqty??0),G=$.avgPrice??$.avgprice??null;if(!Number.isFinite(V)||V<=0)return null;const ne=Number(G);return Number.isFinite(ne)?ne:null})()})):[];d(L);const T=Array.isArray(k.companyAvg)?k.companyAvg.map($=>({salesUnit:String($.salesUnit??$.salesunit??"미지정"),avgPrice:$.avgPrice??$.avgprice??null})):[];f(T)}catch(z){d([]),f([]),v((z==null?void 0:z.message)||"조회 실패")}finally{p(!1)}},x=h.useMemo(()=>{const B=[...c];return B.sort((z,j)=>{if(j.salesYear!==z.salesYear)return j.salesYear-z.salesYear;const k=z.salesUnit||"미지정",L=j.salesUnit||"미지정",T=k==="미지정",$=L==="미지정";return T&&!$?1:!T&&$?-1:k.localeCompare(L)}),B},[c]),N=h.useMemo(()=>Array.from(new Set(x.map(B=>B.salesYear))).sort((B,z)=>z-B),[x]),A=h.useMemo(()=>{const B=new Map;for(const z of u)B.set(z.salesUnit||"미지정",z.avgPrice??null);return B},[u]),C=h.useMemo(()=>{const B=new Map;for(const z of x){const j=`${z.empName}__${z.salesUnit}`;if(!B.has(j)){const L={};N.forEach(T=>{L[T]=null}),B.set(j,{empName:z.empName||"미지정",salesUnit:z.salesUnit||"미지정",yearly:L})}const k=B.get(j);k.yearly[z.salesYear]=z.avgPrice}return Array.from(B.values()).sort((z,j)=>{const k=z.salesUnit==="미지정",L=j.salesUnit==="미지정";if(k&&!L)return 1;if(!k&&L)return-1;const T=z.salesUnit.localeCompare(j.salesUnit);return T!==0?T:z.empName.localeCompare(j.empName)})},[x,N]),w=h.useMemo(()=>{const B=x.reduce((L,T)=>L+(T.salesCount||0),0),z=x.reduce((L,T)=>L+(T.totalQty||0),0),j=x.reduce((L,T)=>L+(T.totalAmt||0),0),k=z>0?j/z:0;return{totalSalesCount:B,totalQty:z,totalAmt:j,avgPrice:k}},[x]),O=B=>{if(B==null||B==="")return"-";const z=Number(B);return Number.isFinite(z)?z.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(B)},M=B=>{if(B==null||B==="")return"-";const z=Number(B);return Number.isFinite(z)?z.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(B)};return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:"판매단가 시뮬레이션"}),r.jsxs("div",{style:{marginTop:16,display:"flex",gap:12,alignItems:"flex-end"},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"회사 구분"}),r.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"inline-flex",gap:2},children:tI.map(B=>r.jsx("button",{onClick:()=>t(B),style:{background:e===B?"#fff":"transparent",border:"none",padding:"8px 16px",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer",color:e===B?"#111827":"#6b7280",boxShadow:e===B?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:B},B))})]}),r.jsxs("div",{style:{flex:1,maxWidth:240},children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"영업사원"}),r.jsxs("select",{className:"input",value:o,onChange:B=>l(B.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13,color:"#111827",background:"#fff"},children:[r.jsx("option",{value:"all",children:"전체"}),a.map(B=>r.jsx("option",{value:B,children:B},B))]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"시작 연도"}),r.jsx("input",{className:"input",type:"number",min:2e3,max:new Date().getFullYear(),value:n,onChange:B=>i(B.target.value),style:{width:100,padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13,textAlign:"center",color:"#111827",background:"#fff"}})]}),r.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:r.jsxs("button",{onClick:b,disabled:m,style:{background:m?"#93c5fd":"#3b82f6",border:"none",padding:"8px 20px",borderRadius:6,fontSize:13,fontWeight:600,cursor:m?"not-allowed":"pointer",color:"#fff",display:"flex",alignItems:"center",gap:6},children:[r.jsx(ts,{size:14}),m?"조회 중...":"분석 실행"]})})]}),c.length>0&&r.jsxs("div",{style:{marginTop:20,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[r.jsx(lo,{title:"총 거래 건수",value:O(w.totalSalesCount),subtext:"Invoice 기준",icon:r.jsx(zd,{size:24}),color:"#3b82f6"}),r.jsx(lo,{title:"총 판매 수량",value:O(w.totalQty),subtext:"전체 기간 합계",icon:r.jsx(jv,{size:24}),color:"#10b981"}),r.jsx(lo,{title:"총 판매 금액",value:O(w.totalAmt),subtext:"원화 기준",icon:r.jsx(ts,{size:24}),color:"#f59e0b"}),r.jsx(lo,{title:"평균 판매 단가",value:M(w.avgPrice),subtext:"금액 ÷ 수량",icon:r.jsx(ts,{size:24}),color:"#8b5cf6"})]})]}),r.jsx("div",{style:{flex:1,padding:24,overflow:"hidden"},children:r.jsx("div",{className:"card",style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:y?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:y}):x.length===0?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"조건을 선택하고 분석을 실행하세요"}):r.jsx("div",{style:{overflow:"auto",flex:1,padding:16},children:r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",width:160},children:"영업사원"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",width:160},children:"영업관리단위"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280",width:120},children:"회사 평균단가"}),N.map(B=>r.jsxs("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:[B,"년 평균단가"]},B))]})}),r.jsx("tbody",{children:C.map((B,z)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[r.jsx("td",{style:{padding:"12px 16px",fontWeight:500,color:"#111827"},children:B.empName||"-"}),r.jsx("td",{style:{padding:"12px 16px",color:"#4b5563"},children:B.salesUnit||"미지정"}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600,color:"#6b7280"},children:M(A.get(B.salesUnit||"미지정"))}),N.map(j=>r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600,color:"#111827"},children:M(B.yearly[j])},j))]},B.empName+B.salesUnit+z))})]})})})})]})}function lo({title:e,value:t,subtext:n,icon:i,color:a}){return r.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:8,padding:12,transition:"all 0.2s"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:4},children:[r.jsx("span",{style:{fontSize:11,color:"#6b7280",fontWeight:500},children:e}),r.jsx("span",{style:{color:a},children:Te.cloneElement(i,{size:16})})]}),r.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#111827"},children:t}),n&&r.jsx("div",{style:{fontSize:10,color:"#6b7280",marginTop:2},children:n})]})}const rI=["TNT","DYS"];function iI(){const[e,t]=h.useState("TNT"),[n,i]=h.useState("2022"),[a,s]=h.useState([]),[o,l]=h.useState(!1),[c,d]=h.useState(null);h.useEffect(()=>{u()},[]);async function u(){l(!0),d(null);try{const g=new URLSearchParams;g.append("companyType",e),g.append("fromYear",n||"2022");const b=await fetch(`/api/v1/analysis/price-sim?${g.toString()}`);if(!b.ok)throw new Error(`HTTP ${b.status}`);const x=await b.json();if(x.error)throw new Error(x.error);const N=Array.isArray(x.data)?x.data.map(A=>({salesYear:Number(A.salesYear??A.salesyear??0),salesUnit:String(A.salesUnit??A.salesunit??"미지정"),empName:String(A.empName??A.empname??"미지정"),totalQty:A.totalQty??A.totalqty,totalAmt:A.totalAmt??A.totalamt,avgPrice:A.avgPrice??A.avgprice??null})):[];s(N)}catch(g){d((g==null?void 0:g.message)||"조회 실패"),s([])}finally{l(!1)}}const f=h.useMemo(()=>Array.from(new Set(a.map(g=>g.salesYear))).sort((g,b)=>b-g),[a]),m=h.useMemo(()=>{const g=new Map;for(const x of a){const N=x.salesUnit||"미지정",A=N,C=x.salesYear;g.has(A)||g.set(A,{salesUnit:N,yearAmt:{},yearQty:{}});const w=g.get(A);w.yearAmt[C]=(w.yearAmt[C]||0)+(Number(x.totalAmt)||0),w.yearQty[C]=(w.yearQty[C]||0)+(Number(x.totalQty)||0)}const b=[];for(const{salesUnit:x,yearAmt:N,yearQty:A}of g.values()){const C={};f.forEach(w=>{const O=N[w]||0,M=A[w]||0;C[w]=M>0?O/M:null}),b.push({salesUnit:x,yearly:C})}return b.sort((x,N)=>{const A=x.salesUnit==="미지정",C=N.salesUnit==="미지정";return A&&!C?1:!A&&C?-1:x.salesUnit.localeCompare(N.salesUnit)})},[a,f]),p=h.useMemo(()=>{const g=a.reduce((N,A)=>N+(Number(A.totalAmt)||0),0),b=a.reduce((N,A)=>N+(Number(A.totalQty)||0),0),x=b>0?g/b:0;return{totalAmt:g,totalQty:b,avgPrice:x}},[a]),y=g=>{if(g==null||g==="")return"-";const b=Number(g);return Number.isFinite(b)?b.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(g)},v=g=>{if(g==null||g==="")return"-";const b=Number(g);return Number.isFinite(b)?b.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(g)};return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:"판매단가 Sim (영업관리단위)"}),r.jsx("p",{style:{margin:"4px 0 0 0",color:"#6b7280",fontSize:14},children:"영업관리단위별 연도별 평균단가 (직원 합산)"}),r.jsxs("div",{style:{marginTop:20,display:"flex",gap:12,alignItems:"flex-end"},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"회사 구분"}),r.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"inline-flex",gap:2},children:rI.map(g=>r.jsx("button",{onClick:()=>t(g),style:{background:e===g?"#fff":"transparent",border:"none",padding:"8px 16px",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer",color:e===g?"#111827":"#6b7280",boxShadow:e===g?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:g},g))})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"시작 연도"}),r.jsx("input",{className:"input",type:"number",min:2e3,max:new Date().getFullYear(),value:n,onChange:g=>i(g.target.value),style:{width:100,padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13,textAlign:"center",color:"#111827",background:"#fff"}})]}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[r.jsxs("button",{onClick:()=>{t("TNT"),i("2022"),s([]),d(null)},style:{background:"#f3f4f6",border:"none",padding:"8px 16px",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",gap:6},children:[r.jsx(LS,{size:14}),"초기화"]}),r.jsxs("button",{onClick:u,disabled:o,style:{background:o?"#93c5fd":"#3b82f6",border:"none",padding:"8px 20px",borderRadius:6,fontSize:13,fontWeight:600,cursor:o?"not-allowed":"pointer",color:"#fff",display:"flex",alignItems:"center",gap:6},children:[r.jsx(ts,{size:14}),o?"조회 중...":"분석 실행"]})]})]}),a.length>0&&r.jsxs("div",{style:{marginTop:20,display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:16},children:[r.jsx(au,{title:"총 판매 수량",value:y(p.totalQty),subtext:"전체 기간 합계",color:"#10b981"}),r.jsx(au,{title:"총 판매 금액",value:y(p.totalAmt),subtext:"원화 기준",color:"#f59e0b"}),r.jsx(au,{title:"평균 판매 단가",value:v(p.avgPrice),subtext:"금액 ÷ 수량",color:"#8b5cf6"})]})]}),r.jsx("div",{style:{flex:1,padding:24,overflow:"hidden"},children:r.jsx("div",{className:"card",style:{height:"100%",display:"flex",flexDirection:"column",overflow:"auto",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:c?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:c}):m.length===0?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"조건을 선택하고 분석을 실행하세요"}):r.jsx("div",{style:{overflow:"auto",flex:1,padding:16},children:r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",width:200},children:"영업관리단위"}),f.map(g=>r.jsxs("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:[g,"년 평균단가"]},g))]})}),r.jsx("tbody",{children:m.map((g,b)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[r.jsx("td",{style:{padding:"12px 16px",fontWeight:600,color:"#111827"},children:g.salesUnit}),f.map(x=>r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600,color:"#111827"},children:v(g.yearly[x])},x))]},g.salesUnit+b))})]})})})})]})}function au({title:e,value:t,subtext:n,color:i}){return r.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,padding:20,transition:"all 0.2s"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:8},children:[r.jsx("span",{style:{fontSize:14,color:"#6b7280",fontWeight:500},children:e}),r.jsx("span",{style:{color:i},children:r.jsx(ts,{size:20})})]}),r.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#111827"},children:t}),n&&r.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:n})]})}function aI({onClose:e,onSelect:t}){return r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:12,width:"90%",maxWidth:1e3,height:"80vh",display:"flex",flexDirection:"column",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},children:[r.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"거래처 검색"}),r.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer"},children:r.jsx(Rd,{size:24})})]}),r.jsx("div",{style:{flex:1,overflow:"hidden",padding:20},children:r.jsx(Bd,{compact:!0,maxHeight:"calc(80vh - 140px)",autoSelectFirst:!1,onSelect:n=>t({customerSeq:Number(n.customerSeq),customerName:n.customerName})})})]})})}function sI(){var x,N,A,C,w,O,M,B;const[e,t]=h.useState(null),[n,i]=h.useState(new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0]),[a,s]=h.useState(new Date().toISOString().split("T")[0]),[o,l]=h.useState(null),[c,d]=h.useState(!1),[u,f]=h.useState(!1),[m,p]=h.useState(50),[y,v]=h.useState(""),g=async()=>{if(e){d(!0);try{const z=await fetch(`/api/v1/lab/price-simulation/data?customerSeq=${e.seq}&startDate=${n}&endDate=${a}`);if(z.ok){const j=await z.json();l(j),p(j.assessmentScore),v(j.assessmentComment||"")}}catch(z){console.error(z)}finally{d(!1)}}},b=async()=>{if(e)try{await fetch("/api/v1/lab/price-simulation/assessment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerSeq:e.seq,assessorId:"current-user",score:m,comment:y})}),g()}catch(z){console.error(z)}};return r.jsxs("div",{className:"price-simulation",style:{padding:20,height:"100%",overflow:"auto",display:"flex",flexDirection:"column",gap:20},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h1",{style:{fontSize:24,fontWeight:"bold"},children:"Price Simulation"}),r.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[r.jsxs("div",{className:"input-group",style:{display:"flex",alignItems:"center",gap:8,background:"#f5f5f5",padding:"4px 12px",borderRadius:8},children:[r.jsx(Iu,{size:16}),r.jsx("input",{type:"date",value:n,onChange:z=>i(z.target.value),style:{border:"none",background:"transparent"}}),r.jsx("span",{children:"~"}),r.jsx("input",{type:"date",value:a,onChange:z=>s(z.target.value),style:{border:"none",background:"transparent"}})]}),r.jsxs("button",{onClick:()=>f(!0),style:{display:"flex",alignItems:"center",gap:8,padding:"8px 16px",background:"#333",color:"#fff",borderRadius:8,border:"none",cursor:"pointer"},children:[r.jsx(Pu,{size:16}),e?e.name:"거래처 선택"]}),r.jsx("button",{onClick:g,disabled:!e||c,style:{display:"flex",alignItems:"center",gap:8,padding:"8px 16px",background:!e||c?"#ccc":"#2563eb",color:"#fff",borderRadius:8,border:"none",cursor:!e||c?"not-allowed":"pointer",fontWeight:"bold"},children:"SIMULATION"})]})]}),e&&o?r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[r.jsx(co,{title:"거래규모 (성장성)",icon:r.jsx(wv,{color:"#4CAF50"}),score:o.volumeScore,children:r.jsxs("div",{style:{fontSize:12,color:"#666"},children:[r.jsxs("div",{children:["금년: ",(x=o.volumeCurrent)==null?void 0:x.toLocaleString()]}),r.jsxs("div",{children:["전년: ",(N=o.volumeYear1)==null?void 0:N.toLocaleString()]}),r.jsxs("div",{style:{fontWeight:"bold",color:o.volumeGrowthRate>=0?"#4CAF50":"#F44336"},children:["YoY: ",(A=o.volumeGrowthRate)==null?void 0:A.toFixed(1),"%"]})]})}),r.jsx(co,{title:"채권 건전성",icon:r.jsx(El,{color:"#FF9800"}),score:o.agingScore,children:r.jsxs("div",{style:{fontSize:12,color:"#666"},children:[r.jsxs("div",{children:["총채권: ",(C=o.totalAr)==null?void 0:C.toLocaleString()]}),r.jsxs("div",{children:["연체: ",(w=o.overdueAr)==null?void 0:w.toLocaleString()]}),r.jsxs("div",{style:{fontWeight:"bold",color:o.overdueRatio>0?"#F44336":"#4CAF50"},children:["연체율: ",(O=o.overdueRatio)==null?void 0:O.toFixed(1),"%"]})]})}),r.jsx(co,{title:"대외 신용도",icon:r.jsx(fS,{color:"#2196F3"}),score:o.ratingScore,children:r.jsxs("div",{style:{fontSize:12,color:"#666"},children:[r.jsxs("div",{children:["기관: ",o.ratingAgency||"-"]}),r.jsx("div",{style:{fontSize:24,fontWeight:"bold",margin:"4px 0"},children:o.ratingGrade||"-"})]})}),r.jsx(co,{title:"영업 정성평가",icon:r.jsx(WS,{color:"#9C27B0"}),score:o.assessmentScore,children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[r.jsx("input",{type:"range",min:"0",max:"100",step:"20",value:m,onChange:z=>p(Number(z.target.value)),style:{width:"100%"}}),r.jsxs("div",{style:{display:"flex",gap:4},children:[r.jsx("input",{type:"text",value:y,onChange:z=>v(z.target.value),placeholder:"평가 코멘트",style:{flex:1,padding:4,borderRadius:4,border:"1px solid #ddd",fontSize:12}}),r.jsx("button",{onClick:b,style:{fontSize:10,padding:"4px 8px",background:"#333",color:"#fff",border:"none",borderRadius:4,cursor:"pointer"},children:"저장"})]})]})})]}),r.jsxs("div",{style:{background:"linear-gradient(90deg, #1a237e 0%, #283593 100%)",padding:20,borderRadius:12,color:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("h2",{style:{margin:0,fontSize:18,opacity:.9},children:"Price Simulation Result"}),r.jsxs("p",{style:{margin:"4px 0 0 0",fontSize:14,opacity:.7},children:["종합 점수 ",o.totalScore,"점을 기반으로 산출된 권장 인상률입니다."]})]}),r.jsxs("div",{style:{textAlign:"right"},children:[r.jsx("div",{style:{fontSize:14,opacity:.8},children:"권장 인상률"}),r.jsxs("div",{style:{fontSize:32,fontWeight:"bold",color:"#4CAF50"},children:["+",(M=o.suggestedIncreaseRate)==null?void 0:M.toFixed(2),"%"]})]})]}),r.jsx("div",{style:{background:"#fff",borderRadius:12,border:"1px solid #eee",overflow:"hidden"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f9f9f9",borderBottom:"1px solid #eee"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:12,textAlign:"left",fontSize:12,color:"#666"},children:"품목명"}),r.jsx("th",{style:{padding:12,textAlign:"center",fontSize:12,color:"#666"},children:"단위"}),r.jsx("th",{style:{padding:12,textAlign:"right",fontSize:12,color:"#666"},children:"최근 판매량"}),r.jsx("th",{style:{padding:12,textAlign:"right",fontSize:12,color:"#666"},children:"최근 평균단가"}),r.jsx("th",{style:{padding:12,textAlign:"right",fontSize:12,color:"#666",background:"#e8f5e9"},children:"시뮬레이션 단가"}),r.jsx("th",{style:{padding:12,textAlign:"right",fontSize:12,color:"#666"},children:"예상 증분"})]})}),r.jsxs("tbody",{children:[(B=o.items)==null?void 0:B.map(z=>{var j,k,L;return r.jsxs("tr",{style:{borderBottom:"1px solid #f5f5f5"},children:[r.jsx("td",{style:{padding:12,fontSize:14},children:z.itemName}),r.jsx("td",{style:{padding:12,textAlign:"center",fontSize:12,color:"#888"},children:z.itemUnit}),r.jsx("td",{style:{padding:12,textAlign:"right",fontSize:14},children:(j=z.recentQty)==null?void 0:j.toLocaleString()}),r.jsx("td",{style:{padding:12,textAlign:"right",fontSize:14},children:(k=z.recentUnitPrice)==null?void 0:k.toLocaleString()}),r.jsx("td",{style:{padding:12,textAlign:"right",fontSize:14,fontWeight:"bold",color:"#2E7D32",background:"#f1f8e9"},children:(L=z.simulatedUnitPrice)==null?void 0:L.toLocaleString(void 0,{maximumFractionDigits:0})}),r.jsxs("td",{style:{padding:12,textAlign:"right",fontSize:12,color:"#4CAF50"},children:["+",(z.simulatedUnitPrice-z.recentUnitPrice).toLocaleString(void 0,{maximumFractionDigits:0})]})]},z.itemSeq)}),(!o.items||o.items.length===0)&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,style:{padding:40,textAlign:"center",color:"#999"},children:"해당 기간에 판매 이력이 없습니다."})})]})]})})]}):r.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#999",gap:16},children:[r.jsx("div",{style:{width:64,height:64,borderRadius:32,background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(Pu,{size:32,color:"#ccc"})}),r.jsx("p",{children:"상단에서 거래처를 선택하여 시뮬레이션을 시작하세요."})]}),u&&r.jsx(aI,{onClose:()=>f(!1),onSelect:z=>{t({seq:z.customerSeq,name:z.customerName}),f(!1)}})]})}function co({title:e,icon:t,score:n,children:i}){return r.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:16,border:"1px solid #eee",display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontWeight:"bold",fontSize:14},children:[t,e]}),r.jsxs("div",{style:{padding:"4px 8px",borderRadius:12,fontSize:12,fontWeight:"bold",background:n>=80?"#E8F5E9":n>=50?"#FFF3E0":"#FFEBEE",color:n>=80?"#2E7D32":n>=50?"#EF6C00":"#C62828"},children:[n,"점"]})]}),r.jsx("div",{style:{height:1,background:"#f0f0f0"}}),i]})}function oI(){const[e,t]=h.useState(""),[n,i]=h.useState(!1),[a,s]=h.useState(null),[o,l]=h.useState([]),[c,d]=h.useState(!1),[u,f]=h.useState(!1),[m,p]=h.useState(null);h.useEffect(()=>{y()},[]);const y=async()=>{d(!0);try{const b=await fetch("/api/v1/nl2sql/schema");if(!b.ok)throw new Error(`HTTP ${b.status}`);const x=await b.json();x.error?p(x.error):l(x.tables||[])}catch(b){p(b.message||"스키마 조회 실패")}finally{d(!1)}},v=async b=>{if(b.preventDefault(),!!e.trim()){i(!0),p(null),s(null);try{const x=await fetch("/api/v1/nl2sql/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e.trim()})});if(!x.ok)throw new Error(`HTTP ${x.status}`);const N=await x.json();N.error?(p(N.error),N.sql&&s({...N,results:[],rowCount:0})):s(N)}catch(x){p(x.message||"쿼리 실행 실패")}finally{i(!1)}}},g=["2024년 총 매출액은?","영업사원별 매출 TOP 10","최근 3개월 신규 고객 수","제품별 판매 수량 합계"];return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{children:[r.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:"VIBE Workspace"}),r.jsx("p",{style:{margin:"6px 0 0",color:"#6b7280",fontSize:14},children:"자연어로 데이터베이스에 질문하세요"})]}),r.jsxs("button",{onClick:()=>f(!u),style:{display:"flex",alignItems:"center",gap:6,padding:"8px 16px",background:u?"#3b82f6":"#fff",color:u?"#fff":"#374151",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer"},children:[r.jsx(jS,{size:16}),u?"스키마 숨기기":"스키마 보기"]})]}),r.jsx("form",{onSubmit:v,style:{marginTop:16},children:r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("div",{style:{flex:1,position:"relative"},children:[r.jsx(zi,{size:18,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}}),r.jsx("input",{type:"text",value:e,onChange:b=>t(b.target.value),placeholder:"예: 2024년 총 매출액은 얼마인가요?",disabled:n,style:{width:"100%",padding:"12px 12px 12px 40px",border:"1px solid #d1d5db",borderRadius:8,fontSize:14,color:"#111827",background:"#fff"}})]}),r.jsx("button",{type:"submit",disabled:n||!e.trim(),style:{padding:"12px 24px",background:n||!e.trim()?"#93c5fd":"#3b82f6",color:"#fff",border:"none",borderRadius:8,fontSize:14,fontWeight:600,cursor:n||!e.trim()?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:8},children:n?r.jsxs(r.Fragment,{children:[r.jsx(jm,{size:16,style:{animation:"spin 1s linear infinite"}}),"분석 중..."]}):"질문하기"})]})}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[r.jsx("span",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:"예시:"}),g.map((b,x)=>r.jsx("button",{onClick:()=>t(b),disabled:n,style:{padding:"4px 12px",background:"#f3f4f6",color:"#374151",border:"1px solid #e5e7eb",borderRadius:6,fontSize:12,cursor:"pointer"},children:b},x))]})]}),r.jsxs("div",{style:{flex:1,padding:24,overflow:"auto",display:"flex",gap:16},children:[u&&r.jsxs("div",{className:"card",style:{width:320,flexShrink:0,overflow:"auto",padding:16,background:"#fff"},children:[r.jsx("h3",{style:{margin:"0 0 12px",fontSize:16,fontWeight:600,color:"#111827"},children:"데이터베이스 스키마"}),c?r.jsx("div",{style:{textAlign:"center",padding:20,color:"#6b7280"},children:r.jsx(jm,{size:24,style:{animation:"spin 1s linear infinite"}})}):o.length===0?r.jsx("div",{style:{textAlign:"center",padding:20,color:"#6b7280",fontSize:13},children:"스키마 정보 없음"}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:o.map((b,x)=>r.jsxs("details",{style:{background:"#f9fafb",padding:8,borderRadius:6},children:[r.jsxs("summary",{style:{cursor:"pointer",fontWeight:500,fontSize:13,color:"#374151",marginBottom:8},children:[b.schema,".",b.name]}),r.jsx("div",{style:{paddingLeft:12,fontSize:12,color:"#6b7280"},children:b.columns.map((N,A)=>r.jsxs("div",{style:{marginBottom:6,display:"flex",flexDirection:"column",gap:2},children:[r.jsxs("div",{children:[r.jsx("span",{style:{color:"#111827",fontWeight:500},children:N.name}),r.jsxs("span",{style:{color:"#9ca3af"},children:[" (",N.type,")"]})]}),N.description&&r.jsx("div",{style:{fontSize:11,color:"#3b82f6",fontWeight:500},children:N.description})]},A))})]},x))})]}),r.jsx("div",{className:"card",style:{flex:1,display:"flex",flexDirection:"column",background:"#fff"},children:m?r.jsxs("div",{style:{padding:40,textAlign:"center"},children:[r.jsx(El,{size:48,style:{color:"#ef4444",marginBottom:12}}),r.jsx("div",{style:{color:"#ef4444",fontSize:16,fontWeight:600},children:m})]}):a?r.jsxs("div",{style:{padding:16,display:"flex",flexDirection:"column",gap:16,flex:1,overflow:"hidden"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:12,background:"#f0fdf4",borderRadius:8},children:[r.jsx(gS,{size:20,style:{color:"#22c55e"}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#166534"},children:"쿼리 실행 완료"}),r.jsxs("div",{style:{fontSize:12,color:"#15803d",marginTop:2},children:[a.rowCount,"개의 결과를 찾았습니다"]})]})]}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6},children:"생성된 SQL:"}),r.jsx("pre",{style:{background:"#1f2937",color:"#f3f4f6",padding:12,borderRadius:6,fontSize:12,overflow:"auto",margin:0},children:a.sql})]}),a.results.length>0&&r.jsxs("div",{style:{flex:1,overflow:"auto"},children:[r.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8},children:"결과:"}),r.jsx("div",{style:{overflow:"auto",border:"1px solid #e5e7eb",borderRadius:6},children:r.jsxs("table",{className:"table",style:{width:"100%",fontSize:13},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:1},children:r.jsx("tr",{children:Object.keys(a.results[0]).map(b=>r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:600,color:"#374151"},children:b},b))})}),r.jsx("tbody",{children:a.results.map((b,x)=>r.jsx("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:Object.values(b).map((N,A)=>r.jsx("td",{style:{padding:"10px 12px",color:"#6b7280"},children:N==null?r.jsx("span",{style:{color:"#d1d5db",fontStyle:"italic"},children:"null"}):typeof N=="object"?JSON.stringify(N):String(N)},A))},x))})]})})]})]}):r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(RS,{size:64,style:{margin:"0 auto 16px",color:"#d1d5db"}}),r.jsx("div",{style:{fontSize:16,fontWeight:500,marginBottom:8},children:"질문을 입력하세요"}),r.jsx("div",{style:{fontSize:14},children:"자연어로 데이터베이스에 질문하면 자동으로 SQL을 생성하여 실행합니다"})]})})]}),r.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})}function lI(){const[e,t]=h.useState([]),[n,i]=h.useState(!1),[a,s]=h.useState(null),[o,l]=h.useState([]),[c,d]=h.useState([]),[u,f]=h.useState("all"),[m,p]=h.useState("all"),[y,v]=h.useState(""),[g,b]=h.useState("all"),[x,N]=h.useState("all"),[A,C]=h.useState("latest"),[w,O]=h.useState({totalAr:0,overdueAr:0,overdueCount:0,aging30Ar:0,aging30Count:0,normalAr:0}),M=async()=>{try{const T=await fetch("/api/v1/credit/sales-reps");if(!T.ok)throw new Error(`API 호출 실패: ${T.status}`);const $=await T.json();l($.salesReps||[])}catch(T){console.error("영업사원 목록 조회 실패:",T)}},B=async()=>{try{const T=await fetch("/api/v1/credit/snapshot-dates");if(!T.ok)throw new Error(`API 호출 실패: ${T.status}`);const $=await T.json();d($.dates||[])}catch(T){console.error("채권검토일 목록 조회 실패:",T)}},z=async()=>{i(!0),s(null);try{const T=new URLSearchParams;u!=="all"&&T.append("company",u),m!=="all"&&T.append("salesRep",m),y&&T.append("customerName",y),g!=="all"&&T.append("riskLevel",g),x!=="all"&&T.append("agingBucket",x),A!=="latest"&&T.append("snapshotDate",A),console.log("AR Aging 조회 요청:",T.toString());const $=await fetch(`/api/v1/credit/ar-aging?${T.toString()}`);if(!$.ok)throw new Error(`API 호출 실패: ${$.status}`);const V=await $.json();console.log("AR Aging 조회 응답:",V);const G=(V.items||[]).map(P=>({customerSeq:P.customer_seq,customerCode:P.customer_no,customerName:P.customer_name,companyType:P.company_type,salesRep:P.emp_name,department:P.dept_name,totalAr:P.total_ar,overdue:P.overdue,aging030:P.aging_0_30,aging3160:P.aging_31_60,aging6190:P.aging_61_90,aging91120:P.aging_91_120,aging121150:P.aging_121_150,aging151180:P.aging_151_180,aging181210:P.aging_181_210,aging211240:P.aging_211_240,aging241270:P.aging_241_270,aging271300:P.aging_271_300,aging301330:P.aging_301_330,aging331365:P.aging_331_365,agingOver365:P.aging_over_365,riskLevel:P.riskLevel,lastCollectionDate:P.last_collection_date}));t(G);const ne=G.filter(P=>P.riskLevel==="high"),U=G.filter(P=>P.riskLevel==="medium"),I=G.filter(P=>P.riskLevel==="low");O({totalAr:G.reduce((P,D)=>P+(D.totalAr||0),0),overdueAr:G.reduce((P,D)=>P+(D.overdue||0),0),overdueCount:ne.length,aging30Ar:G.reduce((P,D)=>P+(D.aging030||0),0),aging30Count:I.length,normalAr:G.reduce((P,D)=>P+(D.aging030||0),0)})}catch(T){console.error("AR Aging 조회 실패:",T),s(T.message||"데이터 조회 중 오류가 발생했습니다.")}finally{i(!1)}};h.useEffect(()=>{M(),B(),z()},[]);const j=T=>{if(T==null||T==="")return"-";const $=Number(T);return Number.isFinite($)?`₩${$.toLocaleString("ko-KR")}`:String(T)},k=T=>T==="TNT"?r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,background:"#3b82f6",color:"white",borderRadius:4,fontSize:11,fontWeight:700,marginRight:6},children:"T"}):T==="DYS"?r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,background:"#10b981",color:"white",borderRadius:4,fontSize:11,fontWeight:700,marginRight:6},children:"D"}):null,L=T=>T==="high"?r.jsx("span",{style:{padding:"2px 8px",background:"#ef4444",color:"white",borderRadius:4,fontSize:11},children:"고위험"}):T==="medium"?r.jsx("span",{style:{padding:"2px 8px",background:"#f59e0b",color:"white",borderRadius:4,fontSize:11},children:"중위험"}):T==="low"?r.jsx("span",{style:{padding:"2px 8px",background:"#10b981",color:"white",borderRadius:4,fontSize:11},children:"저위험"}):r.jsx("span",{style:{padding:"2px 8px",background:"#6b7280",color:"white",borderRadius:4,fontSize:11},children:"-"});return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{marginBottom:24,display:"flex",alignItems:"baseline",gap:12,justifyContent:"space-between"},children:[r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"연체채권 현황"}),r.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"거래처별 채권 연령 분석 및 리스크 관리"})]}),r.jsxs("div",{style:{padding:"8px 12px",background:"#f3f4f6",borderRadius:6,fontSize:12,color:"#4b5563"},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"위험도 분류 기준 (연체비율)"}),r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("span",{children:[r.jsx("span",{style:{color:"#ef4444",fontWeight:600},children:"고위험"}),": 30% 초과"]}),r.jsxs("span",{children:[r.jsx("span",{style:{color:"#f59e0b",fontWeight:600},children:"중위험"}),": 10~30%"]}),r.jsxs("span",{children:[r.jsx("span",{style:{color:"#10b981",fontWeight:600},children:"저위험"}),": 10% 이하"]})]}),r.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:2},children:"※ 연체비율 = 30일 초과 연체액 / 총채권액"})]})]}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",marginBottom:20},children:[r.jsxs("select",{className:"search-input",value:A,onChange:T=>C(T.target.value),style:{width:150},children:[r.jsx("option",{value:"latest",children:"최신 채권검토일"}),c.map(T=>r.jsx("option",{value:T,children:T},T))]}),r.jsxs("select",{className:"search-input",value:u,onChange:T=>f(T.target.value),style:{width:120},children:[r.jsx("option",{value:"all",children:"전체 회사"}),r.jsx("option",{value:"TNT",children:"TNT"}),r.jsx("option",{value:"DYS",children:"DYS"})]}),r.jsxs("select",{className:"search-input",value:m,onChange:T=>p(T.target.value),style:{width:150},children:[r.jsx("option",{value:"all",children:"전체 영업사원"}),o.map(T=>r.jsx("option",{value:T,children:T},T))]}),r.jsx("input",{type:"text",className:"search-input",value:y,onChange:T=>v(T.target.value),placeholder:"거래처명 검색",style:{width:150}}),r.jsxs("select",{className:"search-input",value:g,onChange:T=>b(T.target.value),style:{width:120},children:[r.jsx("option",{value:"all",children:"전체 위험도"}),r.jsx("option",{value:"high",children:"고위험"}),r.jsx("option",{value:"medium",children:"중위험"}),r.jsx("option",{value:"low",children:"저위험"})]}),r.jsxs("select",{className:"search-input",value:x,onChange:T=>N(T.target.value),style:{width:120},children:[r.jsx("option",{value:"all",children:"전체 구간"}),r.jsx("option",{value:"0-30",children:"0-30일 이내"}),r.jsx("option",{value:"31-60",children:"1개월 이내"}),r.jsx("option",{value:"61-90",children:"2개월 이내"}),r.jsx("option",{value:"91-120",children:"3개월 이내"}),r.jsx("option",{value:"121-150",children:"4개월 이내"}),r.jsx("option",{value:"151-180",children:"5개월 이내"}),r.jsx("option",{value:"181-210",children:"6개월 이내"}),r.jsx("option",{value:"211-240",children:"7개월 이내"}),r.jsx("option",{value:"241-270",children:"8개월 이내"}),r.jsx("option",{value:"271-300",children:"9개월 이내"}),r.jsx("option",{value:"301-330",children:"10개월 이내"}),r.jsx("option",{value:"331-365",children:"11개월 이내"}),r.jsx("option",{value:"over-365",children:"12개월 초과"})]}),r.jsx("div",{style:{display:"flex",gap:8,marginLeft:"auto"},children:r.jsx("button",{className:"btn",onClick:z,disabled:n,style:{height:30,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",whiteSpace:"nowrap"},children:n?"조회 중...":"조회"})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[r.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #3b82f6"},children:[r.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"총채권액"}),r.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:j(w.totalAr)})]}),r.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #ef4444"},children:[r.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:["만기도과 (",w.overdueCount,"건)"]}),r.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#ef4444"},children:j(w.overdueAr)})]}),r.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #f59e0b"},children:[r.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:["30일 이내 (",w.aging30Count,"건)"]}),r.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#f59e0b"},children:j(w.aging30Ar)})]}),r.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #10b981"},children:[r.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"정상채권"}),r.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#10b981"},children:j(w.normalAr)})]})]})]}),r.jsx("div",{style:{flex:1,overflow:"auto",padding:24},children:a?r.jsx("div",{style:{padding:16,color:"#ef4444"},children:a}):e.length===0?r.jsx("div",{className:"empty-state",children:"조회된 데이터가 없습니다"}):r.jsx("div",{className:"card",style:{overflow:"auto",height:"100%"},children:r.jsxs("table",{className:"table",style:{fontSize:12},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:40,textAlign:"center",position:"sticky",top:0,background:"#fff",zIndex:10},children:"#"}),r.jsx("th",{style:{width:80,position:"sticky",top:0,background:"#fff",zIndex:10},children:"위험도"}),r.jsx("th",{style:{minWidth:250,position:"sticky",top:0,background:"#fff",zIndex:10},children:"거래처 정보"}),r.jsx("th",{style:{minWidth:120,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"총채권액"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"0-30일"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"1개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"2개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"3개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"4개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"5개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"6개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"7개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"8개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"9개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"10개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"11개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"12개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"12개월+"}),r.jsx("th",{style:{minWidth:100,textAlign:"center",position:"sticky",top:0,background:"#fff",zIndex:10},children:"액션"})]})}),r.jsx("tbody",{children:e.map((T,$)=>r.jsxs("tr",{style:{cursor:"pointer"},children:[r.jsx("td",{style:{textAlign:"center",color:"var(--muted)"},children:$+1}),r.jsx("td",{children:L(T.riskLevel||"")}),r.jsx("td",{children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[k(T.companyType||""),r.jsx("span",{style:{fontWeight:600,fontSize:13},children:T.customerName||"-"})]}),r.jsxs("div",{style:{fontSize:11,color:"#6b7280",display:"flex",gap:8,flexWrap:"wrap"},children:[r.jsxs("span",{children:["코드: ",T.customerCode||"-"]}),r.jsxs("span",{children:["영업: ",T.salesRep||"-"]}),r.jsxs("span",{children:["부서: ",T.department||"-"]})]})]})}),r.jsx("td",{style:{textAlign:"right",fontWeight:600},children:j(T.totalAr)}),r.jsx("td",{style:{textAlign:"right"},children:j(T.aging030)}),r.jsx("td",{style:{textAlign:"right"},children:j(T.aging3160)}),r.jsx("td",{style:{textAlign:"right"},children:j(T.aging6190)}),r.jsx("td",{style:{textAlign:"right"},children:j(T.aging91120)}),r.jsx("td",{style:{textAlign:"right"},children:j(T.aging121150)}),r.jsx("td",{style:{textAlign:"right"},children:j(T.aging151180)}),r.jsx("td",{style:{textAlign:"right"},children:j(T.aging181210)}),r.jsx("td",{style:{textAlign:"right"},children:j(T.aging211240)}),r.jsx("td",{style:{textAlign:"right"},children:j(T.aging241270)}),r.jsx("td",{style:{textAlign:"right"},children:j(T.aging271300)}),r.jsx("td",{style:{textAlign:"right"},children:j(T.aging301330)}),r.jsx("td",{style:{textAlign:"right"},children:j(T.aging331365)}),r.jsx("td",{style:{textAlign:"right"},children:j(T.agingOver365)}),r.jsx("td",{style:{textAlign:"center"},children:r.jsx("button",{className:"btn btn-sm",onClick:V=>{V.stopPropagation(),alert("거래처 상세 패널 구현 예정")},children:"상세"})})]},$))})]})})})]})}function gx(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(n=gx(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function ut(){for(var e,t,n=0,i="",a=arguments.length;n<a;n++)(e=arguments[n])&&(t=gx(e))&&(i&&(i+=" "),i+=t);return i}var cI=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function rf(e){if(typeof e!="string")return!1;var t=cI;return t.includes(e)}var uI=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function yx(e){if(typeof e!="string")return!1;var t=uI;return t.includes(e)}function vx(e){return typeof e=="string"&&e.startsWith("data-")}function Kn(e){var t=Object.entries(e).filter(n=>{var[i]=n;return yx(i)||vx(i)});return Object.fromEntries(t)}function Ri(e){if(e==null)return null;if(h.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return Kn(t)}return typeof e=="object"&&!Array.isArray(e)?Kn(e):null}function In(e){var t=Object.entries(e).filter(n=>{var[i]=n;return yx(i)||vx(i)||rf(i)});return Object.fromEntries(t)}function dI(e){return e==null?null:h.isValidElement(e)?In(e.props):typeof e=="object"&&!Array.isArray(e)?In(e):null}var fI=["children","width","height","viewBox","className","style","title","desc"];function Fu(){return Fu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Fu.apply(null,arguments)}function hI(e,t){if(e==null)return{};var n,i,a=mI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function mI(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}var xx=h.forwardRef((e,t)=>{var{children:n,width:i,height:a,viewBox:s,className:o,style:l,title:c,desc:d}=e,u=hI(e,fI),f=s||{width:i,height:a,x:0,y:0},m=ut("recharts-surface",o);return h.createElement("svg",Fu({},In(u),{className:m,width:i,height:a,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:t}),h.createElement("title",null,c),h.createElement("desc",null,d),n)}),pI=["children","className"];function qu(){return qu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},qu.apply(null,arguments)}function gI(e,t){if(e==null)return{};var n,i,a=yI(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function yI(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}var mn=h.forwardRef((e,t)=>{var{children:n,className:i}=e,a=gI(e,pI),s=ut("recharts-layer",i);return h.createElement("g",qu({className:s},In(a),{ref:t}),n)}),vI=h.createContext(null);function St(e){return function(){return e}}const bx=Math.cos,Mo=Math.sin,mr=Math.sqrt,Lo=Math.PI,_l=2*Lo,Uu=Math.PI,Hu=2*Uu,Ai=1e-6,xI=Hu-Ai;function jx(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function bI(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return jx;const n=10**t;return function(i){this._+=i[0];for(let a=1,s=i.length;a<s;++a)this._+=Math.round(arguments[a]*n)/n+i[a]}}class jI{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?jx:bI(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,i,a){this._append`Q${+t},${+n},${this._x1=+i},${this._y1=+a}`}bezierCurveTo(t,n,i,a,s,o){this._append`C${+t},${+n},${+i},${+a},${this._x1=+s},${this._y1=+o}`}arcTo(t,n,i,a,s){if(t=+t,n=+n,i=+i,a=+a,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,c=i-t,d=a-n,u=o-t,f=l-n,m=u*u+f*f;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(m>Ai)if(!(Math.abs(f*c-d*u)>Ai)||!s)this._append`L${this._x1=t},${this._y1=n}`;else{let p=i-o,y=a-l,v=c*c+d*d,g=p*p+y*y,b=Math.sqrt(v),x=Math.sqrt(m),N=s*Math.tan((Uu-Math.acos((v+m-g)/(2*b*x)))/2),A=N/x,C=N/b;Math.abs(A-1)>Ai&&this._append`L${t+A*u},${n+A*f}`,this._append`A${s},${s},0,0,${+(f*p>u*y)},${this._x1=t+C*c},${this._y1=n+C*d}`}}arc(t,n,i,a,s,o){if(t=+t,n=+n,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let l=i*Math.cos(a),c=i*Math.sin(a),d=t+l,u=n+c,f=1^o,m=o?a-s:s-a;this._x1===null?this._append`M${d},${u}`:(Math.abs(this._x1-d)>Ai||Math.abs(this._y1-u)>Ai)&&this._append`L${d},${u}`,i&&(m<0&&(m=m%Hu+Hu),m>xI?this._append`A${i},${i},0,1,${f},${t-l},${n-c}A${i},${i},0,1,${f},${this._x1=d},${this._y1=u}`:m>Ai&&this._append`A${i},${i},0,${+(m>=Uu)},${f},${this._x1=t+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(t,n,i,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${i=+i}v${+a}h${-i}Z`}toString(){return this._}}function af(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);t=i}return e},()=>new jI(t)}function sf(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function wx(e){this._context=e}wx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Ml(e){return new wx(e)}function Sx(e){return e[0]}function Nx(e){return e[1]}function kx(e,t){var n=St(!0),i=null,a=Ml,s=null,o=af(l);e=typeof e=="function"?e:e===void 0?Sx:St(e),t=typeof t=="function"?t:t===void 0?Nx:St(t);function l(c){var d,u=(c=sf(c)).length,f,m=!1,p;for(i==null&&(s=a(p=o())),d=0;d<=u;++d)!(d<u&&n(f=c[d],d,c))===m&&((m=!m)?s.lineStart():s.lineEnd()),m&&s.point(+e(f,d,c),+t(f,d,c));if(p)return s=null,p+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:St(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:St(+c),l):t},l.defined=function(c){return arguments.length?(n=typeof c=="function"?c:St(!!c),l):n},l.curve=function(c){return arguments.length?(a=c,i!=null&&(s=a(i)),l):a},l.context=function(c){return arguments.length?(c==null?i=s=null:s=a(i=c),l):i},l}function uo(e,t,n){var i=null,a=St(!0),s=null,o=Ml,l=null,c=af(d);e=typeof e=="function"?e:e===void 0?Sx:St(+e),t=typeof t=="function"?t:St(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?Nx:St(+n);function d(f){var m,p,y,v=(f=sf(f)).length,g,b=!1,x,N=new Array(v),A=new Array(v);for(s==null&&(l=o(x=c())),m=0;m<=v;++m){if(!(m<v&&a(g=f[m],m,f))===b)if(b=!b)p=m,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),y=m-1;y>=p;--y)l.point(N[y],A[y]);l.lineEnd(),l.areaEnd()}b&&(N[m]=+e(g,m,f),A[m]=+t(g,m,f),l.point(i?+i(g,m,f):N[m],n?+n(g,m,f):A[m]))}if(x)return l=null,x+""||null}function u(){return kx().defined(a).curve(o).context(s)}return d.x=function(f){return arguments.length?(e=typeof f=="function"?f:St(+f),i=null,d):e},d.x0=function(f){return arguments.length?(e=typeof f=="function"?f:St(+f),d):e},d.x1=function(f){return arguments.length?(i=f==null?null:typeof f=="function"?f:St(+f),d):i},d.y=function(f){return arguments.length?(t=typeof f=="function"?f:St(+f),n=null,d):t},d.y0=function(f){return arguments.length?(t=typeof f=="function"?f:St(+f),d):t},d.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:St(+f),d):n},d.lineX0=d.lineY0=function(){return u().x(e).y(t)},d.lineY1=function(){return u().x(e).y(n)},d.lineX1=function(){return u().x(i).y(t)},d.defined=function(f){return arguments.length?(a=typeof f=="function"?f:St(!!f),d):a},d.curve=function(f){return arguments.length?(o=f,s!=null&&(l=o(s)),d):o},d.context=function(f){return arguments.length?(f==null?s=l=null:l=o(s=f),d):s},d}class Ax{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function wI(e){return new Ax(e,!0)}function SI(e){return new Ax(e,!1)}const of={draw(e,t){const n=mr(t/Lo);e.moveTo(n,0),e.arc(0,0,n,0,_l)}},NI={draw(e,t){const n=mr(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},Cx=mr(1/3),kI=Cx*2,AI={draw(e,t){const n=mr(t/kI),i=n*Cx;e.moveTo(0,-n),e.lineTo(i,0),e.lineTo(0,n),e.lineTo(-i,0),e.closePath()}},CI={draw(e,t){const n=mr(t),i=-n/2;e.rect(i,i,n,n)}},EI=.8908130915292852,Ex=Mo(Lo/10)/Mo(7*Lo/10),II=Mo(_l/10)*Ex,PI=-bx(_l/10)*Ex,TI={draw(e,t){const n=mr(t*EI),i=II*n,a=PI*n;e.moveTo(0,-n),e.lineTo(i,a);for(let s=1;s<5;++s){const o=_l*s/5,l=bx(o),c=Mo(o);e.lineTo(c*n,-l*n),e.lineTo(l*i-c*a,c*i+l*a)}e.closePath()}},su=mr(3),OI={draw(e,t){const n=-mr(t/(su*3));e.moveTo(0,n*2),e.lineTo(-su*n,-n),e.lineTo(su*n,-n),e.closePath()}},Jn=-.5,Zn=mr(3)/2,Yu=1/mr(12),DI=(Yu/2+1)*3,_I={draw(e,t){const n=mr(t/DI),i=n/2,a=n*Yu,s=i,o=n*Yu+n,l=-s,c=o;e.moveTo(i,a),e.lineTo(s,o),e.lineTo(l,c),e.lineTo(Jn*i-Zn*a,Zn*i+Jn*a),e.lineTo(Jn*s-Zn*o,Zn*s+Jn*o),e.lineTo(Jn*l-Zn*c,Zn*l+Jn*c),e.lineTo(Jn*i+Zn*a,Jn*a-Zn*i),e.lineTo(Jn*s+Zn*o,Jn*o-Zn*s),e.lineTo(Jn*l+Zn*c,Jn*c-Zn*l),e.closePath()}};function MI(e,t){let n=null,i=af(a);e=typeof e=="function"?e:St(e||of),t=typeof t=="function"?t:St(t===void 0?64:+t);function a(){let s;if(n||(n=s=i()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return a.type=function(s){return arguments.length?(e=typeof s=="function"?s:St(s),a):e},a.size=function(s){return arguments.length?(t=typeof s=="function"?s:St(+s),a):t},a.context=function(s){return arguments.length?(n=s??null,a):n},a}function $o(){}function zo(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Ix(e){this._context=e}Ix.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:zo(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:zo(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function LI(e){return new Ix(e)}function Px(e){this._context=e}Px.prototype={areaStart:$o,areaEnd:$o,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:zo(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function $I(e){return new Px(e)}function Tx(e){this._context=e}Tx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,i=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break;case 3:this._point=4;default:zo(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function zI(e){return new Tx(e)}function Ox(e){this._context=e}Ox.prototype={areaStart:$o,areaEnd:$o,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function RI(e){return new Ox(e)}function Ap(e){return e<0?-1:1}function Cp(e,t,n){var i=e._x1-e._x0,a=t-e._x1,s=(e._y1-e._y0)/(i||a<0&&-0),o=(n-e._y1)/(a||i<0&&-0),l=(s*a+o*i)/(i+a);return(Ap(s)+Ap(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function Ep(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function ou(e,t,n){var i=e._x0,a=e._y0,s=e._x1,o=e._y1,l=(s-i)/3;e._context.bezierCurveTo(i+l,a+l*t,s-l,o-l*n,s,o)}function Ro(e){this._context=e}Ro.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ou(this,this._t0,Ep(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,ou(this,Ep(this,n=Cp(this,e,t)),n);break;default:ou(this,this._t0,n=Cp(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Dx(e){this._context=new _x(e)}(Dx.prototype=Object.create(Ro.prototype)).point=function(e,t){Ro.prototype.point.call(this,t,e)};function _x(e){this._context=e}_x.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,i,a,s){this._context.bezierCurveTo(t,e,i,n,s,a)}};function BI(e){return new Ro(e)}function WI(e){return new Dx(e)}function Mx(e){this._context=e}Mx.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var i=Ip(e),a=Ip(t),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(i[0][s],a[0][s],i[1][s],a[1][s],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Ip(e){var t,n=e.length-1,i,a=new Array(n),s=new Array(n),o=new Array(n);for(a[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)a[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(a[n-1]=2,s[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)i=a[t]/s[t-1],s[t]-=i,o[t]-=i*o[t-1];for(a[n-1]=o[n-1]/s[n-1],t=n-2;t>=0;--t)a[t]=(o[t]-a[t+1])/s[t];for(s[n-1]=(e[n]+a[n-1])/2,t=0;t<n-1;++t)s[t]=2*e[t+1]-a[t+1];return[a,s]}function FI(e){return new Mx(e)}function Ll(e,t){this._context=e,this._t=t}Ll.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function qI(e){return new Ll(e,.5)}function UI(e){return new Ll(e,0)}function HI(e){return new Ll(e,1)}function ga(e,t){if((o=e.length)>1)for(var n=1,i,a,s=e[t[0]],o,l=s.length;n<o;++n)for(a=s,s=e[t[n]],i=0;i<l;++i)s[i][1]+=s[i][0]=isNaN(a[i][1])?a[i][0]:a[i][1]}function Ku(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function YI(e,t){return e[t]}function KI(e){const t=[];return t.key=e,t}function VI(){var e=St([]),t=Ku,n=ga,i=YI;function a(s){var o=Array.from(e.apply(this,arguments),KI),l,c=o.length,d=-1,u;for(const f of s)for(l=0,++d;l<c;++l)(o[l][d]=[0,+i(f,o[l].key,d,s)]).data=f;for(l=0,u=sf(t(o));l<c;++l)o[u[l]].index=l;return n(o,u),o}return a.keys=function(s){return arguments.length?(e=typeof s=="function"?s:St(Array.from(s)),a):e},a.value=function(s){return arguments.length?(i=typeof s=="function"?s:St(+s),a):i},a.order=function(s){return arguments.length?(t=s==null?Ku:typeof s=="function"?s:St(Array.from(s)),a):t},a.offset=function(s){return arguments.length?(n=s??ga,a):n},a}function XI(e,t){if((i=e.length)>0){for(var n,i,a=0,s=e[0].length,o;a<s;++a){for(o=n=0;n<i;++n)o+=e[n][a][1]||0;if(o)for(n=0;n<i;++n)e[n][a][1]/=o}ga(e,t)}}function GI(e,t){if((a=e.length)>0){for(var n=0,i=e[t[0]],a,s=i.length;n<s;++n){for(var o=0,l=0;o<a;++o)l+=e[o][n][1]||0;i[n][1]+=i[n][0]=-l/2}ga(e,t)}}function QI(e,t){if(!(!((o=e.length)>0)||!((s=(a=e[t[0]]).length)>0))){for(var n=0,i=1,a,s,o;i<s;++i){for(var l=0,c=0,d=0;l<o;++l){for(var u=e[t[l]],f=u[i][1]||0,m=u[i-1][1]||0,p=(f-m)/2,y=0;y<l;++y){var v=e[t[y]],g=v[i][1]||0,b=v[i-1][1]||0;p+=g-b}c+=f,d+=p*f}a[i-1][1]+=a[i-1][0]=n,c&&(n-=d/c)}a[i-1][1]+=a[i-1][0]=n,ga(e,t)}}var $l={},Lx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==="__proto__"}e.isUnsafeProperty=t})(Lx);var lf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}e.isDeepKey=t})(lf);var zl={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){var i;return typeof n=="string"||typeof n=="symbol"?n:Object.is((i=n==null?void 0:n.valueOf)==null?void 0:i.call(n),-0)?"-0":String(n)}e.toKey=t})(zl);var Rl={},$x={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){if(n==null)return"";if(typeof n=="string")return n;if(Array.isArray(n))return n.map(t).join(",");const i=String(n);return i==="0"&&Object.is(Number(n),-0)?"-0":i}e.toString=t})($x);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$x,n=zl;function i(a){if(Array.isArray(a))return a.map(n.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const s=[],o=a.length;if(o===0)return s;let l=0,c="",d="",u=!1;for(a.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const f=a[l];d?f==="\\"&&l+1<o?(l++,c+=a[l]):f===d?d="":c+=f:u?f==='"'||f==="'"?d=f:f==="]"?(u=!1,s.push(c),c=""):c+=f:f==="["?(u=!0,c&&(s.push(c),c="")):f==="."?c&&(s.push(c),c=""):c+=f,l++}return c&&s.push(c),s}e.toPath=i})(Rl);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Lx,n=lf,i=zl,a=Rl;function s(l,c,d){if(l==null)return d;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?n.isDeepKey(c)?s(l,a.toPath(c),d):d:u}case"number":case"symbol":{typeof c=="number"&&(c=i.toKey(c));const u=l[c];return u===void 0?d:u}default:{if(Array.isArray(c))return o(l,c,d);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return d;const u=l[c];return u===void 0?d:u}}}function o(l,c,d){if(c.length===0)return d;let u=l;for(let f=0;f<c.length;f++){if(u==null||t.isUnsafeProperty(c[f]))return d;u=u[c[f]]}return u===void 0?d:u}e.get=s})($l);var JI=$l.get;const Bi=Pr(JI);var hn=e=>e===0?0:e>0?1:-1,hr=e=>typeof e=="number"&&e!=+e,qr=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Be=e=>(typeof e=="number"||e instanceof Number)&&!hr(e),Cr=e=>Be(e)||typeof e=="string",ZI=0,us=e=>{var t=++ZI;return"".concat(e||"").concat(t)},Sn=function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Be(t)&&typeof t!="string")return i;var s;if(qr(t)){if(n==null)return i;var o=t.indexOf("%");s=n*parseFloat(t.slice(0,o))/100}else s=+t;return hr(s)&&(s=i),a&&n!=null&&s>n&&(s=n),s},zx=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,n={},i=0;i<t;i++)if(!n[e[i]])n[e[i]]=!0;else return!0;return!1};function Ot(e,t,n){return Be(e)&&Be(t)?e+n*(t-e):t}function Rx(e,t,n){if(!(!e||!e.length))return e.find(i=>i&&(typeof t=="function"?t(i):Bi(i,t))===n)}var Mt=e=>e===null||typeof e>"u",Ns=e=>Mt(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function eP(e){return e!=null}function Vi(){}var tP=["type","size","sizeType"];function Vu(){return Vu=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Vu.apply(null,arguments)}function Pp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Tp(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Pp(Object(n),!0).forEach(function(i){nP(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pp(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function nP(e,t,n){return(t=rP(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rP(e){var t=iP(e,"string");return typeof t=="symbol"?t:t+""}function iP(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function aP(e,t){if(e==null)return{};var n,i,a=sP(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function sP(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}var Bx={symbolCircle:of,symbolCross:NI,symbolDiamond:AI,symbolSquare:CI,symbolStar:TI,symbolTriangle:OI,symbolWye:_I},oP=Math.PI/180,lP=e=>{var t="symbol".concat(Ns(e));return Bx[t]||of},cP=(e,t,n)=>{if(t==="area")return e;switch(n){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var i=18*oP;return 1.25*e*e*(Math.tan(i)-Math.tan(i*2)*Math.tan(i)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},uP=(e,t)=>{Bx["symbol".concat(Ns(e))]=t},Wx=e=>{var{type:t="circle",size:n=64,sizeType:i="area"}=e,a=aP(e,tP),s=Tp(Tp({},a),{},{type:t,size:n,sizeType:i}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var m=lP(o),p=MI().type(m).size(cP(n,i,o)),y=p();if(y!==null)return y},{className:c,cx:d,cy:u}=s,f=In(s);return Be(d)&&Be(u)&&Be(n)?h.createElement("path",Vu({},f,{className:ut("recharts-symbols",c),transform:"translate(".concat(d,", ").concat(u,")"),d:l()})):null};Wx.registerSymbol=uP;var Fx=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,cf=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(h.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var i={};return Object.keys(n).forEach(a=>{rf(a)&&(i[a]=s=>n[a](n,s))}),i},dP=(e,t,n)=>i=>(e(t,n,i),null),Bl=(e,t,n)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var i=null;return Object.keys(e).forEach(a=>{var s=e[a];rf(a)&&typeof s=="function"&&(i||(i={}),i[a]=dP(s,t,n))}),i};function Op(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function fP(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Op(Object(n),!0).forEach(function(i){hP(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Op(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function hP(e,t,n){return(t=mP(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mP(e){var t=pP(e,"string");return typeof t=="symbol"?t:t+""}function pP(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pn(e,t){var n=fP({},e),i=t,a=Object.keys(t),s=a.reduce((o,l)=>(o[l]===void 0&&i[l]!==void 0&&(o[l]=i[l]),o),n);return s}var qx={},Ux={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,i){const a=new Map;for(let s=0;s<n.length;s++){const o=n[s],l=i(o);a.has(l)||a.set(l,o)}return Array.from(a.values())}e.uniqBy=t})(Ux);var uf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n}e.identity=t})(uf);var Hx={},Wl={},Yx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Number.isSafeInteger(n)&&n>=0}e.isLength=t})(Yx);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Yx;function n(i){return i!=null&&typeof i!="function"&&t.isLength(i.length)}e.isArrayLike=n})(Wl);var Kx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="object"&&n!==null}e.isObjectLike=t})(Kx);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Wl,n=Kx;function i(a){return n.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=i})(Hx);var Vx={},Xx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$l;function n(i){return function(a){return t.get(a,i)}}e.property=n})(Xx);var Gx={},df={},Qx={},ff={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n!==null&&(typeof n=="object"||typeof n=="function")}e.isObject=t})(ff);var hf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null||typeof n!="object"&&typeof n!="function"}e.isPrimitive=t})(hf);var mf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,i){return n===i||Number.isNaN(n)&&Number.isNaN(i)}e.eq=t})(mf);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ff,n=hf,i=mf;function a(u,f,m){return typeof m!="function"?a(u,f,()=>{}):s(u,f,function p(y,v,g,b,x,N){const A=m(y,v,g,b,x,N);return A!==void 0?!!A:s(y,v,p,N)},new Map)}function s(u,f,m,p){if(f===u)return!0;switch(typeof f){case"object":return o(u,f,m,p);case"function":return Object.keys(f).length>0?s(u,{...f},m,p):i.eq(u,f);default:return t.isObject(u)?typeof f=="string"?f==="":!0:i.eq(u,f)}}function o(u,f,m,p){if(f==null)return!0;if(Array.isArray(f))return c(u,f,m,p);if(f instanceof Map)return l(u,f,m,p);if(f instanceof Set)return d(u,f,m,p);const y=Object.keys(f);if(u==null)return y.length===0;if(y.length===0)return!0;if(p!=null&&p.has(f))return p.get(f)===u;p==null||p.set(f,u);try{for(let v=0;v<y.length;v++){const g=y[v];if(!n.isPrimitive(u)&&!(g in u)||f[g]===void 0&&u[g]!==void 0||f[g]===null&&u[g]!==null||!m(u[g],f[g],g,u,f,p))return!1}return!0}finally{p==null||p.delete(f)}}function l(u,f,m,p){if(f.size===0)return!0;if(!(u instanceof Map))return!1;for(const[y,v]of f.entries()){const g=u.get(y);if(m(g,v,y,u,f,p)===!1)return!1}return!0}function c(u,f,m,p){if(f.length===0)return!0;if(!Array.isArray(u))return!1;const y=new Set;for(let v=0;v<f.length;v++){const g=f[v];let b=!1;for(let x=0;x<u.length;x++){if(y.has(x))continue;const N=u[x];let A=!1;if(m(N,g,v,u,f,p)&&(A=!0),A){y.add(x),b=!0;break}}if(!b)return!1}return!0}function d(u,f,m,p){return f.size===0?!0:u instanceof Set?c([...u],[...f],m,p):!1}e.isMatchWith=a,e.isSetMatch=d})(Qx);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Qx;function n(i,a){return t.isMatchWith(i,a,()=>{})}e.isMatch=n})(df);var Jx={},pf={},Zx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Object.getOwnPropertySymbols(n).filter(i=>Object.prototype.propertyIsEnumerable.call(n,i))}e.getSymbols=t})(Zx);var gf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}e.getTag=t})(gf);var yf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",n="[object String]",i="[object Number]",a="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",c="[object Map]",d="[object Set]",u="[object Array]",f="[object Function]",m="[object ArrayBuffer]",p="[object Object]",y="[object Error]",v="[object DataView]",g="[object Uint8Array]",b="[object Uint8ClampedArray]",x="[object Uint16Array]",N="[object Uint32Array]",A="[object BigUint64Array]",C="[object Int8Array]",w="[object Int16Array]",O="[object Int32Array]",M="[object BigInt64Array]",B="[object Float32Array]",z="[object Float64Array]";e.argumentsTag=s,e.arrayBufferTag=m,e.arrayTag=u,e.bigInt64ArrayTag=M,e.bigUint64ArrayTag=A,e.booleanTag=a,e.dataViewTag=v,e.dateTag=l,e.errorTag=y,e.float32ArrayTag=B,e.float64ArrayTag=z,e.functionTag=f,e.int16ArrayTag=w,e.int32ArrayTag=O,e.int8ArrayTag=C,e.mapTag=c,e.numberTag=i,e.objectTag=p,e.regexpTag=t,e.setTag=d,e.stringTag=n,e.symbolTag=o,e.uint16ArrayTag=x,e.uint32ArrayTag=N,e.uint8ArrayTag=g,e.uint8ClampedArrayTag=b})(yf);var e0={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}e.isTypedArray=t})(e0);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Zx,n=gf,i=yf,a=hf,s=e0;function o(u,f){return l(u,void 0,u,new Map,f)}function l(u,f,m,p=new Map,y=void 0){const v=y==null?void 0:y(u,f,m,p);if(v!==void 0)return v;if(a.isPrimitive(u))return u;if(p.has(u))return p.get(u);if(Array.isArray(u)){const g=new Array(u.length);p.set(u,g);for(let b=0;b<u.length;b++)g[b]=l(u[b],b,m,p,y);return Object.hasOwn(u,"index")&&(g.index=u.index),Object.hasOwn(u,"input")&&(g.input=u.input),g}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const g=new RegExp(u.source,u.flags);return g.lastIndex=u.lastIndex,g}if(u instanceof Map){const g=new Map;p.set(u,g);for(const[b,x]of u)g.set(b,l(x,b,m,p,y));return g}if(u instanceof Set){const g=new Set;p.set(u,g);for(const b of u)g.add(l(b,void 0,m,p,y));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(s.isTypedArray(u)){const g=new(Object.getPrototypeOf(u)).constructor(u.length);p.set(u,g);for(let b=0;b<u.length;b++)g[b]=l(u[b],b,m,p,y);return g}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const g=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return p.set(u,g),c(g,u,m,p,y),g}if(typeof File<"u"&&u instanceof File){const g=new File([u],u.name,{type:u.type});return p.set(u,g),c(g,u,m,p,y),g}if(typeof Blob<"u"&&u instanceof Blob){const g=new Blob([u],{type:u.type});return p.set(u,g),c(g,u,m,p,y),g}if(u instanceof Error){const g=new u.constructor;return p.set(u,g),g.message=u.message,g.name=u.name,g.stack=u.stack,g.cause=u.cause,c(g,u,m,p,y),g}if(u instanceof Boolean){const g=new Boolean(u.valueOf());return p.set(u,g),c(g,u,m,p,y),g}if(u instanceof Number){const g=new Number(u.valueOf());return p.set(u,g),c(g,u,m,p,y),g}if(u instanceof String){const g=new String(u.valueOf());return p.set(u,g),c(g,u,m,p,y),g}if(typeof u=="object"&&d(u)){const g=Object.create(Object.getPrototypeOf(u));return p.set(u,g),c(g,u,m,p,y),g}return u}function c(u,f,m=u,p,y){const v=[...Object.keys(f),...t.getSymbols(f)];for(let g=0;g<v.length;g++){const b=v[g],x=Object.getOwnPropertyDescriptor(u,b);(x==null||x.writable)&&(u[b]=l(f[b],b,m,p,y))}}function d(u){switch(n.getTag(u)){case i.argumentsTag:case i.arrayTag:case i.arrayBufferTag:case i.dataViewTag:case i.booleanTag:case i.dateTag:case i.float32ArrayTag:case i.float64ArrayTag:case i.int8ArrayTag:case i.int16ArrayTag:case i.int32ArrayTag:case i.mapTag:case i.numberTag:case i.objectTag:case i.regexpTag:case i.setTag:case i.stringTag:case i.symbolTag:case i.uint8ArrayTag:case i.uint8ClampedArrayTag:case i.uint16ArrayTag:case i.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=c})(pf);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pf;function n(i){return t.cloneDeepWithImpl(i,void 0,i,new Map,void 0)}e.cloneDeep=n})(Jx);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=df,n=Jx;function i(a){return a=n.cloneDeep(a),s=>t.isMatch(s,a)}e.matches=i})(Gx);var t0={},n0={},r0={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=pf,n=yf;function i(a,s){return t.cloneDeepWith(a,(o,l,c,d)=>{const u=s==null?void 0:s(o,l,c,d);if(u!==void 0)return u;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case n.numberTag:case n.stringTag:case n.booleanTag:{const f=new a.constructor(a==null?void 0:a.valueOf());return t.copyProperties(f,a),f}case n.argumentsTag:{const f={};return t.copyProperties(f,a),f.length=a.length,f[Symbol.iterator]=a[Symbol.iterator],f}default:return}})}e.cloneDeepWith=i})(r0);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=r0;function n(i){return t.cloneDeepWith(i)}e.cloneDeep=n})(n0);var i0={},vf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function n(i,a=Number.MAX_SAFE_INTEGER){switch(typeof i){case"number":return Number.isInteger(i)&&i>=0&&i<a;case"symbol":return!1;case"string":return t.test(i)}}e.isIndex=n})(vf);var a0={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=gf;function n(i){return i!==null&&typeof i=="object"&&t.getTag(i)==="[object Arguments]"}e.isArguments=n})(a0);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lf,n=vf,i=a0,a=Rl;function s(o,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&t.isDeepKey(l)&&(o==null?void 0:o[l])==null?c=a.toPath(l):c=[l],c.length===0)return!1;let d=o;for(let u=0;u<c.length;u++){const f=c[u];if((d==null||!Object.hasOwn(d,f))&&!((Array.isArray(d)||i.isArguments(d))&&n.isIndex(f)&&f<d.length))return!1;d=d[f]}return!0}e.has=s})(i0);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=df,n=zl,i=n0,a=$l,s=i0;function o(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=n.toKey(l);break}}return c=i.cloneDeep(c),function(d){const u=a.get(d,l);return u===void 0?s.has(d,l):c===void 0?u===void 0:t.isMatch(u,c)}}e.matchesProperty=o})(t0);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=uf,n=Xx,i=Gx,a=t0;function s(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?a.matchesProperty(o[0],o[1]):i.matches(o);case"string":case"symbol":case"number":return n.property(o)}}e.iteratee=s})(Vx);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ux,n=uf,i=Hx,a=Vx;function s(o,l=n.identity){return i.isArrayLikeObject(o)?t.uniqBy(Array.from(o),a.iteratee(l)):[]}e.uniqBy=s})(qx);var gP=qx.uniqBy;const Dp=Pr(gP);function yP(e,t,n){return t===!0?Dp(e,n):typeof t=="function"?Dp(e,t):e}var s0={exports:{}},o0={},l0={exports:{}},c0={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ya=h;function vP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var xP=typeof Object.is=="function"?Object.is:vP,bP=ya.useState,jP=ya.useEffect,wP=ya.useLayoutEffect,SP=ya.useDebugValue;function NP(e,t){var n=t(),i=bP({inst:{value:n,getSnapshot:t}}),a=i[0].inst,s=i[1];return wP(function(){a.value=n,a.getSnapshot=t,lu(a)&&s({inst:a})},[e,n,t]),jP(function(){return lu(a)&&s({inst:a}),e(function(){lu(a)&&s({inst:a})})},[e]),SP(n),n}function lu(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!xP(e,n)}catch{return!0}}function kP(e,t){return t()}var AP=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?kP:NP;c0.useSyncExternalStore=ya.useSyncExternalStore!==void 0?ya.useSyncExternalStore:AP;l0.exports=c0;var CP=l0.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fl=h,EP=CP;function IP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var PP=typeof Object.is=="function"?Object.is:IP,TP=EP.useSyncExternalStore,OP=Fl.useRef,DP=Fl.useEffect,_P=Fl.useMemo,MP=Fl.useDebugValue;o0.useSyncExternalStoreWithSelector=function(e,t,n,i,a){var s=OP(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=_P(function(){function c(p){if(!d){if(d=!0,u=p,p=i(p),a!==void 0&&o.hasValue){var y=o.value;if(a(y,p))return f=y}return f=p}if(y=f,PP(u,p))return y;var v=i(p);return a!==void 0&&a(y,v)?(u=p,y):(u=p,f=v)}var d=!1,u,f,m=n===void 0?null:n;return[function(){return c(t())},m===null?void 0:function(){return c(m())}]},[t,n,i,a]);var l=TP(e,s[0],s[1]);return DP(function(){o.hasValue=!0,o.value=l},[l]),MP(l),l};s0.exports=o0;var LP=s0.exports,xf=h.createContext(null),$P=e=>e,Lt=()=>{var e=h.useContext(xf);return e?e.store.dispatch:$P},Io=()=>{},zP=()=>Io,RP=(e,t)=>e===t;function We(e){var t=h.useContext(xf);return LP.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:zP,t?t.store.getState:Io,t?t.store.getState:Io,t?e:Io,RP)}function BP(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function WP(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function FP(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(n=>typeof n=="function")){const n=e.map(i=>typeof i=="function"?`function ${i.name||"unnamed"}()`:typeof i).join(", ");throw new TypeError(`${t}[${n}]`)}}var _p=e=>Array.isArray(e)?e:[e];function qP(e){const t=Array.isArray(e[0])?e[0]:e;return FP(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function UP(e,t){const n=[],{length:i}=e;for(let a=0;a<i;a++)n.push(e[a].apply(null,t));return n}var HP=class{constructor(e){this.value=e}deref(){return this.value}},YP=typeof WeakRef<"u"?WeakRef:HP,KP=0,Mp=1;function fo(){return{s:KP,v:void 0,o:null,p:null}}function u0(e,t={}){let n=fo();const{resultEqualityCheck:i}=t;let a,s=0;function o(){var f;let l=n;const{length:c}=arguments;for(let m=0,p=c;m<p;m++){const y=arguments[m];if(typeof y=="function"||typeof y=="object"&&y!==null){let v=l.o;v===null&&(l.o=v=new WeakMap);const g=v.get(y);g===void 0?(l=fo(),v.set(y,l)):l=g}else{let v=l.p;v===null&&(l.p=v=new Map);const g=v.get(y);g===void 0?(l=fo(),v.set(y,l)):l=g}}const d=l;let u;if(l.s===Mp)u=l.v;else if(u=e.apply(null,arguments),s++,i){const m=((f=a==null?void 0:a.deref)==null?void 0:f.call(a))??a;m!=null&&i(m,u)&&(u=m,s!==0&&s--),a=typeof u=="object"&&u!==null||typeof u=="function"?new YP(u):u}return d.s=Mp,d.v=u,u}return o.clearCache=()=>{n=fo(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function VP(e,...t){const n=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,i=(...a)=>{let s=0,o=0,l,c={},d=a.pop();typeof d=="object"&&(c=d,d=a.pop()),BP(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const u={...n,...c},{memoize:f,memoizeOptions:m=[],argsMemoize:p=u0,argsMemoizeOptions:y=[]}=u,v=_p(m),g=_p(y),b=qP(a),x=f(function(){return s++,d.apply(null,arguments)},...v),N=p(function(){o++;const C=UP(b,arguments);return l=x.apply(null,C),l},...g);return Object.assign(N,{resultFunc:d,memoizedResultFunc:x,dependencies:b,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:f,argsMemoize:p})};return Object.assign(i,{withTypes:()=>i}),i}var pe=VP(u0),XP=Object.assign((e,t=pe)=>{WP(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const n=Object.keys(e),i=n.map(s=>e[s]);return t(i,(...s)=>s.reduce((o,l,c)=>(o[n[c]]=l,o),{}))},{withTypes:()=>XP}),d0={},f0={},h0={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(i){return typeof i=="symbol"?1:i===null?2:i===void 0?3:i!==i?4:0}const n=(i,a,s)=>{if(i!==a){const o=t(i),l=t(a);if(o===l&&o===0){if(i<a)return s==="desc"?1:-1;if(i>a)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};e.compareValues=n})(h0);var m0={},bf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"||n instanceof Symbol}e.isSymbol=t})(bf);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bf,n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;function a(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||t.isSymbol(s)?!0:typeof s=="string"&&(i.test(s)||!n.test(s))||o!=null&&Object.hasOwn(o,s)}e.isKey=a})(m0);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=h0,n=m0,i=Rl;function a(s,o,l,c){if(s==null)return[];l=c?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(p=>String(p));const d=(p,y)=>{let v=p;for(let g=0;g<y.length&&v!=null;++g)v=v[y[g]];return v},u=(p,y)=>y==null||p==null?y:typeof p=="object"&&"key"in p?Object.hasOwn(y,p.key)?y[p.key]:d(y,p.path):typeof p=="function"?p(y):Array.isArray(p)?d(y,p):typeof y=="object"?y[p]:y,f=o.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||n.isKey(p)?p:{key:p,path:i.toPath(p)}));return s.map(p=>({original:p,criteria:f.map(y=>u(y,p))})).slice().sort((p,y)=>{for(let v=0;v<f.length;v++){const g=t.compareValues(p.criteria[v],y.criteria[v],l[v]);if(g!==0)return g}return 0}).map(p=>p.original)}e.orderBy=a})(f0);var p0={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,i=1){const a=[],s=Math.floor(i),o=(l,c)=>{for(let d=0;d<l.length;d++){const u=l[d];Array.isArray(u)&&c<s?o(u,c+1):a.push(u)}};return o(n,0),a}e.flatten=t})(p0);var jf={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=vf,n=Wl,i=ff,a=mf;function s(o,l,c){return i.isObject(c)&&(typeof l=="number"&&n.isArrayLike(c)&&t.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?a.eq(c[l],o):!1}e.isIterateeCall=s})(jf);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=f0,n=p0,i=jf;function a(s,...o){const l=o.length;return l>1&&i.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&i.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(s,n.flatten(o),["asc"])}e.sortBy=a})(d0);var GP=d0.sortBy;const ql=Pr(GP);var g0=e=>e.legend.settings,QP=e=>e.legend.size,JP=e=>e.legend.payload;pe([JP,g0],(e,t)=>{var{itemSorter:n}=t,i=e.flat(1);return n?ql(i,n):i});var ho=1;function ZP(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,n]=h.useState({height:0,left:0,top:0,width:0}),i=h.useCallback(a=>{if(a!=null){var s=a.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-t.height)>ho||Math.abs(o.left-t.left)>ho||Math.abs(o.top-t.top)>ho||Math.abs(o.width-t.width)>ho)&&n({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,i]}function vn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var eT=typeof Symbol=="function"&&Symbol.observable||"@@observable",Lp=eT,cu=()=>Math.random().toString(36).substring(7).split("").join("."),tT={INIT:`@@redux/INIT${cu()}`,REPLACE:`@@redux/REPLACE${cu()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${cu()}`},Bo=tT;function wf(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function y0(e,t,n){if(typeof e!="function")throw new Error(vn(2));if(typeof t=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(vn(0));if(typeof t=="function"&&typeof n>"u"&&(n=t,t=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(vn(1));return n(y0)(e,t)}let i=e,a=t,s=new Map,o=s,l=0,c=!1;function d(){o===s&&(o=new Map,s.forEach((g,b)=>{o.set(b,g)}))}function u(){if(c)throw new Error(vn(3));return a}function f(g){if(typeof g!="function")throw new Error(vn(4));if(c)throw new Error(vn(5));let b=!0;d();const x=l++;return o.set(x,g),function(){if(b){if(c)throw new Error(vn(6));b=!1,d(),o.delete(x),s=null}}}function m(g){if(!wf(g))throw new Error(vn(7));if(typeof g.type>"u")throw new Error(vn(8));if(typeof g.type!="string")throw new Error(vn(17));if(c)throw new Error(vn(9));try{c=!0,a=i(a,g)}finally{c=!1}return(s=o).forEach(x=>{x()}),g}function p(g){if(typeof g!="function")throw new Error(vn(10));i=g,m({type:Bo.REPLACE})}function y(){const g=f;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(vn(11));function x(){const A=b;A.next&&A.next(u())}return x(),{unsubscribe:g(x)}},[Lp](){return this}}}return m({type:Bo.INIT}),{dispatch:m,subscribe:f,getState:u,replaceReducer:p,[Lp]:y}}function nT(e){Object.keys(e).forEach(t=>{const n=e[t];if(typeof n(void 0,{type:Bo.INIT})>"u")throw new Error(vn(12));if(typeof n(void 0,{type:Bo.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(vn(13))})}function v0(e){const t=Object.keys(e),n={};for(let s=0;s<t.length;s++){const o=t[s];typeof e[o]=="function"&&(n[o]=e[o])}const i=Object.keys(n);let a;try{nT(n)}catch(s){a=s}return function(o={},l){if(a)throw a;let c=!1;const d={};for(let u=0;u<i.length;u++){const f=i[u],m=n[f],p=o[f],y=m(p,l);if(typeof y>"u")throw l&&l.type,new Error(vn(14));d[f]=y,c=c||y!==p}return c=c||i.length!==Object.keys(o).length,c?d:o}}function Wo(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,n)=>(...i)=>t(n(...i)))}function rT(...e){return t=>(n,i)=>{const a=t(n,i);let s=()=>{throw new Error(vn(15))};const o={getState:a.getState,dispatch:(c,...d)=>s(c,...d)},l=e.map(c=>c(o));return s=Wo(...l)(a.dispatch),{...a,dispatch:s}}}function x0(e){return wf(e)&&"type"in e&&typeof e.type=="string"}var b0=Symbol.for("immer-nothing"),$p=Symbol.for("immer-draftable"),Vn=Symbol.for("immer-state");function dr(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var ds=Object.getPrototypeOf;function Wi(e){return!!e&&!!e[Vn]}function Ur(e){var t;return e?j0(e)||Array.isArray(e)||!!e[$p]||!!((t=e.constructor)!=null&&t[$p])||ks(e)||Hl(e):!1}var iT=Object.prototype.constructor.toString(),zp=new WeakMap;function j0(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(n===Object)return!0;if(typeof n!="function")return!1;let i=zp.get(n);return i===void 0&&(i=Function.toString.call(n),zp.set(n,i)),i===iT}function Fo(e,t,n=!0){Ul(e)===0?(n?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((i,a)=>t(a,i,e))}function Ul(e){const t=e[Vn];return t?t.type_:Array.isArray(e)?1:ks(e)?2:Hl(e)?3:0}function Xu(e,t){return Ul(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function w0(e,t,n){const i=Ul(e);i===2?e.set(t,n):i===3?e.add(n):e[t]=n}function aT(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function ks(e){return e instanceof Map}function Hl(e){return e instanceof Set}function Ci(e){return e.copy_||e.base_}function Gu(e,t){if(ks(e))return new Map(e);if(Hl(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=j0(e);if(t===!0||t==="class_only"&&!n){const i=Object.getOwnPropertyDescriptors(e);delete i[Vn];let a=Reflect.ownKeys(i);for(let s=0;s<a.length;s++){const o=a[s],l=i[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(i[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(ds(e),i)}else{const i=ds(e);if(i!==null&&n)return{...e};const a=Object.create(i);return Object.assign(a,e)}}function Sf(e,t=!1){return Yl(e)||Wi(e)||!Ur(e)||(Ul(e)>1&&Object.defineProperties(e,{set:mo,add:mo,clear:mo,delete:mo}),Object.freeze(e),t&&Object.values(e).forEach(n=>Sf(n,!0))),e}function sT(){dr(2)}var mo={value:sT};function Yl(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var oT={};function Fi(e){const t=oT[e];return t||dr(0,e),t}var fs;function S0(){return fs}function lT(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Rp(e,t){t&&(Fi("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Qu(e){Ju(e),e.drafts_.forEach(cT),e.drafts_=null}function Ju(e){e===fs&&(fs=e.parent_)}function Bp(e){return fs=lT(fs,e)}function cT(e){const t=e[Vn];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Wp(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[Vn].modified_&&(Qu(t),dr(4)),Ur(e)&&(e=qo(t,e),t.parent_||Uo(t,e)),t.patches_&&Fi("Patches").generateReplacementPatches_(n[Vn].base_,e,t.patches_,t.inversePatches_)):e=qo(t,n,[]),Qu(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==b0?e:void 0}function qo(e,t,n){if(Yl(t))return t;const i=e.immer_.shouldUseStrictIteration(),a=t[Vn];if(!a)return Fo(t,(s,o)=>Fp(e,a,t,s,o,n),i),t;if(a.scope_!==e)return t;if(!a.modified_)return Uo(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const s=a.copy_;let o=s,l=!1;a.type_===3&&(o=new Set(s),s.clear(),l=!0),Fo(o,(c,d)=>Fp(e,a,s,c,d,n,l),i),Uo(e,s,!1),n&&e.patches_&&Fi("Patches").generatePatches_(a,n,e.patches_,e.inversePatches_)}return a.copy_}function Fp(e,t,n,i,a,s,o){if(a==null||typeof a!="object"&&!o)return;const l=Yl(a);if(!(l&&!o)){if(Wi(a)){const c=s&&t&&t.type_!==3&&!Xu(t.assigned_,i)?s.concat(i):void 0,d=qo(e,a,c);if(w0(n,i,d),Wi(d))e.canAutoFreeze_=!1;else return}else o&&n.add(a);if(Ur(a)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[i]===a&&l)return;qo(e,a),(!t||!t.scope_.parent_)&&typeof i!="symbol"&&(ks(n)?n.has(i):Object.prototype.propertyIsEnumerable.call(n,i))&&Uo(e,a)}}}function Uo(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Sf(t,n)}function uT(e,t){const n=Array.isArray(e),i={type_:n?1:0,scope_:t?t.scope_:S0(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=i,s=Nf;n&&(a=[i],s=hs);const{revoke:o,proxy:l}=Proxy.revocable(a,s);return i.draft_=l,i.revoke_=o,l}var Nf={get(e,t){if(t===Vn)return e;const n=Ci(e);if(!Xu(n,t))return dT(e,n,t);const i=n[t];return e.finalized_||!Ur(i)?i:i===uu(e.base_,t)?(du(e),e.copy_[t]=ed(i,e)):i},has(e,t){return t in Ci(e)},ownKeys(e){return Reflect.ownKeys(Ci(e))},set(e,t,n){const i=N0(Ci(e),t);if(i!=null&&i.set)return i.set.call(e.draft_,n),!0;if(!e.modified_){const a=uu(Ci(e),t),s=a==null?void 0:a[Vn];if(s&&s.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(aT(n,a)&&(n!==void 0||Xu(e.base_,t)))return!0;du(e),Zu(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return uu(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,du(e),Zu(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=Ci(e),i=Reflect.getOwnPropertyDescriptor(n,t);return i&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:i.enumerable,value:n[t]}},defineProperty(){dr(11)},getPrototypeOf(e){return ds(e.base_)},setPrototypeOf(){dr(12)}},hs={};Fo(Nf,(e,t)=>{hs[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});hs.deleteProperty=function(e,t){return hs.set.call(this,e,t,void 0)};hs.set=function(e,t,n){return Nf.set.call(this,e[0],t,n,e[0])};function uu(e,t){const n=e[Vn];return(n?Ci(n):e)[t]}function dT(e,t,n){var a;const i=N0(t,n);return i?"value"in i?i.value:(a=i.get)==null?void 0:a.call(e.draft_):void 0}function N0(e,t){if(!(t in e))return;let n=ds(e);for(;n;){const i=Object.getOwnPropertyDescriptor(n,t);if(i)return i;n=ds(n)}}function Zu(e){e.modified_||(e.modified_=!0,e.parent_&&Zu(e.parent_))}function du(e){e.copy_||(e.copy_=Gu(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var fT=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,n,i)=>{if(typeof t=="function"&&typeof n!="function"){const s=n;n=t;const o=this;return function(c=s,...d){return o.produce(c,u=>n.call(this,u,...d))}}typeof n!="function"&&dr(6),i!==void 0&&typeof i!="function"&&dr(7);let a;if(Ur(t)){const s=Bp(this),o=ed(t,void 0);let l=!0;try{a=n(o),l=!1}finally{l?Qu(s):Ju(s)}return Rp(s,i),Wp(a,s)}else if(!t||typeof t!="object"){if(a=n(t),a===void 0&&(a=t),a===b0&&(a=void 0),this.autoFreeze_&&Sf(a,!0),i){const s=[],o=[];Fi("Patches").generateReplacementPatches_(t,a,s,o),i(s,o)}return a}else dr(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,c=>t(c,...l));let i,a;return[this.produce(t,n,(o,l)=>{i=o,a=l}),i,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Ur(e)||dr(8),Wi(e)&&(e=Wr(e));const t=Bp(this),n=ed(e,void 0);return n[Vn].isManual_=!0,Ju(t),n}finishDraft(e,t){const n=e&&e[Vn];(!n||!n.isManual_)&&dr(9);const{scope_:i}=n;return Rp(i,t),Wp(void 0,i)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const a=t[n];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}n>-1&&(t=t.slice(n+1));const i=Fi("Patches").applyPatches_;return Wi(e)?i(e,t):this.produce(e,a=>i(a,t))}};function ed(e,t){const n=ks(e)?Fi("MapSet").proxyMap_(e,t):Hl(e)?Fi("MapSet").proxySet_(e,t):uT(e,t);return(t?t.scope_:S0()).drafts_.push(n),n}function Wr(e){return Wi(e)||dr(10,e),k0(e)}function k0(e){if(!Ur(e)||Yl(e))return e;const t=e[Vn];let n,i=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=Gu(e,t.scope_.immer_.useStrictShallowCopy_),i=t.scope_.immer_.shouldUseStrictIteration()}else n=Gu(e,!0);return Fo(n,(a,s)=>{w0(n,a,k0(s))},i),t&&(t.finalized_=!1),n}var td=new fT,A0=td.produce,hT=td.setUseStrictIteration.bind(td);function C0(e){return({dispatch:n,getState:i})=>a=>s=>typeof s=="function"?s(n,i,e):a(s)}var mT=C0(),pT=C0,gT=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Wo:Wo.apply(null,arguments)};function rr(e,t){function n(...i){if(t){let a=t(...i);if(!a)throw new Error(Yn(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:i[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=i=>x0(i)&&i.type===e,n}var E0=class Za extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Za.prototype)}static get[Symbol.species](){return Za}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Za(...t[0].concat(this)):new Za(...t.concat(this))}};function qp(e){return Ur(e)?A0(e,()=>{}):e}function po(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}function yT(e){return typeof e=="boolean"}var vT=()=>function(t){const{thunk:n=!0,immutableCheck:i=!0,serializableCheck:a=!0,actionCreatorCheck:s=!0}=t??{};let o=new E0;return n&&(yT(n)?o.push(mT):o.push(pT(n.extraArgument))),o},I0="RTK_autoBatch",sn=()=>e=>({payload:e,meta:{[I0]:!0}}),Up=e=>t=>{setTimeout(t,e)},P0=(e={type:"raf"})=>t=>(...n)=>{const i=t(...n);let a=!0,s=!1,o=!1;const l=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Up(10):e.type==="callback"?e.queueNotification:Up(e.timeout),d=()=>{o=!1,s&&(s=!1,l.forEach(u=>u()))};return Object.assign({},i,{subscribe(u){const f=()=>a&&u(),m=i.subscribe(f);return l.add(u),()=>{m(),l.delete(u)}},dispatch(u){var f;try{return a=!((f=u==null?void 0:u.meta)!=null&&f[I0]),s=!a,s&&(o||(o=!0,c(d))),i.dispatch(u)}finally{a=!0}}})},xT=e=>function(n){const{autoBatch:i=!0}=n??{};let a=new E0(e);return i&&a.push(P0(typeof i=="object"?i:void 0)),a};function bT(e){const t=vT(),{reducer:n=void 0,middleware:i,devTools:a=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let l;if(typeof n=="function")l=n;else if(wf(n))l=v0(n);else throw new Error(Yn(1));let c;typeof i=="function"?c=i(t):c=t();let d=Wo;a&&(d=gT({trace:!1,...typeof a=="object"&&a}));const u=rT(...c),f=xT(u);let m=typeof o=="function"?o(f):f();const p=d(...m);return y0(l,s,p)}function T0(e){const t={},n=[];let i;const a={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(Yn(28));if(l in t)throw new Error(Yn(29));return t[l]=o,a},addAsyncThunk(s,o){return o.pending&&(t[s.pending.type]=o.pending),o.rejected&&(t[s.rejected.type]=o.rejected),o.fulfilled&&(t[s.fulfilled.type]=o.fulfilled),o.settled&&n.push({matcher:s.settled,reducer:o.settled}),a},addMatcher(s,o){return n.push({matcher:s,reducer:o}),a},addDefaultCase(s){return i=s,a}};return e(a),[t,n,i]}hT(!1);function jT(e){return typeof e=="function"}function wT(e,t){let[n,i,a]=T0(t),s;if(jT(e))s=()=>qp(e());else{const l=qp(e);s=()=>l}function o(l=s(),c){let d=[n[c.type],...i.filter(({matcher:u})=>u(c)).map(({reducer:u})=>u)];return d.filter(u=>!!u).length===0&&(d=[a]),d.reduce((u,f)=>{if(f)if(Wi(u)){const p=f(u,c);return p===void 0?u:p}else{if(Ur(u))return A0(u,m=>f(m,c));{const m=f(u,c);if(m===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return u},l)}return o.getInitialState=s,o}var ST="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",NT=(e=21)=>{let t="",n=e;for(;n--;)t+=ST[Math.random()*64|0];return t},kT=Symbol.for("rtk-slice-createasyncthunk");function AT(e,t){return`${e}/${t}`}function CT({creators:e}={}){var n;const t=(n=e==null?void 0:e.asyncThunk)==null?void 0:n[kT];return function(a){const{name:s,reducerPath:o=s}=a;if(!s)throw new Error(Yn(11));const l=(typeof a.reducers=="function"?a.reducers(IT()):a.reducers)||{},c=Object.keys(l),d={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(A,C){const w=typeof A=="string"?A:A.type;if(!w)throw new Error(Yn(12));if(w in d.sliceCaseReducersByType)throw new Error(Yn(13));return d.sliceCaseReducersByType[w]=C,u},addMatcher(A,C){return d.sliceMatchers.push({matcher:A,reducer:C}),u},exposeAction(A,C){return d.actionCreators[A]=C,u},exposeCaseReducer(A,C){return d.sliceCaseReducersByName[A]=C,u}};c.forEach(A=>{const C=l[A],w={reducerName:A,type:AT(s,A),createNotation:typeof a.reducers=="function"};TT(C)?DT(w,C,u,t):PT(w,C,u)});function f(){const[A={},C=[],w=void 0]=typeof a.extraReducers=="function"?T0(a.extraReducers):[a.extraReducers],O={...A,...d.sliceCaseReducersByType};return wT(a.initialState,M=>{for(let B in O)M.addCase(B,O[B]);for(let B of d.sliceMatchers)M.addMatcher(B.matcher,B.reducer);for(let B of C)M.addMatcher(B.matcher,B.reducer);w&&M.addDefaultCase(w)})}const m=A=>A,p=new Map,y=new WeakMap;let v;function g(A,C){return v||(v=f()),v(A,C)}function b(){return v||(v=f()),v.getInitialState()}function x(A,C=!1){function w(M){let B=M[A];return typeof B>"u"&&C&&(B=po(y,w,b)),B}function O(M=m){const B=po(p,C,()=>new WeakMap);return po(B,M,()=>{const z={};for(const[j,k]of Object.entries(a.selectors??{}))z[j]=ET(k,M,()=>po(y,M,b),C);return z})}return{reducerPath:A,getSelectors:O,get selectors(){return O(w)},selectSlice:w}}const N={name:s,reducer:g,actions:d.actionCreators,caseReducers:d.sliceCaseReducersByName,getInitialState:b,...x(o),injectInto(A,{reducerPath:C,...w}={}){const O=C??o;return A.inject({reducerPath:O,reducer:g},w),{...N,...x(O,!0)}}};return N}}function ET(e,t,n,i){function a(s,...o){let l=t(s);return typeof l>"u"&&i&&(l=n()),e(l,...o)}return a.unwrapped=e,a}var $n=CT();function IT(){function e(t,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...n}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...n){return t(...n)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:n}},asyncThunk:e}}function PT({type:e,reducerName:t,createNotation:n},i,a){let s,o;if("reducer"in i){if(n&&!OT(i))throw new Error(Yn(17));s=i.reducer,o=i.prepare}else s=i;a.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?rr(e,o):rr(e))}function TT(e){return e._reducerDefinitionType==="asyncThunk"}function OT(e){return e._reducerDefinitionType==="reducerWithPrepare"}function DT({type:e,reducerName:t},n,i,a){if(!a)throw new Error(Yn(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:c,settled:d,options:u}=n,f=a(e,s,u);i.exposeAction(t,f),o&&i.addCase(f.fulfilled,o),l&&i.addCase(f.pending,l),c&&i.addCase(f.rejected,c),d&&i.addMatcher(f.settled,d),i.exposeCaseReducer(t,{fulfilled:o||go,pending:l||go,rejected:c||go,settled:d||go})}function go(){}var _T="task",O0="listener",D0="completed",kf="cancelled",MT=`task-${kf}`,LT=`task-${D0}`,nd=`${O0}-${kf}`,$T=`${O0}-${D0}`,Kl=class{constructor(e){Rc(this,"name","TaskAbortError");Rc(this,"message");this.code=e,this.message=`${_T} ${kf} (reason: ${e})`}},Af=(e,t)=>{if(typeof e!="function")throw new TypeError(Yn(32))},Ho=()=>{},_0=(e,t=Ho)=>(e.catch(t),e),M0=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),Di=(e,t)=>{const n=e.signal;n.aborted||("reason"in n||Object.defineProperty(n,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},_i=e=>{if(e.aborted){const{reason:t}=e;throw new Kl(t)}};function L0(e,t){let n=Ho;return new Promise((i,a)=>{const s=()=>a(new Kl(e.reason));if(e.aborted){s();return}n=M0(e,s),t.finally(()=>n()).then(i,a)}).finally(()=>{n=Ho})}var zT=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(n){return{status:n instanceof Kl?"cancelled":"rejected",error:n}}finally{t==null||t()}},Yo=e=>t=>_0(L0(e,t).then(n=>(_i(e),n))),$0=e=>{const t=Yo(e);return n=>t(new Promise(i=>setTimeout(i,n)))},{assign:ma}=Object,Hp={},Vl="listenerMiddleware",RT=(e,t)=>{const n=i=>M0(e,()=>Di(i,e.reason));return(i,a)=>{Af(i);const s=new AbortController;n(s);const o=zT(async()=>{_i(e),_i(s.signal);const l=await i({pause:Yo(s.signal),delay:$0(s.signal),signal:s.signal});return _i(s.signal),l},()=>Di(s,LT));return a!=null&&a.autoJoin&&t.push(o.catch(Ho)),{result:Yo(e)(o),cancel(){Di(s,MT)}}}},BT=(e,t)=>{const n=async(i,a)=>{_i(t);let s=()=>{};const l=[new Promise((c,d)=>{let u=e({predicate:i,effect:(f,m)=>{m.unsubscribe(),c([f,m.getState(),m.getOriginalState()])}});s=()=>{u(),d()}})];a!=null&&l.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await L0(t,Promise.race(l));return _i(t),c}finally{s()}};return(i,a)=>_0(n(i,a))},z0=e=>{let{type:t,actionCreator:n,matcher:i,predicate:a,effect:s}=e;if(t)a=rr(t).match;else if(n)t=n.type,a=n.match;else if(i)a=i;else if(!a)throw new Error(Yn(21));return Af(s),{predicate:a,type:t,effect:s}},R0=ma(e=>{const{type:t,predicate:n,effect:i}=z0(e);return{id:NT(),effect:i,type:t,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(Yn(22))}}},{withTypes:()=>R0}),Yp=(e,t)=>{const{type:n,effect:i,predicate:a}=z0(t);return Array.from(e.values()).find(s=>(typeof n=="string"?s.type===n:s.predicate===a)&&s.effect===i)},rd=e=>{e.pending.forEach(t=>{Di(t,nd)})},WT=(e,t)=>()=>{for(const n of t.keys())rd(n);e.clear()},Kp=(e,t,n)=>{try{e(t,n)}catch(i){setTimeout(()=>{throw i},0)}},B0=ma(rr(`${Vl}/add`),{withTypes:()=>B0}),FT=rr(`${Vl}/removeAll`),W0=ma(rr(`${Vl}/remove`),{withTypes:()=>W0}),qT=(...e)=>{console.error(`${Vl}/error`,...e)},As=(e={})=>{const t=new Map,n=new Map,i=p=>{const y=n.get(p)??0;n.set(p,y+1)},a=p=>{const y=n.get(p)??1;y===1?n.delete(p):n.set(p,y-1)},{extra:s,onError:o=qT}=e;Af(o);const l=p=>(p.unsubscribe=()=>t.delete(p.id),t.set(p.id,p),y=>{p.unsubscribe(),y!=null&&y.cancelActive&&rd(p)}),c=p=>{const y=Yp(t,p)??R0(p);return l(y)};ma(c,{withTypes:()=>c});const d=p=>{const y=Yp(t,p);return y&&(y.unsubscribe(),p.cancelActive&&rd(y)),!!y};ma(d,{withTypes:()=>d});const u=async(p,y,v,g)=>{const b=new AbortController,x=BT(c,b.signal),N=[];try{p.pending.add(b),i(p),await Promise.resolve(p.effect(y,ma({},v,{getOriginalState:g,condition:(A,C)=>x(A,C).then(Boolean),take:x,delay:$0(b.signal),pause:Yo(b.signal),extra:s,signal:b.signal,fork:RT(b.signal,N),unsubscribe:p.unsubscribe,subscribe:()=>{t.set(p.id,p)},cancelActiveListeners:()=>{p.pending.forEach((A,C,w)=>{A!==b&&(Di(A,nd),w.delete(A))})},cancel:()=>{Di(b,nd),p.pending.delete(b)},throwIfCancelled:()=>{_i(b.signal)}})))}catch(A){A instanceof Kl||Kp(o,A,{raisedBy:"effect"})}finally{await Promise.all(N),Di(b,$T),a(p),p.pending.delete(b)}},f=WT(t,n);return{middleware:p=>y=>v=>{if(!x0(v))return y(v);if(B0.match(v))return c(v.payload);if(FT.match(v)){f();return}if(W0.match(v))return d(v.payload);let g=p.getState();const b=()=>{if(g===Hp)throw new Error(Yn(23));return g};let x;try{if(x=y(v),t.size>0){const N=p.getState(),A=Array.from(t.values());for(const C of A){let w=!1;try{w=C.predicate(v,N,g)}catch(O){w=!1,Kp(o,O,{raisedBy:"predicate"})}w&&u(C,v,p,b)}}}finally{g=Hp}return x},startListening:c,stopListening:d,clearListeners:f}};function Yn(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var UT={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},F0=$n({name:"chartLayout",initialState:UT,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var n,i,a,s;e.margin.top=(n=t.payload.top)!==null&&n!==void 0?n:0,e.margin.right=(i=t.payload.right)!==null&&i!==void 0?i:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(s=t.payload.left)!==null&&s!==void 0?s:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:HT,setLayout:YT,setChartSize:KT,setScale:VT}=F0.actions,XT=F0.reducer;function q0(e,t,n){return Array.isArray(e)&&e&&t+n!==0?e.slice(t,n+1):e}function Vp(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function ua(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Vp(Object(n),!0).forEach(function(i){GT(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vp(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function GT(e,t,n){return(t=QT(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QT(e){var t=JT(e,"string");return typeof t=="symbol"?t:t+""}function JT(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function kt(e,t,n){return Mt(e)||Mt(t)?n:Cr(t)?Bi(e,t,n):typeof t=="function"?t(e):n}var ZT=(e,t,n)=>{if(t&&n){var{width:i,height:a}=n,{align:s,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&Be(e[s]))return ua(ua({},e),{},{[s]:e[s]+(i||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&Be(e[o]))return ua(ua({},e),{},{[o]:e[o]+(a||0)})}return e},gi=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",U0=(e,t,n,i)=>{if(i)return e.map(l=>l.coordinate);var a,s,o=e.map(l=>(l.coordinate===t&&(a=!0),l.coordinate===n&&(s=!0),l.coordinate));return a||o.push(t),s||o.push(n),o},H0=(e,t,n)=>{if(!e)return null;var{duplicateDomain:i,type:a,range:s,scale:o,realScaleType:l,isCategorical:c,categoricalDomain:d,tickCount:u,ticks:f,niceTicks:m,axisType:p}=e;if(!o)return null;var y=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,v=a==="category"&&o.bandwidth?o.bandwidth()/y:0;if(v=p==="angleAxis"&&s&&s.length>=2?hn(s[0]-s[1])*2*v:v,f||m){var g=(f||m||[]).map((b,x)=>{var N=i?i.indexOf(b):b;return{coordinate:o(N)+v,value:b,offset:v,index:x}});return g.filter(b=>!hr(b.coordinate))}return c&&d?d.map((b,x)=>({coordinate:o(b)+v,value:b,index:x,offset:v})):o.ticks&&u!=null?o.ticks(u).map((b,x)=>({coordinate:o(b)+v,value:b,offset:v,index:x})):o.domain().map((b,x)=>({coordinate:o(b)+v,value:i?i[b]:b,index:x,offset:v}))},Xp=1e-4,eO=e=>{var t=e.domain();if(!(!t||t.length<=2)){var n=t.length,i=e.range(),a=Math.min(i[0],i[1])-Xp,s=Math.max(i[0],i[1])+Xp,o=e(t[0]),l=e(t[n-1]);(o<a||o>s||l<a||l>s)&&e.domain([t[0],t[n-1]])}},tO=(e,t)=>{if(!t||t.length!==2||!Be(t[0])||!Be(t[1]))return e;var n=Math.min(t[0],t[1]),i=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!Be(e[0])||e[0]<n)&&(a[0]=n),(!Be(e[1])||e[1]>i)&&(a[1]=i),a[0]>i&&(a[0]=i),a[1]<n&&(a[1]=n),a},nO=e=>{var t=e.length;if(!(t<=0))for(var n=0,i=e[0].length;n<i;++n)for(var a=0,s=0,o=0;o<t;++o){var l=hr(e[o][n][1])?e[o][n][0]:e[o][n][1];l>=0?(e[o][n][0]=a,e[o][n][1]=a+l,a=e[o][n][1]):(e[o][n][0]=s,e[o][n][1]=s+l,s=e[o][n][1])}},rO=e=>{var t=e.length;if(!(t<=0))for(var n=0,i=e[0].length;n<i;++n)for(var a=0,s=0;s<t;++s){var o=hr(e[s][n][1])?e[s][n][0]:e[s][n][1];o>=0?(e[s][n][0]=a,e[s][n][1]=a+o,a=e[s][n][1]):(e[s][n][0]=0,e[s][n][1]=0)}},iO={sign:nO,expand:XI,none:ga,silhouette:GI,wiggle:QI,positive:rO},aO=(e,t,n)=>{var i=iO[n],a=VI().keys(t).value((s,o)=>Number(kt(s,o,0))).order(Ku).offset(i);return a(e)};function sO(e){return e==null?void 0:String(e)}function Gp(e){var{axis:t,ticks:n,bandSize:i,entry:a,index:s,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!Mt(a[t.dataKey])){var l=Rx(n,"value",a[t.dataKey]);if(l)return l.coordinate+i/2}return n[s]?n[s].coordinate+i/2:null}var c=kt(a,Mt(o)?t.dataKey:o);return Mt(c)?null:t.scale(c)}var Qp=e=>{var{axis:t,ticks:n,offset:i,bandSize:a,entry:s,index:o}=e;if(t.type==="category")return n[o]?n[o].coordinate+i:null;var l=kt(s,t.dataKey,t.scale.domain()[o]);return Mt(l)?null:t.scale(l)-a/2+i},oO=e=>{var{numericAxis:t}=e,n=t.scale.domain();if(t.type==="number"){var i=Math.min(n[0],n[1]),a=Math.max(n[0],n[1]);return i<=0&&a>=0?0:a<0?a:i}return n[0]},lO=e=>{var t=e.flat(2).filter(Be);return[Math.min(...t),Math.max(...t)]},cO=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],uO=(e,t,n)=>{if(e!=null)return cO(Object.keys(e).reduce((i,a)=>{var s=e[a],{stackedData:o}=s,l=o.reduce((c,d)=>{var u=q0(d,t,n),f=lO(u);return[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],i[0]),Math.max(l[1],i[1])]},[1/0,-1/0]))},Jp=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Zp=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,va=(e,t,n)=>{if(e&&e.scale&&e.scale.bandwidth){var i=e.scale.bandwidth();if(!n||i>0)return i}if(e&&t&&t.length>=2){for(var a=ql(t,u=>u.coordinate),s=1/0,o=1,l=a.length;o<l;o++){var c=a[o],d=a[o-1];s=Math.min((c.coordinate||0)-(d.coordinate||0),s)}return s===1/0?0:s}return n?void 0:0};function eg(e){var{tooltipEntrySettings:t,dataKey:n,payload:i,value:a,name:s}=e;return ua(ua({},t),{},{dataKey:n,payload:i,value:a,name:s})}function ka(e,t){if(e)return String(e);if(typeof t=="string")return t}var dO=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},fO=(e,t)=>t==="centric"?e.angle:e.radius,Gr=e=>e.layout.width,Qr=e=>e.layout.height,hO=e=>e.layout.scale,Y0=e=>e.layout.margin,Xl=pe(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Gl=pe(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),K0="data-recharts-item-index",V0="data-recharts-item-data-key",Cs=60;function tg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function yo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tg(Object(n),!0).forEach(function(i){mO(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tg(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function mO(e,t,n){return(t=pO(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pO(e){var t=gO(e,"string");return typeof t=="symbol"?t:t+""}function gO(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var yO=e=>e.brush.height;function vO(e){var t=Gl(e);return t.reduce((n,i)=>{if(i.orientation==="left"&&!i.mirror&&!i.hide){var a=typeof i.width=="number"?i.width:Cs;return n+a}return n},0)}function xO(e){var t=Gl(e);return t.reduce((n,i)=>{if(i.orientation==="right"&&!i.mirror&&!i.hide){var a=typeof i.width=="number"?i.width:Cs;return n+a}return n},0)}function bO(e){var t=Xl(e);return t.reduce((n,i)=>i.orientation==="top"&&!i.mirror&&!i.hide?n+i.height:n,0)}function jO(e){var t=Xl(e);return t.reduce((n,i)=>i.orientation==="bottom"&&!i.mirror&&!i.hide?n+i.height:n,0)}var on=pe([Gr,Qr,Y0,yO,vO,xO,bO,jO,g0,QP],(e,t,n,i,a,s,o,l,c,d)=>{var u={left:(n.left||0)+a,right:(n.right||0)+s},f={top:(n.top||0)+o,bottom:(n.bottom||0)+l},m=yo(yo({},f),u),p=m.bottom;m.bottom+=i,m=ZT(m,c,d);var y=e-m.left-m.right,v=t-m.top-m.bottom;return yo(yo({brushBottom:p},m),{},{width:Math.max(y,0),height:Math.max(v,0)})}),wO=pe(on,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Cf=pe(Gr,Qr,(e,t)=>({x:0,y:0,width:e,height:t})),SO=h.createContext(null),kn=()=>h.useContext(SO)!=null,Ql=e=>e.brush,Jl=pe([Ql,on,Y0],(e,t,n)=>({height:e.height,x:Be(e.x)?e.x:t.left,y:Be(e.y)?e.y:t.top+t.height+t.brushBottom-((n==null?void 0:n.bottom)||0),width:Be(e.width)?e.width:t.width})),X0={},G0={},Q0={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n,i,{signal:a,edges:s}={}){let o,l=null;const c=s!=null&&s.includes("leading"),d=s==null||s.includes("trailing"),u=()=>{l!==null&&(n.apply(o,l),o=void 0,l=null)},f=()=>{d&&u(),v()};let m=null;const p=()=>{m!=null&&clearTimeout(m),m=setTimeout(()=>{m=null,f()},i)},y=()=>{m!==null&&(clearTimeout(m),m=null)},v=()=>{y(),o=void 0,l=null},g=()=>{u()},b=function(...x){if(a!=null&&a.aborted)return;o=this,l=x;const N=m==null;p(),c&&N&&u()};return b.schedule=p,b.cancel=v,b.flush=g,a==null||a.addEventListener("abort",v,{once:!0}),b}e.debounce=t})(Q0);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Q0;function n(i,a=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:c}=s,d=Array(2);o&&(d[0]="leading"),l&&(d[1]="trailing");let u,f=null;const m=t.debounce(function(...v){u=i.apply(this,v),f=null},a,{edges:d}),p=function(...v){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(u=i.apply(this,v),f=Date.now(),m.cancel(),m.schedule(),u):(m.apply(this,v),u)},y=()=>(m.flush(),u);return p.cancel=m.cancel,p.flush=y,p}e.debounce=n})(G0);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=G0;function n(i,a=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return t.debounce(i,a,{leading:o,maxWait:a,trailing:l})}e.throttle=n})(X0);var NO=X0.throttle;const kO=Pr(NO);var Ko=function(t,n){for(var i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s]},J0=(e,t,n)=>{var{width:i="100%",height:a="100%",aspect:s,maxHeight:o}=n,l=qr(i)?e:Number(i),c=qr(a)?t:Number(a);return s&&s>0&&(l?c=l/s:c&&(l=c*s),o&&c!=null&&c>o&&(c=o)),{calculatedWidth:l,calculatedHeight:c}},AO={width:0,height:0,overflow:"visible"},CO={width:0,overflowX:"visible"},EO={height:0,overflowY:"visible"},IO={},PO=e=>{var{width:t,height:n}=e,i=qr(t),a=qr(n);return i&&a?AO:i?CO:a?EO:IO};function TO(e){var{width:t,height:n,aspect:i}=e,a=t,s=n;return a===void 0&&s===void 0?(a="100%",s="100%"):a===void 0?a=i&&i>0?void 0:"100%":s===void 0&&(s=i&&i>0?void 0:"100%"),{width:a,height:s}}function Xt(e){return Number.isFinite(e)}function Er(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function id(){return id=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},id.apply(null,arguments)}function ng(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function rg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ng(Object(n),!0).forEach(function(i){OO(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ng(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function OO(e,t,n){return(t=DO(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function DO(e){var t=_O(e,"string");return typeof t=="symbol"?t:t+""}function _O(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Z0=h.createContext({width:-1,height:-1});function MO(e){return Er(e.width)&&Er(e.height)}function eb(e){var{children:t,width:n,height:i}=e,a=h.useMemo(()=>({width:n,height:i}),[n,i]);return MO(a)?h.createElement(Z0.Provider,{value:a},t):null}var Ef=()=>h.useContext(Z0),LO=h.forwardRef((e,t)=>{var{aspect:n,initialDimension:i={width:-1,height:-1},width:a,height:s,minWidth:o=0,minHeight:l,maxHeight:c,children:d,debounce:u=0,id:f,className:m,onResize:p,style:y={}}=e,v=h.useRef(null),g=h.useRef();g.current=p,h.useImperativeHandle(t,()=>v.current);var[b,x]=h.useState({containerWidth:i.width,containerHeight:i.height}),N=h.useCallback((M,B)=>{x(z=>{var j=Math.round(M),k=Math.round(B);return z.containerWidth===j&&z.containerHeight===k?z:{containerWidth:j,containerHeight:k}})},[]);h.useEffect(()=>{if(v.current==null||typeof ResizeObserver>"u")return Vi;var M=k=>{var L,{width:T,height:$}=k[0].contentRect;N(T,$),(L=g.current)===null||L===void 0||L.call(g,T,$)};u>0&&(M=kO(M,u,{trailing:!0,leading:!1}));var B=new ResizeObserver(M),{width:z,height:j}=v.current.getBoundingClientRect();return N(z,j),B.observe(v.current),()=>{B.disconnect()}},[N,u]);var{containerWidth:A,containerHeight:C}=b;Ko(!n||n>0,"The aspect(%s) must be greater than zero.",n);var{calculatedWidth:w,calculatedHeight:O}=J0(A,C,{width:a,height:s,aspect:n,maxHeight:c});return Ko(w!=null&&w>0||O!=null&&O>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,w,O,a,s,o,l,n),h.createElement("div",{id:f?"".concat(f):void 0,className:ut("recharts-responsive-container",m),style:rg(rg({},y),{},{width:a,height:s,minWidth:o,minHeight:l,maxHeight:c}),ref:v},h.createElement("div",{style:PO({width:a,height:s})},h.createElement(eb,{width:w,height:O},d)))}),Vo=h.forwardRef((e,t)=>{var n=Ef();if(Er(n.width)&&Er(n.height))return e.children;var{width:i,height:a}=TO({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:s,calculatedHeight:o}=J0(void 0,void 0,{width:i,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return Be(s)&&Be(o)?h.createElement(eb,{width:s,height:o},e.children):h.createElement(LO,id({},e,{width:i,height:a,ref:t}))});function tb(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var Zl=()=>{var e,t=kn(),n=We(wO),i=We(Jl),a=(e=We(Ql))===null||e===void 0?void 0:e.padding;return!t||!i||!a?n:{width:i.width-a.left-a.right,height:i.height-a.top-a.bottom,x:a.left,y:a.top}},$O={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},nb=()=>{var e;return(e=We(on))!==null&&e!==void 0?e:$O},rb=()=>We(Gr),ib=()=>We(Qr),ot=e=>e.layout.layoutType,Es=()=>We(ot),zO=()=>{var e=Es();return e!==void 0},ec=e=>{var t=Lt(),n=kn(),{width:i,height:a}=e,s=Ef(),o=i,l=a;return s&&(o=s.width>0?s.width:i,l=s.height>0?s.height:a),h.useEffect(()=>{!n&&Er(o)&&Er(l)&&t(KT({width:o,height:l}))},[t,n,o,l]),null},RO={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},ab=$n({name:"legend",initialState:RO,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:sn()},removeLegendPayload:{reducer(e,t){var n=Wr(e).payload.indexOf(t.payload);n>-1&&e.payload.splice(n,1)},prepare:sn()}}}),{setLegendSize:g5,setLegendSettings:y5,addLegendPayload:sb,removeLegendPayload:ob}=ab.actions,BO=ab.reducer;function ad(){return ad=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ad.apply(null,arguments)}function ig(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function fu(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ig(Object(n),!0).forEach(function(i){WO(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ig(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function WO(e,t,n){return(t=FO(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function FO(e){var t=qO(e,"string");return typeof t=="symbol"?t:t+""}function qO(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UO(e){return Array.isArray(e)&&Cr(e[0])&&Cr(e[1])?e.join(" ~ "):e}var HO=e=>{var{separator:t=" : ",contentStyle:n={},itemStyle:i={},labelStyle:a={},payload:s,formatter:o,itemSorter:l,wrapperClassName:c,labelClassName:d,label:u,labelFormatter:f,accessibilityLayer:m=!1}=e,p=()=>{if(s&&s.length){var C={padding:0,margin:0},w=(l?ql(s,l):s).map((O,M)=>{if(O.type==="none")return null;var B=O.formatter||o||UO,{value:z,name:j}=O,k=z,L=j;if(B){var T=B(z,j,O,M,s);if(Array.isArray(T))[k,L]=T;else if(T!=null)k=T;else return null}var $=fu({display:"block",paddingTop:4,paddingBottom:4,color:O.color||"#000"},i);return h.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(M),style:$},Cr(L)?h.createElement("span",{className:"recharts-tooltip-item-name"},L):null,Cr(L)?h.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,h.createElement("span",{className:"recharts-tooltip-item-value"},k),h.createElement("span",{className:"recharts-tooltip-item-unit"},O.unit||""))});return h.createElement("ul",{className:"recharts-tooltip-item-list",style:C},w)}return null},y=fu({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),v=fu({margin:0},a),g=!Mt(u),b=g?u:"",x=ut("recharts-default-tooltip",c),N=ut("recharts-tooltip-label",d);g&&f&&s!==void 0&&s!==null&&(b=f(u,s));var A=m?{role:"status","aria-live":"assertive"}:{};return h.createElement("div",ad({className:x,style:y},A),h.createElement("p",{className:N,style:v},h.isValidElement(b)?b:"".concat(b)),p())},Ha="recharts-tooltip-wrapper",YO={visibility:"hidden"};function KO(e){var{coordinate:t,translateX:n,translateY:i}=e;return ut(Ha,{["".concat(Ha,"-right")]:Be(n)&&t&&Be(t.x)&&n>=t.x,["".concat(Ha,"-left")]:Be(n)&&t&&Be(t.x)&&n<t.x,["".concat(Ha,"-bottom")]:Be(i)&&t&&Be(t.y)&&i>=t.y,["".concat(Ha,"-top")]:Be(i)&&t&&Be(t.y)&&i<t.y})}function ag(e){var{allowEscapeViewBox:t,coordinate:n,key:i,offsetTopLeft:a,position:s,reverseDirection:o,tooltipDimension:l,viewBox:c,viewBoxDimension:d}=e;if(s&&Be(s[i]))return s[i];var u=n[i]-l-(a>0?a:0),f=n[i]+a;if(t[i])return o[i]?u:f;var m=c[i];if(m==null)return 0;if(o[i]){var p=u,y=m;return p<y?Math.max(f,m):Math.max(u,m)}if(d==null)return 0;var v=f+l,g=m+d;return v>g?Math.max(u,m):Math.max(f,m)}function VO(e){var{translateX:t,translateY:n,useTranslate3d:i}=e;return{transform:i?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function XO(e){var{allowEscapeViewBox:t,coordinate:n,offsetTopLeft:i,position:a,reverseDirection:s,tooltipBox:o,useTranslate3d:l,viewBox:c}=e,d,u,f;return o.height>0&&o.width>0&&n?(u=ag({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:i,position:a,reverseDirection:s,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),f=ag({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:i,position:a,reverseDirection:s,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),d=VO({translateX:u,translateY:f,useTranslate3d:l})):d=YO,{cssProperties:d,cssClasses:KO({translateX:u,translateY:f,coordinate:n})}}function sg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function vo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sg(Object(n),!0).forEach(function(i){sd(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sg(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function sd(e,t,n){return(t=GO(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function GO(e){var t=QO(e,"string");return typeof t=="symbol"?t:t+""}function QO(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class JO extends h.PureComponent{constructor(){super(...arguments),sd(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),sd(this,"handleKeyDown",t=>{if(t.key==="Escape"){var n,i,a,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(i=this.props.coordinate)===null||i===void 0?void 0:i.x)!==null&&n!==void 0?n:0,y:(a=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,n;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:n,animationDuration:i,animationEasing:a,children:s,coordinate:o,hasPayload:l,isAnimationActive:c,offset:d,position:u,reverseDirection:f,useTranslate3d:m,viewBox:p,wrapperStyle:y,lastBoundingBox:v,innerRef:g,hasPortalFromProps:b}=this.props,{cssClasses:x,cssProperties:N}=XO({allowEscapeViewBox:n,coordinate:o,offsetTopLeft:d,position:u,reverseDirection:f,tooltipBox:{height:v.height,width:v.width},useTranslate3d:m,viewBox:p}),A=b?{}:vo(vo({transition:c&&t?"transform ".concat(i,"ms ").concat(a):void 0},N),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),C=vo(vo({},A),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},y);return h.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:x,style:C,ref:g},s)}}var ZO=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),yi={devToolsEnabled:!1,isSsr:ZO()},lb=()=>{var e;return(e=We(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function od(){return od=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},od.apply(null,arguments)}function og(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function lg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?og(Object(n),!0).forEach(function(i){eD(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):og(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function eD(e,t,n){return(t=tD(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tD(e){var t=nD(e,"string");return typeof t=="symbol"?t:t+""}function nD(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cg={curveBasisClosed:$I,curveBasisOpen:zI,curveBasis:LI,curveBumpX:wI,curveBumpY:SI,curveLinearClosed:RI,curveLinear:Ml,curveMonotoneX:BI,curveMonotoneY:WI,curveNatural:FI,curveStep:qI,curveStepAfter:HI,curveStepBefore:UI},Xo=e=>Xt(e.x)&&Xt(e.y),ug=e=>e.base!=null&&Xo(e.base)&&Xo(e),Ya=e=>e.x,Ka=e=>e.y,rD=(e,t)=>{if(typeof e=="function")return e;var n="curve".concat(Ns(e));return(n==="curveMonotone"||n==="curveBump")&&t?cg["".concat(n).concat(t==="vertical"?"Y":"X")]:cg[n]||Ml},iD=e=>{var{type:t="linear",points:n=[],baseLine:i,layout:a,connectNulls:s=!1}=e,o=rD(t,a),l=s?n.filter(Xo):n,c;if(Array.isArray(i)){var d=n.map((p,y)=>lg(lg({},p),{},{base:i[y]}));a==="vertical"?c=uo().y(Ka).x1(Ya).x0(p=>p.base.x):c=uo().x(Ya).y1(Ka).y0(p=>p.base.y);var u=c.defined(ug).curve(o),f=s?d.filter(ug):d;return u(f)}a==="vertical"&&Be(i)?c=uo().y(Ka).x1(Ya).x0(i):Be(i)?c=uo().x(Ya).y1(Ka).y0(i):c=kx().x(Ya).y(Ka);var m=c.defined(Xo).curve(o);return m(l)},If=e=>{var{className:t,points:n,path:i,pathRef:a}=e;if((!n||!n.length)&&!i)return null;var s=n&&n.length?iD(e):i;return h.createElement("path",od({},Kn(e),cf(e),{className:ut("recharts-curve",t),d:s===null?void 0:s,ref:a}))},aD=["x","y","top","left","width","height","className"];function ld(){return ld=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ld.apply(null,arguments)}function dg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function sD(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dg(Object(n),!0).forEach(function(i){oD(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dg(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function oD(e,t,n){return(t=lD(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lD(e){var t=cD(e,"string");return typeof t=="symbol"?t:t+""}function cD(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function uD(e,t){if(e==null)return{};var n,i,a=dD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function dD(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}var fD=(e,t,n,i,a,s)=>"M".concat(e,",").concat(a,"v").concat(i,"M").concat(s,",").concat(t,"h").concat(n),hD=e=>{var{x:t=0,y:n=0,top:i=0,left:a=0,width:s=0,height:o=0,className:l}=e,c=uD(e,aD),d=sD({x:t,y:n,top:i,left:a,width:s,height:o},c);return!Be(t)||!Be(n)||!Be(s)||!Be(o)||!Be(i)||!Be(a)?null:h.createElement("path",ld({},In(d),{className:ut("recharts-cross",l),d:fD(t,n,s,o,i,a)}))};function mD(e,t,n,i){var a=i/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-a,width:e==="horizontal"?i:n.width-1,height:e==="horizontal"?n.height-1:i}}function fg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function hg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fg(Object(n),!0).forEach(function(i){pD(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fg(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function pD(e,t,n){return(t=gD(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gD(e){var t=yD(e,"string");return typeof t=="symbol"?t:t+""}function yD(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vD=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),cb=(e,t,n)=>e.map(i=>"".concat(vD(i)," ").concat(t,"ms ").concat(n)).join(","),xD=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((n,i)=>n.filter(a=>i.includes(a))),ms=(e,t)=>Object.keys(t).reduce((n,i)=>hg(hg({},n),{},{[i]:e(i,t[i])}),{});function mg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function an(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?mg(Object(n),!0).forEach(function(i){bD(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mg(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function bD(e,t,n){return(t=jD(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jD(e){var t=wD(e,"string");return typeof t=="symbol"?t:t+""}function wD(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Go=(e,t,n)=>e+(t-e)*n,cd=e=>{var{from:t,to:n}=e;return t!==n},ub=(e,t,n)=>{var i=ms((a,s)=>{if(cd(s)){var[o,l]=e(s.from,s.to,s.velocity);return an(an({},s),{},{from:o,velocity:l})}return s},t);return n<1?ms((a,s)=>cd(s)?an(an({},s),{},{velocity:Go(s.velocity,i[a].velocity,n),from:Go(s.from,i[a].from,n)}):s,t):ub(e,i,n-1)};function SD(e,t,n,i,a,s){var o,l=i.reduce((m,p)=>an(an({},m),{},{[p]:{from:e[p],velocity:0,to:t[p]}}),{}),c=()=>ms((m,p)=>p.from,l),d=()=>!Object.values(l).filter(cd).length,u=null,f=m=>{o||(o=m);var p=m-o,y=p/n.dt;l=ub(n,l,y),a(an(an(an({},e),t),c())),o=m,d()||(u=s.setTimeout(f))};return()=>(u=s.setTimeout(f),()=>{var m;(m=u)===null||m===void 0||m()})}function ND(e,t,n,i,a,s,o){var l=null,c=a.reduce((f,m)=>an(an({},f),{},{[m]:[e[m],t[m]]}),{}),d,u=f=>{d||(d=f);var m=(f-d)/i,p=ms((v,g)=>Go(...g,n(m)),c);if(s(an(an(an({},e),t),p)),m<1)l=o.setTimeout(u);else{var y=ms((v,g)=>Go(...g,n(1)),c);s(an(an(an({},e),t),y))}};return()=>(l=o.setTimeout(u),()=>{var f;(f=l)===null||f===void 0||f()})}const kD=(e,t,n,i,a,s)=>{var o=xD(e,t);return n==null?()=>(a(an(an({},e),t)),()=>{}):n.isStepper===!0?SD(e,t,n,o,a,s):ND(e,t,n,i,o,a,s)};var Qo=1e-4,db=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],fb=(e,t)=>e.map((n,i)=>n*t**i).reduce((n,i)=>n+i),pg=(e,t)=>n=>{var i=db(e,t);return fb(i,n)},AD=(e,t)=>n=>{var i=db(e,t),a=[...i.map((s,o)=>s*o).slice(1),0];return fb(a,n)},CD=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(n.length===1)switch(n[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a,s=n[0].split("(");if(s[0]==="cubic-bezier"&&((a=s[1])===null||a===void 0?void 0:a.split(")")[0].split(",").length)===4){var o=s[1].split(")")[0].split(",").map(l=>parseFloat(l));return[o[0],o[1],o[2],o[3]]}}}return n.length===4?n:[0,0,1,1]},ED=(e,t,n,i)=>{var a=pg(e,n),s=pg(t,i),o=AD(e,n),l=d=>d>1?1:d<0?0:d,c=d=>{for(var u=d>1?1:d,f=u,m=0;m<8;++m){var p=a(f)-u,y=o(f);if(Math.abs(p-u)<Qo||y<Qo)return s(f);f=l(f-p/y)}return s(f)};return c.isStepper=!1,c},gg=function(){return ED(...CD(...arguments))},ID=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:i=8,dt:a=17}=t,s=(o,l,c)=>{var d=-(o-l)*n,u=c*i,f=c+(d-u)*a/1e3,m=c*a/1e3+o;return Math.abs(m-l)<Qo&&Math.abs(f)<Qo?[l,0]:[m,f]};return s.isStepper=!0,s.dt=a,s},PD=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return gg(e);case"spring":return ID();default:if(e.split("(")[0]==="cubic-bezier")return gg(e)}return typeof e=="function"?e:null};function TD(e){var t,n=()=>null,i=!1,a=null,s=o=>{if(!i){if(Array.isArray(o)){if(!o.length)return;var l=o,[c,...d]=l;if(typeof c=="number"){a=e.setTimeout(s.bind(null,d),c);return}s(c),a=e.setTimeout(s.bind(null,d));return}typeof o=="string"&&(t=o,n(t)),typeof o=="object"&&(t=o,n(t)),typeof o=="function"&&o()}};return{stop:()=>{i=!0},start:o=>{i=!1,a&&(a(),a=null),s(o)},subscribe:o=>(n=o,()=>{n=()=>null}),getTimeoutController:()=>e}}class OD{setTimeout(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=performance.now(),a=null,s=o=>{o-i>=n?t(o):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(s))};return a=requestAnimationFrame(s),()=>{a!=null&&cancelAnimationFrame(a)}}}function DD(){return TD(new OD)}var _D=h.createContext(DD);function MD(e,t){var n=h.useContext(_D);return h.useMemo(()=>t??n(e),[e,t,n])}var LD={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},yg={t:0},hu={t:1};function Is(e){var t=pn(e,LD),{isActive:n,canBegin:i,duration:a,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:c,children:d}=t,u=MD(t.animationId,t.animationManager),[f,m]=h.useState(n?yg:hu),p=h.useRef(null);return h.useEffect(()=>{n||m(hu)},[n]),h.useEffect(()=>{if(!n||!i)return Vi;var y=kD(yg,hu,PD(s),a,m,u.getTimeoutController()),v=()=>{p.current=y()};return u.start([c,o,v,a,l]),()=>{u.stop(),p.current&&p.current(),l()}},[n,i,a,s,o,c,l,u]),d(f.t)}function Ps(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=h.useRef(us(t)),i=h.useRef(e);return i.current!==e&&(n.current=us(t),i.current=e),n.current}var $D=["radius"],zD=["radius"];function vg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function xg(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?vg(Object(n),!0).forEach(function(i){RD(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vg(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function RD(e,t,n){return(t=BD(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BD(e){var t=WD(e,"string");return typeof t=="symbol"?t:t+""}function WD(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Jo(){return Jo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Jo.apply(null,arguments)}function bg(e,t){if(e==null)return{};var n,i,a=FD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function FD(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}var jg=(e,t,n,i,a)=>{var s=Math.min(Math.abs(n)/2,Math.abs(i)/2),o=i>=0?1:-1,l=n>=0?1:-1,c=i>=0&&n>=0||i<0&&n<0?1:0,d;if(s>0&&a instanceof Array){for(var u=[0,0,0,0],f=0,m=4;f<m;f++)u[f]=a[f]>s?s:a[f];d="M".concat(e,",").concat(t+o*u[0]),u[0]>0&&(d+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(c,",").concat(e+l*u[0],",").concat(t)),d+="L ".concat(e+n-l*u[1],",").concat(t),u[1]>0&&(d+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(c,`,
        `).concat(e+n,",").concat(t+o*u[1])),d+="L ".concat(e+n,",").concat(t+i-o*u[2]),u[2]>0&&(d+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(c,`,
        `).concat(e+n-l*u[2],",").concat(t+i)),d+="L ".concat(e+l*u[3],",").concat(t+i),u[3]>0&&(d+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+i-o*u[3])),d+="Z"}else if(s>0&&a===+a&&a>0){var p=Math.min(s,a);d="M ".concat(e,",").concat(t+o*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+l*p,",").concat(t,`
            L `).concat(e+n-l*p,",").concat(t,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+n,",").concat(t+o*p,`
            L `).concat(e+n,",").concat(t+i-o*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e+n-l*p,",").concat(t+i,`
            L `).concat(e+l*p,",").concat(t+i,`
            A `).concat(p,",").concat(p,",0,0,").concat(c,",").concat(e,",").concat(t+i-o*p," Z")}else d="M ".concat(e,",").concat(t," h ").concat(n," v ").concat(i," h ").concat(-n," Z");return d},wg={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},hb=e=>{var t=pn(e,wg),n=h.useRef(null),[i,a]=h.useState(-1);h.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var G=n.current.getTotalLength();G&&a(G)}catch{}},[]);var{x:s,y:o,width:l,height:c,radius:d,className:u}=t,{animationEasing:f,animationDuration:m,animationBegin:p,isAnimationActive:y,isUpdateAnimationActive:v}=t,g=h.useRef(l),b=h.useRef(c),x=h.useRef(s),N=h.useRef(o),A=h.useMemo(()=>({x:s,y:o,width:l,height:c,radius:d}),[s,o,l,c,d]),C=Ps(A,"rectangle-");if(s!==+s||o!==+o||l!==+l||c!==+c||l===0||c===0)return null;var w=ut("recharts-rectangle",u);if(!v){var O=In(t),{radius:M}=O,B=bg(O,$D);return h.createElement("path",Jo({},B,{radius:typeof d=="number"?d:void 0,className:w,d:jg(s,o,l,c,d)}))}var z=g.current,j=b.current,k=x.current,L=N.current,T="0px ".concat(i===-1?1:i,"px"),$="".concat(i,"px 0px"),V=cb(["strokeDasharray"],m,typeof f=="string"?f:wg.animationEasing);return h.createElement(Is,{animationId:C,key:C,canBegin:i>0,duration:m,easing:f,isActive:v,begin:p},G=>{var ne=Ot(z,l,G),U=Ot(j,c,G),I=Ot(k,s,G),P=Ot(L,o,G);n.current&&(g.current=ne,b.current=U,x.current=I,N.current=P);var D;y?G>0?D={transition:V,strokeDasharray:$}:D={strokeDasharray:T}:D={strokeDasharray:$};var S=In(t),{radius:_}=S,H=bg(S,zD);return h.createElement("path",Jo({},H,{radius:typeof d=="number"?d:void 0,className:w,d:jg(I,P,ne,U,d),ref:n,style:xg(xg({},D),t.style)}))})};function Sg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Ng(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Sg(Object(n),!0).forEach(function(i){qD(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Sg(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function qD(e,t,n){return(t=UD(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function UD(e){var t=HD(e,"string");return typeof t=="symbol"?t:t+""}function HD(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Zo=Math.PI/180,YD=e=>e*180/Math.PI,Zt=(e,t,n,i)=>({x:e+Math.cos(-Zo*i)*n,y:t+Math.sin(-Zo*i)*n}),mb=function(t,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(i.left||0)-(i.right||0)),Math.abs(n-(i.top||0)-(i.bottom||0)))/2},KD=(e,t)=>{var{x:n,y:i}=e,{x:a,y:s}=t;return Math.sqrt((n-a)**2+(i-s)**2)},VD=(e,t)=>{var{x:n,y:i}=e,{cx:a,cy:s}=t,o=KD({x:n,y:i},{x:a,y:s});if(o<=0)return{radius:o,angle:0};var l=(n-a)/o,c=Math.acos(l);return i>s&&(c=2*Math.PI-c),{radius:o,angle:YD(c),angleInRadian:c}},XD=e=>{var{startAngle:t,endAngle:n}=e,i=Math.floor(t/360),a=Math.floor(n/360),s=Math.min(i,a);return{startAngle:t-s*360,endAngle:n-s*360}},GD=(e,t)=>{var{startAngle:n,endAngle:i}=t,a=Math.floor(n/360),s=Math.floor(i/360),o=Math.min(a,s);return e+o*360},QD=(e,t)=>{var{chartX:n,chartY:i}=e,{radius:a,angle:s}=VD({x:n,y:i},t),{innerRadius:o,outerRadius:l}=t;if(a<o||a>l||a===0)return null;var{startAngle:c,endAngle:d}=XD(t),u=s,f;if(c<=d){for(;u>d;)u-=360;for(;u<c;)u+=360;f=u>=c&&u<=d}else{for(;u>c;)u-=360;for(;u<d;)u+=360;f=u>=d&&u<=c}return f?Ng(Ng({},t),{},{radius:a,angle:GD(u,t)}):null};function pb(e){var{cx:t,cy:n,radius:i,startAngle:a,endAngle:s}=e,o=Zt(t,n,i,a),l=Zt(t,n,i,s);return{points:[o,l],cx:t,cy:n,radius:i,startAngle:a,endAngle:s}}function ud(){return ud=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ud.apply(null,arguments)}var JD=(e,t)=>{var n=hn(t-e),i=Math.min(Math.abs(t-e),359.999);return n*i},xo=e=>{var{cx:t,cy:n,radius:i,angle:a,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:c}=e,d=l*(o?1:-1)+i,u=Math.asin(l/d)/Zo,f=c?a:a+s*u,m=Zt(t,n,d,f),p=Zt(t,n,i,f),y=c?a-s*u:a,v=Zt(t,n,d*Math.cos(u*Zo),y);return{center:m,circleTangency:p,lineTangency:v,theta:u}},gb=e=>{var{cx:t,cy:n,innerRadius:i,outerRadius:a,startAngle:s,endAngle:o}=e,l=JD(s,o),c=s+l,d=Zt(t,n,a,s),u=Zt(t,n,a,c),f="M ".concat(d.x,",").concat(d.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(s>c),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(i>0){var m=Zt(t,n,i,s),p=Zt(t,n,i,c);f+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(i,",").concat(i,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(s<=c),`,
            `).concat(m.x,",").concat(m.y," Z")}else f+="L ".concat(t,",").concat(n," Z");return f},ZD=e=>{var{cx:t,cy:n,innerRadius:i,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:d}=e,u=hn(d-c),{circleTangency:f,lineTangency:m,theta:p}=xo({cx:t,cy:n,radius:a,angle:c,sign:u,cornerRadius:s,cornerIsExternal:l}),{circleTangency:y,lineTangency:v,theta:g}=xo({cx:t,cy:n,radius:a,angle:d,sign:-u,cornerRadius:s,cornerIsExternal:l}),b=l?Math.abs(c-d):Math.abs(c-d)-p-g;if(b<0)return o?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):gb({cx:t,cy:n,innerRadius:i,outerRadius:a,startAngle:c,endAngle:d});var x="M ".concat(m.x,",").concat(m.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(b>180),",").concat(+(u<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
  `);if(i>0){var{circleTangency:N,lineTangency:A,theta:C}=xo({cx:t,cy:n,radius:i,angle:c,sign:u,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:w,lineTangency:O,theta:M}=xo({cx:t,cy:n,radius:i,angle:d,sign:-u,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),B=l?Math.abs(c-d):Math.abs(c-d)-C-M;if(B<0&&s===0)return"".concat(x,"L").concat(t,",").concat(n,"Z");x+="L".concat(O.x,",").concat(O.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(w.x,",").concat(w.y,`
      A`).concat(i,",").concat(i,",0,").concat(+(B>180),",").concat(+(u>0),",").concat(N.x,",").concat(N.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(A.x,",").concat(A.y,"Z")}else x+="L".concat(t,",").concat(n,"Z");return x},e_={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},yb=e=>{var t=pn(e,e_),{cx:n,cy:i,innerRadius:a,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u,className:f}=t;if(s<a||d===u)return null;var m=ut("recharts-sector",f),p=s-a,y=Sn(o,p,0,!0),v;return y>0&&Math.abs(d-u)<360?v=ZD({cx:n,cy:i,innerRadius:a,outerRadius:s,cornerRadius:Math.min(y,p/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}):v=gb({cx:n,cy:i,innerRadius:a,outerRadius:s,startAngle:d,endAngle:u}),h.createElement("path",ud({},In(t),{className:m,d:v}))};function t_(e,t,n){if(e==="horizontal")return[{x:t.x,y:n.top},{x:t.x,y:n.top+n.height}];if(e==="vertical")return[{x:n.left,y:t.y},{x:n.left+n.width,y:t.y}];if(Fx(t)){if(e==="centric"){var{cx:i,cy:a,innerRadius:s,outerRadius:o,angle:l}=t,c=Zt(i,a,s,l),d=Zt(i,a,o,l);return[{x:c.x,y:c.y},{x:d.x,y:d.y}]}return pb(t)}}var vb={},xb={},bb={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bf;function n(i){return t.isSymbol(i)?NaN:Number(i)}e.toNumber=n})(bb);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=bb;function n(i){return i?(i=t.toNumber(i),i===1/0||i===-1/0?(i<0?-1:1)*Number.MAX_VALUE:i===i?i:0):i===0?i:0}e.toFinite=n})(xb);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jf,n=xb;function i(a,s,o){o&&typeof o!="number"&&t.isIterateeCall(a,s,o)&&(s=o=void 0),a=n.toFinite(a),s===void 0?(s=a,a=0):s=n.toFinite(s),o=o===void 0?a<s?1:-1:n.toFinite(o);const l=Math.max(Math.ceil((s-a)/(o||1)),0),c=new Array(l);for(let d=0;d<l;d++)c[d]=a,a+=o;return c}e.range=i})(vb);var n_=vb.range;const jb=Pr(n_);function ui(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function r_(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Pf(e){let t,n,i;e.length!==2?(t=ui,n=(l,c)=>ui(e(l),c),i=(l,c)=>e(l)-c):(t=e===ui||e===r_?e:i_,n=e,i=e);function a(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;n(l[f],c)<0?d=f+1:u=f}while(d<u)}return d}function s(l,c,d=0,u=l.length){if(d<u){if(t(c,c)!==0)return u;do{const f=d+u>>>1;n(l[f],c)<=0?d=f+1:u=f}while(d<u)}return d}function o(l,c,d=0,u=l.length){const f=a(l,c,d,u-1);return f>d&&i(l[f-1],c)>-i(l[f],c)?f-1:f}return{left:a,center:o,right:s}}function i_(){return 0}function wb(e){return e===null?NaN:+e}function*a_(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const s_=Pf(ui),Ts=s_.right;Pf(wb).center;class kg extends Map{constructor(t,n=c_){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[i,a]of t)this.set(i,a)}get(t){return super.get(Ag(this,t))}has(t){return super.has(Ag(this,t))}set(t,n){return super.set(o_(this,t),n)}delete(t){return super.delete(l_(this,t))}}function Ag({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):n}function o_({_intern:e,_key:t},n){const i=t(n);return e.has(i)?e.get(i):(e.set(i,n),n)}function l_({_intern:e,_key:t},n){const i=t(n);return e.has(i)&&(n=e.get(i),e.delete(i)),n}function c_(e){return e!==null&&typeof e=="object"?e.valueOf():e}function u_(e=ui){if(e===ui)return Sb;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const i=e(t,n);return i||i===0?i:(e(n,n)===0)-(e(t,t)===0)}}function Sb(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const d_=Math.sqrt(50),f_=Math.sqrt(10),h_=Math.sqrt(2);function el(e,t,n){const i=(t-e)/Math.max(0,n),a=Math.floor(Math.log10(i)),s=i/Math.pow(10,a),o=s>=d_?10:s>=f_?5:s>=h_?2:1;let l,c,d;return a<0?(d=Math.pow(10,-a)/o,l=Math.round(e*d),c=Math.round(t*d),l/d<e&&++l,c/d>t&&--c,d=-d):(d=Math.pow(10,a)*o,l=Math.round(e/d),c=Math.round(t/d),l*d<e&&++l,c*d>t&&--c),c<l&&.5<=n&&n<2?el(e,t,n*2):[l,c,d]}function dd(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const i=t<e,[a,s,o]=i?el(t,e,n):el(e,t,n);if(!(s>=a))return[];const l=s-a+1,c=new Array(l);if(i)if(o<0)for(let d=0;d<l;++d)c[d]=(s-d)/-o;else for(let d=0;d<l;++d)c[d]=(s-d)*o;else if(o<0)for(let d=0;d<l;++d)c[d]=(a+d)/-o;else for(let d=0;d<l;++d)c[d]=(a+d)*o;return c}function fd(e,t,n){return t=+t,e=+e,n=+n,el(e,t,n)[2]}function hd(e,t,n){t=+t,e=+e,n=+n;const i=t<e,a=i?fd(t,e,n):fd(e,t,n);return(i?-1:1)*(a<0?1/-a:a)}function Cg(e,t){let n;for(const i of e)i!=null&&(n<i||n===void 0&&i>=i)&&(n=i);return n}function Eg(e,t){let n;for(const i of e)i!=null&&(n>i||n===void 0&&i>=i)&&(n=i);return n}function Nb(e,t,n=0,i=1/0,a){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),i=Math.floor(Math.min(e.length-1,i)),!(n<=t&&t<=i))return e;for(a=a===void 0?Sb:u_(a);i>n;){if(i-n>600){const c=i-n+1,d=t-n+1,u=Math.log(c),f=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),p=Math.max(n,Math.floor(t-d*f/c+m)),y=Math.min(i,Math.floor(t+(c-d)*f/c+m));Nb(e,t,p,y,a)}const s=e[t];let o=n,l=i;for(Va(e,n,t),a(e[i],s)>0&&Va(e,n,i);o<l;){for(Va(e,o,l),++o,--l;a(e[o],s)<0;)++o;for(;a(e[l],s)>0;)--l}a(e[n],s)===0?Va(e,n,l):(++l,Va(e,l,i)),l<=t&&(n=l+1),t<=l&&(i=l-1)}return e}function Va(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function m_(e,t,n){if(e=Float64Array.from(a_(e)),!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return Eg(e);if(t>=1)return Cg(e);var i,a=(i-1)*t,s=Math.floor(a),o=Cg(Nb(e,s).subarray(0,s+1)),l=Eg(e.subarray(s+1));return o+(l-o)*(a-s)}}function p_(e,t,n=wb){if(!(!(i=e.length)||isNaN(t=+t))){if(t<=0||i<2)return+n(e[0],0,e);if(t>=1)return+n(e[i-1],i-1,e);var i,a=(i-1)*t,s=Math.floor(a),o=+n(e[s],s,e),l=+n(e[s+1],s+1,e);return o+(l-o)*(a-s)}}function g_(e,t,n){e=+e,t=+t,n=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+n;for(var i=-1,a=Math.max(0,Math.ceil((t-e)/n))|0,s=new Array(a);++i<a;)s[i]=e+i*n;return s}function ar(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Jr(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const md=Symbol("implicit");function Tf(){var e=new kg,t=[],n=[],i=md;function a(s){let o=e.get(s);if(o===void 0){if(i!==md)return i;e.set(s,o=t.push(s)-1)}return n[o%n.length]}return a.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new kg;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return a},a.range=function(s){return arguments.length?(n=Array.from(s),a):n.slice()},a.unknown=function(s){return arguments.length?(i=s,a):i},a.copy=function(){return Tf(t,n).unknown(i)},ar.apply(a,arguments),a}function Of(){var e=Tf().unknown(void 0),t=e.domain,n=e.range,i=0,a=1,s,o,l=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var m=t().length,p=a<i,y=p?a:i,v=p?i:a;s=(v-y)/Math.max(1,m-c+d*2),l&&(s=Math.floor(s)),y+=(v-y-s*(m-c))*u,o=s*(1-c),l&&(y=Math.round(y),o=Math.round(o));var g=g_(m).map(function(b){return y+s*b});return n(p?g.reverse():g)}return e.domain=function(m){return arguments.length?(t(m),f()):t()},e.range=function(m){return arguments.length?([i,a]=m,i=+i,a=+a,f()):[i,a]},e.rangeRound=function(m){return[i,a]=m,i=+i,a=+a,l=!0,f()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(m){return arguments.length?(l=!!m,f()):l},e.padding=function(m){return arguments.length?(c=Math.min(1,d=+m),f()):c},e.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),f()):c},e.paddingOuter=function(m){return arguments.length?(d=+m,f()):d},e.align=function(m){return arguments.length?(u=Math.max(0,Math.min(1,m)),f()):u},e.copy=function(){return Of(t(),[i,a]).round(l).paddingInner(c).paddingOuter(d).align(u)},ar.apply(f(),arguments)}function kb(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return kb(t())},e}function y_(){return kb(Of.apply(null,arguments).paddingInner(1))}function Df(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Ab(e,t){var n=Object.create(e.prototype);for(var i in t)n[i]=t[i];return n}function Os(){}var ps=.7,tl=1/ps,pa="\\s*([+-]?\\d+)\\s*",gs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",kr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",v_=/^#([0-9a-f]{3,8})$/,x_=new RegExp(`^rgb\\(${pa},${pa},${pa}\\)$`),b_=new RegExp(`^rgb\\(${kr},${kr},${kr}\\)$`),j_=new RegExp(`^rgba\\(${pa},${pa},${pa},${gs}\\)$`),w_=new RegExp(`^rgba\\(${kr},${kr},${kr},${gs}\\)$`),S_=new RegExp(`^hsl\\(${gs},${kr},${kr}\\)$`),N_=new RegExp(`^hsla\\(${gs},${kr},${kr},${gs}\\)$`),Ig={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Df(Os,ys,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Pg,formatHex:Pg,formatHex8:k_,formatHsl:A_,formatRgb:Tg,toString:Tg});function Pg(){return this.rgb().formatHex()}function k_(){return this.rgb().formatHex8()}function A_(){return Cb(this).formatHsl()}function Tg(){return this.rgb().formatRgb()}function ys(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=v_.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Og(t):n===3?new _n(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?bo(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?bo(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=x_.exec(e))?new _n(t[1],t[2],t[3],1):(t=b_.exec(e))?new _n(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=j_.exec(e))?bo(t[1],t[2],t[3],t[4]):(t=w_.exec(e))?bo(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=S_.exec(e))?Mg(t[1],t[2]/100,t[3]/100,1):(t=N_.exec(e))?Mg(t[1],t[2]/100,t[3]/100,t[4]):Ig.hasOwnProperty(e)?Og(Ig[e]):e==="transparent"?new _n(NaN,NaN,NaN,0):null}function Og(e){return new _n(e>>16&255,e>>8&255,e&255,1)}function bo(e,t,n,i){return i<=0&&(e=t=n=NaN),new _n(e,t,n,i)}function C_(e){return e instanceof Os||(e=ys(e)),e?(e=e.rgb(),new _n(e.r,e.g,e.b,e.opacity)):new _n}function pd(e,t,n,i){return arguments.length===1?C_(e):new _n(e,t,n,i??1)}function _n(e,t,n,i){this.r=+e,this.g=+t,this.b=+n,this.opacity=+i}Df(_n,pd,Ab(Os,{brighter(e){return e=e==null?tl:Math.pow(tl,e),new _n(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?ps:Math.pow(ps,e),new _n(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new _n(Mi(this.r),Mi(this.g),Mi(this.b),nl(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Dg,formatHex:Dg,formatHex8:E_,formatRgb:_g,toString:_g}));function Dg(){return`#${Pi(this.r)}${Pi(this.g)}${Pi(this.b)}`}function E_(){return`#${Pi(this.r)}${Pi(this.g)}${Pi(this.b)}${Pi((isNaN(this.opacity)?1:this.opacity)*255)}`}function _g(){const e=nl(this.opacity);return`${e===1?"rgb(":"rgba("}${Mi(this.r)}, ${Mi(this.g)}, ${Mi(this.b)}${e===1?")":`, ${e})`}`}function nl(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Mi(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Pi(e){return e=Mi(e),(e<16?"0":"")+e.toString(16)}function Mg(e,t,n,i){return i<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new fr(e,t,n,i)}function Cb(e){if(e instanceof fr)return new fr(e.h,e.s,e.l,e.opacity);if(e instanceof Os||(e=ys(e)),!e)return new fr;if(e instanceof fr)return e;e=e.rgb();var t=e.r/255,n=e.g/255,i=e.b/255,a=Math.min(t,n,i),s=Math.max(t,n,i),o=NaN,l=s-a,c=(s+a)/2;return l?(t===s?o=(n-i)/l+(n<i)*6:n===s?o=(i-t)/l+2:o=(t-n)/l+4,l/=c<.5?s+a:2-s-a,o*=60):l=c>0&&c<1?0:o,new fr(o,l,c,e.opacity)}function I_(e,t,n,i){return arguments.length===1?Cb(e):new fr(e,t,n,i??1)}function fr(e,t,n,i){this.h=+e,this.s=+t,this.l=+n,this.opacity=+i}Df(fr,I_,Ab(Os,{brighter(e){return e=e==null?tl:Math.pow(tl,e),new fr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?ps:Math.pow(ps,e),new fr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*t,a=2*n-i;return new _n(mu(e>=240?e-240:e+120,a,i),mu(e,a,i),mu(e<120?e+240:e-120,a,i),this.opacity)},clamp(){return new fr(Lg(this.h),jo(this.s),jo(this.l),nl(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=nl(this.opacity);return`${e===1?"hsl(":"hsla("}${Lg(this.h)}, ${jo(this.s)*100}%, ${jo(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Lg(e){return e=(e||0)%360,e<0?e+360:e}function jo(e){return Math.max(0,Math.min(1,e||0))}function mu(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const _f=e=>()=>e;function P_(e,t){return function(n){return e+n*t}}function T_(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(i){return Math.pow(e+i*t,n)}}function O_(e){return(e=+e)==1?Eb:function(t,n){return n-t?T_(t,n,e):_f(isNaN(t)?n:t)}}function Eb(e,t){var n=t-e;return n?P_(e,n):_f(isNaN(e)?t:e)}const $g=function e(t){var n=O_(t);function i(a,s){var o=n((a=pd(a)).r,(s=pd(s)).r),l=n(a.g,s.g),c=n(a.b,s.b),d=Eb(a.opacity,s.opacity);return function(u){return a.r=o(u),a.g=l(u),a.b=c(u),a.opacity=d(u),a+""}}return i.gamma=e,i}(1);function D_(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,i=t.slice(),a;return function(s){for(a=0;a<n;++a)i[a]=e[a]*(1-s)+t[a]*s;return i}}function __(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function M_(e,t){var n=t?t.length:0,i=e?Math.min(n,e.length):0,a=new Array(i),s=new Array(n),o;for(o=0;o<i;++o)a[o]=Aa(e[o],t[o]);for(;o<n;++o)s[o]=t[o];return function(l){for(o=0;o<i;++o)s[o]=a[o](l);return s}}function L_(e,t){var n=new Date;return e=+e,t=+t,function(i){return n.setTime(e*(1-i)+t*i),n}}function rl(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function $_(e,t){var n={},i={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?n[a]=Aa(e[a],t[a]):i[a]=t[a];return function(s){for(a in n)i[a]=n[a](s);return i}}var gd=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,pu=new RegExp(gd.source,"g");function z_(e){return function(){return e}}function R_(e){return function(t){return e(t)+""}}function B_(e,t){var n=gd.lastIndex=pu.lastIndex=0,i,a,s,o=-1,l=[],c=[];for(e=e+"",t=t+"";(i=gd.exec(e))&&(a=pu.exec(t));)(s=a.index)>n&&(s=t.slice(n,s),l[o]?l[o]+=s:l[++o]=s),(i=i[0])===(a=a[0])?l[o]?l[o]+=a:l[++o]=a:(l[++o]=null,c.push({i:o,x:rl(i,a)})),n=pu.lastIndex;return n<t.length&&(s=t.slice(n),l[o]?l[o]+=s:l[++o]=s),l.length<2?c[0]?R_(c[0].x):z_(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)l[(f=c[u]).i]=f.x(d);return l.join("")})}function Aa(e,t){var n=typeof t,i;return t==null||n==="boolean"?_f(t):(n==="number"?rl:n==="string"?(i=ys(t))?(t=i,$g):B_:t instanceof ys?$g:t instanceof Date?L_:__(t)?D_:Array.isArray(t)?M_:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?$_:rl)(e,t)}function Mf(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function W_(e,t){t===void 0&&(t=e,e=Aa);for(var n=0,i=t.length-1,a=t[0],s=new Array(i<0?0:i);n<i;)s[n]=e(a,a=t[++n]);return function(o){var l=Math.max(0,Math.min(i-1,Math.floor(o*=i)));return s[l](o-l)}}function F_(e){return function(){return e}}function il(e){return+e}var zg=[0,1];function En(e){return e}function yd(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:F_(isNaN(t)?NaN:.5)}function q_(e,t){var n;return e>t&&(n=e,e=t,t=n),function(i){return Math.max(e,Math.min(t,i))}}function U_(e,t,n){var i=e[0],a=e[1],s=t[0],o=t[1];return a<i?(i=yd(a,i),s=n(o,s)):(i=yd(i,a),s=n(s,o)),function(l){return s(i(l))}}function H_(e,t,n){var i=Math.min(e.length,t.length)-1,a=new Array(i),s=new Array(i),o=-1;for(e[i]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<i;)a[o]=yd(e[o],e[o+1]),s[o]=n(t[o],t[o+1]);return function(l){var c=Ts(e,l,1,i)-1;return s[c](a[c](l))}}function Ds(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function tc(){var e=zg,t=zg,n=Aa,i,a,s,o=En,l,c,d;function u(){var m=Math.min(e.length,t.length);return o!==En&&(o=q_(e[0],e[m-1])),l=m>2?H_:U_,c=d=null,f}function f(m){return m==null||isNaN(m=+m)?s:(c||(c=l(e.map(i),t,n)))(i(o(m)))}return f.invert=function(m){return o(a((d||(d=l(t,e.map(i),rl)))(m)))},f.domain=function(m){return arguments.length?(e=Array.from(m,il),u()):e.slice()},f.range=function(m){return arguments.length?(t=Array.from(m),u()):t.slice()},f.rangeRound=function(m){return t=Array.from(m),n=Mf,u()},f.clamp=function(m){return arguments.length?(o=m?!0:En,u()):o!==En},f.interpolate=function(m){return arguments.length?(n=m,u()):n},f.unknown=function(m){return arguments.length?(s=m,f):s},function(m,p){return i=m,a=p,u()}}function Lf(){return tc()(En,En)}function Y_(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function al(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,i=e.slice(0,n);return[i.length>1?i[0]+i.slice(2):i,+e.slice(n+1)]}function xa(e){return e=al(Math.abs(e)),e?e[1]:NaN}function K_(e,t){return function(n,i){for(var a=n.length,s=[],o=0,l=e[0],c=0;a>0&&l>0&&(c+l+1>i&&(l=Math.max(1,i-c)),s.push(n.substring(a-=l,a+l)),!((c+=l+1)>i));)l=e[o=(o+1)%e.length];return s.reverse().join(t)}}function V_(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var X_=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function vs(e){if(!(t=X_.exec(e)))throw new Error("invalid format: "+e);var t;return new $f({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}vs.prototype=$f.prototype;function $f(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}$f.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function G_(e){e:for(var t=e.length,n=1,i=-1,a;n<t;++n)switch(e[n]){case".":i=a=n;break;case"0":i===0&&(i=n),a=n;break;default:if(!+e[n])break e;i>0&&(i=0);break}return i>0?e.slice(0,i)+e.slice(a+1):e}var Ib;function Q_(e,t){var n=al(e,t);if(!n)return e+"";var i=n[0],a=n[1],s=a-(Ib=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,o=i.length;return s===o?i:s>o?i+new Array(s-o+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+al(e,Math.max(0,t+s-1))[0]}function Rg(e,t){var n=al(e,t);if(!n)return e+"";var i=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+i:i.length>a+1?i.slice(0,a+1)+"."+i.slice(a+1):i+new Array(a-i.length+2).join("0")}const Bg={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:Y_,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Rg(e*100,t),r:Rg,s:Q_,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Wg(e){return e}var Fg=Array.prototype.map,qg=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function J_(e){var t=e.grouping===void 0||e.thousands===void 0?Wg:K_(Fg.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",i=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?Wg:V_(Fg.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"−":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=vs(f);var m=f.fill,p=f.align,y=f.sign,v=f.symbol,g=f.zero,b=f.width,x=f.comma,N=f.precision,A=f.trim,C=f.type;C==="n"?(x=!0,C="g"):Bg[C]||(N===void 0&&(N=12),A=!0,C="g"),(g||m==="0"&&p==="=")&&(g=!0,m="0",p="=");var w=v==="$"?n:v==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",O=v==="$"?i:/[%p]/.test(C)?o:"",M=Bg[C],B=/[defgprs%]/.test(C);N=N===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,N)):Math.max(0,Math.min(20,N));function z(j){var k=w,L=O,T,$,V;if(C==="c")L=M(j)+L,j="";else{j=+j;var G=j<0||1/j<0;if(j=isNaN(j)?c:M(Math.abs(j),N),A&&(j=G_(j)),G&&+j==0&&y!=="+"&&(G=!1),k=(G?y==="("?y:l:y==="-"||y==="("?"":y)+k,L=(C==="s"?qg[8+Ib/3]:"")+L+(G&&y==="("?")":""),B){for(T=-1,$=j.length;++T<$;)if(V=j.charCodeAt(T),48>V||V>57){L=(V===46?a+j.slice(T+1):j.slice(T))+L,j=j.slice(0,T);break}}}x&&!g&&(j=t(j,1/0));var ne=k.length+j.length+L.length,U=ne<b?new Array(b-ne+1).join(m):"";switch(x&&g&&(j=t(U+j,U.length?b-L.length:1/0),U=""),p){case"<":j=k+j+L+U;break;case"=":j=k+U+j+L;break;case"^":j=U.slice(0,ne=U.length>>1)+k+j+L+U.slice(ne);break;default:j=U+k+j+L;break}return s(j)}return z.toString=function(){return f+""},z}function u(f,m){var p=d((f=vs(f),f.type="f",f)),y=Math.max(-8,Math.min(8,Math.floor(xa(m)/3)))*3,v=Math.pow(10,-y),g=qg[8+y/3];return function(b){return p(v*b)+g}}return{format:d,formatPrefix:u}}var wo,zf,Pb;Z_({thousands:",",grouping:[3],currency:["$",""]});function Z_(e){return wo=J_(e),zf=wo.format,Pb=wo.formatPrefix,wo}function eM(e){return Math.max(0,-xa(Math.abs(e)))}function tM(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(xa(t)/3)))*3-xa(Math.abs(e)))}function nM(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,xa(t)-xa(e))+1}function Tb(e,t,n,i){var a=hd(e,t,n),s;switch(i=vs(i??",f"),i.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return i.precision==null&&!isNaN(s=tM(a,o))&&(i.precision=s),Pb(i,o)}case"":case"e":case"g":case"p":case"r":{i.precision==null&&!isNaN(s=nM(a,Math.max(Math.abs(e),Math.abs(t))))&&(i.precision=s-(i.type==="e"));break}case"f":case"%":{i.precision==null&&!isNaN(s=eM(a))&&(i.precision=s-(i.type==="%")*2);break}}return zf(i)}function vi(e){var t=e.domain;return e.ticks=function(n){var i=t();return dd(i[0],i[i.length-1],n??10)},e.tickFormat=function(n,i){var a=t();return Tb(a[0],a[a.length-1],n??10,i)},e.nice=function(n){n==null&&(n=10);var i=t(),a=0,s=i.length-1,o=i[a],l=i[s],c,d,u=10;for(l<o&&(d=o,o=l,l=d,d=a,a=s,s=d);u-- >0;){if(d=fd(o,l,n),d===c)return i[a]=o,i[s]=l,t(i);if(d>0)o=Math.floor(o/d)*d,l=Math.ceil(l/d)*d;else if(d<0)o=Math.ceil(o*d)/d,l=Math.floor(l*d)/d;else break;c=d}return e},e}function Ob(){var e=Lf();return e.copy=function(){return Ds(e,Ob())},ar.apply(e,arguments),vi(e)}function Db(e){var t;function n(i){return i==null||isNaN(i=+i)?t:i}return n.invert=n,n.domain=n.range=function(i){return arguments.length?(e=Array.from(i,il),n):e.slice()},n.unknown=function(i){return arguments.length?(t=i,n):t},n.copy=function(){return Db(e).unknown(t)},e=arguments.length?Array.from(e,il):[0,1],vi(n)}function _b(e,t){e=e.slice();var n=0,i=e.length-1,a=e[n],s=e[i],o;return s<a&&(o=n,n=i,i=o,o=a,a=s,s=o),e[n]=t.floor(a),e[i]=t.ceil(s),e}function Ug(e){return Math.log(e)}function Hg(e){return Math.exp(e)}function rM(e){return-Math.log(-e)}function iM(e){return-Math.exp(-e)}function aM(e){return isFinite(e)?+("1e"+e):e<0?0:e}function sM(e){return e===10?aM:e===Math.E?Math.exp:t=>Math.pow(e,t)}function oM(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Yg(e){return(t,n)=>-e(-t,n)}function Rf(e){const t=e(Ug,Hg),n=t.domain;let i=10,a,s;function o(){return a=oM(i),s=sM(i),n()[0]<0?(a=Yg(a),s=Yg(s),e(rM,iM)):e(Ug,Hg),t}return t.base=function(l){return arguments.length?(i=+l,o()):i},t.domain=function(l){return arguments.length?(n(l),o()):n()},t.ticks=l=>{const c=n();let d=c[0],u=c[c.length-1];const f=u<d;f&&([d,u]=[u,d]);let m=a(d),p=a(u),y,v;const g=l==null?10:+l;let b=[];if(!(i%1)&&p-m<g){if(m=Math.floor(m),p=Math.ceil(p),d>0){for(;m<=p;++m)for(y=1;y<i;++y)if(v=m<0?y/s(-m):y*s(m),!(v<d)){if(v>u)break;b.push(v)}}else for(;m<=p;++m)for(y=i-1;y>=1;--y)if(v=m>0?y/s(-m):y*s(m),!(v<d)){if(v>u)break;b.push(v)}b.length*2<g&&(b=dd(d,u,g))}else b=dd(m,p,Math.min(p-m,g)).map(s);return f?b.reverse():b},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=i===10?"s":","),typeof c!="function"&&(!(i%1)&&(c=vs(c)).precision==null&&(c.trim=!0),c=zf(c)),l===1/0)return c;const d=Math.max(1,i*l/t.ticks().length);return u=>{let f=u/s(Math.round(a(u)));return f*i<i-.5&&(f*=i),f<=d?c(u):""}},t.nice=()=>n(_b(n(),{floor:l=>s(Math.floor(a(l))),ceil:l=>s(Math.ceil(a(l)))})),t}function Mb(){const e=Rf(tc()).domain([1,10]);return e.copy=()=>Ds(e,Mb()).base(e.base()),ar.apply(e,arguments),e}function Kg(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Vg(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Bf(e){var t=1,n=e(Kg(t),Vg(t));return n.constant=function(i){return arguments.length?e(Kg(t=+i),Vg(t)):t},vi(n)}function Lb(){var e=Bf(tc());return e.copy=function(){return Ds(e,Lb()).constant(e.constant())},ar.apply(e,arguments)}function Xg(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function lM(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function cM(e){return e<0?-e*e:e*e}function Wf(e){var t=e(En,En),n=1;function i(){return n===1?e(En,En):n===.5?e(lM,cM):e(Xg(n),Xg(1/n))}return t.exponent=function(a){return arguments.length?(n=+a,i()):n},vi(t)}function Ff(){var e=Wf(tc());return e.copy=function(){return Ds(e,Ff()).exponent(e.exponent())},ar.apply(e,arguments),e}function uM(){return Ff.apply(null,arguments).exponent(.5)}function Gg(e){return Math.sign(e)*e*e}function dM(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function $b(){var e=Lf(),t=[0,1],n=!1,i;function a(s){var o=dM(e(s));return isNaN(o)?i:n?Math.round(o):o}return a.invert=function(s){return e.invert(Gg(s))},a.domain=function(s){return arguments.length?(e.domain(s),a):e.domain()},a.range=function(s){return arguments.length?(e.range((t=Array.from(s,il)).map(Gg)),a):t.slice()},a.rangeRound=function(s){return a.range(s).round(!0)},a.round=function(s){return arguments.length?(n=!!s,a):n},a.clamp=function(s){return arguments.length?(e.clamp(s),a):e.clamp()},a.unknown=function(s){return arguments.length?(i=s,a):i},a.copy=function(){return $b(e.domain(),t).round(n).clamp(e.clamp()).unknown(i)},ar.apply(a,arguments),vi(a)}function zb(){var e=[],t=[],n=[],i;function a(){var o=0,l=Math.max(1,t.length);for(n=new Array(l-1);++o<l;)n[o-1]=p_(e,o/l);return s}function s(o){return o==null||isNaN(o=+o)?i:t[Ts(n,o)]}return s.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?n[l-1]:e[0],l<n.length?n[l]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(ui),a()},s.range=function(o){return arguments.length?(t=Array.from(o),a()):t.slice()},s.unknown=function(o){return arguments.length?(i=o,s):i},s.quantiles=function(){return n.slice()},s.copy=function(){return zb().domain(e).range(t).unknown(i)},ar.apply(s,arguments)}function Rb(){var e=0,t=1,n=1,i=[.5],a=[0,1],s;function o(c){return c!=null&&c<=c?a[Ts(i,c,0,n)]:s}function l(){var c=-1;for(i=new Array(n);++c<n;)i[c]=((c+1)*t-(c-n)*e)/(n+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(n=(a=Array.from(c)).length-1,l()):a.slice()},o.invertExtent=function(c){var d=a.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,i[0]]:d>=n?[i[n-1],t]:[i[d-1],i[d]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return i.slice()},o.copy=function(){return Rb().domain([e,t]).range(a).unknown(s)},ar.apply(vi(o),arguments)}function Bb(){var e=[.5],t=[0,1],n,i=1;function a(s){return s!=null&&s<=s?t[Ts(e,s,0,i)]:n}return a.domain=function(s){return arguments.length?(e=Array.from(s),i=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(s){return arguments.length?(t=Array.from(s),i=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},a.unknown=function(s){return arguments.length?(n=s,a):n},a.copy=function(){return Bb().domain(e).range(t).unknown(n)},ar.apply(a,arguments)}const gu=new Date,yu=new Date;function ln(e,t,n,i){function a(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return a.floor=s=>(e(s=new Date(+s)),s),a.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),a.round=s=>{const o=a(s),l=a.ceil(s);return s-o<l-s?o:l},a.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),a.range=(s,o,l)=>{const c=[];if(s=a.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return c;let d;do c.push(d=new Date(+s)),t(s,l),e(s);while(d<s&&s<o);return c},a.filter=s=>ln(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!s(o););else for(;--l>=0;)for(;t(o,1),!s(o););}),n&&(a.count=(s,o)=>(gu.setTime(+s),yu.setTime(+o),e(gu),e(yu),Math.floor(n(gu,yu))),a.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?a.filter(i?o=>i(o)%s===0:o=>a.count(0,o)%s===0):a)),a}const sl=ln(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);sl.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?ln(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):sl);sl.range;const Rr=1e3,nr=Rr*60,Br=nr*60,Hr=Br*24,qf=Hr*7,Qg=Hr*30,vu=Hr*365,Ti=ln(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Rr)},(e,t)=>(t-e)/Rr,e=>e.getUTCSeconds());Ti.range;const Uf=ln(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Rr)},(e,t)=>{e.setTime(+e+t*nr)},(e,t)=>(t-e)/nr,e=>e.getMinutes());Uf.range;const Hf=ln(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*nr)},(e,t)=>(t-e)/nr,e=>e.getUTCMinutes());Hf.range;const Yf=ln(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Rr-e.getMinutes()*nr)},(e,t)=>{e.setTime(+e+t*Br)},(e,t)=>(t-e)/Br,e=>e.getHours());Yf.range;const Kf=ln(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Br)},(e,t)=>(t-e)/Br,e=>e.getUTCHours());Kf.range;const _s=ln(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*nr)/Hr,e=>e.getDate()-1);_s.range;const nc=ln(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Hr,e=>e.getUTCDate()-1);nc.range;const Wb=ln(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Hr,e=>Math.floor(e/Hr));Wb.range;function Xi(e){return ln(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*nr)/qf)}const rc=Xi(0),ol=Xi(1),fM=Xi(2),hM=Xi(3),ba=Xi(4),mM=Xi(5),pM=Xi(6);rc.range;ol.range;fM.range;hM.range;ba.range;mM.range;pM.range;function Gi(e){return ln(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/qf)}const ic=Gi(0),ll=Gi(1),gM=Gi(2),yM=Gi(3),ja=Gi(4),vM=Gi(5),xM=Gi(6);ic.range;ll.range;gM.range;yM.range;ja.range;vM.range;xM.range;const Vf=ln(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Vf.range;const Xf=ln(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Xf.range;const Yr=ln(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Yr.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ln(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Yr.range;const Kr=ln(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Kr.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:ln(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Kr.range;function Fb(e,t,n,i,a,s){const o=[[Ti,1,Rr],[Ti,5,5*Rr],[Ti,15,15*Rr],[Ti,30,30*Rr],[s,1,nr],[s,5,5*nr],[s,15,15*nr],[s,30,30*nr],[a,1,Br],[a,3,3*Br],[a,6,6*Br],[a,12,12*Br],[i,1,Hr],[i,2,2*Hr],[n,1,qf],[t,1,Qg],[t,3,3*Qg],[e,1,vu]];function l(d,u,f){const m=u<d;m&&([d,u]=[u,d]);const p=f&&typeof f.range=="function"?f:c(d,u,f),y=p?p.range(d,+u+1):[];return m?y.reverse():y}function c(d,u,f){const m=Math.abs(u-d)/f,p=Pf(([,,g])=>g).right(o,m);if(p===o.length)return e.every(hd(d/vu,u/vu,f));if(p===0)return sl.every(Math.max(hd(d,u,f),1));const[y,v]=o[m/o[p-1][2]<o[p][2]/m?p-1:p];return y.every(v)}return[l,c]}const[bM,jM]=Fb(Kr,Xf,ic,Wb,Kf,Hf),[wM,SM]=Fb(Yr,Vf,rc,_s,Yf,Uf);function xu(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function bu(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Xa(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function NM(e){var t=e.dateTime,n=e.date,i=e.time,a=e.periods,s=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,d=Ga(a),u=Qa(a),f=Ga(s),m=Qa(s),p=Ga(o),y=Qa(o),v=Ga(l),g=Qa(l),b=Ga(c),x=Qa(c),N={a:G,A:ne,b:U,B:I,c:null,d:ry,e:ry,f:KM,g:r6,G:a6,H:UM,I:HM,j:YM,L:qb,m:VM,M:XM,p:P,q:D,Q:sy,s:oy,S:GM,u:QM,U:JM,V:ZM,w:e6,W:t6,x:null,X:null,y:n6,Y:i6,Z:s6,"%":ay},A={a:S,A:_,b:H,B:q,c:null,d:iy,e:iy,f:u6,g:b6,G:w6,H:o6,I:l6,j:c6,L:Hb,m:d6,M:f6,p:K,q:W,Q:sy,s:oy,S:h6,u:m6,U:p6,V:g6,w:y6,W:v6,x:null,X:null,y:x6,Y:j6,Z:S6,"%":ay},C={a:z,A:j,b:k,B:L,c:T,d:ty,e:ty,f:BM,g:ey,G:Zg,H:ny,I:ny,j:LM,L:RM,m:MM,M:$M,p:B,q:_M,Q:FM,s:qM,S:zM,u:IM,U:PM,V:TM,w:EM,W:OM,x:$,X:V,y:ey,Y:Zg,Z:DM,"%":WM};N.x=w(n,N),N.X=w(i,N),N.c=w(t,N),A.x=w(n,A),A.X=w(i,A),A.c=w(t,A);function w(R,oe){return function(Y){var X=[],de=-1,be=0,ke=R.length,ve,Ie,J;for(Y instanceof Date||(Y=new Date(+Y));++de<ke;)R.charCodeAt(de)===37&&(X.push(R.slice(be,de)),(Ie=Jg[ve=R.charAt(++de)])!=null?ve=R.charAt(++de):Ie=ve==="e"?" ":"0",(J=oe[ve])&&(ve=J(Y,Ie)),X.push(ve),be=de+1);return X.push(R.slice(be,de)),X.join("")}}function O(R,oe){return function(Y){var X=Xa(1900,void 0,1),de=M(X,R,Y+="",0),be,ke;if(de!=Y.length)return null;if("Q"in X)return new Date(X.Q);if("s"in X)return new Date(X.s*1e3+("L"in X?X.L:0));if(oe&&!("Z"in X)&&(X.Z=0),"p"in X&&(X.H=X.H%12+X.p*12),X.m===void 0&&(X.m="q"in X?X.q:0),"V"in X){if(X.V<1||X.V>53)return null;"w"in X||(X.w=1),"Z"in X?(be=bu(Xa(X.y,0,1)),ke=be.getUTCDay(),be=ke>4||ke===0?ll.ceil(be):ll(be),be=nc.offset(be,(X.V-1)*7),X.y=be.getUTCFullYear(),X.m=be.getUTCMonth(),X.d=be.getUTCDate()+(X.w+6)%7):(be=xu(Xa(X.y,0,1)),ke=be.getDay(),be=ke>4||ke===0?ol.ceil(be):ol(be),be=_s.offset(be,(X.V-1)*7),X.y=be.getFullYear(),X.m=be.getMonth(),X.d=be.getDate()+(X.w+6)%7)}else("W"in X||"U"in X)&&("w"in X||(X.w="u"in X?X.u%7:"W"in X?1:0),ke="Z"in X?bu(Xa(X.y,0,1)).getUTCDay():xu(Xa(X.y,0,1)).getDay(),X.m=0,X.d="W"in X?(X.w+6)%7+X.W*7-(ke+5)%7:X.w+X.U*7-(ke+6)%7);return"Z"in X?(X.H+=X.Z/100|0,X.M+=X.Z%100,bu(X)):xu(X)}}function M(R,oe,Y,X){for(var de=0,be=oe.length,ke=Y.length,ve,Ie;de<be;){if(X>=ke)return-1;if(ve=oe.charCodeAt(de++),ve===37){if(ve=oe.charAt(de++),Ie=C[ve in Jg?oe.charAt(de++):ve],!Ie||(X=Ie(R,Y,X))<0)return-1}else if(ve!=Y.charCodeAt(X++))return-1}return X}function B(R,oe,Y){var X=d.exec(oe.slice(Y));return X?(R.p=u.get(X[0].toLowerCase()),Y+X[0].length):-1}function z(R,oe,Y){var X=p.exec(oe.slice(Y));return X?(R.w=y.get(X[0].toLowerCase()),Y+X[0].length):-1}function j(R,oe,Y){var X=f.exec(oe.slice(Y));return X?(R.w=m.get(X[0].toLowerCase()),Y+X[0].length):-1}function k(R,oe,Y){var X=b.exec(oe.slice(Y));return X?(R.m=x.get(X[0].toLowerCase()),Y+X[0].length):-1}function L(R,oe,Y){var X=v.exec(oe.slice(Y));return X?(R.m=g.get(X[0].toLowerCase()),Y+X[0].length):-1}function T(R,oe,Y){return M(R,t,oe,Y)}function $(R,oe,Y){return M(R,n,oe,Y)}function V(R,oe,Y){return M(R,i,oe,Y)}function G(R){return o[R.getDay()]}function ne(R){return s[R.getDay()]}function U(R){return c[R.getMonth()]}function I(R){return l[R.getMonth()]}function P(R){return a[+(R.getHours()>=12)]}function D(R){return 1+~~(R.getMonth()/3)}function S(R){return o[R.getUTCDay()]}function _(R){return s[R.getUTCDay()]}function H(R){return c[R.getUTCMonth()]}function q(R){return l[R.getUTCMonth()]}function K(R){return a[+(R.getUTCHours()>=12)]}function W(R){return 1+~~(R.getUTCMonth()/3)}return{format:function(R){var oe=w(R+="",N);return oe.toString=function(){return R},oe},parse:function(R){var oe=O(R+="",!1);return oe.toString=function(){return R},oe},utcFormat:function(R){var oe=w(R+="",A);return oe.toString=function(){return R},oe},utcParse:function(R){var oe=O(R+="",!0);return oe.toString=function(){return R},oe}}}var Jg={"-":"",_:" ",0:"0"},gn=/^\s*\d+/,kM=/^%/,AM=/[\\^$*+?|[\]().{}]/g;function lt(e,t,n){var i=e<0?"-":"",a=(i?-e:e)+"",s=a.length;return i+(s<n?new Array(n-s+1).join(t)+a:a)}function CM(e){return e.replace(AM,"\\$&")}function Ga(e){return new RegExp("^(?:"+e.map(CM).join("|")+")","i")}function Qa(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function EM(e,t,n){var i=gn.exec(t.slice(n,n+1));return i?(e.w=+i[0],n+i[0].length):-1}function IM(e,t,n){var i=gn.exec(t.slice(n,n+1));return i?(e.u=+i[0],n+i[0].length):-1}function PM(e,t,n){var i=gn.exec(t.slice(n,n+2));return i?(e.U=+i[0],n+i[0].length):-1}function TM(e,t,n){var i=gn.exec(t.slice(n,n+2));return i?(e.V=+i[0],n+i[0].length):-1}function OM(e,t,n){var i=gn.exec(t.slice(n,n+2));return i?(e.W=+i[0],n+i[0].length):-1}function Zg(e,t,n){var i=gn.exec(t.slice(n,n+4));return i?(e.y=+i[0],n+i[0].length):-1}function ey(e,t,n){var i=gn.exec(t.slice(n,n+2));return i?(e.y=+i[0]+(+i[0]>68?1900:2e3),n+i[0].length):-1}function DM(e,t,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return i?(e.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function _M(e,t,n){var i=gn.exec(t.slice(n,n+1));return i?(e.q=i[0]*3-3,n+i[0].length):-1}function MM(e,t,n){var i=gn.exec(t.slice(n,n+2));return i?(e.m=i[0]-1,n+i[0].length):-1}function ty(e,t,n){var i=gn.exec(t.slice(n,n+2));return i?(e.d=+i[0],n+i[0].length):-1}function LM(e,t,n){var i=gn.exec(t.slice(n,n+3));return i?(e.m=0,e.d=+i[0],n+i[0].length):-1}function ny(e,t,n){var i=gn.exec(t.slice(n,n+2));return i?(e.H=+i[0],n+i[0].length):-1}function $M(e,t,n){var i=gn.exec(t.slice(n,n+2));return i?(e.M=+i[0],n+i[0].length):-1}function zM(e,t,n){var i=gn.exec(t.slice(n,n+2));return i?(e.S=+i[0],n+i[0].length):-1}function RM(e,t,n){var i=gn.exec(t.slice(n,n+3));return i?(e.L=+i[0],n+i[0].length):-1}function BM(e,t,n){var i=gn.exec(t.slice(n,n+6));return i?(e.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function WM(e,t,n){var i=kM.exec(t.slice(n,n+1));return i?n+i[0].length:-1}function FM(e,t,n){var i=gn.exec(t.slice(n));return i?(e.Q=+i[0],n+i[0].length):-1}function qM(e,t,n){var i=gn.exec(t.slice(n));return i?(e.s=+i[0],n+i[0].length):-1}function ry(e,t){return lt(e.getDate(),t,2)}function UM(e,t){return lt(e.getHours(),t,2)}function HM(e,t){return lt(e.getHours()%12||12,t,2)}function YM(e,t){return lt(1+_s.count(Yr(e),e),t,3)}function qb(e,t){return lt(e.getMilliseconds(),t,3)}function KM(e,t){return qb(e,t)+"000"}function VM(e,t){return lt(e.getMonth()+1,t,2)}function XM(e,t){return lt(e.getMinutes(),t,2)}function GM(e,t){return lt(e.getSeconds(),t,2)}function QM(e){var t=e.getDay();return t===0?7:t}function JM(e,t){return lt(rc.count(Yr(e)-1,e),t,2)}function Ub(e){var t=e.getDay();return t>=4||t===0?ba(e):ba.ceil(e)}function ZM(e,t){return e=Ub(e),lt(ba.count(Yr(e),e)+(Yr(e).getDay()===4),t,2)}function e6(e){return e.getDay()}function t6(e,t){return lt(ol.count(Yr(e)-1,e),t,2)}function n6(e,t){return lt(e.getFullYear()%100,t,2)}function r6(e,t){return e=Ub(e),lt(e.getFullYear()%100,t,2)}function i6(e,t){return lt(e.getFullYear()%1e4,t,4)}function a6(e,t){var n=e.getDay();return e=n>=4||n===0?ba(e):ba.ceil(e),lt(e.getFullYear()%1e4,t,4)}function s6(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+lt(t/60|0,"0",2)+lt(t%60,"0",2)}function iy(e,t){return lt(e.getUTCDate(),t,2)}function o6(e,t){return lt(e.getUTCHours(),t,2)}function l6(e,t){return lt(e.getUTCHours()%12||12,t,2)}function c6(e,t){return lt(1+nc.count(Kr(e),e),t,3)}function Hb(e,t){return lt(e.getUTCMilliseconds(),t,3)}function u6(e,t){return Hb(e,t)+"000"}function d6(e,t){return lt(e.getUTCMonth()+1,t,2)}function f6(e,t){return lt(e.getUTCMinutes(),t,2)}function h6(e,t){return lt(e.getUTCSeconds(),t,2)}function m6(e){var t=e.getUTCDay();return t===0?7:t}function p6(e,t){return lt(ic.count(Kr(e)-1,e),t,2)}function Yb(e){var t=e.getUTCDay();return t>=4||t===0?ja(e):ja.ceil(e)}function g6(e,t){return e=Yb(e),lt(ja.count(Kr(e),e)+(Kr(e).getUTCDay()===4),t,2)}function y6(e){return e.getUTCDay()}function v6(e,t){return lt(ll.count(Kr(e)-1,e),t,2)}function x6(e,t){return lt(e.getUTCFullYear()%100,t,2)}function b6(e,t){return e=Yb(e),lt(e.getUTCFullYear()%100,t,2)}function j6(e,t){return lt(e.getUTCFullYear()%1e4,t,4)}function w6(e,t){var n=e.getUTCDay();return e=n>=4||n===0?ja(e):ja.ceil(e),lt(e.getUTCFullYear()%1e4,t,4)}function S6(){return"+0000"}function ay(){return"%"}function sy(e){return+e}function oy(e){return Math.floor(+e/1e3)}var oa,Kb,Vb;N6({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function N6(e){return oa=NM(e),Kb=oa.format,oa.parse,Vb=oa.utcFormat,oa.utcParse,oa}function k6(e){return new Date(e)}function A6(e){return e instanceof Date?+e:+new Date(+e)}function Gf(e,t,n,i,a,s,o,l,c,d){var u=Lf(),f=u.invert,m=u.domain,p=d(".%L"),y=d(":%S"),v=d("%I:%M"),g=d("%I %p"),b=d("%a %d"),x=d("%b %d"),N=d("%B"),A=d("%Y");function C(w){return(c(w)<w?p:l(w)<w?y:o(w)<w?v:s(w)<w?g:i(w)<w?a(w)<w?b:x:n(w)<w?N:A)(w)}return u.invert=function(w){return new Date(f(w))},u.domain=function(w){return arguments.length?m(Array.from(w,A6)):m().map(k6)},u.ticks=function(w){var O=m();return e(O[0],O[O.length-1],w??10)},u.tickFormat=function(w,O){return O==null?C:d(O)},u.nice=function(w){var O=m();return(!w||typeof w.range!="function")&&(w=t(O[0],O[O.length-1],w??10)),w?m(_b(O,w)):u},u.copy=function(){return Ds(u,Gf(e,t,n,i,a,s,o,l,c,d))},u}function C6(){return ar.apply(Gf(wM,SM,Yr,Vf,rc,_s,Yf,Uf,Ti,Kb).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function E6(){return ar.apply(Gf(bM,jM,Kr,Xf,ic,nc,Kf,Hf,Ti,Vb).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function ac(){var e=0,t=1,n,i,a,s,o=En,l=!1,c;function d(f){return f==null||isNaN(f=+f)?c:o(a===0?.5:(f=(s(f)-n)*a,l?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,n=s(e=+e),i=s(t=+t),a=n===i?0:1/(i-n),d):[e,t]},d.clamp=function(f){return arguments.length?(l=!!f,d):l},d.interpolator=function(f){return arguments.length?(o=f,d):o};function u(f){return function(m){var p,y;return arguments.length?([p,y]=m,o=f(p,y),d):[o(0),o(1)]}}return d.range=u(Aa),d.rangeRound=u(Mf),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return s=f,n=f(e),i=f(t),a=n===i?0:1/(i-n),d}}function xi(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Xb(){var e=vi(ac()(En));return e.copy=function(){return xi(e,Xb())},Jr.apply(e,arguments)}function Gb(){var e=Rf(ac()).domain([1,10]);return e.copy=function(){return xi(e,Gb()).base(e.base())},Jr.apply(e,arguments)}function Qb(){var e=Bf(ac());return e.copy=function(){return xi(e,Qb()).constant(e.constant())},Jr.apply(e,arguments)}function Qf(){var e=Wf(ac());return e.copy=function(){return xi(e,Qf()).exponent(e.exponent())},Jr.apply(e,arguments)}function I6(){return Qf.apply(null,arguments).exponent(.5)}function Jb(){var e=[],t=En;function n(i){if(i!=null&&!isNaN(i=+i))return t((Ts(e,i,1)-1)/(e.length-1))}return n.domain=function(i){if(!arguments.length)return e.slice();e=[];for(let a of i)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(ui),n},n.interpolator=function(i){return arguments.length?(t=i,n):t},n.range=function(){return e.map((i,a)=>t(a/(e.length-1)))},n.quantiles=function(i){return Array.from({length:i+1},(a,s)=>m_(e,s/i))},n.copy=function(){return Jb(t).domain(e)},Jr.apply(n,arguments)}function sc(){var e=0,t=.5,n=1,i=1,a,s,o,l,c,d=En,u,f=!1,m;function p(v){return isNaN(v=+v)?m:(v=.5+((v=+u(v))-s)*(i*v<i*s?l:c),d(f?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t,n]=v,a=u(e=+e),s=u(t=+t),o=u(n=+n),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),i=s<a?-1:1,p):[e,t,n]},p.clamp=function(v){return arguments.length?(f=!!v,p):f},p.interpolator=function(v){return arguments.length?(d=v,p):d};function y(v){return function(g){var b,x,N;return arguments.length?([b,x,N]=g,d=W_(v,[b,x,N]),p):[d(0),d(.5),d(1)]}}return p.range=y(Aa),p.rangeRound=y(Mf),p.unknown=function(v){return arguments.length?(m=v,p):m},function(v){return u=v,a=v(e),s=v(t),o=v(n),l=a===s?0:.5/(s-a),c=s===o?0:.5/(o-s),i=s<a?-1:1,p}}function Zb(){var e=vi(sc()(En));return e.copy=function(){return xi(e,Zb())},Jr.apply(e,arguments)}function e1(){var e=Rf(sc()).domain([.1,1,10]);return e.copy=function(){return xi(e,e1()).base(e.base())},Jr.apply(e,arguments)}function t1(){var e=Bf(sc());return e.copy=function(){return xi(e,t1()).constant(e.constant())},Jr.apply(e,arguments)}function Jf(){var e=Wf(sc());return e.copy=function(){return xi(e,Jf()).exponent(e.exponent())},Jr.apply(e,arguments)}function P6(){return Jf.apply(null,arguments).exponent(.5)}const es=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Of,scaleDiverging:Zb,scaleDivergingLog:e1,scaleDivergingPow:Jf,scaleDivergingSqrt:P6,scaleDivergingSymlog:t1,scaleIdentity:Db,scaleImplicit:md,scaleLinear:Ob,scaleLog:Mb,scaleOrdinal:Tf,scalePoint:y_,scalePow:Ff,scaleQuantile:zb,scaleQuantize:Rb,scaleRadial:$b,scaleSequential:Xb,scaleSequentialLog:Gb,scaleSequentialPow:Qf,scaleSequentialQuantile:Jb,scaleSequentialSqrt:I6,scaleSequentialSymlog:Qb,scaleSqrt:uM,scaleSymlog:Lb,scaleThreshold:Bb,scaleTime:C6,scaleUtc:E6,tickFormat:Tb},Symbol.toStringTag,{value:"Module"}));var bi=e=>e.chartData,Zf=pe([bi],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),oc=(e,t,n,i)=>i?Zf(e):bi(e);function qi(e){if(Array.isArray(e)&&e.length===2){var[t,n]=e;if(Xt(t)&&Xt(n))return!0}return!1}function ly(e,t,n){return n?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function n1(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[n,i]=e,a,s;if(Xt(n))a=n;else if(typeof n=="function")return;if(Xt(i))s=i;else if(typeof i=="function")return;var o=[a,s];if(qi(o))return o}}function T6(e,t,n){if(!(!n&&t==null)){if(typeof e=="function"&&t!=null)try{var i=e(t,n);if(qi(i))return ly(i,t,n)}catch{}if(Array.isArray(e)&&e.length===2){var[a,s]=e,o,l;if(a==="auto")t!=null&&(o=Math.min(...t));else if(Be(a))o=a;else if(typeof a=="function")try{t!=null&&(o=a(t==null?void 0:t[0]))}catch{}else if(typeof a=="string"&&Jp.test(a)){var c=Jp.exec(a);if(c==null||t==null)o=void 0;else{var d=+c[1];o=t[0]-d}}else o=t==null?void 0:t[0];if(s==="auto")t!=null&&(l=Math.max(...t));else if(Be(s))l=s;else if(typeof s=="function")try{t!=null&&(l=s(t==null?void 0:t[1]))}catch{}else if(typeof s=="string"&&Zp.test(s)){var u=Zp.exec(s);if(u==null||t==null)l=void 0;else{var f=+u[1];l=t[1]+f}}else l=t==null?void 0:t[1];var m=[o,l];if(qi(m))return t==null?m:ly(m,t,n)}}}var Ca=1e9,O6={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},th,_t=!0,ir="[DecimalError] ",Li=ir+"Invalid argument: ",eh=ir+"Exponent out of range: ",Ea=Math.floor,Ei=Math.pow,D6=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Un,fn=1e7,Et=7,r1=9007199254740991,cl=Ea(r1/Et),$e={};$e.absoluteValue=$e.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};$e.comparedTo=$e.cmp=function(e){var t,n,i,a,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(i=s.d.length,a=e.d.length,t=0,n=i<a?i:a;t<n;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return i===a?0:i>a^s.s<0?1:-1};$e.decimalPlaces=$e.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Et;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};$e.dividedBy=$e.div=function(e){return Fr(this,new this.constructor(e))};$e.dividedToIntegerBy=$e.idiv=function(e){var t=this,n=t.constructor;return xt(Fr(t,new n(e),0,1),n.precision)};$e.equals=$e.eq=function(e){return!this.cmp(e)};$e.exponent=function(){return tn(this)};$e.greaterThan=$e.gt=function(e){return this.cmp(e)>0};$e.greaterThanOrEqualTo=$e.gte=function(e){return this.cmp(e)>=0};$e.isInteger=$e.isint=function(){return this.e>this.d.length-2};$e.isNegative=$e.isneg=function(){return this.s<0};$e.isPositive=$e.ispos=function(){return this.s>0};$e.isZero=function(){return this.s===0};$e.lessThan=$e.lt=function(e){return this.cmp(e)<0};$e.lessThanOrEqualTo=$e.lte=function(e){return this.cmp(e)<1};$e.logarithm=$e.log=function(e){var t,n=this,i=n.constructor,a=i.precision,s=a+5;if(e===void 0)e=new i(10);else if(e=new i(e),e.s<1||e.eq(Un))throw Error(ir+"NaN");if(n.s<1)throw Error(ir+(n.s?"NaN":"-Infinity"));return n.eq(Un)?new i(0):(_t=!1,t=Fr(xs(n,s),xs(e,s),s),_t=!0,xt(t,a))};$e.minus=$e.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?s1(t,e):i1(t,(e.s=-e.s,e))};$e.modulo=$e.mod=function(e){var t,n=this,i=n.constructor,a=i.precision;if(e=new i(e),!e.s)throw Error(ir+"NaN");return n.s?(_t=!1,t=Fr(n,e,0,1).times(e),_t=!0,n.minus(t)):xt(new i(n),a)};$e.naturalExponential=$e.exp=function(){return a1(this)};$e.naturalLogarithm=$e.ln=function(){return xs(this)};$e.negated=$e.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};$e.plus=$e.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?i1(t,e):s1(t,(e.s=-e.s,e))};$e.precision=$e.sd=function(e){var t,n,i,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Li+e);if(t=tn(a)+1,i=a.d.length-1,n=i*Et+1,i=a.d[i],i){for(;i%10==0;i/=10)n--;for(i=a.d[0];i>=10;i/=10)n++}return e&&t>n?t:n};$e.squareRoot=$e.sqrt=function(){var e,t,n,i,a,s,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(ir+"NaN")}for(e=tn(l),_t=!1,a=Math.sqrt(+l),a==0||a==1/0?(t=Nr(l.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=Ea((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),i=new c(t)):i=new c(a.toString()),n=c.precision,a=o=n+3;;)if(s=i,i=s.plus(Fr(l,s,o+2)).times(.5),Nr(s.d).slice(0,o)===(t=Nr(i.d)).slice(0,o)){if(t=t.slice(o-3,o+1),a==o&&t=="4999"){if(xt(s,n+1,0),s.times(s).eq(l)){i=s;break}}else if(t!="9999")break;o+=4}return _t=!0,xt(i,n)};$e.times=$e.mul=function(e){var t,n,i,a,s,o,l,c,d,u=this,f=u.constructor,m=u.d,p=(e=new f(e)).d;if(!u.s||!e.s)return new f(0);for(e.s*=u.s,n=u.e+e.e,c=m.length,d=p.length,c<d&&(s=m,m=p,p=s,o=c,c=d,d=o),s=[],o=c+d,i=o;i--;)s.push(0);for(i=d;--i>=0;){for(t=0,a=c+i;a>i;)l=s[a]+p[i]*m[a-i-1]+t,s[a--]=l%fn|0,t=l/fn|0;s[a]=(s[a]+t)%fn|0}for(;!s[--o];)s.pop();return t?++n:s.shift(),e.d=s,e.e=n,_t?xt(e,f.precision):e};$e.toDecimalPlaces=$e.todp=function(e,t){var n=this,i=n.constructor;return n=new i(n),e===void 0?n:(Ir(e,0,Ca),t===void 0?t=i.rounding:Ir(t,0,8),xt(n,e+tn(n)+1,t))};$e.toExponential=function(e,t){var n,i=this,a=i.constructor;return e===void 0?n=Ui(i,!0):(Ir(e,0,Ca),t===void 0?t=a.rounding:Ir(t,0,8),i=xt(new a(i),e+1,t),n=Ui(i,!0,e+1)),n};$e.toFixed=function(e,t){var n,i,a=this,s=a.constructor;return e===void 0?Ui(a):(Ir(e,0,Ca),t===void 0?t=s.rounding:Ir(t,0,8),i=xt(new s(a),e+tn(a)+1,t),n=Ui(i.abs(),!1,e+tn(i)+1),a.isneg()&&!a.isZero()?"-"+n:n)};$e.toInteger=$e.toint=function(){var e=this,t=e.constructor;return xt(new t(e),tn(e)+1,t.rounding)};$e.toNumber=function(){return+this};$e.toPower=$e.pow=function(e){var t,n,i,a,s,o,l=this,c=l.constructor,d=12,u=+(e=new c(e));if(!e.s)return new c(Un);if(l=new c(l),!l.s){if(e.s<1)throw Error(ir+"Infinity");return l}if(l.eq(Un))return l;if(i=c.precision,e.eq(Un))return xt(l,i);if(t=e.e,n=e.d.length-1,o=t>=n,s=l.s,o){if((n=u<0?-u:u)<=r1){for(a=new c(Un),t=Math.ceil(i/Et+4),_t=!1;n%2&&(a=a.times(l),uy(a.d,t)),n=Ea(n/2),n!==0;)l=l.times(l),uy(l.d,t);return _t=!0,e.s<0?new c(Un).div(a):xt(a,i)}}else if(s<0)throw Error(ir+"NaN");return s=s<0&&e.d[Math.max(t,n)]&1?-1:1,l.s=1,_t=!1,a=e.times(xs(l,i+d)),_t=!0,a=a1(a),a.s=s,a};$e.toPrecision=function(e,t){var n,i,a=this,s=a.constructor;return e===void 0?(n=tn(a),i=Ui(a,n<=s.toExpNeg||n>=s.toExpPos)):(Ir(e,1,Ca),t===void 0?t=s.rounding:Ir(t,0,8),a=xt(new s(a),e,t),n=tn(a),i=Ui(a,e<=n||n<=s.toExpNeg,e)),i};$e.toSignificantDigits=$e.tosd=function(e,t){var n=this,i=n.constructor;return e===void 0?(e=i.precision,t=i.rounding):(Ir(e,1,Ca),t===void 0?t=i.rounding:Ir(t,0,8)),xt(new i(n),e,t)};$e.toString=$e.valueOf=$e.val=$e.toJSON=$e[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=tn(e),n=e.constructor;return Ui(e,t<=n.toExpNeg||t>=n.toExpPos)};function i1(e,t){var n,i,a,s,o,l,c,d,u=e.constructor,f=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),_t?xt(t,f):t;if(c=e.d,d=t.d,o=e.e,a=t.e,c=c.slice(),s=o-a,s){for(s<0?(i=c,s=-s,l=d.length):(i=d,a=o,l=c.length),o=Math.ceil(f/Et),l=o>l?o+1:l+1,s>l&&(s=l,i.length=1),i.reverse();s--;)i.push(0);i.reverse()}for(l=c.length,s=d.length,l-s<0&&(s=l,i=d,d=c,c=i),n=0;s;)n=(c[--s]=c[s]+d[s]+n)/fn|0,c[s]%=fn;for(n&&(c.unshift(n),++a),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=a,_t?xt(t,f):t}function Ir(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Li+e)}function Nr(e){var t,n,i,a=e.length-1,s="",o=e[0];if(a>0){for(s+=o,t=1;t<a;t++)i=e[t]+"",n=Et-i.length,n&&(s+=oi(n)),s+=i;o=e[t],i=o+"",n=Et-i.length,n&&(s+=oi(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Fr=function(){function e(i,a){var s,o=0,l=i.length;for(i=i.slice();l--;)s=i[l]*a+o,i[l]=s%fn|0,o=s/fn|0;return o&&i.unshift(o),i}function t(i,a,s,o){var l,c;if(s!=o)c=s>o?1:-1;else for(l=c=0;l<s;l++)if(i[l]!=a[l]){c=i[l]>a[l]?1:-1;break}return c}function n(i,a,s){for(var o=0;s--;)i[s]-=o,o=i[s]<a[s]?1:0,i[s]=o*fn+i[s]-a[s];for(;!i[0]&&i.length>1;)i.shift()}return function(i,a,s,o){var l,c,d,u,f,m,p,y,v,g,b,x,N,A,C,w,O,M,B=i.constructor,z=i.s==a.s?1:-1,j=i.d,k=a.d;if(!i.s)return new B(i);if(!a.s)throw Error(ir+"Division by zero");for(c=i.e-a.e,O=k.length,C=j.length,p=new B(z),y=p.d=[],d=0;k[d]==(j[d]||0);)++d;if(k[d]>(j[d]||0)&&--c,s==null?x=s=B.precision:o?x=s+(tn(i)-tn(a))+1:x=s,x<0)return new B(0);if(x=x/Et+2|0,d=0,O==1)for(u=0,k=k[0],x++;(d<C||u)&&x--;d++)N=u*fn+(j[d]||0),y[d]=N/k|0,u=N%k|0;else{for(u=fn/(k[0]+1)|0,u>1&&(k=e(k,u),j=e(j,u),O=k.length,C=j.length),A=O,v=j.slice(0,O),g=v.length;g<O;)v[g++]=0;M=k.slice(),M.unshift(0),w=k[0],k[1]>=fn/2&&++w;do u=0,l=t(k,v,O,g),l<0?(b=v[0],O!=g&&(b=b*fn+(v[1]||0)),u=b/w|0,u>1?(u>=fn&&(u=fn-1),f=e(k,u),m=f.length,g=v.length,l=t(f,v,m,g),l==1&&(u--,n(f,O<m?M:k,m))):(u==0&&(l=u=1),f=k.slice()),m=f.length,m<g&&f.unshift(0),n(v,f,g),l==-1&&(g=v.length,l=t(k,v,O,g),l<1&&(u++,n(v,O<g?M:k,g))),g=v.length):l===0&&(u++,v=[0]),y[d++]=u,l&&v[0]?v[g++]=j[A]||0:(v=[j[A]],g=1);while((A++<C||v[0]!==void 0)&&x--)}return y[0]||y.shift(),p.e=c,xt(p,o?s+tn(p)+1:s)}}();function a1(e,t){var n,i,a,s,o,l,c=0,d=0,u=e.constructor,f=u.precision;if(tn(e)>16)throw Error(eh+tn(e));if(!e.s)return new u(Un);for(_t=!1,l=f,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),d+=5;for(i=Math.log(Ei(2,d))/Math.LN10*2+5|0,l+=i,n=a=s=new u(Un),u.precision=l;;){if(a=xt(a.times(e),l),n=n.times(++c),o=s.plus(Fr(a,n,l)),Nr(o.d).slice(0,l)===Nr(s.d).slice(0,l)){for(;d--;)s=xt(s.times(s),l);return u.precision=f,t==null?(_t=!0,xt(s,f)):s}s=o}}function tn(e){for(var t=e.e*Et,n=e.d[0];n>=10;n/=10)t++;return t}function ju(e,t,n){if(t>e.LN10.sd())throw _t=!0,n&&(e.precision=n),Error(ir+"LN10 precision limit exceeded");return xt(new e(e.LN10),t)}function oi(e){for(var t="";e--;)t+="0";return t}function xs(e,t){var n,i,a,s,o,l,c,d,u,f=1,m=10,p=e,y=p.d,v=p.constructor,g=v.precision;if(p.s<1)throw Error(ir+(p.s?"NaN":"-Infinity"));if(p.eq(Un))return new v(0);if(t==null?(_t=!1,d=g):d=t,p.eq(10))return t==null&&(_t=!0),ju(v,d);if(d+=m,v.precision=d,n=Nr(y),i=n.charAt(0),s=tn(p),Math.abs(s)<15e14){for(;i<7&&i!=1||i==1&&n.charAt(1)>3;)p=p.times(e),n=Nr(p.d),i=n.charAt(0),f++;s=tn(p),i>1?(p=new v("0."+n),s++):p=new v(i+"."+n.slice(1))}else return c=ju(v,d+2,g).times(s+""),p=xs(new v(i+"."+n.slice(1)),d-m).plus(c),v.precision=g,t==null?(_t=!0,xt(p,g)):p;for(l=o=p=Fr(p.minus(Un),p.plus(Un),d),u=xt(p.times(p),d),a=3;;){if(o=xt(o.times(u),d),c=l.plus(Fr(o,new v(a),d)),Nr(c.d).slice(0,d)===Nr(l.d).slice(0,d))return l=l.times(2),s!==0&&(l=l.plus(ju(v,d+2,g).times(s+""))),l=Fr(l,new v(f),d),v.precision=g,t==null?(_t=!0,xt(l,g)):l;l=c,a+=2}}function cy(e,t){var n,i,a;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(n<0&&(n=i),n+=+t.slice(i+1),t=t.substring(0,i)):n<0&&(n=t.length),i=0;t.charCodeAt(i)===48;)++i;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(i,a),t){if(a-=i,n=n-i-1,e.e=Ea(n/Et),e.d=[],i=(n+1)%Et,n<0&&(i+=Et),i<a){for(i&&e.d.push(+t.slice(0,i)),a-=Et;i<a;)e.d.push(+t.slice(i,i+=Et));t=t.slice(i),i=Et-t.length}else i-=a;for(;i--;)t+="0";if(e.d.push(+t),_t&&(e.e>cl||e.e<-cl))throw Error(eh+n)}else e.s=0,e.e=0,e.d=[0];return e}function xt(e,t,n){var i,a,s,o,l,c,d,u,f=e.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(i=t-o,i<0)i+=Et,a=t,d=f[u=0];else{if(u=Math.ceil((i+1)/Et),s=f.length,u>=s)return e;for(d=s=f[u],o=1;s>=10;s/=10)o++;i%=Et,a=i-Et+o}if(n!==void 0&&(s=Ei(10,o-a-1),l=d/s%10|0,c=t<0||f[u+1]!==void 0||d%s,c=n<4?(l||c)&&(n==0||n==(e.s<0?3:2)):l>5||l==5&&(n==4||c||n==6&&(i>0?a>0?d/Ei(10,o-a):0:f[u-1])%10&1||n==(e.s<0?8:7))),t<1||!f[0])return c?(s=tn(e),f.length=1,t=t-s-1,f[0]=Ei(10,(Et-t%Et)%Et),e.e=Ea(-t/Et)||0):(f.length=1,f[0]=e.e=e.s=0),e;if(i==0?(f.length=u,s=1,u--):(f.length=u+1,s=Ei(10,Et-i),f[u]=a>0?(d/Ei(10,o-a)%Ei(10,a)|0)*s:0),c)for(;;)if(u==0){(f[0]+=s)==fn&&(f[0]=1,++e.e);break}else{if(f[u]+=s,f[u]!=fn)break;f[u--]=0,s=1}for(i=f.length;f[--i]===0;)f.pop();if(_t&&(e.e>cl||e.e<-cl))throw Error(eh+tn(e));return e}function s1(e,t){var n,i,a,s,o,l,c,d,u,f,m=e.constructor,p=m.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new m(e),_t?xt(t,p):t;if(c=e.d,f=t.d,i=t.e,d=e.e,c=c.slice(),o=d-i,o){for(u=o<0,u?(n=c,o=-o,l=f.length):(n=f,i=d,l=c.length),a=Math.max(Math.ceil(p/Et),l)+2,o>a&&(o=a,n.length=1),n.reverse(),a=o;a--;)n.push(0);n.reverse()}else{for(a=c.length,l=f.length,u=a<l,u&&(l=a),a=0;a<l;a++)if(c[a]!=f[a]){u=c[a]<f[a];break}o=0}for(u&&(n=c,c=f,f=n,t.s=-t.s),l=c.length,a=f.length-l;a>0;--a)c[l++]=0;for(a=f.length;a>o;){if(c[--a]<f[a]){for(s=a;s&&c[--s]===0;)c[s]=fn-1;--c[s],c[a]+=fn}c[a]-=f[a]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--i;return c[0]?(t.d=c,t.e=i,_t?xt(t,p):t):new m(0)}function Ui(e,t,n){var i,a=tn(e),s=Nr(e.d),o=s.length;return t?(n&&(i=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+oi(i):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(a<0?"e":"e+")+a):a<0?(s="0."+oi(-a-1)+s,n&&(i=n-o)>0&&(s+=oi(i))):a>=o?(s+=oi(a+1-o),n&&(i=n-a-1)>0&&(s=s+"."+oi(i))):((i=a+1)<o&&(s=s.slice(0,i)+"."+s.slice(i)),n&&(i=n-o)>0&&(a+1===o&&(s+="."),s+=oi(i))),e.s<0?"-"+s:s}function uy(e,t){if(e.length>t)return e.length=t,!0}function o1(e){var t,n,i;function a(s){var o=this;if(!(o instanceof a))return new a(s);if(o.constructor=a,s instanceof a){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Li+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return cy(o,s.toString())}else if(typeof s!="string")throw Error(Li+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,D6.test(s))cy(o,s);else throw Error(Li+s)}if(a.prototype=$e,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=o1,a.config=a.set=_6,e===void 0&&(e={}),e)for(i=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<i.length;)e.hasOwnProperty(n=i[t++])||(e[n]=this[n]);return a.config(e),a}function _6(e){if(!e||typeof e!="object")throw Error(ir+"Object expected");var t,n,i,a=["precision",1,Ca,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((i=e[n=a[t]])!==void 0)if(Ea(i)===i&&i>=a[t+1]&&i<=a[t+2])this[n]=i;else throw Error(Li+n+": "+i);if((i=e[n="LN10"])!==void 0)if(i==Math.LN10)this[n]=new this(i);else throw Error(Li+n+": "+i);return this}var th=o1(O6);Un=new th(1);const pt=th;var M6=e=>e,l1={},c1=e=>e===l1,dy=e=>function t(){return arguments.length===0||arguments.length===1&&c1(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},u1=(e,t)=>e===1?t:dy(function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];var s=i.filter(o=>o!==l1).length;return s>=e?t(...i):u1(e-s,dy(function(){for(var o=arguments.length,l=new Array(o),c=0;c<o;c++)l[c]=arguments[c];var d=i.map(u=>c1(u)?l.shift():u);return t(...d,...l)}))}),lc=e=>u1(e.length,e),vd=(e,t)=>{for(var n=[],i=e;i<t;++i)n[i-e]=i;return n},L6=lc((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(n=>t[n]).map(e)),$6=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];if(!n.length)return M6;var a=n.reverse(),s=a[0],o=a.slice(1);return function(){return o.reduce((l,c)=>c(l),s(...arguments))}},xd=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),d1=e=>{var t=null,n=null;return function(){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return t&&a.every((o,l)=>{var c;return o===((c=t)===null||c===void 0?void 0:c[l])})||(t=a,n=e(...a)),n}};function f1(e){var t;return e===0?t=1:t=Math.floor(new pt(e).abs().log(10).toNumber())+1,t}function h1(e,t,n){for(var i=new pt(e),a=0,s=[];i.lt(t)&&a<1e5;)s.push(i.toNumber()),i=i.add(n),a++;return s}lc((e,t,n)=>{var i=+e,a=+t;return i+n*(a-i)});lc((e,t,n)=>{var i=t-+e;return i=i||1/0,(n-e)/i});lc((e,t,n)=>{var i=t-+e;return i=i||1/0,Math.max(0,Math.min(1,(n-e)/i))});var m1=e=>{var[t,n]=e,[i,a]=[t,n];return t>n&&([i,a]=[n,t]),[i,a]},p1=(e,t,n)=>{if(e.lte(0))return new pt(0);var i=f1(e.toNumber()),a=new pt(10).pow(i),s=e.div(a),o=i!==1?.05:.1,l=new pt(Math.ceil(s.div(o).toNumber())).add(n).mul(o),c=l.mul(a);return t?new pt(c.toNumber()):new pt(Math.ceil(c.toNumber()))},z6=(e,t,n)=>{var i=new pt(1),a=new pt(e);if(!a.isint()&&n){var s=Math.abs(e);s<1?(i=new pt(10).pow(f1(e)-1),a=new pt(Math.floor(a.div(i).toNumber())).mul(i)):s>1&&(a=new pt(Math.floor(e)))}else e===0?a=new pt(Math.floor((t-1)/2)):n||(a=new pt(Math.floor(e)));var o=Math.floor((t-1)/2),l=$6(L6(c=>a.add(new pt(c-o).mul(i)).toNumber()),vd);return l(0,t)},g1=function(t,n,i,a){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-t)/(i-1)))return{step:new pt(0),tickMin:new pt(0),tickMax:new pt(0)};var o=p1(new pt(n).sub(t).div(i-1),a,s),l;t<=0&&n>=0?l=new pt(0):(l=new pt(t).add(n).div(2),l=l.sub(new pt(l).mod(o)));var c=Math.ceil(l.sub(t).div(o).toNumber()),d=Math.ceil(new pt(n).sub(l).div(o).toNumber()),u=c+d+1;return u>i?g1(t,n,i,a,s+1):(u<i&&(d=n>0?d+(i-u):d,c=n>0?c:c+(i-u)),{step:o,tickMin:l.sub(new pt(c).mul(o)),tickMax:l.add(new pt(d).mul(o))})};function R6(e){var[t,n]=e,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(i,2),[o,l]=m1([t,n]);if(o===-1/0||l===1/0){var c=l===1/0?[o,...vd(0,i-1).map(()=>1/0)]:[...vd(0,i-1).map(()=>-1/0),l];return t>n?xd(c):c}if(o===l)return z6(o,i,a);var{step:d,tickMin:u,tickMax:f}=g1(o,l,s,a,0),m=h1(u,f.add(new pt(.1).mul(d)),d);return t>n?xd(m):m}function B6(e,t){var[n,i]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[s,o]=m1([n,i]);if(s===-1/0||o===1/0)return[n,i];if(s===o)return[s];var l=Math.max(t,2),c=p1(new pt(o).sub(s).div(l-1),a,0),d=[...h1(new pt(s),new pt(o),c),o];return a===!1&&(d=d.map(u=>Math.round(u))),n>i?xd(d):d}var W6=d1(R6),F6=d1(B6),y1=e=>e.rootProps.maxBarSize,q6=e=>e.rootProps.barGap,v1=e=>e.rootProps.barCategoryGap,U6=e=>e.rootProps.barSize,Ms=e=>e.rootProps.stackOffset,nh=e=>e.options.chartName,rh=e=>e.rootProps.syncId,x1=e=>e.rootProps.syncMethod,ih=e=>e.options.eventEmitter,en={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},$r={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},qn={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},cc=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},H6={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:$r.angleAxisId,includeHidden:!1,name:void 0,reversed:$r.reversed,scale:$r.scale,tick:$r.tick,tickCount:void 0,ticks:void 0,type:$r.type,unit:void 0},Y6={allowDataOverflow:qn.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:qn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:qn.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:qn.scale,tick:qn.tick,tickCount:qn.tickCount,ticks:void 0,type:qn.type,unit:void 0},K6={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:$r.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:$r.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:$r.scale,tick:$r.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},V6={allowDataOverflow:qn.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:qn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:qn.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:qn.scale,tick:qn.tick,tickCount:qn.tickCount,ticks:void 0,type:"category",unit:void 0},ah=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?K6:H6,sh=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?V6:Y6,uc=e=>e.polarOptions,oh=pe([Gr,Qr,on],mb),b1=pe([uc,oh],(e,t)=>{if(e!=null)return Sn(e.innerRadius,t,0)}),j1=pe([uc,oh],(e,t)=>{if(e!=null)return Sn(e.outerRadius,t,t*.8)}),X6=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:n}=e;return[t,n]},w1=pe([uc],X6);pe([ah,w1],cc);var S1=pe([oh,b1,j1],(e,t,n)=>{if(!(e==null||t==null||n==null))return[t,n]});pe([sh,S1],cc);var N1=pe([ot,uc,b1,j1,Gr,Qr],(e,t,n,i,a,s)=>{if(!(e!=="centric"&&e!=="radial"||t==null||n==null||i==null)){var{cx:o,cy:l,startAngle:c,endAngle:d}=t;return{cx:Sn(o,a,a/2),cy:Sn(l,s,s/2),innerRadius:n,outerRadius:i,startAngle:c,endAngle:d,clockWise:!1}}}),$t=(e,t)=>t,Ls=(e,t,n)=>n;function lh(e){return e==null?void 0:e.id}function k1(e,t,n){var{chartData:i=[]}=t,{allowDuplicatedCategory:a,dataKey:s}=n,o=new Map;return e.forEach(l=>{var c,d=(c=l.data)!==null&&c!==void 0?c:i;if(!(d==null||d.length===0)){var u=lh(l);d.forEach((f,m)=>{var p=s==null||a?m:String(kt(f,s,null)),y=kt(f,l.dataKey,0),v;o.has(p)?v=o.get(p):v={},Object.assign(v,{[u]:y}),o.set(p,v)})}}),Array.from(o.values())}function dc(e){return e.stackId!=null&&e.dataKey!=null}var fc=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function hc(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function G6(e,t){if(e.length===t.length){for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}return!1}var cn=e=>{var t=ot(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Ia=e=>e.tooltip.settings.axisId;function fy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function ul(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fy(Object(n),!0).forEach(function(i){Q6(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fy(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Q6(e,t,n){return(t=J6(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function J6(e){var t=Z6(e,"string");return typeof t=="symbol"?t:t+""}function Z6(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var bd=[0,"auto"],Wn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},A1=(e,t)=>e.cartesianAxis.xAxis[t],Zr=(e,t)=>{var n=A1(e,t);return n??Wn},Fn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:bd,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Cs},C1=(e,t)=>e.cartesianAxis.yAxis[t],ei=(e,t)=>{var n=C1(e,t);return n??Fn},eL={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},ch=(e,t)=>{var n=e.cartesianAxis.zAxis[t];return n??eL},qt=(e,t,n)=>{switch(t){case"xAxis":return Zr(e,n);case"yAxis":return ei(e,n);case"zAxis":return ch(e,n);case"angleAxis":return ah(e,n);case"radiusAxis":return sh(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},tL=(e,t,n)=>{switch(t){case"xAxis":return Zr(e,n);case"yAxis":return ei(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},$s=(e,t,n)=>{switch(t){case"xAxis":return Zr(e,n);case"yAxis":return ei(e,n);case"angleAxis":return ah(e,n);case"radiusAxis":return sh(e,n);default:throw new Error("Unexpected axis type: ".concat(t))}},E1=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function uh(e,t){return n=>{switch(e){case"xAxis":return"xAxisId"in n&&n.xAxisId===t;case"yAxis":return"yAxisId"in n&&n.yAxisId===t;case"zAxis":return"zAxisId"in n&&n.zAxisId===t;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===t;default:return!1}}}var mc=e=>e.graphicalItems.cartesianItems,nL=pe([$t,Ls],uh),dh=(e,t,n)=>e.filter(n).filter(i=>(t==null?void 0:t.includeHidden)===!0?!0:!i.hide),zs=pe([mc,qt,nL],dh,{memoizeOptions:{resultEqualityCheck:hc}}),I1=pe([zs],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(dc)),P1=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),rL=pe([zs],P1),fh=e=>e.map(t=>t.data).filter(Boolean).flat(1),iL=pe([zs],fh,{memoizeOptions:{resultEqualityCheck:hc}}),hh=(e,t)=>{var{chartData:n=[],dataStartIndex:i,dataEndIndex:a}=t;return e.length>0?e:n.slice(i,a+1)},mh=pe([iL,oc],hh),ph=(e,t,n)=>(t==null?void 0:t.dataKey)!=null?e.map(i=>({value:kt(i,t.dataKey)})):n.length>0?n.map(i=>i.dataKey).flatMap(i=>e.map(a=>({value:kt(a,i)}))):e.map(i=>({value:i})),pc=pe([mh,qt,zs],ph);function T1(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Po(e){if(Cr(e)||e instanceof Date){var t=Number(e);if(Xt(t))return t}}function hy(e){if(Array.isArray(e)){var t=[Po(e[0]),Po(e[1])];return qi(t)?t:void 0}var n=Po(e);if(n!=null)return[n,n]}function Vr(e){return e.map(Po).filter(eP)}function aL(e,t,n){return!n||typeof t!="number"||hr(t)?[]:n.length?Vr(n.flatMap(i=>{var a=kt(e,i.dataKey),s,o;if(Array.isArray(a)?[s,o]=a:s=o=a,!(!Xt(s)||!Xt(o)))return[t-s,t+o]})):[]}var un=e=>{var t=cn(e),n=Ia(e);return $s(e,t,n)},O1=pe([un],e=>e==null?void 0:e.dataKey),sL=pe([I1,oc,un],k1),D1=(e,t,n)=>{var i={},a=t.reduce((s,o)=>(o.stackId==null||(s[o.stackId]==null&&(s[o.stackId]=[]),s[o.stackId].push(o)),s),i);return Object.fromEntries(Object.entries(a).map(s=>{var[o,l]=s,c=l.map(lh);return[o,{stackedData:aO(e,c,n),graphicalItems:l}]}))},jd=pe([sL,I1,Ms],D1),_1=(e,t,n,i)=>{var{dataStartIndex:a,dataEndIndex:s}=t;if(i==null&&n!=="zAxis"){var o=uO(e,a,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},oL=pe([qt],e=>e.allowDataOverflow),gh=e=>{var t;if(e==null||!("domain"in e))return bd;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var n=Vr(e.ticks);return[Math.min(...n),Math.max(...n)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:bd},yh=pe([qt],gh),vh=pe([yh,oL],n1),lL=pe([jd,bi,$t,vh],_1,{memoizeOptions:{resultEqualityCheck:fc}}),gc=e=>e.errorBars,cL=(e,t,n)=>e.flatMap(i=>t[i.id]).filter(Boolean).filter(i=>T1(n,i)),dl=function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var a=n.filter(Boolean);if(a.length!==0){var s=a.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},xh=(e,t,n,i,a)=>{var s,o;if(n.length>0&&e.forEach(l=>{n.forEach(c=>{var d,u,f=(d=i[c.id])===null||d===void 0?void 0:d.filter(b=>T1(a,b)),m=kt(l,(u=t.dataKey)!==null&&u!==void 0?u:c.dataKey),p=aL(l,m,f);if(p.length>=2){var y=Math.min(...p),v=Math.max(...p);(s==null||y<s)&&(s=y),(o==null||v>o)&&(o=v)}var g=hy(m);g!=null&&(s=s==null?g[0]:Math.min(s,g[0]),o=o==null?g[1]:Math.max(o,g[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(l=>{var c=hy(kt(l,t.dataKey));c!=null&&(s=s==null?c[0]:Math.min(s,c[0]),o=o==null?c[1]:Math.max(o,c[1]))}),Xt(s)&&Xt(o))return[s,o]},uL=pe([mh,qt,rL,gc,$t],xh,{memoizeOptions:{resultEqualityCheck:fc}});function dL(e){var{value:t}=e;if(Cr(t)||t instanceof Date)return t}var fL=(e,t,n)=>{var i=e.map(dL).filter(a=>a!=null);return n&&(t.dataKey==null||t.allowDuplicatedCategory&&zx(i))?jb(0,e.length):t.allowDuplicatedCategory?i:Array.from(new Set(i))},M1=e=>e.referenceElements.dots,Pa=(e,t,n)=>e.filter(i=>i.ifOverflow==="extendDomain").filter(i=>t==="xAxis"?i.xAxisId===n:i.yAxisId===n),hL=pe([M1,$t,Ls],Pa),L1=e=>e.referenceElements.areas,mL=pe([L1,$t,Ls],Pa),$1=e=>e.referenceElements.lines,pL=pe([$1,$t,Ls],Pa),z1=(e,t)=>{var n=Vr(e.map(i=>t==="xAxis"?i.x:i.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},gL=pe(hL,$t,z1),R1=(e,t)=>{var n=Vr(e.flatMap(i=>[t==="xAxis"?i.x1:i.y1,t==="xAxis"?i.x2:i.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},yL=pe([mL,$t],R1);function vL(e){var t;if(e.x!=null)return Vr([e.x]);var n=(t=e.segment)===null||t===void 0?void 0:t.map(i=>i.x);return n==null||n.length===0?[]:Vr(n)}function xL(e){var t;if(e.y!=null)return Vr([e.y]);var n=(t=e.segment)===null||t===void 0?void 0:t.map(i=>i.y);return n==null||n.length===0?[]:Vr(n)}var B1=(e,t)=>{var n=e.flatMap(i=>t==="xAxis"?vL(i):xL(i));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},bL=pe([pL,$t],B1),jL=pe(gL,bL,yL,(e,t,n)=>dl(e,n,t)),bh=(e,t,n,i,a,s,o,l)=>{if(n!=null)return n;var c=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",d=c?dl(i,s,a):dl(s,a);return T6(t,d,e.allowDataOverflow)},wL=pe([qt,yh,vh,lL,uL,jL,ot,$t],bh,{memoizeOptions:{resultEqualityCheck:fc}}),SL=[0,1],jh=(e,t,n,i,a,s,o)=>{if(!((e==null||n==null||n.length===0)&&o===void 0)){var{dataKey:l,type:c}=e,d=gi(t,s);if(d&&l==null){var u;return jb(0,(u=n==null?void 0:n.length)!==null&&u!==void 0?u:0)}return c==="category"?fL(i,e,d):a==="expand"?SL:o}},wh=pe([qt,ot,mh,pc,Ms,$t,wL],jh),W1=(e,t,n,i,a)=>{if(e!=null){var{scale:s,type:o}=e;if(s==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":o==="category"&&i&&(i.indexOf("LineChart")>=0||i.indexOf("AreaChart")>=0||i.indexOf("ComposedChart")>=0&&!n)?"point":o==="category"?"band":"linear";if(typeof s=="string"){var l="scale".concat(Ns(s));return l in es?l:"point"}}},Ta=pe([qt,ot,E1,nh,$t],W1);function NL(e){if(e!=null){if(e in es)return es[e]();var t="scale".concat(Ns(e));if(t in es)return es[t]()}}function Sh(e,t,n,i){if(!(n==null||i==null)){if(typeof e.scale=="function")return e.scale.copy().domain(n).range(i);var a=NL(t);if(a!=null){var s=a.domain(n).range(i);return eO(s),s}}}var Nh=(e,t,n)=>{var i=gh(t);if(!(n!=="auto"&&n!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(i)&&(i[0]==="auto"||i[1]==="auto")&&qi(e))return W6(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&qi(e))return F6(e,t.tickCount,t.allowDecimals)}},kh=pe([wh,$s,Ta],Nh),Ah=(e,t,n,i)=>{if(i!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&qi(t)&&Array.isArray(n)&&n.length>0){var a=t[0],s=n[0],o=t[1],l=n[n.length-1];return[Math.min(a,s),Math.max(o,l)]}return t},kL=pe([qt,wh,kh,$t],Ah),AL=pe(pc,qt,(e,t)=>{if(!(!t||t.type!=="number")){var n=1/0,i=Array.from(Vr(e.map(l=>l.value))).sort((l,c)=>l-c);if(i.length<2)return 1/0;var a=i[i.length-1]-i[0];if(a===0)return 1/0;for(var s=0;s<i.length-1;s++){var o=i[s+1]-i[s];n=Math.min(n,o)}return n/a}}),F1=pe(AL,ot,v1,on,(e,t,n,i)=>i,(e,t,n,i,a)=>{if(!Xt(e))return 0;var s=t==="vertical"?i.height:i.width;if(a==="gap")return e*s/2;if(a==="no-gap"){var o=Sn(n,e*s),l=e*s/2;return l-o-(l-o)/s*o}return 0}),CL=(e,t)=>{var n=Zr(e,t);return n==null||typeof n.padding!="string"?0:F1(e,"xAxis",t,n.padding)},EL=(e,t)=>{var n=ei(e,t);return n==null||typeof n.padding!="string"?0:F1(e,"yAxis",t,n.padding)},IL=pe(Zr,CL,(e,t)=>{var n,i;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((n=a.left)!==null&&n!==void 0?n:0)+t,right:((i=a.right)!==null&&i!==void 0?i:0)+t}}),PL=pe(ei,EL,(e,t)=>{var n,i;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((n=a.top)!==null&&n!==void 0?n:0)+t,bottom:((i=a.bottom)!==null&&i!==void 0?i:0)+t}}),TL=pe([on,IL,Jl,Ql,(e,t,n)=>n],(e,t,n,i,a)=>{var{padding:s}=i;return a?[s.left,n.width-s.right]:[e.left+t.left,e.left+e.width-t.right]}),OL=pe([on,ot,PL,Jl,Ql,(e,t,n)=>n],(e,t,n,i,a,s)=>{var{padding:o}=a;return s?[i.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-n.bottom,e.top+n.top]:[e.top+n.top,e.top+e.height-n.bottom]}),Rs=(e,t,n,i)=>{var a;switch(t){case"xAxis":return TL(e,n,i);case"yAxis":return OL(e,n,i);case"zAxis":return(a=ch(e,n))===null||a===void 0?void 0:a.range;case"angleAxis":return w1(e);case"radiusAxis":return S1(e,n);default:return}},q1=pe([qt,Rs],cc),Oa=pe([qt,Ta,kL,q1],Sh);pe([zs,gc,$t],cL);function U1(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var yc=(e,t)=>t,vc=(e,t,n)=>n,DL=pe(Xl,yc,vc,(e,t,n)=>e.filter(i=>i.orientation===t).filter(i=>i.mirror===n).sort(U1)),_L=pe(Gl,yc,vc,(e,t,n)=>e.filter(i=>i.orientation===t).filter(i=>i.mirror===n).sort(U1)),H1=(e,t)=>({width:e.width,height:t.height}),ML=(e,t)=>{var n=typeof t.width=="number"?t.width:Cs;return{width:n,height:e.height}},Y1=pe(on,Zr,H1),LL=(e,t,n)=>{switch(t){case"top":return e.top;case"bottom":return n-e.bottom;default:return 0}},$L=(e,t,n)=>{switch(t){case"left":return e.left;case"right":return n-e.right;default:return 0}},zL=pe(Qr,on,DL,yc,vc,(e,t,n,i,a)=>{var s={},o;return n.forEach(l=>{var c=H1(t,l);o==null&&(o=LL(t,i,e));var d=i==="top"&&!a||i==="bottom"&&a;s[l.id]=o-Number(d)*c.height,o+=(d?-1:1)*c.height}),s}),RL=pe(Gr,on,_L,yc,vc,(e,t,n,i,a)=>{var s={},o;return n.forEach(l=>{var c=ML(t,l);o==null&&(o=$L(t,i,e));var d=i==="left"&&!a||i==="right"&&a;s[l.id]=o-Number(d)*c.width,o+=(d?-1:1)*c.width}),s}),BL=(e,t)=>{var n=Zr(e,t);if(n!=null)return zL(e,n.orientation,n.mirror)},WL=pe([on,Zr,BL,(e,t)=>t],(e,t,n,i)=>{if(t!=null){var a=n==null?void 0:n[i];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),FL=(e,t)=>{var n=ei(e,t);if(n!=null)return RL(e,n.orientation,n.mirror)},qL=pe([on,ei,FL,(e,t)=>t],(e,t,n,i)=>{if(t!=null){var a=n==null?void 0:n[i];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),K1=pe(on,ei,(e,t)=>{var n=typeof t.width=="number"?t.width:Cs;return{width:n,height:e.height}}),my=(e,t,n)=>{switch(t){case"xAxis":return Y1(e,n).width;case"yAxis":return K1(e,n).height;default:return}},V1=(e,t,n,i)=>{if(n!=null){var{allowDuplicatedCategory:a,type:s,dataKey:o}=n,l=gi(e,i),c=t.map(d=>d.value);if(o&&l&&s==="category"&&a&&zx(c))return c}},Ch=pe([ot,pc,qt,$t],V1),X1=(e,t,n,i)=>{if(!(n==null||n.dataKey==null)){var{type:a,scale:s}=n,o=gi(e,i);if(o&&(a==="number"||s!=="auto"))return t.map(l=>l.value)}},Eh=pe([ot,pc,$s,$t],X1),py=pe([ot,tL,Ta,Oa,Ch,Eh,Rs,kh,$t],(e,t,n,i,a,s,o,l,c)=>{if(t!=null){var d=gi(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:s,duplicateDomain:a,isCategorical:d,niceTicks:l,range:o,realScaleType:n,scale:i}}}),UL=(e,t,n,i,a,s,o,l,c)=>{if(!(t==null||i==null)){var d=gi(e,c),{type:u,ticks:f,tickCount:m}=t,p=n==="scaleBand"&&typeof i.bandwidth=="function"?i.bandwidth()/2:2,y=u==="category"&&i.bandwidth?i.bandwidth()/p:0;y=c==="angleAxis"&&s!=null&&s.length>=2?hn(s[0]-s[1])*2*y:y;var v=f||a;if(v){var g=v.map((b,x)=>{var N=o?o.indexOf(b):b;return{index:x,coordinate:i(N)+y,value:b,offset:y}});return g.filter(b=>Xt(b.coordinate))}return d&&l?l.map((b,x)=>({coordinate:i(b)+y,value:b,index:x,offset:y})).filter(b=>Xt(b.coordinate)):i.ticks?i.ticks(m).map(b=>({coordinate:i(b)+y,value:b,offset:y})):i.domain().map((b,x)=>({coordinate:i(b)+y,value:o?o[b]:b,index:x,offset:y}))}},G1=pe([ot,$s,Ta,Oa,kh,Rs,Ch,Eh,$t],UL),HL=(e,t,n,i,a,s,o)=>{if(!(t==null||n==null||i==null||i[0]===i[1])){var l=gi(e,o),{tickCount:c}=t,d=0;return d=o==="angleAxis"&&(i==null?void 0:i.length)>=2?hn(i[0]-i[1])*2*d:d,l&&s?s.map((u,f)=>({coordinate:n(u)+d,value:u,index:f,offset:d})):n.ticks?n.ticks(c).map(u=>({coordinate:n(u)+d,value:u,offset:d})):n.domain().map((u,f)=>({coordinate:n(u)+d,value:a?a[u]:u,index:f,offset:d}))}},di=pe([ot,$s,Oa,Rs,Ch,Eh,$t],HL),fi=pe(qt,Oa,(e,t)=>{if(!(e==null||t==null))return ul(ul({},e),{},{scale:t})}),YL=pe([qt,Ta,wh,q1],Sh);pe((e,t,n)=>ch(e,n),YL,(e,t)=>{if(!(e==null||t==null))return ul(ul({},e),{},{scale:t})});var KL=pe([ot,Xl,Gl],(e,t,n)=>{switch(e){case"horizontal":return t.some(i=>i.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(i=>i.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),Q1=e=>e.options.defaultTooltipEventType,J1=e=>e.options.validateTooltipEventTypes;function Z1(e,t,n){if(e==null)return t;var i=e?"axis":"item";return n==null?t:n.includes(i)?i:t}function Ih(e,t){var n=Q1(e),i=J1(e);return Z1(t,n,i)}function VL(e){return We(t=>Ih(t,e))}var ej=(e,t)=>{var n,i=Number(t);if(!(hr(i)||t==null))return i>=0?e==null||(n=e[i])===null||n===void 0?void 0:n.value:void 0},XL=e=>e.tooltip.settings,ci={active:!1,index:null,dataKey:void 0,coordinate:void 0},GL={itemInteraction:{click:ci,hover:ci},axisInteraction:{click:ci,hover:ci},keyboardInteraction:ci,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},tj=$n({name:"tooltip",initialState:GL,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:sn()},removeTooltipEntrySettings:{reducer(e,t){var n=Wr(e).tooltipItemPayloads.indexOf(t.payload);n>-1&&e.tooltipItemPayloads.splice(n,1)},prepare:sn()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:QL,removeTooltipEntrySettings:JL,setTooltipSettingsState:ZL,setActiveMouseOverItemIndex:nj,mouseLeaveItem:e8,mouseLeaveChart:rj,setActiveClickItemIndex:t8,setMouseOverAxisIndex:ij,setMouseClickAxisIndex:n8,setSyncInteraction:wd,setKeyboardInteraction:Sd}=tj.actions,r8=tj.reducer;function gy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function So(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gy(Object(n),!0).forEach(function(i){i8(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gy(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function i8(e,t,n){return(t=a8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a8(e){var t=s8(e,"string");return typeof t=="symbol"?t:t+""}function s8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function o8(e,t,n){return t==="axis"?n==="click"?e.axisInteraction.click:e.axisInteraction.hover:n==="click"?e.itemInteraction.click:e.itemInteraction.hover}function l8(e){return e.index!=null}var aj=(e,t,n,i)=>{if(t==null)return ci;var a=o8(e,t,n);if(a==null)return ci;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var s=e.settings.active===!0;if(l8(a)){if(s)return So(So({},a),{},{active:!0})}else if(i!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:i};return So(So({},ci),{},{coordinate:a.coordinate})},Ph=(e,t)=>{var n=e==null?void 0:e.index;if(n==null)return null;var i=Number(n);if(!Xt(i))return n;var a=0,s=1/0;return t.length>0&&(s=t.length-1),String(Math.max(a,Math.min(i,s)))},sj=(e,t,n,i,a,s,o,l)=>{if(!(s==null||l==null)){var c=o[0],d=c==null?void 0:l(c.positions,s);if(d!=null)return d;var u=a==null?void 0:a[Number(s)];if(u)switch(n){case"horizontal":return{x:u.coordinate,y:(i.top+t)/2};default:return{x:(i.left+e)/2,y:u.coordinate}}}},oj=(e,t,n,i)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return n==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&i!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(s=>{var o;return((o=s.settings)===null||o===void 0?void 0:o.dataKey)===a})},Bs=e=>e.options.tooltipPayloadSearcher,Da=e=>e.tooltip;function yy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function vy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?yy(Object(n),!0).forEach(function(i){c8(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yy(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function c8(e,t,n){return(t=u8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u8(e){var t=d8(e,"string");return typeof t=="symbol"?t:t+""}function d8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function f8(e,t){return e??t}var lj=(e,t,n,i,a,s,o)=>{if(!(t==null||s==null)){var{chartData:l,computedData:c,dataStartIndex:d,dataEndIndex:u}=n,f=[];return e.reduce((m,p)=>{var y,{dataDefinedOnItem:v,settings:g}=p,b=f8(v,l),x=Array.isArray(b)?q0(b,d,u):b,N=(y=g==null?void 0:g.dataKey)!==null&&y!==void 0?y:i,A=g==null?void 0:g.nameKey,C;if(i&&Array.isArray(x)&&!Array.isArray(x[0])&&o==="axis"?C=Rx(x,i,a):C=s(x,t,c,A),Array.isArray(C))C.forEach(O=>{var M=vy(vy({},g),{},{name:O.name,unit:O.unit,color:void 0,fill:void 0});m.push(eg({tooltipEntrySettings:M,dataKey:O.dataKey,payload:O.payload,value:kt(O.payload,O.dataKey),name:O.name}))});else{var w;m.push(eg({tooltipEntrySettings:g,dataKey:N,payload:C,value:kt(C,N),name:(w=kt(C,A))!==null&&w!==void 0?w:g==null?void 0:g.name}))}return m},f)}},Th=pe([un,ot,E1,nh,cn],W1),h8=pe([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),m8=pe([cn,Ia],uh),Ws=pe([h8,un,m8],dh,{memoizeOptions:{resultEqualityCheck:hc}}),p8=pe([Ws],e=>e.filter(dc)),g8=pe([Ws],fh,{memoizeOptions:{resultEqualityCheck:hc}}),_a=pe([g8,bi],hh),y8=pe([p8,bi,un],k1),Oh=pe([_a,un,Ws],ph),cj=pe([un],gh),v8=pe([un],e=>e.allowDataOverflow),uj=pe([cj,v8],n1),x8=pe([Ws],e=>e.filter(dc)),b8=pe([y8,x8,Ms],D1),j8=pe([b8,bi,cn,uj],_1),w8=pe([Ws],P1),S8=pe([_a,un,w8,gc,cn],xh,{memoizeOptions:{resultEqualityCheck:fc}}),N8=pe([M1,cn,Ia],Pa),k8=pe([N8,cn],z1),A8=pe([L1,cn,Ia],Pa),C8=pe([A8,cn],R1),E8=pe([$1,cn,Ia],Pa),I8=pe([E8,cn],B1),P8=pe([k8,I8,C8],dl),T8=pe([un,cj,uj,j8,S8,P8,ot,cn],bh),dj=pe([un,ot,_a,Oh,Ms,cn,T8],jh),O8=pe([dj,un,Th],Nh),D8=pe([un,dj,O8,cn],Ah),fj=e=>{var t=cn(e),n=Ia(e),i=!1;return Rs(e,t,n,i)},hj=pe([un,fj],cc),mj=pe([un,Th,D8,hj],Sh),_8=pe([ot,Oh,un,cn],V1),M8=pe([ot,Oh,un,cn],X1),L8=(e,t,n,i,a,s,o,l)=>{if(t){var{type:c}=t,d=gi(e,l);if(i){var u=n==="scaleBand"&&i.bandwidth?i.bandwidth()/2:2,f=c==="category"&&i.bandwidth?i.bandwidth()/u:0;return f=l==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?hn(a[0]-a[1])*2*f:f,d&&o?o.map((m,p)=>({coordinate:i(m)+f,value:m,index:p,offset:f})):i.domain().map((m,p)=>({coordinate:i(m)+f,value:s?s[m]:m,index:p,offset:f}))}}},ti=pe([ot,un,Th,mj,fj,_8,M8,cn],L8),Dh=pe([Q1,J1,XL],(e,t,n)=>Z1(n.shared,e,t)),pj=e=>e.tooltip.settings.trigger,_h=e=>e.tooltip.settings.defaultIndex,xc=pe([Da,Dh,pj,_h],aj),hi=pe([xc,_a],Ph),gj=pe([ti,hi],ej),yj=pe([xc],e=>{if(e)return e.dataKey}),vj=pe([Da,Dh,pj,_h],oj),$8=pe([Gr,Qr,ot,on,ti,_h,vj,Bs],sj),z8=pe([xc,$8],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),R8=pe([xc],e=>e.active),B8=pe([vj,hi,bi,O1,gj,Bs,Dh],lj),W8=pe([B8],e=>{if(e!=null){var t=e.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(t))}});function xy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function by(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xy(Object(n),!0).forEach(function(i){F8(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xy(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function F8(e,t,n){return(t=q8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q8(e){var t=U8(e,"string");return typeof t=="symbol"?t:t+""}function U8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H8=()=>We(un),Y8=()=>{var e=H8(),t=We(ti),n=We(mj);return va(!e||!n?void 0:by(by({},e),{},{scale:n}),t)};function jy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function la(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jy(Object(n),!0).forEach(function(i){K8(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jy(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function K8(e,t,n){return(t=V8(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V8(e){var t=X8(e,"string");return typeof t=="symbol"?t:t+""}function X8(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var G8=(e,t,n,i)=>{var a=t.find(s=>s&&s.index===n);if(a){if(e==="horizontal")return{x:a.coordinate,y:i.chartY};if(e==="vertical")return{x:i.chartX,y:a.coordinate}}return{x:0,y:0}},Q8=(e,t,n,i)=>{var a=t.find(d=>d&&d.index===n);if(a){if(e==="centric"){var s=a.coordinate,{radius:o}=i;return la(la(la({},i),Zt(i.cx,i.cy,o,s)),{},{angle:s,radius:o})}var l=a.coordinate,{angle:c}=i;return la(la(la({},i),Zt(i.cx,i.cy,l,c)),{},{angle:c,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function J8(e,t){var{chartX:n,chartY:i}=e;return n>=t.left&&n<=t.left+t.width&&i>=t.top&&i<=t.top+t.height}var xj=(e,t,n,i,a)=>{var s,o=-1,l=(s=t==null?void 0:t.length)!==null&&s!==void 0?s:0;if(l<=1||e==null)return 0;if(i==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var c=0;c<l;c++){var d=c>0?n[c-1].coordinate:n[l-1].coordinate,u=n[c].coordinate,f=c>=l-1?n[0].coordinate:n[c+1].coordinate,m=void 0;if(hn(u-d)!==hn(f-u)){var p=[];if(hn(f-u)===hn(a[1]-a[0])){m=f;var y=u+a[1]-a[0];p[0]=Math.min(y,(y+d)/2),p[1]=Math.max(y,(y+d)/2)}else{m=d;var v=f+a[1]-a[0];p[0]=Math.min(u,(v+u)/2),p[1]=Math.max(u,(v+u)/2)}var g=[Math.min(u,(m+u)/2),Math.max(u,(m+u)/2)];if(e>g[0]&&e<=g[1]||e>=p[0]&&e<=p[1]){({index:o}=n[c]);break}}else{var b=Math.min(d,f),x=Math.max(d,f);if(e>(b+u)/2&&e<=(x+u)/2){({index:o}=n[c]);break}}}else if(t){for(var N=0;N<l;N++)if(N===0&&e<=(t[N].coordinate+t[N+1].coordinate)/2||N>0&&N<l-1&&e>(t[N].coordinate+t[N-1].coordinate)/2&&e<=(t[N].coordinate+t[N+1].coordinate)/2||N===l-1&&e>(t[N].coordinate+t[N-1].coordinate)/2){({index:o}=t[N]);break}}return o},Z8=()=>We(nh),Mh=(e,t)=>t,bj=(e,t,n)=>n,Lh=(e,t,n,i)=>i,e$=pe(ti,e=>ql(e,t=>t.coordinate)),$h=pe([Da,Mh,bj,Lh],aj),jj=pe([$h,_a],Ph),t$=(e,t,n)=>{if(t!=null){var i=Da(e);return t==="axis"?n==="hover"?i.axisInteraction.hover.dataKey:i.axisInteraction.click.dataKey:n==="hover"?i.itemInteraction.hover.dataKey:i.itemInteraction.click.dataKey}},wj=pe([Da,Mh,bj,Lh],oj),fl=pe([Gr,Qr,ot,on,ti,Lh,wj,Bs],sj),n$=pe([$h,fl],(e,t)=>{var n;return(n=e.coordinate)!==null&&n!==void 0?n:t}),Sj=pe([ti,jj],ej),r$=pe([wj,jj,bi,O1,Sj,Bs,Mh],lj),i$=pe([$h],e=>({isActive:e.active,activeIndex:e.index})),a$=(e,t,n,i,a,s,o)=>{if(!(!e||!n||!i||!a)&&J8(e,o)){var l=dO(e,t),c=xj(l,s,a,n,i),d=G8(t,a,c,e);return{activeIndex:String(c),activeCoordinate:d}}},s$=(e,t,n,i,a,s,o)=>{if(!(!e||!i||!a||!s||!n)){var l=QD(e,n);if(l){var c=fO(l,t),d=xj(c,o,s,i,a),u=Q8(t,s,d,l);return{activeIndex:String(d),activeCoordinate:u}}}},o$=(e,t,n,i,a,s,o,l)=>{if(!(!e||!t||!i||!a||!s))return t==="horizontal"||t==="vertical"?a$(e,t,i,a,s,o,l):s$(e,t,n,i,a,s,o)},l$=pe(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,n)=>n,(e,t,n)=>{if(t!=null){var i=e[t];if(i!=null)return n?i.panoramaElementId:i.elementId}}),c$=pe(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(i=>parseInt(i,10)).concat(Object.values(en)),n=Array.from(new Set(t));return n.sort((i,a)=>i-a)},{memoizeOptions:{resultEqualityCheck:G6}});function wy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Sy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?wy(Object(n),!0).forEach(function(i){u$(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):wy(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function u$(e,t,n){return(t=d$(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d$(e){var t=f$(e,"string");return typeof t=="symbol"?t:t+""}function f$(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var h$={},m$={zIndexMap:Object.values(en).reduce((e,t)=>Sy(Sy({},e),{},{[t]:{elementId:void 0,panoramaElementId:void 0,consumers:0}}),h$)},p$=new Set(Object.values(en));function g$(e){return p$.has(e)}var Nj=$n({name:"zIndex",initialState:m$,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]?e.zIndexMap[n].consumers+=1:e.zIndexMap[n]={consumers:1,elementId:void 0,panoramaElementId:void 0}},prepare:sn()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(e.zIndexMap[n].consumers-=1,e.zIndexMap[n].consumers<=0&&!g$(n)&&delete e.zIndexMap[n])},prepare:sn()},registerZIndexPortalId:{reducer:(e,t)=>{var{zIndex:n,elementId:i,isPanorama:a}=t.payload;e.zIndexMap[n]?a?e.zIndexMap[n].panoramaElementId=i:e.zIndexMap[n].elementId=i:e.zIndexMap[n]={consumers:0,elementId:a?void 0:i,panoramaElementId:a?i:void 0}},prepare:sn()},unregisterZIndexPortalId:{reducer:(e,t)=>{var{zIndex:n}=t.payload;e.zIndexMap[n]&&(t.payload.isPanorama?e.zIndexMap[n].panoramaElementId=void 0:e.zIndexMap[n].elementId=void 0)},prepare:sn()}}}),{registerZIndexPortal:y$,unregisterZIndexPortal:v$,registerZIndexPortalId:x$,unregisterZIndexPortalId:b$}=Nj.actions,j$=Nj.reducer;function zn(e){var{zIndex:t,children:n}=e,i=zO(),a=i&&t!==void 0&&t!==0,s=kn(),o=Lt();h.useLayoutEffect(()=>a?(o(y$({zIndex:t})),()=>{o(v$({zIndex:t}))}):Vi,[o,t,a]);var l=We(d=>l$(d,t,s));if(!a)return n;if(!l)return null;var c=document.getElementById(l);return c?$d.createPortal(n,c):null}function Nd(){return Nd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Nd.apply(null,arguments)}function Ny(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function No(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ny(Object(n),!0).forEach(function(i){w$(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ny(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function w$(e,t,n){return(t=S$(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function S$(e){var t=N$(e,"string");return typeof t=="symbol"?t:t+""}function N$(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function k$(e){var{cursor:t,cursorComp:n,cursorProps:i}=e;return h.isValidElement(t)?h.cloneElement(t,i):h.createElement(n,i)}function A$(e){var t,{coordinate:n,payload:i,index:a,offset:s,tooltipAxisBandSize:o,layout:l,cursor:c,tooltipEventType:d,chartName:u}=e,f=n,m=i,p=a;if(!c||!f||u!=="ScatterChart"&&d!=="axis")return null;var y,v,g;if(u==="ScatterChart")y=f,v=hD,g=en.cursorLine;else if(u==="BarChart")y=mD(l,f,s,o),v=hb,g=en.cursorRectangle;else if(l==="radial"&&Fx(f)){var{cx:b,cy:x,radius:N,startAngle:A,endAngle:C}=pb(f);y={cx:b,cy:x,startAngle:A,endAngle:C,innerRadius:N,outerRadius:N},v=yb,g=en.cursorLine}else y={points:t_(l,f,s)},v=If,g=en.cursorLine;var w=typeof c=="object"&&"className"in c?c.className:void 0,O=No(No(No(No({stroke:"#ccc",pointerEvents:"none"},s),y),Ri(c)),{},{payload:m,payloadIndex:p,className:ut("recharts-tooltip-cursor",w)});return h.createElement(zn,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:g},h.createElement(k$,{cursor:c,cursorComp:v,cursorProps:O}))}function C$(e){var t=Y8(),n=nb(),i=Es(),a=Z8();return t==null||n==null||i==null||a==null?null:h.createElement(A$,Nd({},e,{offset:n,layout:i,tooltipAxisBandSize:t,chartName:a}))}var kj=h.createContext(null),E$=()=>h.useContext(kj),Aj={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function a(c,d,u){this.fn=c,this.context=d,this.once=u||!1}function s(c,d,u,f,m){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new a(u,f||c,m),y=n?n+d:d;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],p]:c._events[y].push(p):(c._events[y]=p,c._eventsCount++),c}function o(c,d){--c._eventsCount===0?c._events=new i:delete c._events[d]}function l(){this._events=new i,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],u,f;if(this._eventsCount===0)return d;for(f in u=this._events)t.call(u,f)&&d.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(u)):d},l.prototype.listeners=function(d){var u=n?n+d:d,f=this._events[u];if(!f)return[];if(f.fn)return[f.fn];for(var m=0,p=f.length,y=new Array(p);m<p;m++)y[m]=f[m].fn;return y},l.prototype.listenerCount=function(d){var u=n?n+d:d,f=this._events[u];return f?f.fn?1:f.length:0},l.prototype.emit=function(d,u,f,m,p,y){var v=n?n+d:d;if(!this._events[v])return!1;var g=this._events[v],b=arguments.length,x,N;if(g.fn){switch(g.once&&this.removeListener(d,g.fn,void 0,!0),b){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,f),!0;case 4:return g.fn.call(g.context,u,f,m),!0;case 5:return g.fn.call(g.context,u,f,m,p),!0;case 6:return g.fn.call(g.context,u,f,m,p,y),!0}for(N=1,x=new Array(b-1);N<b;N++)x[N-1]=arguments[N];g.fn.apply(g.context,x)}else{var A=g.length,C;for(N=0;N<A;N++)switch(g[N].once&&this.removeListener(d,g[N].fn,void 0,!0),b){case 1:g[N].fn.call(g[N].context);break;case 2:g[N].fn.call(g[N].context,u);break;case 3:g[N].fn.call(g[N].context,u,f);break;case 4:g[N].fn.call(g[N].context,u,f,m);break;default:if(!x)for(C=1,x=new Array(b-1);C<b;C++)x[C-1]=arguments[C];g[N].fn.apply(g[N].context,x)}}return!0},l.prototype.on=function(d,u,f){return s(this,d,u,f,!1)},l.prototype.once=function(d,u,f){return s(this,d,u,f,!0)},l.prototype.removeListener=function(d,u,f,m){var p=n?n+d:d;if(!this._events[p])return this;if(!u)return o(this,p),this;var y=this._events[p];if(y.fn)y.fn===u&&(!m||y.once)&&(!f||y.context===f)&&o(this,p);else{for(var v=0,g=[],b=y.length;v<b;v++)(y[v].fn!==u||m&&!y[v].once||f&&y[v].context!==f)&&g.push(y[v]);g.length?this._events[p]=g.length===1?g[0]:g:o(this,p)}return this},l.prototype.removeAllListeners=function(d){var u;return d?(u=n?n+d:d,this._events[u]&&o(this,u)):(this._events=new i,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,e.exports=l})(Aj);var I$=Aj.exports;const P$=Pr(I$);var bs=new P$,kd="recharts.syncEvent.tooltip",ky="recharts.syncEvent.brush";function zh(e,t){if(t){var n=Number.parseInt(t,10);if(!hr(n))return e==null?void 0:e[n]}}var T$={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},Cj=$n({name:"options",initialState:T$,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),O$=Cj.reducer,{createEventEmitter:D$}=Cj.actions;function _$(e){return e.tooltip.syncInteraction}var M$={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},Ej=$n({name:"chartData",initialState:M$,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:n,endIndex:i}=t.payload;n!=null&&(e.dataStartIndex=n),i!=null&&(e.dataEndIndex=i)}}}),{setChartData:Ay,setDataStartEndIndexes:L$,setComputedData:v5}=Ej.actions,$$=Ej.reducer,z$=["x","y"];function Cy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function ca(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Cy(Object(n),!0).forEach(function(i){R$(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Cy(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function R$(e,t,n){return(t=B$(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function B$(e){var t=W$(e,"string");return typeof t=="symbol"?t:t+""}function W$(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function F$(e,t){if(e==null)return{};var n,i,a=q$(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function q$(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function U$(){var e=We(rh),t=We(ih),n=Lt(),i=We(x1),a=We(ti),s=Es(),o=Zl(),l=We(c=>c.rootProps.className);h.useEffect(()=>{if(e==null)return Vi;var c=(d,u,f)=>{if(t!==f&&e===d){if(i==="index"){var m;if(o&&u!==null&&u!==void 0&&(m=u.payload)!==null&&m!==void 0&&m.coordinate&&u.payload.sourceViewBox){var p=u.payload.coordinate,{x:y,y:v}=p,g=F$(p,z$),{x:b,y:x,width:N,height:A}=u.payload.sourceViewBox,C=ca(ca({},g),{},{x:o.x+(N?(y-b)/N:0)*o.width,y:o.y+(A?(v-x)/A:0)*o.height});n(ca(ca({},u),{},{payload:ca(ca({},u.payload),{},{coordinate:C})}))}else n(u);return}if(a!=null){var w;if(typeof i=="function"){var O={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},M=i(a,O);w=a[M]}else i==="value"&&(w=a.find(V=>String(V.value)===u.payload.label));var{coordinate:B}=u.payload;if(w==null||u.payload.active===!1||B==null||o==null){n(wd({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:z,y:j}=B,k=Math.min(z,o.x+o.width),L=Math.min(j,o.y+o.height),T={x:s==="horizontal"?w.coordinate:k,y:s==="horizontal"?L:w.coordinate},$=wd({active:u.payload.active,coordinate:T,dataKey:u.payload.dataKey,index:String(w.index),label:u.payload.label,sourceViewBox:u.payload.sourceViewBox});n($)}}};return bs.on(kd,c),()=>{bs.off(kd,c)}},[l,n,t,e,i,a,s,o])}function H$(){var e=We(rh),t=We(ih),n=Lt();h.useEffect(()=>{if(e==null)return Vi;var i=(a,s,o)=>{t!==o&&e===a&&n(L$(s))};return bs.on(ky,i),()=>{bs.off(ky,i)}},[n,t,e])}function Y$(){var e=Lt();h.useEffect(()=>{e(D$())},[e]),U$(),H$()}function K$(e,t,n,i,a,s){var o=We(p=>t$(p,e,t)),l=We(ih),c=We(rh),d=We(x1),u=We(_$),f=u==null?void 0:u.active,m=Zl();h.useEffect(()=>{if(!f&&c!=null&&l!=null){var p=wd({active:s,coordinate:n,dataKey:o,index:a,label:typeof i=="number"?String(i):i,sourceViewBox:m});bs.emit(kd,c,p,l)}},[f,n,o,a,i,l,c,d,s,m])}function Ey(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Iy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ey(Object(n),!0).forEach(function(i){V$(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ey(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function V$(e,t,n){return(t=X$(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X$(e){var t=G$(e,"string");return typeof t=="symbol"?t:t+""}function G$(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q$(e){return e.dataKey}function J$(e,t){return h.isValidElement(e)?h.cloneElement(e,t):typeof e=="function"?h.createElement(e,t):h.createElement(HO,t)}var Py=[],Z$={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!yi.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function Ad(e){var t,n,i=pn(e,Z$),{active:a,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:c,filterNull:d,isAnimationActive:u,offset:f,payloadUniqBy:m,position:p,reverseDirection:y,useTranslate3d:v,wrapperStyle:g,cursor:b,shared:x,trigger:N,defaultIndex:A,portal:C,axisId:w}=i,O=Lt(),M=typeof A=="number"?String(A):A;h.useEffect(()=>{O(ZL({shared:x,trigger:N,axisId:w,active:a,defaultIndex:M}))},[O,x,N,w,a,M]);var B=Zl(),z=lb(),j=VL(x),{activeIndex:k,isActive:L}=(t=We(K=>i$(K,j,N,M)))!==null&&t!==void 0?t:{},T=We(K=>r$(K,j,N,M)),$=We(K=>Sj(K,j,N,M)),V=We(K=>n$(K,j,N,M)),G=T,ne=E$(),U=(n=a??L)!==null&&n!==void 0?n:!1,[I,P]=ZP([G,U]),D=j==="axis"?$:void 0;K$(j,N,V,D,k,U);var S=C??ne;if(S==null||B==null||j==null)return null;var _=G??Py;U||(_=Py),d&&_.length&&(_=yP(_.filter(K=>K.value!=null&&(K.hide!==!0||i.includeHidden)),m,Q$));var H=_.length>0,q=h.createElement(JO,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:u,active:U,coordinate:V,hasPayload:H,offset:f,position:p,reverseDirection:y,useTranslate3d:v,viewBox:B,wrapperStyle:g,lastBoundingBox:I,innerRef:P,hasPortalFromProps:!!C},J$(c,Iy(Iy({},i),{},{payload:_,label:D,active:U,activeIndex:k,coordinate:V,accessibilityLayer:z})));return h.createElement(h.Fragment,null,$d.createPortal(q,S),U&&h.createElement(C$,{cursor:b,tooltipEventType:j,coordinate:V,payload:_,index:k}))}var Qi=e=>null;Qi.displayName="Cell";function e4(e,t,n){return(t=t4(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function t4(e){var t=n4(e,"string");return typeof t=="symbol"?t:t+""}function n4(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class r4{constructor(t){e4(this,"cache",new Map),this.maxSize=t}get(t){var n=this.cache.get(t);return n!==void 0&&(this.cache.delete(t),this.cache.set(t,n)),n}set(t,n){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var i=this.cache.keys().next().value;this.cache.delete(i)}this.cache.set(t,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function Ty(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function i4(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Ty(Object(n),!0).forEach(function(i){a4(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ty(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function a4(e,t,n){return(t=s4(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s4(e){var t=o4(e,"string");return typeof t=="symbol"?t:t+""}function o4(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var l4={cacheSize:2e3,enableCache:!0},Ij=i4({},l4),Oy=new r4(Ij.cacheSize),c4={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},Dy="recharts_measurement_span";function u4(e,t){var n=t.fontSize||"",i=t.fontFamily||"",a=t.fontWeight||"",s=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(n,"|").concat(i,"|").concat(a,"|").concat(s,"|").concat(o,"|").concat(l)}var _y=(e,t)=>{try{var n=document.getElementById(Dy);n||(n=document.createElement("span"),n.setAttribute("id",Dy),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,c4,t),n.textContent="".concat(e);var i=n.getBoundingClientRect();return{width:i.width,height:i.height}}catch{return{width:0,height:0}}},os=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||yi.isSsr)return{width:0,height:0};if(!Ij.enableCache)return _y(t,n);var i=u4(t,n),a=Oy.get(i);if(a)return a;var s=_y(t,n);return Oy.set(i,s),s},My=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Ly=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,d4=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,f4=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,Pj={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},h4=Object.keys(Pj),da="NaN";function m4(e,t){return e*Pj[t]}class On{static parse(t){var n,[,i,a]=(n=f4.exec(t))!==null&&n!==void 0?n:[];return new On(parseFloat(i),a??"")}constructor(t,n){this.num=t,this.unit=n,this.num=t,this.unit=n,hr(t)&&(this.unit=""),n!==""&&!d4.test(n)&&(this.num=NaN,this.unit=""),h4.includes(n)&&(this.num=m4(t,n),this.unit="px")}add(t){return this.unit!==t.unit?new On(NaN,""):new On(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new On(NaN,""):new On(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new On(NaN,""):new On(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new On(NaN,""):new On(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return hr(this.num)}}function Tj(e){if(e.includes(da))return da;for(var t=e;t.includes("*")||t.includes("/");){var n,[,i,a,s]=(n=My.exec(t))!==null&&n!==void 0?n:[],o=On.parse(i??""),l=On.parse(s??""),c=a==="*"?o.multiply(l):o.divide(l);if(c.isNaN())return da;t=t.replace(My,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,[,u,f,m]=(d=Ly.exec(t))!==null&&d!==void 0?d:[],p=On.parse(u??""),y=On.parse(m??""),v=f==="+"?p.add(y):p.subtract(y);if(v.isNaN())return da;t=t.replace(Ly,v.toString())}return t}var $y=/\(([^()]*)\)/;function p4(e){for(var t=e,n;(n=$y.exec(t))!=null;){var[,i]=n;t=t.replace($y,Tj(i))}return t}function g4(e){var t=e.replace(/\s+/g,"");return t=p4(t),t=Tj(t),t}function y4(e){try{return g4(e)}catch{return da}}function wu(e){var t=y4(e.slice(5,-1));return t===da?"":t}var v4=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],x4=["dx","dy","angle","className","breakAll"];function Cd(){return Cd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Cd.apply(null,arguments)}function zy(e,t){if(e==null)return{};var n,i,a=b4(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function b4(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}var Oj=/[ \f\n\r\t\v\u2028\u2029]+/,Dj=e=>{var{children:t,breakAll:n,style:i}=e;try{var a=[];Mt(t)||(n?a=t.toString().split(""):a=t.toString().split(Oj));var s=a.map(l=>({word:l,width:os(l,i).width})),o=n?0:os(" ",i).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function j4(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var _j=(e,t,n,i)=>e.reduce((a,s)=>{var{word:o,width:l}=s,c=a[a.length-1];if(c&&l!=null&&(t==null||i||c.width+l+n<Number(t)))c.words.push(o),c.width+=l+n;else{var d={words:[o],width:l};a.push(d)}return a},[]),Mj=e=>e.reduce((t,n)=>t.width>n.width?t:n),w4="…",Ry=(e,t,n,i,a,s,o,l)=>{var c=e.slice(0,t),d=Dj({breakAll:n,style:i,children:c+w4});if(!d)return[!1,[]];var u=_j(d.wordsWithComputedWidth,s,o,l),f=u.length>a||Mj(u).width>Number(s);return[f,u]},S4=(e,t,n,i,a)=>{var{maxLines:s,children:o,style:l,breakAll:c}=e,d=Be(s),u=String(o),f=_j(t,i,n,a);if(!d||a)return f;var m=f.length>s||Mj(f).width>Number(i);if(!m)return f;for(var p=0,y=u.length-1,v=0,g;p<=y&&v<=u.length-1;){var b=Math.floor((p+y)/2),x=b-1,[N,A]=Ry(u,x,c,l,s,i,n,a),[C]=Ry(u,b,c,l,s,i,n,a);if(!N&&!C&&(p=b+1),N&&C&&(y=b-1),!N&&C){g=A;break}v++}return g||f},By=e=>{var t=Mt(e)?[]:e.toString().split(Oj);return[{words:t,width:void 0}]},N4=e=>{var{width:t,scaleToFit:n,children:i,style:a,breakAll:s,maxLines:o}=e;if((t||n)&&!yi.isSsr){var l,c,d=Dj({breakAll:s,children:i,style:a});if(d){var{wordsWithComputedWidth:u,spaceWidth:f}=d;l=u,c=f}else return By(i);return S4({breakAll:s,children:i,maxLines:o,style:a},l,c,t,!!n)}return By(i)},Lj="#808080",k4={breakAll:!1,capHeight:"0.71em",fill:Lj,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},bc=h.forwardRef((e,t)=>{var n=pn(e,k4),{x:i,y:a,lineHeight:s,capHeight:o,fill:l,scaleToFit:c,textAnchor:d,verticalAnchor:u}=n,f=zy(n,v4),m=h.useMemo(()=>N4({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:c,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,c,f.style,f.width]),{dx:p,dy:y,angle:v,className:g,breakAll:b}=f,x=zy(f,x4);if(!Cr(i)||!Cr(a)||m.length===0)return null;var N=Number(i)+(Be(p)?p:0),A=Number(a)+(Be(y)?y:0);if(!Xt(N)||!Xt(A))return null;var C;switch(u){case"start":C=wu("calc(".concat(o,")"));break;case"middle":C=wu("calc(".concat((m.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:C=wu("calc(".concat(m.length-1," * -").concat(s,")"));break}var w=[];if(c){var O=m[0].width,{width:M}=f;w.push("scale(".concat(Be(M)&&Be(O)?M/O:1,")"))}return v&&w.push("rotate(".concat(v,", ").concat(N,", ").concat(A,")")),w.length&&(x.transform=w.join(" ")),h.createElement("text",Cd({},In(x),{ref:t,x:N,y:A,className:ut("recharts-text",g),textAnchor:d,fill:l.includes("url")?Lj:l}),m.map((B,z)=>{var j=B.words.join(b?"":" ");return h.createElement("tspan",{x:N,dy:z===0?C:s,key:"".concat(j,"-").concat(z)},j)}))});bc.displayName="Text";var A4=["labelRef"];function C4(e,t){if(e==null)return{};var n,i,a=E4(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function E4(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function Wy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Vt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Wy(Object(n),!0).forEach(function(i){I4(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Wy(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function I4(e,t,n){return(t=P4(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function P4(e){var t=T4(e,"string");return typeof t=="symbol"?t:t+""}function T4(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zr(){return zr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},zr.apply(null,arguments)}var $j=h.createContext(null),O4=e=>{var{x:t,y:n,upperWidth:i,lowerWidth:a,width:s,height:o,children:l}=e,c=h.useMemo(()=>({x:t,y:n,upperWidth:i,lowerWidth:a,width:s,height:o}),[t,n,i,a,s,o]);return h.createElement($j.Provider,{value:c},l)},zj=()=>{var e=h.useContext($j),t=Zl();return e||tb(t)},D4=h.createContext(null),_4=()=>{var e=h.useContext(D4),t=We(N1);return e||t},M4=e=>{var{value:t,formatter:n}=e,i=Mt(e.children)?t:e.children;return typeof n=="function"?n(i):i},Rh=e=>e!=null&&typeof e=="function",L4=(e,t)=>{var n=hn(t-e),i=Math.min(Math.abs(t-e),360);return n*i},$4=(e,t,n,i,a)=>{var{offset:s,className:o}=e,{cx:l,cy:c,innerRadius:d,outerRadius:u,startAngle:f,endAngle:m,clockWise:p}=a,y=(d+u)/2,v=L4(f,m),g=v>=0?1:-1,b,x;switch(t){case"insideStart":b=f+g*s,x=p;break;case"insideEnd":b=m-g*s,x=!p;break;case"end":b=m+g*s,x=p;break;default:throw new Error("Unsupported position ".concat(t))}x=v<=0?x:!x;var N=Zt(l,c,y,b),A=Zt(l,c,y,b+(x?1:-1)*359),C="M".concat(N.x,",").concat(N.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(x?0:1,`,
    `).concat(A.x,",").concat(A.y),w=Mt(e.id)?us("recharts-radial-line-"):e.id;return h.createElement("text",zr({},i,{dominantBaseline:"central",className:ut("recharts-radial-bar-label",o)}),h.createElement("defs",null,h.createElement("path",{id:w,d:C})),h.createElement("textPath",{xlinkHref:"#".concat(w)},n))},z4=(e,t,n)=>{var{cx:i,cy:a,innerRadius:s,outerRadius:o,startAngle:l,endAngle:c}=e,d=(l+c)/2;if(n==="outside"){var{x:u,y:f}=Zt(i,a,o+t,d);return{x:u,y:f,textAnchor:u>=i?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:i,y:a,textAnchor:"middle",verticalAnchor:"end"};var m=(s+o)/2,{x:p,y}=Zt(i,a,m,d);return{x:p,y,textAnchor:"middle",verticalAnchor:"middle"}},Ed=e=>"cx"in e&&Be(e.cx),R4=(e,t)=>{var{parentViewBox:n,offset:i,position:a}=e,s;n!=null&&!Ed(n)&&(s=n);var{x:o,y:l,upperWidth:c,lowerWidth:d,height:u}=t,f=o,m=o+(c-d)/2,p=(f+m)/2,y=(c+d)/2,v=f+c/2,g=u>=0?1:-1,b=g*i,x=g>0?"end":"start",N=g>0?"start":"end",A=c>=0?1:-1,C=A*i,w=A>0?"end":"start",O=A>0?"start":"end";if(a==="top"){var M={x:f+c/2,y:l-b,textAnchor:"middle",verticalAnchor:x};return Vt(Vt({},M),s?{height:Math.max(l-s.y,0),width:c}:{})}if(a==="bottom"){var B={x:m+d/2,y:l+u+b,textAnchor:"middle",verticalAnchor:N};return Vt(Vt({},B),s?{height:Math.max(s.y+s.height-(l+u),0),width:d}:{})}if(a==="left"){var z={x:p-C,y:l+u/2,textAnchor:w,verticalAnchor:"middle"};return Vt(Vt({},z),s?{width:Math.max(z.x-s.x,0),height:u}:{})}if(a==="right"){var j={x:p+y+C,y:l+u/2,textAnchor:O,verticalAnchor:"middle"};return Vt(Vt({},j),s?{width:Math.max(s.x+s.width-j.x,0),height:u}:{})}var k=s?{width:y,height:u}:{};return a==="insideLeft"?Vt({x:p+C,y:l+u/2,textAnchor:O,verticalAnchor:"middle"},k):a==="insideRight"?Vt({x:p+y-C,y:l+u/2,textAnchor:w,verticalAnchor:"middle"},k):a==="insideTop"?Vt({x:f+c/2,y:l+b,textAnchor:"middle",verticalAnchor:N},k):a==="insideBottom"?Vt({x:m+d/2,y:l+u-b,textAnchor:"middle",verticalAnchor:x},k):a==="insideTopLeft"?Vt({x:f+C,y:l+b,textAnchor:O,verticalAnchor:N},k):a==="insideTopRight"?Vt({x:f+c-C,y:l+b,textAnchor:w,verticalAnchor:N},k):a==="insideBottomLeft"?Vt({x:m+C,y:l+u-b,textAnchor:O,verticalAnchor:x},k):a==="insideBottomRight"?Vt({x:m+d-C,y:l+u-b,textAnchor:w,verticalAnchor:x},k):a&&typeof a=="object"&&(Be(a.x)||qr(a.x))&&(Be(a.y)||qr(a.y))?Vt({x:o+Sn(a.x,y),y:l+Sn(a.y,u),textAnchor:"end",verticalAnchor:"end"},k):Vt({x:v,y:l+u/2,textAnchor:"middle",verticalAnchor:"middle"},k)},B4={offset:5,zIndex:en.label};function li(e){var t=pn(e,B4),{viewBox:n,position:i,value:a,children:s,content:o,className:l="",textBreakAll:c,labelRef:d}=t,u=_4(),f=zj(),m=i==="center"?f:u??f,p,y,v;if(n==null?p=m:Ed(n)?p=n:p=tb(n),!p||Mt(a)&&Mt(s)&&!h.isValidElement(o)&&typeof o!="function")return null;var g=Vt(Vt({},t),{},{viewBox:p});if(h.isValidElement(o)){var{labelRef:b}=g,x=C4(g,A4);return h.cloneElement(o,x)}if(typeof o=="function"){if(y=h.createElement(o,g),h.isValidElement(y))return y}else y=M4(t);var N=In(t);if(Ed(p)){if(i==="insideStart"||i==="insideEnd"||i==="end")return $4(t,i,y,N,p);v=z4(p,t.offset,t.position)}else v=R4(t,p);return h.createElement(zn,{zIndex:t.zIndex},h.createElement(bc,zr({ref:d,className:ut("recharts-label",l)},N,v,{textAnchor:j4(N.textAnchor)?N.textAnchor:v.textAnchor,breakAll:c}),y))}li.displayName="Label";var W4=(e,t,n)=>{if(!e)return null;var i={viewBox:t,labelRef:n};return e===!0?h.createElement(li,zr({key:"label-implicit"},i)):Cr(e)?h.createElement(li,zr({key:"label-implicit",value:e},i)):h.isValidElement(e)?e.type===li?h.cloneElement(e,Vt({key:"label-implicit"},i)):h.createElement(li,zr({key:"label-implicit",content:e},i)):Rh(e)?h.createElement(li,zr({key:"label-implicit",content:e},i)):e&&typeof e=="object"?h.createElement(li,zr({},e,{key:"label-implicit"},i)):null};function F4(e){var{label:t,labelRef:n}=e,i=zj();return W4(t,i,n)||null}var Rj={},Bj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return n[n.length-1]}e.last=t})(Bj);var Wj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return Array.isArray(n)?n:Array.from(n)}e.toArray=t})(Wj);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Bj,n=Wj,i=Wl;function a(s){if(i.isArrayLike(s))return t.last(n.toArray(s))}e.last=a})(Rj);var q4=Rj.last;const U4=Pr(q4);var H4=["valueAccessor"],Y4=["dataKey","clockWise","id","textBreakAll","zIndex"];function hl(){return hl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},hl.apply(null,arguments)}function Fy(e,t){if(e==null)return{};var n,i,a=K4(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function K4(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}var V4=e=>Array.isArray(e.value)?U4(e.value):e.value,Fj=h.createContext(void 0),qj=Fj.Provider,Uj=h.createContext(void 0),X4=Uj.Provider;function G4(){return h.useContext(Fj)}function Q4(){return h.useContext(Uj)}function To(e){var{valueAccessor:t=V4}=e,n=Fy(e,H4),{dataKey:i,clockWise:a,id:s,textBreakAll:o,zIndex:l}=n,c=Fy(n,Y4),d=G4(),u=Q4(),f=d||u;return!f||!f.length?null:h.createElement(zn,{zIndex:l??en.label},h.createElement(mn,{className:"recharts-label-list"},f.map((m,p)=>{var y,v=Mt(i)?t(m,p):kt(m&&m.payload,i),g=Mt(s)?{}:{id:"".concat(s,"-").concat(p)};return h.createElement(li,hl({key:"label-".concat(p)},In(m),c,g,{fill:(y=n.fill)!==null&&y!==void 0?y:m.fill,parentViewBox:m.parentViewBox,value:v,textBreakAll:o,viewBox:m.viewBox,index:p,zIndex:0}))})))}To.displayName="LabelList";function Bh(e){var{label:t}=e;return t?t===!0?h.createElement(To,{key:"labelList-implicit"}):h.isValidElement(t)||Rh(t)?h.createElement(To,{key:"labelList-implicit",content:t}):typeof t=="object"?h.createElement(To,hl({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function Id(){return Id=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Id.apply(null,arguments)}var Hj=e=>{var{cx:t,cy:n,r:i,className:a}=e,s=ut("recharts-dot",a);return Be(t)&&Be(n)&&Be(i)?h.createElement("circle",Id({},Kn(e),cf(e),{className:s,cx:t,cy:n,r:i})):null},Yj=e=>e.graphicalItems.polarItems,J4=pe([$t,Ls],uh),jc=pe([Yj,qt,J4],dh),Z4=pe([jc],fh),wc=pe([Z4,Zf],hh),ez=pe([wc,qt,jc],ph);pe([wc,qt,jc],(e,t,n)=>n.length>0?e.flatMap(i=>n.flatMap(a=>{var s,o=kt(i,(s=t.dataKey)!==null&&s!==void 0?s:a.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(i=>({value:kt(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})));var qy=()=>{},tz=pe([wc,qt,jc,gc,$t],xh),nz=pe([qt,yh,vh,qy,tz,qy,ot,$t],bh),Kj=pe([qt,ot,wc,ez,Ms,$t,nz],jh),rz=pe([Kj,qt,Ta],Nh);pe([qt,Kj,rz,$t],Ah);var iz={radiusAxis:{},angleAxis:{}},Vj=$n({name:"polarAxis",initialState:iz,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:x5,removeRadiusAxis:b5,addAngleAxis:j5,removeAngleAxis:w5}=Vj.actions,az=Vj.reducer;function Uy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Hy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Uy(Object(n),!0).forEach(function(i){sz(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uy(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function sz(e,t,n){return(t=oz(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oz(e){var t=lz(e,"string");return typeof t=="symbol"?t:t+""}function lz(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var cz=(e,t)=>t,Wh=pe([Yj,cz],(e,t)=>e.filter(n=>n.type==="pie").find(n=>n.id===t)),uz=[],Fh=(e,t,n)=>(n==null?void 0:n.length)===0?uz:n,Xj=pe([Zf,Wh,Fh],(e,t,n)=>{var{chartData:i}=e;if(t!=null){var a;if((t==null?void 0:t.data)!=null&&t.data.length>0?a=t.data:a=i,(!a||!a.length)&&n!=null&&(a=n.map(s=>Hy(Hy({},t.presentationProps),s.props))),a!=null)return a}}),dz=pe([Xj,Wh,Fh],(e,t,n)=>{if(!(e==null||t==null))return e.map((i,a)=>{var s,o=kt(i,t.nameKey,t.name),l;return n!=null&&(s=n[a])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=n[a].props.fill:typeof i=="object"&&i!=null&&"fill"in i?l=i.fill:l=t.fill,{value:ka(o,t.dataKey),color:l,payload:i,type:t.legendType}})}),fz=pe([Xj,Wh,Fh,on],(e,t,n,i)=>{if(!(t==null||e==null))return cR({offset:i,pieSettings:t,displayedData:e,cells:n})}),Gj={exports:{}},bt={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qh=Symbol.for("react.transitional.element"),Uh=Symbol.for("react.portal"),Sc=Symbol.for("react.fragment"),Nc=Symbol.for("react.strict_mode"),kc=Symbol.for("react.profiler"),Ac=Symbol.for("react.consumer"),Cc=Symbol.for("react.context"),Ec=Symbol.for("react.forward_ref"),Ic=Symbol.for("react.suspense"),Pc=Symbol.for("react.suspense_list"),Tc=Symbol.for("react.memo"),Oc=Symbol.for("react.lazy"),hz=Symbol.for("react.view_transition"),mz=Symbol.for("react.client.reference");function sr(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case qh:switch(e=e.type,e){case Sc:case kc:case Nc:case Ic:case Pc:case hz:return e;default:switch(e=e&&e.$$typeof,e){case Cc:case Ec:case Oc:case Tc:return e;case Ac:return e;default:return t}}case Uh:return t}}}bt.ContextConsumer=Ac;bt.ContextProvider=Cc;bt.Element=qh;bt.ForwardRef=Ec;bt.Fragment=Sc;bt.Lazy=Oc;bt.Memo=Tc;bt.Portal=Uh;bt.Profiler=kc;bt.StrictMode=Nc;bt.Suspense=Ic;bt.SuspenseList=Pc;bt.isContextConsumer=function(e){return sr(e)===Ac};bt.isContextProvider=function(e){return sr(e)===Cc};bt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===qh};bt.isForwardRef=function(e){return sr(e)===Ec};bt.isFragment=function(e){return sr(e)===Sc};bt.isLazy=function(e){return sr(e)===Oc};bt.isMemo=function(e){return sr(e)===Tc};bt.isPortal=function(e){return sr(e)===Uh};bt.isProfiler=function(e){return sr(e)===kc};bt.isStrictMode=function(e){return sr(e)===Nc};bt.isSuspense=function(e){return sr(e)===Ic};bt.isSuspenseList=function(e){return sr(e)===Pc};bt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Sc||e===kc||e===Nc||e===Ic||e===Pc||typeof e=="object"&&e!==null&&(e.$$typeof===Oc||e.$$typeof===Tc||e.$$typeof===Cc||e.$$typeof===Ac||e.$$typeof===Ec||e.$$typeof===mz||e.getModuleId!==void 0)};bt.typeOf=sr;Gj.exports=bt;var pz=Gj.exports,Yy=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",Ky=null,Su=null,Qj=e=>{if(e===Ky&&Array.isArray(Su))return Su;var t=[];return h.Children.forEach(e,n=>{Mt(n)||(pz.isFragment(n)?t=t.concat(Qj(n.props.children)):t.push(n))}),Su=t,Ky=e,t};function Hh(e,t){var n=[],i=[];return Array.isArray(t)?i=t.map(a=>Yy(a)):i=[Yy(t)],Qj(e).forEach(a=>{var s=Bi(a,"type.displayName")||Bi(a,"type.name");s&&i.indexOf(s)!==-1&&n.push(a)}),n}var Jj=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,Zj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){var a;if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const s=n[Symbol.toStringTag];return s==null||!((a=Object.getOwnPropertyDescriptor(n,Symbol.toStringTag))!=null&&a.writable)?!1:n.toString()===`[object ${s}]`}let i=n;for(;Object.getPrototypeOf(i)!==null;)i=Object.getPrototypeOf(i);return Object.getPrototypeOf(n)===i}e.isPlainObject=t})(Zj);var gz=Zj.isPlainObject;const yz=Pr(gz);function Vy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Xy(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Vy(Object(n),!0).forEach(function(i){vz(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Vy(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function vz(e,t,n){return(t=xz(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xz(e){var t=bz(e,"string");return typeof t=="symbol"?t:t+""}function bz(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ml(){return ml=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ml.apply(null,arguments)}var Gy=(e,t,n,i,a)=>{var s=n-i,o;return o="M ".concat(e,",").concat(t),o+="L ".concat(e+n,",").concat(t),o+="L ".concat(e+n-s/2,",").concat(t+a),o+="L ".concat(e+n-s/2-i,",").concat(t+a),o+="L ".concat(e,",").concat(t," Z"),o},jz={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},wz=e=>{var t=pn(e,jz),{x:n,y:i,upperWidth:a,lowerWidth:s,height:o,className:l}=t,{animationEasing:c,animationDuration:d,animationBegin:u,isUpdateAnimationActive:f}=t,m=h.useRef(null),[p,y]=h.useState(-1),v=h.useRef(a),g=h.useRef(s),b=h.useRef(o),x=h.useRef(n),N=h.useRef(i),A=Ps(e,"trapezoid-");if(h.useEffect(()=>{if(m.current&&m.current.getTotalLength)try{var T=m.current.getTotalLength();T&&y(T)}catch{}},[]),n!==+n||i!==+i||a!==+a||s!==+s||o!==+o||a===0&&s===0||o===0)return null;var C=ut("recharts-trapezoid",l);if(!f)return h.createElement("g",null,h.createElement("path",ml({},In(t),{className:C,d:Gy(n,i,a,s,o)})));var w=v.current,O=g.current,M=b.current,B=x.current,z=N.current,j="0px ".concat(p===-1?1:p,"px"),k="".concat(p,"px 0px"),L=cb(["strokeDasharray"],d,c);return h.createElement(Is,{animationId:A,key:A,canBegin:p>0,duration:d,easing:c,isActive:f,begin:u},T=>{var $=Ot(w,a,T),V=Ot(O,s,T),G=Ot(M,o,T),ne=Ot(B,n,T),U=Ot(z,i,T);m.current&&(v.current=$,g.current=V,b.current=G,x.current=ne,N.current=U);var I=T>0?{transition:L,strokeDasharray:k}:{strokeDasharray:j};return h.createElement("path",ml({},In(t),{className:C,d:Gy(ne,U,$,V,G),ref:m,style:Xy(Xy({},I),t.style)}))})},Sz=["option","shapeType","propTransformer","activeClassName","isActive"];function Nz(e,t){if(e==null)return{};var n,i,a=kz(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function kz(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function Qy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function pl(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Qy(Object(n),!0).forEach(function(i){Az(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qy(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Az(e,t,n){return(t=Cz(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Cz(e){var t=Ez(e,"string");return typeof t=="symbol"?t:t+""}function Ez(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Iz(e,t){return pl(pl({},t),e)}function Pz(e,t){return e==="symbols"}function Jy(e){var{shapeType:t,elementProps:n}=e;switch(t){case"rectangle":return h.createElement(hb,n);case"trapezoid":return h.createElement(wz,n);case"sector":return h.createElement(yb,n);case"symbols":if(Pz(t))return h.createElement(Wx,n);break;case"curve":return h.createElement(If,n);default:return null}}function Tz(e){return h.isValidElement(e)?e.props:e}function Yh(e){var{option:t,shapeType:n,propTransformer:i=Iz,activeClassName:a="recharts-active-shape",isActive:s}=e,o=Nz(e,Sz),l;if(h.isValidElement(t))l=h.cloneElement(t,pl(pl({},o),Tz(t)));else if(typeof t=="function")l=t(o);else if(yz(t)&&typeof t!="boolean"){var c=i(t,o);l=h.createElement(Jy,{shapeType:n,elementProps:c})}else{var d=o;l=h.createElement(Jy,{shapeType:n,elementProps:d})}return s?h.createElement(mn,{className:a},l):l}var Kh=(e,t)=>{var n=Lt();return(i,a)=>s=>{e==null||e(i,a,s),n(nj({activeIndex:String(a),activeDataKey:t,activeCoordinate:i.tooltipPosition}))}},Vh=e=>{var t=Lt();return(n,i)=>a=>{e==null||e(n,i,a),t(e8())}},Xh=(e,t)=>{var n=Lt();return(i,a)=>s=>{e==null||e(i,a,s),n(t8({activeIndex:String(a),activeDataKey:t,activeCoordinate:i.tooltipPosition}))}};function Gh(e){var{fn:t,args:n}=e,i=Lt(),a=kn();return h.useLayoutEffect(()=>{if(!a){var s=t(n);return i(QL(s)),()=>{i(JL(s))}}},[t,n,i,a]),null}function ew(e){var{legendPayload:t}=e,n=Lt(),i=kn();return h.useLayoutEffect(()=>i?Vi:(n(sb(t)),()=>{n(ob(t))}),[n,i,t]),null}function Oz(e){var{legendPayload:t}=e,n=Lt(),i=We(ot);return h.useLayoutEffect(()=>i!=="centric"&&i!=="radial"?Vi:(n(sb(t)),()=>{n(ob(t))}),[n,i,t]),null}var Nu,Dz=()=>{var[e]=h.useState(()=>us("uid-"));return e},_z=(Nu=nS.useId)!==null&&Nu!==void 0?Nu:Dz;function tw(e,t){var n=_z();return t||(e?"".concat(e,"-").concat(n):n)}var Mz=h.createContext(void 0),Qh=e=>{var{id:t,type:n,children:i}=e,a=tw("recharts-".concat(n),t);return h.createElement(Mz.Provider,{value:a},i(a))},Lz={cartesianItems:[],polarItems:[]},nw=$n({name:"graphicalItems",initialState:Lz,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:sn()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:n,next:i}=t.payload,a=Wr(e).cartesianItems.indexOf(n);a>-1&&(e.cartesianItems[a]=i)},prepare:sn()},removeCartesianGraphicalItem:{reducer(e,t){var n=Wr(e).cartesianItems.indexOf(t.payload);n>-1&&e.cartesianItems.splice(n,1)},prepare:sn()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:sn()},removePolarGraphicalItem:{reducer(e,t){var n=Wr(e).polarItems.indexOf(t.payload);n>-1&&e.polarItems.splice(n,1)},prepare:sn()}}}),{addCartesianGraphicalItem:$z,replaceCartesianGraphicalItem:zz,removeCartesianGraphicalItem:Rz,addPolarGraphicalItem:Bz,removePolarGraphicalItem:Wz}=nw.actions,Fz=nw.reducer;function rw(e){var t=Lt(),n=h.useRef(null);return h.useLayoutEffect(()=>{n.current===null?t($z(e)):n.current!==e&&t(zz({prev:n.current,next:e})),n.current=e},[t,e]),h.useLayoutEffect(()=>()=>{n.current&&(t(Rz(n.current)),n.current=null)},[t]),null}function qz(e){var t=Lt();return h.useLayoutEffect(()=>(t(Bz(e)),()=>{t(Wz(e))}),[t,e]),null}var Uz=["onMouseEnter","onClick","onMouseLeave"],Hz=["id"],Yz=["id"];function Jh(e,t){if(e==null)return{};var n,i,a=Kz(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function Kz(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function Zy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Dt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Zy(Object(n),!0).forEach(function(i){Vz(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zy(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function Vz(e,t,n){return(t=Xz(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Xz(e){var t=Gz(e,"string");return typeof t=="symbol"?t:t+""}function Gz(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mi(){return mi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},mi.apply(null,arguments)}function Qz(e){var t=h.useMemo(()=>Hh(e.children,Qi),[e.children]),n=We(i=>dz(i,e.id,t));return n==null?null:h.createElement(Oz,{legendPayload:n})}function Jz(e){var{dataKey:t,nameKey:n,sectors:i,stroke:a,strokeWidth:s,fill:o,name:l,hide:c,tooltipType:d}=e;return{dataDefinedOnItem:i.map(u=>u.tooltipPayload),positions:i.map(u=>u.tooltipPosition),settings:{stroke:a,strokeWidth:s,fill:o,dataKey:t,nameKey:n,name:ka(l,t),hide:c,type:d,color:o,unit:""}}}var Zz=(e,t)=>e>t?"start":e<t?"end":"middle",eR=(e,t,n)=>Sn(typeof t=="function"?t(e):t,n,n*.8),tR=(e,t,n)=>{var{top:i,left:a,width:s,height:o}=t,l=mb(s,o),c=a+Sn(e.cx,s,s/2),d=i+Sn(e.cy,o,o/2),u=Sn(e.innerRadius,l,0),f=eR(n,e.outerRadius,l),m=e.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:c,cy:d,innerRadius:u,outerRadius:f,maxRadius:m}},nR=(e,t)=>{var n=hn(t-e),i=Math.min(Math.abs(t-e),360);return n*i};function rR(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var iR=(e,t)=>{if(h.isValidElement(e))return h.cloneElement(e,t);if(typeof e=="function")return e(t);var n=ut("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return h.createElement(If,mi({},t,{type:"linear",className:n}))},aR=(e,t,n)=>{if(h.isValidElement(e))return h.cloneElement(e,t);var i=n;if(typeof e=="function"&&(i=e(t),h.isValidElement(i)))return i;var a=ut("recharts-pie-label-text",rR(e));return h.createElement(bc,mi({},t,{alignmentBaseline:"middle",className:a}),i)};function sR(e){var{sectors:t,props:n,showLabels:i}=e,{label:a,labelLine:s,dataKey:o}=n;if(!i||!a||!t)return null;var l=Kn(n),c=Ri(a),d=Ri(s),u=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,f=t.map((m,p)=>{var y=(m.startAngle+m.endAngle)/2,v=Zt(m.cx,m.cy,m.outerRadius+u,y),g=Dt(Dt(Dt(Dt({},l),m),{},{stroke:"none"},c),{},{index:p,textAnchor:Zz(v.x,m.cx)},v),b=Dt(Dt(Dt(Dt({},l),m),{},{fill:"none",stroke:m.fill},d),{},{index:p,points:[Zt(m.cx,m.cy,m.outerRadius,y),v],key:"line"});return h.createElement(zn,{zIndex:en.label,key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(p)},h.createElement(mn,null,s&&iR(s,b),aR(a,g,kt(m,o))))});return h.createElement(mn,{className:"recharts-pie-labels"},f)}function oR(e){var{sectors:t,props:n,showLabels:i}=e,{label:a}=n;return typeof a=="object"&&a!=null&&"position"in a?h.createElement(Bh,{label:a}):h.createElement(sR,{sectors:t,props:n,showLabels:i})}function lR(e){var{sectors:t,activeShape:n,inactiveShape:i,allOtherPieProps:a}=e,s=We(hi),{onMouseEnter:o,onClick:l,onMouseLeave:c}=a,d=Jh(a,Uz),u=Kh(o,a.dataKey),f=Vh(c),m=Xh(l,a.dataKey);return t==null||t.length===0?null:h.createElement(h.Fragment,null,t.map((p,y)=>{if((p==null?void 0:p.startAngle)===0&&(p==null?void 0:p.endAngle)===0&&t.length!==1)return null;var v=n&&String(y)===s,g=s?i:null,b=v?n:g,x=Dt(Dt({},p),{},{stroke:p.stroke,tabIndex:-1,[K0]:y,[V0]:a.dataKey});return h.createElement(mn,mi({key:"sector-".concat(p==null?void 0:p.startAngle,"-").concat(p==null?void 0:p.endAngle,"-").concat(p.midAngle,"-").concat(y),tabIndex:-1,className:"recharts-pie-sector"},Bl(d,p,y),{onMouseEnter:u(p,y),onMouseLeave:f(p,y),onClick:m(p,y)}),h.createElement(Yh,mi({option:b,isActive:v,shapeType:"sector"},x)))}))}function cR(e){var t,{pieSettings:n,displayedData:i,cells:a,offset:s}=e,{cornerRadius:o,startAngle:l,endAngle:c,dataKey:d,nameKey:u,tooltipType:f}=n,m=Math.abs(n.minAngle),p=nR(l,c),y=Math.abs(p),v=i.length<=1?0:(t=n.paddingAngle)!==null&&t!==void 0?t:0,g=i.filter(w=>kt(w,d,0)!==0).length,b=(y>=360?g:g-1)*v,x=y-g*m-b,N=i.reduce((w,O)=>{var M=kt(O,d,0);return w+(Be(M)?M:0)},0),A;if(N>0){var C;A=i.map((w,O)=>{var M=kt(w,d,0),B=kt(w,u,O),z=tR(n,s,w),j=(Be(M)?M:0)/N,k,L=Dt(Dt({},w),a&&a[O]&&a[O].props);O?k=C.endAngle+hn(p)*v*(M!==0?1:0):k=l;var T=k+hn(p)*((M!==0?m:0)+j*x),$=(k+T)/2,V=(z.innerRadius+z.outerRadius)/2,G=[{name:B,value:M,payload:L,dataKey:d,type:f}],ne=Zt(z.cx,z.cy,V,$);return C=Dt(Dt(Dt(Dt({},n.presentationProps),{},{percent:j,cornerRadius:typeof o=="string"?parseFloat(o):o,name:B,tooltipPayload:G,midAngle:$,middleRadius:V,tooltipPosition:ne},L),z),{},{value:M,startAngle:k,endAngle:T,payload:L,paddingAngle:hn(p)*v}),C})}return A}function uR(e){var{showLabels:t,sectors:n,children:i}=e,a=h.useMemo(()=>!t||!n?[]:n.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[n,t]);return h.createElement(X4,{value:t?a:void 0},i)}function dR(e){var{props:t,previousSectorsRef:n}=e,{sectors:i,isAnimationActive:a,animationBegin:s,animationDuration:o,animationEasing:l,activeShape:c,inactiveShape:d,onAnimationStart:u,onAnimationEnd:f}=t,m=Ps(t,"recharts-pie-"),p=n.current,[y,v]=h.useState(!1),g=h.useCallback(()=>{typeof f=="function"&&f(),v(!1)},[f]),b=h.useCallback(()=>{typeof u=="function"&&u(),v(!0)},[u]);return h.createElement(uR,{showLabels:!y,sectors:i},h.createElement(Is,{animationId:m,begin:s,duration:o,isActive:a,easing:l,onAnimationStart:b,onAnimationEnd:g,key:m},x=>{var N=[],A=i&&i[0],C=A==null?void 0:A.startAngle;return i==null||i.forEach((w,O)=>{var M=p&&p[O],B=O>0?Bi(w,"paddingAngle",0):0;if(M){var z=Ot(M.endAngle-M.startAngle,w.endAngle-w.startAngle,x),j=Dt(Dt({},w),{},{startAngle:C+B,endAngle:C+z+B});N.push(j),C=j.endAngle}else{var{endAngle:k,startAngle:L}=w,T=Ot(0,k-L,x),$=Dt(Dt({},w),{},{startAngle:C+B,endAngle:C+T+B});N.push($),C=$.endAngle}}),n.current=N,h.createElement(mn,null,h.createElement(lR,{sectors:N,activeShape:c,inactiveShape:d,allOtherPieProps:t}))}),h.createElement(oR,{showLabels:!y,sectors:i,props:t}),t.children)}var fR={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!yi.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:en.area};function hR(e){var{id:t}=e,n=Jh(e,Hz),{hide:i,className:a,rootTabIndex:s}=e,o=h.useMemo(()=>Hh(e.children,Qi),[e.children]),l=We(u=>fz(u,t,o)),c=h.useRef(null),d=ut("recharts-pie",a);return i||l==null?(c.current=null,h.createElement(mn,{tabIndex:s,className:d})):h.createElement(zn,{zIndex:e.zIndex},h.createElement(Gh,{fn:Jz,args:Dt(Dt({},e),{},{sectors:l})}),h.createElement(mn,{tabIndex:s,className:d},h.createElement(dR,{props:Dt(Dt({},n),{},{sectors:l}),previousSectorsRef:c})))}function iw(e){var t=pn(e,fR),{id:n}=t,i=Jh(t,Yz),a=Kn(i);return h.createElement(Qh,{id:n,type:"pie"},s=>h.createElement(h.Fragment,null,h.createElement(qz,{type:"pie",id:s,data:i.data,dataKey:i.dataKey,hide:i.hide,angleAxisId:0,radiusAxisId:0,name:i.name,nameKey:i.nameKey,tooltipType:i.tooltipType,legendType:i.legendType,fill:i.fill,cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,paddingAngle:i.paddingAngle,minAngle:i.minAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius,cornerRadius:i.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),h.createElement(Qz,mi({},i,{id:s})),h.createElement(hR,mi({},i,{id:s}))))}iw.displayName="Pie";var mR=["points"];function ev(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function ku(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?ev(Object(n),!0).forEach(function(i){pR(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ev(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function pR(e,t,n){return(t=gR(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gR(e){var t=yR(e,"string");return typeof t=="symbol"?t:t+""}function yR(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gl(){return gl=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},gl.apply(null,arguments)}function vR(e,t){if(e==null)return{};var n,i,a=xR(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function xR(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function bR(e){var{option:t,dotProps:n,className:i}=e;if(h.isValidElement(t))return h.cloneElement(t,n);if(typeof t=="function")return t(n);var a=ut(i,typeof t!="boolean"?t.className:""),s=n??{},{points:o}=s,l=vR(s,mR);return h.createElement(Hj,gl({},l,{className:a}))}function jR(e,t){return e==null?!1:t?!0:e.length===1}function wR(e){var{points:t,dot:n,className:i,dotClassName:a,dataKey:s,baseProps:o,needClip:l,clipPathId:c,zIndex:d=en.scatter}=e;if(!jR(t,n))return null;var u=Jj(n),f=dI(n),m=t.map((y,v)=>{var g,b,x=ku(ku(ku({r:3},o),f),{},{index:v,cx:(g=y.x)!==null&&g!==void 0?g:void 0,cy:(b=y.y)!==null&&b!==void 0?b:void 0,dataKey:s,value:y.value,payload:y.payload,points:t});return h.createElement(bR,{key:"dot-".concat(v),option:n,dotProps:x,className:a})}),p={};return l&&c!=null&&(p.clipPath="url(#clipPath-".concat(u?"":"dots-").concat(c,")")),h.createElement(zn,{zIndex:d},h.createElement(mn,gl({className:i},p),m))}function tv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function nv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?tv(Object(n),!0).forEach(function(i){SR(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tv(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function SR(e,t,n){return(t=NR(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function NR(e){var t=kR(e,"string");return typeof t=="symbol"?t:t+""}function kR(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var AR={xAxis:{},yAxis:{},zAxis:{}},aw=$n({name:"cartesianAxis",initialState:AR,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:sn()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:sn()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:sn()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:sn()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:sn()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:sn()},updateYAxisWidth(e,t){var{id:n,width:i}=t.payload,a=e.yAxis[n];if(a){var s=a.widthHistory||[];if(s.length===3&&s[0]===s[2]&&i===s[1]&&i!==a.width&&Math.abs(i-s[0])<=1)return;var o=[...s,i].slice(-3);e.yAxis[n]=nv(nv({},e.yAxis[n]),{},{width:i,widthHistory:o})}}}}),{addXAxis:CR,removeXAxis:ER,addYAxis:IR,removeYAxis:PR,addZAxis:S5,removeZAxis:N5,updateYAxisWidth:TR}=aw.actions,OR=aw.reducer,DR=pe([on],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),_R=pe([DR,Gr,Qr],(e,t,n)=>{if(!(!e||t==null||n==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,n-e.top-e.bottom)}}),Zh=()=>We(_R),MR=()=>We(W8);function rv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Au(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rv(Object(n),!0).forEach(function(i){LR(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rv(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function LR(e,t,n){return(t=$R(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $R(e){var t=zR(e,"string");return typeof t=="symbol"?t:t+""}function zR(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RR=e=>{var{point:t,childIndex:n,mainColor:i,activeDot:a,dataKey:s}=e;if(a===!1||t.x==null||t.y==null)return null;var o={index:n,dataKey:s,cx:t.x,cy:t.y,r:4,fill:i??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},l=Au(Au(Au({},o),Ri(a)),cf(a)),c;return h.isValidElement(a)?c=h.cloneElement(a,l):typeof a=="function"?c=a(l):c=h.createElement(Hj,l),h.createElement(mn,{className:"recharts-active-dot"},c)};function BR(e){var{points:t,mainColor:n,activeDot:i,itemDataKey:a,zIndex:s=en.activeDot}=e,o=We(hi),l=MR();if(t==null||l==null)return null;var c=t.find(d=>l.includes(d.payload));return Mt(c)?null:h.createElement(zn,{zIndex:s},h.createElement(RR,{point:c,childIndex:Number(o),mainColor:n,dataKey:a,activeDot:i}))}var WR="Invariant failed";function FR(e,t){throw new Error(WR)}var qR=["x","y"];function Pd(){return Pd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Pd.apply(null,arguments)}function iv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Ja(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?iv(Object(n),!0).forEach(function(i){UR(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):iv(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function UR(e,t,n){return(t=HR(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function HR(e){var t=YR(e,"string");return typeof t=="symbol"?t:t+""}function YR(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function KR(e,t){if(e==null)return{};var n,i,a=VR(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function VR(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function XR(e,t){var{x:n,y:i}=e,a=KR(e,qR),s="".concat(n),o=parseInt(s,10),l="".concat(i),c=parseInt(l,10),d="".concat(t.height||a.height),u=parseInt(d,10),f="".concat(t.width||a.width),m=parseInt(f,10);return Ja(Ja(Ja(Ja(Ja({},t),a),o?{x:o}:{}),c?{y:c}:{}),{},{height:u,width:m,name:t.name,radius:t.radius})}function yl(e){return h.createElement(Yh,Pd({shapeType:"rectangle",propTransformer:XR,activeClassName:"recharts-active-bar"},e))}var GR=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(i,a)=>{if(Be(t))return t;var s=Be(i)||Mt(i);return s?t(i,a):(s||FR(),n)}},QR={},sw=$n({name:"errorBars",initialState:QR,reducers:{addErrorBar:(e,t)=>{var{itemId:n,errorBar:i}=t.payload;e[n]||(e[n]=[]),e[n].push(i)},replaceErrorBar:(e,t)=>{var{itemId:n,prev:i,next:a}=t.payload;e[n]&&(e[n]=e[n].map(s=>s.dataKey===i.dataKey&&s.direction===i.direction?a:s))},removeErrorBar:(e,t)=>{var{itemId:n,errorBar:i}=t.payload;e[n]&&(e[n]=e[n].filter(a=>a.dataKey!==i.dataKey||a.direction!==i.direction))}}}),{addErrorBar:k5,replaceErrorBar:A5,removeErrorBar:C5}=sw.actions,JR=sw.reducer,ZR=["children"];function e3(e,t){if(e==null)return{};var n,i,a=t3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function t3(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}var n3={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},r3=h.createContext(n3);function ow(e){var{children:t}=e,n=e3(e,ZR);return h.createElement(r3.Provider,{value:n},t)}function em(e,t){var n,i,a=We(d=>Zr(d,e)),s=We(d=>ei(d,t)),o=(n=a==null?void 0:a.allowDataOverflow)!==null&&n!==void 0?n:Wn.allowDataOverflow,l=(i=s==null?void 0:s.allowDataOverflow)!==null&&i!==void 0?i:Fn.allowDataOverflow,c=o||l;return{needClip:c,needClipX:o,needClipY:l}}function lw(e){var{xAxisId:t,yAxisId:n,clipPathId:i}=e,a=Zh(),{needClipX:s,needClipY:o,needClip:l}=em(t,n);if(!l||!a)return null;var{x:c,y:d,width:u,height:f}=a;return h.createElement("clipPath",{id:"clipPath-".concat(i)},h.createElement("rect",{x:s?c:c-u/2,y:o?d:d-f/2,width:s?u:u*2,height:o?f:f*2}))}function i3(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&Xt(e.zIndex)?e.zIndex:t}var a3=["onMouseEnter","onMouseLeave","onClick"],s3=["value","background","tooltipPosition"],o3=["id"],l3=["onMouseEnter","onClick","onMouseLeave"];function Xr(){return Xr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Xr.apply(null,arguments)}function av(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Cn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?av(Object(n),!0).forEach(function(i){c3(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):av(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function c3(e,t,n){return(t=u3(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u3(e){var t=d3(e,"string");return typeof t=="symbol"?t:t+""}function d3(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vl(e,t){if(e==null)return{};var n,i,a=f3(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function f3(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}var h3=e=>{var{dataKey:t,name:n,fill:i,legendType:a,hide:s}=e;return[{inactive:s,dataKey:t,type:a,color:i,value:ka(n,t),payload:e}]};function m3(e){var{dataKey:t,stroke:n,strokeWidth:i,fill:a,name:s,hide:o,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:i,fill:a,dataKey:t,nameKey:void 0,name:ka(s,t),hide:o,type:e.tooltipType,color:e.fill,unit:l}}}function p3(e){var t=We(hi),{data:n,dataKey:i,background:a,allOtherBarProps:s}=e,{onMouseEnter:o,onMouseLeave:l,onClick:c}=s,d=vl(s,a3),u=Kh(o,i),f=Vh(l),m=Xh(c,i);if(!a||n==null)return null;var p=Ri(a);return h.createElement(zn,{zIndex:i3(a,en.barBackground)},n.map((y,v)=>{var{value:g,background:b,tooltipPosition:x}=y,N=vl(y,s3);if(!b)return null;var A=u(y,v),C=f(y,v),w=m(y,v),O=Cn(Cn(Cn(Cn(Cn({option:a,isActive:String(v)===t},N),{},{fill:"#eee"},b),p),Bl(d,y,v)),{},{onMouseEnter:A,onMouseLeave:C,onClick:w,dataKey:i,index:v,className:"recharts-bar-background-rectangle"});return h.createElement(yl,Xr({key:"background-bar-".concat(v)},O))}))}function g3(e){var{showLabels:t,children:n,rects:i}=e,a=i==null?void 0:i.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return Cn(Cn({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return h.createElement(qj,{value:t?a:void 0},n)}function y3(e){var{shape:t,activeBar:n,baseProps:i,entry:a,index:s,dataKey:o}=e,l=We(hi),c=We(yj),d=n&&String(s)===l&&(c==null||o===c),u=d?n:t;return d?h.createElement(zn,{zIndex:en.activeBar},h.createElement(yl,Xr({},i,{name:String(i.name)},a,{isActive:d,option:u,index:s,dataKey:o}))):h.createElement(yl,Xr({},i,{name:String(i.name)},a,{isActive:d,option:u,index:s,dataKey:o}))}function v3(e){var{shape:t,baseProps:n,entry:i,index:a,dataKey:s}=e;return h.createElement(yl,Xr({},n,{name:String(n.name)},i,{isActive:!1,option:t,index:a,dataKey:s}))}function x3(e){var t,{data:n,props:i}=e,a=(t=Kn(i))!==null&&t!==void 0?t:{},{id:s}=a,o=vl(a,o3),{shape:l,dataKey:c,activeBar:d}=i,{onMouseEnter:u,onClick:f,onMouseLeave:m}=i,p=vl(i,l3),y=Kh(u,c),v=Vh(m),g=Xh(f,c);return n?h.createElement(h.Fragment,null,n.map((b,x)=>h.createElement(mn,Xr({key:"rectangle-".concat(b==null?void 0:b.x,"-").concat(b==null?void 0:b.y,"-").concat(b==null?void 0:b.value,"-").concat(x),className:"recharts-bar-rectangle"},Bl(p,b,x),{onMouseEnter:y(b,x),onMouseLeave:v(b,x),onClick:g(b,x)}),d?h.createElement(y3,{shape:l,activeBar:d,baseProps:o,entry:b,index:x,dataKey:c}):h.createElement(v3,{shape:l,baseProps:o,entry:b,index:x,dataKey:c})))):null}function b3(e){var{props:t,previousRectanglesRef:n}=e,{data:i,layout:a,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:c,onAnimationEnd:d,onAnimationStart:u}=t,f=n.current,m=Ps(t,"recharts-bar-"),[p,y]=h.useState(!1),v=!p,g=h.useCallback(()=>{typeof d=="function"&&d(),y(!1)},[d]),b=h.useCallback(()=>{typeof u=="function"&&u(),y(!0)},[u]);return h.createElement(g3,{showLabels:v,rects:i},h.createElement(Is,{animationId:m,begin:o,duration:l,isActive:s,easing:c,onAnimationEnd:g,onAnimationStart:b,key:m},x=>{var N=x===1?i:i==null?void 0:i.map((A,C)=>{var w=f&&f[C];if(w)return Cn(Cn({},A),{},{x:Ot(w.x,A.x,x),y:Ot(w.y,A.y,x),width:Ot(w.width,A.width,x),height:Ot(w.height,A.height,x)});if(a==="horizontal"){var O=Ot(0,A.height,x),M=Ot(A.stackedBarStart,A.y,x);return Cn(Cn({},A),{},{y:M,height:O})}var B=Ot(0,A.width,x),z=Ot(A.stackedBarStart,A.x,x);return Cn(Cn({},A),{},{width:B,x:z})});return x>0&&(n.current=N??null),N==null?null:h.createElement(mn,null,h.createElement(x3,{props:t,data:N}))}),h.createElement(Bh,{label:t.label}),t.children)}function j3(e){var t=h.useRef(null);return h.createElement(b3,{previousRectanglesRef:t,props:e})}var cw=0,w3=(e,t)=>{var n=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:n,errorVal:kt(e,t)}};class S3 extends h.PureComponent{render(){var{hide:t,data:n,dataKey:i,className:a,xAxisId:s,yAxisId:o,needClip:l,background:c,id:d}=this.props;if(t||n==null)return null;var u=ut("recharts-bar",a),f=d;return h.createElement(mn,{className:u,id:d},l&&h.createElement("defs",null,h.createElement(lw,{clipPathId:f,xAxisId:s,yAxisId:o})),h.createElement(mn,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},h.createElement(p3,{data:n,dataKey:i,background:c,allOtherBarProps:this.props}),h.createElement(j3,this.props)))}}var N3={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!yi.isSsr,legendType:"rect",minPointSize:cw,xAxisId:0,yAxisId:0,zIndex:en.bar};function k3(e){var{xAxisId:t,yAxisId:n,hide:i,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u}=e,{needClip:f}=em(t,n),m=Es(),p=kn(),y=Hh(e.children,Qi),v=We(x=>Z3(x,t,n,p,e.id,y));if(m!=="vertical"&&m!=="horizontal")return null;var g,b=v==null?void 0:v[0];return b==null||b.height==null||b.width==null?g=0:g=m==="vertical"?b.height/2:b.width/2,h.createElement(ow,{xAxisId:t,yAxisId:n,data:v,dataPointFormatter:w3,errorBarOffset:g},h.createElement(S3,Xr({},e,{layout:m,needClip:f,data:v,xAxisId:t,yAxisId:n,hide:i,legendType:a,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:c,animationEasing:d,isAnimationActive:u})))}function A3(e){var{layout:t,barSettings:{dataKey:n,minPointSize:i},pos:a,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:c,yAxisTicks:d,stackedData:u,displayedData:f,offset:m,cells:p,parentViewBox:y,dataStartIndex:v}=e,g=t==="horizontal"?l:o,b=u?g.scale.domain():null,x=oO({numericAxis:g}),N=g.scale(x);return f.map((A,C)=>{var w,O,M,B,z,j;u?w=tO(u[C+v],b):(w=kt(A,n),Array.isArray(w)||(w=[x,w]));var k=GR(i,cw)(w[1],C);if(t==="horizontal"){var L,[T,$]=[l.scale(w[0]),l.scale(w[1])];O=Qp({axis:o,ticks:c,bandSize:s,offset:a.offset,entry:A,index:C}),M=(L=$??T)!==null&&L!==void 0?L:void 0,B=a.size;var V=T-$;if(z=hr(V)?0:V,j={x:O,y:m.top,width:B,height:m.height},Math.abs(k)>0&&Math.abs(z)<Math.abs(k)){var G=hn(z||k)*(Math.abs(k)-Math.abs(z));M-=G,z+=G}}else{var[ne,U]=[o.scale(w[0]),o.scale(w[1])];if(O=ne,M=Qp({axis:l,ticks:d,bandSize:s,offset:a.offset,entry:A,index:C}),B=U-ne,z=a.size,j={x:m.left,y:M,width:m.width,height:z},Math.abs(k)>0&&Math.abs(B)<Math.abs(k)){var I=hn(B||k)*(Math.abs(k)-Math.abs(B));B+=I}}if(O==null||M==null||B==null||z==null)return null;var P=Cn(Cn({},A),{},{stackedBarStart:N,x:O,y:M,width:B,height:z,value:u?w:w[1],payload:A,background:j,tooltipPosition:{x:O+B/2,y:M+z/2},parentViewBox:y},p&&p[C]&&p[C].props);return P}).filter(Boolean)}function C3(e){var t=pn(e,N3),n=kn();return h.createElement(Qh,{id:t.id,type:"bar"},i=>h.createElement(h.Fragment,null,h.createElement(ew,{legendPayload:h3(t)}),h.createElement(Gh,{fn:m3,args:t}),h.createElement(rw,{type:"bar",id:i,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:sO(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),h.createElement(zn,{zIndex:t.zIndex},h.createElement(k3,Xr({},t,{id:i})))))}var tm=h.memo(C3);tm.displayName="Bar";function sv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function ko(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sv(Object(n),!0).forEach(function(i){E3(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sv(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function E3(e,t,n){return(t=I3(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I3(e){var t=P3(e,"string");return typeof t=="symbol"?t:t+""}function P3(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var T3=(e,t)=>t,O3=(e,t,n)=>n,D3=(e,t,n,i)=>i,_3=(e,t,n,i,a)=>a,Fs=pe([mc,_3],(e,t)=>e.filter(n=>n.type==="bar").find(n=>n.id===t)),M3=pe([Fs],e=>e==null?void 0:e.maxBarSize),L3=(e,t,n,i,a,s)=>s,ov=(e,t,n)=>{var i=n??e;if(!Mt(i))return Sn(i,t,0)},$3=pe([ot,mc,T3,O3,D3],(e,t,n,i,a)=>t.filter(s=>e==="horizontal"?s.xAxisId===n:s.yAxisId===i).filter(s=>s.isPanorama===a).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),z3=(e,t,n,i)=>{var a=ot(e);return a==="horizontal"?jd(e,"yAxis",n,i):jd(e,"xAxis",t,i)},R3=(e,t,n)=>{var i=ot(e);return i==="horizontal"?my(e,"xAxis",t):my(e,"yAxis",n)},B3=(e,t,n)=>{var i={},a=e.filter(dc),s=e.filter(d=>d.stackId==null),o=a.reduce((d,u)=>(d[u.stackId]||(d[u.stackId]=[]),d[u.stackId].push(u),d),i),l=Object.entries(o).map(d=>{var[u,f]=d,m=f.map(y=>y.dataKey),p=ov(t,n,f[0].barSize);return{stackId:u,dataKeys:m,barSize:p}}),c=s.map(d=>{var u=[d.dataKey].filter(m=>m!=null),f=ov(t,n,d.barSize);return{stackId:void 0,dataKeys:u,barSize:f}});return[...l,...c]},W3=pe([$3,U6,R3],B3),F3=(e,t,n,i,a)=>{var s,o,l=Fs(e,t,n,i,a);if(l!=null){var c=ot(e),d=y1(e),{maxBarSize:u}=l,f=Mt(u)?d:u,m,p;return c==="horizontal"?(m=fi(e,"xAxis",t,i),p=di(e,"xAxis",t,i)):(m=fi(e,"yAxis",n,i),p=di(e,"yAxis",n,i)),(s=(o=va(m,p,!0))!==null&&o!==void 0?o:f)!==null&&s!==void 0?s:0}},uw=(e,t,n,i)=>{var a=ot(e),s,o;return a==="horizontal"?(s=fi(e,"xAxis",t,i),o=di(e,"xAxis",t,i)):(s=fi(e,"yAxis",n,i),o=di(e,"yAxis",n,i)),va(s,o)};function q3(e,t,n,i,a){var s=i.length;if(!(s<1)){var o=Sn(e,n,0,!0),l,c=[];if(Xt(i[0].barSize)){var d=!1,u=n/s,f=i.reduce((b,x)=>b+(x.barSize||0),0);f+=(s-1)*o,f>=n&&(f-=(s-1)*o,o=0),f>=n&&u>0&&(d=!0,u*=.9,f=s*u);var m=(n-f)/2>>0,p={offset:m-o,size:0};l=i.reduce((b,x)=>{var N,A={stackId:x.stackId,dataKeys:x.dataKeys,position:{offset:p.offset+p.size+o,size:d?u:(N=x.barSize)!==null&&N!==void 0?N:0}},C=[...b,A];return p=C[C.length-1].position,C},c)}else{var y=Sn(t,n,0,!0);n-2*y-(s-1)*o<=0&&(o=0);var v=(n-2*y-(s-1)*o)/s;v>1&&(v>>=0);var g=Xt(a)?Math.min(v,a):v;l=i.reduce((b,x,N)=>[...b,{stackId:x.stackId,dataKeys:x.dataKeys,position:{offset:y+(v+o)*N+(v-g)/2,size:g}}],c)}return l}}var U3=(e,t,n,i,a,s,o)=>{var l=Mt(o)?t:o,c=q3(n,i,a!==s?a:s,e,l);return a!==s&&c!=null&&(c=c.map(d=>ko(ko({},d),{},{position:ko(ko({},d.position),{},{offset:d.position.offset-a/2})}))),c},H3=pe([W3,y1,q6,v1,F3,uw,M3],U3),Y3=(e,t,n,i)=>fi(e,"xAxis",t,i),K3=(e,t,n,i)=>fi(e,"yAxis",n,i),V3=(e,t,n,i)=>di(e,"xAxis",t,i),X3=(e,t,n,i)=>di(e,"yAxis",n,i),G3=pe([H3,Fs],(e,t)=>{if(!(e==null||t==null)){var n=e.find(i=>i.stackId===t.stackId&&t.dataKey!=null&&i.dataKeys.includes(t.dataKey));if(n!=null)return n.position}}),Q3=(e,t)=>{var n=lh(t);if(!(!e||n==null||t==null)){var{stackId:i}=t;if(i!=null){var a=e[i];if(a){var{stackedData:s}=a;if(s)return s.find(o=>o.key===n)}}}},J3=pe([z3,Fs],Q3),Z3=pe([on,Cf,Y3,K3,V3,X3,G3,ot,oc,uw,J3,Fs,L3],(e,t,n,i,a,s,o,l,c,d,u,f,m)=>{var{chartData:p,dataStartIndex:y,dataEndIndex:v}=c;if(!(f==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||n==null||i==null||a==null||s==null||d==null)){var{data:g}=f,b;if(g!=null&&g.length>0?b=g:b=p==null?void 0:p.slice(y,v+1),b!=null)return A3({layout:l,barSettings:f,pos:o,parentViewBox:t,bandSize:d,xAxis:n,yAxis:i,xAxisTicks:a,yAxisTicks:s,stackedData:u,displayedData:b,offset:e,cells:m,dataStartIndex:y})}}),dw=e=>{var{chartData:t}=e,n=Lt(),i=kn();return h.useEffect(()=>i?()=>{}:(n(Ay(t)),()=>{n(Ay(void 0))}),[t,n,i]),null},lv={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},fw=$n({name:"brush",initialState:lv,reducers:{setBrushSettings(e,t){return t.payload==null?lv:t.payload}}}),{setBrushSettings:E5}=fw.actions,eB=fw.reducer;function tB(e,t,n){return(t=nB(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nB(e){var t=rB(e,"string");return typeof t=="symbol"?t:t+""}function rB(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class nm{static create(t){return new nm(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:n,position:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(i)switch(i){case"start":return this.scale(t);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+a}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(t)+s}default:return this.scale(t)}if(n){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var n=this.range(),i=n[0],a=n[n.length-1];return i<=a?t>=i&&t<=a:t>=a&&t<=i}}tB(nm,"EPS",1e-4);function iB(e){return(e%180+180)%180}var aB=function(t){var{width:n,height:i}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=iB(a),o=s*Math.PI/180,l=Math.atan(i/n),c=o>l&&o<Math.PI-l?i/Math.sin(o):n/Math.cos(o);return Math.abs(c)},sB={dots:[],areas:[],lines:[]},hw=$n({name:"referenceElements",initialState:sB,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var n=Wr(e).dots.findIndex(i=>i===t.payload);n!==-1&&e.dots.splice(n,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var n=Wr(e).areas.findIndex(i=>i===t.payload);n!==-1&&e.areas.splice(n,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var n=Wr(e).lines.findIndex(i=>i===t.payload);n!==-1&&e.lines.splice(n,1)}}}),{addDot:I5,removeDot:P5,addArea:T5,removeArea:O5,addLine:D5,removeLine:_5}=hw.actions,oB=hw.reducer,lB=h.createContext(void 0),cB=e=>{var{children:t}=e,[n]=h.useState("".concat(us("recharts"),"-clip")),i=Zh();if(i==null)return null;var{x:a,y:s,width:o,height:l}=i;return h.createElement(lB.Provider,{value:n},h.createElement("defs",null,h.createElement("clipPath",{id:n},h.createElement("rect",{x:a,y:s,height:l,width:o}))),t)};function wa(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var i in t)if({}.hasOwnProperty.call(t,i)&&!{}.hasOwnProperty.call(e,i))return!1;return!0}function mw(e,t){if(t<1)return[];if(t===1)return e;for(var n=[],i=0;i<e.length;i+=t)n.push(e[i]);return n}function uB(e,t,n){var i={width:e.width+t.width,height:e.height+t.height};return aB(i,n)}function dB(e,t,n){var i=n==="width",{x:a,y:s,width:o,height:l}=e;return t===1?{start:i?a:s,end:i?a+o:s+l}:{start:i?a+o:s+l,end:i?a:s}}function xl(e,t,n,i,a){if(e*t<e*i||e*t>e*a)return!1;var s=n();return e*(t-e*s/2-i)>=0&&e*(t+e*s/2-a)<=0}function fB(e,t){return mw(e,t+1)}function hB(e,t,n,i,a){for(var s=(i||[]).slice(),{start:o,end:l}=t,c=0,d=1,u=o,f=function(){var y=i==null?void 0:i[c];if(y===void 0)return{v:mw(i,d)};var v=c,g,b=()=>(g===void 0&&(g=n(y,v)),g),x=y.coordinate,N=c===0||xl(e,x,b,u,l);N||(c=0,u=o,d+=1),N&&(u=x+e*(b()/2+a),c+=d)},m;d<=s.length;)if(m=f(),m)return m.v;return[]}function cv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function jn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?cv(Object(n),!0).forEach(function(i){mB(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cv(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function mB(e,t,n){return(t=pB(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pB(e){var t=gB(e,"string");return typeof t=="symbol"?t:t+""}function gB(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yB(e,t,n,i,a){for(var s=(i||[]).slice(),o=s.length,{start:l}=t,{end:c}=t,d=function(m){var p=s[m],y,v=()=>(y===void 0&&(y=n(p,m)),y);if(m===o-1){var g=e*(p.coordinate+e*v()/2-c);s[m]=p=jn(jn({},p),{},{tickCoord:g>0?p.coordinate-g*e:p.coordinate})}else s[m]=p=jn(jn({},p),{},{tickCoord:p.coordinate});if(p.tickCoord!=null){var b=xl(e,p.tickCoord,v,l,c);b&&(c=p.tickCoord-e*(v()/2+a),s[m]=jn(jn({},p),{},{isShow:!0}))}},u=o-1;u>=0;u--)d(u);return s}function vB(e,t,n,i,a,s){var o=(i||[]).slice(),l=o.length,{start:c,end:d}=t;if(s){var u=i[l-1],f=n(u,l-1),m=e*(u.coordinate+e*f/2-d);if(o[l-1]=u=jn(jn({},u),{},{tickCoord:m>0?u.coordinate-m*e:u.coordinate}),u.tickCoord!=null){var p=xl(e,u.tickCoord,()=>f,c,d);p&&(d=u.tickCoord-e*(f/2+a),o[l-1]=jn(jn({},u),{},{isShow:!0}))}}for(var y=s?l-1:l,v=function(x){var N=o[x],A,C=()=>(A===void 0&&(A=n(N,x)),A);if(x===0){var w=e*(N.coordinate-e*C()/2-c);o[x]=N=jn(jn({},N),{},{tickCoord:w<0?N.coordinate-w*e:N.coordinate})}else o[x]=N=jn(jn({},N),{},{tickCoord:N.coordinate});if(N.tickCoord!=null){var O=xl(e,N.tickCoord,C,c,d);O&&(c=N.tickCoord+e*(C()/2+a),o[x]=jn(jn({},N),{},{isShow:!0}))}},g=0;g<y;g++)v(g);return o}function rm(e,t,n){var{tick:i,ticks:a,viewBox:s,minTickGap:o,orientation:l,interval:c,tickFormatter:d,unit:u,angle:f}=e;if(!a||!a.length||!i)return[];if(Be(c)||yi.isSsr){var m;return(m=fB(a,Be(c)?c:0))!==null&&m!==void 0?m:[]}var p=[],y=l==="top"||l==="bottom"?"width":"height",v=u&&y==="width"?os(u,{fontSize:t,letterSpacing:n}):{width:0,height:0},g=(N,A)=>{var C=typeof d=="function"?d(N.value,A):N.value;return y==="width"?uB(os(C,{fontSize:t,letterSpacing:n}),v,f):os(C,{fontSize:t,letterSpacing:n})[y]},b=a.length>=2?hn(a[1].coordinate-a[0].coordinate):1,x=dB(s,b,y);return c==="equidistantPreserveStart"?hB(b,x,g,a,o):(c==="preserveStart"||c==="preserveStartEnd"?p=vB(b,x,g,a,o,c==="preserveStartEnd"):p=yB(b,x,g,a,o),p.filter(N=>N.isShow))}var xB=e=>{var{ticks:t,label:n,labelGapWithTick:i=5,tickSize:a=0,tickMargin:s=0}=e,o=0;if(t){Array.from(t).forEach(u=>{if(u){var f=u.getBoundingClientRect();f.width>o&&(o=f.width)}});var l=n?n.getBoundingClientRect().width:0,c=a+s,d=o+c+l+(n?i:0);return Math.round(d)}return 0},bB=["axisLine","width","height","className","hide","ticks","axisType"],jB=["viewBox"],wB=["viewBox"];function Td(e,t){if(e==null)return{};var n,i,a=SB(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function SB(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function Hi(){return Hi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Hi.apply(null,arguments)}function uv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function Jt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?uv(Object(n),!0).forEach(function(i){NB(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):uv(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function NB(e,t,n){return(t=kB(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function kB(e){var t=AB(e,"string");return typeof t=="symbol"?t:t+""}function AB(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var im={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:en.axis};function CB(e){var{x:t,y:n,width:i,height:a,orientation:s,mirror:o,axisLine:l,otherSvgProps:c}=e;if(!l)return null;var d=Jt(Jt(Jt({},c),Kn(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var u=+(s==="top"&&!o||s==="bottom"&&o);d=Jt(Jt({},d),{},{x1:t,y1:n+u*a,x2:t+i,y2:n+u*a})}else{var f=+(s==="left"&&!o||s==="right"&&o);d=Jt(Jt({},d),{},{x1:t+f*i,y1:n,x2:t+f*i,y2:n+a})}return h.createElement("line",Hi({},d,{className:ut("recharts-cartesian-axis-line",Bi(l,"className"))}))}function EB(e,t,n,i,a,s,o,l,c){var d,u,f,m,p,y,v=l?-1:1,g=e.tickSize||o,b=Be(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":d=u=e.coordinate,m=n+ +!l*a,f=m-v*g,y=f-v*c,p=b;break;case"left":f=m=e.coordinate,u=t+ +!l*i,d=u-v*g,p=d-v*c,y=b;break;case"right":f=m=e.coordinate,u=t+ +l*i,d=u+v*g,p=d+v*c,y=b;break;default:d=u=e.coordinate,m=n+ +l*a,f=m+v*g,y=f+v*c,p=b;break}return{line:{x1:d,y1:f,x2:u,y2:m},tick:{x:p,y}}}function IB(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function PB(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function TB(e){var{option:t,tickProps:n,value:i}=e,a,s=ut(n.className,"recharts-cartesian-axis-tick-value");if(h.isValidElement(t))a=h.cloneElement(t,Jt(Jt({},n),{},{className:s}));else if(typeof t=="function")a=t(Jt(Jt({},n),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=ut(o,t==null?void 0:t.className)),a=h.createElement(bc,Hi({},n,{className:o}),i)}return a}var OB=h.forwardRef((e,t)=>{var{ticks:n=[],tick:i,tickLine:a,stroke:s,tickFormatter:o,unit:l,padding:c,tickTextProps:d,orientation:u,mirror:f,x:m,y:p,width:y,height:v,tickSize:g,tickMargin:b,fontSize:x,letterSpacing:N,getTicksConfig:A,events:C,axisType:w}=e,O=rm(Jt(Jt({},A),{},{ticks:n}),x,N),M=IB(u,f),B=PB(u,f),z=Kn(A),j=Ri(i),k={};typeof a=="object"&&(k=a);var L=Jt(Jt({},z),{},{fill:"none"},k),T=O.map(G=>Jt({entry:G},EB(G,m,p,y,v,u,g,f,b))),$=T.map(G=>{var{entry:ne,line:U}=G;return h.createElement(mn,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(ne.value,"-").concat(ne.coordinate,"-").concat(ne.tickCoord)},a&&h.createElement("line",Hi({},L,U,{className:ut("recharts-cartesian-axis-tick-line",Bi(a,"className"))})))}),V=T.map((G,ne)=>{var{entry:U,tick:I}=G,P=Jt(Jt(Jt(Jt({textAnchor:M,verticalAnchor:B},z),{},{stroke:"none",fill:s},j),I),{},{index:ne,payload:U,visibleTicksCount:O.length,tickFormatter:o,padding:c},d);return h.createElement(mn,Hi({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(U.value,"-").concat(U.coordinate,"-").concat(U.tickCoord)},Bl(C,U,ne)),i&&h.createElement(TB,{option:i,tickProps:P,value:"".concat(typeof o=="function"?o(U.value,ne):U.value).concat(l||"")}))});return h.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(w,"-ticks")},V.length>0&&h.createElement(zn,{zIndex:en.label},h.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(w,"-tick-labels"),ref:t},V)),$.length>0&&h.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(w,"-tick-lines")},$))}),DB=h.forwardRef((e,t)=>{var{axisLine:n,width:i,height:a,className:s,hide:o,ticks:l,axisType:c}=e,d=Td(e,bB),[u,f]=h.useState(""),[m,p]=h.useState(""),y=h.useRef(null);h.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var g;return xB({ticks:y.current,label:(g=e.labelRef)===null||g===void 0?void 0:g.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var v=h.useCallback(g=>{if(g){var b=g.getElementsByClassName("recharts-cartesian-axis-tick-value");y.current=b;var x=b[0];if(x){var N=window.getComputedStyle(x),A=N.fontSize,C=N.letterSpacing;(A!==u||C!==m)&&(f(A),p(C))}}},[u,m]);return o||i!=null&&i<=0||a!=null&&a<=0?null:h.createElement(zn,{zIndex:e.zIndex},h.createElement(mn,{className:ut("recharts-cartesian-axis",s)},h.createElement(CB,{x:e.x,y:e.y,width:i,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:n,otherSvgProps:Kn(e)}),h.createElement(OB,{ref:v,axisType:c,events:d,fontSize:u,getTicksConfig:e,height:e.height,letterSpacing:m,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:l,unit:e.unit,width:e.width,x:e.x,y:e.y}),h.createElement(O4,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},h.createElement(F4,{label:e.label,labelRef:e.labelRef}),e.children)))}),_B=h.memo(DB,(e,t)=>{var{viewBox:n}=e,i=Td(e,jB),{viewBox:a}=t,s=Td(t,wB);return wa(n,a)&&wa(i,s)}),am=h.forwardRef((e,t)=>{var n=pn(e,im);return h.createElement(_B,Hi({},n,{ref:t}))});am.displayName="CartesianAxis";var MB=["x1","y1","x2","y2","key"],LB=["offset"],$B=["xAxisId","yAxisId"],zB=["xAxisId","yAxisId"];function dv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function wn(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dv(Object(n),!0).forEach(function(i){RB(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dv(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function RB(e,t,n){return(t=BB(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function BB(e){var t=WB(e,"string");return typeof t=="symbol"?t:t+""}function WB(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Oi(){return Oi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Oi.apply(null,arguments)}function bl(e,t){if(e==null)return{};var n,i,a=FB(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function FB(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}var qB=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:n,x:i,y:a,width:s,height:o,ry:l}=e;return h.createElement("rect",{x:i,y:a,ry:l,width:s,height:o,stroke:"none",fill:t,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function pw(e){var{option:t,lineItemProps:n}=e,i;if(h.isValidElement(t))i=h.cloneElement(t,n);else if(typeof t=="function")i=t(n);else{var a,{x1:s,y1:o,x2:l,y2:c,key:d}=n,u=bl(n,MB),f=(a=Kn(u))!==null&&a!==void 0?a:{},{offset:m}=f,p=bl(f,LB);i=h.createElement("line",Oi({},p,{x1:s,y1:o,x2:l,y2:c,fill:"none",key:d}))}return i}function UB(e){var{x:t,width:n,horizontal:i=!0,horizontalPoints:a}=e;if(!i||!a||!a.length)return null;var{xAxisId:s,yAxisId:o}=e,l=bl(e,$B),c=a.map((d,u)=>{var f=wn(wn({},l),{},{x1:t,y1:d,x2:t+n,y2:d,key:"line-".concat(u),index:u});return h.createElement(pw,{key:"line-".concat(u),option:i,lineItemProps:f})});return h.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function HB(e){var{y:t,height:n,vertical:i=!0,verticalPoints:a}=e;if(!i||!a||!a.length)return null;var{xAxisId:s,yAxisId:o}=e,l=bl(e,zB),c=a.map((d,u)=>{var f=wn(wn({},l),{},{x1:d,y1:t,x2:d,y2:t+n,key:"line-".concat(u),index:u});return h.createElement(pw,{option:i,lineItemProps:f,key:"line-".concat(u)})});return h.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function YB(e){var{horizontalFill:t,fillOpacity:n,x:i,y:a,width:s,height:o,horizontalPoints:l,horizontal:c=!0}=e;if(!c||!t||!t.length||l==null)return null;var d=l.map(f=>Math.round(f+a-a)).sort((f,m)=>f-m);a!==d[0]&&d.unshift(0);var u=d.map((f,m)=>{var p=!d[m+1],y=p?a+o-f:d[m+1]-f;if(y<=0)return null;var v=m%t.length;return h.createElement("rect",{key:"react-".concat(m),y:f,x:i,height:y,width:s,stroke:"none",fill:t[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return h.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function KB(e){var{vertical:t=!0,verticalFill:n,fillOpacity:i,x:a,y:s,width:o,height:l,verticalPoints:c}=e;if(!t||!n||!n.length)return null;var d=c.map(f=>Math.round(f+a-a)).sort((f,m)=>f-m);a!==d[0]&&d.unshift(0);var u=d.map((f,m)=>{var p=!d[m+1],y=p?a+o-f:d[m+1]-f;if(y<=0)return null;var v=m%n.length;return h.createElement("rect",{key:"react-".concat(m),x:f,y:s,width:y,height:l,stroke:"none",fill:n[v],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return h.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var VB=(e,t)=>{var{xAxis:n,width:i,height:a,offset:s}=e;return U0(rm(wn(wn(wn({},im),n),{},{ticks:H0(n),viewBox:{x:0,y:0,width:i,height:a}})),s.left,s.left+s.width,t)},XB=(e,t)=>{var{yAxis:n,width:i,height:a,offset:s}=e;return U0(rm(wn(wn(wn({},im),n),{},{ticks:H0(n),viewBox:{x:0,y:0,width:i,height:a}})),s.top,s.top+s.height,t)},GB={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:en.grid};function jl(e){var t=rb(),n=ib(),i=nb(),a=wn(wn({},pn(e,GB)),{},{x:Be(e.x)?e.x:i.left,y:Be(e.y)?e.y:i.top,width:Be(e.width)?e.width:i.width,height:Be(e.height)?e.height:i.height}),{xAxisId:s,yAxisId:o,x:l,y:c,width:d,height:u,syncWithTicks:f,horizontalValues:m,verticalValues:p}=a,y=kn(),v=We(B=>py(B,"xAxis",s,y)),g=We(B=>py(B,"yAxis",o,y));if(!Er(d)||!Er(u)||!Be(l)||!Be(c))return null;var b=a.verticalCoordinatesGenerator||VB,x=a.horizontalCoordinatesGenerator||XB,{horizontalPoints:N,verticalPoints:A}=a;if((!N||!N.length)&&typeof x=="function"){var C=m&&m.length,w=x({yAxis:g?wn(wn({},g),{},{ticks:C?m:g.ticks}):void 0,width:t??d,height:n??u,offset:i},C?!0:f);Ko(Array.isArray(w),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof w,"]")),Array.isArray(w)&&(N=w)}if((!A||!A.length)&&typeof b=="function"){var O=p&&p.length,M=b({xAxis:v?wn(wn({},v),{},{ticks:O?p:v.ticks}):void 0,width:t??d,height:n??u,offset:i},O?!0:f);Ko(Array.isArray(M),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof M,"]")),Array.isArray(M)&&(A=M)}return h.createElement(zn,{zIndex:a.zIndex},h.createElement("g",{className:"recharts-cartesian-grid"},h.createElement(qB,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),h.createElement(YB,Oi({},a,{horizontalPoints:N})),h.createElement(KB,Oi({},a,{verticalPoints:A})),h.createElement(UB,Oi({},a,{offset:i,horizontalPoints:N,xAxis:v,yAxis:g})),h.createElement(HB,Oi({},a,{offset:i,verticalPoints:A,xAxis:v,yAxis:g}))))}jl.displayName="CartesianGrid";var gw=(e,t,n,i)=>fi(e,"xAxis",t,i),yw=(e,t,n,i)=>di(e,"xAxis",t,i),vw=(e,t,n,i)=>fi(e,"yAxis",n,i),xw=(e,t,n,i)=>di(e,"yAxis",n,i),QB=pe([ot,gw,vw,yw,xw],(e,t,n,i,a)=>gi(e,"xAxis")?va(t,i,!1):va(n,a,!1)),JB=(e,t,n,i,a)=>a;function ZB(e){return e.type==="line"}var eW=pe([mc,JB],(e,t)=>e.filter(ZB).find(n=>n.id===t)),tW=pe([ot,gw,vw,yw,xw,eW,QB,oc],(e,t,n,i,a,s,o,l)=>{var{chartData:c,dataStartIndex:d,dataEndIndex:u}=l;if(!(s==null||t==null||n==null||i==null||a==null||i.length===0||a.length===0||o==null)){var{dataKey:f,data:m}=s,p;if(m!=null&&m.length>0?p=m:p=c==null?void 0:c.slice(d,u+1),p!=null)return wW({layout:e,xAxis:t,yAxis:n,xAxisTicks:i,yAxisTicks:a,dataKey:f,bandSize:o,displayedData:p})}});function nW(e){var t=Ri(e),n=3,i=2;if(t!=null){var{r:a,strokeWidth:s}=t,o=Number(a),l=Number(s);return(Number.isNaN(o)||o<0)&&(o=n),(Number.isNaN(l)||l<0)&&(l=i),{r:o,strokeWidth:l}}return{r:n,strokeWidth:i}}var rW=["id"],iW=["type","layout","connectNulls","needClip","shape"],aW=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function js(){return js=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},js.apply(null,arguments)}function fv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function wr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?fv(Object(n),!0).forEach(function(i){sW(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fv(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function sW(e,t,n){return(t=oW(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oW(e){var t=lW(e,"string");return typeof t=="symbol"?t:t+""}function lW(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sm(e,t){if(e==null)return{};var n,i,a=cW(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function cW(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}var uW=e=>{var{dataKey:t,name:n,stroke:i,legendType:a,hide:s}=e;return[{inactive:s,dataKey:t,type:a,color:i,value:ka(n,t),payload:e}]};function dW(e){var{dataKey:t,data:n,stroke:i,strokeWidth:a,fill:s,name:o,hide:l,unit:c}=e;return{dataDefinedOnItem:n,positions:void 0,settings:{stroke:i,strokeWidth:a,fill:s,dataKey:t,nameKey:void 0,name:ka(o,t),hide:l,type:e.tooltipType,color:e.stroke,unit:c}}}var bw=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function fW(e,t){for(var n=e.length%2!==0?[...e,0]:e,i=[],a=0;a<t;++a)i=[...i,...n];return i}var hW=(e,t,n)=>{var i=n.reduce((f,m)=>f+m);if(!i)return bw(t,e);for(var a=Math.floor(e/i),s=e%i,o=t-e,l=[],c=0,d=0;c<n.length;d+=n[c],++c)if(d+n[c]>s){l=[...n.slice(0,c),s-d];break}var u=l.length%2===0?[0,o]:[o];return[...fW(n,a),...l,...u].map(f=>"".concat(f,"px")).join(", ")};function mW(e){var{clipPathId:t,points:n,props:i}=e,{dot:a,dataKey:s,needClip:o}=i,{id:l}=i,c=sm(i,rW),d=Kn(c);return h.createElement(wR,{points:n,dot:a,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:s,baseProps:d,needClip:o,clipPathId:t})}function pW(e){var{showLabels:t,children:n,points:i}=e,a=h.useMemo(()=>i==null?void 0:i.map(s=>{var o,l,c={x:(o=s.x)!==null&&o!==void 0?o:0,y:(l=s.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return wr(wr({},c),{},{value:s.value,payload:s.payload,viewBox:c,parentViewBox:void 0,fill:void 0})}),[i]);return h.createElement(qj,{value:t?a:void 0},n)}function hv(e){var{clipPathId:t,pathRef:n,points:i,strokeDasharray:a,props:s}=e,{type:o,layout:l,connectNulls:c,needClip:d,shape:u}=s,f=sm(s,iW),m=wr(wr({},In(f)),{},{fill:"none",className:"recharts-line-curve",clipPath:d?"url(#clipPath-".concat(t,")"):void 0,points:i,type:o,layout:l,connectNulls:c,strokeDasharray:a??s.strokeDasharray});return h.createElement(h.Fragment,null,(i==null?void 0:i.length)>1&&h.createElement(Yh,js({shapeType:"curve",option:u},m,{pathRef:n})),h.createElement(mW,{points:i,clipPathId:t,props:s}))}function gW(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function yW(e){var{clipPathId:t,props:n,pathRef:i,previousPointsRef:a,longestAnimatedLengthRef:s}=e,{points:o,strokeDasharray:l,isAnimationActive:c,animationBegin:d,animationDuration:u,animationEasing:f,animateNewValues:m,width:p,height:y,onAnimationEnd:v,onAnimationStart:g}=n,b=a.current,x=Ps(n,"recharts-line-"),[N,A]=h.useState(!1),C=!N,w=h.useCallback(()=>{typeof v=="function"&&v(),A(!1)},[v]),O=h.useCallback(()=>{typeof g=="function"&&g(),A(!0)},[g]),M=gW(i.current),B=s.current;return h.createElement(pW,{points:o,showLabels:C},n.children,h.createElement(Is,{animationId:x,begin:d,duration:u,isActive:c,easing:f,onAnimationEnd:w,onAnimationStart:O,key:x},z=>{var j=Ot(B,M+B,z),k=Math.min(j,M),L;if(c)if(l){var T="".concat(l).split(/[,\s]+/gim).map(G=>parseFloat(G));L=hW(k,M,T)}else L=bw(M,k);else L=l==null?void 0:String(l);if(b){var $=b.length/o.length,V=z===1?o:o.map((G,ne)=>{var U=Math.floor(ne*$);if(b[U]){var I=b[U];return wr(wr({},G),{},{x:Ot(I.x,G.x,z),y:Ot(I.y,G.y,z)})}return m?wr(wr({},G),{},{x:Ot(p*2,G.x,z),y:Ot(y/2,G.y,z)}):wr(wr({},G),{},{x:G.x,y:G.y})});return a.current=V,h.createElement(hv,{props:n,points:V,clipPathId:t,pathRef:i,strokeDasharray:L})}return z>0&&M>0&&(a.current=o,s.current=k),h.createElement(hv,{props:n,points:o,clipPathId:t,pathRef:i,strokeDasharray:L})}),h.createElement(Bh,{label:n.label}))}function vW(e){var{clipPathId:t,props:n}=e,i=h.useRef(null),a=h.useRef(0),s=h.useRef(null);return h.createElement(yW,{props:n,clipPathId:t,previousPointsRef:i,longestAnimatedLengthRef:a,pathRef:s})}var xW=(e,t)=>{var n,i;return{x:(n=e.x)!==null&&n!==void 0?n:void 0,y:(i=e.y)!==null&&i!==void 0?i:void 0,value:e.value,errorVal:kt(e.payload,t)}};class bW extends h.Component{render(){var{hide:t,dot:n,points:i,className:a,xAxisId:s,yAxisId:o,top:l,left:c,width:d,height:u,id:f,needClip:m,zIndex:p}=this.props;if(t)return null;var y=ut("recharts-line",a),v=f,{r:g,strokeWidth:b}=nW(n),x=Jj(n),N=g*2+b;return h.createElement(zn,{zIndex:p},h.createElement(mn,{className:y},m&&h.createElement("defs",null,h.createElement(lw,{clipPathId:v,xAxisId:s,yAxisId:o}),!x&&h.createElement("clipPath",{id:"clipPath-dots-".concat(v)},h.createElement("rect",{x:c-N/2,y:l-N/2,width:d+N,height:u+N}))),h.createElement(ow,{xAxisId:s,yAxisId:o,data:i,dataPointFormatter:xW,errorBarOffset:0},h.createElement(vW,{props:this.props,clipPathId:v}))),h.createElement(BR,{activeDot:this.props.activeDot,points:i,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var jw={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!yi.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:en.line};function jW(e){var t=pn(e,jw),{activeDot:n,animateNewValues:i,animationBegin:a,animationDuration:s,animationEasing:o,connectNulls:l,dot:c,hide:d,isAnimationActive:u,label:f,legendType:m,xAxisId:p,yAxisId:y,id:v}=t,g=sm(t,aW),{needClip:b}=em(p,y),x=Zh(),N=Es(),A=kn(),C=We(z=>tW(z,p,y,A,v));if(N!=="horizontal"&&N!=="vertical"||C==null||x==null)return null;var{height:w,width:O,x:M,y:B}=x;return h.createElement(bW,js({},g,{id:v,connectNulls:l,dot:c,activeDot:n,animateNewValues:i,animationBegin:a,animationDuration:s,animationEasing:o,isAnimationActive:u,hide:d,label:f,legendType:m,xAxisId:p,yAxisId:y,points:C,layout:N,height:w,width:O,left:M,top:B,needClip:b}))}function wW(e){var{layout:t,xAxis:n,yAxis:i,xAxisTicks:a,yAxisTicks:s,dataKey:o,bandSize:l,displayedData:c}=e;return c.map((d,u)=>{var f=kt(d,o);if(t==="horizontal"){var m=Gp({axis:n,ticks:a,bandSize:l,entry:d,index:u}),p=Mt(f)?null:i.scale(f);return{x:m,y:p,value:f,payload:d}}var y=Mt(f)?null:n.scale(f),v=Gp({axis:i,ticks:s,bandSize:l,entry:d,index:u});return y==null||v==null?null:{x:y,y:v,value:f,payload:d}}).filter(Boolean)}function SW(e){var t=pn(e,jw),n=kn();return h.createElement(Qh,{id:t.id,type:"line"},i=>h.createElement(h.Fragment,null,h.createElement(ew,{legendPayload:uW(t)}),h.createElement(Gh,{fn:dW,args:t}),h.createElement(rw,{type:"line",id:i,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:n}),h.createElement(jW,js({},t,{id:i}))))}var ww=h.memo(SW);ww.displayName="Line";var NW=["dangerouslySetInnerHTML","ticks"],kW=["id"],AW=["domain"],CW=["domain"];function Od(){return Od=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Od.apply(null,arguments)}function wl(e,t){if(e==null)return{};var n,i,a=EW(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function EW(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function IW(e){var t=Lt();return h.useLayoutEffect(()=>(t(CR(e)),()=>{t(ER(e))}),[e,t]),null}var PW=e=>{var{xAxisId:t,className:n}=e,i=We(Cf),a=kn(),s="xAxis",o=We(g=>Oa(g,s,t,a)),l=We(g=>G1(g,s,t,a)),c=We(g=>Y1(g,t)),d=We(g=>WL(g,t)),u=We(g=>A1(g,t));if(c==null||d==null||u==null)return null;var{dangerouslySetInnerHTML:f,ticks:m}=e,p=wl(e,NW),{id:y}=u,v=wl(u,kW);return h.createElement(am,Od({},p,v,{scale:o,x:d.x,y:d.y,width:c.width,height:c.height,className:ut("recharts-".concat(s," ").concat(s),n),viewBox:i,ticks:l,axisType:s}))},TW={allowDataOverflow:Wn.allowDataOverflow,allowDecimals:Wn.allowDecimals,allowDuplicatedCategory:Wn.allowDuplicatedCategory,height:Wn.height,hide:!1,mirror:Wn.mirror,orientation:Wn.orientation,padding:Wn.padding,reversed:Wn.reversed,scale:Wn.scale,tickCount:Wn.tickCount,type:Wn.type,xAxisId:0},OW=e=>{var t,n,i,a,s,o=pn(e,TW);return h.createElement(h.Fragment,null,h.createElement(IW,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:(n=o.includeHidden)!==null&&n!==void 0?n:!1,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(i=o.angle)!==null&&i!==void 0?i:0,minTickGap:(a=o.minTickGap)!==null&&a!==void 0?a:5,tick:(s=o.tick)!==null&&s!==void 0?s:!0,tickFormatter:o.tickFormatter}),h.createElement(PW,o))},DW=(e,t)=>{var{domain:n}=e,i=wl(e,AW),{domain:a}=t,s=wl(t,CW);return wa(i,s)?Array.isArray(n)&&n.length===2&&Array.isArray(a)&&a.length===2?n[0]===a[0]&&n[1]===a[1]:wa({domain:n},{domain:a}):!1},Sl=h.memo(OW,DW);Sl.displayName="XAxis";var _W=["dangerouslySetInnerHTML","ticks"],MW=["id"],LW=["domain"],$W=["domain"];function Dd(){return Dd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Dd.apply(null,arguments)}function Nl(e,t){if(e==null)return{};var n,i,a=zW(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function zW(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function RW(e){var t=Lt();return h.useLayoutEffect(()=>(t(IR(e)),()=>{t(PR(e))}),[e,t]),null}var BW=e=>{var{yAxisId:t,className:n,width:i,label:a}=e,s=h.useRef(null),o=h.useRef(null),l=We(Cf),c=kn(),d=Lt(),u="yAxis",f=We(C=>Oa(C,u,t,c)),m=We(C=>K1(C,t)),p=We(C=>qL(C,t)),y=We(C=>G1(C,u,t,c)),v=We(C=>C1(C,t));if(h.useLayoutEffect(()=>{if(!(i!=="auto"||!m||Rh(a)||h.isValidElement(a)||v==null)){var C=s.current;if(C){var w=C.getCalculatedWidth();Math.round(m.width)!==Math.round(w)&&d(TR({id:t,width:w}))}}},[y,m,d,a,t,i,v]),m==null||p==null||v==null)return null;var{dangerouslySetInnerHTML:g,ticks:b}=e,x=Nl(e,_W),{id:N}=v,A=Nl(v,MW);return h.createElement(am,Dd({},x,A,{ref:s,labelRef:o,scale:f,x:p.x,y:p.y,tickTextProps:i==="auto"?{width:void 0}:{width:i},width:m.width,height:m.height,className:ut("recharts-".concat(u," ").concat(u),n),viewBox:l,ticks:y,axisType:u}))},WW={allowDataOverflow:Fn.allowDataOverflow,allowDecimals:Fn.allowDecimals,allowDuplicatedCategory:Fn.allowDuplicatedCategory,hide:!1,mirror:Fn.mirror,orientation:Fn.orientation,padding:Fn.padding,reversed:Fn.reversed,scale:Fn.scale,tickCount:Fn.tickCount,type:Fn.type,width:Fn.width,yAxisId:0},FW=e=>{var t,n,i,a,s,o=pn(e,WW);return h.createElement(h.Fragment,null,h.createElement(RW,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:(n=o.includeHidden)!==null&&n!==void 0?n:!1,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(i=o.angle)!==null&&i!==void 0?i:0,minTickGap:(a=o.minTickGap)!==null&&a!==void 0?a:5,tick:(s=o.tick)!==null&&s!==void 0?s:!0,tickFormatter:o.tickFormatter}),h.createElement(BW,o))},qW=(e,t)=>{var{domain:n}=e,i=Nl(e,LW),{domain:a}=t,s=Nl(t,$W);return wa(i,s)?Array.isArray(n)&&n.length===2&&Array.isArray(a)&&a.length===2?n[0]===a[0]&&n[1]===a[1]:wa({domain:n},{domain:a}):!1},kl=h.memo(FW,qW);kl.displayName="YAxis";var UW={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qs=h;function HW(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var YW=typeof Object.is=="function"?Object.is:HW,KW=qs.useSyncExternalStore,VW=qs.useRef,XW=qs.useEffect,GW=qs.useMemo,QW=qs.useDebugValue;UW.useSyncExternalStoreWithSelector=function(e,t,n,i,a){var s=VW(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=GW(function(){function c(p){if(!d){if(d=!0,u=p,p=i(p),a!==void 0&&o.hasValue){var y=o.value;if(a(y,p))return f=y}return f=p}if(y=f,YW(u,p))return y;var v=i(p);return a!==void 0&&a(y,v)?(u=p,y):(u=p,f=v)}var d=!1,u,f,m=n===void 0?null:n;return[function(){return c(t())},m===null?void 0:function(){return c(m())}]},[t,n,i,a]);var l=KW(e,s[0],s[1]);return XW(function(){o.hasValue=!0,o.value=l},[l]),QW(l),l};function JW(e){e()}function ZW(){let e=null,t=null;return{clear(){e=null,t=null},notify(){JW(()=>{let n=e;for(;n;)n.callback(),n=n.next})},get(){const n=[];let i=e;for(;i;)n.push(i),i=i.next;return n},subscribe(n){let i=!0;const a=t={callback:n,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!i||e===null||(i=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var mv={notify(){},get:()=>[]};function eF(e,t){let n,i=mv,a=0,s=!1;function o(v){u();const g=i.subscribe(v);let b=!1;return()=>{b||(b=!0,g(),f())}}function l(){i.notify()}function c(){y.onStateChange&&y.onStateChange()}function d(){return s}function u(){a++,n||(n=e.subscribe(c),i=ZW())}function f(){a--,n&&a===0&&(n(),n=void 0,i.clear(),i=mv)}function m(){s||(s=!0,u())}function p(){s&&(s=!1,f())}const y={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:d,trySubscribe:m,tryUnsubscribe:p,getListeners:()=>i};return y}var tF=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",nF=tF(),rF=()=>typeof navigator<"u"&&navigator.product==="ReactNative",iF=rF(),aF=()=>nF||iF?h.useLayoutEffect:h.useEffect,sF=aF(),Cu=Symbol.for("react-redux-context"),Eu=typeof globalThis<"u"?globalThis:{};function oF(){if(!h.createContext)return{};const e=Eu[Cu]??(Eu[Cu]=new Map);let t=e.get(h.createContext);return t||(t=h.createContext(null),e.set(h.createContext,t)),t}var lF=oF();function cF(e){const{children:t,context:n,serverState:i,store:a}=e,s=h.useMemo(()=>{const c=eF(a);return{store:a,subscription:c,getServerState:i?()=>i:void 0}},[a,i]),o=h.useMemo(()=>a.getState(),[a]);sF(()=>{const{subscription:c}=s;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),o!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[s,o]);const l=n||lF;return h.createElement(l.Provider,{value:s},t)}var uF=cF,dF=(e,t)=>t,om=pe([dF,ot,N1,cn,hj,ti,e$,on],o$),lm=e=>{var t=e.currentTarget.getBoundingClientRect(),n=t.width/e.currentTarget.offsetWidth,i=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/n),chartY:Math.round((e.clientY-t.top)/i)}},Sw=rr("mouseClick"),Nw=As();Nw.startListening({actionCreator:Sw,effect:(e,t)=>{var n=e.payload,i=om(t.getState(),lm(n));(i==null?void 0:i.activeIndex)!=null&&t.dispatch(n8({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}});var _d=rr("mouseMove"),kw=As();kw.startListening({actionCreator:_d,effect:(e,t)=>{var n=e.payload,i=t.getState(),a=Ih(i,i.tooltip.settings.shared),s=om(i,lm(n));a==="axis"&&((s==null?void 0:s.activeIndex)!=null?t.dispatch(ij({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate})):t.dispatch(rj()))}});var pv={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0},Aw=$n({name:"rootProps",initialState:pv,reducers:{updateOptions:(e,t)=>{var n;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(n=t.payload.barGap)!==null&&n!==void 0?n:pv.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue}}}),fF=Aw.reducer,{updateOptions:hF}=Aw.actions,Cw=$n({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:mF}=Cw.actions,pF=Cw.reducer,Ew=rr("keyDown"),Iw=rr("focus"),cm=As();cm.startListening({actionCreator:Ew,effect:(e,t)=>{var n=t.getState(),i=n.rootProps.accessibilityLayer!==!1;if(i){var{keyboardInteraction:a}=n.tooltip,s=e.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=Number(Ph(a,_a(n))),l=ti(n);if(s==="Enter"){var c=fl(n,"axis","hover",String(a.index));t.dispatch(Sd({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:c}));return}var d=KL(n),u=d==="left-to-right"?1:-1,f=s==="ArrowRight"?1:-1,m=o+f*u;if(!(l==null||m>=l.length||m<0)){var p=fl(n,"axis","hover",String(m));t.dispatch(Sd({active:!0,activeIndex:m.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});cm.startListening({actionCreator:Iw,effect:(e,t)=>{var n=t.getState(),i=n.rootProps.accessibilityLayer!==!1;if(i){var{keyboardInteraction:a}=n.tooltip;if(!a.active&&a.index==null){var s="0",o=fl(n,"axis","hover",String(s));t.dispatch(Sd({activeDataKey:void 0,active:!0,activeIndex:s,activeCoordinate:o}))}}}});var er=rr("externalEvent"),Pw=As();Pw.startListening({actionCreator:er,effect:(e,t)=>{if(e.payload.handler!=null){var n=t.getState(),i={activeCoordinate:z8(n),activeDataKey:yj(n),activeIndex:hi(n),activeLabel:gj(n),activeTooltipIndex:hi(n),isTooltipActive:R8(n)};e.payload.handler(i,e.payload.reactEvent)}}});var gF=pe([Da],e=>e.tooltipItemPayloads),yF=pe([gF,Bs,(e,t,n)=>t,(e,t,n)=>n],(e,t,n,i)=>{var a=e.find(l=>l.settings.dataKey===i);if(a!=null){var{positions:s}=a;if(s!=null){var o=t(s,n);return o}}}),Tw=rr("touchMove"),Ow=As();Ow.startListening({actionCreator:Tw,effect:(e,t)=>{var n=e.payload;if(!(n.touches==null||n.touches.length===0)){var i=t.getState(),a=Ih(i,i.tooltip.settings.shared);if(a==="axis"){var s=om(i,lm({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));(s==null?void 0:s.activeIndex)!=null&&t.dispatch(ij({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}else if(a==="item"){var o,l=n.touches[0];if(document.elementFromPoint==null)return;var c=document.elementFromPoint(l.clientX,l.clientY);if(!c||!c.getAttribute)return;var d=c.getAttribute(K0),u=(o=c.getAttribute(V0))!==null&&o!==void 0?o:void 0,f=yF(t.getState(),d,u);t.dispatch(nj({activeDataKey:u,activeIndex:d,activeCoordinate:f}))}}}});var vF=v0({brush:eB,cartesianAxis:OR,chartData:$$,errorBars:JR,graphicalItems:Fz,layout:XT,legend:BO,options:O$,polarAxis:az,polarOptions:pF,referenceElements:oB,rootProps:fF,tooltip:r8,zIndex:j$}),xF=function(t){return bT({reducer:vF,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([Nw.middleware,kw.middleware,cm.middleware,Pw.middleware,Ow.middleware]),enhancers:n=>{var i=n;return typeof n=="function"&&(i=n()),i.concat(P0({type:"raf"}))},devTools:yi.devToolsEnabled})};function Dw(e){var{preloadedState:t,children:n,reduxStoreName:i}=e,a=kn(),s=h.useRef(null);if(a)return n;s.current==null&&(s.current=xF(t));var o=xf;return h.createElement(uF,{context:o,store:s.current},n)}function _w(e){var{layout:t,margin:n}=e,i=Lt(),a=kn();return h.useEffect(()=>{a||(i(YT(t)),i(HT(n)))},[i,a,t,n]),null}function Mw(e){var t=Lt();return h.useEffect(()=>{t(hF(e))},[t,e]),null}function gv(e){var{zIndex:t,isPanorama:n}=e,i=n?"recharts-zindex-panorama-":"recharts-zindex-",a=tw("".concat(i).concat(t)),s=Lt();return h.useLayoutEffect(()=>(s(x$({zIndex:t,elementId:a,isPanorama:n})),()=>{s(b$({zIndex:t,isPanorama:n}))}),[s,t,a,n]),h.createElement("g",{id:a})}function yv(e){var{children:t,isPanorama:n}=e,i=We(c$);if(!i||i.length===0)return t;var a=i.filter(o=>o<0),s=i.filter(o=>o>0);return h.createElement(h.Fragment,null,a.map(o=>h.createElement(gv,{key:o,zIndex:o,isPanorama:n})),t,s.map(o=>h.createElement(gv,{key:o,zIndex:o,isPanorama:n})))}var bF=["children"];function jF(e,t){if(e==null)return{};var n,i,a=wF(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function wF(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}function Al(){return Al=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Al.apply(null,arguments)}var SF={width:"100%",height:"100%",display:"block"},NF=h.forwardRef((e,t)=>{var n=rb(),i=ib(),a=lb();if(!Er(n)||!Er(i))return null;var{children:s,otherAttributes:o,title:l,desc:c}=e,d,u;return o!=null&&(typeof o.tabIndex=="number"?d=o.tabIndex:d=a?0:void 0,typeof o.role=="string"?u=o.role:u=a?"application":void 0),h.createElement(xx,Al({},o,{title:l,desc:c,role:u,tabIndex:d,width:n,height:i,style:SF,ref:t}),s)}),kF=e=>{var{children:t}=e,n=We(Jl);if(!n)return null;var{width:i,height:a,y:s,x:o}=n;return h.createElement(xx,{width:i,height:a,x:o,y:s},t)},vv=h.forwardRef((e,t)=>{var{children:n}=e,i=jF(e,bF),a=kn();return a?h.createElement(kF,null,h.createElement(yv,{isPanorama:!0},n)):h.createElement(NF,Al({ref:t},i),h.createElement(yv,{isPanorama:!1},n))});function AF(){var e=Lt(),[t,n]=h.useState(null),i=We(hO);return h.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),s=a.width/t.offsetWidth;Xt(s)&&s!==i&&e(VT(s))}},[t,e,i]),n}function xv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,i)}return n}function CF(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?xv(Object(n),!0).forEach(function(i){EF(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xv(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function EF(e,t,n){return(t=IF(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function IF(e){var t=PF(e,"string");return typeof t=="symbol"?t:t+""}function PF(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,t);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yi(){return Yi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Yi.apply(null,arguments)}var TF=()=>(Y$(),null);function Cl(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var OF=h.forwardRef((e,t)=>{var n,i,a=h.useRef(null),[s,o]=h.useState({containerWidth:Cl((n=e.style)===null||n===void 0?void 0:n.width),containerHeight:Cl((i=e.style)===null||i===void 0?void 0:i.height)}),l=h.useCallback((d,u)=>{o(f=>{var m=Math.round(d),p=Math.round(u);return f.containerWidth===m&&f.containerHeight===p?f:{containerWidth:m,containerHeight:p}})},[]),c=h.useCallback(d=>{if(typeof t=="function"&&t(d),d!=null&&typeof ResizeObserver<"u"){var{width:u,height:f}=d.getBoundingClientRect();l(u,f);var m=y=>{var{width:v,height:g}=y[0].contentRect;l(v,g)},p=new ResizeObserver(m);p.observe(d),a.current=p}},[t,l]);return h.useEffect(()=>()=>{var d=a.current;d!=null&&d.disconnect()},[l]),h.createElement(h.Fragment,null,h.createElement(ec,{width:s.containerWidth,height:s.containerHeight}),h.createElement("div",Yi({ref:c},e)))}),DF=h.forwardRef((e,t)=>{var{width:n,height:i}=e,[a,s]=h.useState({containerWidth:Cl(n),containerHeight:Cl(i)}),o=h.useCallback((c,d)=>{s(u=>{var f=Math.round(c),m=Math.round(d);return u.containerWidth===f&&u.containerHeight===m?u:{containerWidth:f,containerHeight:m}})},[]),l=h.useCallback(c=>{if(typeof t=="function"&&t(c),c!=null){var{width:d,height:u}=c.getBoundingClientRect();o(d,u)}},[t,o]);return h.createElement(h.Fragment,null,h.createElement(ec,{width:a.containerWidth,height:a.containerHeight}),h.createElement("div",Yi({ref:l},e)))}),_F=h.forwardRef((e,t)=>{var{width:n,height:i}=e;return h.createElement(h.Fragment,null,h.createElement(ec,{width:n,height:i}),h.createElement("div",Yi({ref:t},e)))}),MF=h.forwardRef((e,t)=>{var{width:n,height:i}=e;return qr(n)||qr(i)?h.createElement(DF,Yi({},e,{ref:t})):h.createElement(_F,Yi({},e,{ref:t}))});function LF(e){return e===!0?OF:MF}var $F=h.forwardRef((e,t)=>{var{children:n,className:i,height:a,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:c,onMouseEnter:d,onMouseLeave:u,onMouseMove:f,onMouseUp:m,onTouchEnd:p,onTouchMove:y,onTouchStart:v,style:g,width:b,responsive:x,dispatchTouchEvents:N=!0}=e,A=h.useRef(null),C=Lt(),[w,O]=h.useState(null),[M,B]=h.useState(null),z=AF(),j=Ef(),k=(j==null?void 0:j.width)>0?j.width:b,L=(j==null?void 0:j.height)>0?j.height:a,T=h.useCallback(R=>{z(R),typeof t=="function"&&t(R),O(R),B(R),R!=null&&(A.current=R)},[z,t,O,B]),$=h.useCallback(R=>{C(Sw(R)),C(er({handler:s,reactEvent:R}))},[C,s]),V=h.useCallback(R=>{C(_d(R)),C(er({handler:d,reactEvent:R}))},[C,d]),G=h.useCallback(R=>{C(rj()),C(er({handler:u,reactEvent:R}))},[C,u]),ne=h.useCallback(R=>{C(_d(R)),C(er({handler:f,reactEvent:R}))},[C,f]),U=h.useCallback(()=>{C(Iw())},[C]),I=h.useCallback(R=>{C(Ew(R.key))},[C]),P=h.useCallback(R=>{C(er({handler:o,reactEvent:R}))},[C,o]),D=h.useCallback(R=>{C(er({handler:l,reactEvent:R}))},[C,l]),S=h.useCallback(R=>{C(er({handler:c,reactEvent:R}))},[C,c]),_=h.useCallback(R=>{C(er({handler:m,reactEvent:R}))},[C,m]),H=h.useCallback(R=>{C(er({handler:v,reactEvent:R}))},[C,v]),q=h.useCallback(R=>{N&&C(Tw(R)),C(er({handler:y,reactEvent:R}))},[C,N,y]),K=h.useCallback(R=>{C(er({handler:p,reactEvent:R}))},[C,p]),W=LF(x);return h.createElement(kj.Provider,{value:w},h.createElement(vI.Provider,{value:M},h.createElement(W,{width:k??(g==null?void 0:g.width),height:L??(g==null?void 0:g.height),className:ut("recharts-wrapper",i),style:CF({position:"relative",cursor:"default",width:k,height:L},g),onClick:$,onContextMenu:P,onDoubleClick:D,onFocus:U,onKeyDown:I,onMouseDown:S,onMouseEnter:V,onMouseLeave:G,onMouseMove:ne,onMouseUp:_,onTouchEnd:K,onTouchMove:q,onTouchStart:H,ref:T},h.createElement(TF,null),n)))}),zF=["width","height","responsive","children","className","style","compact","title","desc"];function RF(e,t){if(e==null)return{};var n,i,a=BF(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function BF(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}var Lw=h.forwardRef((e,t)=>{var{width:n,height:i,responsive:a,children:s,className:o,style:l,compact:c,title:d,desc:u}=e,f=RF(e,zF),m=Kn(f);return c?h.createElement(h.Fragment,null,h.createElement(ec,{width:n,height:i}),h.createElement(vv,{otherAttributes:m,title:d,desc:u},s)):h.createElement($F,{className:o,style:l,width:n,height:i,responsive:a??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},h.createElement(vv,{otherAttributes:m,title:d,desc:u,ref:t},h.createElement(cB,null,s)))});function Md(){return Md=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Md.apply(null,arguments)}var WF={top:5,right:5,bottom:5,left:5},FF={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:WF,reverseStackOrder:!1,syncMethod:"index",responsive:!1},$w=h.forwardRef(function(t,n){var i,a=pn(t.categoricalChartProps,FF),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,categoricalChartProps:d}=t,u={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:c,eventEmitter:void 0};return h.createElement(Dw,{preloadedState:{options:u},reduxStoreName:(i=d.id)!==null&&i!==void 0?i:s},h.createElement(dw,{chartData:d.data}),h.createElement(_w,{layout:a.layout,margin:a.margin}),h.createElement(Mw,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),h.createElement(Lw,Md({},a,{ref:n})))}),qF=["axis"],UF=h.forwardRef((e,t)=>h.createElement($w,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:qF,tooltipPayloadSearcher:zh,categoricalChartProps:e,ref:t})),HF=["axis","item"],zw=h.forwardRef((e,t)=>h.createElement($w,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:HF,tooltipPayloadSearcher:zh,categoricalChartProps:e,ref:t}));function YF(e){var t=Lt();return h.useEffect(()=>{t(mF(e))},[t,e]),null}var KF=["layout"];function Ld(){return Ld=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)({}).hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ld.apply(null,arguments)}function VF(e,t){if(e==null)return{};var n,i,a=XF(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(i=0;i<s.length;i++)n=s[i],t.indexOf(n)===-1&&{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}function XF(e,t){if(e==null)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(t.indexOf(i)!==-1)continue;n[i]=e[i]}return n}var GF={top:5,right:5,bottom:5,left:5},QF={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:GF,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},JF=h.forwardRef(function(t,n){var i,a=pn(t.categoricalChartProps,QF),{layout:s}=a,o=VF(a,KF),{chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u}=t,f={chartName:l,defaultTooltipEventType:c,validateTooltipEventTypes:d,tooltipPayloadSearcher:u,eventEmitter:void 0};return h.createElement(Dw,{preloadedState:{options:f},reduxStoreName:(i=a.id)!==null&&i!==void 0?i:l},h.createElement(dw,{chartData:a.data}),h.createElement(_w,{layout:s,margin:a.margin}),h.createElement(Mw,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),h.createElement(YF,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),h.createElement(Lw,Ld({},o,{ref:n})))}),ZF=["item"],e5={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},t5=h.forwardRef((e,t)=>{var n=pn(e,e5);return h.createElement(JF,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:ZF,tooltipPayloadSearcher:zh,categoricalChartProps:n,ref:t})});const Ao={high:"#ef4444",medium:"#f59e0b",low:"#10b981",default:"#e5e7eb"};function n5(){const[e,t]=h.useState([]),[n,i]=h.useState(!1),[a,s]=h.useState(null),[o,l]=h.useState("all"),[c,d]=h.useState(""),[u,f]=h.useState(""),[m,p]=h.useState(""),[y,v]=h.useState(!1),[g,b]=h.useState(""),[x,N]=h.useState(new Date().toISOString().split("T")[0]),[A,C]=h.useState(""),[w,O]=h.useState(!1),M=async()=>{i(!0),s(null);try{const k=new URLSearchParams;o!=="all"&&k.append("status",o),c&&k.append("fromDate",c),u&&k.append("toDate",u);const L=await fetch(`/api/v1/credit/meetings?${k.toString()}`);if(!L.ok)throw new Error(`API 호출 실패: ${L.status}`);const $=((await L.json()).meetings||[]).map(V=>{var G;return{id:V.id,title:V.meeting_name,meetingDate:V.meeting_date,status:((G=V.meeting_status)==null?void 0:G.toLowerCase())==="closed"?"completed":"in_progress",customerCount:V.customer_count||0,highRiskCount:V.high_risk_count||0,mediumRiskCount:V.medium_risk_count||0,lowRiskCount:V.low_risk_count||0,createdAt:V.created_at}});t($)}catch(k){console.error("채권회의 목록 조회 실패:",k),s(k.message||"데이터 조회 중 오류가 발생했습니다.")}finally{i(!1)}};h.useEffect(()=>{M()},[]);const B=k=>{if(!k)return"-";const L=new Date(k);return new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}).format(L)},z=async()=>{if(!g||!x){alert("회의명과 일자를 입력해주세요.");return}O(!0);try{const k=await fetch("/api/v1/credit/meetings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({meetingCode:`MTG-${x.replace(/-/g,"")}`,meetingName:g,meetingDate:x,remark:A})});if(!k.ok)throw new Error("회의 생성 실패");const L=await k.json();if(L.success)v(!1),b(""),C(""),M();else throw new Error(L.error||"회의 생성 실패")}catch(k){alert(k.message)}finally{O(!1)}},j=k=>{const L=`credit:meeting:${k}`;window.location.hash=L,window.dispatchEvent(new CustomEvent("tnt.sales.navigate",{detail:{key:L}}))};return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{marginBottom:24,display:"flex",alignItems:"baseline",gap:12,justifyContent:"space-between"},children:[r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"채권회의"}),r.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"월별 채권 심사 및 리스크 관리 현황"})]}),r.jsxs("button",{className:"btn",onClick:()=>v(!0),style:{height:36,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",display:"flex",alignItems:"center",gap:6},children:[r.jsx(sS,{size:16}),"새 회의 생성"]})]}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",marginBottom:0},children:[r.jsxs("select",{className:"search-input",value:o,onChange:k=>l(k.target.value),style:{width:120},children:[r.jsx("option",{value:"all",children:"전체 상태"}),r.jsx("option",{value:"in_progress",children:"진행중"}),r.jsx("option",{value:"completed",children:"완료"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{type:"date",className:"search-input",value:c,onChange:k=>d(k.target.value),style:{width:130}}),r.jsx("span",{style:{color:"#9ca3af"},children:"~"}),r.jsx("input",{type:"date",className:"search-input",value:u,onChange:k=>f(k.target.value),style:{width:130}})]}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("input",{type:"text",className:"search-input",value:m,onChange:k=>p(k.target.value),placeholder:"회의명 검색",style:{width:200,paddingLeft:30}}),r.jsx(zi,{size:14,style:{position:"absolute",left:10,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}})]}),r.jsx("div",{style:{display:"flex",gap:8,marginLeft:"auto"},children:r.jsx("button",{className:"btn",onClick:M,disabled:n,style:{height:30,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",whiteSpace:"nowrap"},children:n?"조회 중...":"조회"})})]})]}),r.jsx("div",{style:{flex:1,overflow:"auto",padding:24},children:a?r.jsx("div",{style:{padding:16,color:"#ef4444",background:"#fef2f2",border:"1px solid #fee2e2",borderRadius:8},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx(qS,{size:16}),a]})}):e.length===0?r.jsxs("div",{className:"empty-state",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:300,gap:16},children:[r.jsx(Iu,{size:48,style:{opacity:.2}}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("p",{style:{fontSize:18,fontWeight:500,color:"#6b7280",margin:0},children:"등록된 채권회의가 없습니다."}),r.jsx("p",{style:{fontSize:14,color:"#9ca3af",marginTop:4},children:"새로운 회의를 생성하여 관리를 시작해보세요."})]})]}):r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:24},children:e.map(k=>{const L=[{name:"High",value:k.highRiskCount,color:Ao.high},{name:"Medium",value:k.mediumRiskCount,color:Ao.medium},{name:"Low",value:k.lowRiskCount,color:Ao.low}].filter(T=>T.value>0);return L.length===0&&L.push({name:"None",value:1,color:Ao.default}),r.jsxs("div",{onClick:()=>j(k.id),className:"card",style:{background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden",cursor:"pointer",transition:"all 0.2s",display:"flex",flexDirection:"column"},onMouseEnter:T=>{T.currentTarget.style.transform="translateY(-2px)",T.currentTarget.style.boxShadow="0 10px 15px -3px rgba(0, 0, 0, 0.1)",T.currentTarget.style.borderColor="#93c5fd"},onMouseLeave:T=>{T.currentTarget.style.transform="none",T.currentTarget.style.boxShadow="none",T.currentTarget.style.borderColor="#e5e7eb"},children:[r.jsxs("div",{style:{padding:20,borderBottom:"1px solid #f3f4f6",background:"linear-gradient(to right, #fff, #f9fafb)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[k.status==="completed"?r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,padding:"2px 8px",borderRadius:999,fontSize:11,fontWeight:600,background:"#dcfce7",color:"#15803d"},children:[r.jsx(Il,{size:12})," 완료됨"]}):r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,padding:"2px 8px",borderRadius:999,fontSize:11,fontWeight:600,background:"#dbeafe",color:"#1d4ed8"},children:[r.jsx(xS,{size:12})," 진행중"]}),r.jsxs("span",{style:{fontSize:11,color:"#9ca3af"},children:[k.createdAt.substring(0,10)," 생성"]})]}),r.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(ls,{size:16,color:"#9ca3af"})})]}),r.jsx("h3",{style:{fontSize:18,fontWeight:700,color:"#111827",margin:"0 0 8px 0",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:k.title}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:13,color:"#6b7280"},children:[r.jsx(Iu,{size:14}),B(k.meetingDate)]})]}),r.jsxs("div",{style:{padding:20,display:"flex",alignItems:"center",gap:24,flex:1},children:[r.jsxs("div",{style:{position:"relative",width:80,height:80,flexShrink:0},children:[r.jsx(Vo,{width:"100%",height:"100%",children:r.jsx(t5,{children:r.jsx(iw,{data:L,innerRadius:25,outerRadius:40,paddingAngle:2,dataKey:"value",stroke:"none",children:L.map((T,$)=>r.jsx(Qi,{fill:T.color},`cell-${$}`))})})}),r.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:[r.jsx("span",{style:{fontSize:10,fontWeight:600,color:"#9ca3af"},children:"Total"}),r.jsx("span",{style:{fontSize:16,fontWeight:700,color:"#111827",lineHeight:1},children:k.customerCount})]})]}),r.jsxs("div",{style:{flex:1,display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 8px"},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[r.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"고위험"}),r.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#ef4444"},children:k.highRiskCount})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[r.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"중위험"}),r.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#f59e0b"},children:k.mediumRiskCount})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[r.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"저위험"}),r.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#10b981"},children:k.lowRiskCount})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[r.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"심사대상"}),r.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#374151"},children:k.customerCount})]})]})]}),r.jsxs("div",{style:{padding:"12px 20px",background:"#f9fafb",borderTop:"1px solid #f3f4f6",fontSize:12,color:"#6b7280",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("span",{children:"관리자: 홍길동"}),r.jsxs("span",{style:{color:"#3b82f6",fontWeight:600,display:"flex",alignItems:"center",gap:4},children:["상세보기 ",r.jsx(ls,{size:12})]})]})]},k.id)})})}),y&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",backdropFilter:"blur(4px)",zIndex:50,display:"flex",alignItems:"center",justifyContent:"center",padding:16},children:r.jsxs("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",width:"100%",maxWidth:480,overflow:"hidden"},onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #f3f4f6",display:"flex",justifyContent:"space-between",alignItems:"center",background:"#f9fafb"},children:[r.jsx("h3",{style:{fontSize:18,fontWeight:700,color:"#111827",margin:0},children:"새 채권회의 생성"}),r.jsx("button",{onClick:()=>v(!1),style:{background:"none",border:"none",color:"#9ca3af",cursor:"pointer",padding:4},children:r.jsx("span",{style:{fontSize:24,lineHeight:1},children:"×"})})]}),r.jsxs("div",{style:{padding:24,display:"flex",flexDirection:"column",gap:20},children:[r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:6},children:["회의명 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("input",{type:"text",value:g,onChange:k=>b(k.target.value),placeholder:"예: 2025년 1월 정기 채권회의",className:"search-input",style:{width:"100%",height:42},autoFocus:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:6},children:["회의 일자 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("input",{type:"date",value:x,onChange:k=>N(k.target.value),className:"search-input",style:{width:"100%",height:42}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:6},children:"비고"}),r.jsx("textarea",{value:A,onChange:k=>C(k.target.value),rows:3,placeholder:"회의 관련 메모를 입력하세요",className:"search-input",style:{width:"100%",height:"auto",padding:"12px",resize:"none"}})]})]}),r.jsxs("div",{style:{padding:"16px 24px",background:"#f9fafb",borderTop:"1px solid #f3f4f6",display:"flex",justifyContent:"flex-end",gap:12},children:[r.jsx("button",{onClick:()=>v(!1),className:"btn",style:{background:"#f3f4f6",borderColor:"#e5e7eb",color:"#4b5563"},children:"취소"}),r.jsx("button",{onClick:z,disabled:w,className:"btn",style:{background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:w?.7:1},children:w?"생성 중...":"회의 생성"})]})]})})]})}function r5(){const t=(window.location.hash.replace("#","")||"credit:meeting:1").split(":")[2]||"1",[n,i]=h.useState(null),[a,s]=h.useState([]),[o,l]=h.useState(!1),[c,d]=h.useState("kanban"),[u,f]=h.useState(null),[m,p]=h.useState(!1),[y,v]=h.useState(""),[g,b]=h.useState("WATCH"),x=async()=>{l(!0);try{const B=await(await fetch(`/api/v1/credit/meetings/${t}`)).json();B.meeting&&i({id:B.meeting.id,meetingCode:B.meeting.meeting_code,meetingName:B.meeting.meeting_name,meetingDate:B.meeting.meeting_date,status:B.meeting.meeting_status,remark:B.meeting.remark});const z=(B.customers||[]).map(j=>({id:j.id,customerSeq:j.customer_seq,customerName:j.customer_name,riskLevel:"medium",totalAr:j.total_ar,overdue:j.overdue||0,decisionCode:j.decision_code,decisionComment:j.decision_comment,reviewFlag:j.review_flag}));s(z)}catch(M){console.error(M)}finally{l(!1)}};h.useEffect(()=>{x()},[t]);const N=M=>{f(M),v(M.decisionComment||""),b(M.decisionCode||"WATCH"),p(!0)},A=async()=>{u&&(alert("의견이 저장되었습니다."),p(!1),x())},C=M=>`₩${M.toLocaleString()}`,w=[{id:"WATCH",title:"관찰 (Watch)",color:"#fef3c7",textColor:"#92400e",borderColor:"#f59e0b"},{id:"REVIEW_UNBLOCK",title:"해제 검토",color:"#dbeafe",textColor:"#1e40af",borderColor:"#3b82f6"},{id:"KEEP_BLOCK",title:"차단 유지",color:"#fee2e2",textColor:"#991b1b",borderColor:"#ef4444"},{id:"APPROVED",title:"승인",color:"#dcfce7",textColor:"#166534",borderColor:"#22c55e"}],O=()=>a.filter(M=>!M.decisionCode);return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa",overflow:"hidden",position:"relative"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb",zIndex:10},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:20},children:[r.jsx("button",{onClick:()=>window.history.back(),style:{padding:8,borderRadius:"50%",border:"none",background:"transparent",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:M=>M.currentTarget.style.background="#f3f4f6",onMouseLeave:M=>M.currentTarget.style.background="transparent",children:r.jsx(lS,{size:20,color:"#4b5563"})}),r.jsxs("div",{children:[r.jsxs("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0,display:"flex",alignItems:"center",gap:12},children:[n==null?void 0:n.meetingName,r.jsx("span",{style:{padding:"2px 10px",borderRadius:999,fontSize:12,fontWeight:600,background:(n==null?void 0:n.status)==="CLOSED"?"#dcfce7":"#dbeafe",color:(n==null?void 0:n.status)==="CLOSED"?"#15803d":"#1d4ed8"},children:n==null?void 0:n.status})]}),r.jsxs("p",{style:{margin:"4px 0 0 0",color:"#6b7280",fontSize:14},children:[n==null?void 0:n.meetingCode," · ",n==null?void 0:n.meetingDate]})]}),r.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:r.jsxs("div",{style:{display:"flex",background:"#f3f4f6",padding:4,borderRadius:8},children:[r.jsx("button",{onClick:()=>d("kanban"),style:{padding:6,borderRadius:6,border:"none",background:c==="kanban"?"#fff":"transparent",boxShadow:c==="kanban"?"0 1px 2px rgba(0,0,0,0.1)":"none",color:c==="kanban"?"#2563eb":"#6b7280",cursor:"pointer",display:"flex",alignItems:"center"},children:r.jsx(kv,{size:16})}),r.jsx("button",{onClick:()=>d("grid"),style:{padding:6,borderRadius:6,border:"none",background:c==="grid"?"#fff":"transparent",boxShadow:c==="grid"?"0 1px 2px rgba(0,0,0,0.1)":"none",color:c==="grid"?"#2563eb":"#6b7280",cursor:"pointer",display:"flex",alignItems:"center"},children:r.jsx(DS,{size:16})})]})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[r.jsxs("div",{style:{background:"linear-gradient(to bottom right, #eff6ff, #fff)",padding:16,borderRadius:12,border:"1px solid #dbeafe"},children:[r.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#2563eb",marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[r.jsx(wv,{size:12})," 총 채권액"]}),r.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:C(a.reduce((M,B)=>M+B.totalAr,0))})]}),r.jsxs("div",{style:{background:"linear-gradient(to bottom right, #fef2f2, #fff)",padding:16,borderRadius:12,border:"1px solid #fee2e2"},children:[r.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#dc2626",marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[r.jsx(El,{size:12})," 총 연체액"]}),r.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:C(a.reduce((M,B)=>M+B.overdue,0))})]}),r.jsxs("div",{style:{background:"linear-gradient(to bottom right, #fffbeb, #fff)",padding:16,borderRadius:12,border:"1px solid #fef3c7"},children:[r.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#d97706",marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[r.jsx(Pu,{size:12})," 심사 대상"]}),r.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:[a.filter(M=>M.reviewFlag).length," ",r.jsx("span",{style:{fontSize:14,fontWeight:400,color:"#6b7280"},children:"업체"})]})]}),r.jsxs("div",{style:{background:"linear-gradient(to bottom right, #ecfdf5, #fff)",padding:16,borderRadius:12,border:"1px solid #d1fae5"},children:[r.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#059669",marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[r.jsx(Il,{size:12})," 완료율"]}),r.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:[Math.round(a.filter(M=>M.decisionCode).length/(a.length||1)*100),"%"]})]})]})]}),r.jsx("div",{style:{flex:1,overflowX:"auto",padding:24},children:c==="kanban"?r.jsxs("div",{style:{display:"flex",gap:24,height:"100%",minWidth:"max-content"},children:[r.jsxs("div",{style:{width:320,display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{marginBottom:12,fontWeight:600,color:"#6b7280",display:"flex",justifyContent:"space-between",alignItems:"center"},children:["미결정 ",r.jsx("span",{style:{background:"#e5e7eb",padding:"2px 8px",borderRadius:999,fontSize:12},children:O().length})]}),r.jsx("div",{style:{flex:1,background:"#f3f4f6",borderRadius:12,padding:12,display:"flex",flexDirection:"column",gap:12,overflowY:"auto"},children:O().map(M=>r.jsxs("div",{onClick:()=>N(M),className:"card",style:{background:"#fff",padding:16,borderRadius:8,border:"1px solid #e5e7eb",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:B=>{B.currentTarget.style.transform="translateY(-2px)",B.currentTarget.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.1)"},onMouseLeave:B=>{B.currentTarget.style.transform="none",B.currentTarget.style.boxShadow="none"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[r.jsx("span",{style:{width:8,height:8,borderRadius:"50%",marginTop:6,background:M.riskLevel==="high"?"#ef4444":M.riskLevel==="medium"?"#f59e0b":"#10b981"}}),r.jsxs("span",{style:{fontSize:12,fontFamily:"monospace",color:"#9ca3af"},children:["#",M.customerSeq]})]}),r.jsx("h4",{style:{fontSize:16,fontWeight:700,color:"#111827",margin:"0 0 4px 0"},children:M.customerName}),r.jsxs("div",{style:{fontSize:14,color:"#6b7280",marginBottom:12},children:["채권: ",C(M.totalAr)]}),M.reviewFlag&&r.jsx("div",{style:{fontSize:12,background:"#f3e8ff",color:"#7e22ce",padding:"2px 8px",borderRadius:4,display:"inline-block"},children:"심사필요"})]},M.id))})]}),w.map(M=>{const B=a.filter(z=>z.decisionCode===M.id);return r.jsxs("div",{style:{width:320,display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{marginBottom:12,fontWeight:600,color:"#374151",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[M.title,r.jsx("span",{style:{background:M.color,color:M.textColor,padding:"2px 8px",borderRadius:999,fontSize:12},children:B.length})]}),r.jsx("div",{style:{flex:1,background:"#f3f4f6",borderRadius:12,padding:12,display:"flex",flexDirection:"column",gap:12,overflowY:"auto"},children:B.map(z=>r.jsxs("div",{onClick:()=>N(z),className:"card",style:{background:"#fff",padding:16,borderRadius:8,border:"1px solid #e5e7eb",borderLeft:`4px solid ${M.borderColor}`,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:j=>{j.currentTarget.style.transform="translateY(-2px)",j.currentTarget.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.1)"},onMouseLeave:j=>{j.currentTarget.style.transform="none",j.currentTarget.style.boxShadow="none"},children:[r.jsx("h4",{style:{fontSize:16,fontWeight:700,color:"#111827",margin:"0 0 4px 0"},children:z.customerName}),r.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"0 0 8px 0",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:['"',z.decisionComment,'"']}),r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:12,color:"#9ca3af"},children:[r.jsx("span",{children:C(z.totalAr)}),r.jsx(NS,{size:16})]})]},z.id))})]},M.id)})]}):r.jsx("div",{style:{background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[r.jsx("thead",{style:{background:"#f9fafb",borderBottom:"1px solid #e5e7eb"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"12px 24px",textAlign:"left",fontWeight:600,color:"#6b7280"},children:"거래처"}),r.jsx("th",{style:{padding:"12px 24px",textAlign:"right",fontWeight:600,color:"#6b7280"},children:"총 채권"}),r.jsx("th",{style:{padding:"12px 24px",textAlign:"right",fontWeight:600,color:"#6b7280"},children:"연체액"}),r.jsx("th",{style:{padding:"12px 24px",textAlign:"center",fontWeight:600,color:"#6b7280"},children:"위험도"}),r.jsx("th",{style:{padding:"12px 24px",textAlign:"left",fontWeight:600,color:"#6b7280"},children:"결정"}),r.jsx("th",{style:{padding:"12px 24px",textAlign:"left",fontWeight:600,color:"#6b7280"},children:"의견"})]})}),r.jsx("tbody",{children:a.map((M,B)=>{var z;return r.jsxs("tr",{onClick:()=>N(M),style:{borderBottom:B===a.length-1?"none":"1px solid #f3f4f6",cursor:"pointer",transition:"background 0.1s"},onMouseEnter:j=>j.currentTarget.style.background="#f9fafb",onMouseLeave:j=>j.currentTarget.style.background="#fff",children:[r.jsxs("td",{style:{padding:"16px 24px"},children:[r.jsx("div",{style:{fontWeight:600,color:"#111827"},children:M.customerName}),r.jsx("div",{style:{fontSize:12,color:"#9ca3af"},children:M.customerSeq})]}),r.jsx("td",{style:{padding:"16px 24px",textAlign:"right",fontFamily:"monospace"},children:C(M.totalAr)}),r.jsx("td",{style:{padding:"16px 24px",textAlign:"right",fontFamily:"monospace",color:"#dc2626"},children:C(M.overdue)}),r.jsx("td",{style:{padding:"16px 24px",textAlign:"center"},children:r.jsx("span",{style:{display:"inline-block",width:10,height:10,borderRadius:"50%",background:M.riskLevel==="high"?"#ef4444":M.riskLevel==="medium"?"#f59e0b":"#10b981"}})}),r.jsx("td",{style:{padding:"16px 24px"},children:M.decisionCode?r.jsx("span",{style:{padding:"2px 8px",borderRadius:4,fontSize:12,fontWeight:500,background:"#f3f4f6",color:"#374151"},children:((z=w.find(j=>j.id===M.decisionCode))==null?void 0:z.title)||M.decisionCode}):r.jsx("span",{style:{color:"#d1d5db"},children:"-"})}),r.jsx("td",{style:{padding:"16px 24px",color:"#6b7280",maxWidth:300,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:M.decisionComment||"-"})]},M.id)})})]})})}),m&&u&&r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.2)",backdropFilter:"blur(2px)",zIndex:40},onClick:()=>p(!1)}),r.jsxs("div",{style:{position:"fixed",top:0,right:0,bottom:0,width:500,background:"#fff",boxShadow:"-4px 0 24px rgba(0,0,0,0.15)",zIndex:50,display:"flex",flexDirection:"column",animation:"slideIn 0.3s ease-out"},children:[r.jsxs("div",{style:{padding:24,borderBottom:"1px solid #f3f4f6",display:"flex",justifyContent:"space-between",alignItems:"flex-start",background:"#f9fafb"},children:[r.jsxs("div",{children:[r.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#111827",margin:0},children:u.customerName}),r.jsxs("p",{style:{margin:"4px 0 0 0",fontSize:14,color:"#6b7280"},children:["#",u.customerSeq," · ",u.riskLevel.toUpperCase()," Risk"]})]}),r.jsx("button",{onClick:()=>p(!1),style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af",padding:4},children:r.jsx(Rd,{size:24})})]}),r.jsxs("div",{style:{flex:1,overflowY:"auto",padding:24,display:"flex",flexDirection:"column",gap:32},children:[r.jsxs("div",{children:[r.jsxs("h3",{style:{fontSize:14,fontWeight:700,color:"#111827",marginBottom:16,display:"flex",alignItems:"center",gap:8},children:[r.jsx(mS,{size:16,color:"#2563eb"})," 채권 Aging 분석"]}),r.jsx("div",{style:{height:200,background:"#fff",borderRadius:12,border:"1px solid #f3f4f6",padding:8},children:r.jsx(Vo,{width:"100%",height:"100%",children:r.jsxs(zw,{data:[{name:"정상",value:u.totalAr-u.overdue},{name:"1개월",value:u.overdue*.5},{name:"2개월",value:u.overdue*.3},{name:"3개월+",value:u.overdue*.2}],children:[r.jsx(jl,{strokeDasharray:"3 3",vertical:!1,stroke:"#f3f4f6"}),r.jsx(Sl,{dataKey:"name",tick:{fontSize:11,fill:"#6b7280"},axisLine:!1,tickLine:!1}),r.jsx(kl,{tick:{fontSize:11,fill:"#6b7280"},axisLine:!1,tickLine:!1}),r.jsx(Ad,{contentStyle:{borderRadius:8,border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:12},formatter:M=>C(M)}),r.jsx(tm,{dataKey:"value",radius:[4,4,0,0],children:[0,1,2,3].map((M,B)=>r.jsx(Qi,{fill:B===0?"#10b981":B===3?"#ef4444":"#3b82f6"},`cell-${B}`))})]})})})]}),r.jsxs("div",{style:{background:"#f9fafb",borderRadius:12,padding:20,border:"1px solid #e5e7eb"},children:[r.jsx("h3",{style:{fontSize:14,fontWeight:700,color:"#111827",marginBottom:16},children:"심사 결정 및 의견"}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6},children:"결정 (Decision)"}),r.jsxs("select",{value:g,onChange:M=>b(M.target.value),className:"search-input",style:{width:"100%",padding:"8px 12px",borderRadius:8,border:"1px solid #d1d5db",fontSize:14},children:[r.jsx("option",{value:"WATCH",children:"관찰 (Watch)"}),r.jsx("option",{value:"REVIEW_UNBLOCK",children:"해제 검토"}),r.jsx("option",{value:"KEEP_BLOCK",children:"차단 유지"}),r.jsx("option",{value:"APPROVED",children:"승인"}),r.jsx("option",{value:"REJECTED",children:"거부"})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6},children:"의견 (Opinion)"}),r.jsx("textarea",{value:y,onChange:M=>v(M.target.value),rows:4,className:"search-input",style:{width:"100%",padding:"12px",borderRadius:8,border:"1px solid #d1d5db",fontSize:14,resize:"none"},placeholder:"심사 의견을 상세히 입력하세요..."})]})]})]})]}),r.jsx("div",{style:{padding:24,borderTop:"1px solid #f3f4f6",background:"#f9fafb"},children:r.jsx("button",{onClick:A,className:"btn",style:{width:"100%",padding:"12px",background:"#2563eb",color:"white",fontWeight:700,borderRadius:12,border:"none",fontSize:15,boxShadow:"0 4px 6px -1px rgba(37, 99, 235, 0.2)"},children:"저장하기"})})]})]}),r.jsx("style",{children:`
        @keyframes slideIn {
          from { transform: translateX(100%); }
          to { transform: translateX(0); }
        }
      `})]})}const bv=[{id:1,title:"거래처 선택 및 현황 분석",icon:zi},{id:2,title:"해제 사유 및 계획 작성",icon:zd},{id:3,title:"요청 완료",icon:Il}];function i5(){const[e,t]=h.useState(1),[n,i]=h.useState(""),[a,s]=h.useState(null),[o,l]=h.useState(!1),[c,d]=h.useState(""),[u,f]=h.useState(""),[m,p]=h.useState(""),[y,v]=h.useState(""),[g,b]=h.useState(!1),x=async M=>{if(M){l(!0),s(null);try{const B=await fetch(`/api/v1/credit/customers/${M}`);if(!B.ok)throw new Error("거래처 정보를 찾을 수 없습니다");const z=await B.json();if(z.customer){const j=z.customer;s({customerSeq:j.customer_seq,customerName:j.customer_name,totalAr:j.total_ar||0,weightedAgingDays:45,overdue:j.overdue||0,aging0_30:j.aging_0_30||0,aging31_60:j.aging_31_60||0,aging61_90:j.aging_61_90||0,recentCollections:[{date:"2024-12-15",amount:5e6},{date:"2024-11-20",amount:3e6},{date:"2024-10-18",amount:4e6}],avgMonthlySales:25e6,lastMeetingOpinion:"고객사 자금 사정 어려움. 1월 중순 입금 약속."})}}catch(B){console.error("거래처 조회 실패:",B),alert(B.message)}finally{l(!1)}}},N=async()=>{if(!n||!c||!u||!m||!y){alert("모든 필수 항목을 입력해주세요");return}b(!0);try{const M=await fetch("/api/v1/credit/unblock-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerSeq:Number(n),requestCode:`REQ-${Date.now()}`,requestDate:new Date().toISOString().split("T")[0],requestReason:c,expectedCollectionDate:u,expectedAmount:Number(m),collectionPlan:y,assigneeId:"user1"})});if(!M.ok)throw new Error("요청 제출 실패");const B=await M.json();if(B.success)t(3);else throw new Error(B.error||"요청 제출 실패")}catch(M){alert("요청 제출 중 오류가 발생했습니다: "+M.message)}finally{b(!1)}},A=M=>`₩${M.toLocaleString("ko-KR")}`,C=()=>r.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[r.jsxs("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb"},children:[r.jsxs("h2",{style:{fontSize:18,fontWeight:700,color:"#111827",marginBottom:20,display:"flex",alignItems:"center",gap:8},children:[r.jsx(zi,{size:20,color:"#3b82f6"})," 거래처 조회"]}),r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("div",{style:{position:"relative",flex:1,maxWidth:400},children:[r.jsx("input",{type:"number",value:n,onChange:M=>i(M.target.value),onKeyDown:M=>M.key==="Enter"&&x(n),placeholder:"거래처 코드 (SEQ) 입력",className:"search-input",style:{width:"100%",height:42,paddingLeft:40,fontSize:14},autoFocus:!0}),r.jsx(zi,{size:16,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}})]}),r.jsx("button",{onClick:()=>x(n),disabled:o||!n,className:"btn",style:{height:42,padding:"0 24px",fontSize:14,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:o||!n?.7:1},children:o?"조회 중...":"조회"})]})]}),a&&r.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:24},children:[r.jsx("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",gridColumn:"span 2"},children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:24},children:[r.jsxs("div",{style:{padding:16,background:"#eff6ff",borderRadius:12,border:"1px solid #dbeafe"},children:[r.jsx("div",{style:{fontSize:13,color:"#2563eb",fontWeight:600,marginBottom:4},children:"총 채권액"}),r.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:A(a.totalAr)})]}),r.jsxs("div",{style:{padding:16,background:"#fef2f2",borderRadius:12,border:"1px solid #fee2e2"},children:[r.jsx("div",{style:{fontSize:13,color:"#dc2626",fontWeight:600,marginBottom:4},children:"연체 금액"}),r.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:A(a.overdue)})]}),r.jsxs("div",{style:{padding:16,background:"#fffbeb",borderRadius:12,border:"1px solid #fef3c7"},children:[r.jsx("div",{style:{fontSize:13,color:"#d97706",fontWeight:600,marginBottom:4},children:"평균 결제일"}),r.jsxs("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:[a.weightedAgingDays,"일"]})]}),r.jsxs("div",{style:{padding:16,background:"#f9fafb",borderRadius:12,border:"1px solid #f3f4f6"},children:[r.jsx("div",{style:{fontSize:13,color:"#4b5563",fontWeight:600,marginBottom:4},children:"월 평균 매출"}),r.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:A(a.avgMonthlySales||0)})]})]})}),r.jsxs("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",height:320},children:[r.jsx("h3",{style:{fontSize:16,fontWeight:700,color:"#111827",marginBottom:16},children:"채권 연령 분석"}),r.jsx(Vo,{width:"100%",height:"100%",children:r.jsxs(zw,{data:[{name:"정상",value:a.totalAr-a.overdue},{name:"1개월",value:a.aging0_30},{name:"2개월",value:a.aging31_60},{name:"3개월+",value:a.aging61_90}],margin:{top:20,right:30,left:20,bottom:5},children:[r.jsx(jl,{strokeDasharray:"3 3",vertical:!1}),r.jsx(Sl,{dataKey:"name",tick:{fontSize:12}}),r.jsx(kl,{tick:{fontSize:12}}),r.jsx(Ad,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:12},formatter:M=>A(M)}),r.jsx(tm,{dataKey:"value",radius:[4,4,0,0],children:[0,1,2,3].map((M,B)=>r.jsx(Qi,{fill:B===0?"#10b981":B===3?"#ef4444":"#3b82f6"},`cell-${B}`))})]})})]}),r.jsxs("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",height:320},children:[r.jsx("h3",{style:{fontSize:16,fontWeight:700,color:"#111827",marginBottom:16},children:"최근 수금 추이"}),r.jsx(Vo,{width:"100%",height:"100%",children:r.jsxs(UF,{data:a.recentCollections,margin:{top:20,right:30,left:20,bottom:5},children:[r.jsx(jl,{strokeDasharray:"3 3",vertical:!1}),r.jsx(Sl,{dataKey:"date",tick:{fontSize:12}}),r.jsx(kl,{tick:{fontSize:12}}),r.jsx(Ad,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:12},formatter:M=>A(M)}),r.jsx(ww,{type:"monotone",dataKey:"amount",stroke:"#8b5cf6",strokeWidth:3,dot:{r:4},activeDot:{r:6}})]})})]})]})]}),w=()=>r.jsx("div",{className:"animate-in fade-in slide-in-from-right-4 duration-300",style:{maxWidth:800,margin:"0 auto"},children:r.jsxs("div",{className:"card",style:{padding:32,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb"},children:[r.jsxs("h2",{style:{fontSize:18,fontWeight:700,color:"#111827",marginBottom:24,display:"flex",alignItems:"center",gap:8},children:[r.jsx(zd,{size:20,color:"#3b82f6"})," 해제 요청 사유 작성"]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["요청 사유 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("textarea",{value:c,onChange:M=>d(M.target.value),rows:5,className:"search-input",style:{width:"100%",height:"auto",padding:12,resize:"none",fontSize:14},placeholder:"매출통제 해제가 필요한 구체적인 사유를 입력해주세요."})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:24},children:[r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["예상 수금일 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("input",{type:"date",value:u,onChange:M=>f(M.target.value),className:"search-input",style:{width:"100%",height:42}})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["예상 수금액 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("span",{style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#6b7280",fontSize:14},children:"₩"}),r.jsx("input",{type:"number",value:m,onChange:M=>p(M.target.value),className:"search-input",style:{width:"100%",height:42,paddingLeft:30},placeholder:"0"})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["수금 계획 근거 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("textarea",{value:y,onChange:M=>v(M.target.value),rows:3,className:"search-input",style:{width:"100%",height:"auto",padding:12,resize:"none",fontSize:14},placeholder:"수금 계획의 신뢰성을 뒷받침할 근거를 입력해주세요 (예: 고객사 담당자 통화 내용, 지불각서 등)"})]})]})]})}),O=()=>r.jsxs("div",{className:"animate-in zoom-in-95 duration-500",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"60vh"},children:[r.jsx("div",{style:{width:80,height:80,background:"#dcfce7",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:24},children:r.jsx(Il,{size:40,color:"#16a34a"})}),r.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#111827",marginBottom:8},children:"요청이 완료되었습니다!"}),r.jsx("p",{style:{fontSize:16,color:"#6b7280",marginBottom:32},children:"담당자 검토 후 승인 여부가 결정됩니다."}),r.jsx("button",{onClick:()=>{t(1),i(""),s(null),d(""),f(""),p(""),v("")},className:"btn",style:{height:48,padding:"0 32px",fontSize:15,fontWeight:700,background:"#111827",borderColor:"#111827",color:"white",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:"새로운 요청 작성하기"})]});return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb",zIndex:10},children:[r.jsxs("div",{style:{marginBottom:24},children:[r.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"매출통제 해제 요청"}),r.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"연체 거래처의 일시적 매출 허용을 위한 승인 요청"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",maxWidth:600,margin:"0 auto",position:"relative"},children:[r.jsx("div",{style:{position:"absolute",top:20,left:0,width:"100%",height:2,background:"#f3f4f6",zIndex:0}}),r.jsx("div",{style:{position:"absolute",top:20,left:0,height:2,background:"#3b82f6",zIndex:0,width:`${(e-1)/(bv.length-1)*100}%`,transition:"width 0.3s ease"}}),bv.map(M=>{const B=e>=M.id,z=e===M.id;return r.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",position:"relative",zIndex:1},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:B?"#3b82f6":"#fff",border:B?"none":"2px solid #e5e7eb",color:B?"#fff":"#9ca3af",boxShadow:B?"0 4px 6px -1px rgba(59, 130, 246, 0.3)":"none",transition:"all 0.3s ease"},children:r.jsx(M.icon,{size:20})}),r.jsx("span",{style:{marginTop:8,fontSize:13,fontWeight:z?700:500,color:z?"#3b82f6":"#9ca3af",transition:"color 0.3s ease"},children:M.title})]},M.id)})]})]}),r.jsxs("div",{style:{flex:1,overflow:"auto",padding:32},children:[e===1&&C(),e===2&&w(),e===3&&O()]}),e<3&&r.jsxs("div",{style:{padding:"16px 32px",background:"#fff",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("button",{onClick:()=>t(M=>Math.max(1,M-1)),disabled:e===1,className:"btn",style:{background:"transparent",borderColor:"transparent",color:"#4b5563",opacity:e===1?.3:1,cursor:e===1?"not-allowed":"pointer",paddingLeft:0},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[r.jsx(rS,{size:18})," 이전"]})}),e===1?r.jsx("button",{onClick:()=>t(2),disabled:!a,className:"btn",style:{height:42,padding:"0 24px",fontSize:14,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:a?1:.5,cursor:a?"pointer":"not-allowed"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:["다음 단계 ",r.jsx(ls,{size:18})]})}):r.jsx("button",{onClick:N,disabled:g,className:"btn",style:{height:42,padding:"0 24px",fontSize:14,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:g?.7:1},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[g?"제출 중...":"요청 제출하기"," ",r.jsx(uS,{size:18})]})})]})]})}function M5({selectedKey:e}){return r.jsx("div",{className:"main-view",children:e==="dashboard"?r.jsx(SN,{}):e==="calendar"?r.jsx(xN,{}):e==="demand"&&bn.demandManagement?r.jsxs("section",{children:[r.jsx("h1",{children:"수요관리"}),r.jsx("p",{children:"여기에서 수요 데이터를 조회/분석/관리하는 기능이 표시됩니다."}),r.jsx("div",{className:"empty-state",children:"초기 버전: 메인 화면 스켈레톤"})]}):e==="customer"&&bn.customerManagement?r.jsxs("section",{children:[r.jsx("h1",{children:"고객관리"}),r.jsx("p",{children:"고객관리 요구사항은 별도로 정의/입력됩니다. 현재는 플레이스홀더입니다."}),r.jsx("div",{className:"empty-state",children:"초기 버전: 고객관리 화면 스켈레톤"})]}):e==="customer"&&bn.customerManagement?r.jsxs("section",{children:[r.jsx("h1",{children:"고객관리"}),r.jsx("p",{children:"고객관리 요구사항은 별도로 정의/입력됩니다. 현재는 플레이스홀더입니다."}),r.jsx("div",{className:"empty-state",children:"초기 버전: 고객관리 화면 스켈레톤"})]}):e==="customer:list"&&bn.customerManagement?r.jsx(Bd,{}):e==="customer:sales-activity-new"&&bn.customerManagement?r.jsx(rN,{}):e==="customer:c360"&&bn.customerManagement?r.jsx(uN,{}):e==="sales-mgmt:activity-plan"?r.jsx(yN,{}):e==="customer:c360-old"&&bn.customerManagement?r.jsx(vN,{}):e==="customer:my-activities"&&bn.customerManagement?r.jsx(CN,{}):e==="lead:register"||e==="lead"?r.jsx(qN,{}):e==="lead:tm-status"?r.jsx(HN,{}):e==="order-sheet"?r.jsx(YN,{}):e==="order-list"?r.jsx(QN,{}):e==="inquiry"?r.jsx(_N,{}):e==="estimate"?r.jsx(RN,{}):e==="item360"?r.jsx(ZN,{}):e==="inventory:expiry-ag"?r.jsx(ZE,{}):e==="complaint"?r.jsx(EN,{}):e==="credit:ar-aging"?r.jsx(lI,{}):e==="credit:meetings"?r.jsx(n5,{}):e.startsWith("credit:meeting:")?r.jsx(r5,{}):e==="credit:unblocking"?r.jsx(i5,{}):e==="sales-receivables"?r.jsxs("section",{children:[r.jsx("h1",{children:"매출/채권"}),r.jsx("div",{className:"empty-state",children:"매출·채권 관리 화면이 준비중입니다."})]}):e==="settings"?r.jsx(BN,{}):e==="sales-mgmt:sales"?r.jsx(n2,{}):e==="sales-mgmt:receivables"?r.jsx(s2,{}):e==="sales-mgmt:activities"?r.jsx(QE,{}):e==="lab:vibe-workspace"?r.jsx(oI,{}):e==="lab:unit-analysis"?r.jsx(eI,{}):e==="lab:price-sim"?r.jsx(nI,{}):e==="lab:price-sim-unit"?r.jsx(iI,{}):e==="lab:price-simulation"?r.jsx(sI,{}):e==="demand:list"&&bn.demandManagement?r.jsx(iS,{}):e==="sales-targets"&&bn.demandManagement?r.jsx(Sm,{}):e==="sales-dashboard"&&bn.demandManagement?r.jsx(t2,{}):e==="sales-assign"&&bn.demandManagement?r.jsx(GN,{}):e==="sales-plan"&&bn.demandManagement?r.jsx(eN,{}):e==="sales-plan-new"&&bn.demandManagement?r.jsx(Sm,{}):e==="sales-plan-s"&&bn.demandManagement?r.jsx(JS,{}):e==="demand:excel-upload"&&bn.demandManagement?r.jsx(YS,{}):r.jsxs("section",{children:[r.jsx("h1",{children:e}),r.jsx("div",{className:"empty-state",children:"콘텐츠가 준비중입니다."})]})})}export{M5 as MainView};
