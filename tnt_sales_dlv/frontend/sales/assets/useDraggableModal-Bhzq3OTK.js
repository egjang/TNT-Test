import{r as n}from"./index-BmcpNj69.js";function R(a,i,w,o){const l=(o==null?void 0:o.persist)!==!1,p=(o==null?void 0:o.resetOnOpen)===!0,r=n.useRef(null),[u,g]=n.useState(()=>{if(!l)return null;try{const e=localStorage.getItem(`tnt.sales.modal.pos.${a}`);if(e)return JSON.parse(e)}catch{}return null}),f=n.useRef(u);n.useEffect(()=>{f.current=u},[u]);const[h,v]=n.useState(!1),s=n.useRef(null);n.useEffect(()=>{if(i&&r.current&&w)try{(p||!u)&&g(w(r.current))}catch{}},[i]),n.useEffect(()=>{if(!h)return;function e(c){if(!s.current||!r.current)return;const M=r.current.getBoundingClientRect(),y=M.width,D=M.height;let m=c.clientX-s.current.dx,d=c.clientY-s.current.dy;const L=Math.max(0,window.innerWidth-y),O=Math.max(0,window.innerHeight-D);m=Math.min(Math.max(0,m),L),d=Math.min(Math.max(0,d),O),g({x:m,y:d})}function t(){if(l&&f.current)try{localStorage.setItem(`tnt.sales.modal.pos.${a}`,JSON.stringify(f.current))}catch{}v(!1),s.current=null,window.removeEventListener("mousemove",e,!0),window.removeEventListener("mouseup",t,!0)}return window.addEventListener("mousemove",e,!0),window.addEventListener("mouseup",t,!0),()=>{window.removeEventListener("mousemove",e,!0),window.removeEventListener("mouseup",t,!0)}},[h,l,a]);function x(e){if(e.button!==0||!r.current)return;const t=r.current.getBoundingClientRect();s.current={dx:e.clientX-t.left,dy:e.clientY-t.top},v(!0),e.preventDefault()}function E(e){if(e.button!==0)return;const t=e.target,c=((t==null?void 0:t.tagName)||"").toLowerCase();["input","textarea","select","button","a","label"].includes(c)||x(e)}const b=u&&i?{position:"absolute",top:u.y,left:u.x,transform:"none"}:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)"};return{ref:r,style:b,bindHeader:{onMouseDown:x},bindContainer:{onMouseDown:E}}}export{R as u};
