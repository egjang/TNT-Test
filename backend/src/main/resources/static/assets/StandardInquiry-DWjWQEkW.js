import{r as i,j as e}from"./index-BB_3LKiY.js";import{S as k}from"./search-DWsQZhhE.js";import{R as B}from"./refresh-cw-BZiQWki6.js";import{P as N}from"./plus-NPOo4Ump.js";import{A}from"./arrow-left-DNYSmVoh.js";function z({onSelect:s,onCreate:p,selectedId:x}){const[o,h]=i.useState([]),[l,y]=i.useState(!1),[a,g]=i.useState(""),[d,b]=i.useState(""),[r,u]=i.useState("");i.useEffect(()=>{m();const t=()=>m();return window.addEventListener("tnt.sales.inquiry.reload",t),()=>window.removeEventListener("tnt.sales.inquiry.reload",t)},[]);async function m(){y(!0);try{const t=await fetch("/api/v1/inquiries");if(t.ok){const v=await t.json();if(Array.isArray(v)){const c=v.map(n=>({id:Number(n.id),title:n.title,customerName:n.customerName||n.customer_name,inquiryStatus:n.inquiryStatus||n.inquiry_status||n.status,assigneeName:n.assigneeName||n.assignee_name,openedAt:n.openedAt||n.opened_at,inquiryCategory:n.inquiryCategory||n.inquiry_category,severity:n.severity}));c.sort((n,f)=>{const w=n.openedAt?new Date(n.openedAt).getTime():0;return(f.openedAt?new Date(f.openedAt).getTime():0)-w}),h(c)}}}catch(t){console.error(t)}finally{y(!1)}}const j=o.filter(t=>{const v=a===""||(t.title||"").toLowerCase().includes(a.toLowerCase())||(t.customerName||"").toLowerCase().includes(a.toLowerCase()),c=d===""||t.inquiryStatus===d,n=r===""||t.inquiryCategory===r;return v&&c&&n}),S=t=>{switch(t){case"신규접수":return{background:"var(--primary)",color:"var(--on-accent)"};case"확인 중":return{background:"var(--warning)",color:"var(--on-accent)"};case"완료":return{background:"var(--success)",color:"var(--on-accent)"};case"보류":return{background:"var(--error)",color:"var(--on-accent)"};default:return{background:"var(--bg-secondary)",color:"var(--text-secondary)"}}},C=()=>{g(""),b(""),u("")};return e.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8},children:[e.jsx("div",{style:{padding:16,borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12,marginBottom:12},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"제목/고객명"}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("input",{type:"text",className:"input",placeholder:"검색...",value:a,onChange:t=>g(t.target.value),style:{width:"100%",paddingLeft:36}}),e.jsx(k,{size:16,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",opacity:.5}})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"상태"}),e.jsxs("select",{className:"input",value:d,onChange:t=>b(t.target.value),style:{width:"100%"},children:[e.jsx("option",{value:"",children:"전체"}),e.jsx("option",{value:"신규접수",children:"신규접수"}),e.jsx("option",{value:"확인 중",children:"확인 중"}),e.jsx("option",{value:"완료",children:"완료"}),e.jsx("option",{value:"보류",children:"보류"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"분류"}),e.jsxs("select",{className:"input",value:r,onChange:t=>u(t.target.value),style:{width:"100%"},children:[e.jsx("option",{value:"",children:"전체"}),e.jsx("option",{value:"제품문의",children:"제품문의"}),e.jsx("option",{value:"재고/배송문의",children:"재고/배송문의"}),e.jsx("option",{value:"가격문의",children:"가격문의"}),e.jsx("option",{value:"기타문의",children:"기타문의"})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"flex-end",gap:8},children:[e.jsx("button",{className:"btn btn-secondary",onClick:C,children:"초기화"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>m(),disabled:l,children:l?"검색 중...":"검색"})]})]})}),e.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{fontSize:13,color:"var(--text-secondary)"},children:["총 ",e.jsx("strong",{style:{color:"var(--text-primary)"},children:j.length}),"건"]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>m(),disabled:l,style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(B,{size:14,className:l?"animate-spin":""}),"새로고침"]}),e.jsxs("button",{className:"btn btn-primary",onClick:p,style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx(N,{size:14}),"신규 등록"]})]})]}),e.jsx("div",{style:{overflow:"auto",maxHeight:"calc(100vh - 400px)"},children:e.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[e.jsx("thead",{children:e.jsxs("tr",{style:{background:"var(--bg-secondary)"},children:[e.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:40},children:e.jsx("input",{type:"checkbox"})}),e.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)",width:60},children:"No"}),e.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:100},children:"상태"}),e.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)"},children:"제목"}),e.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)",width:120},children:"분류"}),e.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)",width:150},children:"고객명"}),e.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)",width:120},children:"담당자"}),e.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:110},children:"등록일"})]})}),e.jsxs("tbody",{children:[j.map((t,v)=>e.jsxs("tr",{onClick:()=>s(t),style:{cursor:"pointer",background:x===t.id?"var(--bg-secondary)":"transparent"},onMouseEnter:c=>{x!==t.id&&(c.currentTarget.style.background="var(--bg-secondary)")},onMouseLeave:c=>{x!==t.id&&(c.currentTarget.style.background="transparent")},children:[e.jsx("td",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)"},children:e.jsx("input",{type:"checkbox",onClick:c=>c.stopPropagation()})}),e.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)"},children:v+1}),e.jsx("td",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)"},children:e.jsx("span",{style:{padding:"2px 8px",borderRadius:4,fontSize:11,fontWeight:500,...S(t.inquiryStatus)},children:t.inquiryStatus||"-"})}),e.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)",fontWeight:500,color:"var(--primary)"},children:t.title||"-"}),e.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)"},children:t.inquiryCategory||"-"}),e.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)"},children:t.customerName||"-"}),e.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)"},children:t.assigneeName||"-"}),e.jsx("td",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)"},children:t.openedAt?new Date(t.openedAt).toLocaleDateString():"-"})]},t.id)),j.length===0&&!l&&e.jsx("tr",{children:e.jsx("td",{colSpan:8,style:{padding:"40px 12px",textAlign:"center",color:"var(--text-secondary)"},children:"조회된 데이터가 없습니다."})})]})]})}),j.length>0&&e.jsxs("div",{style:{padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:4,borderTop:"1px solid var(--border)"},children:[e.jsx("button",{className:"btn btn-ghost",style:{padding:"4px 8px",minWidth:32},children:"«"}),e.jsx("button",{className:"btn btn-ghost",style:{padding:"4px 8px",minWidth:32},children:"‹"}),e.jsx("button",{className:"btn btn-primary",style:{padding:"4px 8px",minWidth:32},children:"1"}),e.jsx("button",{className:"btn btn-ghost",style:{padding:"4px 8px",minWidth:32},children:"›"}),e.jsx("button",{className:"btn btn-ghost",style:{padding:"4px 8px",minWidth:32},children:"»"})]})]})}function q({inquiry:s,onCancel:p,onSave:x}){const[o,h]=i.useState({}),[l,y]=i.useState(!1),[a,g]=i.useState("basic");i.useEffect(()=>{h(s?{title:s.title||"",inquiryStatus:s.inquiryStatus||"신규접수",inquiryCategory:s.inquiryCategory||"",customerName:s.customerName||"",assigneeName:s.assigneeName||"",content:""}:{title:"",inquiryStatus:"신규접수",inquiryCategory:"제품문의",customerName:"",assigneeName:"",content:""})},[s]);const d=(r,u)=>{h(m=>({...m,[r]:u}))},b=async()=>{y(!0);try{await new Promise(r=>setTimeout(r,1e3)),x()}catch(r){console.error(r)}finally{y(!1)}};return e.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8},children:[e.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("button",{onClick:p,style:{background:"none",border:"none",cursor:"pointer",padding:4,display:"flex",alignItems:"center"},children:e.jsx(A,{size:20})}),e.jsx("h3",{style:{fontSize:18,fontWeight:600,margin:0},children:s?"문의 상세":"문의 등록"})]}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-secondary",onClick:p,disabled:l,children:"목록"}),e.jsx("button",{className:"btn btn-primary",onClick:b,disabled:l,children:l?"저장 중...":"저장"})]})]}),e.jsx("div",{style:{borderBottom:"1px solid var(--border)",padding:"0 20px"},children:e.jsx("div",{style:{display:"flex",gap:0},children:[{key:"basic",label:"기본정보"},{key:"history",label:"처리이력"}].map(r=>e.jsx("button",{onClick:()=>g(r.key),style:{padding:"12px 20px",background:"none",border:"none",borderBottom:a===r.key?"2px solid var(--primary)":"2px solid transparent",color:a===r.key?"var(--primary)":"var(--text-secondary)",fontWeight:a===r.key?600:400,cursor:"pointer",fontSize:14},children:r.label},r.key))})}),e.jsxs("div",{style:{padding:20},children:[a==="basic"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx("h4",{style:{fontSize:14,fontWeight:600,marginBottom:12,paddingBottom:8,borderBottom:"1px solid var(--border)"},children:"문의 정보"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{style:{gridColumn:"1 / -1"},children:[e.jsxs("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:["제목 ",e.jsx("span",{style:{color:"var(--error)"},children:"*"})]}),e.jsx("input",{type:"text",className:"input",value:o.title,onChange:r=>d("title",r.target.value),placeholder:"문의 제목을 입력하세요",style:{width:"100%"}})]}),e.jsxs("div",{children:[e.jsxs("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:["분류 ",e.jsx("span",{style:{color:"var(--error)"},children:"*"})]}),e.jsxs("select",{className:"input",value:o.inquiryCategory,onChange:r=>d("inquiryCategory",r.target.value),style:{width:"100%"},children:[e.jsx("option",{value:"",children:"선택"}),e.jsx("option",{value:"제품문의",children:"제품문의"}),e.jsx("option",{value:"재고/배송문의",children:"재고/배송문의"}),e.jsx("option",{value:"가격문의",children:"가격문의"}),e.jsx("option",{value:"기타문의",children:"기타문의"})]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"상태"}),e.jsxs("select",{className:"input",value:o.inquiryStatus,onChange:r=>d("inquiryStatus",r.target.value),style:{width:"100%"},children:[e.jsx("option",{value:"신규접수",children:"신규접수"}),e.jsx("option",{value:"확인 중",children:"확인 중"}),e.jsx("option",{value:"완료",children:"완료"}),e.jsx("option",{value:"보류",children:"보류"})]})]})]})]}),e.jsxs("div",{style:{marginBottom:24},children:[e.jsx("h4",{style:{fontSize:14,fontWeight:600,marginBottom:12,paddingBottom:8,borderBottom:"1px solid var(--border)"},children:"고객 정보"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"고객명"}),e.jsx("input",{type:"text",className:"input",value:o.customerName,onChange:r=>d("customerName",r.target.value),placeholder:"고객명을 입력하세요",style:{width:"100%"}})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"담당자"}),e.jsx("input",{type:"text",className:"input",value:o.assigneeName,onChange:r=>d("assigneeName",r.target.value),placeholder:"담당자를 입력하세요",style:{width:"100%"}})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{fontSize:14,fontWeight:600,marginBottom:12,paddingBottom:8,borderBottom:"1px solid var(--border)"},children:"문의 내용"}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"내용"}),e.jsx("textarea",{className:"input",value:o.content,onChange:r=>d("content",r.target.value),placeholder:"문의 내용을 입력하세요",rows:6,style:{width:"100%",resize:"vertical"}})]})]})]}),a==="history"&&e.jsx("div",{children:e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:s?[{date:s.openedAt?new Date(s.openedAt).toLocaleString():"-",user:"시스템",action:"문의 등록"}].map((r,u)=>e.jsxs("div",{style:{display:"flex",gap:16,padding:12,background:"var(--bg-secondary)",borderRadius:4},children:[e.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)",minWidth:150},children:r.date}),e.jsx("div",{style:{fontSize:13,fontWeight:500,minWidth:80},children:r.user}),e.jsx("div",{style:{fontSize:13},children:r.action})]},u)):e.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-secondary)"},children:"신규 등록 시에는 처리이력이 없습니다."})})})]})]})}function D(){const[s,p]=i.useState(null),[x,o]=i.useState(!1),h=g=>{p(g),o(!1)},l=()=>{p(null),o(!0)},y=()=>{p(null),o(!1)},a=()=>{o(!1),p(null),window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.reload"))};return s||x?e.jsx("div",{style:{padding:24,height:"100%",overflow:"auto",background:"var(--panel)"},children:e.jsx(q,{inquiry:s,onCancel:y,onSave:a})}):e.jsxs("div",{style:{padding:24,height:"100%",overflow:"auto",background:"var(--panel)"},children:[e.jsxs("div",{style:{marginBottom:24},children:[e.jsx("h1",{style:{fontSize:24,fontWeight:600,marginBottom:8},children:"문의 관리"}),e.jsx("p",{style:{color:"var(--text-secondary)",fontSize:14},children:"고객 문의 및 지원 요청을 관리합니다."})]}),e.jsx(z,{onSelect:h,onCreate:l,selectedId:s==null?void 0:s.id})]})}export{D as StandardInquiry};
