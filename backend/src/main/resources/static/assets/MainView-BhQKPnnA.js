var Vk=Object.defineProperty;var Xk=(e,n,i)=>n in e?Vk(e,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[n]=i;var Au=(e,n,i)=>Xk(e,typeof n!="symbol"?n+"":n,i);import{c as qt,r as p,j as r,_ as Sg,R as Be,g as Wi,U as ao,a as Bh,b as Qk,C as Dv,d as Ii,e as kg,f as Iu,o as Jk,i as Tu,s as Zk,W as cc,F as nr,P as _s,B as mo,h as qr,k as Ti,T as eN,S as zv,l as tN,m as pd,L as nN,I as rN,n as ui,p as Eu,u as iN}from"./index-BB_3LKiY.js";import{DemandList as sN}from"./DemandList-BTJZWd6P.js";import{u as tr,c as sn}from"./useDraggableModal-CETtIliS.js";import{t as zt}from"./tone-B1QjB-CC.js";import{X as On}from"./x-Ci4NTfDo.js";import{R as ln}from"./refresh-cw-BZiQWki6.js";import{D as Ni}from"./dollar-sign-CDimaGAB.js";import{S as fn,a as Ps,g as Ng,f as aN}from"./week-YEOvqQIj.js";import{M as oN,G as lN,a as cN,u as dN,L as uN}from"./Marker--CfJXtT2.js";/* empty css                */import{T as fN,M as Mv,g as Rv,a as So,r as hN}from"./index-NjT4_Tk6.js";import{c as $v,a as Lv}from"./chevron-right-DHqVul_D.js";import{C as ko}from"./chevron-down-DD_Bc6LT.js";import{S as Fn}from"./search-DWsQZhhE.js";import{C as wf}from"./chevron-up-DTPmQPJn.js";import{P as mr}from"./plus-NPOo4Ump.js";import{C as fr}from"./circle-check-UkLLO3d0.js";import{L as Fh,P as Wv}from"./pen-line-CEzorJh1.js";import{C as rs}from"./check-C3N30iKO.js";import{L as Ei}from"./loader-circle-Cdx_3rgK.js";import{C as pN}from"./circle-x-DNW52tLr.js";import{C as Bv}from"./clock-DmAeCGI0.js";import{T as ha}from"./triangle-alert-D2LzuWlc.js";import{L as mN,P as Fv}from"./play-D3xUlVw8.js";import{E as Sf,S as qv}from"./send-RHemNrO9.js";import{C as oa,B as go}from"./chart-column-Jjm1NHhn.js";import{C as dc}from"./circle-check-big-56oz7VR7.js";import{A as pa}from"./arrow-right-C8-C_j_O.js";import{T as gN}from"./trending-down-BkmuUZtQ.js";import{S as yN}from"./save-CHvqRpOx.js";import{D as qh}from"./download-BMDqQjuM.js";import{U as uc}from"./user-C1JnWx0K.js";import{C as Uv,u as xN,U as Hv,L as vN,F as _g}from"./upload-QE74yyW2.js";import{M as No}from"./message-square-DaNp9p04.js";import{D as ei}from"./database-o3KgoVAW.js";import{T as la}from"./trash-2-YQlpFIkM.js";import{C as Uh}from"./copy-DO6QvMZG.js";import{S as bN}from"./sparkles-B11WZgmB.js";import{F as Cg}from"./file-code-hEGm3Prq.js";import{A as Yv}from"./arrow-left-DNYSmVoh.js";import{I as Ag}from"./info-CFRwD8MS.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jN=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],Ig=qt("activity",jN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wN=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],SN=qt("award",wN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kN=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],NN=qt("book-open",kN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _N=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],CN=qt("circle-user",_N);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Tr=qt("clipboard-list",AN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IN=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],TN=qt("coins",IN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]],PN=qt("file-check",EN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ON=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]],DN=qt("file-plus",ON);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zN=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],kf=qt("file-spreadsheet",zN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MN=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],Tg=qt("file-up",MN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RN=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],$N=qt("flame",RN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LN=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],WN=qt("folder-open",LN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BN=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Kv=qt("history",BN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FN=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]],qN=qt("layout-list",FN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UN=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],oo=qt("lock-open",UN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HN=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],YN=qt("lock",HN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KN=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],Nf=qt("message-circle",KN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GN=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],Pu=qt("shield-alert",GN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VN=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ou=qt("shield-check",VN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XN=[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]],QN=qt("table-2",XN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JN=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Eg=qt("tag",JN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZN=[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2a3.13 3.13 0 0 1 3 3.88Z",key:"emmmcr"}]],e_=qt("thumbs-up",ZN);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t_=[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]],n_=qt("truck",t_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r_=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Gv=qt("user-check",r_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i_=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],s_=qt("zoom-in",i_);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a_=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],o_=qt("zoom-out",a_),Rn={demandManagement:!0,customerManagement:!0};function l_(){const e=p.useRef(null),[n,i]=p.useState(null),[s,a]=p.useState([]),[o,l]=p.useState(null),[c,d]=p.useState([]),[u,f]=p.useState([]),[h,m]=p.useState(null),[g,b]=p.useState(!1),[j,y]=p.useState(null),[x,v]=p.useState(0),[A,N]=p.useState(""),C=()=>{var E;return(E=e.current)==null?void 0:E.click()},w=async E=>{var k;m(null);const S=(k=E.target.files)==null?void 0:k[0];if(i(S?S.name:null),d([]),a([]),l(null),!!S)try{const D=await Sg(()=>import("./xlsx-D_0l8YDs.js"),[]),T=await S.arrayBuffer(),P=D.read(T,{type:"array"}),R=P.SheetNames||[];a(R);const Y=R[0];if(l(Y||null),Y){const X=P.Sheets[Y],H=D.utils.sheet_to_json(X,{header:1});f(H),d(H)}}catch(D){m("엑셀 파일을 읽는 중 오류가 발생했습니다. 파일 형식을 확인해 주세요."),console.error(D)}},_=c&&c.length>0,I=p.useMemo(()=>{if(!_)return null;const E=c.reduce((S,k)=>Math.max(S,Array.isArray(k)?k.length:0),0);return r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsx("tr",{children:Array.from({length:E}).map((S,k)=>r.jsxs("th",{children:["C",k+1]},k))})}),r.jsx("tbody",{children:c.map((S,k)=>r.jsx("tr",{children:Array.from({length:E}).map((D,T)=>r.jsx("td",{children:Array.isArray(S)&&S[T]!=null?String(S[T]):""},T))},k))})]})})},[c,_]),O=async E=>{var D,T;const S=E.target.value;l(S);const k=(T=(D=e.current)==null?void 0:D.files)==null?void 0:T[0];if(k)try{const P=await Sg(()=>import("./xlsx-D_0l8YDs.js"),[]),R=await k.arrayBuffer(),X=P.read(R,{type:"array"}).Sheets[S],H=P.utils.sheet_to_json(X,{header:1});f(H),d(H)}catch(P){m("시트를 전환하는 중 오류가 발생했습니다."),console.error(P)}};return r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"Excel Upload"}),r.jsx("div",{className:"muted count-text"})]}),r.jsx("p",{children:"로컬 PC에서 엑셀 파일(.xlsx, .xls)만 선택할 수 있습니다."}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("input",{ref:e,type:"file",accept:".xlsx,.xls,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",onChange:w,style:{display:"none"}}),r.jsx("button",{className:"btn",onClick:C,children:"엑셀 파일 선택"}),n&&r.jsxs("span",{className:"muted",children:["선택됨: ",n]})]}),s.length>1&&r.jsx("div",{style:{marginTop:10},children:r.jsxs("label",{children:["시트 선택: ",r.jsx("select",{value:o??"",onChange:O,children:s.map(E=>r.jsx("option",{value:E,children:E},E))})]})}),h&&r.jsx("div",{className:"error",children:h}),I,_&&r.jsxs("div",{style:{marginTop:12,display:"flex",alignItems:"center",gap:10},children:[r.jsx("button",{type:"button",className:"btn",disabled:g,onClick:async E=>{E.preventDefault(),E.stopPropagation(),y(null),m(null);try{b(!0),v(0),N("데이터 준비 중...");const S=c_(u);if(!S.length)throw new Error("업로드할 데이터가 없습니다. 엑셀 내용을 확인해 주세요.");const D=u_(S,250);let T=0,P=0,R=0;for(let Y=0;Y<D.length;Y++){const X=D[Y];N(`업로드 중... (${Y+1}/${D.length})`);const H=await fetch("/api/v1/demand/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:X})});if(!H.ok){const M=await H.text();try{const L=JSON.parse(M),B=(L==null?void 0:L.error)||M||`Upload failed: ${H.status}`;throw new Error(B)}catch{throw new Error(`Upload failed: ${H.status} ${M}`)}}const q=await H.json();P+=Number(q.updated||0),R+=Number(q.inserted||0),T+=X.length,v(Math.min(100,Math.round(T/S.length*100)))}N("완료"),y(`성공: 총 ${P+R}건 (업데이트 ${P}, 신규 ${R})`)}catch(S){m(S.message||"업로드 중 오류가 발생했습니다")}finally{b(!1),setTimeout(()=>{v(0),N("")},1200)}},children:"업로드"}),j&&r.jsx("span",{className:"muted",children:j})]}),g&&r.jsxs("div",{style:{marginTop:10,width:"100%"},children:[r.jsx("div",{className:"progress",children:r.jsx("div",{className:"progress-bar",style:{width:`${x}%`}})}),r.jsxs("div",{className:"muted",style:{marginTop:6},children:[A," ",x>0?`${x}%`:""]})]})]})}function c_(e){if(!e||e.length===0)return[];const n=e[0].map(j=>String(j||"").trim()),i=e.slice(1);function s(j){return n.map((y,x)=>j.some(v=>bl(y,v))?x:-1).filter(y=>y>=0)}const a=n.findIndex(j=>["영업담당자","영업사원","sales_owner","sales_rep","sales_rep_name"].some(y=>bl(j,y))),o=n.findIndex(j=>["거래처","고객","customer"].some(y=>bl(j,y))),l=n.findIndex(j=>["중분류","품목중분류","종분류","category_mid","item_subcategory"].some(y=>bl(j,y))),c=s(["공급사(tnt)","공급사 tnt","tnt","공급사","공급자","supplier"]),d=s(["영업관리단위","관리단위","mgmt_unit","sales_mgmt_unit"]),u=s(["점유율(%)","점유율","share","share_rate"]),f=Math.max(c.length,d.length,u.length),h=[];let m=null,g=null,b=null;for(const j of i){let y=Gs(j,a).trim(),x=Gs(j,o).trim(),v=Gs(j,l).trim();if(y||(y=m||""),x||(x=g||""),v||(v=b||""),!y||!x||!v){y&&(m=y),x&&(g=x),v&&(b=v);continue}m=y,g=x,b=v;for(let A=0;A<f;A++){const N=Gs(j,c[A]).trim(),C=Gs(j,d[A]).trim(),w=d_(Gs(j,u[A])),_=w!=null&&w!==0;if(!(N||C||_))continue;const I=_?w:null;h.push({salesRepName:y,customerName:x,itemSubcategory:v,supplierName:N,salesMgmtUnit:C,shareRate:I,priority:A+1})}}return h}function Gs(e,n){return n>=0?e[n]??"":""}function Pg(e){return String(e||"").replace(/[\s\-_%()\[\]{}]/g,"").replace(/tnt/gi,"").toLowerCase()}function bl(e,n){return Pg(e)===Pg(n)}function d_(e){if(e==null)return null;const n=Number(String(e).replace(/[,\s%]/g,""));return Number.isFinite(n)?n:null}function u_(e,n){const i=[];for(let s=0;s<e.length;s+=n)i.push(e.slice(s,s+n));return i}const Vv="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='20'%20height='20'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20aria-hidden='true'%3e%3cpath%20d='M20.59%2013.41%2011%203H4v7l9.59%209.59a2%202%200%200%200%202.82%200l4.18-4.18a2%202%200%200%200%200-2.82Z'/%3e%3ccircle%20cx='7.5'%20cy='7.5'%20r='1.5'/%3e%3c/svg%3e";function f_(e){if(!e)return"";const n=e instanceof Date?e:new Date(e);if(isNaN(n.getTime()))return"";const i=String(n.getFullYear()%100).padStart(2,"0"),s=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0");return`${i}-${s}-${a} ${o}:${l}`}function Og(){const[e,n]=p.useState(""),[i,s]=p.useState(""),[a,o]=p.useState(""),[l,c]=p.useState(!1),[d,u]=p.useState(null),[f,h]=p.useState([]),[m,g]=p.useState(""),[b,j]=p.useState(!1),[y,x]=p.useState({open:!1,x:0,y:0}),[v,A]=p.useState(()=>new Set),[N,C]=p.useState({open:!1,x:0,y:0}),[w,_]=p.useState(void 0),[I,O]=p.useState("init"),[E,S]=p.useState({}),[k,D]=p.useState("TNT"),T=100,[P,R]=p.useState(0),[Y,X]=p.useState(!0),[H,q]=p.useState(!1),M=Be.useRef(null),[L,B]=p.useState(0),F=["init","sim","apply","confirm"],te=[{key:"init",label:"초기설정"},{key:"sim",label:"Simulation"},{key:"apply",label:"목표반영"},{key:"confirm",label:"확정"}],$=F.indexOf(I),W=()=>{const se=Math.max(0,$-1);O(F[se])},U=()=>{const se=Math.min(F.length-1,$+1);O(F[se])};function Z(){const se=[];for(let we=2030;we>=2026;we--)se.push(we);return se}const[ee,K]=p.useState(""),[ne,pe]=p.useState(!1),[G,ae]=p.useState(null),[ie,J]=p.useState({tnt:0,dys:0}),[re,de]=p.useState({tnt:0,dys:0}),[he,oe]=p.useState({tnt:0,dys:0}),V=new Intl.NumberFormat("ko-KR");function Pe(se,we){return Number.isFinite(se)?se:0}function Ve(se,we){const Me=Number.isFinite(se)&&se>0,He=Me?Pe(se):0;return r.jsxs("div",{style:{textAlign:"right",lineHeight:1.15},children:[r.jsx("div",{children:Me?se%1===0?Math.round(se).toLocaleString():se.toFixed(2):"-"}),r.jsx("div",{className:"muted",style:{fontSize:11},children:Me?`${V.format(Math.round(He))} 원`:""})]})}async function tt(){pe(!0),ae(null);try{const se=(localStorage.getItem("tnt.sales.empName")||"").trim();if(!se){J({tnt:0,dys:0}),ae("로그인이 필요합니다");return}if(!ee||isNaN(Number(ee))){J({tnt:0,dys:0});return}const we=new URL("/api/v1/targets/assigned",window.location.origin);we.searchParams.set("year",String(ee)),we.searchParams.set("empNames",se);try{const Ye=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),at=Ye==="moderate"?"2":Ye==="best"?"1":"";at&&we.searchParams.set("versionNo",at)}catch{}const Me=await fetch(we.toString());if(!Me.ok)throw new Error(`HTTP ${Me.status}`);const He=await Me.json().catch(()=>[]),rt=Array.isArray(He)?He.find(Ye=>String(Ye.company_name||"").toUpperCase()==="TNT"):null,Fe=Array.isArray(He)?He.find(Ye=>String(Ye.company_name||"").toUpperCase()==="DYS"):null;J({tnt:Math.round(Number((rt==null?void 0:rt.assigned_amount)||0)),dys:Math.round(Number((Fe==null?void 0:Fe.assigned_amount)||0)),tntStage:String((rt==null?void 0:rt.target_stage)||"").trim()||void 0,dysStage:String((Fe==null?void 0:Fe.target_stage)||"").trim()||void 0})}catch(se){ae((se==null?void 0:se.message)||"조회 오류"),J({tnt:0,dys:0})}finally{pe(!1)}}const[ot,ht]=p.useState(0);p.useEffect(()=>{const se=()=>ht(we=>we+1);return window.addEventListener("tnt.sales.assign.mode.changed",se),()=>window.removeEventListener("tnt.sales.assign.mode.changed",se)},[]),p.useEffect(()=>{tt()},[ee,ot]);const[vt,Se]=p.useState(!1),[je,Te]=p.useState(null);new Date().getFullYear();const[Le,ke]=p.useState("prev1"),[Ue,st]=p.useState(()=>new Array(12).fill(0)),[Ee,dt]=p.useState({loading:!1});async function gt(){if(!(w!=null&&w.customerSeq)){st(new Array(12).fill(0));return}Se(!0),Te(null);try{const se=new Date().getFullYear(),we=Le==="prev1"?[se-1]:Le==="last2"?[se-1,se-2]:[se-1,se-2,se-3],Me=[];await Promise.all(we.map(async Ye=>{try{const at=await fetch(`/api/v1/customers/${w.customerSeq}/invoice-monthly-by-dim?year=${Ye}`);if(!at.ok)return;const Rt=await at.json().catch(()=>[]),xn=xt=>{const Kt=String(xt??"").trim();return Kt.toLowerCase()==="na"?"":Kt},Mn=(Array.isArray(Rt)?Rt:[]).map(xt=>({itemSubcategorySeq:Number(xt.itemSubcategorySeq??xt.item_subcategory_seq??0),salesMgmtUnitSeq:Number(xt.salesMgmtUnitSeq??xt.sales_mgmt_unit_seq??0),itemSubcategory:xn(xt.itemSubcategory??xt.item_subcategory),salesMgmtUnit:xn(xt.salesMgmtUnit??xt.sales_mgmt_unit),month:Number(xt.month??0),amount:Number(xt.amount??0)}));Me.push(...Mn)}catch{}}));const He=new Map,rt=(Ye,at)=>`${(Ye||"").trim().toLowerCase()}||${(at||"").trim().toLowerCase()}`;for(const Ye of Me){const at=rt(Ye.itemSubcategory,Ye.salesMgmtUnit);let Rt=He.get(at);Rt||(Rt={sub:Ye.itemSubcategory||"",unit:Ye.salesMgmtUnit||"",months:new Array(12).fill(0)},He.set(at,Rt));const xn=Math.min(12,Math.max(1,Number(Ye.month)||0))-1;Rt.months[xn]+=Number.isFinite(Ye.amount)?Number(Ye.amount):0}const Fe=Array.from(He.values()).sort((Ye,at)=>(Ye.sub||"").localeCompare(at.sub||"")||(Ye.unit||"").localeCompare(at.unit||""));yn(Fe)}catch(se){Te(se.message||"조회 중 오류가 발생했습니다"),yn([])}finally{Se(!1)}}p.useEffect(()=>{I==="init"&&gt()},[I,w==null?void 0:w.customerSeq,Le]);async function Nt(){if(!(w!=null&&w.customerSeq)){dt({loading:!1,hasRecent:void 0,error:null});return}dt({loading:!0,hasRecent:void 0,error:null});try{const se=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);se.searchParams.set("custSeq",String(w.customerSeq)),se.searchParams.set("years","2");const we=await fetch(se.toString());if(!we.ok){let rt=`HTTP ${we.status}`;try{const Fe=await we.json();Fe!=null&&Fe.error&&(rt=Fe.error)}catch{}throw new Error(rt)}const Me=await we.json(),He=Array.isArray(Me)&&Me.some(rt=>Number((rt==null?void 0:rt.customerSeq)||(rt==null?void 0:rt.customerSeqText)||0)===Number(w.customerSeq)&&!!(rt!=null&&rt.hasRecent));dt({loading:!1,hasRecent:He,error:null})}catch(se){dt({loading:!1,hasRecent:void 0,error:se.message||"오류"})}}p.useEffect(()=>{I==="init"&&Nt()},[I,w==null?void 0:w.customerSeq]);const[St,yn]=p.useState([]),Kr=p.useMemo(()=>r.jsx("div",{className:"table-container",style:{border:"1px solid var(--border)",borderRadius:8,marginTop:8},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:220,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:120,textAlign:"center"},children:"목표입력"}),Array.from({length:12},(se,we)=>r.jsxs("th",{style:{width:90,textAlign:"right"},children:[String(we+1).padStart(2,"0"),"월"]},we))]})}),r.jsx("tbody",{children:St.length===0?r.jsx("tr",{children:r.jsx("td",{className:"muted",colSpan:15,style:{padding:"12px 10px"},children:vt?"불러오는 중…":"데이터가 없습니다"})}):St.map((se,we)=>r.jsxs("tr",{children:[r.jsx("td",{children:se.sub}),r.jsx("td",{children:se.unit}),r.jsx("td",{style:{textAlign:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>Gr(se.sub,se.unit),children:"목표입력"})}),se.months.map((Me,He)=>r.jsx("td",{style:{textAlign:"right"},children:Math.round(Me).toLocaleString()},He))]},we))})]})}),[St,vt]),[Ot,En]=p.useState({open:!1,dist:new Array(12).fill(0)});function Gr(se,we){En({open:!0,sub:se,unit:we,month:"",qty:"",dist:new Array(12).fill(0)})}function Yt(){En({open:!1,dist:new Array(12).fill(0)})}function vr(se,we){const Me=Number(se),He=Number(we),rt=new Array(12).fill(0);if(Number.isFinite(Me)&&Me>=1&&Me<=12&&Number.isFinite(He)&&He>0){const Fe=12-Me+1,Ye=He/Fe;for(let at=Me-1;at<12;at++)rt[at]=Ye}En(Fe=>({...Fe,month:se,qty:we,dist:rt}))}const[zn,Zn]=p.useState({open:!1,rows:[]});function ue(){const se=(St||[]).map((we,Me)=>({key:`${we.sub}||${we.unit}||${Me}`,sub:we.sub,unit:we.unit,month:"",qty:"",dist:new Array(12).fill(0)}));Zn({open:!0,rows:se})}function De(){Zn({open:!1,rows:[]})}function Ke(se,we,Me){Zn(He=>{const rt=He.rows.slice(),Fe={...rt[se]},Ye=Number(we??Fe.month),at=Number(Me??Fe.qty),Rt=new Array(12).fill(0);if(Number.isFinite(Ye)&&Ye>=1&&Ye<=12&&Number.isFinite(at)&&at>0){const xn=12-Ye+1,Mn=at/xn;for(let xt=Ye-1;xt<12;xt++)Rt[xt]=Mn}return Fe.month=we??Fe.month,Fe.qty=Me??Fe.qty,Fe.dist=Rt,rt[se]=Fe,{...He,rows:rt}})}function lt(se){try{const we=se.getBoundingClientRect(),Me=(we==null?void 0:we.width)||se.offsetWidth||600,He=(we==null?void 0:we.height)||se.offsetHeight||400,rt=Math.max(0,Math.round((window.innerWidth-Me)/2)),Ye=Math.max(0,Math.round(window.innerHeight-He-40));return{x:rt,y:Ye}}catch{const we=Math.max(0,Math.round((window.innerWidth-600)/2)),He=Math.max(0,Math.round(window.innerHeight-400-40));return{x:we,y:He}}}function pt(se){try{const we=se.getBoundingClientRect(),Me=(we==null?void 0:we.width)||se.offsetWidth||460,He=Math.max(0,Math.round(window.innerWidth-Me)),rt=Math.max(0,Math.round(window.innerHeight*.17));return{x:He,y:rt}}catch{const Me=Math.max(0,Math.round(window.innerWidth-460)),He=Math.max(0,Math.round(window.innerHeight*.17));return{x:Me,y:He}}}const jt=tr("sales-plan-target-input",!!Ot.open,lt,{persist:!1,resetOnOpen:!0}),Dt=tr("sales-plan-bulk-input",!!zn.open,lt,{persist:!1,resetOnOpen:!0}),[cn,Un]=p.useState({open:!1,rows:[]}),[Ct,Mt]=p.useState("");function me(){const se=(St||[]).map((we,Me)=>({key:`${we.sub}||${we.unit}||${Me}`,sub:we.sub,unit:we.unit,month:"",qty:"",dist:new Array(12).fill(0)}));Un({open:!0,rows:se})}function ze(){Un({open:!1,rows:[]})}function Oe(se,we,Me){Un(He=>{const rt=He.rows.slice(),Fe={...rt[se]},Ye=Number(we??Fe.month),at=Number(Me??Fe.qty),Rt=new Array(12).fill(0);if(Number.isFinite(Ye)&&Ye>=1&&Ye<=12&&Number.isFinite(at)&&at>0){const xn=12-Ye+1,Mn=at/xn;for(let xt=Ye-1;xt<12;xt++)Rt[xt]=Mn}return Fe.month=we??Fe.month,Fe.qty=Me??Fe.qty,Fe.dist=Rt,rt[se]=Fe,{...He,rows:rt}})}const Ze=tr("sales-plan-bulk-ratio",!!cn.open,lt,{persist:!1,resetOnOpen:!0}),[Ne,Xe]=p.useState({open:!1,loading:!1,error:null,opts:[],dist:new Array(12).fill(0),rows:[]}),$e=tr("sales-plan-new-item",!!Ne.open,lt,{persist:!1,resetOnOpen:!0});async function ct(){Xe(se=>({...se,open:!0,loading:!0,error:null,unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0),rows:[]}));try{const se=await fetch("/api/v1/items/dim"),we=se.ok?await se.json():[],Me=Array.isArray(we)?we.map(Fe=>({itemSubcategory:String(Fe.itemSubcategory||Fe.item_subcategory||""),salesMgmtUnit:String(Fe.salesMgmtUnit||Fe.sales_mgmt_unit||"")})):[],He={};Me.forEach(Fe=>{const Ye=Fe.salesMgmtUnit.trim();Ye&&!He[Ye]&&(He[Ye]=Fe)});const rt=Object.values(He).sort((Fe,Ye)=>Fe.salesMgmtUnit.localeCompare(Ye.salesMgmtUnit));Xe(Fe=>({...Fe,loading:!1,opts:rt}))}catch(se){Xe(we=>({...we,loading:!1,error:(se==null?void 0:se.message)||"조회 오류",opts:[]}))}}function ut(){Xe({open:!1,loading:!1,error:null,opts:[],dist:new Array(12).fill(0),rows:[]})}function yt(se){const we=Ne.opts.find(Me=>Me.salesMgmtUnit===se);Xe(Me=>({...Me,unit:se,sub:(we==null?void 0:we.itemSubcategory)||Me.sub}))}function ft(se,we){const Me=Number(se??Ne.month),He=Number(we??Ne.qty),rt=new Array(12).fill(0);if(Number.isFinite(Me)&&Me>=1&&Me<=12&&Number.isFinite(He)&&He>0){const Fe=12-Me+1,Ye=He/Fe;for(let at=Me-1;at<12;at++)rt[at]=Ye}Xe(Fe=>({...Fe,month:se??Fe.month,qty:we??Fe.qty,dist:rt}))}function nn(){const se=(Ne.unit||"").trim(),we=(Ne.sub||"").trim(),Me=Ne.month,He=Ne.qty;if(!se||!Me||!He){alert("영업관리단위, 매출월, 매출 수량을 입력하세요.");return}const rt={sub:we||"(신규)",unit:se,months:Ne.dist.slice()};Xe(Fe=>({...Fe,rows:[...Fe.rows,rt],unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0)}))}p.useEffect(()=>{if(!Ot.open&&!zn.open&&!Ne.open)return;const se=we=>{we.key==="Escape"&&(Ot.open&&Yt(),zn.open&&De(),Ne.open&&ut())};return window.addEventListener("keydown",se,!0),()=>window.removeEventListener("keydown",se,!0)},[Ot.open,zn.open,Ne.open]);async function Et(se=!0){u(null),se?(c(!0),R(0),X(!0)):q(!0);try{const we=localStorage.getItem("tnt.sales.assigneeId");if(!we){h([]),u(zt.loginRequired);return}const Me=new URL("/api/v1/customers",window.location.origin);Me.searchParams.set("mineOnly","true"),Me.searchParams.set("assigneeId",we),Me.searchParams.set("companyType",k),m.trim()&&Me.searchParams.set("name",m.trim()),Me.searchParams.set("limit",String(T)),Me.searchParams.set("offset",String(se?0:P));const He=await fetch(Me.toString());if(!He.ok){let Ye=`HTTP ${He.status}`;try{const at=await He.json();at!=null&&at.error&&(Ye=at.error)}catch{const at=await He.text();at&&(Ye=at)}throw new Error(Ye)}const rt=await He.json(),Fe=Array.isArray(rt)?rt:[];h(se?Fe:Ye=>[...Ye,...Fe]),X(Fe.length>=T),R(Ye=>se?T:Ye+T);try{if(we){const Ye=new URL("/api/v1/customers/count",window.location.origin);Ye.searchParams.set("mineOnly","true"),Ye.searchParams.set("assigneeId",we);const at=await fetch(Ye.toString());if(at.ok){const Rt=await at.json().catch(()=>({})),xn=Number((Rt==null?void 0:Rt.total)??0);B(Number.isFinite(xn)?xn:0)}else B(0)}else B(0)}catch{B(0)}try{const Ye=Fe.map(at=>Number(at.customerSeq||0)).filter(at=>Number.isFinite(at)&&at>0);if(Ye.length>0){const at=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);at.searchParams.set("custSeq",Array.from(new Set(Ye)).join(",")),at.searchParams.set("years","2");const Rt=await fetch(at.toString());if(Rt.ok){const xn=await Rt.json(),Mn={};Array.isArray(xn)&&xn.forEach(xt=>{const Kt=Number((xt==null?void 0:xt.customerSeq)||(xt==null?void 0:xt.customerSeqText)||0);Number.isFinite(Kt)&&(Mn[Kt]=!!(xt!=null&&xt.hasRecent))}),S(xt=>se?Mn:{...xt,...Mn})}else se&&S({})}else se&&S({})}catch{S({})}}catch(we){u(we.message||"조회 중 오류가 발생했습니다")}finally{se?c(!1):q(!1)}}p.useEffect(()=>{Et(!0)},[]),p.useEffect(()=>{Et(!0)},[k]),p.useEffect(()=>{if(!y.open)return;const se=()=>x({open:!1,x:0,y:0});return window.addEventListener("click",se),()=>window.removeEventListener("click",se)},[y.open]),p.useEffect(()=>{if(!y.open)return;const se=we=>{we.key==="Escape"&&x({open:!1,x:0,y:0})};return window.addEventListener("keydown",se),()=>window.removeEventListener("keydown",se)},[y.open]),p.useEffect(()=>{const se=we=>{((we==null?void 0:we.key)==="Escape"||(we==null?void 0:we.key)==="Esc"||(we==null?void 0:we.keyCode)===27)&&(x({open:!1,x:0,y:0}),C({open:!1,x:0,y:0}))};return document.addEventListener("keydown",se,!0),()=>document.removeEventListener("keydown",se,!0)},[]);async function At(se,we){se.preventDefault(),se.stopPropagation(),x({open:!1,x:0,y:0});const Me=se.clientX,He=se.clientY;C({open:!0,x:Me,y:He,row:we,loading:!1,error:null,data:[]})}const ci=p.useMemo(()=>{var we,Me,He,rt,Fe,Ye,at,Rt,xn,Mn,xt,Kt,hs,Ma,gl;const se=[...f].sort((Hn,Vi)=>{const Vr=Number(Hn.customerSeq||0),Ra=Number(Vi.customerSeq||0),wu=!!E[Vr],bt=!!E[Ra];if(wu!==bt)return bt?1:-1;const or=(Hn.customerName||"").toString(),$a=(Vi.customerName||"").toString();return or.localeCompare($a,"ko",{sensitivity:"base"})});return r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:8},children:[r.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,cursor:"pointer"},children:[r.jsx("input",{type:"radio",name:"companyType",checked:k==="TNT",onChange:()=>D("TNT")}),r.jsx("span",{children:"TNT"})]}),r.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,cursor:"pointer"},children:[r.jsx("input",{type:"radio",name:"companyType",checked:k==="DYS",onChange:()=>D("DYS")}),r.jsx("span",{children:"DYS"})]})]}),r.jsxs("div",{ref:M,className:"table-container",onClick:()=>x({open:!1,x:0,y:0}),style:{height:"100%",overflow:"auto"},children:[se.length===0?r.jsx("div",{className:"empty-state",children:zt.empty}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsx("tr",{children:r.jsx("th",{style:{width:"auto"},children:"거래처명"})})}),r.jsx("tbody",{children:se.map((Hn,Vi)=>r.jsx("tr",{onClick:Vr=>{Vr.preventDefault(),Vr.stopPropagation(),_(Hn),C({open:!1,x:0,y:0})},onContextMenu:Vr=>At(Vr,Hn),"aria-selected":(w==null?void 0:w.customerId)===Hn.customerId?!0:void 0,style:(w==null?void 0:w.customerId)===Hn.customerId?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:r.jsx("td",{children:(()=>{const Vr=Number(Hn.customerSeq||0);return E[Vr]?r.jsxs("span",{children:[Hn.customerName," "," ","$"]}):Hn.customerName})()})},Vi))})]}),H&&r.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:zt.loading}),!l&&!H&&!Y&&f.length>0&&r.jsx("div",{className:"muted",style:{padding:"8px 10px",textAlign:"center"},children:"마지막 데이터입니다."}),N.open&&r.jsxs("div",{className:"context-menu",style:{left:N.x+6,top:N.y+6,maxWidth:420,padding:8},onClick:Hn=>Hn.stopPropagation(),children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 상세"}),N.error?r.jsx("div",{className:"error",style:{maxWidth:380},children:N.error}):r.jsx("table",{className:"table",style:{width:"100%"},children:r.jsxs("tbody",{children:[r.jsxs("tr",{children:[r.jsx("th",{style:{width:110,textAlign:"left"},children:"거래처번호"}),r.jsx("td",{children:((we=N.row)==null?void 0:we.customerId)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"사업자번호"}),r.jsx("td",{children:((Me=N.row)==null?void 0:Me.bizNo)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"대표자명"}),r.jsx("td",{children:((He=N.row)==null?void 0:He.ownerName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"업태"}),r.jsx("td",{children:((rt=N.row)==null?void 0:rt.bizKind)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"종목"}),r.jsx("td",{children:((Fe=N.row)==null?void 0:Fe.bizType)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"전화번호"}),r.jsx("td",{children:((Ye=N.row)==null?void 0:Ye.telNo)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"담당자명"}),r.jsx("td",{children:((at=N.row)==null?void 0:at.empName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"부서명"}),r.jsx("td",{children:((Rt=N.row)==null?void 0:Rt.deptName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"시/도"}),r.jsx("td",{children:((xn=N.row)==null?void 0:xn.addrProvinceName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"시/군/구"}),r.jsx("td",{children:((Mn=N.row)==null?void 0:Mn.addrCityName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"고객유형"}),r.jsx("td",{children:((xt=N.row)==null?void 0:xt.customerTypeName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"비고"}),r.jsx("td",{children:((Kt=N.row)==null?void 0:Kt.customerRemark)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"생성자"}),r.jsx("td",{children:((hs=N.row)==null?void 0:hs.createdBy)??""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"수정자"}),r.jsx("td",{children:((Ma=N.row)==null?void 0:Ma.updatedBy)??""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"생성일시"}),r.jsx("td",{children:f_((gl=N.row)==null?void 0:gl.createdAt)})]})]})})]})]})]})},[f,y,v,N,w,E,l,H,Y]);p.useEffect(()=>{const se=M.current;if(!se)return;function we(){se.scrollTop+se.clientHeight>=se.scrollHeight-48&&Y&&!H&&!l&&Et(!1)}return se.addEventListener("scroll",we),()=>se.removeEventListener("scroll",we)},[Y,H,l,P]);const[Nn,Ki]=p.useState({open:!1,loading:!1,error:null,rows:[]}),Gi=tr("unit-amounts-by-emp",Nn.open,pt,{persist:!1,resetOnOpen:!0});function pl(){Ki({open:!0,loading:!0,error:null,rows:[]});const se=(localStorage.getItem("tnt.sales.empName")||"").trim();if(!se){Ki({open:!0,loading:!1,error:"로그인이 필요합니다",rows:[]});return}const we=new URL("/api/v1/dashboard/unit-amounts-by-emp",window.location.origin);we.searchParams.set("empName",se),fetch(we.toString()).then(async Me=>{if(!Me.ok){let Fe=`HTTP ${Me.status}`;try{const Ye=await Me.json();Ye!=null&&Ye.error&&(Fe=Ye.error)}catch{const Ye=await Me.text();Ye&&(Fe=Ye)}throw new Error(Fe)}const He=await Me.json(),rt=(Array.isArray(He)?He:[]).map(Fe=>({unit:String((Fe==null?void 0:Fe.sales_mgmt_unit)??(Fe==null?void 0:Fe.salesMgmtUnit)??""),amount:Number((Fe==null?void 0:Fe.amount)??0)}));Ki({open:!0,loading:!1,error:null,rows:rt})}).catch(Me=>Ki({open:!0,loading:!1,error:(Me==null?void 0:Me.message)||"조회 오류",rows:[]}))}function ml(){Ki(se=>({...se,open:!1}))}return p.useEffect(()=>{if(!Nn.open)return;const se=we=>{we.key==="Escape"&&ml()};return window.addEventListener("keydown",se,!0),()=>window.removeEventListener("keydown",se,!0)},[Nn.open]),p.useEffect(()=>{if(!Ot.open)return;const se=we=>{we.key==="Escape"&&Yt()};return window.addEventListener("keydown",se,!0),()=>window.removeEventListener("keydown",se,!0)},[Ot.open]),p.useEffect(()=>{if(!zn.open)return;const se=we=>{we.key==="Escape"&&De()};return window.addEventListener("keydown",se,!0),()=>window.removeEventListener("keydown",se,!0)},[zn.open]),p.useEffect(()=>{if(!cn.open)return;const se=we=>{we.key==="Escape"&&ze()};return window.addEventListener("keydown",se,!0),()=>window.removeEventListener("keydown",se,!0)},[cn.open]),p.useEffect(()=>{if(!Ne.open)return;const se=we=>{we.key==="Escape"&&ut()};return window.addEventListener("keydown",se,!0),()=>window.removeEventListener("keydown",se,!0)},[Ne.open]),r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsxs("h2",{style:{margin:0,fontSize:18,display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:["목표 Simulation",r.jsxs("select",{className:"search-input",value:ee,onChange:se=>K(se.target.value),"aria-label":"목표년도",children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Z().map(se=>r.jsxs("option",{value:String(se),children:[se,"년"]},se))]}),r.jsxs("span",{className:"badge",title:"내 목표 배정(TNT)",children:["TNT(배정): ",V.format(ie.tnt)," 억"]}),r.jsxs("span",{className:"badge",title:"내 목표 배정(DYS)",children:["DYS(배정): ",V.format(ie.dys)," 억"]}),r.jsx("span",{"aria-hidden":"true",style:{opacity:.4},children:"|"}),r.jsxs("span",{className:"badge",title:"내 목표 계획(TNT)",children:["TNT(계획): ",V.format(re.tnt)," 억"]}),r.jsxs("span",{className:"badge",title:"내 목표 계획(DYS)",children:["DYS(계획): ",V.format(re.dys)," 억"]}),r.jsx("span",{"aria-hidden":"true",style:{opacity:.4},children:"|"}),r.jsxs("span",{className:"badge",title:"내 목표 차액(TNT)",children:["TNT(차액): ",V.format(he.tnt)," 억"]}),r.jsxs("span",{className:"badge",title:"내 목표 차액(DYS)",children:["DYS(차액): ",V.format(he.dys)," 억"]})]}),r.jsxs("div",{className:"muted count-text",style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("button",{className:"btn-plain",title:"내 평균거래 단가",onClick:pl,"aria-label":"평균거래 단가 팝업 열기",children:r.jsx("img",{src:Vv,className:"icon",alt:"단가"})}),L.toLocaleString(),"개 거래처"]})]}),d&&r.jsx("div",{className:"error",children:d||zt.errorGeneric}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[r.jsxs("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:[r.jsx("div",{className:"card",style:{padding:8,marginBottom:8},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{className:"search-input",placeholder:"거래처명",value:m,onChange:se=>g(se.target.value),onKeyDown:se=>{se.key==="Enter"&&Et(!0)},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:()=>Et(!0),disabled:l,style:{flex:"0 0 auto"},children:"조회"})]})}),ci]}),r.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:te.map((se,we)=>{const Me=we<$,He=we===$;return r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:we===te.length-1?"0 0 auto":"1 1 0"},children:[r.jsx("div",{title:se.label,onClick:()=>O(se.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:Me||He?"var(--accent)":"transparent",border:`2px solid ${Me||He?"var(--accent)":"var(--border)"}`,color:Me||He?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":He?"step":void 0,children:Me?"✓":we+1}),r.jsx("div",{style:{fontSize:12,color:He||Me?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:se.label}),we<te.length-1&&r.jsx("div",{style:{height:2,background:we<$?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},se.key)})}),r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("button",{className:"btn btn-icon",onClick:W,disabled:$===0,"aria-label":"이전 단계",title:"이전 단계",children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:r.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),r.jsx("button",{className:"btn btn-icon",onClick:U,disabled:$===te.length-1,"aria-label":"다음 단계",title:"다음 단계",children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:r.jsx("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),I==="init"&&r.jsxs("section",{style:{marginTop:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:10},children:[r.jsx("b",{children:"기준매출"}),r.jsxs("select",{value:Le,onChange:se=>ke(se.target.value),style:{height:28,padding:"4px 8px",borderRadius:8,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12},"aria-label":"기준 기간 선택",children:[r.jsx("option",{value:"prev1",children:"전년"}),r.jsx("option",{value:"last2",children:"최근2년"}),r.jsx("option",{value:"last3",children:"최근3년"})]})]}),r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[je&&r.jsx("span",{className:"error",children:je}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:me,children:"일괄비율"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:ue,children:"일괄입력"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:ct,children:"신규품목"})]})]}),Kr]})]})]}),Ot.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:jt.ref,className:"card",style:{...jt.style,width:720,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[r.jsx("div",{...jt.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:Yt,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 120px 1fr",gap:8,alignItems:"center"},children:[r.jsx("div",{className:"muted",children:"중분류"}),r.jsx("div",{children:Ot.sub||""}),r.jsx("div",{className:"muted",children:"영업관리단위"}),r.jsx("div",{children:Ot.unit||""}),r.jsx("div",{className:"muted",children:"매출월"}),r.jsx("div",{children:r.jsxs("select",{className:"search-input",value:Ot.month||"",onChange:se=>vr(se.target.value,Ot.qty),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(se,we)=>we+1).map(se=>r.jsxs("option",{value:String(se),children:[se,"월"]},se))]})}),r.jsx("div",{className:"muted",children:"매출 수량"}),r.jsx("div",{children:r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:Ot.qty||"",onChange:se=>vr(Ot.month,se.target.value)})})]}),r.jsx("div",{style:{marginTop:12},children:r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsx("tr",{children:Array.from({length:12},(se,we)=>we+1).map(se=>r.jsxs("th",{style:{textAlign:"right"},children:[String(se).padStart(2,"0"),"월"]},se))})}),r.jsx("tbody",{children:r.jsx("tr",{children:Ot.dist.map((se,we)=>r.jsx("td",{children:Ve(se)},we))})})]})})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(단건) — 추후 구현 예정"),children:"목표등록"})})]})}),zn.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:Dt.ref,className:"card",style:{...Dt.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[r.jsx("div",{...Dt.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:De,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h2",{style:{margin:0},children:"목표 일괄입력"})}),r.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:120,textAlign:"left"},children:"매출월"}),r.jsx("th",{style:{width:120,textAlign:"left"},children:"매출 수량"}),Array.from({length:12},(se,we)=>we+1).map(se=>r.jsxs("th",{style:{textAlign:"right"},children:[String(se).padStart(2,"0"),"월"]},se))]})}),r.jsx("tbody",{children:zn.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:16,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):zn.rows.map((se,we)=>r.jsxs("tr",{children:[r.jsx("td",{children:se.sub}),r.jsx("td",{children:se.unit}),r.jsx("td",{children:r.jsxs("select",{className:"search-input",value:se.month||"",onChange:Me=>Ke(we,Me.target.value,void 0),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(Me,He)=>He+1).map(Me=>r.jsxs("option",{value:String(Me),children:[Me,"월"]},Me))]})}),r.jsx("td",{children:r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:se.qty||"",onChange:Me=>Ke(we,void 0,Me.target.value)})}),se.dist.map((Me,He)=>r.jsx("td",{children:Ve(Me)},He))]},se.key))})]})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(일괄) — 추후 구현 예정"),children:"목표등록"})})]})}),cn.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:Ze.ref,className:"card",style:{...Ze.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[r.jsx("div",{...Ze.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:ze,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsxs("div",{className:"page-title",style:{marginBottom:8,alignItems:"center"},children:[r.jsx("h2",{style:{margin:0},children:"목표 일괄비율"}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsx("span",{className:"muted",children:"적용 비율(%)"}),r.jsx("input",{className:"assign-input",type:"number",min:0,max:100,step:1,placeholder:"0",value:Ct,onChange:se=>Mt(se.target.value),style:{width:100},"aria-label":"일괄 비율 입력"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("일괄비율 적용 — 추후 개발 예정"),children:"적용"})]})]}),r.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:120,textAlign:"left"},children:"매출월"}),r.jsx("th",{style:{width:120,textAlign:"left"},children:"매출 수량"}),Array.from({length:12},(se,we)=>we+1).map(se=>r.jsxs("th",{style:{textAlign:"right"},children:[String(se).padStart(2,"0"),"월"]},se))]})}),r.jsx("tbody",{children:cn.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:16,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):cn.rows.map((se,we)=>r.jsxs("tr",{children:[r.jsx("td",{children:se.sub}),r.jsx("td",{children:se.unit}),r.jsx("td",{children:r.jsxs("select",{className:"search-input",value:se.month||"",onChange:Me=>Oe(we,Me.target.value,void 0),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(Me,He)=>He+1).map(Me=>r.jsxs("option",{value:String(Me),children:[Me,"월"]},Me))]})}),r.jsx("td",{children:r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:se.qty||"",onChange:Me=>Oe(we,void 0,Me.target.value)})}),se.dist.map((Me,He)=>r.jsx("td",{children:Ve(Me)},He))]},se.key))})]})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(일괄비율) — 추후 구현 예정"),children:"목표등록"})})]})}),Ne.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:$e.ref,className:"card",style:{...$e.style,width:820,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[r.jsx("div",{...$e.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:ut,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h2",{style:{margin:0},children:"신규품목"})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 120px 1fr",gap:8,alignItems:"center"},children:[r.jsx("div",{className:"muted",children:"영업관리단위"}),r.jsx("div",{children:r.jsxs("select",{className:"search-input",value:Ne.unit||"",onChange:se=>yt(se.target.value),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Ne.opts.map((se,we)=>r.jsx("option",{value:se.salesMgmtUnit,children:se.salesMgmtUnit},we))]})}),r.jsx("div",{className:"muted",children:"중분류"}),r.jsx("div",{children:r.jsx("input",{className:"assign-input",value:Ne.sub||"",readOnly:!0,placeholder:"자동"})}),r.jsx("div",{className:"muted",children:"매출월"}),r.jsx("div",{children:r.jsxs("select",{className:"search-input",value:Ne.month||"",onChange:se=>ft(se.target.value,void 0),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(se,we)=>we+1).map(se=>r.jsxs("option",{value:String(se),children:[se,"월"]},se))]})}),r.jsx("div",{className:"muted",children:"매출 수량"}),r.jsx("div",{children:r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:Ne.qty||"",onChange:se=>ft(void 0,se.target.value)})})]}),r.jsx("div",{style:{marginTop:12},children:r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsx("tr",{children:Array.from({length:12},(se,we)=>we+1).map(se=>r.jsxs("th",{style:{textAlign:"right"},children:[String(se).padStart(2,"0"),"월"]},se))})}),r.jsx("tbody",{children:r.jsx("tr",{children:Ne.dist.map((se,we)=>r.jsx("td",{children:Ve(se)},we))})})]})})}),r.jsxs("div",{style:{marginTop:12},children:[r.jsx("div",{className:"pane-header",style:{margin:0},children:"추가된 항목"}),r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),Array.from({length:12},(se,we)=>we+1).map(se=>r.jsxs("th",{style:{textAlign:"right"},children:[String(se).padStart(2,"0"),"월"]},se))]})}),r.jsx("tbody",{children:Ne.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:14,className:"muted",style:{padding:"12px 10px"},children:"추가된 항목이 없습니다"})}):Ne.rows.map((se,we)=>r.jsxs("tr",{children:[r.jsx("td",{children:se.sub}),r.jsx("td",{children:se.unit}),se.months.map((Me,He)=>r.jsx("td",{children:Ve(Me)},He))]},we))})]})})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:[r.jsx("button",{className:"btn btn-card btn-3d",onClick:nn,children:"추가"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(신규품목) — 추후 구현 예정"),children:"목표등록"})]})]})}),Nn.open&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:60},children:r.jsxs("div",{ref:Gi.ref,className:"card",style:{...Gi.style,height:"66vh",width:460,maxWidth:"92vw",background:"var(--panel)",padding:12,borderLeft:"1px solid var(--border)",boxShadow:"-8px 0 24px rgba(0,0,0,0.18)",overflow:"auto"},children:[r.jsx("div",{...Gi.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:ml,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h2",{style:{margin:0},children:"내 평균거래 단가"})}),Nn.error?r.jsx("div",{className:"error",style:{maxWidth:420},children:Nn.error}):r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:280,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:180,textAlign:"right"},children:"합계(원)"})]})}),r.jsx("tbody",{children:Nn.loading?r.jsx("tr",{children:r.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"불러오는 중…"})}):Nn.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):Nn.rows.map((se,we)=>r.jsxs("tr",{children:[r.jsx("td",{children:se.unit||"na"}),r.jsxs("td",{style:{textAlign:"right"},children:[V.format(Math.round(se.amount))," 원"]})]},we))})]})})]})})]})}function h_(e){if(!e)return"";const n=e instanceof Date?e:new Date(e);if(isNaN(n.getTime()))return"";const i=String(n.getFullYear()%100).padStart(2,"0"),s=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0");return`${i}-${s}-${a} ${o}:${l}`}function p_(){const[e,n]=p.useState(""),[i,s]=p.useState(""),[a,o]=p.useState(""),[l,c]=p.useState(!1),[d,u]=p.useState(null),[f,h]=p.useState([]),[m,g]=p.useState(""),[b,j]=p.useState(!1),[y,x]=p.useState({open:!1,x:0,y:0}),[v,A]=p.useState(()=>new Set),[N,C]=p.useState({open:!1,x:0,y:0}),[w,_]=p.useState(void 0),[I,O]=p.useState("init"),[E,S]=p.useState({}),[k,D]=p.useState("TNT"),[T,P]=p.useState({}),R=100,[Y,X]=p.useState(0),[H,q]=p.useState(!0),[M,L]=p.useState(!1),B=Be.useRef(null),[F,te]=p.useState(0),[$,W]=p.useState({show:!1,name:"",tnt:0,dys:0,year:0}),[U,Z]=p.useState(!1),[ee,K]=p.useState({tnt:0,dys:0}),ne=["init","sim","confirm"],pe=[{key:"init",label:"초기설정"},{key:"sim",label:"계획 수립 중"},{key:"confirm",label:"확정"}],G=ne.indexOf(I);function ae(){const z=[];for(let Q=2030;Q>=2026;Q--)z.push(Q);return z}const[ie,J]=p.useState(""),[re,de]=p.useState(!1),[he,oe]=p.useState(null),[V,Pe]=p.useState({tnt:0,dys:0}),[Ve,tt]=p.useState({tnt:0,dys:0}),[ot,ht]=p.useState({tnt:0,dys:0}),[vt,Se]=p.useState({tnt:0,dys:0}),[je,Te]=p.useState({open:!1,company:"TNT",group:"customer",loading:!1,error:null,rows:[]}),[Le,ke]=p.useState({x:0,y:0}),Ue=new Intl.NumberFormat("ko-KR"),st=new Intl.NumberFormat("ko-KR",{minimumFractionDigits:2,maximumFractionDigits:2}),[Ee,dt]=p.useState(null),[gt,Nt]=p.useState({val:"",loading:!1,saving:!1,error:null,success:null});async function St(){try{const z=Number(ie),Q=Number((w==null?void 0:w.customerSeq)||0),ce=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!ce||!Number.isFinite(z)||z<=0||!Q){Nt(ve=>({...ve,val:"",loading:!1,error:null}));return}Nt(ve=>({...ve,loading:!0,error:null}));const ge=new URL("/api/v1/sales/plan/plan-remark",window.location.origin);ge.searchParams.set("year",String(z)),ge.searchParams.set("customerSeq",String(Q));const fe=await fetch(ge.toString(),{headers:{"X-ASSIGNEE-ID":ce}});if(!fe.ok)throw new Error(`HTTP ${fe.status}`);const le=await fe.json().catch(()=>({})),be=String((le==null?void 0:le.remark)??"");Nt({val:be,loading:!1,saving:!1,error:null,success:null})}catch(z){Nt(Q=>({...Q,loading:!1,error:(z==null?void 0:z.message)||"조회 오류"}))}}async function yn(){try{const z=Number(ie),Q=Number((w==null?void 0:w.customerSeq)||0),ce=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!ce){alert("로그인이 필요합니다.");return}if(!Number.isFinite(z)||z<=0){alert("연도를 선택하세요.");return}if(!Q){alert("거래처를 선택하세요.");return}Nt(be=>({...be,saving:!0,error:null,success:null}));const ge={"Content-Type":"application/json","X-ASSIGNEE-ID":ce},fe=JSON.stringify({year:z,customerSeq:Q,remark:gt.val}),le=await fetch("/api/v1/sales/plan/plan-remark",{method:"POST",headers:ge,body:fe});if(!le.ok){let be=await le.text().catch(()=>"");throw new Error(be||"HTTP "+le.status)}Nt(be=>({...be,saving:!1,success:"저장되었습니다."})),setTimeout(()=>Nt(be=>({...be,success:null})),1200)}catch(z){Nt(Q=>({...Q,saving:!1,error:(z==null?void 0:z.message)||"저장 오류"}))}}p.useEffect(()=>{w!=null&&w.customerSeq&&ie&&St()},[w==null?void 0:w.customerSeq,ie]);async function Kr(){try{const z=Number(ie),Q=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),ce=Number((w==null?void 0:w.customerSeq)||0);if(!Q){alert("로그인이 필요합니다.");return}if(!Number.isFinite(z)||z<=0){alert("연도를 선택하세요.");return}if(!ce){alert("거래처를 선택하세요.");return}const ge={year:z,companyType:k,assigneeId:Q,customerSeq:ce},fe={"Content-Type":"application/json","X-ASSIGNEE-ID":Q},le=(localStorage.getItem("tnt.sales.empId")||"").trim();le&&(fe["X-EMP-ID"]=le);const be=await fetch("/api/v1/sales/plan/confirm-customer",{method:"POST",headers:fe,body:JSON.stringify(ge)});if(!be.ok){let ve=await be.text().catch(()=>"");throw new Error(ve||"HTTP "+be.status)}await be.json().catch(()=>({})),O("confirm"),Un(ve=>ve+1);try{const ve=String((w==null?void 0:w.customerName)||""),ye=String(ie||"");dt(ve&&ye?`${ve} ${ye}년 목표 수립이 완료되었습니다.`:"목표 수립이 완료되었습니다.")}catch{dt("목표 수립이 완료되었습니다.")}}catch(z){alert((z==null?void 0:z.message)||"확정 처리 중 오류가 발생했습니다")}}const[Ot,En]=p.useState(!1),[Gr,Yt]=p.useState(""),[vr,zn]=p.useState("TNT");function Zn(z,Q){return Number.isFinite(z)?z:0}function ue(z,Q,ce,ge,fe){const le=Number.isFinite(z)&&z>0,be=le&&Number.isFinite(ce),ve=be?Number(ce):le?Zn(z):0,ye=le?st.format(Number(z)):"-",_e=le?be?`${st.format(Number(ve))} 원`:"-":"";return r.jsxs("div",{style:{textAlign:"right",lineHeight:1.15,color:ge||void 0},children:[r.jsx("div",{style:{fontWeight:fe?700:void 0},children:ye}),r.jsx("div",{className:fe?void 0:"muted",style:{fontSize:11,color:ge||void 0,fontWeight:fe?700:void 0},children:_e})]})}async function De(z,Q){try{const ce=Number(ie),ge=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!ge||!Number.isFinite(ce)||ce<=0){Te(ye=>({...ye,rows:[],error:null,loading:!1}));return}Te(ye=>({...ye,loading:!0,error:null}));const fe=new URL("/api/v1/sales/plan/totals-breakdown",window.location.origin);fe.searchParams.set("year",String(ce)),fe.searchParams.set("assigneeId",ge),fe.searchParams.set("companyType",z),fe.searchParams.set("groupBy",Q);const le=await fetch(fe.toString());if(!le.ok){let ye=await le.text().catch(()=>"");throw new Error(ye||"HTTP "+le.status)}const be=await le.json().catch(()=>[]),ve=(Array.isArray(be)?be:[]).map(ye=>({key:String((ye==null?void 0:ye.key)??""),label:ye!=null&&ye.label?String(ye.label):void 0,amount:Number((ye==null?void 0:ye.amount)??0)}));Te(ye=>({...ye,rows:ve,loading:!1,error:null}))}catch(ce){Te(ge=>({...ge,loading:!1,error:(ce==null?void 0:ce.message)||"조회 오류",rows:[]}))}}function Ke(z,Q){if(Q)try{ke({x:Q.clientX||0,y:Q.clientY||0})}catch{}Te({open:!0,company:z,group:"customer",loading:!1,error:null,rows:[]}),De(z,"customer")}function lt(){Te(z=>({...z,open:!1}))}async function pt(){de(!0),oe(null);try{const z=(localStorage.getItem("tnt.sales.empName")||"").trim();if(!z){Pe({tnt:0,dys:0}),oe("로그인이 필요합니다");return}if(!ie||isNaN(Number(ie))){Pe({tnt:0,dys:0});return}const Q=new URL("/api/v1/targets/assigned",window.location.origin);Q.searchParams.set("year",String(ie)),Q.searchParams.set("empNames",z);try{const be=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),ve=be==="moderate"?"2":be==="best"?"1":"";ve&&Q.searchParams.set("versionNo",ve)}catch{}const ce=await fetch(Q.toString());if(!ce.ok)throw new Error(`HTTP ${ce.status}`);const ge=await ce.json().catch(()=>[]),fe=Array.isArray(ge)?ge.find(be=>String(be.company_name||"").toUpperCase()==="TNT"):null,le=Array.isArray(ge)?ge.find(be=>String(be.company_name||"").toUpperCase()==="DYS"):null;Pe({tnt:Math.round(Number((fe==null?void 0:fe.assigned_amount)||0)),dys:Math.round(Number((le==null?void 0:le.assigned_amount)||0)),tntStage:String((fe==null?void 0:fe.target_stage)||"").trim()||void 0,dysStage:String((le==null?void 0:le.target_stage)||"").trim()||void 0})}catch(z){oe((z==null?void 0:z.message)||"조회 오류"),Pe({tnt:0,dys:0})}finally{de(!1)}}const[jt,Dt]=p.useState(0);p.useEffect(()=>{const z=()=>Dt(Q=>Q+1);return window.addEventListener("tnt.sales.assign.mode.changed",z),()=>window.removeEventListener("tnt.sales.assign.mode.changed",z)},[]),p.useEffect(()=>{pt()},[ie,jt]),p.useEffect(()=>{(async()=>{try{const z=Number(ie),Q=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!Q||!Number.isFinite(z)||z<=0){ht({tnt:0,dys:0});return}const ce=new URL("/api/v1/sales/plan/totals-by-assignee",window.location.origin);ce.searchParams.set("year",String(z)),ce.searchParams.set("assigneeId",Q);const ge=await fetch(ce.toString());if(!ge.ok)throw new Error(`HTTP ${ge.status}`);const fe=await ge.json().catch(()=>[]);let le=0,be=0;Array.isArray(fe)&&fe.forEach(ve=>{const ye=String((ve==null?void 0:ve.company_type)||(ve==null?void 0:ve.companyType)||"").toUpperCase(),_e=Number((ve==null?void 0:ve.amount)||0);ye==="TNT"?le+=_e:ye==="DYS"&&(be+=_e)}),ht({tnt:Math.round(le),dys:Math.round(be)})}catch{ht({tnt:0,dys:0})}})()},[ie]),p.useEffect(()=>{async function z(){try{Z(!1);const Q=Number(ie);if(!Number.isFinite(Q)||Q<=0){W(it=>({...it,show:!1})),Z(!0);return}const ce=localStorage.getItem("tnt.sales.assigneeId")||"",ge=localStorage.getItem("tnt.sales.empId")||"",fe=new URL("/api/v1/sales/plan/status",window.location.origin);fe.searchParams.set("year",String(Q)),ce?fe.searchParams.set("assigneeId",ce):ge&&fe.searchParams.set("empId",ge);const le=await fetch(fe.toString());if(!le.ok){W(it=>({...it,show:!1})),Z(!0);return}const be=await le.json().catch(()=>({})),ve=(localStorage.getItem("tnt.sales.empName")||"").trim()||"사용자",ye=Number((be==null?void 0:be.tnt)||0),_e=Number((be==null?void 0:be.dys)||0),Ae=!!(be!=null&&be.hasP),Ce=!!(be!=null&&be.hasC),qe=!!(be!=null&&be.hasI);let Re="";Ce&&!Ae&&!qe?Re="목표수립완료":qe&&!Ae&&!Ce?Re="초기설정완료":(Ae||Ce&&qe)&&(Re="계획수립 중"),W({show:!!Re,name:ve,tnt:ye,dys:_e,year:Q,label:Re,hasP:Ae,hasC:Ce,hasI:qe}),O(Ce&&!Ae&&!qe?"confirm":Ae?"sim":"init"),Z(!0)}catch{W(ce=>({...ce,show:!1})),Z(!0)}}z()},[ie]);const[cn,Un]=p.useState(0),[Ct,Mt]=p.useState({loading:!1,error:null,rows:[]});p.useEffect(()=>{const z=Number((w==null?void 0:w.customerSeq)||0),Q=Number(ie);if(!z||!Number.isFinite(Q)||Q<=0){Mt({loading:!1,error:null,rows:[]});return}let ce=!1;return(async()=>{try{Mt(ye=>({...ye,loading:!0,error:null}));const ge=localStorage.getItem("tnt.sales.assigneeId")||"",fe=new URL("/api/v1/sales/plan/customer-monthly-rows",window.location.origin);fe.searchParams.set("year",String(Q)),fe.searchParams.set("customerSeq",String(z)),k&&fe.searchParams.set("companyType",k),ge&&fe.searchParams.set("assigneeId",ge);const le=await fetch(fe.toString());if(!le.ok){let ye=`HTTP ${le.status}`;try{const _e=await le.json();_e!=null&&_e.error&&(ye=_e.error)}catch{}throw new Error(ye)}const be=await le.json().catch(()=>[]),ve=(Array.isArray(be)?be:[]).map(ye=>({sub:String((ye==null?void 0:ye.item_subcategory)??(ye==null?void 0:ye.itemSubcategory)??""),unit:String((ye==null?void 0:ye.sales_mgmt_unit)??(ye==null?void 0:ye.salesMgmtUnit)??""),months:Array.from({length:12},(_e,Ae)=>Number((ye==null?void 0:ye[`qty_${String(Ae+1).padStart(2,"0")}`])??0)),amounts:Array.from({length:12},(_e,Ae)=>Number((ye==null?void 0:ye[`amount_${String(Ae+1).padStart(2,"0")}`])??0)),type:String((ye==null?void 0:ye.plan_type)||(ye==null?void 0:ye.planType)||"").toUpperCase()==="P"?"P":"B",stage:String((ye==null?void 0:ye.target_stage)||(ye==null?void 0:ye.targetStage)||"").toUpperCase()||void 0}));ce||Mt({loading:!1,error:null,rows:ve})}catch(ge){ce||Mt({loading:!1,error:(ge==null?void 0:ge.message)||"오류",rows:[]})}})(),()=>{ce=!0}},[w==null?void 0:w.customerSeq,ie,k,cn]),p.useEffect(()=>{try{if(!Number((w==null?void 0:w.customerSeq)||0))return;const Q=Array.isArray(Ct.rows)?Ct.rows:[];if(!Q.length){O("init");return}const ce=Q.some(le=>String((le==null?void 0:le.type)||"").toUpperCase()==="P"),ge=Q.map(le=>String((le==null?void 0:le.stage)||"").toUpperCase()).filter(Boolean),fe=ge.length>0&&ge.every(le=>le==="C");O(fe?"confirm":ce?"sim":"init")}catch{}},[w==null?void 0:w.customerSeq,Ct.rows]);const[me,ze]=p.useState({open:!1,dist:new Array(12).fill(0),curMonths:new Array(12).fill(0),curAmounts:new Array(12).fill(0),success:null}),[Oe,Ze]=p.useState({}),[Ne,Xe]=p.useState({}),[$e,ct]=p.useState({});function ut(z){return String(z||"").trim().toUpperCase()}function yt(z){try{const Q=ft(),ge=(Oe[Q]||{})[ut(z)];if(Number.isFinite(ge)&&Number(ge)>0)return Number(ge);const fe=Et(),be=((Ne==null?void 0:Ne[fe])||{})[ut(z)];return Number.isFinite(be)&&Number(be)>0?Number(be):void 0}catch{return}}function ft(){const z=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),Q=Number(ie),ce=new Date().getFullYear()-1,ge=Number.isFinite(Q)&&Q>0?Q-1:ce;return`${z}|${k||""}|${ge}`}async function nn(){try{const z=ft();if(!z||Oe[z])return;const[Q,ce,ge]=z.split("|"),fe=Number(ge);if(!Q||!ce||!Number.isFinite(fe)||fe<=0)return;const le=new URL("/api/v1/dashboard/avg-unit-price-by-emp",window.location.origin);le.searchParams.set("assigneeId",Q),le.searchParams.set("companyType",ce),le.searchParams.set("year",String(fe));const be=await fetch(le.toString());if(!be.ok)return;const ve=await be.json().catch(()=>[]),ye={},_e={};Array.isArray(ve)&&ve.forEach(Ae=>{const Ce=ut((Ae==null?void 0:Ae.sales_mgmt_unit)||(Ae==null?void 0:Ae.salesMgmtUnit)),qe=Number((Ae==null?void 0:Ae.avg_unit_price)||(Ae==null?void 0:Ae.avgUnitPrice)||0);Ce&&(ye[Ce]=qe),Ce&&(_e[Ce]={itemUnit:String((Ae==null?void 0:Ae.item_unit)||(Ae==null?void 0:Ae.itemUnit)||""),itemStdUnit:String((Ae==null?void 0:Ae.item_std_unit)||(Ae==null?void 0:Ae.itemStdUnit)||"")})}),Ze(Ae=>({...Ae,[z]:ye})),ct(Ae=>({...Ae,[z]:_e}))}catch{}}function Et(){const z=Number(ie),Q=new Date().getFullYear()-1,ce=Number.isFinite(z)&&z>0?z-1:Q;return`${k||""}|${ce}`}async function At(){try{const z=Et();if(!z||Ne[z])return;const[Q,ce]=z.split("|"),ge=Number(ce);if(!Q||!Number.isFinite(ge)||ge<=0)return;const fe=new URL("/api/v1/dashboard/avg-unit-price",window.location.origin);fe.searchParams.set("companyType",Q),fe.searchParams.set("year",String(ge));const le=await fetch(fe.toString());if(!le.ok)return;const be=await le.json().catch(()=>[]),ve={};Array.isArray(be)&&be.forEach(ye=>{const _e=ut((ye==null?void 0:ye.sales_mgmt_unit)||(ye==null?void 0:ye.salesMgmtUnit)),Ae=Number((ye==null?void 0:ye.avg_unit_price)||(ye==null?void 0:ye.avgUnitPrice)||0);_e&&(ve[_e]=Ae)}),Xe(ye=>({...ye,[z]:ve}))}catch{}}async function ci(z){try{await At()}catch{}}async function Nn(z){try{const Q=ft();if(!Q)return;const[ce,ge,fe]=Q.split("|"),le=Number(fe);if(!ce||!ge||!Number.isFinite(le)||le<=0)return;const be=new URL("/api/v1/dashboard/avg-unit-price-by-emp",window.location.origin);be.searchParams.set("assigneeId",ce),be.searchParams.set("companyType",ge),be.searchParams.set("year",String(le));const ve=await fetch(be.toString());if(!ve.ok)return;const ye=await ve.json().catch(()=>[]);let _e=null;if(Array.isArray(ye)){const Ae=ut(z);_e=ye.find(Ce=>ut((Ce==null?void 0:Ce.sales_mgmt_unit)||(Ce==null?void 0:Ce.salesMgmtUnit))===Ae)}if(_e){const Ae=ut((_e==null?void 0:_e.sales_mgmt_unit)||(_e==null?void 0:_e.salesMgmtUnit)),Ce=Number((_e==null?void 0:_e.avg_unit_price)||(_e==null?void 0:_e.avgUnitPrice)||0),qe={itemUnit:String((_e==null?void 0:_e.item_unit)||(_e==null?void 0:_e.itemUnit)||""),itemStdUnit:String((_e==null?void 0:_e.item_std_unit)||(_e==null?void 0:_e.itemStdUnit)||"")};Ze(Re=>({...Re,[Q]:{...Re[Q]||{},[Ae]:Ce}})),ct(Re=>({...Re,[Q]:{...Re[Q]||{},[Ae]:qe}}))}}catch{}}function Ki(z,Q){const ce=(Ct.rows||[]).find(le=>le.sub===z&&le.unit===Q),ge=ce!=null&&ce.months?ce.months.slice():new Array(12).fill(0),fe=ce!=null&&ce.amounts?ce.amounts.slice():new Array(12).fill(0);ze({open:!0,sub:z,unit:Q,stage:ce==null?void 0:ce.stage,month:"",qty:"",dist:new Array(12).fill(0),curMonths:ge,curAmounts:fe,success:null});try{nn()}catch{}try{At()}catch{}}function Gi(){ze({open:!1,dist:new Array(12).fill(0),curMonths:new Array(12).fill(0),curAmounts:new Array(12).fill(0),success:null})}function pl(z,Q){const ce=Number(z),ge=Number(Q),fe=new Array(12).fill(0);if(Number.isFinite(ce)&&ce>=1&&ce<=12&&Number.isFinite(ge)&&ge>0){const le=12-ce+1,be=ge/le;for(let ve=ce-1;ve<12;ve++)fe[ve]=be}ze(le=>({...le,month:z,qty:Q,dist:fe}))}async function ml(){try{const z=Number(ie),Q=k,ce=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),ge=Number((w==null?void 0:w.customerSeq)||0),fe=(me.sub||"").trim(),le=(me.unit||"").trim();if(!Number.isFinite(z)||z<=0){alert("연도를 선택하세요.");return}if(!ce){alert("로그인이 필요합니다.");return}if(!ge||!fe||!le){alert("거래처/중분류/영업관리단위가 필요합니다.");return}const be=(me.dist||[]).map(Ce=>{const qe=Number(Ce);return!Number.isFinite(qe)||qe<=0?0:Math.round(qe*100)/100});if(!be.some(Ce=>Ce>0)&&!(me.month&&Number(me.month)>0)){alert("매출월을 선택하세요.");return}const ve={year:z,companyType:Q,assigneeId:ce,customerSeq:ge,itemSubcategory:fe,salesMgmtUnit:le,qty:be},ye={"Content-Type":"application/json","X-ASSIGNEE-ID":ce},_e=(localStorage.getItem("tnt.sales.empId")||"").trim();_e&&(ye["X-EMP-ID"]=_e);const Ae=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:ye,body:JSON.stringify(ve)});if(!Ae.ok){let Ce=await Ae.text().catch(()=>"");throw new Error(Ce||"HTTP "+Ae.status)}ze(Ce=>({...Ce,success:"목표가 변경되었습니다"}))}catch(z){alert((z==null?void 0:z.message)||"저장 중 오류가 발생했습니다")}}async function se(){try{const z=Number(ie),Q=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),ce=Number((w==null?void 0:w.customerSeq)||0);if(Number.isFinite(z)&&z>0&&Q&&ce){const ge=new URL("/api/v1/sales/plan/customer-monthly-rows",window.location.origin);ge.searchParams.set("year",String(z)),ge.searchParams.set("customerSeq",String(ce)),k&&ge.searchParams.set("companyType",k),ge.searchParams.set("assigneeId",Q);const fe=await fetch(ge.toString());if(fe.ok){const le=await fe.json().catch(()=>[]),be=(Array.isArray(le)?le:[]).map(ve=>({sub:String((ve==null?void 0:ve.item_subcategory)??(ve==null?void 0:ve.itemSubcategory)??""),unit:String((ve==null?void 0:ve.sales_mgmt_unit)??(ve==null?void 0:ve.salesMgmtUnit)??""),months:Array.from({length:12},(ye,_e)=>Number((ve==null?void 0:ve[`qty_${String(_e+1).padStart(2,"0")}`])??0)),amounts:Array.from({length:12},(ye,_e)=>Number((ve==null?void 0:ve[`amount_${String(_e+1).padStart(2,"0")}`])??0)),type:String((ve==null?void 0:ve.plan_type)||(ve==null?void 0:ve.planType)||"").toUpperCase()==="P"?"P":"B",stage:String((ve==null?void 0:ve.target_stage)||(ve==null?void 0:ve.targetStage)||"").toUpperCase()||void 0}));Mt({loading:!1,error:null,rows:be})}}}catch{}Gi();try{rt()}catch{}try{Vi()}catch{}try{yl()}catch{}}const[we,Me]=p.useState({open:!1,rows:[],success:null});function He(){const z=(Ct.rows||[]).map((Q,ce)=>({key:`${Q.sub}||${Q.unit}||${ce}`,sub:Q.sub,unit:Q.unit,stage:Q.stage,type:Q.type,month:"",qty:"",dist:new Array(12).fill(0),curMonths:Q.months?Q.months.slice():new Array(12).fill(0),curAmounts:Q.amounts?Q.amounts.slice():new Array(12).fill(0)}));Me({open:!0,rows:z,success:null});try{nn()}catch{}try{At()}catch{}}function rt(){Me({open:!1,rows:[],success:null})}function Fe(z,Q,ce){Me(ge=>{const fe=ge.rows.slice(),le={...fe[z]},be=Number(Q??le.month),ve=Number(ce??le.qty),ye=new Array(12).fill(0);if(Number.isFinite(be)&&be>=1&&be<=12&&Number.isFinite(ve)&&ve>0){const _e=12-be+1,Ae=ve/_e;for(let Ce=be-1;Ce<12;Ce++)ye[Ce]=Ae}return le.month=Q??le.month,le.qty=ce??le.qty,le.dist=ye,fe[z]=le,{...ge,rows:fe}})}async function Ye(){try{const z=Number(ie),Q=k,ce=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),ge=Number((w==null?void 0:w.customerSeq)||0);if(!Number.isFinite(z)||z<=0){alert("연도를 선택하세요.");return}if(!ce){alert("로그인이 필요합니다.");return}if(!ge){alert("거래처를 선택하세요.");return}const fe={"Content-Type":"application/json","X-ASSIGNEE-ID":ce},le=(localStorage.getItem("tnt.sales.empId")||"").trim();le&&(fe["X-EMP-ID"]=le);const be=(we.rows||[]).filter(ve=>!!ve.month&&Number(ve.month)>0);if(be.length===0){alert("매출월을 선택한 행이 없습니다.");return}for(const ve of be){const ye=Number(ve.month),_e=Number(ve.qty||0),Ae=new Array(12).fill(0);if(Number.isFinite(ye)&&ye>=1&&ye<=12){const it=12-ye+1,et=Number.isFinite(_e)&&_e>0?_e/it:0;for(let mt=ye-1;mt<12;mt++)Ae[mt]=et}const Ce=Ae.map(it=>{const et=Number(it);return!Number.isFinite(et)||et<=0?0:Math.round(et*100)/100}),qe={year:z,companyType:Q,assigneeId:ce,customerSeq:ge,itemSubcategory:ve.sub,salesMgmtUnit:ve.unit,qty:Ce},Re=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:fe,body:JSON.stringify(qe)});if(!Re.ok){let it=await Re.text().catch(()=>"");throw new Error(it||"HTTP "+Re.status)}}Me(ve=>({...ve,success:"목표가 변경되었습니다"}))}catch(z){alert((z==null?void 0:z.message)||"저장 중 오류가 발생했습니다")}}function at(z){try{const Q=z.getBoundingClientRect(),ce=(Q==null?void 0:Q.width)||z.offsetWidth||600,ge=(Q==null?void 0:Q.height)||z.offsetHeight||400,fe=Math.max(0,Math.round((window.innerWidth-ce)/2)),be=Math.max(0,Math.round(window.innerHeight-ge-40));return{x:fe,y:be}}catch{const Q=Math.max(0,Math.round((window.innerWidth-600)/2)),ge=Math.max(0,Math.round(window.innerHeight-400-40));return{x:Q,y:ge}}}function Rt(z){try{const Q=z.getBoundingClientRect(),ce=(Q==null?void 0:Q.width)||z.offsetWidth||600,ge=(Q==null?void 0:Q.height)||z.offsetHeight||400,fe=Math.max(0,Math.round((window.innerWidth-ce)/2)),le=Math.max(0,Math.round((window.innerHeight-ge)/2));return{x:fe,y:le}}catch{const ge=Math.max(0,Math.round((window.innerWidth-600)/2)),fe=Math.max(0,Math.round((window.innerHeight-400)/2));return{x:ge,y:fe}}}function xn(z){try{const Q=z.getBoundingClientRect(),ce=(Q==null?void 0:Q.width)||z.offsetWidth||460,ge=Math.max(0,Math.round(window.innerWidth-ce)),fe=Math.max(0,Math.round(window.innerHeight*.17));return{x:ge,y:fe}}catch{const ce=Math.max(0,Math.round(window.innerWidth-460)),ge=Math.max(0,Math.round(window.innerHeight*.17));return{x:ce,y:ge}}}const Mn=tr("sales-plan-target-input",!!me.open,at,{persist:!1,resetOnOpen:!0}),xt=tr("sales-plan-bulk-input",!!we.open,Rt,{persist:!1,resetOnOpen:!0}),[Kt,hs]=p.useState({open:!1,rows:[],success:null}),[Ma,gl]=p.useState("");function Hn(){const z=(Ct.rows||[]).map((Q,ce)=>({key:`${Q.sub}||${Q.unit}||${ce}`,sub:Q.sub,unit:Q.unit,stage:Q.stage,type:Q.type,month:"",qty:"",dist:new Array(12).fill(0),curMonths:Q.months?Q.months.slice():new Array(12).fill(0),curAmounts:Q.amounts?Q.amounts.slice():new Array(12).fill(0)}));hs({open:!0,rows:z,success:null});try{nn()}catch{}try{At()}catch{}}function Vi(){hs({open:!1,rows:[],success:null})}function Vr(){const z=Number(Ma);if(!Number.isFinite(z)){alert("적용 비율(%)을 입력하세요.");return}let Q=1+z/100;(!Number.isFinite(Q)||Q<0)&&(Q=0),hs(ce=>{const ge=(ce.rows||[]).map(fe=>{const le=fe.curMonths||[],be=Array.from({length:12},(ve,ye)=>{const _e=Number(le[ye]||0);return Number.isFinite(_e)?_e*Q:0});return{...fe,dist:be}});return{...ce,rows:ge}})}const Ra=tr("sales-plan-bulk-ratio",!!Kt.open,Rt,{persist:!1,resetOnOpen:!0});async function wu(){try{const z=Number(ie),Q=k,ce=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),ge=Number((w==null?void 0:w.customerSeq)||0);if(!Number.isFinite(z)||z<=0){alert("연도를 선택하세요.");return}if(!ce){alert("로그인이 필요합니다.");return}if(!ge){alert("거래처를 선택하세요.");return}const fe={"Content-Type":"application/json","X-ASSIGNEE-ID":ce},le=(localStorage.getItem("tnt.sales.empId")||"").trim();le&&(fe["X-EMP-ID"]=le);const be=(Kt.rows||[]).filter(ve=>(ve.dist||[]).some(ye=>Number(ye)>0));if(be.length===0){alert("적용 비율을 먼저 적용하세요.");return}for(const ve of be){const ye=(ve.dist||[]).map(Ce=>{const qe=Number(Ce);return!Number.isFinite(qe)||qe<=0?0:Math.round(qe*100)/100}),_e={year:z,companyType:Q,assigneeId:ce,customerSeq:ge,itemSubcategory:ve.sub,salesMgmtUnit:ve.unit,qty:ye},Ae=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:fe,body:JSON.stringify(_e)});if(!Ae.ok){let Ce=await Ae.text().catch(()=>"");throw new Error(Ce||"HTTP "+Ae.status)}}hs(ve=>({...ve,success:"목표가 변경되었습니다"}))}catch(z){alert((z==null?void 0:z.message)||"저장 중 오류가 발생했습니다")}}const[bt,or]=p.useState({open:!1,loading:!1,error:null,success:null,opts:[],dist:new Array(12).fill(0),rows:[]}),$a=tr("sales-plan-new-item",!!bt.open,Rt,{persist:!1,resetOnOpen:!0});function Mk(z){try{const Q=z.getBoundingClientRect(),ce=(Q==null?void 0:Q.width)||z.offsetWidth||480,ge=(Q==null?void 0:Q.height)||z.offsetHeight||300,fe=12;let le=Math.round(Le.x-Math.min(ce/2,240)),be=Math.round(Le.y+fe);return le=Math.max(8,Math.min(le,window.innerWidth-ce-8)),be=Math.max(8,Math.min(be,window.innerHeight-ge-8)),{x:le,y:be}}catch{const Q=Math.max(8,Math.min(Le.x,window.innerWidth-500)),ce=Math.max(8,Math.min(Le.y,window.innerHeight-320));return{x:Q,y:ce}}}const Su=tr("plan-totals-breakdown",je.open,Mk,{persist:!1,resetOnOpen:!0});async function yg(){or(z=>({...z,open:!0,loading:!0,error:null,unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0),rows:[]}));try{const z=await fetch("/api/v1/items/dim"),Q=z.ok?await z.json():[],ce=Array.isArray(Q)?Q.map(le=>({itemSubcategory:String(le.itemSubcategory||le.item_subcategory||""),salesMgmtUnit:String(le.salesMgmtUnit||le.sales_mgmt_unit||"")})):[],ge={};ce.forEach(le=>{const be=le.salesMgmtUnit.trim();be&&!ge[be]&&(ge[be]=le)});const fe=Object.values(ge).sort((le,be)=>le.salesMgmtUnit.localeCompare(be.salesMgmtUnit));or(le=>({...le,loading:!1,opts:fe}));try{nn()}catch{}}catch(z){or(Q=>({...Q,loading:!1,error:(z==null?void 0:z.message)||"조회 오류",opts:[]}))}}p.useEffect(()=>{if(bt.open){try{nn()}catch{}try{At()}catch{}}},[bt.open,ie,k]);function yl(){or({open:!1,loading:!1,error:null,success:null,opts:[],dist:new Array(12).fill(0),rows:[]})}function Rk(z){const Q=bt.opts.find(ce=>ce.salesMgmtUnit===z);or(ce=>({...ce,unit:z,sub:(Q==null?void 0:Q.itemSubcategory)||ce.sub}));try{nn()}catch{}try{Nn(z)}catch{}try{ci(z)}catch{}}function xg(z,Q){const ce=Number(z??bt.month),ge=Number(Q??bt.qty),fe=new Array(12).fill(0);if(Number.isFinite(ce)&&ce>=1&&ce<=12&&Number.isFinite(ge)&&ge>0){const le=12-ce+1,be=ge/le;for(let ve=ce-1;ve<12;ve++)fe[ve]=be}or(le=>({...le,month:z??le.month,qty:Q??le.qty,dist:fe}))}function $k(){const z=(bt.unit||"").trim(),Q=(bt.sub||"").trim(),ce=bt.month,ge=bt.qty;if(!z||!ce||!ge){alert("영업관리단위, 매출월, 매출 수량을 입력하세요.");return}const fe={sub:Q||"(신규)",unit:z,months:bt.dist.slice()};or(le=>{const be=le.rows.slice(),ve=be.findIndex(ye=>(ye.unit||"").trim()===z&&(ye.sub||"").trim()===(fe.sub||"").trim());return ve>=0?be[ve]={...be[ve],sub:fe.sub,unit:fe.unit,months:fe.months.slice()}:be.push(fe),{...le,rows:be,unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0)}})}async function Lk(){try{const z=Number(ie),Q=k,ce=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),ge=Number((w==null?void 0:w.customerSeq)||0);if(!Number.isFinite(z)||z<=0){alert("연도를 선택하세요.");return}if(!ce){alert("로그인이 필요합니다.");return}if(!ge){alert("거래처를 선택하세요.");return}const fe=bt.rows||[];if(!fe.length){alert("추가된 영업관리단위가 없습니다.");return}const le=new Set((Ct.rows||[]).map(_e=>`${String(_e.sub||"").trim()}||${String(_e.unit||"").trim()}`).filter(_e=>!!_e&&_e!=="||")),be=fe.map(_e=>({sub:String(_e.sub||"").trim(),unit:String(_e.unit||"").trim()})).filter(_e=>_e.sub&&_e.unit&&le.has(`${_e.sub}||${_e.unit}`)).map(_e=>_e.unit);if(be.length>0){or(_e=>({..._e,error:`${be.join(", ")} 이미 목표에 등록되어 있습니다. 목표 수정을 통해 작업 하세요.`}));return}const ve={"Content-Type":"application/json","X-ASSIGNEE-ID":ce},ye=(localStorage.getItem("tnt.sales.empId")||"").trim();ye&&(ve["X-EMP-ID"]=ye);for(const _e of fe){const Ae=(_e.months||[]).map(rn=>{const It=Number(rn);return!Number.isFinite(It)||It<=0?0:Math.round(It*100)/100}),Ce=String(_e.unit||"").trim(),qe=yt(Ce),Re=Number.isFinite(qe)?Math.round(Number(qe)):0,it=Ae.map(rn=>Number.isFinite(rn)&&Re>0?Math.round(Number(rn)*Re):0),et={year:z,companyType:Q,assigneeId:ce,customerSeq:ge,itemSubcategory:_e.sub,salesMgmtUnit:_e.unit,qty:Ae,amount:it},mt=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:ve,body:JSON.stringify(et)});if(!mt.ok){let rn=await mt.text().catch(()=>"");throw new Error(rn||"HTTP "+mt.status)}}or(_e=>({..._e,success:"목표가 변경되었습니다"}))}catch(z){alert((z==null?void 0:z.message)||"저장 중 오류가 발생했습니다")}}p.useEffect(()=>{if(!me.open&&!we.open&&!bt.open)return;const z=Q=>{Q.key==="Escape"&&(me.open&&Gi(),we.open&&rt(),bt.open&&yl())};return window.addEventListener("keydown",z,!0),()=>window.removeEventListener("keydown",z,!0)},[me.open,we.open,bt.open]);async function ps(z=!0){u(null),z?(c(!0),X(0),q(!0)):L(!0);try{const Q=Number(ie);if(!Number.isFinite(Q)||Q<=0){z&&(h([]),q(!0),X(0),S({}),P({}));return}const ce=localStorage.getItem("tnt.sales.assigneeId");if(!ce){h([]),u(zt.loginRequired);return}const ge=new URL("/api/v1/customers",window.location.origin);ge.searchParams.set("mineOnly","true"),ge.searchParams.set("assigneeId",ce),ge.searchParams.set("companyType",k),ie&&ge.searchParams.set("year",String(ie)),m.trim()&&ge.searchParams.set("name",m.trim()),ge.searchParams.set("limit",String(R)),ge.searchParams.set("offset",String(z?0:Y));const fe=await fetch(ge.toString());if(!fe.ok){let ve=`HTTP ${fe.status}`;try{const ye=await fe.json();ye!=null&&ye.error&&(ve=ye.error)}catch{const ye=await fe.text();ye&&(ve=ye)}throw new Error(ve)}const le=await fe.json(),be=Array.isArray(le)?le:[];h(z?be:ve=>[...ve,...be]),q(be.length>=R),X(ve=>z?R:ve+R);try{if(ce){const ve=new URL("/api/v1/customers/count",window.location.origin);ve.searchParams.set("mineOnly","true"),ve.searchParams.set("assigneeId",ce);const ye=await fetch(ve.toString());if(ye.ok){const _e=await ye.json().catch(()=>({})),Ae=Number((_e==null?void 0:_e.total)??0);te(Number.isFinite(Ae)?Ae:0)}else te(0)}else te(0)}catch{te(0)}try{const ve=be.map(ye=>Number(ye.customerSeq||0)).filter(ye=>Number.isFinite(ye)&&ye>0);if(ve.length>0){const ye=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);ye.searchParams.set("custSeq",Array.from(new Set(ve)).join(",")),ye.searchParams.set("years","2");const _e=await fetch(ye.toString());if(_e.ok){const Ae=await _e.json(),Ce={};Array.isArray(Ae)&&Ae.forEach(qe=>{const Re=Number((qe==null?void 0:qe.customerSeq)||(qe==null?void 0:qe.customerSeqText)||0);Number.isFinite(Re)&&(Ce[Re]=!!(qe!=null&&qe.hasRecent))}),S(qe=>z?Ce:{...qe,...Ce})}else z&&S({})}else z&&S({})}catch{S({})}try{const ve=Number(ie),ye=Number.isFinite(ve)&&ve>0?ve:new Date().getFullYear(),_e=localStorage.getItem("tnt.sales.assigneeId")||"",Ae=be.map(Ce=>Number(Ce.customerSeq||0)).filter(Ce=>Number.isFinite(Ce)&&Ce>0);if(_e&&Ae.length>0){const Ce=new URL("/api/v1/sales/plan/stages",window.location.origin);Ce.searchParams.set("year",String(ye)),k&&Ce.searchParams.set("companyType",k),Ce.searchParams.set("assigneeId",_e),Ce.searchParams.set("customerSeqs",Array.from(new Set(Ae)).join(","));const qe=await fetch(Ce.toString());if(qe.ok){const Re=await qe.json(),it={};Array.isArray(Re)&&Re.forEach(et=>{const mt=Number((et==null?void 0:et.customer_seq)??(et==null?void 0:et.customerSeq)??0),rn=String((et==null?void 0:et.target_stage)??(et==null?void 0:et.targetStage)??"").trim();Number.isFinite(mt)&&rn&&(it[mt]=rn)}),P(et=>z?it:{...et,...it})}else z&&P({})}else z&&P({})}catch{z&&P({})}}catch(Q){u(Q.message||"조회 중 오류가 발생했습니다")}finally{z?c(!1):L(!1)}}p.useEffect(()=>{ie&&ps(!0)},[ie,k]),p.useEffect(()=>{ie||(h([]),q(!0),X(0),S({}),P({}))},[ie]),p.useEffect(()=>{async function z(){try{const Q=localStorage.getItem("tnt.sales.assigneeId");if(!Q){K({tnt:0,dys:0});return}const ce=Number(ie);if(!Number.isFinite(ce)||ce<=0){K({tnt:0,dys:0});return}const ge=new URL("/api/v1/customers/with-invoice-count",window.location.origin);ge.searchParams.set("assigneeId",Q),ge.searchParams.set("year",String(ce));const fe=await fetch(ge.toString());if(!fe.ok){K({tnt:0,dys:0});return}const le=await fe.json().catch(()=>({})),be=Number((le==null?void 0:le.tnt)??0),ve=Number((le==null?void 0:le.dys)??0);K({tnt:Number.isFinite(be)?be:0,dys:Number.isFinite(ve)?ve:0})}catch{K({tnt:0,dys:0})}}z()},[ie]);const Wk=p.useMemo(()=>{const z=Number(ie);return Number.isFinite(z)&&z>0?`${z-1}년`:"전년도"},[ie]),Bk=p.useMemo(()=>(localStorage.getItem("tnt.sales.empName")||"").trim()||"사용자",[]),on="#1e3a8a";p.useEffect(()=>{if(!y.open)return;const z=()=>x({open:!1,x:0,y:0});return window.addEventListener("click",z),()=>window.removeEventListener("click",z)},[y.open]),p.useEffect(()=>{if(!y.open)return;const z=Q=>{Q.key==="Escape"&&x({open:!1,x:0,y:0})};return window.addEventListener("keydown",z),()=>window.removeEventListener("keydown",z)},[y.open]),p.useEffect(()=>{const z=Q=>{((Q==null?void 0:Q.key)==="Escape"||(Q==null?void 0:Q.key)==="Esc"||(Q==null?void 0:Q.keyCode)===27)&&(x({open:!1,x:0,y:0}),C({open:!1,x:0,y:0}))};return document.addEventListener("keydown",z,!0),()=>document.removeEventListener("keydown",z,!0)},[]);async function Fk(z,Q){z.preventDefault(),z.stopPropagation(),x({open:!1,x:0,y:0});const ce=z.clientX,ge=z.clientY;C({open:!0,x:ce,y:ge,row:Q,loading:!1,error:null,data:[]})}const vg=p.useMemo(()=>{var Q,ce,ge,fe,le,be,ve,ye,_e,Ae,Ce,qe,Re,it,et;const z=[...f].sort((mt,rn)=>{const It=Number(mt.customerSeq||0),br=Number(rn.customerSeq||0),jr=!!T[It],Mr=!!T[br];if(jr!==Mr)return jr?-1:1;const di=(mt.customerName||"").toString(),Cu=(rn.customerName||"").toString();return di.localeCompare(Cu,"ko",{sensitivity:"base"})});return r.jsx(r.Fragment,{children:r.jsxs("div",{ref:B,className:"table-container",onClick:()=>x({open:!1,x:0,y:0}),style:{height:"100%",overflow:"auto"},children:[z.length===0?r.jsx("div",{className:"empty-state",children:zt.empty}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsx("tr",{children:r.jsx("th",{style:{width:"auto"},children:"거래처명"})})}),r.jsx("tbody",{children:z.map((mt,rn)=>r.jsx("tr",{onClick:It=>{It.preventDefault(),It.stopPropagation(),_(mt),C({open:!1,x:0,y:0})},onContextMenu:It=>Fk(It,mt),"aria-selected":(w==null?void 0:w.customerId)===mt.customerId?!0:void 0,style:(w==null?void 0:w.customerId)===mt.customerId?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:r.jsx("td",{children:(()=>{const It=Number(mt.customerSeq||0),br=T[It],jr={};return br==="P"&&(jr.color="#dc2626"),br==="C"&&(jr.fontWeight=700),r.jsxs("span",{children:[r.jsx("span",{style:jr,children:mt.customerName}),br?r.jsx("span",{className:"badge stage-badge",style:{marginLeft:6},children:br}):null]})})()})},rn))})]}),M&&r.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:zt.loading}),!l&&!M&&!H&&f.length>0&&r.jsx("div",{className:"muted",style:{padding:"8px 10px",textAlign:"center"},children:"마지막 데이터입니다."}),N.open&&r.jsxs("div",{className:"context-menu",style:{left:N.x+6,top:N.y+6,maxWidth:420,padding:8},onClick:mt=>mt.stopPropagation(),children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 상세"}),N.error?r.jsx("div",{className:"error",style:{maxWidth:380},children:N.error}):r.jsx("table",{className:"table",style:{width:"100%"},children:r.jsxs("tbody",{children:[r.jsxs("tr",{children:[r.jsx("th",{style:{width:110,textAlign:"left"},children:"거래처번호"}),r.jsx("td",{children:((Q=N.row)==null?void 0:Q.customerId)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"사업자번호"}),r.jsx("td",{children:((ce=N.row)==null?void 0:ce.bizNo)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"대표자명"}),r.jsx("td",{children:((ge=N.row)==null?void 0:ge.ownerName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"업태"}),r.jsx("td",{children:((fe=N.row)==null?void 0:fe.bizKind)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"종목"}),r.jsx("td",{children:((le=N.row)==null?void 0:le.bizType)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"전화번호"}),r.jsx("td",{children:((be=N.row)==null?void 0:be.telNo)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"담당자명"}),r.jsx("td",{children:((ve=N.row)==null?void 0:ve.empName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"부서명"}),r.jsx("td",{children:((ye=N.row)==null?void 0:ye.deptName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"시/도"}),r.jsx("td",{children:((_e=N.row)==null?void 0:_e.addrProvinceName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"시/군/구"}),r.jsx("td",{children:((Ae=N.row)==null?void 0:Ae.addrCityName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"고객유형"}),r.jsx("td",{children:((Ce=N.row)==null?void 0:Ce.customerTypeName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"비고"}),r.jsx("td",{children:((qe=N.row)==null?void 0:qe.customerRemark)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"생성자"}),r.jsx("td",{children:((Re=N.row)==null?void 0:Re.createdBy)??""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"수정자"}),r.jsx("td",{children:((it=N.row)==null?void 0:it.updatedBy)??""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"생성일시"}),r.jsx("td",{children:h_((et=N.row)==null?void 0:et.createdAt)})]})]})})]})]})})},[f,y,v,N,w,T,l,M,H]);p.useEffect(()=>{const z=B.current;if(!z)return;function Q(){z.scrollTop+z.clientHeight>=z.scrollHeight-48&&H&&!M&&!l&&ps(!1)}return z.addEventListener("scroll",Q),()=>z.removeEventListener("scroll",Q)},[H,M,l,Y]);const[zr,Ys]=p.useState({open:!1,loading:!1,error:null,rows:[]}),[ku,qk]=p.useState(10),[Xi,bg]=p.useState(""),[La,Nu]=p.useState("TNT"),_u=tr("unit-amounts-by-emp",zr.open,xn,{persist:!1,resetOnOpen:!0}),[Ks,xl]=p.useState({total:0,confirmed:0,inprogress:0,loading:!1,error:null}),[Wa,vl]=p.useState({tnt:0,dys:0,loading:!1,error:null});p.useEffect(()=>{async function z(){const Q=Number(ie),ce=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),ge=(localStorage.getItem("tnt.sales.empId")||"").trim();if(!Number.isFinite(Q)||Q<=0||!ce&&!ge){xl({total:0,confirmed:0,inprogress:0,loading:!1,error:null});return}xl(fe=>({...fe,loading:!0,error:null}));try{const fe=new URL("/api/v1/sales/plan/customer-counts-overall",window.location.origin);fe.searchParams.set("year",String(Q)),ce?fe.searchParams.set("assigneeId",ce):ge&&fe.searchParams.set("empId",ge);const le=await fetch(fe.toString());if(!le.ok)throw new Error(`HTTP ${le.status}`);const be=await le.json(),ve=Number((be==null?void 0:be.total_customers)??0)||0,ye=Number((be==null?void 0:be.confirmed_customers)??0)||0,_e=Number((be==null?void 0:be.inprogress_customers)??0)||0;xl({total:ve,confirmed:ye,inprogress:_e,loading:!1,error:null})}catch(fe){xl({total:0,confirmed:0,inprogress:0,loading:!1,error:(fe==null?void 0:fe.message)||"요약 조회 오류"})}}z()},[ie,jt]);async function Uk(){try{const z=localStorage.getItem("tnt.sales.assigneeId");if(!z||!Xi){Ys(Ce=>({...Ce,loading:!1}));return}const Q=new URL("/api/v1/dashboard/avg-unit-price-by-emp",window.location.origin);Q.searchParams.set("assigneeId",z),Q.searchParams.set("companyType",La),Q.searchParams.set("year",String(Xi));const ce=await fetch(Q.toString());if(!ce.ok)throw new Error(`HTTP ${ce.status}`);const ge=await ce.json(),fe=new URL("/api/v1/dashboard/avg-unit-price",window.location.origin);fe.searchParams.set("companyType",La),fe.searchParams.set("year",String(Xi));const le=await fetch(fe.toString()),be=le.ok?await le.json():[],ve={},ye={};Array.isArray(ge)&&ge.forEach(Ce=>{const Re=String((Ce==null?void 0:Ce.sales_mgmt_unit)??(Ce==null?void 0:Ce.salesMgmtUnit)??"").trim().toUpperCase();Re&&(ve[Re]={amount:Number((Ce==null?void 0:Ce.avg_unit_price)??(Ce==null?void 0:Ce.avgUnitPrice)??0),itemUnit:String((Ce==null?void 0:Ce.item_unit)??(Ce==null?void 0:Ce.itemUnit)??""),itemStdUnit:String((Ce==null?void 0:Ce.item_std_unit)??(Ce==null?void 0:Ce.itemStdUnit)??"")})}),Array.isArray(be)&&be.forEach(Ce=>{const Re=String((Ce==null?void 0:Ce.sales_mgmt_unit)??(Ce==null?void 0:Ce.salesMgmtUnit)??"").trim().toUpperCase();Re&&(ye[Re]={amount:Number((Ce==null?void 0:Ce.avg_unit_price)??(Ce==null?void 0:Ce.avgUnitPrice)??0),itemUnit:String((Ce==null?void 0:Ce.item_unit)??(Ce==null?void 0:Ce.itemUnit)??""),itemStdUnit:String((Ce==null?void 0:Ce.item_std_unit)??(Ce==null?void 0:Ce.itemStdUnit)??"")})});const Ae=Array.from(new Set([...Object.keys(ve),...Object.keys(ye)])).sort().map(Ce=>{var qe,Re,it,et,mt,rn;return{unit:Ce,amountMy:Number(((qe=ve[Ce])==null?void 0:qe.amount)??0),amountGlobal:Number(((Re=ye[Ce])==null?void 0:Re.amount)??0),itemUnit:((it=ve[Ce])==null?void 0:it.itemUnit)||((et=ye[Ce])==null?void 0:et.itemUnit)||"",itemStdUnit:((mt=ve[Ce])==null?void 0:mt.itemStdUnit)||((rn=ye[Ce])==null?void 0:rn.itemStdUnit)||""}});Ys({open:!0,loading:!1,error:null,rows:Ae})}catch(z){Ys({open:!0,loading:!1,error:(z==null?void 0:z.message)||"조회 오류",rows:[]})}}function Hk(){Ys({open:!0,loading:!0,error:null,rows:[]});const z=Number(ie),Q=Number.isFinite(z)&&z>0?z-1:new Date().getFullYear()-1,ce=Math.max(2025,Math.min(2030,Q));bg(ce),Nu("TNT")}function Yk(z){const Q=z.target.value;J(Q)}function jg(){Ys(z=>({...z,open:!1}))}return p.useEffect(()=>{if(!zr.open)return;const z=Q=>{Q.key==="Escape"&&jg()};return window.addEventListener("keydown",z,!0),()=>window.removeEventListener("keydown",z,!0)},[zr.open]),p.useEffect(()=>{zr.open&&Xi&&(Ys(z=>({...z,loading:!0})),Uk())},[zr.open,Xi,La]),p.useEffect(()=>{(async()=>{try{vl(ye=>({...ye,loading:!0,error:null}));const z=Number(ie),Q=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),ce=(localStorage.getItem("tnt.sales.empId")||"").trim();if(!Number.isFinite(z)||z<=0||!Q&&!ce){vl({tnt:0,dys:0,loading:!1,error:null});return}const ge=new URL("/api/v1/sales/plan/totals-confirmed-by-assignee",window.location.origin);ge.searchParams.set("year",String(z)),Q?ge.searchParams.set("assigneeId",Q):ce&&ge.searchParams.set("empId",ce);const fe=await fetch(ge.toString());if(!fe.ok)throw new Error(`HTTP ${fe.status}`);const le=await fe.json().catch(()=>[]);let be=0,ve=0;if(Array.isArray(le))for(const ye of le){const _e=String((ye==null?void 0:ye.company_type)||(ye==null?void 0:ye.companyType)||"").toUpperCase(),Ae=Number((ye==null?void 0:ye.amount)||0);_e==="TNT"?be+=Ae:_e==="DYS"&&(ve+=Ae)}vl({tnt:Math.round(be),dys:Math.round(ve),loading:!1,error:null})}catch(z){vl({tnt:0,dys:0,loading:!1,error:(z==null?void 0:z.message)||"확정 합계 조회 오류"})}})()},[ie]),p.useEffect(()=>{if(!me.open)return;const z=Q=>{Q.key==="Escape"&&Gi()};return window.addEventListener("keydown",z,!0),()=>window.removeEventListener("keydown",z,!0)},[me.open]),p.useEffect(()=>{if(!we.open)return;const z=Q=>{Q.key==="Escape"&&rt()};return window.addEventListener("keydown",z,!0),()=>window.removeEventListener("keydown",z,!0)},[we.open]),p.useEffect(()=>{if(!Kt.open)return;const z=Q=>{Q.key==="Escape"&&Vi()};return window.addEventListener("keydown",z,!0),()=>window.removeEventListener("keydown",z,!0)},[Kt.open]),p.useEffect(()=>{if(!bt.open)return;const z=Q=>{Q.key==="Escape"&&yl()};return window.addEventListener("keydown",z,!0),()=>window.removeEventListener("keydown",z,!0)},[bt.open]),p.useEffect(()=>{if(!je.open)return;const z=Q=>{Q.key==="Escape"&&lt()};return window.addEventListener("keydown",z,!0),()=>window.removeEventListener("keydown",z,!0)},[je.open]),r.jsxs("section",{"aria-busy":Ot||void 0,children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"목표 Simulation"}),r.jsxs("div",{className:"muted count-text",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[r.jsx("span",{style:{fontWeight:700},children:"현재목표"}),r.jsxs("span",{onClick:z=>Ke("TNT",z),style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #3b82f6",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent",cursor:"pointer"},title:"TNT 계획 합계 (클릭하여 상세)",children:[r.jsx("span",{style:{fontSize:12,color:"#3b82f6",fontWeight:700},children:"TNT"}),r.jsx("span",{style:{color:"#3b82f6"},children:Ue.format(ot.tnt)}),r.jsx("span",{style:{fontSize:12,color:"#3b82f6"},children:"원"})]}),r.jsxs("span",{onClick:z=>Ke("DYS",z),style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #10b981",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent",cursor:"pointer"},title:"DYS 계획 합계 (클릭하여 상세)",children:[r.jsx("span",{style:{fontSize:12,color:"#10b981",fontWeight:700},children:"DYS"}),r.jsx("span",{style:{color:"#10b981"},children:Ue.format(ot.dys)}),r.jsx("span",{style:{fontSize:12,color:"#10b981"},children:"원"})]}),r.jsx("span",{"aria-hidden":!0,style:{width:1,height:20,background:"var(--border)",display:"inline-block"}}),r.jsx("span",{style:{fontWeight:700},children:"목표확정"}),Wa.loading?r.jsx("span",{className:"muted",style:{fontSize:12},children:"불러오는 중…"}):Wa.error?r.jsx("span",{className:"error",style:{fontSize:12},children:Wa.error}):r.jsxs(r.Fragment,{children:[r.jsxs("span",{title:"확정된 고객 합계 (TNT)",style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #3b82f6",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent"},children:[r.jsx("span",{style:{fontSize:12,color:"#3b82f6",fontWeight:700},children:"TNT"}),r.jsx("span",{style:{color:"#3b82f6"},children:Ue.format(Wa.tnt)}),r.jsx("span",{style:{fontSize:12,color:"#3b82f6"},children:"원"})]}),r.jsxs("span",{title:"확정된 고객 합계 (DYS)",style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #10b981",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent"},children:[r.jsx("span",{style:{fontSize:12,color:"#10b981",fontWeight:700},children:"DYS"}),r.jsx("span",{style:{color:"#10b981"},children:Ue.format(Wa.dys)}),r.jsx("span",{style:{fontSize:12,color:"#10b981"},children:"원"})]})]}),r.jsx("button",{className:"btn-plain",title:"내 평균거래 단가",onClick:Hk,"aria-label":"평균거래 단가 팝업 열기",children:r.jsx("img",{src:Vv,className:"icon",alt:"단가"})}),F.toLocaleString(),"개 거래처"]})]}),r.jsxs("div",{className:"card",style:{padding:8,marginTop:8,display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[r.jsx("div",{className:"muted",children:"목표년도"}),r.jsxs("select",{className:"search-input",value:ie,onChange:Yk,"aria-label":"목표년도",style:{height:28},children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),ae().map(z=>r.jsxs("option",{value:String(z),children:[z,"년"]},z))]}),r.jsx("div",{className:"muted",style:{marginLeft:12},children:"가중치"}),r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("input",{className:"search-input",value:String(ku),onChange:z=>{const Q=Number((z.target.value||"").replace(/[^0-9]/g,""));Number.isFinite(Q)&&qk(Math.max(0,Math.min(999,Q)))},inputMode:"numeric","aria-label":"가중치(%)",style:{width:72,height:28,textAlign:"right"}}),r.jsx("span",{className:"muted",children:"%"})]})]}),(()=>{const z=!!($.hasC&&!$.hasP&&!$.hasI),Q=!!($.hasI&&!$.hasP&&!$.hasC),ce=!!($.hasP||$.hasC&&$.hasI),ge=z?"목표수립완료":Q?"초기설정완료":ce?"계획수립 중":"초기설정",fe=z||Q||ce,le=fe||Ot?{opacity:.6,cursor:"not-allowed",background:"var(--border)",color:"var(--muted)"}:void 0;return r.jsx("button",{className:"btn btn-card btn-3d",onClick:Kk,disabled:fe||Ot,style:le,children:ge})})(),ie?$.show?r.jsxs("div",{className:"muted",style:{display:"inline-flex",alignItems:"center",gap:6,flexWrap:"wrap",fontSize:12},children:[r.jsxs("span",{style:{fontSize:12},children:[$.name,"님"]}),r.jsxs("span",{style:{color:on,fontWeight:700,fontSize:14,whiteSpace:"pre"},children:[$.year,"년"]}),r.jsx("span",{style:{fontSize:12},children:" "}),r.jsxs("span",{style:{color:on,fontWeight:700,fontSize:14},children:["TNT ",$.tnt.toLocaleString(),"개"]}),r.jsx("span",{style:{fontSize:12},children:","}),r.jsxs("span",{style:{color:on,fontWeight:700,fontSize:14},children:[" DYS ",$.dys.toLocaleString(),"개"]}),r.jsx("span",{style:{fontSize:12},children:$.label||""})]}):U?r.jsxs("div",{className:"muted",style:{display:"inline-flex",alignItems:"center",gap:6,flexWrap:"wrap",fontSize:12},children:[r.jsxs("span",{style:{fontSize:12},children:[Bk,"님,"]}),r.jsx("span",{style:{color:on,fontWeight:700,fontSize:14},children:Wk}),r.jsx("span",{style:{fontSize:12},children:"매출 기준으로 담당 거래처"}),r.jsx("span",{style:{color:on,fontWeight:700,fontSize:14},children:"TNT"}),r.jsx("span",{style:{color:on,fontWeight:700,fontSize:14},children:ee.tnt.toLocaleString()}),r.jsx("span",{style:{fontSize:12},children:"개,"}),r.jsx("span",{style:{color:on,fontWeight:700,fontSize:14},children:"DYS"}),r.jsx("span",{style:{color:on,fontWeight:700,fontSize:14},children:ee.dys.toLocaleString()}),r.jsx("span",{style:{fontSize:12},children:"개에 대해"}),r.jsxs("span",{style:{color:on,fontWeight:700,fontSize:14},children:[ku,"%"]}),r.jsx("span",{style:{fontSize:12},children:"추가하여 목표 설정합니다."})]}):null:null,r.jsx("div",{className:"muted",style:{marginLeft:"auto"},children:Ks.loading?"요약 불러오는 중…":Ks.error?r.jsx("span",{className:"error",children:Ks.error}):r.jsxs(r.Fragment,{children:["수립대상 ",Ks.total.toLocaleString(),"개, 확정 ",Ks.confirmed.toLocaleString(),"개, 진행 중 ",Ks.inprogress.toLocaleString(),"개"]})})]}),je.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"transparent",zIndex:60},children:r.jsxs("div",{ref:Su.ref,className:"card",style:{...Su.style,width:720,maxWidth:"92vw",background:"var(--panel)",padding:12,fontSize:12},children:[r.jsx("div",{...Su.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:lt,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsxs("div",{className:"page-title",style:{marginBottom:8,alignItems:"center"},children:[r.jsxs("h2",{style:{margin:0},children:[je.company," 계획 합계 상세"]}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"radio",name:"totals-group",checked:je.group==="customer",onChange:()=>{Te(z=>({...z,group:"customer"})),De(je.company,"customer")}}),"거래처별"]}),r.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"radio",name:"totals-group",checked:je.group==="unit",onChange:()=>{Te(z=>({...z,group:"unit"})),De(je.company,"unit")}}),"영업관리단위별"]})]})]}),je.error?r.jsx("div",{className:"error",children:je.error}):null,r.jsx("div",{className:"table-container",style:{maxHeight:"66vh",overflow:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",width:380},children:je.group==="customer"?"거래처":"영업관리단위"}),r.jsx("th",{style:{textAlign:"right",width:200},children:"금액(원)"})]})}),r.jsx("tbody",{children:je.loading?r.jsx("tr",{children:r.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"불러오는 중…"})}):je.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):je.rows.map((z,Q)=>{const ce=je.group==="customer"&&z.label||z.key;return r.jsxs("tr",{children:[r.jsx("td",{children:ce}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Ue.format(Math.round(z.amount))})]},Q)})})]})})]})}),Ee?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:80,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:280,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:Ee}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>dt(null),children:"확인"})})]})}):null,r.jsx("div",{className:"c360-tabs",role:"tablist","aria-label":"회사 구분 탭",style:{marginTop:8},children:["TNT","DYS"].map(z=>r.jsx("button",{role:"tab","aria-selected":vr===z,className:`tab ${vr===z?"active":""}`,onClick:()=>{zn(z);try{D(z)}catch{}},children:z},z))}),vr==="TNT"?r.jsxs(r.Fragment,{children:[d&&r.jsx("div",{className:"error",children:d||zt.errorGeneric}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[r.jsxs("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:[r.jsx("div",{className:"card",style:{padding:8,marginBottom:8},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{className:"search-input",placeholder:"거래처명",value:m,onChange:z=>g(z.target.value),onKeyDown:z=>{z.key==="Enter"&&ps(!0)},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:()=>ps(!0),disabled:l,style:{flex:"0 0 auto"},children:"조회"})]})}),ie?vg:r.jsx("div",{className:"muted",style:{padding:"12px 10px"},children:"연도를 먼저 선택하세요."})]}),r.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:pe.map((z,Q)=>{const ce=Q<G,ge=Q===G;return r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:Q===pe.length-1?"0 0 auto":"1 1 0"},children:[r.jsx("div",{title:z.label,onClick:()=>O(z.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:ce||ge?"var(--accent)":"transparent",border:`2px solid ${ce||ge?"var(--accent)":"var(--border)"}`,color:ce||ge?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":ge?"step":void 0,children:ce?"✓":Q+1}),r.jsx("div",{style:{fontSize:12,color:ge||ce?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:z.label}),Q<pe.length-1&&r.jsx("div",{style:{height:2,background:Q<G?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},z.key)})}),r.jsx("div",{children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:Kr,disabled:!(w!=null&&w.customerSeq)||!ie,title:"해당 거래처 목표 확정",children:"확정"})})]}),w!=null&&w.customerSeq&&ie?r.jsxs("div",{className:"card",style:{marginBottom:12,padding:8},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginBottom:8,gap:8,flexWrap:"wrap"},children:[r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:Hn,children:"일괄비율"}),r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:He,children:"일괄입력"}),r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:yg,children:"신규 영업관리단위"})]}),Ct.error?r.jsx("div",{className:"error",children:Ct.error}):r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",width:220},children:"중분류"}),r.jsx("th",{style:{textAlign:"left",width:220},children:"영업관리단위"}),r.jsx("th",{style:{textAlign:"center",width:120},children:"목표입력"}),r.jsx("th",{className:"sum-head",style:{textAlign:"right",width:140},children:"합계"}),Array.from({length:12},(z,Q)=>Q+1).map(z=>r.jsxs("th",{style:{textAlign:"right"},children:[String(z).padStart(2,"0"),"월"]},z))]})}),r.jsx("tbody",{children:Ct.rows.length===0?r.jsx("tr",{children:r.jsx("td",{className:"muted",colSpan:16,style:{padding:"12px 10px"},children:Ct.loading?"불러오는 중…":"데이터가 없습니다"})}):Ct.rows.map((z,Q)=>{const ce=(z.months||[]).reduce((fe,le)=>fe+(Number.isFinite(le)?Number(le):0),0),ge=(z.amounts||[]).reduce((fe,le)=>fe+(Number.isFinite(le)?Number(le):0),0);return r.jsxs("tr",{children:[r.jsx("td",{children:z.sub}),r.jsxs("td",{children:[r.jsx("span",{children:z.unit}),z.stage?r.jsx("span",{className:"stage-badge",style:{marginLeft:6},title:String(z.stage),children:z.stage}):null]}),r.jsx("td",{style:{textAlign:"center"},children:r.jsx("button",{type:"button",className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:fe=>{fe.preventDefault(),fe.stopPropagation(),Ki(z.sub,z.unit)},children:"입력"})}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(ce,0,ge)}),z.months.map((fe,le)=>{var be;return r.jsx("td",{style:{textAlign:"right"},children:ue(fe,le,(be=z.amounts)==null?void 0:be[le],z.stage==="P"?"#dc2626":void 0,z.stage==="C")},le)})]},Q)})}),(()=>{if(!Ct.rows||Ct.rows.length===0)return null;const z=Array.from({length:12},(fe,le)=>Ct.rows.reduce((be,ve)=>{var ye;return be+(Number((ye=ve.months)==null?void 0:ye[le])||0)},0)),Q=Array.from({length:12},(fe,le)=>Ct.rows.reduce((be,ve)=>{var ye;return be+(Number((ye=ve.amounts)==null?void 0:ye[le])||0)},0)),ce=z.reduce((fe,le)=>fe+(Number(le)||0),0),ge=Q.reduce((fe,le)=>fe+(Number(le)||0),0);return r.jsx("tfoot",{children:r.jsxs("tr",{className:"sum-row",children:[r.jsx("td",{colSpan:3,style:{textAlign:"center",fontWeight:700},children:"합계"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(ce,0,ge)}),z.map((fe,le)=>r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(fe,le,Q[le])},le))]})})})()]})})]}):null]})]})]}):r.jsxs(r.Fragment,{children:[d&&r.jsx("div",{className:"error",children:d||zt.errorGeneric}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[r.jsxs("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:[r.jsx("div",{className:"card",style:{padding:8,marginBottom:8},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{className:"search-input",placeholder:"거래처명",value:m,onChange:z=>g(z.target.value),onKeyDown:z=>{z.key==="Enter"&&ps(!0)},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:()=>ps(!0),disabled:l,style:{flex:"0 0 auto"},children:"조회"})]})}),ie?vg:r.jsx("div",{className:"muted",style:{padding:"12px 10px"},children:"연도를 먼저 선택하세요."})]}),r.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:pe.map((z,Q)=>{const ce=Q<G,ge=Q===G;return r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:Q===pe.length-1?"0 0 auto":"1 1 0"},children:[r.jsx("div",{title:z.label,onClick:()=>O(z.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:ce||ge?"var(--accent)":"transparent",border:`2px solid ${ce||ge?"var(--accent)":"var(--border)"}`,color:ce||ge?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":ge?"step":void 0,children:ce?"✓":Q+1}),r.jsx("div",{style:{fontSize:12,color:ge||ce?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:z.label}),Q<pe.length-1&&r.jsx("div",{style:{height:2,background:Q<G?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},z.key)})}),r.jsx("div",{children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:Kr,disabled:!(w!=null&&w.customerSeq)||!ie,title:"해당 거래처 목표 확정",children:"확정"})})]}),w!=null&&w.customerSeq&&ie?r.jsxs("div",{className:"card",style:{marginBottom:12,padding:8},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginBottom:8,gap:8,flexWrap:"wrap"},children:[r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:Hn,children:"일괄비율"}),r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:He,children:"일괄입력"}),r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:yg,children:"신규 영업관리단위"})]}),Ct.error?r.jsx("div",{className:"error",children:Ct.error}):r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",width:220},children:"중분류"}),r.jsx("th",{style:{textAlign:"left",width:220},children:"영업관리단위"}),r.jsx("th",{style:{textAlign:"center",width:120},children:"목표입력"}),r.jsx("th",{className:"sum-head",style:{textAlign:"right",width:140},children:"합계"}),Array.from({length:12},(z,Q)=>Q+1).map(z=>r.jsxs("th",{style:{textAlign:"right"},children:[String(z).padStart(2,"0"),"월"]},z))]})}),r.jsx("tbody",{children:Ct.rows.length===0?r.jsx("tr",{children:r.jsx("td",{className:"muted",colSpan:16,style:{padding:"12px 10px"},children:Ct.loading?"불러오는 중…":"데이터가 없습니다"})}):Ct.rows.map((z,Q)=>{const ce=(z.months||[]).reduce((fe,le)=>fe+(Number.isFinite(le)?Number(le):0),0),ge=(z.amounts||[]).reduce((fe,le)=>fe+(Number.isFinite(le)?Number(le):0),0);return r.jsxs("tr",{children:[r.jsx("td",{children:z.sub}),r.jsxs("td",{children:[r.jsx("span",{children:z.unit}),z.stage?r.jsx("span",{className:"badge stage-badge",style:{marginLeft:6},children:z.stage}):null]}),r.jsx("td",{style:{textAlign:"center"},children:r.jsx("button",{type:"button",className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:fe=>{fe.preventDefault(),fe.stopPropagation(),Ki(z.sub,z.unit)},children:"입력"})}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(ce,0,ge)}),z.months.map((fe,le)=>{var be;return r.jsx("td",{style:{textAlign:"right"},children:ue(fe,le,(be=z.amounts)==null?void 0:be[le],z.stage==="P"?"#dc2626":void 0,z.stage==="C")},le)})]},Q)})}),(()=>{if(!Ct.rows||Ct.rows.length===0)return null;const z=Array.from({length:12},(fe,le)=>Ct.rows.reduce((be,ve)=>{var ye;return be+(Number((ye=ve.months)==null?void 0:ye[le])||0)},0)),Q=Array.from({length:12},(fe,le)=>Ct.rows.reduce((be,ve)=>{var ye;return be+(Number((ye=ve.amounts)==null?void 0:ye[le])||0)},0)),ce=z.reduce((fe,le)=>fe+(Number(le)||0),0),ge=Q.reduce((fe,le)=>fe+(Number(le)||0),0);return r.jsx("tfoot",{children:r.jsxs("tr",{className:"sum-row",children:[r.jsx("td",{colSpan:3,style:{textAlign:"center",fontWeight:700},children:"합계"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(ce,0,ge)}),z.map((fe,le)=>r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(fe,le,Q[le])},le))]})})})()]})})]}):null,w!=null&&w.customerSeq&&ie?r.jsxs("div",{className:"card",style:{marginBottom:12,padding:8},children:[r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[r.jsx("div",{className:"muted",style:{fontWeight:700,lineHeight:"28px",fontSize:14},children:"목표수립의견"}),r.jsx("textarea",{className:"search-input",value:gt.val,onChange:z=>Nt(Q=>({...Q,val:z.target.value})),placeholder:"목표수립에 대한 의견을 입력하세요",rows:6,style:{flex:1,resize:"vertical",height:80,minHeight:80,fontSize:12}})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:8,marginTop:8},children:[gt.loading?r.jsx("span",{className:"muted",style:{fontSize:12},children:"(읽는 중…)"}):null,gt.error?r.jsx("span",{className:"error",style:{fontSize:12},children:gt.error}):null,gt.success?r.jsx("span",{style:{fontSize:12,color:"var(--accent)",fontWeight:700},children:gt.success}):null,r.jsx("button",{className:"btn btn-card btn-3d",onClick:yn,disabled:gt.saving,children:gt.saving?"저장중…":"저장"})]})]}):null]})]})]}),me.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:Mn.ref,className:"card compact",style:{...Mn.style,position:"relative",width:900,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[r.jsx("div",{...Mn.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:Gi,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1.6fr 120px 1fr",gap:8,alignItems:"center"},children:[r.jsx("div",{className:"muted form-label",children:"영업관리단위"}),r.jsx("div",{children:me.unit||""}),r.jsx("div",{className:"muted form-label",children:"중분류"}),r.jsx("div",{children:me.sub||""}),r.jsx("div",{className:"muted form-label",children:"매출 수량"}),r.jsx("div",{style:{gridColumn:"2 / 5"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"nowrap",minWidth:0},children:[r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:me.qty||"",onChange:z=>pl(me.month,z.target.value)}),(()=>{const z=ft(),Q=(me.unit||"").trim(),ce=ut(Q),ge=Oe[z]||{},fe=Number(ge[ce]||0),le=Et(),be=(Ne==null?void 0:Ne[le])||{},ve=Number(be[ce]||0),ye=Number.isFinite(fe)&&fe>0?Ue.format(Math.round(fe)):"-",_e=Number.isFinite(ve)&&ve>0?Ue.format(Math.round(ve)):"-",Ae=Number.isFinite(fe)&&Number.isFinite(ve)?fe>=ve?on:"#dc2626":on;return r.jsxs("span",{className:"muted",style:{fontSize:12,whiteSpace:"nowrap"},children:[r.jsxs("span",{style:{color:Ae,fontWeight:700},children:["내단가 ",ye," 원"]})," | 전체단가 ",_e," 원/단위"]})})()]})}),r.jsx("div",{className:"muted form-label",children:"매출월"}),r.jsx("div",{children:r.jsxs("select",{className:"search-input",value:me.month||"",onChange:z=>pl(z.target.value,me.qty),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(z,Q)=>Q+1).map(z=>r.jsxs("option",{value:String(z),children:[z,"월"]},z))]})})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsx("div",{className:"pane-header",style:{margin:0},children:"현재 목표"}),r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(z,Q)=>Q+1).map(z=>r.jsxs("th",{style:{textAlign:"right"},children:[String(z).padStart(2,"0"),"월"]},z))]})}),r.jsx("tbody",{children:r.jsx("tr",{children:(()=>{const z=(me.curMonths||[]).reduce((ce,ge)=>ce+(Number.isFinite(ge)?Number(ge):0),0),Q=(me.curAmounts||[]).reduce((ce,ge)=>ce+(Number.isFinite(ge)?Number(ge):0),0);return r.jsxs(r.Fragment,{children:[r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(z,0,Q)}),me.curMonths.map((ce,ge)=>{var fe;return r.jsx("td",{children:ue(ce,ge,(fe=me.curAmounts)==null?void 0:fe[ge],me.stage==="P"?"#dc2626":void 0,me.stage==="C")},ge)})]})})()})})]})})]}),r.jsxs("div",{style:{marginTop:12},children:[r.jsx("div",{className:"pane-header",style:{margin:0},children:"분배 미리보기"}),r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(z,Q)=>Q+1).map(z=>r.jsxs("th",{style:{textAlign:"right"},children:[String(z).padStart(2,"0"),"월"]},z))]})}),r.jsx("tbody",{children:r.jsx("tr",{children:(()=>{const z=ft();Oe[z];const Q=(me.unit||"").trim(),ce=yt(Q),ge=Number.isFinite(ce)?Number(ce):0,fe=(me.dist||[]).reduce((ve,ye)=>ve+(Number.isFinite(ye)?Number(ye):0),0),le=Number.isFinite(ge)?Math.round(ge):0,be=(me.dist||[]).reduce((ve,ye)=>ve+(Number.isFinite(ye)&&le>0?Number(ye)*le:0),0);return r.jsxs(r.Fragment,{children:[r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(fe,0,be)}),me.dist.map((ve,ye)=>{const _e=Number.isFinite(ge)?Math.round(ge):0,Ae=Number.isFinite(ve)&&_e>0?Number(ve)*_e:void 0;return r.jsx("td",{children:ue(ve,ye,Ae,me.stage==="P"?"#dc2626":void 0,me.stage==="C")},ye)})]})})()})})]})})]}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:ml,children:"목표등록"})}),me.success?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:me.success}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:se,children:"확인"})})]})}):null]})}),we.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:xt.ref,className:"card compact",style:{...xt.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[r.jsx("div",{...xt.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:rt,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h2",{style:{margin:0},children:"목표 일괄입력"})}),r.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto",position:"relative"},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:68,textAlign:"center"},children:"구분"}),r.jsx("th",{style:{width:160,textAlign:"left"},children:"내 평균단가"}),r.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(z,Q)=>Q+1).map(z=>r.jsxs("th",{style:{textAlign:"right"},children:[String(z).padStart(2,"0"),"월"]},z))]})}),r.jsx("tbody",{children:we.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:19,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):we.rows.map((z,Q)=>{const ce=ft();Oe[ce];const ge=yt((z.unit||"").trim()),fe=Number.isFinite(ge)?Number(ge):0,le=Number(z.month||0),be=Number(z.qty||0),ve=new Array(12).fill(0);if(Number.isFinite(le)&&le>=1&&le<=12&&Number.isFinite(be)&&be>0){const Re=12-le+1,it=be/Re;for(let et=le-1;et<12;et++)ve[et]=it}const ye=ve,_e=(z.curMonths||[]).reduce((Re,it)=>Re+(Number.isFinite(it)?Number(it):0),0),Ae=(z.curAmounts||[]).reduce((Re,it)=>Re+(Number.isFinite(it)?Number(it):0),0),Ce=ve.reduce((Re,it)=>Re+(Number.isFinite(it)?Number(it):0),0),qe=ve.reduce((Re,it)=>Re+(Number.isFinite(it)&&Number.isFinite(fe)?Number(it)*fe:0),0);return r.jsxs(r.Fragment,{children:[r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("span",{style:{fontSize:12},children:z.sub})}),r.jsxs("td",{children:[r.jsx("span",{style:{fontSize:12},children:z.unit}),z.stage?r.jsx("span",{className:"stage-badge",style:{marginLeft:6},title:String(z.stage),children:String(z.stage)}):null]}),r.jsx("td",{style:{textAlign:"center"},className:"muted",children:"현재"}),r.jsx("td",{className:"muted",children:"-"}),r.jsx("td",{className:"muted",children:"-"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(_e,0,Ae)}),z.curMonths.map((Re,it)=>{var et;return r.jsx("td",{children:ue(Re,it,(et=z.curAmounts)==null?void 0:et[it],z.stage==="P"?"#dc2626":void 0,z.stage==="C")},it)})]},z.key+":cur"),r.jsxs("tr",{style:{background:"var(--panel-2)"},children:[r.jsx("td",{}),r.jsx("td",{}),r.jsx("td",{style:{textAlign:"center"},className:"sum-head",children:"적용"}),r.jsx("td",{children:r.jsxs("select",{className:"search-input",value:z.month||"",onChange:Re=>Fe(Q,Re.target.value,void 0),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(Re,it)=>it+1).map(Re=>r.jsxs("option",{value:String(Re),children:[Re,"월"]},Re))]})}),r.jsx("td",{children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:z.qty||"",onChange:Re=>Fe(Q,void 0,Re.target.value)}),(()=>{var wg;const Re=ft(),et=(((wg=($e[Re]||{})[(z.unit||"").trim()])==null?void 0:wg.itemStdUnit)||"").trim(),mt=ut(z.unit||""),rn=Oe[Re]||{},It=Number(rn[mt]||0),br=Et(),jr=(Ne==null?void 0:Ne[br])||{},Mr=Number(jr[mt]||0),di=Number.isFinite(It)&&It>0?Ue.format(Math.round(It)):"-",Cu=Number.isFinite(Mr)&&Mr>0?Ue.format(Math.round(Mr)):"-",Gk=Number.isFinite(It)&&Number.isFinite(Mr)?It>=Mr?on:"#dc2626":on;return r.jsxs("span",{className:"muted",style:{fontSize:12},children:[r.jsxs("span",{style:{color:Gk,fontWeight:700},children:["내단가 ",di," 원"]})," | 전체단가 ",Cu," 원/",et||"단위"]})})()]})}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(Ce,0,qe)}),ye.map((Re,it)=>{const et=Number.isFinite(fe)?Math.round(fe):0,mt=Number.isFinite(Re)&&et>0?Number(Re)*et:void 0;return r.jsx("td",{children:ue(Re,it,mt,z.stage==="P"?"#dc2626":void 0,z.stage==="C")},it)})]},z.key+":prev")]})})}),(()=>{if(!we.rows||we.rows.length===0)return null;const z=ft();Oe[z];const Q=Array.from({length:12},(_e,Ae)=>we.rows.reduce((Ce,qe)=>{var Re;return Ce+(Number((Re=qe.curMonths)==null?void 0:Re[Ae])||0)},0)),ce=Array.from({length:12},(_e,Ae)=>we.rows.reduce((Ce,qe)=>{var Re;return Ce+(Number((Re=qe.curAmounts)==null?void 0:Re[Ae])||0)},0)),ge=Q.reduce((_e,Ae)=>_e+(Number(Ae)||0),0),fe=ce.reduce((_e,Ae)=>_e+(Number(Ae)||0),0),le=Array.from({length:12},(_e,Ae)=>we.rows.reduce((Ce,qe)=>{var Re;return Ce+(Number((Re=qe.dist)==null?void 0:Re[Ae])||0)},0)),be=Array.from({length:12},(_e,Ae)=>we.rows.reduce((Ce,qe)=>{var mt;const Re=yt((qe.unit||"").trim()),it=Number.isFinite(Re)?Math.round(Number(Re)):0,et=Number(((mt=qe.dist)==null?void 0:mt[Ae])||0);return Ce+(Number.isFinite(et)&&it>0?et*it:0)},0)),ve=le.reduce((_e,Ae)=>_e+(Number(Ae)||0),0),ye=be.reduce((_e,Ae)=>_e+(Number(Ae)||0),0);return r.jsxs("tfoot",{children:[r.jsxs("tr",{className:"sum-row-current",children:[r.jsx("td",{colSpan:5,style:{textAlign:"center",fontWeight:700},children:"[현재] 합계"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(ge,0,fe)}),Q.map((_e,Ae)=>r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(_e,Ae,ce[Ae])},Ae))]}),r.jsxs("tr",{className:"sum-row-apply",style:{background:"var(--panel-2)"},children:[r.jsx("td",{colSpan:5,style:{textAlign:"center",fontWeight:700},children:"[적용] 합계"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(ve,0,ye)}),le.map((_e,Ae)=>r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(_e,Ae,be[Ae])},Ae))]})]})})()]})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:Ye,children:"목표등록"})}),we.success?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"absolute",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:we.success}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:se,children:"확인"})})]})}):null]})}),Kt.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:Ra.ref,className:"card compact",style:{...Ra.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[r.jsx("div",{...Ra.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:Vi,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsxs("div",{className:"page-title",style:{marginBottom:8,alignItems:"center"},children:[r.jsx("h2",{style:{margin:0},children:"목표 일괄비율"}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsx("span",{className:"muted",children:"적용 비율(%)"}),r.jsx("input",{className:"assign-input",type:"number",min:0,max:100,step:1,placeholder:"0",value:Ma,onChange:z=>gl(z.target.value),style:{width:100},"aria-label":"일괄 비율 입력"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:Vr,children:"적용"})]})]}),r.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:68,textAlign:"center"},children:"구분"}),r.jsx("th",{style:{width:160,textAlign:"left"},children:"내 평균단가"}),r.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(z,Q)=>Q+1).map(z=>r.jsxs("th",{style:{textAlign:"right"},children:[String(z).padStart(2,"0"),"월"]},z))]})}),r.jsx("tbody",{children:Kt.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:19,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):Kt.rows.map((z,Q)=>{const ce=ft();Oe[ce];const ge=yt((z.unit||"").trim()),fe=Number.isFinite(ge)?Number(ge):0,le=Array.isArray(z.dist)?z.dist.slice():new Array(12).fill(0),be=(z.curMonths||[]).reduce((Ae,Ce)=>Ae+(Number.isFinite(Ce)?Number(Ce):0),0),ve=(z.curAmounts||[]).reduce((Ae,Ce)=>Ae+(Number.isFinite(Ce)?Number(Ce):0),0),ye=le.reduce((Ae,Ce)=>Ae+(Number.isFinite(Ce)?Number(Ce):0),0),_e=le.reduce((Ae,Ce)=>Ae+(Number.isFinite(Ce)&&Number.isFinite(fe)?Number(Ce)*fe:0),0);return r.jsxs(r.Fragment,{children:[r.jsxs("tr",{children:[r.jsx("td",{children:r.jsx("span",{style:{fontSize:12},children:z.sub})}),r.jsxs("td",{children:[r.jsx("span",{style:{fontSize:12},children:z.unit}),z.stage?r.jsx("span",{className:"stage-badge",style:{marginLeft:6},title:String(z.stage),children:String(z.stage)}):null]}),r.jsx("td",{style:{textAlign:"center"},className:"muted",children:"현재"}),r.jsx("td",{className:"muted",style:{textAlign:"left"},children:(()=>{var di;const Ae=ft(),qe=(((di=($e[Ae]||{})[(z.unit||"").trim()])==null?void 0:di.itemStdUnit)||"").trim(),Re=ut(z.unit||""),it=Oe[Ae]||{},et=Number(it[Re]||0),mt=Et(),rn=(Ne==null?void 0:Ne[mt])||{},It=Number(rn[Re]||0),br=Number.isFinite(et)&&et>0?Ue.format(Math.round(et)):"-",jr=Number.isFinite(It)&&It>0?Ue.format(Math.round(It)):"-",Mr=Number.isFinite(et)&&Number.isFinite(It)?et>=It?on:"#dc2626":on;return r.jsxs("span",{children:[r.jsxs("span",{style:{color:Mr,fontWeight:700},children:["내단가 ",br," 원"]})," | 전체단가 ",jr," 원/",qe||"단위"]})})()}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(be,0,ve)}),z.curMonths.map((Ae,Ce)=>{var qe;return r.jsx("td",{children:ue(Ae,Ce,(qe=z.curAmounts)==null?void 0:qe[Ce],z.stage==="P"?"#dc2626":void 0,z.stage==="C")},Ce)})]},z.key+":cur"),r.jsxs("tr",{style:{background:"var(--panel-2)"},children:[r.jsx("td",{}),r.jsx("td",{}),r.jsx("td",{style:{textAlign:"center"},className:"sum-head",children:"적용"}),r.jsx("td",{className:"muted",style:{textAlign:"left"},children:(()=>{var di;const Ae=ft(),qe=(((di=($e[Ae]||{})[(z.unit||"").trim()])==null?void 0:di.itemStdUnit)||"").trim(),Re=ut(z.unit||""),it=Oe[Ae]||{},et=Number(it[Re]||0),mt=Et(),rn=(Ne==null?void 0:Ne[mt])||{},It=Number(rn[Re]||0),br=Number.isFinite(et)&&et>0?Ue.format(Math.round(et)):"-",jr=Number.isFinite(It)&&It>0?Ue.format(Math.round(It)):"-",Mr=Number.isFinite(et)&&Number.isFinite(It)?et>=It?on:"#dc2626":on;return r.jsxs("span",{children:[r.jsxs("span",{style:{color:Mr,fontWeight:700},children:["내단가 ",br," 원"]})," | 전체단가 ",jr," 원/",qe||"단위"]})})()}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(ye,0,_e)}),le.map((Ae,Ce)=>{const qe=Number.isFinite(fe)?Math.round(fe):0,Re=Number.isFinite(Ae)&&qe>0?Number(Ae)*qe:void 0;return r.jsx("td",{children:ue(Ae,Ce,Re,z.stage==="P"?"#dc2626":void 0,z.stage==="C")},Ce)})]},z.key+":prev")]})})}),(()=>{if(!Kt.rows||Kt.rows.length===0)return null;const z=ft();Oe[z];const Q=Array.from({length:12},(_e,Ae)=>Kt.rows.reduce((Ce,qe)=>{var Re;return Ce+(Number((Re=qe.curMonths)==null?void 0:Re[Ae])||0)},0)),ce=Array.from({length:12},(_e,Ae)=>Kt.rows.reduce((Ce,qe)=>{var Re;return Ce+(Number((Re=qe.curAmounts)==null?void 0:Re[Ae])||0)},0)),ge=Q.reduce((_e,Ae)=>_e+(Number(Ae)||0),0),fe=ce.reduce((_e,Ae)=>_e+(Number(Ae)||0),0),le=Array.from({length:12},(_e,Ae)=>Kt.rows.reduce((Ce,qe)=>{var Re;return Ce+(Number((Re=qe.dist)==null?void 0:Re[Ae])||0)},0)),be=Array.from({length:12},(_e,Ae)=>Kt.rows.reduce((Ce,qe)=>{var mt;const Re=yt((qe.unit||"").trim()),it=Number.isFinite(Re)?Math.round(Number(Re)):0,et=Number(((mt=qe.dist)==null?void 0:mt[Ae])||0);return Ce+(Number.isFinite(et)&&it>0?et*it:0)},0)),ve=le.reduce((_e,Ae)=>_e+(Number(Ae)||0),0),ye=be.reduce((_e,Ae)=>_e+(Number(Ae)||0),0);return r.jsxs("tfoot",{children:[r.jsxs("tr",{className:"sum-row-current",children:[r.jsx("td",{colSpan:4,style:{textAlign:"center",fontWeight:700},children:"[현재] 합계"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(ge,0,fe)}),Q.map((_e,Ae)=>r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(_e,Ae,ce[Ae])},Ae))]}),r.jsxs("tr",{className:"sum-row-apply",style:{background:"var(--panel-2)"},children:[r.jsx("td",{colSpan:4,style:{textAlign:"center",fontWeight:700},children:"[적용] 합계"}),r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(ve,0,ye)}),le.map((_e,Ae)=>r.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:ue(_e,Ae,be[Ae])},Ae))]})]})})()]})}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:wu,children:"목표등록"})}),Kt.success?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:Kt.success}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:se,children:"확인"})})]})}):null]})}),bt.open&&r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:r.jsxs("div",{ref:$a.ref,className:"card",style:{...$a.style,width:984,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[r.jsx("div",{...$a.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:yl,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h2",{style:{margin:0},children:"신규 영업관리단위"})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 120px 1fr",gap:8,alignItems:"center",fontSize:12},children:[r.jsx("div",{className:"muted",children:"영업관리단위"}),r.jsx("div",{children:r.jsxs("select",{className:"search-input",value:bt.unit||"",onChange:z=>Rk(z.target.value),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),bt.opts.map((z,Q)=>r.jsx("option",{value:z.salesMgmtUnit,children:z.salesMgmtUnit},Q))]})}),r.jsx("div",{className:"muted",children:"중분류"}),r.jsx("div",{children:r.jsx("input",{className:"assign-input",value:bt.sub||"",readOnly:!0,placeholder:"자동"})}),r.jsx("div",{className:"muted",children:"매출월"}),r.jsx("div",{children:r.jsxs("select",{className:"search-input",value:bt.month||"",onChange:z=>xg(z.target.value,void 0),children:[r.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(z,Q)=>Q+1).map(z=>r.jsxs("option",{value:String(z),children:[z,"월"]},z))]})}),r.jsx("div",{className:"muted",children:"매출 수량"}),r.jsx("div",{children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:bt.qty||"",onChange:z=>xg(void 0,z.target.value)}),(()=>{var Re;const z=ft(),Q=Oe[z]||{},ce=$e[z]||{},ge=(bt.unit||"").trim(),fe=ut(ge),le=Number((Q==null?void 0:Q[fe])||0),be=Et(),ve=(Ne==null?void 0:Ne[be])||{},ye=Number(ve[fe]||0),_e=(((Re=ce[ge])==null?void 0:Re.itemStdUnit)||"").trim(),Ae=Number.isFinite(le)&&le>0?Ue.format(Math.round(le)):"-",Ce=Number.isFinite(ye)&&ye>0?Ue.format(Math.round(ye)):"-",qe=Number.isFinite(le)&&Number.isFinite(ye)?le>=ye?on:"#dc2626":on;return r.jsxs("span",{className:"muted",style:{fontSize:12,whiteSpace:"nowrap"},children:[r.jsxs("span",{style:{color:qe,fontWeight:700},children:["내단가 ",Ae," 원"]})," | 전체단가 ",Ce," 원/",_e||"단위"]})})()]})})]}),r.jsx("div",{style:{marginTop:12},children:r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsx("tr",{children:Array.from({length:12},(z,Q)=>Q+1).map(z=>r.jsxs("th",{style:{textAlign:"right"},children:[String(z).padStart(2,"0"),"월"]},z))})}),r.jsx("tbody",{children:r.jsx("tr",{children:bt.dist.map((z,Q)=>{const ce=ft();Oe[ce];const ge=yt((bt.unit||"").trim()),fe=Number.isFinite(ge)?Number(ge):0,le=Number.isFinite(fe)?Math.round(fe):0,be=Number.isFinite(z)&&le>0?Number(z)*le:void 0;return r.jsx("td",{children:ue(z,Q,be)},Q)})})})]})})}),r.jsxs("div",{style:{marginTop:12},children:[r.jsx("div",{className:"pane-header",style:{margin:0},children:"추가된 영업관리단위"}),r.jsx("div",{className:"table-container",children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),r.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),Array.from({length:12},(z,Q)=>Q+1).map(z=>r.jsxs("th",{style:{textAlign:"right"},children:[String(z).padStart(2,"0"),"월"]},z))]})}),r.jsx("tbody",{children:bt.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:14,className:"muted",style:{padding:"12px 10px"},children:"추가된 영업관리단위가 없습니다"})}):bt.rows.map((z,Q)=>r.jsxs("tr",{children:[r.jsxs("td",{children:[r.jsx("button",{className:"btn-plain","aria-label":"삭제",title:"삭제",onClick:()=>or(ce=>({...ce,rows:ce.rows.filter((ge,fe)=>fe!==Q)})),style:{marginRight:6,verticalAlign:"middle"},children:r.jsx("img",{src:sn,className:"icon",alt:"삭제"})}),z.sub]}),r.jsx("td",{children:z.unit}),z.months.map((ce,ge)=>{const fe=ft();Oe[fe];const le=yt((z.unit||"").trim()),be=Number.isFinite(le)?Number(le):0,ve=Number.isFinite(be)?Math.round(be):0,ye=Number.isFinite(ce)&&ve>0?Number(ce)*ve:void 0;return r.jsx("td",{children:ue(ce,ge,ye)},ge)})]},Q))})]})})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:[r.jsx("button",{className:"btn btn-card btn-3d",onClick:$k,children:"추가"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:Lk,children:"목표등록"})]}),bt.error?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:bt.error}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>or(z=>({...z,error:null})),children:"확인"})})]})}):null,bt.success?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:bt.success}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:se,children:"확인"})})]})}):null]})}),zr.open&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:60},children:r.jsxs("div",{ref:_u.ref,className:"card",style:{..._u.style,height:"66vh",width:760,maxWidth:"96vw",background:"var(--panel)",padding:12,borderLeft:"1px solid var(--border)",boxShadow:"-8px 0 24px rgba(0,0,0,0.18)",overflow:"hidden"},children:[r.jsx("div",{..._u.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),r.jsx("button",{"aria-label":"닫기",onClick:jg,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsxs("div",{className:"page-title",style:{marginBottom:8,display:"flex",alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,display:"flex",alignItems:"center",gap:6,fontSize:14},children:Xi?r.jsxs(r.Fragment,{children:[r.jsxs("span",{style:{color:on,fontWeight:700,fontSize:14},children:[Xi,"년"]}),r.jsx("span",{style:{fontSize:12},children:"내 평균거래 단가"})]}):r.jsx("span",{style:{fontSize:12},children:"내 평균거래 단가"})}),r.jsxs("div",{style:{marginLeft:"auto",display:"inline-flex",alignItems:"center",gap:8,flexWrap:"nowrap"},children:[r.jsx("select",{className:"search-input",value:Xi,onChange:z=>bg(Number(z.target.value)),"aria-label":"평균단가 조회 연도",style:{height:28},children:[2025,2026,2027,2028,2029,2030].map(z=>r.jsxs("option",{value:z,children:[z,"년"]},z))}),r.jsxs("div",{role:"radiogroup","aria-label":"회사 구분",className:"segmented",style:{display:"inline-flex",alignItems:"center",gap:8,height:28,border:"1px solid var(--border)",borderRadius:6,padding:"0 6px"},children:[r.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:12,height:"100%"},children:[r.jsx("input",{type:"radio",name:"unit-company",value:"TNT",checked:La==="TNT",onChange:()=>Nu("TNT")}),r.jsx("span",{style:{fontSize:12},children:"TNT"})]}),r.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:12,height:"100%"},children:[r.jsx("input",{type:"radio",name:"unit-company",value:"DYS",checked:La==="DYS",onChange:()=>Nu("DYS")}),r.jsx("span",{style:{fontSize:12},children:"DYS"})]})]})]})]}),zr.error?r.jsx("div",{className:"error",style:{maxWidth:420},children:zr.error}):r.jsx("div",{className:"table-container",style:{height:"calc(66vh - 120px)",overflow:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:180,textAlign:"left"},children:"영업관리단위"}),r.jsx("th",{style:{width:120,textAlign:"left"},children:"판매단위"}),r.jsx("th",{style:{width:120,textAlign:"left"},children:"표준단위"}),r.jsx("th",{style:{width:120,textAlign:"right"},children:"내평균단가(원)"}),r.jsx("th",{style:{width:120,textAlign:"right"},children:"전체단가(원)"})]})}),r.jsx("tbody",{children:zr.loading?r.jsx("tr",{children:r.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"불러오는 중…"})}):zr.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):zr.rows.map((z,Q)=>r.jsxs("tr",{children:[r.jsx("td",{children:z.unit||"na"}),r.jsx("td",{children:z.itemUnit||"-"}),r.jsx("td",{children:z.itemStdUnit||"-"}),(()=>{const ce=Number(z.amountMy||0),ge=Number(z.amountGlobal||0),fe=Number.isFinite(ce)&&Number.isFinite(ge)?ce>=ge?on:"#dc2626":on;return r.jsx("td",{style:{textAlign:"right",color:fe,fontWeight:700},children:Number.isFinite(ce)&&ce>0?`${Ue.format(Math.round(ce))} 원`:"-"})})(),r.jsx("td",{style:{textAlign:"right"},children:Number.isFinite(Number(z.amountGlobal))&&Number(z.amountGlobal)>0?`${Ue.format(Math.round(Number(z.amountGlobal)))} 원`:"-"})]},Q))})]})})]})}),Ot&&r.jsx("div",{role:"alert","aria-live":"assertive","aria-busy":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:r.jsxs("div",{className:"card",style:{padding:16,background:"var(--panel)",minWidth:280,textAlign:"center",boxShadow:"0 4px 16px rgba(0,0,0,.3)"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"초기설정 진행 중"}),r.jsx("div",{className:"muted",style:{marginBottom:12},children:Gr||"작업을 준비 중입니다…"}),r.jsx("div",{className:"muted",style:{fontSize:12},children:"작업이 완료될 때까지 다른 동작을 할 수 없습니다."})]})})]});async function Kk(){try{if(En(!0),Yt("초기설정 요청 중입니다…"),!ie||isNaN(Number(ie))){alert("연도를 선택하세요.");return}const z=localStorage.getItem("tnt.sales.assigneeId")||"";if(!z){alert("로그인이 필요합니다.");return}const Q={year:Number(ie),companyType:k,upliftPercent:Math.max(0,Math.min(999,Number(ku)||0)),versionNo:1,assigneeId:z},ce=localStorage.getItem("tnt.sales.empSeq")||"",ge=localStorage.getItem("tnt.sales.empId")||"",fe={"Content-Type":"application/json"};ce&&(fe["X-EMP-SEQ"]=ce),ge&&(fe["X-EMP-ID"]=ge),fe["X-ASSIGNEE-ID"]=z;const le=await fetch("/api/v1/sales/plan/init",{method:"POST",headers:fe,body:JSON.stringify(Q)});if(Yt("초기 목표를 저장하고 있습니다…"),!le.ok){let ye=`HTTP ${le.status}`;try{const _e=await le.json();_e!=null&&_e.error&&(ye=_e.error)}catch{const _e=await le.text();_e&&(ye=_e)}throw new Error(ye)}await le.json().catch(()=>({}));const be=(localStorage.getItem("tnt.sales.empName")||"").trim()||"사용자",ve=Number(ie);W({show:!0,name:be,tnt:ee.tnt,dys:ee.dys,year:Number.isFinite(ve)&&ve>0?ve:0,hasP:!1,hasC:!1,hasI:!0,label:"초기설정완료"});try{await ps(!0)}catch{}}catch(z){alert((z==null?void 0:z.message)||"초기설정 중 오류가 발생했습니다.")}finally{En(!1),Yt("")}}}function m_(e){if(!e)return"";const n=e instanceof Date?e:new Date(e);if(isNaN(n.getTime()))return"";const i=String(n.getFullYear()%100).padStart(2,"0"),s=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0");return`${i}-${s}-${a} ${o}:${l}`}function g_(){const[e,n]=p.useState(""),[i,s]=p.useState(""),[a,o]=p.useState(""),[l,c]=p.useState(!1),[d,u]=p.useState(null),[f,h]=p.useState([]),[m,g]=p.useState(!1),[b,j]=p.useState({open:!1,x:0,y:0}),[y,x]=p.useState(()=>new Set),[v,A]=p.useState({open:!1,x:0,y:0}),[N,C]=p.useState(void 0),[w,_]=p.useState("init"),[I,O]=p.useState({}),E=["init","sim","apply","confirm"],S=[{key:"init",label:"초기설정"},{key:"sim",label:"Simulation"},{key:"apply",label:"목표반영"},{key:"confirm",label:"확정"}],k=E.indexOf(w),D=()=>{const K=Math.max(0,k-1);_(E[K])},T=()=>{const K=Math.min(E.length-1,k+1);_(E[K])},[P,R]=p.useState(!1),[Y,X]=p.useState(null);new Date().getFullYear();const[H,q]=p.useState("prev1"),[M,L]=p.useState(()=>new Array(12).fill(0)),[B,F]=p.useState({loading:!1});async function te(){if(!(N!=null&&N.customerSeq)){L(new Array(12).fill(0));return}R(!0),X(null);try{const K=new Date().getFullYear(),ne=H==="prev1"?[K-1]:H==="last2"?[K-1,K-2]:[K-1,K-2,K-3],pe=[];await Promise.all(ne.map(async ae=>{try{const ie=await fetch(`/api/v1/customers/${N.customerSeq}/invoice-monthly?year=${ae}`);if(!ie.ok)return;const J=await ie.json().catch(()=>[]),re=(Array.isArray(J)?J:[]).map(de=>({month:Number(de.month??0),amount:Number(de.amount??0)}));pe.push(...re)}catch{}}));const G=new Array(12).fill(0);for(const ae of pe){const ie=Math.min(12,Math.max(1,Number(ae.month)||0))-1;G[ie]+=Number.isFinite(ae.amount)?Number(ae.amount):0}L(G)}catch(K){X(K.message||"조회 중 오류가 발생했습니다"),L(new Array(12).fill(0))}finally{R(!1)}}p.useEffect(()=>{w==="init"&&te()},[w,N==null?void 0:N.customerSeq,H]);async function $(){if(!(N!=null&&N.customerSeq)){F({loading:!1,hasRecent:void 0,error:null});return}F({loading:!0,hasRecent:void 0,error:null});try{const K=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);K.searchParams.set("custSeq",String(N.customerSeq)),K.searchParams.set("years","2");const ne=await fetch(K.toString());if(!ne.ok){let ae=`HTTP ${ne.status}`;try{const ie=await ne.json();ie!=null&&ie.error&&(ae=ie.error)}catch{}throw new Error(ae)}const pe=await ne.json(),G=Array.isArray(pe)&&pe.some(ae=>Number((ae==null?void 0:ae.customerSeq)||(ae==null?void 0:ae.customerSeqText)||0)===Number(N.customerSeq)&&!!(ae!=null&&ae.hasRecent));F({loading:!1,hasRecent:G,error:null})}catch(K){F({loading:!1,hasRecent:void 0,error:K.message||"오류"})}}p.useEffect(()=>{w==="init"&&$()},[w,N==null?void 0:N.customerSeq]);const W=p.useMemo(()=>r.jsx("div",{className:"table-container",style:{border:"1px solid var(--border)",borderRadius:8,marginTop:8},children:r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsx("tr",{children:Array.from({length:12},(K,ne)=>r.jsxs("th",{style:{width:100,textAlign:"right"},children:[String(ne+1).padStart(2,"0"),"월"]},ne))})}),r.jsx("tbody",{children:r.jsx("tr",{children:M.map((K,ne)=>r.jsx("td",{style:{textAlign:"right"},children:Math.round(K).toLocaleString()},ne))})})]})}),[M]);async function U(){u(null),c(!0);try{const K=localStorage.getItem("tnt.sales.empId");if(!K){h([]),u(zt.loginRequired);return}const ne=new URL("/api/v1/customers",window.location.origin);ne.searchParams.set("mineOnly","true"),ne.searchParams.set("empId",K);const pe=await fetch(ne.toString());if(!pe.ok){let ie=`HTTP ${pe.status}`;try{const J=await pe.json();J!=null&&J.error&&(ie=J.error)}catch{const J=await pe.text();J&&(ie=J)}throw new Error(ie)}const G=await pe.json(),ae=Array.isArray(G)?G:[];h(ae);try{const ie=ae.map(J=>Number(J.customerSeq||0)).filter(J=>Number.isFinite(J)&&J>0);if(ie.length>0){const J=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);J.searchParams.set("custSeq",Array.from(new Set(ie)).join(",")),J.searchParams.set("years","2");const re=await fetch(J.toString());if(re.ok){const de=await re.json(),he={};Array.isArray(de)&&de.forEach(oe=>{const V=Number((oe==null?void 0:oe.customerSeq)||(oe==null?void 0:oe.customerSeqText)||0);Number.isFinite(V)&&(he[V]=!!(oe!=null&&oe.hasRecent))}),O(he)}else O({})}else O({})}catch{O({})}}catch(K){u(K.message||"조회 중 오류가 발생했습니다")}finally{c(!1)}}p.useEffect(()=>{U()},[]),p.useEffect(()=>{if(!b.open)return;const K=()=>j({open:!1,x:0,y:0});return window.addEventListener("click",K),()=>window.removeEventListener("click",K)},[b.open]),p.useEffect(()=>{if(!b.open)return;const K=ne=>{ne.key==="Escape"&&j({open:!1,x:0,y:0})};return window.addEventListener("keydown",K),()=>window.removeEventListener("keydown",K)},[b.open]),p.useEffect(()=>{const K=ne=>{((ne==null?void 0:ne.key)==="Escape"||(ne==null?void 0:ne.key)==="Esc"||(ne==null?void 0:ne.keyCode)===27)&&(j({open:!1,x:0,y:0}),A({open:!1,x:0,y:0}))};return document.addEventListener("keydown",K,!0),()=>document.removeEventListener("keydown",K,!0)},[]);async function Z(K,ne){K.preventDefault(),K.stopPropagation(),j({open:!1,x:0,y:0});const pe=K.clientX,G=K.clientY;A({open:!0,x:pe,y:G,row:ne,loading:!1,error:null,data:[]})}const ee=p.useMemo(()=>{var K,ne,pe,G,ae,ie,J,re,de,he,oe,V,Pe,Ve,tt;return r.jsx(r.Fragment,{children:r.jsxs("div",{className:"table-container",onClick:()=>j({open:!1,x:0,y:0}),style:{height:"100%",overflow:"auto"},children:[f.length===0?r.jsx("div",{className:"empty-state",children:zt.empty}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsx("tr",{children:r.jsx("th",{style:{width:"auto"},children:"거래처명"})})}),r.jsx("tbody",{children:f.map((ot,ht)=>r.jsx("tr",{onClick:vt=>{vt.preventDefault(),vt.stopPropagation(),C(ot),A({open:!1,x:0,y:0})},onContextMenu:vt=>Z(vt,ot),"aria-selected":(N==null?void 0:N.customerId)===ot.customerId?!0:void 0,style:(N==null?void 0:N.customerId)===ot.customerId?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:r.jsx("td",{children:(()=>{const vt=Number(ot.customerSeq||0);return I[vt]?r.jsxs("span",{children:[ot.customerName," "," ","$"]}):ot.customerName})()})},ht))})]}),v.open&&r.jsxs("div",{className:"context-menu",style:{left:v.x+6,top:v.y+6,maxWidth:420,padding:8},onClick:ot=>ot.stopPropagation(),children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 상세"}),v.error?r.jsx("div",{className:"error",style:{maxWidth:380},children:v.error}):r.jsx("table",{className:"table",style:{width:"100%"},children:r.jsxs("tbody",{children:[r.jsxs("tr",{children:[r.jsx("th",{style:{width:110,textAlign:"left"},children:"거래처번호"}),r.jsx("td",{children:((K=v.row)==null?void 0:K.customerId)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"사업자번호"}),r.jsx("td",{children:((ne=v.row)==null?void 0:ne.bizNo)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"대표자명"}),r.jsx("td",{children:((pe=v.row)==null?void 0:pe.ownerName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"업태"}),r.jsx("td",{children:((G=v.row)==null?void 0:G.bizKind)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"종목"}),r.jsx("td",{children:((ae=v.row)==null?void 0:ae.bizType)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"전화번호"}),r.jsx("td",{children:((ie=v.row)==null?void 0:ie.telNo)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"담당자명"}),r.jsx("td",{children:((J=v.row)==null?void 0:J.empName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"부서명"}),r.jsx("td",{children:((re=v.row)==null?void 0:re.deptName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"시/도"}),r.jsx("td",{children:((de=v.row)==null?void 0:de.addrProvinceName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"시/군/구"}),r.jsx("td",{children:((he=v.row)==null?void 0:he.addrCityName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"고객유형"}),r.jsx("td",{children:((oe=v.row)==null?void 0:oe.customerTypeName)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"비고"}),r.jsx("td",{children:((V=v.row)==null?void 0:V.customerRemark)||""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"생성자"}),r.jsx("td",{children:((Pe=v.row)==null?void 0:Pe.createdBy)??""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"수정자"}),r.jsx("td",{children:((Ve=v.row)==null?void 0:Ve.updatedBy)??""})]}),r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left"},children:"생성일시"}),r.jsx("td",{children:m_((tt=v.row)==null?void 0:tt.createdAt)})]})]})})]})]})})},[f,b,y,v,N,I]);return r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"목표 Simulation"}),r.jsxs("div",{className:"muted count-text",children:[f.length.toLocaleString(),"개 거래처"]})]}),d&&r.jsx("div",{className:"error",children:d||zt.errorGeneric}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[r.jsx("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:ee}),r.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:(()=>{const K=[];for(let ne=0;ne<S.length;ne++){const pe=S[ne],G=ne<k,ae=ne===k;K.push(r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:ne===S.length-1?"0 0 auto":"1 1 0"},children:[r.jsx("div",{title:pe.label,onClick:()=>_(pe.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:G||ae?"var(--accent)":"transparent",border:`2px solid ${G||ae?"var(--accent)":"var(--border)"}`,color:G||ae?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":ae?"step":void 0,children:G?"✓":ne+1}),r.jsx("div",{style:{fontSize:12,color:ae||G?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:pe.label}),ne<S.length-1&&r.jsx("div",{style:{height:2,background:ne<k?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},pe.key))}return K})()}),r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("button",{className:"btn btn-icon",onClick:D,disabled:k===0,"aria-label":"이전 단계",title:"이전 단계",children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:r.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),r.jsx("button",{className:"btn btn-icon",onClick:T,disabled:k===S.length-1,"aria-label":"다음 단계",title:"다음 단계",children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:r.jsx("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),w==="init"&&r.jsxs("section",{style:{marginTop:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:10},children:[r.jsx("b",{children:"기준매출"}),r.jsxs("select",{value:H,onChange:K=>q(K.target.value),style:{height:28,padding:"4px 8px",borderRadius:8,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12},"aria-label":"기준 기간 선택",children:[r.jsx("option",{value:"prev1",children:"전년"}),r.jsx("option",{value:"last2",children:"최근2년"}),r.jsx("option",{value:"last3",children:"최근3년"})]})]}),Y&&r.jsx("span",{className:"error",children:Y})]}),P?r.jsx("div",{className:"empty-state",style:{marginTop:8},children:"불러오는 중…"}):W]})]})]})]})}const y_="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M12%201v22'/%3e%3cpath%20d='M17%205H9.5a3.5%203.5%200%200%200%200%207H14a3.5%203.5%200%200%201%200%207H6'/%3e%3c/svg%3e",x_="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpolyline%20points='3%2017%209%2011%2013%2015%2021%207'%20/%3e%3ccircle%20cx='21'%20cy='7'%20r='1'%20/%3e%3c/svg%3e";function v_(e,n){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var s,a,o,l,c=[],d=!0,u=!1;try{if(o=(i=i.call(e)).next,n===0){if(Object(i)!==i)return;d=!1}else for(;!(d=(s=o.call(i)).done)&&(c.push(s.value),c.length!==n);d=!0);}catch(f){u=!0,a=f}finally{try{if(!d&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(u)throw a}}return c}}function b_(e,n,i){return n=A_(n),n in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function Dg(e,n){return S_(e)||v_(e,n)||Xv(e,n)||__()}function j_(e){return w_(e)||k_(e)||Xv(e)||N_()}function w_(e){if(Array.isArray(e))return _f(e)}function S_(e){if(Array.isArray(e))return e}function k_(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Xv(e,n){if(e){if(typeof e=="string")return _f(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);if(i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set")return Array.from(e);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return _f(e,n)}}function _f(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,s=new Array(n);i<n;i++)s[i]=e[i];return s}function N_(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function __(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function C_(e,n){if(typeof e!="object"||e===null)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function A_(e){var n=C_(e,"string");return typeof n=="symbol"?n:String(n)}var I_=function(n,i){var s=new Set(i);return Object.assign.apply(Object,[{}].concat(j_(Object.entries(n).filter(function(a){var o=Dg(a,1),l=o[0];return!s.has(l)}).map(function(a){var o=Dg(a,2),l=o[0],c=o[1];return b_({},l,c)}))))};function Cf(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,s=Array(n);i<n;i++)s[i]=e[i];return s}function T_(e){if(Array.isArray(e))return e}function E_(e){if(Array.isArray(e))return Cf(e)}function P_(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function O_(e,n){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var s,a,o,l,c=[],d=!0,u=!1;try{if(o=(i=i.call(e)).next,n!==0)for(;!(d=(s=o.call(i)).done)&&(c.push(s.value),c.length!==n);d=!0);}catch(f){u=!0,a=f}finally{try{if(!d&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(u)throw a}}return c}}function D_(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function z_(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function M_(e,n){return T_(e)||O_(e,n)||Qv(e,n)||D_()}function zg(e){return E_(e)||P_(e)||Qv(e)||z_()}function Qv(e,n){if(e){if(typeof e=="string")return Cf(e,n);var i={}.toString.call(e).slice(8,-1);return i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set"?Array.from(e):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Cf(e,n):void 0}}function R_(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.wrapperElementType,s=i===void 0?"div":i,a=n.nodeMapper,o=a===void 0?function(f){return f}:a,l=n.methodNames,c=l===void 0?[]:l,d=n.initPropNames,u=d===void 0?[]:d;return p.forwardRef(function(f,h){var m=p.useRef(),g=p.useMemo(function(){var y=Object.fromEntries(u.filter(function(x){return f.hasOwnProperty(x)}).map(function(x){return[x,f[x]]}));return e(y)},[]);Mg(function(){g(o(m.current))},p.useLayoutEffect),Mg(function(){return g._destructor instanceof Function?g._destructor:void 0});var b=p.useCallback(function(y){for(var x=arguments.length,v=new Array(x>1?x-1:0),A=1;A<x;A++)v[A-1]=arguments[A];return g[y]instanceof Function?g[y].apply(g,v):void 0},[g]),j=p.useRef({});return Object.keys(I_(f,[].concat(zg(c),zg(u)))).filter(function(y){return j.current[y]!==f[y]}).forEach(function(y){return b(y,f[y])}),j.current=f,p.useImperativeHandle(h,function(){return Object.fromEntries(c.map(function(y){return[y,function(){for(var x=arguments.length,v=new Array(x),A=0;A<x;A++)v[A]=arguments[A];return b.apply(void 0,[y].concat(v))}]}))},[b]),Be.createElement(s,{ref:m})})}function Mg(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:p.useEffect,i=p.useRef(),s=p.useRef(!1),a=p.useRef(!1),o=p.useState(0),l=M_(o,2);l[0];var c=l[1];s.current&&(a.current=!0),n(function(){return s.current||(i.current=e(),s.current=!0),c(function(d){return d+1}),function(){a.current&&i.current&&i.current()}},[])}var Af="http://www.w3.org/1999/xhtml";const Rg={svg:"http://www.w3.org/2000/svg",xhtml:Af,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function md(e){var n=e+="",i=n.indexOf(":");return i>=0&&(n=e.slice(0,i))!=="xmlns"&&(e=e.slice(i+1)),Rg.hasOwnProperty(n)?{space:Rg[n],local:e}:e}function $_(e){return function(){var n=this.ownerDocument,i=this.namespaceURI;return i===Af&&n.documentElement.namespaceURI===Af?n.createElement(e):n.createElementNS(i,e)}}function L_(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Jv(e){var n=md(e);return(n.local?L_:$_)(n)}function W_(){}function Hh(e){return e==null?W_:function(){return this.querySelector(e)}}function B_(e){typeof e!="function"&&(e=Hh(e));for(var n=this._groups,i=n.length,s=new Array(i),a=0;a<i;++a)for(var o=n[a],l=o.length,c=s[a]=new Array(l),d,u,f=0;f<l;++f)(d=o[f])&&(u=e.call(d,d.__data__,f,o))&&("__data__"in d&&(u.__data__=d.__data__),c[f]=u);return new gr(s,this._parents)}function F_(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function q_(){return[]}function Zv(e){return e==null?q_:function(){return this.querySelectorAll(e)}}function U_(e){return function(){return F_(e.apply(this,arguments))}}function H_(e){typeof e=="function"?e=U_(e):e=Zv(e);for(var n=this._groups,i=n.length,s=[],a=[],o=0;o<i;++o)for(var l=n[o],c=l.length,d,u=0;u<c;++u)(d=l[u])&&(s.push(e.call(d,d.__data__,u,l)),a.push(d));return new gr(s,a)}function eb(e){return function(){return this.matches(e)}}function tb(e){return function(n){return n.matches(e)}}var Y_=Array.prototype.find;function K_(e){return function(){return Y_.call(this.children,e)}}function G_(){return this.firstElementChild}function V_(e){return this.select(e==null?G_:K_(typeof e=="function"?e:tb(e)))}var X_=Array.prototype.filter;function Q_(){return Array.from(this.children)}function J_(e){return function(){return X_.call(this.children,e)}}function Z_(e){return this.selectAll(e==null?Q_:J_(typeof e=="function"?e:tb(e)))}function eC(e){typeof e!="function"&&(e=eb(e));for(var n=this._groups,i=n.length,s=new Array(i),a=0;a<i;++a)for(var o=n[a],l=o.length,c=s[a]=[],d,u=0;u<l;++u)(d=o[u])&&e.call(d,d.__data__,u,o)&&c.push(d);return new gr(s,this._parents)}function nb(e){return new Array(e.length)}function tC(){return new gr(this._enter||this._groups.map(nb),this._parents)}function fc(e,n){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=n}fc.prototype={constructor:fc,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,n){return this._parent.insertBefore(e,n)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function nC(e){return function(){return e}}function rC(e,n,i,s,a,o){for(var l=0,c,d=n.length,u=o.length;l<u;++l)(c=n[l])?(c.__data__=o[l],s[l]=c):i[l]=new fc(e,o[l]);for(;l<d;++l)(c=n[l])&&(a[l]=c)}function iC(e,n,i,s,a,o,l){var c,d,u=new Map,f=n.length,h=o.length,m=new Array(f),g;for(c=0;c<f;++c)(d=n[c])&&(m[c]=g=l.call(d,d.__data__,c,n)+"",u.has(g)?a[c]=d:u.set(g,d));for(c=0;c<h;++c)g=l.call(e,o[c],c,o)+"",(d=u.get(g))?(s[c]=d,d.__data__=o[c],u.delete(g)):i[c]=new fc(e,o[c]);for(c=0;c<f;++c)(d=n[c])&&u.get(m[c])===d&&(a[c]=d)}function sC(e){return e.__data__}function aC(e,n){if(!arguments.length)return Array.from(this,sC);var i=n?iC:rC,s=this._parents,a=this._groups;typeof e!="function"&&(e=nC(e));for(var o=a.length,l=new Array(o),c=new Array(o),d=new Array(o),u=0;u<o;++u){var f=s[u],h=a[u],m=h.length,g=oC(e.call(f,f&&f.__data__,u,s)),b=g.length,j=c[u]=new Array(b),y=l[u]=new Array(b),x=d[u]=new Array(m);i(f,h,j,y,x,g,n);for(var v=0,A=0,N,C;v<b;++v)if(N=j[v]){for(v>=A&&(A=v+1);!(C=y[A])&&++A<b;);N._next=C||null}}return l=new gr(l,s),l._enter=c,l._exit=d,l}function oC(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function lC(){return new gr(this._exit||this._groups.map(nb),this._parents)}function cC(e,n,i){var s=this.enter(),a=this,o=this.exit();return typeof e=="function"?(s=e(s),s&&(s=s.selection())):s=s.append(e+""),n!=null&&(a=n(a),a&&(a=a.selection())),i==null?o.remove():i(o),s&&a?s.merge(a).order():a}function dC(e){for(var n=e.selection?e.selection():e,i=this._groups,s=n._groups,a=i.length,o=s.length,l=Math.min(a,o),c=new Array(a),d=0;d<l;++d)for(var u=i[d],f=s[d],h=u.length,m=c[d]=new Array(h),g,b=0;b<h;++b)(g=u[b]||f[b])&&(m[b]=g);for(;d<a;++d)c[d]=i[d];return new gr(c,this._parents)}function uC(){for(var e=this._groups,n=-1,i=e.length;++n<i;)for(var s=e[n],a=s.length-1,o=s[a],l;--a>=0;)(l=s[a])&&(o&&l.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(l,o),o=l);return this}function fC(e){e||(e=hC);function n(h,m){return h&&m?e(h.__data__,m.__data__):!h-!m}for(var i=this._groups,s=i.length,a=new Array(s),o=0;o<s;++o){for(var l=i[o],c=l.length,d=a[o]=new Array(c),u,f=0;f<c;++f)(u=l[f])&&(d[f]=u);d.sort(n)}return new gr(a,this._parents).order()}function hC(e,n){return e<n?-1:e>n?1:e>=n?0:NaN}function pC(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function mC(){return Array.from(this)}function gC(){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var s=e[n],a=0,o=s.length;a<o;++a){var l=s[a];if(l)return l}return null}function yC(){let e=0;for(const n of this)++e;return e}function xC(){return!this.node()}function vC(e){for(var n=this._groups,i=0,s=n.length;i<s;++i)for(var a=n[i],o=0,l=a.length,c;o<l;++o)(c=a[o])&&e.call(c,c.__data__,o,a);return this}function bC(e){return function(){this.removeAttribute(e)}}function jC(e){return function(){this.removeAttributeNS(e.space,e.local)}}function wC(e,n){return function(){this.setAttribute(e,n)}}function SC(e,n){return function(){this.setAttributeNS(e.space,e.local,n)}}function kC(e,n){return function(){var i=n.apply(this,arguments);i==null?this.removeAttribute(e):this.setAttribute(e,i)}}function NC(e,n){return function(){var i=n.apply(this,arguments);i==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,i)}}function _C(e,n){var i=md(e);if(arguments.length<2){var s=this.node();return i.local?s.getAttributeNS(i.space,i.local):s.getAttribute(i)}return this.each((n==null?i.local?jC:bC:typeof n=="function"?i.local?NC:kC:i.local?SC:wC)(i,n))}function rb(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function CC(e){return function(){this.style.removeProperty(e)}}function AC(e,n,i){return function(){this.style.setProperty(e,n,i)}}function IC(e,n,i){return function(){var s=n.apply(this,arguments);s==null?this.style.removeProperty(e):this.style.setProperty(e,s,i)}}function TC(e,n,i){return arguments.length>1?this.each((n==null?CC:typeof n=="function"?IC:AC)(e,n,i??"")):ma(this.node(),e)}function ma(e,n){return e.style.getPropertyValue(n)||rb(e).getComputedStyle(e,null).getPropertyValue(n)}function EC(e){return function(){delete this[e]}}function PC(e,n){return function(){this[e]=n}}function OC(e,n){return function(){var i=n.apply(this,arguments);i==null?delete this[e]:this[e]=i}}function DC(e,n){return arguments.length>1?this.each((n==null?EC:typeof n=="function"?OC:PC)(e,n)):this.node()[e]}function ib(e){return e.trim().split(/^|\s+/)}function Yh(e){return e.classList||new sb(e)}function sb(e){this._node=e,this._names=ib(e.getAttribute("class")||"")}sb.prototype={add:function(e){var n=this._names.indexOf(e);n<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var n=this._names.indexOf(e);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function ab(e,n){for(var i=Yh(e),s=-1,a=n.length;++s<a;)i.add(n[s])}function ob(e,n){for(var i=Yh(e),s=-1,a=n.length;++s<a;)i.remove(n[s])}function zC(e){return function(){ab(this,e)}}function MC(e){return function(){ob(this,e)}}function RC(e,n){return function(){(n.apply(this,arguments)?ab:ob)(this,e)}}function $C(e,n){var i=ib(e+"");if(arguments.length<2){for(var s=Yh(this.node()),a=-1,o=i.length;++a<o;)if(!s.contains(i[a]))return!1;return!0}return this.each((typeof n=="function"?RC:n?zC:MC)(i,n))}function LC(){this.textContent=""}function WC(e){return function(){this.textContent=e}}function BC(e){return function(){var n=e.apply(this,arguments);this.textContent=n??""}}function FC(e){return arguments.length?this.each(e==null?LC:(typeof e=="function"?BC:WC)(e)):this.node().textContent}function qC(){this.innerHTML=""}function UC(e){return function(){this.innerHTML=e}}function HC(e){return function(){var n=e.apply(this,arguments);this.innerHTML=n??""}}function YC(e){return arguments.length?this.each(e==null?qC:(typeof e=="function"?HC:UC)(e)):this.node().innerHTML}function KC(){this.nextSibling&&this.parentNode.appendChild(this)}function GC(){return this.each(KC)}function VC(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function XC(){return this.each(VC)}function QC(e){var n=typeof e=="function"?e:Jv(e);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function JC(){return null}function ZC(e,n){var i=typeof e=="function"?e:Jv(e),s=n==null?JC:typeof n=="function"?n:Hh(n);return this.select(function(){return this.insertBefore(i.apply(this,arguments),s.apply(this,arguments)||null)})}function eA(){var e=this.parentNode;e&&e.removeChild(this)}function tA(){return this.each(eA)}function nA(){var e=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function rA(){var e=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(e,this.nextSibling):e}function iA(e){return this.select(e?rA:nA)}function sA(e){return arguments.length?this.property("__data__",e):this.node().__data__}function aA(e){return function(n){e.call(this,n,this.__data__)}}function oA(e){return e.trim().split(/^|\s+/).map(function(n){var i="",s=n.indexOf(".");return s>=0&&(i=n.slice(s+1),n=n.slice(0,s)),{type:n,name:i}})}function lA(e){return function(){var n=this.__on;if(n){for(var i=0,s=-1,a=n.length,o;i<a;++i)o=n[i],(!e.type||o.type===e.type)&&o.name===e.name?this.removeEventListener(o.type,o.listener,o.options):n[++s]=o;++s?n.length=s:delete this.__on}}}function cA(e,n,i){return function(){var s=this.__on,a,o=aA(n);if(s){for(var l=0,c=s.length;l<c;++l)if((a=s[l]).type===e.type&&a.name===e.name){this.removeEventListener(a.type,a.listener,a.options),this.addEventListener(a.type,a.listener=o,a.options=i),a.value=n;return}}this.addEventListener(e.type,o,i),a={type:e.type,name:e.name,value:n,listener:o,options:i},s?s.push(a):this.__on=[a]}}function dA(e,n,i){var s=oA(e+""),a,o=s.length,l;if(arguments.length<2){var c=this.node().__on;if(c){for(var d=0,u=c.length,f;d<u;++d)for(a=0,f=c[d];a<o;++a)if((l=s[a]).type===f.type&&l.name===f.name)return f.value}return}for(c=n?cA:lA,a=0;a<o;++a)this.each(c(s[a],n,i));return this}function lb(e,n,i){var s=rb(e),a=s.CustomEvent;typeof a=="function"?a=new a(n,i):(a=s.document.createEvent("Event"),i?(a.initEvent(n,i.bubbles,i.cancelable),a.detail=i.detail):a.initEvent(n,!1,!1)),e.dispatchEvent(a)}function uA(e,n){return function(){return lb(this,e,n)}}function fA(e,n){return function(){return lb(this,e,n.apply(this,arguments))}}function hA(e,n){return this.each((typeof n=="function"?fA:uA)(e,n))}function*pA(){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var s=e[n],a=0,o=s.length,l;a<o;++a)(l=s[a])&&(yield l)}var cb=[null];function gr(e,n){this._groups=e,this._parents=n}function Ho(){return new gr([[document.documentElement]],cb)}function mA(){return this}gr.prototype=Ho.prototype={constructor:gr,select:B_,selectAll:H_,selectChild:V_,selectChildren:Z_,filter:eC,data:aC,enter:tC,exit:lC,join:cC,merge:dC,selection:mA,order:uC,sort:fC,call:pC,nodes:mC,node:gC,size:yC,empty:xC,each:vC,attr:_C,style:TC,property:DC,classed:$C,text:FC,html:YC,raise:GC,lower:XC,append:QC,insert:ZC,remove:tA,clone:iA,datum:sA,on:dA,dispatch:hA,[Symbol.iterator]:pA};function Cr(e){return typeof e=="string"?new gr([[document.querySelector(e)]],[document.documentElement]):new gr([[e]],cb)}function gA(e){let n;for(;n=e.sourceEvent;)e=n;return e}function Jr(e,n){if(e=gA(e),n===void 0&&(n=e.currentTarget),n){var i=n.ownerSVGElement||n;if(i.createSVGPoint){var s=i.createSVGPoint();return s.x=e.clientX,s.y=e.clientY,s=s.matrixTransform(n.getScreenCTM().inverse()),[s.x,s.y]}if(n.getBoundingClientRect){var a=n.getBoundingClientRect();return[e.clientX-a.left-n.clientLeft,e.clientY-a.top-n.clientTop]}}return[e.pageX,e.pageY]}var yA={value:()=>{}};function Yo(){for(var e=0,n=arguments.length,i={},s;e<n;++e){if(!(s=arguments[e]+"")||s in i||/[\s.]/.test(s))throw new Error("illegal type: "+s);i[s]=[]}return new nc(i)}function nc(e){this._=e}function xA(e,n){return e.trim().split(/^|\s+/).map(function(i){var s="",a=i.indexOf(".");if(a>=0&&(s=i.slice(a+1),i=i.slice(0,a)),i&&!n.hasOwnProperty(i))throw new Error("unknown type: "+i);return{type:i,name:s}})}nc.prototype=Yo.prototype={constructor:nc,on:function(e,n){var i=this._,s=xA(e+"",i),a,o=-1,l=s.length;if(arguments.length<2){for(;++o<l;)if((a=(e=s[o]).type)&&(a=vA(i[a],e.name)))return a;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<l;)if(a=(e=s[o]).type)i[a]=$g(i[a],e.name,n);else if(n==null)for(a in i)i[a]=$g(i[a],e.name,null);return this},copy:function(){var e={},n=this._;for(var i in n)e[i]=n[i].slice();return new nc(e)},call:function(e,n){if((a=arguments.length-2)>0)for(var i=new Array(a),s=0,a,o;s<a;++s)i[s]=arguments[s+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(o=this._[e],s=0,a=o.length;s<a;++s)o[s].value.apply(n,i)},apply:function(e,n,i){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var s=this._[e],a=0,o=s.length;a<o;++a)s[a].value.apply(n,i)}};function vA(e,n){for(var i=0,s=e.length,a;i<s;++i)if((a=e[i]).name===n)return a.value}function $g(e,n,i){for(var s=0,a=e.length;s<a;++s)if(e[s].name===n){e[s]=yA,e=e.slice(0,s).concat(e.slice(s+1));break}return i!=null&&e.push({name:n,value:i}),e}const bA={passive:!1},_o={capture:!0,passive:!1};function Du(e){e.stopImmediatePropagation()}function ca(e){e.preventDefault(),e.stopImmediatePropagation()}function db(e){var n=e.document.documentElement,i=Cr(e).on("dragstart.drag",ca,_o);"onselectstart"in n?i.on("selectstart.drag",ca,_o):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function ub(e,n){var i=e.document.documentElement,s=Cr(e).on("dragstart.drag",null);n&&(s.on("click.drag",ca,_o),setTimeout(function(){s.on("click.drag",null)},0)),"onselectstart"in i?s.on("selectstart.drag",null):(i.style.MozUserSelect=i.__noselect,delete i.__noselect)}const jl=e=>()=>e;function If(e,{sourceEvent:n,subject:i,target:s,identifier:a,active:o,x:l,y:c,dx:d,dy:u,dispatch:f}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},subject:{value:i,enumerable:!0,configurable:!0},target:{value:s,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:l,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:d,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:f}})}If.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function jA(e){return!e.ctrlKey&&!e.button}function wA(){return this.parentNode}function SA(e,n){return n??{x:e.x,y:e.y}}function kA(){return navigator.maxTouchPoints||"ontouchstart"in this}function NA(){var e=jA,n=wA,i=SA,s=kA,a={},o=Yo("start","drag","end"),l=0,c,d,u,f,h=0;function m(N){N.on("mousedown.drag",g).filter(s).on("touchstart.drag",y).on("touchmove.drag",x,bA).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(N,C){if(!(f||!e.call(this,N,C))){var w=A(this,n.call(this,N,C),N,C,"mouse");w&&(Cr(N.view).on("mousemove.drag",b,_o).on("mouseup.drag",j,_o),db(N.view),Du(N),u=!1,c=N.clientX,d=N.clientY,w("start",N))}}function b(N){if(ca(N),!u){var C=N.clientX-c,w=N.clientY-d;u=C*C+w*w>h}a.mouse("drag",N)}function j(N){Cr(N.view).on("mousemove.drag mouseup.drag",null),ub(N.view,u),ca(N),a.mouse("end",N)}function y(N,C){if(e.call(this,N,C)){var w=N.changedTouches,_=n.call(this,N,C),I=w.length,O,E;for(O=0;O<I;++O)(E=A(this,_,N,C,w[O].identifier,w[O]))&&(Du(N),E("start",N,w[O]))}}function x(N){var C=N.changedTouches,w=C.length,_,I;for(_=0;_<w;++_)(I=a[C[_].identifier])&&(ca(N),I("drag",N,C[_]))}function v(N){var C=N.changedTouches,w=C.length,_,I;for(f&&clearTimeout(f),f=setTimeout(function(){f=null},500),_=0;_<w;++_)(I=a[C[_].identifier])&&(Du(N),I("end",N,C[_]))}function A(N,C,w,_,I,O){var E=o.copy(),S=Jr(O||w,C),k,D,T;if((T=i.call(N,new If("beforestart",{sourceEvent:w,target:m,identifier:I,active:l,x:S[0],y:S[1],dx:0,dy:0,dispatch:E}),_))!=null)return k=T.x-S[0]||0,D=T.y-S[1]||0,function P(R,Y,X){var H=S,q;switch(R){case"start":a[I]=P,q=l++;break;case"end":delete a[I],--l;case"drag":S=Jr(X||Y,C),q=l;break}E.call(R,N,new If(R,{sourceEvent:Y,subject:T,target:m,identifier:I,active:q,x:S[0]+k,y:S[1]+D,dx:S[0]-H[0],dy:S[1]-H[1],dispatch:E}),_)}}return m.filter=function(N){return arguments.length?(e=typeof N=="function"?N:jl(!!N),m):e},m.container=function(N){return arguments.length?(n=typeof N=="function"?N:jl(N),m):n},m.subject=function(N){return arguments.length?(i=typeof N=="function"?N:jl(N),m):i},m.touchable=function(N){return arguments.length?(s=typeof N=="function"?N:jl(!!N),m):s},m.on=function(){var N=o.on.apply(o,arguments);return N===o?m:N},m.clickDistance=function(N){return arguments.length?(h=(N=+N)*N,m):Math.sqrt(h)},m}function Kh(e,n,i){e.prototype=n.prototype=i,i.constructor=e}function fb(e,n){var i=Object.create(e.prototype);for(var s in n)i[s]=n[s];return i}function Ko(){}var Co=.7,hc=1/Co,da="\\s*([+-]?\\d+)\\s*",Ao="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ri="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_A=/^#([0-9a-f]{3,8})$/,CA=new RegExp(`^rgb\\(${da},${da},${da}\\)$`),AA=new RegExp(`^rgb\\(${ri},${ri},${ri}\\)$`),IA=new RegExp(`^rgba\\(${da},${da},${da},${Ao}\\)$`),TA=new RegExp(`^rgba\\(${ri},${ri},${ri},${Ao}\\)$`),EA=new RegExp(`^hsl\\(${Ao},${ri},${ri}\\)$`),PA=new RegExp(`^hsla\\(${Ao},${ri},${ri},${Ao}\\)$`),Lg={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Kh(Ko,Os,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Wg,formatHex:Wg,formatHex8:OA,formatHsl:DA,formatRgb:Bg,toString:Bg});function Wg(){return this.rgb().formatHex()}function OA(){return this.rgb().formatHex8()}function DA(){return hb(this).formatHsl()}function Bg(){return this.rgb().formatRgb()}function Os(e){var n,i;return e=(e+"").trim().toLowerCase(),(n=_A.exec(e))?(i=n[1].length,n=parseInt(n[1],16),i===6?Fg(n):i===3?new rr(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):i===8?wl(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):i===4?wl(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=CA.exec(e))?new rr(n[1],n[2],n[3],1):(n=AA.exec(e))?new rr(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=IA.exec(e))?wl(n[1],n[2],n[3],n[4]):(n=TA.exec(e))?wl(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=EA.exec(e))?Hg(n[1],n[2]/100,n[3]/100,1):(n=PA.exec(e))?Hg(n[1],n[2]/100,n[3]/100,n[4]):Lg.hasOwnProperty(e)?Fg(Lg[e]):e==="transparent"?new rr(NaN,NaN,NaN,0):null}function Fg(e){return new rr(e>>16&255,e>>8&255,e&255,1)}function wl(e,n,i,s){return s<=0&&(e=n=i=NaN),new rr(e,n,i,s)}function zA(e){return e instanceof Ko||(e=Os(e)),e?(e=e.rgb(),new rr(e.r,e.g,e.b,e.opacity)):new rr}function Tf(e,n,i,s){return arguments.length===1?zA(e):new rr(e,n,i,s??1)}function rr(e,n,i,s){this.r=+e,this.g=+n,this.b=+i,this.opacity=+s}Kh(rr,Tf,fb(Ko,{brighter(e){return e=e==null?hc:Math.pow(hc,e),new rr(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Co:Math.pow(Co,e),new rr(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new rr(Cs(this.r),Cs(this.g),Cs(this.b),pc(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qg,formatHex:qg,formatHex8:MA,formatRgb:Ug,toString:Ug}));function qg(){return`#${Ss(this.r)}${Ss(this.g)}${Ss(this.b)}`}function MA(){return`#${Ss(this.r)}${Ss(this.g)}${Ss(this.b)}${Ss((isNaN(this.opacity)?1:this.opacity)*255)}`}function Ug(){const e=pc(this.opacity);return`${e===1?"rgb(":"rgba("}${Cs(this.r)}, ${Cs(this.g)}, ${Cs(this.b)}${e===1?")":`, ${e})`}`}function pc(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Cs(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Ss(e){return e=Cs(e),(e<16?"0":"")+e.toString(16)}function Hg(e,n,i,s){return s<=0?e=n=i=NaN:i<=0||i>=1?e=n=NaN:n<=0&&(e=NaN),new Wr(e,n,i,s)}function hb(e){if(e instanceof Wr)return new Wr(e.h,e.s,e.l,e.opacity);if(e instanceof Ko||(e=Os(e)),!e)return new Wr;if(e instanceof Wr)return e;e=e.rgb();var n=e.r/255,i=e.g/255,s=e.b/255,a=Math.min(n,i,s),o=Math.max(n,i,s),l=NaN,c=o-a,d=(o+a)/2;return c?(n===o?l=(i-s)/c+(i<s)*6:i===o?l=(s-n)/c+2:l=(n-i)/c+4,c/=d<.5?o+a:2-o-a,l*=60):c=d>0&&d<1?0:l,new Wr(l,c,d,e.opacity)}function RA(e,n,i,s){return arguments.length===1?hb(e):new Wr(e,n,i,s??1)}function Wr(e,n,i,s){this.h=+e,this.s=+n,this.l=+i,this.opacity=+s}Kh(Wr,RA,fb(Ko,{brighter(e){return e=e==null?hc:Math.pow(hc,e),new Wr(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Co:Math.pow(Co,e),new Wr(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,n=isNaN(e)||isNaN(this.s)?0:this.s,i=this.l,s=i+(i<.5?i:1-i)*n,a=2*i-s;return new rr(zu(e>=240?e-240:e+120,a,s),zu(e,a,s),zu(e<120?e+240:e-120,a,s),this.opacity)},clamp(){return new Wr(Yg(this.h),Sl(this.s),Sl(this.l),pc(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=pc(this.opacity);return`${e===1?"hsl(":"hsla("}${Yg(this.h)}, ${Sl(this.s)*100}%, ${Sl(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Yg(e){return e=(e||0)%360,e<0?e+360:e}function Sl(e){return Math.max(0,Math.min(1,e||0))}function zu(e,n,i){return(e<60?n+(i-n)*e/60:e<180?i:e<240?n+(i-n)*(240-e)/60:n)*255}const Gh=e=>()=>e;function $A(e,n){return function(i){return e+i*n}}function LA(e,n,i){return e=Math.pow(e,i),n=Math.pow(n,i)-e,i=1/i,function(s){return Math.pow(e+s*n,i)}}function WA(e){return(e=+e)==1?pb:function(n,i){return i-n?LA(n,i,e):Gh(isNaN(n)?i:n)}}function pb(e,n){var i=n-e;return i?$A(e,i):Gh(isNaN(e)?n:e)}const mc=function e(n){var i=WA(n);function s(a,o){var l=i((a=Tf(a)).r,(o=Tf(o)).r),c=i(a.g,o.g),d=i(a.b,o.b),u=pb(a.opacity,o.opacity);return function(f){return a.r=l(f),a.g=c(f),a.b=d(f),a.opacity=u(f),a+""}}return s.gamma=e,s}(1);function BA(e,n){n||(n=[]);var i=e?Math.min(n.length,e.length):0,s=n.slice(),a;return function(o){for(a=0;a<i;++a)s[a]=e[a]*(1-o)+n[a]*o;return s}}function FA(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function qA(e,n){var i=n?n.length:0,s=e?Math.min(i,e.length):0,a=new Array(s),o=new Array(i),l;for(l=0;l<s;++l)a[l]=Na(e[l],n[l]);for(;l<i;++l)o[l]=n[l];return function(c){for(l=0;l<s;++l)o[l]=a[l](c);return o}}function UA(e,n){var i=new Date;return e=+e,n=+n,function(s){return i.setTime(e*(1-s)+n*s),i}}function Lr(e,n){return e=+e,n=+n,function(i){return e*(1-i)+n*i}}function HA(e,n){var i={},s={},a;(e===null||typeof e!="object")&&(e={}),(n===null||typeof n!="object")&&(n={});for(a in n)a in e?i[a]=Na(e[a],n[a]):s[a]=n[a];return function(o){for(a in i)s[a]=i[a](o);return s}}var Ef=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Mu=new RegExp(Ef.source,"g");function YA(e){return function(){return e}}function KA(e){return function(n){return e(n)+""}}function mb(e,n){var i=Ef.lastIndex=Mu.lastIndex=0,s,a,o,l=-1,c=[],d=[];for(e=e+"",n=n+"";(s=Ef.exec(e))&&(a=Mu.exec(n));)(o=a.index)>i&&(o=n.slice(i,o),c[l]?c[l]+=o:c[++l]=o),(s=s[0])===(a=a[0])?c[l]?c[l]+=a:c[++l]=a:(c[++l]=null,d.push({i:l,x:Lr(s,a)})),i=Mu.lastIndex;return i<n.length&&(o=n.slice(i),c[l]?c[l]+=o:c[++l]=o),c.length<2?d[0]?KA(d[0].x):YA(n):(n=d.length,function(u){for(var f=0,h;f<n;++f)c[(h=d[f]).i]=h.x(u);return c.join("")})}function Na(e,n){var i=typeof n,s;return n==null||i==="boolean"?Gh(n):(i==="number"?Lr:i==="string"?(s=Os(n))?(n=s,mc):mb:n instanceof Os?mc:n instanceof Date?UA:FA(n)?BA:Array.isArray(n)?qA:typeof n.valueOf!="function"&&typeof n.toString!="function"||isNaN(n)?HA:Lr)(e,n)}function Vh(e,n){return e=+e,n=+n,function(i){return Math.round(e*(1-i)+n*i)}}var Kg=180/Math.PI,Pf={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function gb(e,n,i,s,a,o){var l,c,d;return(l=Math.sqrt(e*e+n*n))&&(e/=l,n/=l),(d=e*i+n*s)&&(i-=e*d,s-=n*d),(c=Math.sqrt(i*i+s*s))&&(i/=c,s/=c,d/=c),e*s<n*i&&(e=-e,n=-n,d=-d,l=-l),{translateX:a,translateY:o,rotate:Math.atan2(n,e)*Kg,skewX:Math.atan(d)*Kg,scaleX:l,scaleY:c}}var kl;function GA(e){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return n.isIdentity?Pf:gb(n.a,n.b,n.c,n.d,n.e,n.f)}function VA(e){return e==null||(kl||(kl=document.createElementNS("http://www.w3.org/2000/svg","g")),kl.setAttribute("transform",e),!(e=kl.transform.baseVal.consolidate()))?Pf:(e=e.matrix,gb(e.a,e.b,e.c,e.d,e.e,e.f))}function yb(e,n,i,s){function a(u){return u.length?u.pop()+" ":""}function o(u,f,h,m,g,b){if(u!==h||f!==m){var j=g.push("translate(",null,n,null,i);b.push({i:j-4,x:Lr(u,h)},{i:j-2,x:Lr(f,m)})}else(h||m)&&g.push("translate("+h+n+m+i)}function l(u,f,h,m){u!==f?(u-f>180?f+=360:f-u>180&&(u+=360),m.push({i:h.push(a(h)+"rotate(",null,s)-2,x:Lr(u,f)})):f&&h.push(a(h)+"rotate("+f+s)}function c(u,f,h,m){u!==f?m.push({i:h.push(a(h)+"skewX(",null,s)-2,x:Lr(u,f)}):f&&h.push(a(h)+"skewX("+f+s)}function d(u,f,h,m,g,b){if(u!==h||f!==m){var j=g.push(a(g)+"scale(",null,",",null,")");b.push({i:j-4,x:Lr(u,h)},{i:j-2,x:Lr(f,m)})}else(h!==1||m!==1)&&g.push(a(g)+"scale("+h+","+m+")")}return function(u,f){var h=[],m=[];return u=e(u),f=e(f),o(u.translateX,u.translateY,f.translateX,f.translateY,h,m),l(u.rotate,f.rotate,h,m),c(u.skewX,f.skewX,h,m),d(u.scaleX,u.scaleY,f.scaleX,f.scaleY,h,m),u=f=null,function(g){for(var b=-1,j=m.length,y;++b<j;)h[(y=m[b]).i]=y.x(g);return h.join("")}}}var XA=yb(GA,"px, ","px)","deg)"),QA=yb(VA,", ",")",")"),JA=1e-12;function Gg(e){return((e=Math.exp(e))+1/e)/2}function ZA(e){return((e=Math.exp(e))-1/e)/2}function e6(e){return((e=Math.exp(2*e))-1)/(e+1)}const t6=function e(n,i,s){function a(o,l){var c=o[0],d=o[1],u=o[2],f=l[0],h=l[1],m=l[2],g=f-c,b=h-d,j=g*g+b*b,y,x;if(j<JA)x=Math.log(m/u)/n,y=function(_){return[c+_*g,d+_*b,u*Math.exp(n*_*x)]};else{var v=Math.sqrt(j),A=(m*m-u*u+s*j)/(2*u*i*v),N=(m*m-u*u-s*j)/(2*m*i*v),C=Math.log(Math.sqrt(A*A+1)-A),w=Math.log(Math.sqrt(N*N+1)-N);x=(w-C)/n,y=function(_){var I=_*x,O=Gg(C),E=u/(i*v)*(O*e6(n*I+C)-ZA(C));return[c+E*g,d+E*b,u*O/Gg(n*I+C)]}}return y.duration=x*1e3*n/Math.SQRT2,y}return a.rho=function(o){var l=Math.max(.001,+o),c=l*l,d=c*c;return e(l,c,d)},a}(Math.SQRT2,2,4);function n6(e,n){n===void 0&&(n=e,e=Na);for(var i=0,s=n.length-1,a=n[0],o=new Array(s<0?0:s);i<s;)o[i]=e(a,a=n[++i]);return function(l){var c=Math.max(0,Math.min(s-1,Math.floor(l*=s)));return o[c](l-c)}}var ga=0,lo=0,Ba=0,xb=1e3,gc,co,yc=0,Ds=0,gd=0,Io=typeof performance=="object"&&performance.now?performance:Date,vb=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Xh(){return Ds||(vb(r6),Ds=Io.now()+gd)}function r6(){Ds=0}function xc(){this._call=this._time=this._next=null}xc.prototype=Qh.prototype={constructor:xc,restart:function(e,n,i){if(typeof e!="function")throw new TypeError("callback is not a function");i=(i==null?Xh():+i)+(n==null?0:+n),!this._next&&co!==this&&(co?co._next=this:gc=this,co=this),this._call=e,this._time=i,Of()},stop:function(){this._call&&(this._call=null,this._time=1/0,Of())}};function Qh(e,n,i){var s=new xc;return s.restart(e,n,i),s}function i6(){Xh(),++ga;for(var e=gc,n;e;)(n=Ds-e._time)>=0&&e._call.call(void 0,n),e=e._next;--ga}function Vg(){Ds=(yc=Io.now())+gd,ga=lo=0;try{i6()}finally{ga=0,a6(),Ds=0}}function s6(){var e=Io.now(),n=e-yc;n>xb&&(gd-=n,yc=e)}function a6(){for(var e,n=gc,i,s=1/0;n;)n._call?(s>n._time&&(s=n._time),e=n,n=n._next):(i=n._next,n._next=null,n=e?e._next=i:gc=i);co=e,Of(s)}function Of(e){if(!ga){lo&&(lo=clearTimeout(lo));var n=e-Ds;n>24?(e<1/0&&(lo=setTimeout(Vg,e-Io.now()-gd)),Ba&&(Ba=clearInterval(Ba))):(Ba||(yc=Io.now(),Ba=setInterval(s6,xb)),ga=1,vb(Vg))}}function Xg(e,n,i){var s=new xc;return n=n==null?0:+n,s.restart(a=>{s.stop(),e(a+n)},n,i),s}var o6=Yo("start","end","cancel","interrupt"),l6=[],bb=0,Qg=1,Df=2,rc=3,Jg=4,zf=5,ic=6;function yd(e,n,i,s,a,o){var l=e.__transition;if(!l)e.__transition={};else if(i in l)return;c6(e,i,{name:n,index:s,group:a,on:o6,tween:l6,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:bb})}function Jh(e,n){var i=Hr(e,n);if(i.state>bb)throw new Error("too late; already scheduled");return i}function li(e,n){var i=Hr(e,n);if(i.state>rc)throw new Error("too late; already running");return i}function Hr(e,n){var i=e.__transition;if(!i||!(i=i[n]))throw new Error("transition not found");return i}function c6(e,n,i){var s=e.__transition,a;s[n]=i,i.timer=Qh(o,0,i.time);function o(u){i.state=Qg,i.timer.restart(l,i.delay,i.time),i.delay<=u&&l(u-i.delay)}function l(u){var f,h,m,g;if(i.state!==Qg)return d();for(f in s)if(g=s[f],g.name===i.name){if(g.state===rc)return Xg(l);g.state===Jg?(g.state=ic,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete s[f]):+f<n&&(g.state=ic,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete s[f])}if(Xg(function(){i.state===rc&&(i.state=Jg,i.timer.restart(c,i.delay,i.time),c(u))}),i.state=Df,i.on.call("start",e,e.__data__,i.index,i.group),i.state===Df){for(i.state=rc,a=new Array(m=i.tween.length),f=0,h=-1;f<m;++f)(g=i.tween[f].value.call(e,e.__data__,i.index,i.group))&&(a[++h]=g);a.length=h+1}}function c(u){for(var f=u<i.duration?i.ease.call(null,u/i.duration):(i.timer.restart(d),i.state=zf,1),h=-1,m=a.length;++h<m;)a[h].call(e,f);i.state===zf&&(i.on.call("end",e,e.__data__,i.index,i.group),d())}function d(){i.state=ic,i.timer.stop(),delete s[n];for(var u in s)return;delete e.__transition}}function sc(e,n){var i=e.__transition,s,a,o=!0,l;if(i){n=n==null?null:n+"";for(l in i){if((s=i[l]).name!==n){o=!1;continue}a=s.state>Df&&s.state<zf,s.state=ic,s.timer.stop(),s.on.call(a?"interrupt":"cancel",e,e.__data__,s.index,s.group),delete i[l]}o&&delete e.__transition}}function d6(e){return this.each(function(){sc(this,e)})}function u6(e,n){var i,s;return function(){var a=li(this,e),o=a.tween;if(o!==i){s=i=o;for(var l=0,c=s.length;l<c;++l)if(s[l].name===n){s=s.slice(),s.splice(l,1);break}}a.tween=s}}function f6(e,n,i){var s,a;if(typeof i!="function")throw new Error;return function(){var o=li(this,e),l=o.tween;if(l!==s){a=(s=l).slice();for(var c={name:n,value:i},d=0,u=a.length;d<u;++d)if(a[d].name===n){a[d]=c;break}d===u&&a.push(c)}o.tween=a}}function h6(e,n){var i=this._id;if(e+="",arguments.length<2){for(var s=Hr(this.node(),i).tween,a=0,o=s.length,l;a<o;++a)if((l=s[a]).name===e)return l.value;return null}return this.each((n==null?u6:f6)(i,e,n))}function Zh(e,n,i){var s=e._id;return e.each(function(){var a=li(this,s);(a.value||(a.value={}))[n]=i.apply(this,arguments)}),function(a){return Hr(a,s).value[n]}}function jb(e,n){var i;return(typeof n=="number"?Lr:n instanceof Os?mc:(i=Os(n))?(n=i,mc):mb)(e,n)}function p6(e){return function(){this.removeAttribute(e)}}function m6(e){return function(){this.removeAttributeNS(e.space,e.local)}}function g6(e,n,i){var s,a=i+"",o;return function(){var l=this.getAttribute(e);return l===a?null:l===s?o:o=n(s=l,i)}}function y6(e,n,i){var s,a=i+"",o;return function(){var l=this.getAttributeNS(e.space,e.local);return l===a?null:l===s?o:o=n(s=l,i)}}function x6(e,n,i){var s,a,o;return function(){var l,c=i(this),d;return c==null?void this.removeAttribute(e):(l=this.getAttribute(e),d=c+"",l===d?null:l===s&&d===a?o:(a=d,o=n(s=l,c)))}}function v6(e,n,i){var s,a,o;return function(){var l,c=i(this),d;return c==null?void this.removeAttributeNS(e.space,e.local):(l=this.getAttributeNS(e.space,e.local),d=c+"",l===d?null:l===s&&d===a?o:(a=d,o=n(s=l,c)))}}function b6(e,n){var i=md(e),s=i==="transform"?QA:jb;return this.attrTween(e,typeof n=="function"?(i.local?v6:x6)(i,s,Zh(this,"attr."+e,n)):n==null?(i.local?m6:p6)(i):(i.local?y6:g6)(i,s,n))}function j6(e,n){return function(i){this.setAttribute(e,n.call(this,i))}}function w6(e,n){return function(i){this.setAttributeNS(e.space,e.local,n.call(this,i))}}function S6(e,n){var i,s;function a(){var o=n.apply(this,arguments);return o!==s&&(i=(s=o)&&w6(e,o)),i}return a._value=n,a}function k6(e,n){var i,s;function a(){var o=n.apply(this,arguments);return o!==s&&(i=(s=o)&&j6(e,o)),i}return a._value=n,a}function N6(e,n){var i="attr."+e;if(arguments.length<2)return(i=this.tween(i))&&i._value;if(n==null)return this.tween(i,null);if(typeof n!="function")throw new Error;var s=md(e);return this.tween(i,(s.local?S6:k6)(s,n))}function _6(e,n){return function(){Jh(this,e).delay=+n.apply(this,arguments)}}function C6(e,n){return n=+n,function(){Jh(this,e).delay=n}}function A6(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?_6:C6)(n,e)):Hr(this.node(),n).delay}function I6(e,n){return function(){li(this,e).duration=+n.apply(this,arguments)}}function T6(e,n){return n=+n,function(){li(this,e).duration=n}}function E6(e){var n=this._id;return arguments.length?this.each((typeof e=="function"?I6:T6)(n,e)):Hr(this.node(),n).duration}function P6(e,n){if(typeof n!="function")throw new Error;return function(){li(this,e).ease=n}}function O6(e){var n=this._id;return arguments.length?this.each(P6(n,e)):Hr(this.node(),n).ease}function D6(e,n){return function(){var i=n.apply(this,arguments);if(typeof i!="function")throw new Error;li(this,e).ease=i}}function z6(e){if(typeof e!="function")throw new Error;return this.each(D6(this._id,e))}function M6(e){typeof e!="function"&&(e=eb(e));for(var n=this._groups,i=n.length,s=new Array(i),a=0;a<i;++a)for(var o=n[a],l=o.length,c=s[a]=[],d,u=0;u<l;++u)(d=o[u])&&e.call(d,d.__data__,u,o)&&c.push(d);return new Pi(s,this._parents,this._name,this._id)}function R6(e){if(e._id!==this._id)throw new Error;for(var n=this._groups,i=e._groups,s=n.length,a=i.length,o=Math.min(s,a),l=new Array(s),c=0;c<o;++c)for(var d=n[c],u=i[c],f=d.length,h=l[c]=new Array(f),m,g=0;g<f;++g)(m=d[g]||u[g])&&(h[g]=m);for(;c<s;++c)l[c]=n[c];return new Pi(l,this._parents,this._name,this._id)}function $6(e){return(e+"").trim().split(/^|\s+/).every(function(n){var i=n.indexOf(".");return i>=0&&(n=n.slice(0,i)),!n||n==="start"})}function L6(e,n,i){var s,a,o=$6(n)?Jh:li;return function(){var l=o(this,e),c=l.on;c!==s&&(a=(s=c).copy()).on(n,i),l.on=a}}function W6(e,n){var i=this._id;return arguments.length<2?Hr(this.node(),i).on.on(e):this.each(L6(i,e,n))}function B6(e){return function(){var n=this.parentNode;for(var i in this.__transition)if(+i!==e)return;n&&n.removeChild(this)}}function F6(){return this.on("end.remove",B6(this._id))}function q6(e){var n=this._name,i=this._id;typeof e!="function"&&(e=Hh(e));for(var s=this._groups,a=s.length,o=new Array(a),l=0;l<a;++l)for(var c=s[l],d=c.length,u=o[l]=new Array(d),f,h,m=0;m<d;++m)(f=c[m])&&(h=e.call(f,f.__data__,m,c))&&("__data__"in f&&(h.__data__=f.__data__),u[m]=h,yd(u[m],n,i,m,u,Hr(f,i)));return new Pi(o,this._parents,n,i)}function U6(e){var n=this._name,i=this._id;typeof e!="function"&&(e=Zv(e));for(var s=this._groups,a=s.length,o=[],l=[],c=0;c<a;++c)for(var d=s[c],u=d.length,f,h=0;h<u;++h)if(f=d[h]){for(var m=e.call(f,f.__data__,h,d),g,b=Hr(f,i),j=0,y=m.length;j<y;++j)(g=m[j])&&yd(g,n,i,j,m,b);o.push(m),l.push(f)}return new Pi(o,l,n,i)}var H6=Ho.prototype.constructor;function Y6(){return new H6(this._groups,this._parents)}function K6(e,n){var i,s,a;return function(){var o=ma(this,e),l=(this.style.removeProperty(e),ma(this,e));return o===l?null:o===i&&l===s?a:a=n(i=o,s=l)}}function wb(e){return function(){this.style.removeProperty(e)}}function G6(e,n,i){var s,a=i+"",o;return function(){var l=ma(this,e);return l===a?null:l===s?o:o=n(s=l,i)}}function V6(e,n,i){var s,a,o;return function(){var l=ma(this,e),c=i(this),d=c+"";return c==null&&(d=c=(this.style.removeProperty(e),ma(this,e))),l===d?null:l===s&&d===a?o:(a=d,o=n(s=l,c))}}function X6(e,n){var i,s,a,o="style."+n,l="end."+o,c;return function(){var d=li(this,e),u=d.on,f=d.value[o]==null?c||(c=wb(n)):void 0;(u!==i||a!==f)&&(s=(i=u).copy()).on(l,a=f),d.on=s}}function Q6(e,n,i){var s=(e+="")=="transform"?XA:jb;return n==null?this.styleTween(e,K6(e,s)).on("end.style."+e,wb(e)):typeof n=="function"?this.styleTween(e,V6(e,s,Zh(this,"style."+e,n))).each(X6(this._id,e)):this.styleTween(e,G6(e,s,n),i).on("end.style."+e,null)}function J6(e,n,i){return function(s){this.style.setProperty(e,n.call(this,s),i)}}function Z6(e,n,i){var s,a;function o(){var l=n.apply(this,arguments);return l!==a&&(s=(a=l)&&J6(e,l,i)),s}return o._value=n,o}function eI(e,n,i){var s="style."+(e+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(n==null)return this.tween(s,null);if(typeof n!="function")throw new Error;return this.tween(s,Z6(e,n,i??""))}function tI(e){return function(){this.textContent=e}}function nI(e){return function(){var n=e(this);this.textContent=n??""}}function rI(e){return this.tween("text",typeof e=="function"?nI(Zh(this,"text",e)):tI(e==null?"":e+""))}function iI(e){return function(n){this.textContent=e.call(this,n)}}function sI(e){var n,i;function s(){var a=e.apply(this,arguments);return a!==i&&(n=(i=a)&&iI(a)),n}return s._value=e,s}function aI(e){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;return this.tween(n,sI(e))}function oI(){for(var e=this._name,n=this._id,i=Sb(),s=this._groups,a=s.length,o=0;o<a;++o)for(var l=s[o],c=l.length,d,u=0;u<c;++u)if(d=l[u]){var f=Hr(d,n);yd(d,e,i,u,l,{time:f.time+f.delay+f.duration,delay:0,duration:f.duration,ease:f.ease})}return new Pi(s,this._parents,e,i)}function lI(){var e,n,i=this,s=i._id,a=i.size();return new Promise(function(o,l){var c={value:l},d={value:function(){--a===0&&o()}};i.each(function(){var u=li(this,s),f=u.on;f!==e&&(n=(e=f).copy(),n._.cancel.push(c),n._.interrupt.push(c),n._.end.push(d)),u.on=n}),a===0&&o()})}var cI=0;function Pi(e,n,i,s){this._groups=e,this._parents=n,this._name=i,this._id=s}function Sb(){return++cI}var fi=Ho.prototype;Pi.prototype={constructor:Pi,select:q6,selectAll:U6,selectChild:fi.selectChild,selectChildren:fi.selectChildren,filter:M6,merge:R6,selection:Y6,transition:oI,call:fi.call,nodes:fi.nodes,node:fi.node,size:fi.size,empty:fi.empty,each:fi.each,on:W6,attr:b6,attrTween:N6,style:Q6,styleTween:eI,text:rI,textTween:aI,remove:F6,tween:h6,delay:A6,duration:E6,ease:O6,easeVarying:z6,end:lI,[Symbol.iterator]:fi[Symbol.iterator]};function dI(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var uI={time:null,delay:0,duration:250,ease:dI};function fI(e,n){for(var i;!(i=e.__transition)||!(i=i[n]);)if(!(e=e.parentNode))throw new Error(`transition ${n} not found`);return i}function hI(e){var n,i;e instanceof Pi?(n=e._id,e=e._name):(n=Sb(),(i=uI).time=Xh(),e=e==null?null:e+"");for(var s=this._groups,a=s.length,o=0;o<a;++o)for(var l=s[o],c=l.length,d,u=0;u<c;++u)(d=l[u])&&yd(d,e,n,u,l,i||fI(d,n));return new Pi(s,this._parents,e,n)}Ho.prototype.interrupt=d6;Ho.prototype.transition=hI;const Nl=e=>()=>e;function pI(e,{sourceEvent:n,target:i,transform:s,dispatch:a}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:i,enumerable:!0,configurable:!0},transform:{value:s,enumerable:!0,configurable:!0},_:{value:a}})}function ji(e,n,i){this.k=e,this.x=n,this.y=i}ji.prototype={constructor:ji,scale:function(e){return e===1?this:new ji(this.k*e,this.x,this.y)},translate:function(e,n){return e===0&n===0?this:new ji(this.k,this.x+this.k*e,this.y+this.k*n)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ep=new ji(1,0,0);Qr.prototype=ji.prototype;function Qr(e){for(;!e.__zoom;)if(!(e=e.parentNode))return ep;return e.__zoom}function Ru(e){e.stopImmediatePropagation()}function Fa(e){e.preventDefault(),e.stopImmediatePropagation()}function mI(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function gI(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Zg(){return this.__zoom||ep}function yI(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function xI(){return navigator.maxTouchPoints||"ontouchstart"in this}function vI(e,n,i){var s=e.invertX(n[0][0])-i[0][0],a=e.invertX(n[1][0])-i[1][0],o=e.invertY(n[0][1])-i[0][1],l=e.invertY(n[1][1])-i[1][1];return e.translate(a>s?(s+a)/2:Math.min(0,s)||Math.max(0,a),l>o?(o+l)/2:Math.min(0,o)||Math.max(0,l))}function bI(){var e=mI,n=gI,i=vI,s=yI,a=xI,o=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],c=250,d=t6,u=Yo("start","zoom","end"),f,h,m,g=500,b=150,j=0,y=10;function x(T){T.property("__zoom",Zg).on("wheel.zoom",I,{passive:!1}).on("mousedown.zoom",O).on("dblclick.zoom",E).filter(a).on("touchstart.zoom",S).on("touchmove.zoom",k).on("touchend.zoom touchcancel.zoom",D).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(T,P,R,Y){var X=T.selection?T.selection():T;X.property("__zoom",Zg),T!==X?C(T,P,R,Y):X.interrupt().each(function(){w(this,arguments).event(Y).start().zoom(null,typeof P=="function"?P.apply(this,arguments):P).end()})},x.scaleBy=function(T,P,R,Y){x.scaleTo(T,function(){var X=this.__zoom.k,H=typeof P=="function"?P.apply(this,arguments):P;return X*H},R,Y)},x.scaleTo=function(T,P,R,Y){x.transform(T,function(){var X=n.apply(this,arguments),H=this.__zoom,q=R==null?N(X):typeof R=="function"?R.apply(this,arguments):R,M=H.invert(q),L=typeof P=="function"?P.apply(this,arguments):P;return i(A(v(H,L),q,M),X,l)},R,Y)},x.translateBy=function(T,P,R,Y){x.transform(T,function(){return i(this.__zoom.translate(typeof P=="function"?P.apply(this,arguments):P,typeof R=="function"?R.apply(this,arguments):R),n.apply(this,arguments),l)},null,Y)},x.translateTo=function(T,P,R,Y,X){x.transform(T,function(){var H=n.apply(this,arguments),q=this.__zoom,M=Y==null?N(H):typeof Y=="function"?Y.apply(this,arguments):Y;return i(ep.translate(M[0],M[1]).scale(q.k).translate(typeof P=="function"?-P.apply(this,arguments):-P,typeof R=="function"?-R.apply(this,arguments):-R),H,l)},Y,X)};function v(T,P){return P=Math.max(o[0],Math.min(o[1],P)),P===T.k?T:new ji(P,T.x,T.y)}function A(T,P,R){var Y=P[0]-R[0]*T.k,X=P[1]-R[1]*T.k;return Y===T.x&&X===T.y?T:new ji(T.k,Y,X)}function N(T){return[(+T[0][0]+ +T[1][0])/2,(+T[0][1]+ +T[1][1])/2]}function C(T,P,R,Y){T.on("start.zoom",function(){w(this,arguments).event(Y).start()}).on("interrupt.zoom end.zoom",function(){w(this,arguments).event(Y).end()}).tween("zoom",function(){var X=this,H=arguments,q=w(X,H).event(Y),M=n.apply(X,H),L=R==null?N(M):typeof R=="function"?R.apply(X,H):R,B=Math.max(M[1][0]-M[0][0],M[1][1]-M[0][1]),F=X.__zoom,te=typeof P=="function"?P.apply(X,H):P,$=d(F.invert(L).concat(B/F.k),te.invert(L).concat(B/te.k));return function(W){if(W===1)W=te;else{var U=$(W),Z=B/U[2];W=new ji(Z,L[0]-U[0]*Z,L[1]-U[1]*Z)}q.zoom(null,W)}})}function w(T,P,R){return!R&&T.__zooming||new _(T,P)}function _(T,P){this.that=T,this.args=P,this.active=0,this.sourceEvent=null,this.extent=n.apply(T,P),this.taps=0}_.prototype={event:function(T){return T&&(this.sourceEvent=T),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(T,P){return this.mouse&&T!=="mouse"&&(this.mouse[1]=P.invert(this.mouse[0])),this.touch0&&T!=="touch"&&(this.touch0[1]=P.invert(this.touch0[0])),this.touch1&&T!=="touch"&&(this.touch1[1]=P.invert(this.touch1[0])),this.that.__zoom=P,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(T){var P=Cr(this.that).datum();u.call(T,this.that,new pI(T,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:u}),P)}};function I(T,...P){if(!e.apply(this,arguments))return;var R=w(this,P).event(T),Y=this.__zoom,X=Math.max(o[0],Math.min(o[1],Y.k*Math.pow(2,s.apply(this,arguments)))),H=Jr(T);if(R.wheel)(R.mouse[0][0]!==H[0]||R.mouse[0][1]!==H[1])&&(R.mouse[1]=Y.invert(R.mouse[0]=H)),clearTimeout(R.wheel);else{if(Y.k===X)return;R.mouse=[H,Y.invert(H)],sc(this),R.start()}Fa(T),R.wheel=setTimeout(q,b),R.zoom("mouse",i(A(v(Y,X),R.mouse[0],R.mouse[1]),R.extent,l));function q(){R.wheel=null,R.end()}}function O(T,...P){if(m||!e.apply(this,arguments))return;var R=T.currentTarget,Y=w(this,P,!0).event(T),X=Cr(T.view).on("mousemove.zoom",L,!0).on("mouseup.zoom",B,!0),H=Jr(T,R),q=T.clientX,M=T.clientY;db(T.view),Ru(T),Y.mouse=[H,this.__zoom.invert(H)],sc(this),Y.start();function L(F){if(Fa(F),!Y.moved){var te=F.clientX-q,$=F.clientY-M;Y.moved=te*te+$*$>j}Y.event(F).zoom("mouse",i(A(Y.that.__zoom,Y.mouse[0]=Jr(F,R),Y.mouse[1]),Y.extent,l))}function B(F){X.on("mousemove.zoom mouseup.zoom",null),ub(F.view,Y.moved),Fa(F),Y.event(F).end()}}function E(T,...P){if(e.apply(this,arguments)){var R=this.__zoom,Y=Jr(T.changedTouches?T.changedTouches[0]:T,this),X=R.invert(Y),H=R.k*(T.shiftKey?.5:2),q=i(A(v(R,H),Y,X),n.apply(this,P),l);Fa(T),c>0?Cr(this).transition().duration(c).call(C,q,Y,T):Cr(this).call(x.transform,q,Y,T)}}function S(T,...P){if(e.apply(this,arguments)){var R=T.touches,Y=R.length,X=w(this,P,T.changedTouches.length===Y).event(T),H,q,M,L;for(Ru(T),q=0;q<Y;++q)M=R[q],L=Jr(M,this),L=[L,this.__zoom.invert(L),M.identifier],X.touch0?!X.touch1&&X.touch0[2]!==L[2]&&(X.touch1=L,X.taps=0):(X.touch0=L,H=!0,X.taps=1+!!f);f&&(f=clearTimeout(f)),H&&(X.taps<2&&(h=L[0],f=setTimeout(function(){f=null},g)),sc(this),X.start())}}function k(T,...P){if(this.__zooming){var R=w(this,P).event(T),Y=T.changedTouches,X=Y.length,H,q,M,L;for(Fa(T),H=0;H<X;++H)q=Y[H],M=Jr(q,this),R.touch0&&R.touch0[2]===q.identifier?R.touch0[0]=M:R.touch1&&R.touch1[2]===q.identifier&&(R.touch1[0]=M);if(q=R.that.__zoom,R.touch1){var B=R.touch0[0],F=R.touch0[1],te=R.touch1[0],$=R.touch1[1],W=(W=te[0]-B[0])*W+(W=te[1]-B[1])*W,U=(U=$[0]-F[0])*U+(U=$[1]-F[1])*U;q=v(q,Math.sqrt(W/U)),M=[(B[0]+te[0])/2,(B[1]+te[1])/2],L=[(F[0]+$[0])/2,(F[1]+$[1])/2]}else if(R.touch0)M=R.touch0[0],L=R.touch0[1];else return;R.zoom("touch",i(A(q,M,L),R.extent,l))}}function D(T,...P){if(this.__zooming){var R=w(this,P).event(T),Y=T.changedTouches,X=Y.length,H,q;for(Ru(T),m&&clearTimeout(m),m=setTimeout(function(){m=null},g),H=0;H<X;++H)q=Y[H],R.touch0&&R.touch0[2]===q.identifier?delete R.touch0:R.touch1&&R.touch1[2]===q.identifier&&delete R.touch1;if(R.touch1&&!R.touch0&&(R.touch0=R.touch1,delete R.touch1),R.touch0)R.touch0[1]=this.__zoom.invert(R.touch0[0]);else if(R.end(),R.taps===2&&(q=Jr(q,this),Math.hypot(h[0]-q[0],h[1]-q[1])<y)){var M=Cr(this).on("dblclick.zoom");M&&M.apply(this,arguments)}}}return x.wheelDelta=function(T){return arguments.length?(s=typeof T=="function"?T:Nl(+T),x):s},x.filter=function(T){return arguments.length?(e=typeof T=="function"?T:Nl(!!T),x):e},x.touchable=function(T){return arguments.length?(a=typeof T=="function"?T:Nl(!!T),x):a},x.extent=function(T){return arguments.length?(n=typeof T=="function"?T:Nl([[+T[0][0],+T[0][1]],[+T[1][0],+T[1][1]]]),x):n},x.scaleExtent=function(T){return arguments.length?(o[0]=+T[0],o[1]=+T[1],x):[o[0],o[1]]},x.translateExtent=function(T){return arguments.length?(l[0][0]=+T[0][0],l[1][0]=+T[1][0],l[0][1]=+T[0][1],l[1][1]=+T[1][1],x):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},x.constrain=function(T){return arguments.length?(i=T,x):i},x.duration=function(T){return arguments.length?(c=+T,x):c},x.interpolate=function(T){return arguments.length?(d=T,x):d},x.on=function(){var T=u.on.apply(u,arguments);return T===u?x:T},x.clickDistance=function(T){return arguments.length?(j=(T=+T)*T,x):Math.sqrt(j)},x.tapDistance=function(T){return arguments.length?(y=+T,x):y},x}function ns(e,n){return e==null||n==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function jI(e,n){return e==null||n==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function tp(e){let n,i,s;e.length!==2?(n=ns,i=(c,d)=>ns(e(c),d),s=(c,d)=>e(c)-d):(n=e===ns||e===jI?e:wI,i=e,s=e);function a(c,d,u=0,f=c.length){if(u<f){if(n(d,d)!==0)return f;do{const h=u+f>>>1;i(c[h],d)<0?u=h+1:f=h}while(u<f)}return u}function o(c,d,u=0,f=c.length){if(u<f){if(n(d,d)!==0)return f;do{const h=u+f>>>1;i(c[h],d)<=0?u=h+1:f=h}while(u<f)}return u}function l(c,d,u=0,f=c.length){const h=a(c,d,u,f-1);return h>u&&s(c[h-1],d)>-s(c[h],d)?h-1:h}return{left:a,center:l,right:o}}function wI(){return 0}function kb(e){return e===null?NaN:+e}function*SI(e,n){for(let i of e)i!=null&&(i=+i)>=i&&(yield i)}const kI=tp(ns),Go=kI.right;tp(kb).center;class ey extends Map{constructor(n,i=CI){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:i}}),n!=null)for(const[s,a]of n)this.set(s,a)}get(n){return super.get(ty(this,n))}has(n){return super.has(ty(this,n))}set(n,i){return super.set(NI(this,n),i)}delete(n){return super.delete(_I(this,n))}}function ty({_intern:e,_key:n},i){const s=n(i);return e.has(s)?e.get(s):i}function NI({_intern:e,_key:n},i){const s=n(i);return e.has(s)?e.get(s):(e.set(s,i),i)}function _I({_intern:e,_key:n},i){const s=n(i);return e.has(s)&&(i=e.get(s),e.delete(s)),i}function CI(e){return e!==null&&typeof e=="object"?e.valueOf():e}function AI(e=ns){if(e===ns)return Nb;if(typeof e!="function")throw new TypeError("compare is not a function");return(n,i)=>{const s=e(n,i);return s||s===0?s:(e(i,i)===0)-(e(n,n)===0)}}function Nb(e,n){return(e==null||!(e>=e))-(n==null||!(n>=n))||(e<n?-1:e>n?1:0)}const II=Math.sqrt(50),TI=Math.sqrt(10),EI=Math.sqrt(2);function vc(e,n,i){const s=(n-e)/Math.max(0,i),a=Math.floor(Math.log10(s)),o=s/Math.pow(10,a),l=o>=II?10:o>=TI?5:o>=EI?2:1;let c,d,u;return a<0?(u=Math.pow(10,-a)/l,c=Math.round(e*u),d=Math.round(n*u),c/u<e&&++c,d/u>n&&--d,u=-u):(u=Math.pow(10,a)*l,c=Math.round(e/u),d=Math.round(n/u),c*u<e&&++c,d*u>n&&--d),d<c&&.5<=i&&i<2?vc(e,n,i*2):[c,d,u]}function Mf(e,n,i){if(n=+n,e=+e,i=+i,!(i>0))return[];if(e===n)return[e];const s=n<e,[a,o,l]=s?vc(n,e,i):vc(e,n,i);if(!(o>=a))return[];const c=o-a+1,d=new Array(c);if(s)if(l<0)for(let u=0;u<c;++u)d[u]=(o-u)/-l;else for(let u=0;u<c;++u)d[u]=(o-u)*l;else if(l<0)for(let u=0;u<c;++u)d[u]=(a+u)/-l;else for(let u=0;u<c;++u)d[u]=(a+u)*l;return d}function Rf(e,n,i){return n=+n,e=+e,i=+i,vc(e,n,i)[2]}function $f(e,n,i){n=+n,e=+e,i=+i;const s=n<e,a=s?Rf(n,e,i):Rf(e,n,i);return(s?-1:1)*(a<0?1/-a:a)}function bc(e,n){let i;if(n===void 0)for(const s of e)s!=null&&(i<s||i===void 0&&s>=s)&&(i=s);else{let s=-1;for(let a of e)(a=n(a,++s,e))!=null&&(i<a||i===void 0&&a>=a)&&(i=a)}return i}function jc(e,n){let i;if(n===void 0)for(const s of e)s!=null&&(i>s||i===void 0&&s>=s)&&(i=s);else{let s=-1;for(let a of e)(a=n(a,++s,e))!=null&&(i>a||i===void 0&&a>=a)&&(i=a)}return i}function _b(e,n,i=0,s=1/0,a){if(n=Math.floor(n),i=Math.floor(Math.max(0,i)),s=Math.floor(Math.min(e.length-1,s)),!(i<=n&&n<=s))return e;for(a=a===void 0?Nb:AI(a);s>i;){if(s-i>600){const d=s-i+1,u=n-i+1,f=Math.log(d),h=.5*Math.exp(2*f/3),m=.5*Math.sqrt(f*h*(d-h)/d)*(u-d/2<0?-1:1),g=Math.max(i,Math.floor(n-u*h/d+m)),b=Math.min(s,Math.floor(n+(d-u)*h/d+m));_b(e,n,g,b,a)}const o=e[n];let l=i,c=s;for(qa(e,i,n),a(e[s],o)>0&&qa(e,i,s);l<c;){for(qa(e,l,c),++l,--c;a(e[l],o)<0;)++l;for(;a(e[c],o)>0;)--c}a(e[i],o)===0?qa(e,i,c):(++c,qa(e,c,s)),c<=n&&(i=c+1),n<=c&&(s=c-1)}return e}function qa(e,n,i){const s=e[n];e[n]=e[i],e[i]=s}function PI(e,n,i){if(e=Float64Array.from(SI(e)),!(!(s=e.length)||isNaN(n=+n))){if(n<=0||s<2)return jc(e);if(n>=1)return bc(e);var s,a=(s-1)*n,o=Math.floor(a),l=bc(_b(e,o).subarray(0,o+1)),c=jc(e.subarray(o+1));return l+(c-l)*(a-o)}}function OI(e,n,i=kb){if(!(!(s=e.length)||isNaN(n=+n))){if(n<=0||s<2)return+i(e[0],0,e);if(n>=1)return+i(e[s-1],s-1,e);var s,a=(s-1)*n,o=Math.floor(a),l=+i(e[o],o,e),c=+i(e[o+1],o+1,e);return l+(c-l)*(a-o)}}function DI(e,n,i){e=+e,n=+n,i=(a=arguments.length)<2?(n=e,e=0,1):a<3?1:+i;for(var s=-1,a=Math.max(0,Math.ceil((n-e)/i))|0,o=new Array(a);++s<a;)o[s]=e+s*i;return o}function zI(e,n){let i=0;for(let s of e)(s=+s)&&(i+=s);return i}var MI=typeof global=="object"&&global&&global.Object===Object&&global,RI=typeof self=="object"&&self&&self.Object===Object&&self,Cb=MI||RI||Function("return this")(),wc=Cb.Symbol,Ab=Object.prototype,$I=Ab.hasOwnProperty,LI=Ab.toString,Ua=wc?wc.toStringTag:void 0;function WI(e){var n=$I.call(e,Ua),i=e[Ua];try{e[Ua]=void 0;var s=!0}catch{}var a=LI.call(e);return s&&(n?e[Ua]=i:delete e[Ua]),a}var BI=Object.prototype,FI=BI.toString;function qI(e){return FI.call(e)}var UI="[object Null]",HI="[object Undefined]",ny=wc?wc.toStringTag:void 0;function YI(e){return e==null?e===void 0?HI:UI:ny&&ny in Object(e)?WI(e):qI(e)}function KI(e){return e!=null&&typeof e=="object"}var GI="[object Symbol]";function VI(e){return typeof e=="symbol"||KI(e)&&YI(e)==GI}var XI=/\s/;function QI(e){for(var n=e.length;n--&&XI.test(e.charAt(n)););return n}var JI=/^\s+/;function ZI(e){return e&&e.slice(0,QI(e)+1).replace(JI,"")}function Sc(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}var ry=NaN,eT=/^[-+]0x[0-9a-f]+$/i,tT=/^0b[01]+$/i,nT=/^0o[0-7]+$/i,rT=parseInt;function iy(e){if(typeof e=="number")return e;if(VI(e))return ry;if(Sc(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=Sc(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=ZI(e);var i=tT.test(e);return i||nT.test(e)?rT(e.slice(2),i?2:8):eT.test(e)?ry:+e}var $u=function(){return Cb.Date.now()},iT="Expected a function",sT=Math.max,aT=Math.min;function Ib(e,n,i){var s,a,o,l,c,d,u=0,f=!1,h=!1,m=!0;if(typeof e!="function")throw new TypeError(iT);n=iy(n)||0,Sc(i)&&(f=!!i.leading,h="maxWait"in i,o=h?sT(iy(i.maxWait)||0,n):o,m="trailing"in i?!!i.trailing:m);function g(w){var _=s,I=a;return s=a=void 0,u=w,l=e.apply(I,_),l}function b(w){return u=w,c=setTimeout(x,n),f?g(w):l}function j(w){var _=w-d,I=w-u,O=n-_;return h?aT(O,o-I):O}function y(w){var _=w-d,I=w-u;return d===void 0||_>=n||_<0||h&&I>=o}function x(){var w=$u();if(y(w))return v(w);c=setTimeout(x,j(w))}function v(w){return c=void 0,m&&s?g(w):(s=a=void 0,l)}function A(){c!==void 0&&clearTimeout(c),u=0,s=d=a=c=void 0}function N(){return c===void 0?l:v($u())}function C(){var w=$u(),_=y(w);if(s=arguments,a=this,d=w,_){if(c===void 0)return b(d);if(h)return clearTimeout(c),c=setTimeout(x,n),g(d)}return c===void 0&&(c=setTimeout(x,n)),l}return C.cancel=A,C.flush=N,C}var oT="Expected a function";function lT(e,n,i){var s=!0,a=!0;if(typeof e!="function")throw new TypeError(oT);return Sc(i)&&(s="leading"in i?!!i.leading:s,a="trailing"in i?!!i.trailing:a),Ib(e,n,{leading:s,maxWait:n,trailing:a})}var As=Object.freeze({Linear:Object.freeze({None:function(e){return e},In:function(e){return e},Out:function(e){return e},InOut:function(e){return e}}),Quadratic:Object.freeze({In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}}),Cubic:Object.freeze({In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}}),Quartic:Object.freeze({In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}}),Quintic:Object.freeze({In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}}),Sinusoidal:Object.freeze({In:function(e){return 1-Math.sin((1-e)*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return .5*(1-Math.sin(Math.PI*(.5-e)))}}),Exponential:Object.freeze({In:function(e){return e===0?0:Math.pow(1024,e-1)},Out:function(e){return e===1?1:1-Math.pow(2,-10*e)},InOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)}}),Circular:Object.freeze({In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}}),Elastic:Object.freeze({In:function(e){return e===0?0:e===1?1:-Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI)},Out:function(e){return e===0?0:e===1?1:Math.pow(2,-10*e)*Math.sin((e-.1)*5*Math.PI)+1},InOut:function(e){return e===0?0:e===1?1:(e*=2,e<1?-.5*Math.pow(2,10*(e-1))*Math.sin((e-1.1)*5*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin((e-1.1)*5*Math.PI)+1)}}),Back:Object.freeze({In:function(e){var n=1.70158;return e===1?1:e*e*((n+1)*e-n)},Out:function(e){var n=1.70158;return e===0?0:--e*e*((n+1)*e+n)+1},InOut:function(e){var n=2.5949095;return(e*=2)<1?.5*(e*e*((n+1)*e-n)):.5*((e-=2)*e*((n+1)*e+n)+2)}}),Bounce:Object.freeze({In:function(e){return 1-As.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?As.Bounce.In(e*2)*.5:As.Bounce.Out(e*2-1)*.5+.5}}),generatePow:function(e){return e===void 0&&(e=4),e=e<Number.EPSILON?Number.EPSILON:e,e=e>1e4?1e4:e,{In:function(n){return Math.pow(n,e)},Out:function(n){return 1-Math.pow(1-n,e)},InOut:function(n){return n<.5?Math.pow(n*2,e)/2:(1-Math.pow(2-n*2,e))/2+.5}}}}),uo=function(){return performance.now()},Tb=function(){function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];this._tweens={},this._tweensAddedDuringUpdate={},this.add.apply(this,n)}return e.prototype.getAll=function(){var n=this;return Object.keys(this._tweens).map(function(i){return n._tweens[i]})},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(){for(var n,i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];for(var a=0,o=i;a<o.length;a++){var l=o[a];(n=l._group)===null||n===void 0||n.remove(l),l._group=this,this._tweens[l.getId()]=l,this._tweensAddedDuringUpdate[l.getId()]=l}},e.prototype.remove=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];for(var s=0,a=n;s<a.length;s++){var o=a[s];o._group=void 0,delete this._tweens[o.getId()],delete this._tweensAddedDuringUpdate[o.getId()]}},e.prototype.allStopped=function(){return this.getAll().every(function(n){return!n.isPlaying()})},e.prototype.update=function(n,i){n===void 0&&(n=uo()),i===void 0&&(i=!0);var s=Object.keys(this._tweens);if(s.length!==0)for(;s.length>0;){this._tweensAddedDuringUpdate={};for(var a=0;a<s.length;a++){var o=this._tweens[s[a]],l=!i;o&&o.update(n,l)===!1&&!i&&this.remove(o)}s=Object.keys(this._tweensAddedDuringUpdate)}},e}(),Lf={Linear:function(e,n){var i=e.length-1,s=i*n,a=Math.floor(s),o=Lf.Utils.Linear;return n<0?o(e[0],e[1],s):n>1?o(e[i],e[i-1],i-s):o(e[a],e[a+1>i?i:a+1],s-a)},Utils:{Linear:function(e,n,i){return(n-e)*i+e}}},Eb=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),Wf=new Tb,sy=function(){function e(n,i){this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._isDynamic=!1,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=As.Linear.None,this._interpolationFunction=Lf.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._id=Eb.nextId(),this._isChainStopped=!1,this._propertiesAreSetUp=!1,this._goToEnd=!1,this._object=n,typeof i=="object"?(this._group=i,i.add(this)):i===!0&&(this._group=Wf,Wf.add(this))}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.getDuration=function(){return this._duration},e.prototype.to=function(n,i){if(i===void 0&&(i=1e3),this._isPlaying)throw new Error("Can not call Tween.to() while Tween is already started or paused. Stop the Tween first.");return this._valuesEnd=n,this._propertiesAreSetUp=!1,this._duration=i<0?0:i,this},e.prototype.duration=function(n){return n===void 0&&(n=1e3),this._duration=n<0?0:n,this},e.prototype.dynamic=function(n){return n===void 0&&(n=!1),this._isDynamic=n,this},e.prototype.start=function(n,i){if(n===void 0&&(n=uo()),i===void 0&&(i=!1),this._isPlaying)return this;if(this._repeat=this._initialRepeat,this._reversed){this._reversed=!1;for(var s in this._valuesStartRepeat)this._swapEndStartRepeatValues(s),this._valuesStart[s]=this._valuesStartRepeat[s]}if(this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._onEveryStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=n,this._startTime+=this._delayTime,!this._propertiesAreSetUp||i){if(this._propertiesAreSetUp=!0,!this._isDynamic){var a={};for(var o in this._valuesEnd)a[o]=this._valuesEnd[o];this._valuesEnd=a}this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat,i)}return this},e.prototype.startFromCurrentValues=function(n){return this.start(n,!0)},e.prototype._setupProperties=function(n,i,s,a,o){for(var l in s){var c=n[l],d=Array.isArray(c),u=d?"array":typeof c,f=!d&&Array.isArray(s[l]);if(!(u==="undefined"||u==="function")){if(f){var h=s[l];if(h.length===0)continue;for(var m=[c],g=0,b=h.length;g<b;g+=1){var j=this._handleRelativeValue(c,h[g]);if(isNaN(j)){f=!1,console.warn("Found invalid interpolation list. Skipping.");break}m.push(j)}f&&(s[l]=m)}if((u==="object"||d)&&c&&!f){i[l]=d?[]:{};var y=c;for(var x in y)i[l][x]=y[x];a[l]=d?[]:{};var h=s[l];if(!this._isDynamic){var v={};for(var x in h)v[x]=h[x];s[l]=h=v}this._setupProperties(y,i[l],h,a[l],o)}else(typeof i[l]>"u"||o)&&(i[l]=c),d||(i[l]*=1),f?a[l]=s[l].slice().reverse():a[l]=i[l]||0}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(this._startTime+this._duration),this},e.prototype.pause=function(n){return n===void 0&&(n=uo()),this._isPaused||!this._isPlaying?this:(this._isPaused=!0,this._pauseStart=n,this)},e.prototype.resume=function(n){return n===void 0&&(n=uo()),!this._isPaused||!this._isPlaying?this:(this._isPaused=!1,this._startTime+=n-this._pauseStart,this._pauseStart=0,this)},e.prototype.stopChainedTweens=function(){for(var n=0,i=this._chainedTweens.length;n<i;n++)this._chainedTweens[n].stop();return this},e.prototype.group=function(n){return n?(n.add(this),this):(console.warn("tween.group() without args has been removed, use group.add(tween) instead."),this)},e.prototype.remove=function(){var n;return(n=this._group)===null||n===void 0||n.remove(this),this},e.prototype.delay=function(n){return n===void 0&&(n=0),this._delayTime=n,this},e.prototype.repeat=function(n){return n===void 0&&(n=0),this._initialRepeat=n,this._repeat=n,this},e.prototype.repeatDelay=function(n){return this._repeatDelayTime=n,this},e.prototype.yoyo=function(n){return n===void 0&&(n=!1),this._yoyo=n,this},e.prototype.easing=function(n){return n===void 0&&(n=As.Linear.None),this._easingFunction=n,this},e.prototype.interpolation=function(n){return n===void 0&&(n=Lf.Linear),this._interpolationFunction=n,this},e.prototype.chain=function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];return this._chainedTweens=n,this},e.prototype.onStart=function(n){return this._onStartCallback=n,this},e.prototype.onEveryStart=function(n){return this._onEveryStartCallback=n,this},e.prototype.onUpdate=function(n){return this._onUpdateCallback=n,this},e.prototype.onRepeat=function(n){return this._onRepeatCallback=n,this},e.prototype.onComplete=function(n){return this._onCompleteCallback=n,this},e.prototype.onStop=function(n){return this._onStopCallback=n,this},e.prototype.update=function(n,i){var s=this,a;if(n===void 0&&(n=uo()),i===void 0&&(i=e.autoStartOnUpdate),this._isPaused)return!0;var o;if(!this._goToEnd&&!this._isPlaying)if(i)this.start(n,!0);else return!1;if(this._goToEnd=!1,n<this._startTime)return!0;this._onStartCallbackFired===!1&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),this._onEveryStartCallbackFired===!1&&(this._onEveryStartCallback&&this._onEveryStartCallback(this._object),this._onEveryStartCallbackFired=!0);var l=n-this._startTime,c=this._duration+((a=this._repeatDelayTime)!==null&&a!==void 0?a:this._delayTime),d=this._duration+this._repeat*c,u=function(){if(s._duration===0||l>d)return 1;var j=Math.trunc(l/c),y=l-j*c,x=Math.min(y/s._duration,1);return x===0&&l===s._duration?1:x},f=u(),h=this._easingFunction(f);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,h),this._onUpdateCallback&&this._onUpdateCallback(this._object,f),this._duration===0||l>=this._duration)if(this._repeat>0){var m=Math.min(Math.trunc((l-this._duration)/c)+1,this._repeat);isFinite(this._repeat)&&(this._repeat-=m);for(o in this._valuesStartRepeat)!this._yoyo&&typeof this._valuesEnd[o]=="string"&&(this._valuesStartRepeat[o]=this._valuesStartRepeat[o]+parseFloat(this._valuesEnd[o])),this._yoyo&&this._swapEndStartRepeatValues(o),this._valuesStart[o]=this._valuesStartRepeat[o];return this._yoyo&&(this._reversed=!this._reversed),this._startTime+=c*m,this._onRepeatCallback&&this._onRepeatCallback(this._object),this._onEveryStartCallbackFired=!1,!0}else{this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var g=0,b=this._chainedTweens.length;g<b;g++)this._chainedTweens[g].start(this._startTime+this._duration,!1);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(n,i,s,a){for(var o in s)if(i[o]!==void 0){var l=i[o]||0,c=s[o],d=Array.isArray(n[o]),u=Array.isArray(c),f=!d&&u;f?n[o]=this._interpolationFunction(c,a):typeof c=="object"&&c?this._updateProperties(n[o],l,c,a):(c=this._handleRelativeValue(l,c),typeof c=="number"&&(n[o]=l+(c-l)*a))}},e.prototype._handleRelativeValue=function(n,i){return typeof i!="string"?i:i.charAt(0)==="+"||i.charAt(0)==="-"?n+parseFloat(i):parseFloat(i)},e.prototype._swapEndStartRepeatValues=function(n){var i=this._valuesStartRepeat[n],s=this._valuesEnd[n];typeof s=="string"?this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(s):this._valuesStartRepeat[n]=this._valuesEnd[n],this._valuesEnd[n]=i},e.autoStartOnUpdate=!1,e}();Eb.nextId;var ii=Wf;ii.getAll.bind(ii);ii.removeAll.bind(ii);ii.add.bind(ii);ii.remove.bind(ii);ii.update.bind(ii);function ay(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,s=Array(n);i<n;i++)s[i]=e[i];return s}function cT(e){if(Array.isArray(e))return e}function dT(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function uT(e,n,i){return Object.defineProperty(e,"prototype",{writable:!1}),e}function fT(e,n){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var s,a,o,l,c=[],d=!0,u=!1;try{if(o=(i=i.call(e)).next,n!==0)for(;!(d=(s=o.call(i)).done)&&(c.push(s.value),c.length!==n);d=!0);}catch(f){u=!0,a=f}finally{try{if(!d&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(u)throw a}}return c}}function hT(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function pT(e,n){return cT(e)||fT(e,n)||mT(e,n)||hT()}function mT(e,n){if(e){if(typeof e=="string")return ay(e,n);var i={}.toString.call(e).slice(8,-1);return i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set"?Array.from(e):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?ay(e,n):void 0}}var gT=uT(function e(n,i){var s=i.default,a=s===void 0?null:s,o=i.triggerUpdate,l=o===void 0?!0:o,c=i.onChange,d=c===void 0?function(u,f){}:c;dT(this,e),this.name=n,this.defaultVal=a,this.triggerUpdate=l,this.onChange=d});function np(e){var n=e.stateInit,i=n===void 0?function(){return{}}:n,s=e.props,a=s===void 0?{}:s,o=e.methods,l=o===void 0?{}:o,c=e.aliases,d=c===void 0?{}:c,u=e.init,f=u===void 0?function(){}:u,h=e.update,m=h===void 0?function(){}:h,g=Object.keys(a).map(function(b){return new gT(b,a[b])});return function b(){for(var j=arguments.length,y=new Array(j),x=0;x<j;x++)y[x]=arguments[x];var v=!!(this instanceof b&&this.constructor),A=v?y.shift():void 0,N=y[0],C=N===void 0?{}:N,w=Object.assign({},i instanceof Function?i(C):i,{initialised:!1}),_={};function I(S){return O(S,C),E(),I}var O=function(k,D){f.call(I,k,w,D),w.initialised=!0},E=Ib(function(){w.initialised&&(m.call(I,w,_),_={})},1);return g.forEach(function(S){I[S.name]=k(S);function k(D){var T=D.name,P=D.triggerUpdate,R=P===void 0?!1:P,Y=D.onChange,X=Y===void 0?function(M,L){}:Y,H=D.defaultVal,q=H===void 0?null:H;return function(M){var L=w[T];if(!arguments.length)return L;var B=M===void 0?q:M;return w[T]=B,X.call(I,B,w,L),!_.hasOwnProperty(T)&&(_[T]=L),R&&E(),I}}}),Object.keys(l).forEach(function(S){I[S]=function(){for(var k,D=arguments.length,T=new Array(D),P=0;P<D;P++)T[P]=arguments[P];return(k=l[S]).call.apply(k,[I,w].concat(T))}}),Object.entries(d).forEach(function(S){var k=pT(S,2),D=k[0],T=k[1];return I[D]=I[T]}),I.resetProps=function(){return g.forEach(function(S){I[S.name](S.defaultVal)}),I},I.resetProps(),w._rerender=E,v&&A&&I(A),I}}var Tt=function(e){return typeof e=="function"?e:typeof e=="string"?function(n){return n[e]}:function(n){return e}};function kc(e){"@babel/helpers - typeof";return kc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},kc(e)}var yT=/^\s+/,xT=/\s+$/;function nt(e,n){if(e=e||"",n=n||{},e instanceof nt)return e;if(!(this instanceof nt))return new nt(e,n);var i=vT(e);this._originalInput=e,this._r=i.r,this._g=i.g,this._b=i.b,this._a=i.a,this._roundA=Math.round(100*this._a)/100,this._format=n.format||i.format,this._gradientType=n.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=i.ok}nt.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var n=this.toRgb();return(n.r*299+n.g*587+n.b*114)/1e3},getLuminance:function(){var n=this.toRgb(),i,s,a,o,l,c;return i=n.r/255,s=n.g/255,a=n.b/255,i<=.03928?o=i/12.92:o=Math.pow((i+.055)/1.055,2.4),s<=.03928?l=s/12.92:l=Math.pow((s+.055)/1.055,2.4),a<=.03928?c=a/12.92:c=Math.pow((a+.055)/1.055,2.4),.2126*o+.7152*l+.0722*c},setAlpha:function(n){return this._a=Pb(n),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var n=ly(this._r,this._g,this._b);return{h:n.h*360,s:n.s,v:n.v,a:this._a}},toHsvString:function(){var n=ly(this._r,this._g,this._b),i=Math.round(n.h*360),s=Math.round(n.s*100),a=Math.round(n.v*100);return this._a==1?"hsv("+i+", "+s+"%, "+a+"%)":"hsva("+i+", "+s+"%, "+a+"%, "+this._roundA+")"},toHsl:function(){var n=oy(this._r,this._g,this._b);return{h:n.h*360,s:n.s,l:n.l,a:this._a}},toHslString:function(){var n=oy(this._r,this._g,this._b),i=Math.round(n.h*360),s=Math.round(n.s*100),a=Math.round(n.l*100);return this._a==1?"hsl("+i+", "+s+"%, "+a+"%)":"hsla("+i+", "+s+"%, "+a+"%, "+this._roundA+")"},toHex:function(n){return cy(this._r,this._g,this._b,n)},toHexString:function(n){return"#"+this.toHex(n)},toHex8:function(n){return ST(this._r,this._g,this._b,this._a,n)},toHex8String:function(n){return"#"+this.toHex8(n)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Gt(this._r,255)*100)+"%",g:Math.round(Gt(this._g,255)*100)+"%",b:Math.round(Gt(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Gt(this._r,255)*100)+"%, "+Math.round(Gt(this._g,255)*100)+"%, "+Math.round(Gt(this._b,255)*100)+"%)":"rgba("+Math.round(Gt(this._r,255)*100)+"%, "+Math.round(Gt(this._g,255)*100)+"%, "+Math.round(Gt(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:zT[cy(this._r,this._g,this._b,!0)]||!1},toFilter:function(n){var i="#"+dy(this._r,this._g,this._b,this._a),s=i,a=this._gradientType?"GradientType = 1, ":"";if(n){var o=nt(n);s="#"+dy(o._r,o._g,o._b,o._a)}return"progid:DXImageTransform.Microsoft.gradient("+a+"startColorstr="+i+",endColorstr="+s+")"},toString:function(n){var i=!!n;n=n||this._format;var s=!1,a=this._a<1&&this._a>=0,o=!i&&a&&(n==="hex"||n==="hex6"||n==="hex3"||n==="hex4"||n==="hex8"||n==="name");return o?n==="name"&&this._a===0?this.toName():this.toRgbString():(n==="rgb"&&(s=this.toRgbString()),n==="prgb"&&(s=this.toPercentageRgbString()),(n==="hex"||n==="hex6")&&(s=this.toHexString()),n==="hex3"&&(s=this.toHexString(!0)),n==="hex4"&&(s=this.toHex8String(!0)),n==="hex8"&&(s=this.toHex8String()),n==="name"&&(s=this.toName()),n==="hsl"&&(s=this.toHslString()),n==="hsv"&&(s=this.toHsvString()),s||this.toHexString())},clone:function(){return nt(this.toString())},_applyModification:function(n,i){var s=n.apply(null,[this].concat([].slice.call(i)));return this._r=s._r,this._g=s._g,this._b=s._b,this.setAlpha(s._a),this},lighten:function(){return this._applyModification(CT,arguments)},brighten:function(){return this._applyModification(AT,arguments)},darken:function(){return this._applyModification(IT,arguments)},desaturate:function(){return this._applyModification(kT,arguments)},saturate:function(){return this._applyModification(NT,arguments)},greyscale:function(){return this._applyModification(_T,arguments)},spin:function(){return this._applyModification(TT,arguments)},_applyCombination:function(n,i){return n.apply(null,[this].concat([].slice.call(i)))},analogous:function(){return this._applyCombination(OT,arguments)},complement:function(){return this._applyCombination(ET,arguments)},monochromatic:function(){return this._applyCombination(DT,arguments)},splitcomplement:function(){return this._applyCombination(PT,arguments)},triad:function(){return this._applyCombination(uy,[3])},tetrad:function(){return this._applyCombination(uy,[4])}};nt.fromRatio=function(e,n){if(kc(e)=="object"){var i={};for(var s in e)e.hasOwnProperty(s)&&(s==="a"?i[s]=e[s]:i[s]=fo(e[s]));e=i}return nt(e,n)};function vT(e){var n={r:0,g:0,b:0},i=1,s=null,a=null,o=null,l=!1,c=!1;return typeof e=="string"&&(e=LT(e)),kc(e)=="object"&&(hi(e.r)&&hi(e.g)&&hi(e.b)?(n=bT(e.r,e.g,e.b),l=!0,c=String(e.r).substr(-1)==="%"?"prgb":"rgb"):hi(e.h)&&hi(e.s)&&hi(e.v)?(s=fo(e.s),a=fo(e.v),n=wT(e.h,s,a),l=!0,c="hsv"):hi(e.h)&&hi(e.s)&&hi(e.l)&&(s=fo(e.s),o=fo(e.l),n=jT(e.h,s,o),l=!0,c="hsl"),e.hasOwnProperty("a")&&(i=e.a)),i=Pb(i),{ok:l,format:e.format||c,r:Math.min(255,Math.max(n.r,0)),g:Math.min(255,Math.max(n.g,0)),b:Math.min(255,Math.max(n.b,0)),a:i}}function bT(e,n,i){return{r:Gt(e,255)*255,g:Gt(n,255)*255,b:Gt(i,255)*255}}function oy(e,n,i){e=Gt(e,255),n=Gt(n,255),i=Gt(i,255);var s=Math.max(e,n,i),a=Math.min(e,n,i),o,l,c=(s+a)/2;if(s==a)o=l=0;else{var d=s-a;switch(l=c>.5?d/(2-s-a):d/(s+a),s){case e:o=(n-i)/d+(n<i?6:0);break;case n:o=(i-e)/d+2;break;case i:o=(e-n)/d+4;break}o/=6}return{h:o,s:l,l:c}}function jT(e,n,i){var s,a,o;e=Gt(e,360),n=Gt(n,100),i=Gt(i,100);function l(u,f,h){return h<0&&(h+=1),h>1&&(h-=1),h<1/6?u+(f-u)*6*h:h<1/2?f:h<2/3?u+(f-u)*(2/3-h)*6:u}if(n===0)s=a=o=i;else{var c=i<.5?i*(1+n):i+n-i*n,d=2*i-c;s=l(d,c,e+1/3),a=l(d,c,e),o=l(d,c,e-1/3)}return{r:s*255,g:a*255,b:o*255}}function ly(e,n,i){e=Gt(e,255),n=Gt(n,255),i=Gt(i,255);var s=Math.max(e,n,i),a=Math.min(e,n,i),o,l,c=s,d=s-a;if(l=s===0?0:d/s,s==a)o=0;else{switch(s){case e:o=(n-i)/d+(n<i?6:0);break;case n:o=(i-e)/d+2;break;case i:o=(e-n)/d+4;break}o/=6}return{h:o,s:l,v:c}}function wT(e,n,i){e=Gt(e,360)*6,n=Gt(n,100),i=Gt(i,100);var s=Math.floor(e),a=e-s,o=i*(1-n),l=i*(1-a*n),c=i*(1-(1-a)*n),d=s%6,u=[i,l,o,o,c,i][d],f=[c,i,i,l,o,o][d],h=[o,o,c,i,i,l][d];return{r:u*255,g:f*255,b:h*255}}function cy(e,n,i,s){var a=[Fr(Math.round(e).toString(16)),Fr(Math.round(n).toString(16)),Fr(Math.round(i).toString(16))];return s&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function ST(e,n,i,s,a){var o=[Fr(Math.round(e).toString(16)),Fr(Math.round(n).toString(16)),Fr(Math.round(i).toString(16)),Fr(Ob(s))];return a&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)&&o[3].charAt(0)==o[3].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function dy(e,n,i,s){var a=[Fr(Ob(s)),Fr(Math.round(e).toString(16)),Fr(Math.round(n).toString(16)),Fr(Math.round(i).toString(16))];return a.join("")}nt.equals=function(e,n){return!e||!n?!1:nt(e).toRgbString()==nt(n).toRgbString()};nt.random=function(){return nt.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function kT(e,n){n=n===0?0:n||10;var i=nt(e).toHsl();return i.s-=n/100,i.s=xd(i.s),nt(i)}function NT(e,n){n=n===0?0:n||10;var i=nt(e).toHsl();return i.s+=n/100,i.s=xd(i.s),nt(i)}function _T(e){return nt(e).desaturate(100)}function CT(e,n){n=n===0?0:n||10;var i=nt(e).toHsl();return i.l+=n/100,i.l=xd(i.l),nt(i)}function AT(e,n){n=n===0?0:n||10;var i=nt(e).toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(255*-(n/100)))),i.g=Math.max(0,Math.min(255,i.g-Math.round(255*-(n/100)))),i.b=Math.max(0,Math.min(255,i.b-Math.round(255*-(n/100)))),nt(i)}function IT(e,n){n=n===0?0:n||10;var i=nt(e).toHsl();return i.l-=n/100,i.l=xd(i.l),nt(i)}function TT(e,n){var i=nt(e).toHsl(),s=(i.h+n)%360;return i.h=s<0?360+s:s,nt(i)}function ET(e){var n=nt(e).toHsl();return n.h=(n.h+180)%360,nt(n)}function uy(e,n){if(isNaN(n)||n<=0)throw new Error("Argument to polyad must be a positive number");for(var i=nt(e).toHsl(),s=[nt(e)],a=360/n,o=1;o<n;o++)s.push(nt({h:(i.h+o*a)%360,s:i.s,l:i.l}));return s}function PT(e){var n=nt(e).toHsl(),i=n.h;return[nt(e),nt({h:(i+72)%360,s:n.s,l:n.l}),nt({h:(i+216)%360,s:n.s,l:n.l})]}function OT(e,n,i){n=n||6,i=i||30;var s=nt(e).toHsl(),a=360/i,o=[nt(e)];for(s.h=(s.h-(a*n>>1)+720)%360;--n;)s.h=(s.h+a)%360,o.push(nt(s));return o}function DT(e,n){n=n||6;for(var i=nt(e).toHsv(),s=i.h,a=i.s,o=i.v,l=[],c=1/n;n--;)l.push(nt({h:s,s:a,v:o})),o=(o+c)%1;return l}nt.mix=function(e,n,i){i=i===0?0:i||50;var s=nt(e).toRgb(),a=nt(n).toRgb(),o=i/100,l={r:(a.r-s.r)*o+s.r,g:(a.g-s.g)*o+s.g,b:(a.b-s.b)*o+s.b,a:(a.a-s.a)*o+s.a};return nt(l)};nt.readability=function(e,n){var i=nt(e),s=nt(n);return(Math.max(i.getLuminance(),s.getLuminance())+.05)/(Math.min(i.getLuminance(),s.getLuminance())+.05)};nt.isReadable=function(e,n,i){var s=nt.readability(e,n),a,o;switch(o=!1,a=WT(i),a.level+a.size){case"AAsmall":case"AAAlarge":o=s>=4.5;break;case"AAlarge":o=s>=3;break;case"AAAsmall":o=s>=7;break}return o};nt.mostReadable=function(e,n,i){var s=null,a=0,o,l,c,d;i=i||{},l=i.includeFallbackColors,c=i.level,d=i.size;for(var u=0;u<n.length;u++)o=nt.readability(e,n[u]),o>a&&(a=o,s=nt(n[u]));return nt.isReadable(e,s,{level:c,size:d})||!l?s:(i.includeFallbackColors=!1,nt.mostReadable(e,["#fff","#000"],i))};var Bf=nt.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},zT=nt.hexNames=MT(Bf);function MT(e){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[e[i]]=i);return n}function Pb(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function Gt(e,n){RT(e)&&(e="100%");var i=$T(e);return e=Math.min(n,Math.max(0,parseFloat(e))),i&&(e=parseInt(e*n,10)/100),Math.abs(e-n)<1e-6?1:e%n/parseFloat(n)}function xd(e){return Math.min(1,Math.max(0,e))}function lr(e){return parseInt(e,16)}function RT(e){return typeof e=="string"&&e.indexOf(".")!=-1&&parseFloat(e)===1}function $T(e){return typeof e=="string"&&e.indexOf("%")!=-1}function Fr(e){return e.length==1?"0"+e:""+e}function fo(e){return e<=1&&(e=e*100+"%"),e}function Ob(e){return Math.round(parseFloat(e)*255).toString(16)}function fy(e){return lr(e)/255}var $r=function(){var e="[-\\+]?\\d+%?",n="[-\\+]?\\d*\\.\\d+%?",i="(?:"+n+")|(?:"+e+")",s="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?",a="[\\s|\\(]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")[,|\\s]+("+i+")\\s*\\)?";return{CSS_UNIT:new RegExp(i),rgb:new RegExp("rgb"+s),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+s),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+s),hsva:new RegExp("hsva"+a),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function hi(e){return!!$r.CSS_UNIT.exec(e)}function LT(e){e=e.replace(yT,"").replace(xT,"").toLowerCase();var n=!1;if(Bf[e])e=Bf[e],n=!0;else if(e=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var i;return(i=$r.rgb.exec(e))?{r:i[1],g:i[2],b:i[3]}:(i=$r.rgba.exec(e))?{r:i[1],g:i[2],b:i[3],a:i[4]}:(i=$r.hsl.exec(e))?{h:i[1],s:i[2],l:i[3]}:(i=$r.hsla.exec(e))?{h:i[1],s:i[2],l:i[3],a:i[4]}:(i=$r.hsv.exec(e))?{h:i[1],s:i[2],v:i[3]}:(i=$r.hsva.exec(e))?{h:i[1],s:i[2],v:i[3],a:i[4]}:(i=$r.hex8.exec(e))?{r:lr(i[1]),g:lr(i[2]),b:lr(i[3]),a:fy(i[4]),format:n?"name":"hex8"}:(i=$r.hex6.exec(e))?{r:lr(i[1]),g:lr(i[2]),b:lr(i[3]),format:n?"name":"hex"}:(i=$r.hex4.exec(e))?{r:lr(i[1]+""+i[1]),g:lr(i[2]+""+i[2]),b:lr(i[3]+""+i[3]),a:fy(i[4]+""+i[4]),format:n?"name":"hex8"}:(i=$r.hex3.exec(e))?{r:lr(i[1]+""+i[1]),g:lr(i[2]+""+i[2]),b:lr(i[3]+""+i[3]),format:n?"name":"hex"}:!1}function WT(e){var n,i;return e=e||{level:"AA",size:"small"},n=(e.level||"AA").toUpperCase(),i=(e.size||"small").toLowerCase(),n!=="AA"&&n!=="AAA"&&(n="AA"),i!=="small"&&i!=="large"&&(i="small"),{level:n,size:i}}function Ff(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,s=Array(n);i<n;i++)s[i]=e[i];return s}function BT(e){if(Array.isArray(e))return Ff(e)}function Db(e,n,i){if(typeof e=="function"?e===n:e.has(n))return arguments.length<3?n:i;throw new TypeError("Private element is not present on this object")}function FT(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qT(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function wr(e,n){return e.get(Db(e,n))}function hy(e,n,i){FT(e,n),n.set(e,i)}function py(e,n,i){return e.set(Db(e,n),i),i}function UT(e,n){for(var i=0;i<n.length;i++){var s=n[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,XT(s.key),s)}}function HT(e,n,i){return n&&UT(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function YT(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function KT(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GT(e){return BT(e)||YT(e)||QT(e)||KT()}function VT(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function XT(e){var n=VT(e,"string");return typeof n=="symbol"?n:n+""}function QT(e,n){if(e){if(typeof e=="string")return Ff(e,n);var i={}.toString.call(e).slice(8,-1);return i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set"?Array.from(e):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Ff(e,n):void 0}}var JT=123,ZT=function(n){return"#".concat(Math.min(n,Math.pow(2,24)).toString(16).padStart(6,"0"))},zb=function(n,i,s){return(n<<16)+(i<<8)+s},eE=function(n){var i=nt(n).toRgb(),s=i.r,a=i.g,o=i.b;return zb(s,a,o)},my=function(n,i){return n*JT%Math.pow(2,i)},ms=new WeakMap,pi=new WeakMap,tE=function(){function e(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:6;qT(this,e),hy(this,ms,void 0),hy(this,pi,void 0),py(pi,this,n),this.reset()}return HT(e,[{key:"reset",value:function(){py(ms,this,["__reserved for background__"])}},{key:"register",value:function(i){if(wr(ms,this).length>=Math.pow(2,24-wr(pi,this)))return null;var s=wr(ms,this).length,a=my(s,wr(pi,this)),o=ZT(s+(a<<24-wr(pi,this)));return wr(ms,this).push(i),o}},{key:"lookup",value:function(i){if(!i)return null;var s=typeof i=="string"?eE(i):zb.apply(void 0,GT(i));if(!s)return null;var a=s&Math.pow(2,24-wr(pi,this))-1,o=s>>24-wr(pi,this)&Math.pow(2,wr(pi,this))-1;return my(a,wr(pi,this))!==o||a>=wr(ms,this).length?null:wr(ms,this)[a]}}])}(),Vo,Qt,Mb,Rb,ws,gy,$b,Lb,Wb,rp,qf,Uf,To={},Bb=[],nE=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,vd=Array.isArray;function ti(e,n){for(var i in n)e[i]=n[i];return e}function ip(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function rE(e,n,i){var s,a,o,l={};for(o in n)o=="key"?s=n[o]:o=="ref"?a=n[o]:l[o]=n[o];if(arguments.length>2&&(l.children=arguments.length>3?Vo.call(arguments,2):i),typeof e=="function"&&e.defaultProps!=null)for(o in e.defaultProps)l[o]===void 0&&(l[o]=e.defaultProps[o]);return yo(e,l,s,a,null)}function yo(e,n,i,s,a){var o={type:e,props:n,key:i,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++Mb,__i:-1,__u:0};return a==null&&Qt.vnode!=null&&Qt.vnode(o),o}function bd(e){return e.children}function ac(e,n){this.props=e,this.context=n}function ya(e,n){if(n==null)return e.__?ya(e.__,e.__i+1):null;for(var i;n<e.__k.length;n++)if((i=e.__k[n])!=null&&i.__e!=null)return i.__e;return typeof e.type=="function"?ya(e):null}function Fb(e){var n,i;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,n=0;n<e.__k.length;n++)if((i=e.__k[n])!=null&&i.__e!=null){e.__e=e.__c.base=i.__e;break}return Fb(e)}}function yy(e){(!e.__d&&(e.__d=!0)&&ws.push(e)&&!Nc.__r++||gy!=Qt.debounceRendering)&&((gy=Qt.debounceRendering)||$b)(Nc)}function Nc(){for(var e,n,i,s,a,o,l,c=1;ws.length;)ws.length>c&&ws.sort(Lb),e=ws.shift(),c=ws.length,e.__d&&(i=void 0,s=void 0,a=(s=(n=e).__v).__e,o=[],l=[],n.__P&&((i=ti({},s)).__v=s.__v+1,Qt.vnode&&Qt.vnode(i),sp(n.__P,i,s,n.__n,n.__P.namespaceURI,32&s.__u?[a]:null,o,a??ya(s),!!(32&s.__u),l),i.__v=s.__v,i.__.__k[i.__i]=i,Hb(o,i,l),s.__e=s.__=null,i.__e!=a&&Fb(i)));Nc.__r=0}function qb(e,n,i,s,a,o,l,c,d,u,f){var h,m,g,b,j,y,x,v=s&&s.__k||Bb,A=n.length;for(d=iE(i,n,v,d,A),h=0;h<A;h++)(g=i.__k[h])!=null&&(m=g.__i==-1?To:v[g.__i]||To,g.__i=h,y=sp(e,g,m,a,o,l,c,d,u,f),b=g.__e,g.ref&&m.ref!=g.ref&&(m.ref&&ap(m.ref,null,g),f.push(g.ref,g.__c||b,g)),j==null&&b!=null&&(j=b),(x=!!(4&g.__u))||m.__k===g.__k?d=Ub(g,d,e,x):typeof g.type=="function"&&y!==void 0?d=y:b&&(d=b.nextSibling),g.__u&=-7);return i.__e=j,d}function iE(e,n,i,s,a){var o,l,c,d,u,f=i.length,h=f,m=0;for(e.__k=new Array(a),o=0;o<a;o++)(l=n[o])!=null&&typeof l!="boolean"&&typeof l!="function"?(typeof l=="string"||typeof l=="number"||typeof l=="bigint"||l.constructor==String?l=e.__k[o]=yo(null,l,null,null,null):vd(l)?l=e.__k[o]=yo(bd,{children:l},null,null,null):l.constructor==null&&l.__b>0?l=e.__k[o]=yo(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):e.__k[o]=l,d=o+m,l.__=e,l.__b=e.__b+1,(u=l.__i=sE(l,i,d,h))!=-1&&(h--,(c=i[u])&&(c.__u|=2)),c==null||c.__v==null?(u==-1&&(a>f?m--:a<f&&m++),typeof l.type!="function"&&(l.__u|=4)):u!=d&&(u==d-1?m--:u==d+1?m++:(u>d?m--:m++,l.__u|=4))):e.__k[o]=null;if(h)for(o=0;o<f;o++)(c=i[o])!=null&&!(2&c.__u)&&(c.__e==s&&(s=ya(c)),Kb(c,c));return s}function Ub(e,n,i,s){var a,o;if(typeof e.type=="function"){for(a=e.__k,o=0;a&&o<a.length;o++)a[o]&&(a[o].__=e,n=Ub(a[o],n,i,s));return n}e.__e!=n&&(s&&(n&&e.type&&!n.parentNode&&(n=ya(e)),i.insertBefore(e.__e,n||null)),n=e.__e);do n=n&&n.nextSibling;while(n!=null&&n.nodeType==8);return n}function sE(e,n,i,s){var a,o,l,c=e.key,d=e.type,u=n[i],f=u!=null&&(2&u.__u)==0;if(u===null&&c==null||f&&c==u.key&&d==u.type)return i;if(s>(f?1:0)){for(a=i-1,o=i+1;a>=0||o<n.length;)if((u=n[l=a>=0?a--:o++])!=null&&!(2&u.__u)&&c==u.key&&d==u.type)return l}return-1}function xy(e,n,i){n[0]=="-"?e.setProperty(n,i??""):e[n]=i==null?"":typeof i!="number"||nE.test(n)?i:i+"px"}function _l(e,n,i,s,a){var o,l;e:if(n=="style")if(typeof i=="string")e.style.cssText=i;else{if(typeof s=="string"&&(e.style.cssText=s=""),s)for(n in s)i&&n in i||xy(e.style,n,"");if(i)for(n in i)s&&i[n]==s[n]||xy(e.style,n,i[n])}else if(n[0]=="o"&&n[1]=="n")o=n!=(n=n.replace(Wb,"$1")),l=n.toLowerCase(),n=l in e||n=="onFocusOut"||n=="onFocusIn"?l.slice(2):n.slice(2),e.l||(e.l={}),e.l[n+o]=i,i?s?i.u=s.u:(i.u=rp,e.addEventListener(n,o?Uf:qf,o)):e.removeEventListener(n,o?Uf:qf,o);else{if(a=="http://www.w3.org/2000/svg")n=n.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(n!="width"&&n!="height"&&n!="href"&&n!="list"&&n!="form"&&n!="tabIndex"&&n!="download"&&n!="rowSpan"&&n!="colSpan"&&n!="role"&&n!="popover"&&n in e)try{e[n]=i??"";break e}catch{}typeof i=="function"||(i==null||i===!1&&n[4]!="-"?e.removeAttribute(n):e.setAttribute(n,n=="popover"&&i==1?"":i))}}function vy(e){return function(n){if(this.l){var i=this.l[n.type+e];if(n.t==null)n.t=rp++;else if(n.t<i.u)return;return i(Qt.event?Qt.event(n):n)}}}function sp(e,n,i,s,a,o,l,c,d,u){var f,h,m,g,b,j,y,x,v,A,N,C,w,_,I,O,E,S=n.type;if(n.constructor!=null)return null;128&i.__u&&(d=!!(32&i.__u),o=[c=n.__e=i.__e]),(f=Qt.__b)&&f(n);e:if(typeof S=="function")try{if(x=n.props,v="prototype"in S&&S.prototype.render,A=(f=S.contextType)&&s[f.__c],N=f?A?A.props.value:f.__:s,i.__c?y=(h=n.__c=i.__c).__=h.__E:(v?n.__c=h=new S(x,N):(n.__c=h=new ac(x,N),h.constructor=S,h.render=oE),A&&A.sub(h),h.state||(h.state={}),h.__n=s,m=h.__d=!0,h.__h=[],h._sb=[]),v&&h.__s==null&&(h.__s=h.state),v&&S.getDerivedStateFromProps!=null&&(h.__s==h.state&&(h.__s=ti({},h.__s)),ti(h.__s,S.getDerivedStateFromProps(x,h.__s))),g=h.props,b=h.state,h.__v=n,m)v&&S.getDerivedStateFromProps==null&&h.componentWillMount!=null&&h.componentWillMount(),v&&h.componentDidMount!=null&&h.__h.push(h.componentDidMount);else{if(v&&S.getDerivedStateFromProps==null&&x!==g&&h.componentWillReceiveProps!=null&&h.componentWillReceiveProps(x,N),n.__v==i.__v||!h.__e&&h.shouldComponentUpdate!=null&&h.shouldComponentUpdate(x,h.__s,N)===!1){for(n.__v!=i.__v&&(h.props=x,h.state=h.__s,h.__d=!1),n.__e=i.__e,n.__k=i.__k,n.__k.some(function(k){k&&(k.__=n)}),C=0;C<h._sb.length;C++)h.__h.push(h._sb[C]);h._sb=[],h.__h.length&&l.push(h);break e}h.componentWillUpdate!=null&&h.componentWillUpdate(x,h.__s,N),v&&h.componentDidUpdate!=null&&h.__h.push(function(){h.componentDidUpdate(g,b,j)})}if(h.context=N,h.props=x,h.__P=e,h.__e=!1,w=Qt.__r,_=0,v){for(h.state=h.__s,h.__d=!1,w&&w(n),f=h.render(h.props,h.state,h.context),I=0;I<h._sb.length;I++)h.__h.push(h._sb[I]);h._sb=[]}else do h.__d=!1,w&&w(n),f=h.render(h.props,h.state,h.context),h.state=h.__s;while(h.__d&&++_<25);h.state=h.__s,h.getChildContext!=null&&(s=ti(ti({},s),h.getChildContext())),v&&!m&&h.getSnapshotBeforeUpdate!=null&&(j=h.getSnapshotBeforeUpdate(g,b)),O=f,f!=null&&f.type===bd&&f.key==null&&(O=Yb(f.props.children)),c=qb(e,vd(O)?O:[O],n,i,s,a,o,l,c,d,u),h.base=n.__e,n.__u&=-161,h.__h.length&&l.push(h),y&&(h.__E=h.__=null)}catch(k){if(n.__v=null,d||o!=null)if(k.then){for(n.__u|=d?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;o[o.indexOf(c)]=null,n.__e=c}else{for(E=o.length;E--;)ip(o[E]);Hf(n)}else n.__e=i.__e,n.__k=i.__k,k.then||Hf(n);Qt.__e(k,n,i)}else o==null&&n.__v==i.__v?(n.__k=i.__k,n.__e=i.__e):c=n.__e=aE(i.__e,n,i,s,a,o,l,d,u);return(f=Qt.diffed)&&f(n),128&n.__u?void 0:c}function Hf(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Hf)}function Hb(e,n,i){for(var s=0;s<i.length;s++)ap(i[s],i[++s],i[++s]);Qt.__c&&Qt.__c(n,e),e.some(function(a){try{e=a.__h,a.__h=[],e.some(function(o){o.call(a)})}catch(o){Qt.__e(o,a.__v)}})}function Yb(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:vd(e)?e.map(Yb):ti({},e)}function aE(e,n,i,s,a,o,l,c,d){var u,f,h,m,g,b,j,y=i.props||To,x=n.props,v=n.type;if(v=="svg"?a="http://www.w3.org/2000/svg":v=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),o!=null){for(u=0;u<o.length;u++)if((g=o[u])&&"setAttribute"in g==!!v&&(v?g.localName==v:g.nodeType==3)){e=g,o[u]=null;break}}if(e==null){if(v==null)return document.createTextNode(x);e=document.createElementNS(a,v,x.is&&x),c&&(Qt.__m&&Qt.__m(n,o),c=!1),o=null}if(v==null)y===x||c&&e.data==x||(e.data=x);else{if(o=o&&Vo.call(e.childNodes),!c&&o!=null)for(y={},u=0;u<e.attributes.length;u++)y[(g=e.attributes[u]).name]=g.value;for(u in y)if(g=y[u],u!="children"){if(u=="dangerouslySetInnerHTML")h=g;else if(!(u in x)){if(u=="value"&&"defaultValue"in x||u=="checked"&&"defaultChecked"in x)continue;_l(e,u,null,g,a)}}for(u in x)g=x[u],u=="children"?m=g:u=="dangerouslySetInnerHTML"?f=g:u=="value"?b=g:u=="checked"?j=g:c&&typeof g!="function"||y[u]===g||_l(e,u,g,y[u],a);if(f)c||h&&(f.__html==h.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),n.__k=[];else if(h&&(e.innerHTML=""),qb(n.type=="template"?e.content:e,vd(m)?m:[m],n,i,s,v=="foreignObject"?"http://www.w3.org/1999/xhtml":a,o,l,o?o[0]:i.__k&&ya(i,0),c,d),o!=null)for(u=o.length;u--;)ip(o[u]);c||(u="value",v=="progress"&&b==null?e.removeAttribute("value"):b!=null&&(b!==e[u]||v=="progress"&&!b||v=="option"&&b!=y[u])&&_l(e,u,b,y[u],a),u="checked",j!=null&&j!=e[u]&&_l(e,u,j,y[u],a))}return e}function ap(e,n,i){try{if(typeof e=="function"){var s=typeof e.__u=="function";s&&e.__u(),s&&n==null||(e.__u=e(n))}else e.current=n}catch(a){Qt.__e(a,i)}}function Kb(e,n,i){var s,a;if(Qt.unmount&&Qt.unmount(e),(s=e.ref)&&(s.current&&s.current!=e.__e||ap(s,null,n)),(s=e.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(o){Qt.__e(o,n)}s.base=s.__P=null}if(s=e.__k)for(a=0;a<s.length;a++)s[a]&&Kb(s[a],n,i||typeof e.type!="function");i||ip(e.__e),e.__c=e.__=e.__e=void 0}function oE(e,n,i){return this.constructor(e,i)}function lE(e,n,i){var s,a,o,l;n==document&&(n=document.documentElement),Qt.__&&Qt.__(e,n),a=(s=!1)?null:n.__k,o=[],l=[],sp(n,e=n.__k=rE(bd,null,[e]),a||To,To,n.namespaceURI,a?null:n.firstChild?Vo.call(n.childNodes):null,o,a?a.__e:n.firstChild,s,l),Hb(o,e,l)}function Gb(e,n,i){var s,a,o,l,c=ti({},e.props);for(o in e.type&&e.type.defaultProps&&(l=e.type.defaultProps),n)o=="key"?s=n[o]:o=="ref"?a=n[o]:c[o]=n[o]===void 0&&l!=null?l[o]:n[o];return arguments.length>2&&(c.children=arguments.length>3?Vo.call(arguments,2):i),yo(e.type,c,s||e.key,a||e.ref,null)}Vo=Bb.slice,Qt={__e:function(e,n,i,s){for(var a,o,l;n=n.__;)if((a=n.__c)&&!a.__)try{if((o=a.constructor)&&o.getDerivedStateFromError!=null&&(a.setState(o.getDerivedStateFromError(e)),l=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(e,s||{}),l=a.__d),l)return a.__E=a}catch(c){e=c}throw e}},Mb=0,Rb=function(e){return e!=null&&e.constructor==null},ac.prototype.setState=function(e,n){var i;i=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=ti({},this.state),typeof e=="function"&&(e=e(ti({},i),this.props)),e&&ti(i,e),e!=null&&this.__v&&(n&&this._sb.push(n),yy(this))},ac.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),yy(this))},ac.prototype.render=bd,ws=[],$b=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Lb=function(e,n){return e.__v.__b-n.__v.__b},Nc.__r=0,Wb=/(PointerCapture)$|Capture$/i,rp=0,qf=vy(!1),Uf=vy(!0);function by(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,s=Array(n);i<n;i++)s[i]=e[i];return s}function cE(e){if(Array.isArray(e))return e}function dE(e,n,i){return(n=gE(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function uE(e,n){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var s,a,o,l,c=[],d=!0,u=!1;try{if(o=(i=i.call(e)).next,n!==0)for(;!(d=(s=o.call(i)).done)&&(c.push(s.value),c.length!==n);d=!0);}catch(f){u=!0,a=f}finally{try{if(!d&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(u)throw a}}return c}}function fE(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function jy(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function hE(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?jy(Object(i),!0).forEach(function(s){dE(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):jy(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function pE(e,n){return cE(e)||uE(e,n)||yE(e,n)||fE()}function mE(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function gE(e){var n=mE(e,"string");return typeof n=="symbol"?n:n+""}function _c(e){"@babel/helpers - typeof";return _c=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},_c(e)}function yE(e,n){if(e){if(typeof e=="string")return by(e,n);var i={}.toString.call(e).slice(8,-1);return i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set"?Array.from(e):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?by(e,n):void 0}}var Yf=function(n){if(_c(n)!=="object")return n;var i=Gb(n);if(i.props){var s;i.props=hE({},i.props),i!=null&&(s=i.props)!==null&&s!==void 0&&s.children&&(i.props.children=Array.isArray(i.props.children)?i.props.children.map(Yf):Yf(i.props.children))}return i},xE=function(n){return Rb(Gb(n))},vE=function(n,i){delete i.__k,lE(Yf(n),i)};function bE(e,n){n===void 0&&(n={});var i=n.insertAt;if(!(typeof document>"u")){var s=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",i==="top"&&s.firstChild?s.insertBefore(a,s.firstChild):s.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var jE=`.float-tooltip-kap {
  position: absolute;
  width: max-content; /* prevent shrinking near right edge */
  max-width: max(50%, 150px);
  padding: 3px 5px;
  border-radius: 3px;
  font: 12px sans-serif;
  color: #eee;
  background: rgba(0,0,0,0.6);
  pointer-events: none;
}
`;bE(jE);var wE=np({props:{content:{default:!1},offsetX:{triggerUpdate:!1},offsetY:{triggerUpdate:!1}},init:function(n,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},a=s.style,o=a===void 0?{}:a,l=!!n&&_c(n)==="object"&&!!n.node&&typeof n.node=="function",c=Cr(l?n.node():n);c.style("position")==="static"&&c.style("position","relative"),i.tooltipEl=c.append("div").attr("class","float-tooltip-kap"),Object.entries(o).forEach(function(u){var f=pE(u,2),h=f[0],m=f[1];return i.tooltipEl.style(h,m)}),i.tooltipEl.style("left","-10000px").style("display","none");var d="tooltip-".concat(Math.round(Math.random()*1e12));i.mouseInside=!1,c.on("mousemove.".concat(d),function(u){i.mouseInside=!0;var f=Jr(u),h=c.node(),m=h.offsetWidth,g=h.offsetHeight,b=[i.offsetX===null||i.offsetX===void 0?"-".concat(f[0]/m*100,"%"):typeof i.offsetX=="number"?"calc(-50% + ".concat(i.offsetX,"px)"):i.offsetX,i.offsetY===null||i.offsetY===void 0?g>130&&g-f[1]<100?"calc(-100% - 6px)":"21px":typeof i.offsetY=="number"?i.offsetY<0?"calc(-100% - ".concat(Math.abs(i.offsetY),"px)"):"".concat(i.offsetY,"px"):i.offsetY];i.tooltipEl.style("left",f[0]+"px").style("top",f[1]+"px").style("transform","translate(".concat(b.join(","),")")),i.content&&i.tooltipEl.style("display","inline")}),c.on("mouseover.".concat(d),function(){i.mouseInside=!0,i.content&&i.tooltipEl.style("display","inline")}),c.on("mouseout.".concat(d),function(){i.mouseInside=!1,i.tooltipEl.style("display","none")})},update:function(n){n.tooltipEl.style("display",n.content&&n.mouseInside?"inline":"none"),n.content?n.content instanceof HTMLElement?(n.tooltipEl.text(""),n.tooltipEl.append(function(){return n.content})):typeof n.content=="string"?n.tooltipEl.html(n.content):xE(n.content)?(n.tooltipEl.text(""),vE(n.content,n.tooltipEl.node())):(n.tooltipEl.style("display","none"),console.warn("Tooltip content is invalid, skipping.",n.content,n.content.toString())):n.tooltipEl.text("")}});function SE(e,n,i){var s,a=1;e==null&&(e=0),n==null&&(n=0),i==null&&(i=0);function o(){var l,c=s.length,d,u=0,f=0,h=0;for(l=0;l<c;++l)d=s[l],u+=d.x||0,f+=d.y||0,h+=d.z||0;for(u=(u/c-e)*a,f=(f/c-n)*a,h=(h/c-i)*a,l=0;l<c;++l)d=s[l],u&&(d.x-=u),f&&(d.y-=f),h&&(d.z-=h)}return o.initialize=function(l){s=l},o.x=function(l){return arguments.length?(e=+l,o):e},o.y=function(l){return arguments.length?(n=+l,o):n},o.z=function(l){return arguments.length?(i=+l,o):i},o.strength=function(l){return arguments.length?(a=+l,o):a},o}function kE(e){const n=+this._x.call(null,e);return Vb(this.cover(n),n,e)}function Vb(e,n,i){if(isNaN(n))return e;var s,a=e._root,o={data:i},l=e._x0,c=e._x1,d,u,f,h,m;if(!a)return e._root=o,e;for(;a.length;)if((f=n>=(d=(l+c)/2))?l=d:c=d,s=a,!(a=a[h=+f]))return s[h]=o,e;if(u=+e._x.call(null,a.data),n===u)return o.next=a,s?s[h]=o:e._root=o,e;do s=s?s[h]=new Array(2):e._root=new Array(2),(f=n>=(d=(l+c)/2))?l=d:c=d;while((h=+f)==(m=+(u>=d)));return s[m]=a,s[h]=o,e}function NE(e){Array.isArray(e)||(e=Array.from(e));const n=e.length,i=new Float64Array(n);let s=1/0,a=-1/0;for(let o=0,l;o<n;++o)isNaN(l=+this._x.call(null,e[o]))||(i[o]=l,l<s&&(s=l),l>a&&(a=l));if(s>a)return this;this.cover(s).cover(a);for(let o=0;o<n;++o)Vb(this,i[o],e[o]);return this}function _E(e){if(isNaN(e=+e))return this;var n=this._x0,i=this._x1;if(isNaN(n))i=(n=Math.floor(e))+1;else{for(var s=i-n||1,a=this._root,o,l;n>e||e>=i;)switch(l=+(e<n),o=new Array(2),o[l]=a,a=o,s*=2,l){case 0:i=n+s;break;case 1:n=i-s;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._x1=i,this}function CE(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e}function AE(e){return arguments.length?this.cover(+e[0][0]).cover(+e[1][0]):isNaN(this._x0)?void 0:[[this._x0],[this._x1]]}function _i(e,n,i){this.node=e,this.x0=n,this.x1=i}function IE(e,n){var i,s=this._x0,a,o,l=this._x1,c=[],d=this._root,u,f;for(d&&c.push(new _i(d,s,l)),n==null?n=1/0:(s=e-n,l=e+n);u=c.pop();)if(!(!(d=u.node)||(a=u.x0)>l||(o=u.x1)<s))if(d.length){var h=(a+o)/2;c.push(new _i(d[1],h,o),new _i(d[0],a,h)),(f=+(e>=h))&&(u=c[c.length-1],c[c.length-1]=c[c.length-1-f],c[c.length-1-f]=u)}else{var m=Math.abs(e-+this._x.call(null,d.data));m<n&&(n=m,s=e-m,l=e+m,i=d.data)}return i}function TE(e){if(isNaN(d=+this._x.call(null,e)))return this;var n,i=this._root,s,a,o,l=this._x0,c=this._x1,d,u,f,h,m;if(!i)return this;if(i.length)for(;;){if((f=d>=(u=(l+c)/2))?l=u:c=u,n=i,!(i=i[h=+f]))return this;if(!i.length)break;n[h+1&1]&&(s=n,m=h)}for(;i.data!==e;)if(a=i,!(i=i.next))return this;return(o=i.next)&&delete i.next,a?(o?a.next=o:delete a.next,this):n?(o?n[h]=o:delete n[h],(i=n[0]||n[1])&&i===(n[1]||n[0])&&!i.length&&(s?s[m]=i:this._root=i),this):(this._root=o,this)}function EE(e){for(var n=0,i=e.length;n<i;++n)this.remove(e[n]);return this}function PE(){return this._root}function OE(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e}function DE(e){var n=[],i,s=this._root,a,o,l;for(s&&n.push(new _i(s,this._x0,this._x1));i=n.pop();)if(!e(s=i.node,o=i.x0,l=i.x1)&&s.length){var c=(o+l)/2;(a=s[1])&&n.push(new _i(a,c,l)),(a=s[0])&&n.push(new _i(a,o,c))}return this}function zE(e){var n=[],i=[],s;for(this._root&&n.push(new _i(this._root,this._x0,this._x1));s=n.pop();){var a=s.node;if(a.length){var o,l=s.x0,c=s.x1,d=(l+c)/2;(o=a[0])&&n.push(new _i(o,l,d)),(o=a[1])&&n.push(new _i(o,d,c))}i.push(s)}for(;s=i.pop();)e(s.node,s.x0,s.x1);return this}function ME(e){return e[0]}function RE(e){return arguments.length?(this._x=e,this):this._x}function Xb(e,n){var i=new op(n??ME,NaN,NaN);return e==null?i:i.addAll(e)}function op(e,n,i){this._x=e,this._x0=n,this._x1=i,this._root=void 0}function wy(e){for(var n={data:e.data},i=n;e=e.next;)i=i.next={data:e.data};return n}var ir=Xb.prototype=op.prototype;ir.copy=function(){var e=new op(this._x,this._x0,this._x1),n=this._root,i,s;if(!n)return e;if(!n.length)return e._root=wy(n),e;for(i=[{source:n,target:e._root=new Array(2)}];n=i.pop();)for(var a=0;a<2;++a)(s=n.source[a])&&(s.length?i.push({source:s,target:n.target[a]=new Array(2)}):n.target[a]=wy(s));return e};ir.add=kE;ir.addAll=NE;ir.cover=_E;ir.data=CE;ir.extent=AE;ir.find=IE;ir.remove=TE;ir.removeAll=EE;ir.root=PE;ir.size=OE;ir.visit=DE;ir.visitAfter=zE;ir.x=RE;function $E(e){const n=+this._x.call(null,e),i=+this._y.call(null,e);return Qb(this.cover(n,i),n,i,e)}function Qb(e,n,i,s){if(isNaN(n)||isNaN(i))return e;var a,o=e._root,l={data:s},c=e._x0,d=e._y0,u=e._x1,f=e._y1,h,m,g,b,j,y,x,v;if(!o)return e._root=l,e;for(;o.length;)if((j=n>=(h=(c+u)/2))?c=h:u=h,(y=i>=(m=(d+f)/2))?d=m:f=m,a=o,!(o=o[x=y<<1|j]))return a[x]=l,e;if(g=+e._x.call(null,o.data),b=+e._y.call(null,o.data),n===g&&i===b)return l.next=o,a?a[x]=l:e._root=l,e;do a=a?a[x]=new Array(4):e._root=new Array(4),(j=n>=(h=(c+u)/2))?c=h:u=h,(y=i>=(m=(d+f)/2))?d=m:f=m;while((x=y<<1|j)===(v=(b>=m)<<1|g>=h));return a[v]=o,a[x]=l,e}function LE(e){var n,i,s=e.length,a,o,l=new Array(s),c=new Array(s),d=1/0,u=1/0,f=-1/0,h=-1/0;for(i=0;i<s;++i)isNaN(a=+this._x.call(null,n=e[i]))||isNaN(o=+this._y.call(null,n))||(l[i]=a,c[i]=o,a<d&&(d=a),a>f&&(f=a),o<u&&(u=o),o>h&&(h=o));if(d>f||u>h)return this;for(this.cover(d,u).cover(f,h),i=0;i<s;++i)Qb(this,l[i],c[i],e[i]);return this}function WE(e,n){if(isNaN(e=+e)||isNaN(n=+n))return this;var i=this._x0,s=this._y0,a=this._x1,o=this._y1;if(isNaN(i))a=(i=Math.floor(e))+1,o=(s=Math.floor(n))+1;else{for(var l=a-i||1,c=this._root,d,u;i>e||e>=a||s>n||n>=o;)switch(u=(n<s)<<1|e<i,d=new Array(4),d[u]=c,c=d,l*=2,u){case 0:a=i+l,o=s+l;break;case 1:i=a-l,o=s+l;break;case 2:a=i+l,s=o-l;break;case 3:i=a-l,s=o-l;break}this._root&&this._root.length&&(this._root=c)}return this._x0=i,this._y0=s,this._x1=a,this._y1=o,this}function BE(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e}function FE(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Vn(e,n,i,s,a){this.node=e,this.x0=n,this.y0=i,this.x1=s,this.y1=a}function qE(e,n,i){var s,a=this._x0,o=this._y0,l,c,d,u,f=this._x1,h=this._y1,m=[],g=this._root,b,j;for(g&&m.push(new Vn(g,a,o,f,h)),i==null?i=1/0:(a=e-i,o=n-i,f=e+i,h=n+i,i*=i);b=m.pop();)if(!(!(g=b.node)||(l=b.x0)>f||(c=b.y0)>h||(d=b.x1)<a||(u=b.y1)<o))if(g.length){var y=(l+d)/2,x=(c+u)/2;m.push(new Vn(g[3],y,x,d,u),new Vn(g[2],l,x,y,u),new Vn(g[1],y,c,d,x),new Vn(g[0],l,c,y,x)),(j=(n>=x)<<1|e>=y)&&(b=m[m.length-1],m[m.length-1]=m[m.length-1-j],m[m.length-1-j]=b)}else{var v=e-+this._x.call(null,g.data),A=n-+this._y.call(null,g.data),N=v*v+A*A;if(N<i){var C=Math.sqrt(i=N);a=e-C,o=n-C,f=e+C,h=n+C,s=g.data}}return s}function UE(e){if(isNaN(f=+this._x.call(null,e))||isNaN(h=+this._y.call(null,e)))return this;var n,i=this._root,s,a,o,l=this._x0,c=this._y0,d=this._x1,u=this._y1,f,h,m,g,b,j,y,x;if(!i)return this;if(i.length)for(;;){if((b=f>=(m=(l+d)/2))?l=m:d=m,(j=h>=(g=(c+u)/2))?c=g:u=g,n=i,!(i=i[y=j<<1|b]))return this;if(!i.length)break;(n[y+1&3]||n[y+2&3]||n[y+3&3])&&(s=n,x=y)}for(;i.data!==e;)if(a=i,!(i=i.next))return this;return(o=i.next)&&delete i.next,a?(o?a.next=o:delete a.next,this):n?(o?n[y]=o:delete n[y],(i=n[0]||n[1]||n[2]||n[3])&&i===(n[3]||n[2]||n[1]||n[0])&&!i.length&&(s?s[x]=i:this._root=i),this):(this._root=o,this)}function HE(e){for(var n=0,i=e.length;n<i;++n)this.remove(e[n]);return this}function YE(){return this._root}function KE(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e}function GE(e){var n=[],i,s=this._root,a,o,l,c,d;for(s&&n.push(new Vn(s,this._x0,this._y0,this._x1,this._y1));i=n.pop();)if(!e(s=i.node,o=i.x0,l=i.y0,c=i.x1,d=i.y1)&&s.length){var u=(o+c)/2,f=(l+d)/2;(a=s[3])&&n.push(new Vn(a,u,f,c,d)),(a=s[2])&&n.push(new Vn(a,o,f,u,d)),(a=s[1])&&n.push(new Vn(a,u,l,c,f)),(a=s[0])&&n.push(new Vn(a,o,l,u,f))}return this}function VE(e){var n=[],i=[],s;for(this._root&&n.push(new Vn(this._root,this._x0,this._y0,this._x1,this._y1));s=n.pop();){var a=s.node;if(a.length){var o,l=s.x0,c=s.y0,d=s.x1,u=s.y1,f=(l+d)/2,h=(c+u)/2;(o=a[0])&&n.push(new Vn(o,l,c,f,h)),(o=a[1])&&n.push(new Vn(o,f,c,d,h)),(o=a[2])&&n.push(new Vn(o,l,h,f,u)),(o=a[3])&&n.push(new Vn(o,f,h,d,u))}i.push(s)}for(;s=i.pop();)e(s.node,s.x0,s.y0,s.x1,s.y1);return this}function XE(e){return e[0]}function QE(e){return arguments.length?(this._x=e,this):this._x}function JE(e){return e[1]}function ZE(e){return arguments.length?(this._y=e,this):this._y}function lp(e,n,i){var s=new cp(n??XE,i??JE,NaN,NaN,NaN,NaN);return e==null?s:s.addAll(e)}function cp(e,n,i,s,a,o){this._x=e,this._y=n,this._x0=i,this._y0=s,this._x1=a,this._y1=o,this._root=void 0}function Sy(e){for(var n={data:e.data},i=n;e=e.next;)i=i.next={data:e.data};return n}var Jn=lp.prototype=cp.prototype;Jn.copy=function(){var e=new cp(this._x,this._y,this._x0,this._y0,this._x1,this._y1),n=this._root,i,s;if(!n)return e;if(!n.length)return e._root=Sy(n),e;for(i=[{source:n,target:e._root=new Array(4)}];n=i.pop();)for(var a=0;a<4;++a)(s=n.source[a])&&(s.length?i.push({source:s,target:n.target[a]=new Array(4)}):n.target[a]=Sy(s));return e};Jn.add=$E;Jn.addAll=LE;Jn.cover=WE;Jn.data=BE;Jn.extent=FE;Jn.find=qE;Jn.remove=UE;Jn.removeAll=HE;Jn.root=YE;Jn.size=KE;Jn.visit=GE;Jn.visitAfter=VE;Jn.x=QE;Jn.y=ZE;function e4(e){const n=+this._x.call(null,e),i=+this._y.call(null,e),s=+this._z.call(null,e);return Jb(this.cover(n,i,s),n,i,s,e)}function Jb(e,n,i,s,a){if(isNaN(n)||isNaN(i)||isNaN(s))return e;var o,l=e._root,c={data:a},d=e._x0,u=e._y0,f=e._z0,h=e._x1,m=e._y1,g=e._z1,b,j,y,x,v,A,N,C,w,_,I;if(!l)return e._root=c,e;for(;l.length;)if((N=n>=(b=(d+h)/2))?d=b:h=b,(C=i>=(j=(u+m)/2))?u=j:m=j,(w=s>=(y=(f+g)/2))?f=y:g=y,o=l,!(l=l[_=w<<2|C<<1|N]))return o[_]=c,e;if(x=+e._x.call(null,l.data),v=+e._y.call(null,l.data),A=+e._z.call(null,l.data),n===x&&i===v&&s===A)return c.next=l,o?o[_]=c:e._root=c,e;do o=o?o[_]=new Array(8):e._root=new Array(8),(N=n>=(b=(d+h)/2))?d=b:h=b,(C=i>=(j=(u+m)/2))?u=j:m=j,(w=s>=(y=(f+g)/2))?f=y:g=y;while((_=w<<2|C<<1|N)===(I=(A>=y)<<2|(v>=j)<<1|x>=b));return o[I]=l,o[_]=c,e}function t4(e){Array.isArray(e)||(e=Array.from(e));const n=e.length,i=new Float64Array(n),s=new Float64Array(n),a=new Float64Array(n);let o=1/0,l=1/0,c=1/0,d=-1/0,u=-1/0,f=-1/0;for(let h=0,m,g,b,j;h<n;++h)isNaN(g=+this._x.call(null,m=e[h]))||isNaN(b=+this._y.call(null,m))||isNaN(j=+this._z.call(null,m))||(i[h]=g,s[h]=b,a[h]=j,g<o&&(o=g),g>d&&(d=g),b<l&&(l=b),b>u&&(u=b),j<c&&(c=j),j>f&&(f=j));if(o>d||l>u||c>f)return this;this.cover(o,l,c).cover(d,u,f);for(let h=0;h<n;++h)Jb(this,i[h],s[h],a[h],e[h]);return this}function n4(e,n,i){if(isNaN(e=+e)||isNaN(n=+n)||isNaN(i=+i))return this;var s=this._x0,a=this._y0,o=this._z0,l=this._x1,c=this._y1,d=this._z1;if(isNaN(s))l=(s=Math.floor(e))+1,c=(a=Math.floor(n))+1,d=(o=Math.floor(i))+1;else{for(var u=l-s||1,f=this._root,h,m;s>e||e>=l||a>n||n>=c||o>i||i>=d;)switch(m=(i<o)<<2|(n<a)<<1|e<s,h=new Array(8),h[m]=f,f=h,u*=2,m){case 0:l=s+u,c=a+u,d=o+u;break;case 1:s=l-u,c=a+u,d=o+u;break;case 2:l=s+u,a=c-u,d=o+u;break;case 3:s=l-u,a=c-u,d=o+u;break;case 4:l=s+u,c=a+u,o=d-u;break;case 5:s=l-u,c=a+u,o=d-u;break;case 6:l=s+u,a=c-u,o=d-u;break;case 7:s=l-u,a=c-u,o=d-u;break}this._root&&this._root.length&&(this._root=f)}return this._x0=s,this._y0=a,this._z0=o,this._x1=l,this._y1=c,this._z1=d,this}function r4(){var e=[];return this.visit(function(n){if(!n.length)do e.push(n.data);while(n=n.next)}),e}function i4(e){return arguments.length?this.cover(+e[0][0],+e[0][1],+e[0][2]).cover(+e[1][0],+e[1][1],+e[1][2]):isNaN(this._x0)?void 0:[[this._x0,this._y0,this._z0],[this._x1,this._y1,this._z1]]}function $t(e,n,i,s,a,o,l){this.node=e,this.x0=n,this.y0=i,this.z0=s,this.x1=a,this.y1=o,this.z1=l}function s4(e,n,i,s){var a,o=this._x0,l=this._y0,c=this._z0,d,u,f,h,m,g,b=this._x1,j=this._y1,y=this._z1,x=[],v=this._root,A,N;for(v&&x.push(new $t(v,o,l,c,b,j,y)),s==null?s=1/0:(o=e-s,l=n-s,c=i-s,b=e+s,j=n+s,y=i+s,s*=s);A=x.pop();)if(!(!(v=A.node)||(d=A.x0)>b||(u=A.y0)>j||(f=A.z0)>y||(h=A.x1)<o||(m=A.y1)<l||(g=A.z1)<c))if(v.length){var C=(d+h)/2,w=(u+m)/2,_=(f+g)/2;x.push(new $t(v[7],C,w,_,h,m,g),new $t(v[6],d,w,_,C,m,g),new $t(v[5],C,u,_,h,w,g),new $t(v[4],d,u,_,C,w,g),new $t(v[3],C,w,f,h,m,_),new $t(v[2],d,w,f,C,m,_),new $t(v[1],C,u,f,h,w,_),new $t(v[0],d,u,f,C,w,_)),(N=(i>=_)<<2|(n>=w)<<1|e>=C)&&(A=x[x.length-1],x[x.length-1]=x[x.length-1-N],x[x.length-1-N]=A)}else{var I=e-+this._x.call(null,v.data),O=n-+this._y.call(null,v.data),E=i-+this._z.call(null,v.data),S=I*I+O*O+E*E;if(S<s){var k=Math.sqrt(s=S);o=e-k,l=n-k,c=i-k,b=e+k,j=n+k,y=i+k,a=v.data}}return a}const a4=(e,n,i,s,a,o)=>Math.sqrt((e-s)**2+(n-a)**2+(i-o)**2);function o4(e,n,i,s){const a=[],o=e-s,l=n-s,c=i-s,d=e+s,u=n+s,f=i+s;return this.visit((h,m,g,b,j,y,x)=>{if(!h.length)do{const v=h.data;a4(e,n,i,this._x(v),this._y(v),this._z(v))<=s&&a.push(v)}while(h=h.next);return m>d||g>u||b>f||j<o||y<l||x<c}),a}function l4(e){if(isNaN(m=+this._x.call(null,e))||isNaN(g=+this._y.call(null,e))||isNaN(b=+this._z.call(null,e)))return this;var n,i=this._root,s,a,o,l=this._x0,c=this._y0,d=this._z0,u=this._x1,f=this._y1,h=this._z1,m,g,b,j,y,x,v,A,N,C,w;if(!i)return this;if(i.length)for(;;){if((v=m>=(j=(l+u)/2))?l=j:u=j,(A=g>=(y=(c+f)/2))?c=y:f=y,(N=b>=(x=(d+h)/2))?d=x:h=x,n=i,!(i=i[C=N<<2|A<<1|v]))return this;if(!i.length)break;(n[C+1&7]||n[C+2&7]||n[C+3&7]||n[C+4&7]||n[C+5&7]||n[C+6&7]||n[C+7&7])&&(s=n,w=C)}for(;i.data!==e;)if(a=i,!(i=i.next))return this;return(o=i.next)&&delete i.next,a?(o?a.next=o:delete a.next,this):n?(o?n[C]=o:delete n[C],(i=n[0]||n[1]||n[2]||n[3]||n[4]||n[5]||n[6]||n[7])&&i===(n[7]||n[6]||n[5]||n[4]||n[3]||n[2]||n[1]||n[0])&&!i.length&&(s?s[w]=i:this._root=i),this):(this._root=o,this)}function c4(e){for(var n=0,i=e.length;n<i;++n)this.remove(e[n]);return this}function d4(){return this._root}function u4(){var e=0;return this.visit(function(n){if(!n.length)do++e;while(n=n.next)}),e}function f4(e){var n=[],i,s=this._root,a,o,l,c,d,u,f;for(s&&n.push(new $t(s,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));i=n.pop();)if(!e(s=i.node,o=i.x0,l=i.y0,c=i.z0,d=i.x1,u=i.y1,f=i.z1)&&s.length){var h=(o+d)/2,m=(l+u)/2,g=(c+f)/2;(a=s[7])&&n.push(new $t(a,h,m,g,d,u,f)),(a=s[6])&&n.push(new $t(a,o,m,g,h,u,f)),(a=s[5])&&n.push(new $t(a,h,l,g,d,m,f)),(a=s[4])&&n.push(new $t(a,o,l,g,h,m,f)),(a=s[3])&&n.push(new $t(a,h,m,c,d,u,g)),(a=s[2])&&n.push(new $t(a,o,m,c,h,u,g)),(a=s[1])&&n.push(new $t(a,h,l,c,d,m,g)),(a=s[0])&&n.push(new $t(a,o,l,c,h,m,g))}return this}function h4(e){var n=[],i=[],s;for(this._root&&n.push(new $t(this._root,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1));s=n.pop();){var a=s.node;if(a.length){var o,l=s.x0,c=s.y0,d=s.z0,u=s.x1,f=s.y1,h=s.z1,m=(l+u)/2,g=(c+f)/2,b=(d+h)/2;(o=a[0])&&n.push(new $t(o,l,c,d,m,g,b)),(o=a[1])&&n.push(new $t(o,m,c,d,u,g,b)),(o=a[2])&&n.push(new $t(o,l,g,d,m,f,b)),(o=a[3])&&n.push(new $t(o,m,g,d,u,f,b)),(o=a[4])&&n.push(new $t(o,l,c,b,m,g,h)),(o=a[5])&&n.push(new $t(o,m,c,b,u,g,h)),(o=a[6])&&n.push(new $t(o,l,g,b,m,f,h)),(o=a[7])&&n.push(new $t(o,m,g,b,u,f,h))}i.push(s)}for(;s=i.pop();)e(s.node,s.x0,s.y0,s.z0,s.x1,s.y1,s.z1);return this}function p4(e){return e[0]}function m4(e){return arguments.length?(this._x=e,this):this._x}function g4(e){return e[1]}function y4(e){return arguments.length?(this._y=e,this):this._y}function x4(e){return e[2]}function v4(e){return arguments.length?(this._z=e,this):this._z}function Zb(e,n,i,s){var a=new dp(n??p4,i??g4,s??x4,NaN,NaN,NaN,NaN,NaN,NaN);return e==null?a:a.addAll(e)}function dp(e,n,i,s,a,o,l,c,d){this._x=e,this._y=n,this._z=i,this._x0=s,this._y0=a,this._z0=o,this._x1=l,this._y1=c,this._z1=d,this._root=void 0}function ky(e){for(var n={data:e.data},i=n;e=e.next;)i=i.next={data:e.data};return n}var Dn=Zb.prototype=dp.prototype;Dn.copy=function(){var e=new dp(this._x,this._y,this._z,this._x0,this._y0,this._z0,this._x1,this._y1,this._z1),n=this._root,i,s;if(!n)return e;if(!n.length)return e._root=ky(n),e;for(i=[{source:n,target:e._root=new Array(8)}];n=i.pop();)for(var a=0;a<8;++a)(s=n.source[a])&&(s.length?i.push({source:s,target:n.target[a]=new Array(8)}):n.target[a]=ky(s));return e};Dn.add=e4;Dn.addAll=t4;Dn.cover=n4;Dn.data=r4;Dn.extent=i4;Dn.find=s4;Dn.findAllWithinRadius=o4;Dn.remove=l4;Dn.removeAll=c4;Dn.root=d4;Dn.size=u4;Dn.visit=f4;Dn.visitAfter=h4;Dn.x=m4;Dn.y=y4;Dn.z=v4;function wi(e){return function(){return e}}function xi(e){return(e()-.5)*1e-6}function b4(e){return e.index}function Ny(e,n){var i=e.get(n);if(!i)throw new Error("node not found: "+n);return i}function j4(e){var n=b4,i=m,s,a=wi(30),o,l,c,d,u,f,h=1;e==null&&(e=[]);function m(x){return 1/Math.min(d[x.source.index],d[x.target.index])}function g(x){for(var v=0,A=e.length;v<h;++v)for(var N=0,C,w,_,I=0,O=0,E=0,S,k;N<A;++N)C=e[N],w=C.source,_=C.target,I=_.x+_.vx-w.x-w.vx||xi(f),c>1&&(O=_.y+_.vy-w.y-w.vy||xi(f)),c>2&&(E=_.z+_.vz-w.z-w.vz||xi(f)),S=Math.sqrt(I*I+O*O+E*E),S=(S-o[N])/S*x*s[N],I*=S,O*=S,E*=S,_.vx-=I*(k=u[N]),c>1&&(_.vy-=O*k),c>2&&(_.vz-=E*k),w.vx+=I*(k=1-k),c>1&&(w.vy+=O*k),c>2&&(w.vz+=E*k)}function b(){if(l){var x,v=l.length,A=e.length,N=new Map(l.map((w,_)=>[n(w,_,l),w])),C;for(x=0,d=new Array(v);x<A;++x)C=e[x],C.index=x,typeof C.source!="object"&&(C.source=Ny(N,C.source)),typeof C.target!="object"&&(C.target=Ny(N,C.target)),d[C.source.index]=(d[C.source.index]||0)+1,d[C.target.index]=(d[C.target.index]||0)+1;for(x=0,u=new Array(A);x<A;++x)C=e[x],u[x]=d[C.source.index]/(d[C.source.index]+d[C.target.index]);s=new Array(A),j(),o=new Array(A),y()}}function j(){if(l)for(var x=0,v=e.length;x<v;++x)s[x]=+i(e[x],x,e)}function y(){if(l)for(var x=0,v=e.length;x<v;++x)o[x]=+a(e[x],x,e)}return g.initialize=function(x,...v){l=x,f=v.find(A=>typeof A=="function")||Math.random,c=v.find(A=>[1,2,3].includes(A))||2,b()},g.links=function(x){return arguments.length?(e=x,b(),g):e},g.id=function(x){return arguments.length?(n=x,g):n},g.iterations=function(x){return arguments.length?(h=+x,g):h},g.strength=function(x){return arguments.length?(i=typeof x=="function"?x:wi(+x),j(),g):i},g.distance=function(x){return arguments.length?(a=typeof x=="function"?x:wi(+x),y(),g):a},g}const w4=1664525,S4=1013904223,_y=4294967296;function k4(){let e=1;return()=>(e=(w4*e+S4)%_y)/_y}var Cy=3;function Lu(e){return e.x}function Ay(e){return e.y}function N4(e){return e.z}var _4=10,C4=Math.PI*(3-Math.sqrt(5)),A4=Math.PI*20/(9+Math.sqrt(221));function I4(e,n){n=n||2;var i=Math.min(Cy,Math.max(1,Math.round(n))),s,a=1,o=.001,l=1-Math.pow(o,1/300),c=0,d=.6,u=new Map,f=Qh(g),h=Yo("tick","end"),m=k4();e==null&&(e=[]);function g(){b(),h.call("tick",s),a<o&&(f.stop(),h.call("end",s))}function b(x){var v,A=e.length,N;x===void 0&&(x=1);for(var C=0;C<x;++C)for(a+=(c-a)*l,u.forEach(function(w){w(a)}),v=0;v<A;++v)N=e[v],N.fx==null?N.x+=N.vx*=d:(N.x=N.fx,N.vx=0),i>1&&(N.fy==null?N.y+=N.vy*=d:(N.y=N.fy,N.vy=0)),i>2&&(N.fz==null?N.z+=N.vz*=d:(N.z=N.fz,N.vz=0));return s}function j(){for(var x=0,v=e.length,A;x<v;++x){if(A=e[x],A.index=x,A.fx!=null&&(A.x=A.fx),A.fy!=null&&(A.y=A.fy),A.fz!=null&&(A.z=A.fz),isNaN(A.x)||i>1&&isNaN(A.y)||i>2&&isNaN(A.z)){var N=_4*(i>2?Math.cbrt(.5+x):i>1?Math.sqrt(.5+x):x),C=x*C4,w=x*A4;i===1?A.x=N:i===2?(A.x=N*Math.cos(C),A.y=N*Math.sin(C)):(A.x=N*Math.sin(C)*Math.cos(w),A.y=N*Math.cos(C),A.z=N*Math.sin(C)*Math.sin(w))}(isNaN(A.vx)||i>1&&isNaN(A.vy)||i>2&&isNaN(A.vz))&&(A.vx=0,i>1&&(A.vy=0),i>2&&(A.vz=0))}}function y(x){return x.initialize&&x.initialize(e,m,i),x}return j(),s={tick:b,restart:function(){return f.restart(g),s},stop:function(){return f.stop(),s},numDimensions:function(x){return arguments.length?(i=Math.min(Cy,Math.max(1,Math.round(x))),u.forEach(y),s):i},nodes:function(x){return arguments.length?(e=x,j(),u.forEach(y),s):e},alpha:function(x){return arguments.length?(a=+x,s):a},alphaMin:function(x){return arguments.length?(o=+x,s):o},alphaDecay:function(x){return arguments.length?(l=+x,s):+l},alphaTarget:function(x){return arguments.length?(c=+x,s):c},velocityDecay:function(x){return arguments.length?(d=1-x,s):1-d},randomSource:function(x){return arguments.length?(m=x,u.forEach(y),s):m},force:function(x,v){return arguments.length>1?(v==null?u.delete(x):u.set(x,y(v)),s):u.get(x)},find:function(){var x=Array.prototype.slice.call(arguments),v=x.shift()||0,A=(i>1?x.shift():null)||0,N=(i>2?x.shift():null)||0,C=x.shift()||1/0,w=0,_=e.length,I,O,E,S,k,D;for(C*=C,w=0;w<_;++w)k=e[w],I=v-k.x,O=A-(k.y||0),E=N-(k.z||0),S=I*I+O*O+E*E,S<C&&(D=k,C=S);return D},on:function(x,v){return arguments.length>1?(h.on(x,v),s):h.on(x)}}}function T4(){var e,n,i,s,a,o=wi(-30),l,c=1,d=1/0,u=.81;function f(b){var j,y=e.length,x=(n===1?Xb(e,Lu):n===2?lp(e,Lu,Ay):n===3?Zb(e,Lu,Ay,N4):null).visitAfter(m);for(a=b,j=0;j<y;++j)i=e[j],x.visit(g)}function h(){if(e){var b,j=e.length,y;for(l=new Array(j),b=0;b<j;++b)y=e[b],l[y.index]=+o(y,b,e)}}function m(b){var j=0,y,x,v=0,A,N,C,w,_=b.length;if(_){for(A=N=C=w=0;w<_;++w)(y=b[w])&&(x=Math.abs(y.value))&&(j+=y.value,v+=x,A+=x*(y.x||0),N+=x*(y.y||0),C+=x*(y.z||0));j*=Math.sqrt(4/_),b.x=A/v,n>1&&(b.y=N/v),n>2&&(b.z=C/v)}else{y=b,y.x=y.data.x,n>1&&(y.y=y.data.y),n>2&&(y.z=y.data.z);do j+=l[y.data.index];while(y=y.next)}b.value=j}function g(b,j,y,x,v){if(!b.value)return!0;var A=[y,x,v][n-1],N=b.x-i.x,C=n>1?b.y-i.y:0,w=n>2?b.z-i.z:0,_=A-j,I=N*N+C*C+w*w;if(_*_/u<I)return I<d&&(N===0&&(N=xi(s),I+=N*N),n>1&&C===0&&(C=xi(s),I+=C*C),n>2&&w===0&&(w=xi(s),I+=w*w),I<c&&(I=Math.sqrt(c*I)),i.vx+=N*b.value*a/I,n>1&&(i.vy+=C*b.value*a/I),n>2&&(i.vz+=w*b.value*a/I)),!0;if(b.length||I>=d)return;(b.data!==i||b.next)&&(N===0&&(N=xi(s),I+=N*N),n>1&&C===0&&(C=xi(s),I+=C*C),n>2&&w===0&&(w=xi(s),I+=w*w),I<c&&(I=Math.sqrt(c*I)));do b.data!==i&&(_=l[b.data.index]*a/I,i.vx+=N*_,n>1&&(i.vy+=C*_),n>2&&(i.vz+=w*_));while(b=b.next)}return f.initialize=function(b,...j){e=b,s=j.find(y=>typeof y=="function")||Math.random,n=j.find(y=>[1,2,3].includes(y))||2,h()},f.strength=function(b){return arguments.length?(o=typeof b=="function"?b:wi(+b),h(),f):o},f.distanceMin=function(b){return arguments.length?(c=b*b,f):Math.sqrt(c)},f.distanceMax=function(b){return arguments.length?(d=b*b,f):Math.sqrt(d)},f.theta=function(b){return arguments.length?(u=b*b,f):Math.sqrt(u)},f}function E4(e,n,i,s){var a,o,l=wi(.1),c,d;typeof e!="function"&&(e=wi(+e)),n==null&&(n=0),i==null&&(i=0),s==null&&(s=0);function u(h){for(var m=0,g=a.length;m<g;++m){var b=a[m],j=b.x-n||1e-6,y=(b.y||0)-i||1e-6,x=(b.z||0)-s||1e-6,v=Math.sqrt(j*j+y*y+x*x),A=(d[m]-v)*c[m]*h/v;b.vx+=j*A,o>1&&(b.vy+=y*A),o>2&&(b.vz+=x*A)}}function f(){if(a){var h,m=a.length;for(c=new Array(m),d=new Array(m),h=0;h<m;++h)d[h]=+e(a[h],h,a),c[h]=isNaN(d[h])?0:+l(a[h],h,a)}}return u.initialize=function(h,...m){a=h,o=m.find(g=>[1,2,3].includes(g))||2,f()},u.strength=function(h){return arguments.length?(l=typeof h=="function"?h:wi(+h),f(),u):l},u.radius=function(h){return arguments.length?(e=typeof h=="function"?h:wi(+h),f(),u):e},u.x=function(h){return arguments.length?(n=+h,u):n},u.y=function(h){return arguments.length?(i=+h,u):i},u.z=function(h){return arguments.length?(s=+h,u):s},u}const{abs:Ha,cos:mi,sin:Vs,acos:P4,atan2:Ya,sqrt:Qi,pow:_r}=Math;function Ka(e){return e<0?-_r(-e,1/3):_r(e,1/3)}const e1=Math.PI,Cl=2*e1,Ji=e1/2,O4=1e-6,Wu=Number.MAX_SAFE_INTEGER||9007199254740991,Bu=Number.MIN_SAFE_INTEGER||-9007199254740991,D4={x:0,y:0,z:0},We={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(e,n){const i=n(e);let s=i.x*i.x+i.y*i.y;return typeof i.z<"u"&&(s+=i.z*i.z),Qi(s)},compute:function(e,n,i){if(e===0)return n[0].t=0,n[0];const s=n.length-1;if(e===1)return n[s].t=1,n[s];const a=1-e;let o=n;if(s===0)return n[0].t=e,n[0];if(s===1){const c={x:a*o[0].x+e*o[1].x,y:a*o[0].y+e*o[1].y,t:e};return i&&(c.z=a*o[0].z+e*o[1].z),c}if(s<4){let c=a*a,d=e*e,u,f,h,m=0;s===2?(o=[o[0],o[1],o[2],D4],u=c,f=a*e*2,h=d):s===3&&(u=c*a,f=c*e*3,h=a*d*3,m=e*d);const g={x:u*o[0].x+f*o[1].x+h*o[2].x+m*o[3].x,y:u*o[0].y+f*o[1].y+h*o[2].y+m*o[3].y,t:e};return i&&(g.z=u*o[0].z+f*o[1].z+h*o[2].z+m*o[3].z),g}const l=JSON.parse(JSON.stringify(n));for(;l.length>1;){for(let c=0;c<l.length-1;c++)l[c]={x:l[c].x+(l[c+1].x-l[c].x)*e,y:l[c].y+(l[c+1].y-l[c].y)*e},typeof l[c].z<"u"&&(l[c].z=l[c].z+(l[c+1].z-l[c].z)*e);l.splice(l.length-1,1)}return l[0].t=e,l[0]},computeWithRatios:function(e,n,i,s){const a=1-e,o=i,l=n;let c=o[0],d=o[1],u=o[2],f=o[3],h;if(c*=a,d*=e,l.length===2)return h=c+d,{x:(c*l[0].x+d*l[1].x)/h,y:(c*l[0].y+d*l[1].y)/h,z:s?(c*l[0].z+d*l[1].z)/h:!1,t:e};if(c*=a,d*=2*a,u*=e*e,l.length===3)return h=c+d+u,{x:(c*l[0].x+d*l[1].x+u*l[2].x)/h,y:(c*l[0].y+d*l[1].y+u*l[2].y)/h,z:s?(c*l[0].z+d*l[1].z+u*l[2].z)/h:!1,t:e};if(c*=a,d*=1.5*a,u*=3*a,f*=e*e*e,l.length===4)return h=c+d+u+f,{x:(c*l[0].x+d*l[1].x+u*l[2].x+f*l[3].x)/h,y:(c*l[0].y+d*l[1].y+u*l[2].y+f*l[3].y)/h,z:s?(c*l[0].z+d*l[1].z+u*l[2].z+f*l[3].z)/h:!1,t:e}},derive:function(e,n){const i=[];for(let s=e,a=s.length,o=a-1;a>1;a--,o--){const l=[];for(let c=0,d;c<o;c++)d={x:o*(s[c+1].x-s[c].x),y:o*(s[c+1].y-s[c].y)},n&&(d.z=o*(s[c+1].z-s[c].z)),l.push(d);i.push(l),s=l}return i},between:function(e,n,i){return n<=e&&e<=i||We.approximately(e,n)||We.approximately(e,i)},approximately:function(e,n,i){return Ha(e-n)<=(i||O4)},length:function(e){const i=We.Tvalues.length;let s=0;for(let a=0,o;a<i;a++)o=.5*We.Tvalues[a]+.5,s+=We.Cvalues[a]*We.arcfn(o,e);return .5*s},map:function(e,n,i,s,a){const o=i-n,l=a-s,c=e-n,d=c/o;return s+l*d},lerp:function(e,n,i){const s={x:n.x+e*(i.x-n.x),y:n.y+e*(i.y-n.y)};return n.z!==void 0&&i.z!==void 0&&(s.z=n.z+e*(i.z-n.z)),s},pointToString:function(e){let n=e.x+"/"+e.y;return typeof e.z<"u"&&(n+="/"+e.z),n},pointsToString:function(e){return"["+e.map(We.pointToString).join(", ")+"]"},copy:function(e){return JSON.parse(JSON.stringify(e))},angle:function(e,n,i){const s=n.x-e.x,a=n.y-e.y,o=i.x-e.x,l=i.y-e.y,c=s*l-a*o,d=s*o+a*l;return Ya(c,d)},round:function(e,n){const i=""+e,s=i.indexOf(".");return parseFloat(i.substring(0,s+1+n))},dist:function(e,n){const i=e.x-n.x,s=e.y-n.y;return Qi(i*i+s*s)},closest:function(e,n){let i=_r(2,63),s,a;return e.forEach(function(o,l){a=We.dist(n,o),a<i&&(i=a,s=l)}),{mdist:i,mpos:s}},abcratio:function(e,n){if(n!==2&&n!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;const i=_r(e,n)+_r(1-e,n),s=i-1;return Ha(s/i)},projectionratio:function(e,n){if(n!==2&&n!==3)return!1;if(typeof e>"u")e=.5;else if(e===0||e===1)return e;const i=_r(1-e,n),s=_r(e,n)+i;return i/s},lli8:function(e,n,i,s,a,o,l,c){const d=(e*s-n*i)*(a-l)-(e-i)*(a*c-o*l),u=(e*s-n*i)*(o-c)-(n-s)*(a*c-o*l),f=(e-i)*(o-c)-(n-s)*(a-l);return f==0?!1:{x:d/f,y:u/f}},lli4:function(e,n,i,s){const a=e.x,o=e.y,l=n.x,c=n.y,d=i.x,u=i.y,f=s.x,h=s.y;return We.lli8(a,o,l,c,d,u,f,h)},lli:function(e,n){return We.lli4(e,e.c,n,n.c)},makeline:function(e,n){return new Ut(e.x,e.y,(e.x+n.x)/2,(e.y+n.y)/2,n.x,n.y)},findbbox:function(e){let n=Wu,i=Wu,s=Bu,a=Bu;return e.forEach(function(o){const l=o.bbox();n>l.x.min&&(n=l.x.min),i>l.y.min&&(i=l.y.min),s<l.x.max&&(s=l.x.max),a<l.y.max&&(a=l.y.max)}),{x:{min:n,mid:(n+s)/2,max:s,size:s-n},y:{min:i,mid:(i+a)/2,max:a,size:a-i}}},shapeintersections:function(e,n,i,s,a){if(!We.bboxoverlap(n,s))return[];const o=[],l=[e.startcap,e.forward,e.back,e.endcap],c=[i.startcap,i.forward,i.back,i.endcap];return l.forEach(function(d){d.virtual||c.forEach(function(u){if(u.virtual)return;const f=d.intersects(u,a);f.length>0&&(f.c1=d,f.c2=u,f.s1=e,f.s2=i,o.push(f))})}),o},makeshape:function(e,n,i){const s=n.points.length,a=e.points.length,o=We.makeline(n.points[s-1],e.points[0]),l=We.makeline(e.points[a-1],n.points[0]),c={startcap:o,forward:e,back:n,endcap:l,bbox:We.findbbox([o,e,n,l])};return c.intersections=function(d){return We.shapeintersections(c,c.bbox,d,d.bbox,i)},c},getminmax:function(e,n,i){if(!i)return{min:0,max:0};let s=Wu,a=Bu,o,l;i.indexOf(0)===-1&&(i=[0].concat(i)),i.indexOf(1)===-1&&i.push(1);for(let c=0,d=i.length;c<d;c++)o=i[c],l=e.get(o),l[n]<s&&(s=l[n]),l[n]>a&&(a=l[n]);return{min:s,mid:(s+a)/2,max:a,size:a-s}},align:function(e,n){const i=n.p1.x,s=n.p1.y,a=-Ya(n.p2.y-s,n.p2.x-i),o=function(l){return{x:(l.x-i)*mi(a)-(l.y-s)*Vs(a),y:(l.x-i)*Vs(a)+(l.y-s)*mi(a)}};return e.map(o)},roots:function(e,n){n=n||{p1:{x:0,y:0},p2:{x:1,y:0}};const i=e.length-1,s=We.align(e,n),a=function(_){return 0<=_&&_<=1};if(i===2){const _=s[0].y,I=s[1].y,O=s[2].y,E=_-2*I+O;if(E!==0){const S=-Qi(I*I-_*O),k=-_+I,D=-(S+k)/E,T=-(-S+k)/E;return[D,T].filter(a)}else if(I!==O&&E===0)return[(2*I-O)/(2*I-2*O)].filter(a);return[]}const o=s[0].y,l=s[1].y,c=s[2].y,d=s[3].y;let u=-o+3*l-3*c+d,f=3*o-6*l+3*c,h=-3*o+3*l,m=o;if(We.approximately(u,0)){if(We.approximately(f,0))return We.approximately(h,0)?[]:[-m/h].filter(a);const _=Qi(h*h-4*f*m),I=2*f;return[(_-h)/I,(-h-_)/I].filter(a)}f/=u,h/=u,m/=u;const g=(3*h-f*f)/3,b=g/3,j=(2*f*f*f-9*f*h+27*m)/27,y=j/2,x=y*y+b*b*b;let v,A,N,C,w;if(x<0){const _=-g/3,I=_*_*_,O=Qi(I),E=-j/(2*O),S=E<-1?-1:E>1?1:E,k=P4(S),D=Ka(O),T=2*D;return N=T*mi(k/3)-f/3,C=T*mi((k+Cl)/3)-f/3,w=T*mi((k+2*Cl)/3)-f/3,[N,C,w].filter(a)}else{if(x===0)return v=y<0?Ka(-y):-Ka(y),N=2*v-f/3,C=-v-f/3,[N,C].filter(a);{const _=Qi(x);return v=Ka(-y+_),A=Ka(y+_),[v-A-f/3].filter(a)}}},droots:function(e){if(e.length===3){const n=e[0],i=e[1],s=e[2],a=n-2*i+s;if(a!==0){const o=-Qi(i*i-n*s),l=-n+i,c=-(o+l)/a,d=-(-o+l)/a;return[c,d]}else if(i!==s&&a===0)return[(2*i-s)/(2*(i-s))];return[]}if(e.length===2){const n=e[0],i=e[1];return n!==i?[n/(n-i)]:[]}return[]},curvature:function(e,n,i,s,a){let o,l,c,d,u=0,f=0;const h=We.compute(e,n),m=We.compute(e,i),g=h.x*h.x+h.y*h.y;if(s?(o=Qi(_r(h.y*m.z-m.y*h.z,2)+_r(h.z*m.x-m.z*h.x,2)+_r(h.x*m.y-m.x*h.y,2)),l=_r(g+h.z*h.z,3/2)):(o=h.x*m.y-h.y*m.x,l=_r(g,3/2)),o===0||l===0)return{k:0,r:0};if(u=o/l,f=l/o,!a){const b=We.curvature(e-.001,n,i,s,!0).k,j=We.curvature(e+.001,n,i,s,!0).k;d=(j-u+(u-b))/2,c=(Ha(j-u)+Ha(u-b))/2}return{k:u,r:f,dk:d,adk:c}},inflections:function(e){if(e.length<4)return[];const n=We.align(e,{p1:e[0],p2:e.slice(-1)[0]}),i=n[2].x*n[1].y,s=n[3].x*n[1].y,a=n[1].x*n[2].y,o=n[3].x*n[2].y,l=18*(-3*i+2*s+3*a-o),c=18*(3*i-s-3*a),d=18*(a-i);if(We.approximately(l,0)){if(!We.approximately(c,0)){let m=-d/c;if(0<=m&&m<=1)return[m]}return[]}const u=2*l;if(We.approximately(u,0))return[];const f=c*c-4*l*d;if(f<0)return[];const h=Math.sqrt(f);return[(h-c)/u,-(c+h)/u].filter(function(m){return 0<=m&&m<=1})},bboxoverlap:function(e,n){const i=["x","y"],s=i.length;for(let a=0,o,l,c,d;a<s;a++)if(o=i[a],l=e[o].mid,c=n[o].mid,d=(e[o].size+n[o].size)/2,Ha(l-c)>=d)return!1;return!0},expandbox:function(e,n){n.x.min<e.x.min&&(e.x.min=n.x.min),n.y.min<e.y.min&&(e.y.min=n.y.min),n.z&&n.z.min<e.z.min&&(e.z.min=n.z.min),n.x.max>e.x.max&&(e.x.max=n.x.max),n.y.max>e.y.max&&(e.y.max=n.y.max),n.z&&n.z.max>e.z.max&&(e.z.max=n.z.max),e.x.mid=(e.x.min+e.x.max)/2,e.y.mid=(e.y.min+e.y.max)/2,e.z&&(e.z.mid=(e.z.min+e.z.max)/2),e.x.size=e.x.max-e.x.min,e.y.size=e.y.max-e.y.min,e.z&&(e.z.size=e.z.max-e.z.min)},pairiteration:function(e,n,i){const s=e.bbox(),a=n.bbox(),o=1e5,l=i||.5;if(s.x.size+s.y.size<l&&a.x.size+a.y.size<l)return[(o*(e._t1+e._t2)/2|0)/o+"/"+(o*(n._t1+n._t2)/2|0)/o];let c=e.split(.5),d=n.split(.5),u=[{left:c.left,right:d.left},{left:c.left,right:d.right},{left:c.right,right:d.right},{left:c.right,right:d.left}];u=u.filter(function(h){return We.bboxoverlap(h.left.bbox(),h.right.bbox())});let f=[];return u.length===0||(u.forEach(function(h){f=f.concat(We.pairiteration(h.left,h.right,l))}),f=f.filter(function(h,m){return f.indexOf(h)===m})),f},getccenter:function(e,n,i){const s=n.x-e.x,a=n.y-e.y,o=i.x-n.x,l=i.y-n.y,c=s*mi(Ji)-a*Vs(Ji),d=s*Vs(Ji)+a*mi(Ji),u=o*mi(Ji)-l*Vs(Ji),f=o*Vs(Ji)+l*mi(Ji),h=(e.x+n.x)/2,m=(e.y+n.y)/2,g=(n.x+i.x)/2,b=(n.y+i.y)/2,j=h+c,y=m+d,x=g+u,v=b+f,A=We.lli8(h,m,j,y,g,b,x,v),N=We.dist(A,e);let C=Ya(e.y-A.y,e.x-A.x),w=Ya(n.y-A.y,n.x-A.x),_=Ya(i.y-A.y,i.x-A.x),I;return C<_?((C>w||w>_)&&(C+=Cl),C>_&&(I=_,_=C,C=I)):_<w&&w<C?(I=_,_=C,C=I):_+=Cl,A.s=C,A.e=_,A.r=N,A},numberSort:function(e,n){return e-n}};class xo{constructor(n){this.curves=[],this._3d=!1,n&&(this.curves=n,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(n){return We.pointsToString(n.points)}).join(", ")+"]"}addCurve(n){this.curves.push(n),this._3d=this._3d||n._3d}length(){return this.curves.map(function(n){return n.length()}).reduce(function(n,i){return n+i})}curve(n){return this.curves[n]}bbox(){const n=this.curves;for(var i=n[0].bbox(),s=1;s<n.length;s++)We.expandbox(i,n[s].bbox());return i}offset(n){const i=[];return this.curves.forEach(function(s){i.push(...s.offset(n))}),new xo(i)}}const{abs:Ga,min:Iy,max:Ty,cos:z4,sin:M4,acos:R4,sqrt:Va}=Math,$4=Math.PI;class Ut{constructor(n){let i=n&&n.forEach?n:Array.from(arguments).slice(),s=!1;if(typeof i[0]=="object"){s=i.length;const g=[];i.forEach(function(b){["x","y","z"].forEach(function(j){typeof b[j]<"u"&&g.push(b[j])})}),i=g}let a=!1;const o=i.length;if(s){if(s>4){if(arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");a=!0}}else if(o!==6&&o!==8&&o!==9&&o!==12&&arguments.length!==1)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const l=this._3d=!a&&(o===9||o===12)||n&&n[0]&&typeof n[0].z<"u",c=this.points=[];for(let g=0,b=l?3:2;g<o;g+=b){var d={x:i[g],y:i[g+1]};l&&(d.z=i[g+2]),c.push(d)}const u=this.order=c.length-1,f=this.dims=["x","y"];l&&f.push("z"),this.dimlen=f.length;const h=We.align(c,{p1:c[0],p2:c[u]}),m=We.dist(c[0],c[u]);this._linear=h.reduce((g,b)=>g+Ga(b.y),0)<m/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(n,i,s,a){if(typeof a>"u"&&(a=.5),a===0)return new Ut(i,i,s);if(a===1)return new Ut(n,i,i);const o=Ut.getABC(2,n,i,s,a);return new Ut(n,o.A,s)}static cubicFromPoints(n,i,s,a,o){typeof a>"u"&&(a=.5);const l=Ut.getABC(3,n,i,s,a);typeof o>"u"&&(o=We.dist(i,l.C));const c=o*(1-a)/a,d=We.dist(n,s),u=(s.x-n.x)/d,f=(s.y-n.y)/d,h=o*u,m=o*f,g=c*u,b=c*f,j={x:i.x-h,y:i.y-m},y={x:i.x+g,y:i.y+b},x=l.A,v={x:x.x+(j.x-x.x)/(1-a),y:x.y+(j.y-x.y)/(1-a)},A={x:x.x+(y.x-x.x)/a,y:x.y+(y.y-x.y)/a},N={x:n.x+(v.x-n.x)/a,y:n.y+(v.y-n.y)/a},C={x:s.x+(A.x-s.x)/(1-a),y:s.y+(A.y-s.y)/(1-a)};return new Ut(n,N,C,s)}static getUtils(){return We}getUtils(){return Ut.getUtils()}static get PolyBezier(){return xo}valueOf(){return this.toString()}toString(){return We.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const n=this.points,i=n[0].x,s=n[0].y,a=["M",i,s,this.order===2?"Q":"C"];for(let o=1,l=n.length;o<l;o++)a.push(n[o].x),a.push(n[o].y);return a.join(" ")}setRatios(n){if(n.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=n,this._lut=[]}verify(){const n=this.coordDigest();n!==this._print&&(this._print=n,this.update())}coordDigest(){return this.points.map(function(n,i){return""+i+n.x+n.y+(n.z?n.z:0)}).join("")}update(){this._lut=[],this.dpoints=We.derive(this.points,this._3d),this.computedirection()}computedirection(){const n=this.points,i=We.angle(n[0],n[this.order],n[1]);this.clockwise=i>0}length(){return We.length(this.derivative.bind(this))}static getABC(n=2,i,s,a,o=.5){const l=We.projectionratio(o,n),c=1-l,d={x:l*i.x+c*a.x,y:l*i.y+c*a.y},u=We.abcratio(o,n);return{A:{x:s.x+(s.x-d.x)/u,y:s.y+(s.y-d.y)/u},B:s,C:d,S:i,E:a}}getABC(n,i){i=i||this.get(n);let s=this.points[0],a=this.points[this.order];return Ut.getABC(this.order,s,i,a,n)}getLUT(n){if(this.verify(),n=n||100,this._lut.length===n+1)return this._lut;this._lut=[],n++,this._lut=[];for(let i=0,s,a;i<n;i++)a=i/(n-1),s=this.compute(a),s.t=a,this._lut.push(s);return this._lut}on(n,i){i=i||5;const s=this.getLUT(),a=[];for(let o=0,l,c=0;o<s.length;o++)l=s[o],We.dist(l,n)<i&&(a.push(l),c+=o/s.length);return a.length?t/=a.length:!1}project(n){const i=this.getLUT(),s=i.length-1,a=We.closest(i,n),o=a.mpos,l=(o-1)/s,c=(o+1)/s,d=.1/s;let u=a.mdist,f=l,h=f,m;u+=1;for(let g;f<c+d;f+=d)m=this.compute(f),g=We.dist(n,m),g<u&&(u=g,h=f);return h=h<0?0:h>1?1:h,m=this.compute(h),m.t=h,m.d=u,m}get(n){return this.compute(n)}point(n){return this.points[n]}compute(n){return this.ratios?We.computeWithRatios(n,this.points,this.ratios,this._3d):We.compute(n,this.points,this._3d,this.ratios)}raise(){const n=this.points,i=[n[0]],s=n.length;for(let a=1,o,l;a<s;a++)o=n[a],l=n[a-1],i[a]={x:(s-a)/s*o.x+a/s*l.x,y:(s-a)/s*o.y+a/s*l.y};return i[s]=n[s-1],new Ut(i)}derivative(n){return We.compute(n,this.dpoints[0],this._3d)}dderivative(n){return We.compute(n,this.dpoints[1],this._3d)}align(){let n=this.points;return new Ut(We.align(n,{p1:n[0],p2:n[n.length-1]}))}curvature(n){return We.curvature(n,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return We.inflections(this.points)}normal(n){return this._3d?this.__normal3(n):this.__normal2(n)}__normal2(n){const i=this.derivative(n),s=Va(i.x*i.x+i.y*i.y);return{t:n,x:-i.y/s,y:i.x/s}}__normal3(n){const i=this.derivative(n),s=this.derivative(n+.01),a=Va(i.x*i.x+i.y*i.y+i.z*i.z),o=Va(s.x*s.x+s.y*s.y+s.z*s.z);i.x/=a,i.y/=a,i.z/=a,s.x/=o,s.y/=o,s.z/=o;const l={x:s.y*i.z-s.z*i.y,y:s.z*i.x-s.x*i.z,z:s.x*i.y-s.y*i.x},c=Va(l.x*l.x+l.y*l.y+l.z*l.z);l.x/=c,l.y/=c,l.z/=c;const d=[l.x*l.x,l.x*l.y-l.z,l.x*l.z+l.y,l.x*l.y+l.z,l.y*l.y,l.y*l.z-l.x,l.x*l.z-l.y,l.y*l.z+l.x,l.z*l.z];return{t:n,x:d[0]*i.x+d[1]*i.y+d[2]*i.z,y:d[3]*i.x+d[4]*i.y+d[5]*i.z,z:d[6]*i.x+d[7]*i.y+d[8]*i.z}}hull(n){let i=this.points,s=[],a=[],o=0;for(a[o++]=i[0],a[o++]=i[1],a[o++]=i[2],this.order===3&&(a[o++]=i[3]);i.length>1;){s=[];for(let l=0,c,d=i.length-1;l<d;l++)c=We.lerp(n,i[l],i[l+1]),a[o++]=c,s.push(c);i=s}return a}split(n,i){if(n===0&&i)return this.split(i).left;if(i===1)return this.split(n).right;const s=this.hull(n),a={left:this.order===2?new Ut([s[0],s[3],s[5]]):new Ut([s[0],s[4],s[7],s[9]]),right:this.order===2?new Ut([s[5],s[4],s[2]]):new Ut([s[9],s[8],s[6],s[3]]),span:s};return a.left._t1=We.map(0,0,1,this._t1,this._t2),a.left._t2=We.map(n,0,1,this._t1,this._t2),a.right._t1=We.map(n,0,1,this._t1,this._t2),a.right._t2=We.map(1,0,1,this._t1,this._t2),i?(i=We.map(i,n,1,0,1),a.right.split(i).left):a}extrema(){const n={};let i=[];return this.dims.forEach((function(s){let a=function(l){return l[s]},o=this.dpoints[0].map(a);n[s]=We.droots(o),this.order===3&&(o=this.dpoints[1].map(a),n[s]=n[s].concat(We.droots(o))),n[s]=n[s].filter(function(l){return l>=0&&l<=1}),i=i.concat(n[s].sort(We.numberSort))}).bind(this)),n.values=i.sort(We.numberSort).filter(function(s,a){return i.indexOf(s)===a}),n}bbox(){const n=this.extrema(),i={};return this.dims.forEach((function(s){i[s]=We.getminmax(this,s,n[s])}).bind(this)),i}overlaps(n){const i=this.bbox(),s=n.bbox();return We.bboxoverlap(i,s)}offset(n,i){if(typeof i<"u"){const s=this.get(n),a=this.normal(n),o={c:s,n:a,x:s.x+a.x*i,y:s.y+a.y*i};return this._3d&&(o.z=s.z+a.z*i),o}if(this._linear){const s=this.normal(0),a=this.points.map(function(o){const l={x:o.x+n*s.x,y:o.y+n*s.y};return o.z&&s.z&&(l.z=o.z+n*s.z),l});return[new Ut(a)]}return this.reduce().map(function(s){return s._linear?s.offset(n)[0]:s.scale(n)})}simple(){if(this.order===3){const a=We.angle(this.points[0],this.points[3],this.points[1]),o=We.angle(this.points[0],this.points[3],this.points[2]);if(a>0&&o<0||a<0&&o>0)return!1}const n=this.normal(0),i=this.normal(1);let s=n.x*i.x+n.y*i.y;return this._3d&&(s+=n.z*i.z),Ga(R4(s))<$4/3}reduce(){let n,i=0,s=0,a=.01,o,l=[],c=[],d=this.extrema().values;for(d.indexOf(0)===-1&&(d=[0].concat(d)),d.indexOf(1)===-1&&d.push(1),i=d[0],n=1;n<d.length;n++)s=d[n],o=this.split(i,s),o._t1=i,o._t2=s,l.push(o),i=s;return l.forEach(function(u){for(i=0,s=0;s<=1;)for(s=i+a;s<=1+a;s+=a)if(o=u.split(i,s),!o.simple()){if(s-=a,Ga(i-s)<a)return[];o=u.split(i,s),o._t1=We.map(i,0,1,u._t1,u._t2),o._t2=We.map(s,0,1,u._t1,u._t2),c.push(o),i=s;break}i<1&&(o=u.split(i,1),o._t1=We.map(i,0,1,u._t1,u._t2),o._t2=u._t2,c.push(o))}),c}translate(n,i,s){s=typeof s=="number"?s:i;const a=this.order;let o=this.points.map((l,c)=>(1-c/a)*i+c/a*s);return new Ut(this.points.map((l,c)=>({x:l.x+n.x*o[c],y:l.y+n.y*o[c]})))}scale(n){const i=this.order;let s=!1;if(typeof n=="function"&&(s=n),s&&i===2)return this.raise().scale(s);const a=this.clockwise,o=this.points;if(this._linear)return this.translate(this.normal(0),s?s(0):n,s?s(1):n);const l=s?s(0):n,c=s?s(1):n,d=[this.offset(0,10),this.offset(1,10)],u=[],f=We.lli4(d[0],d[0].c,d[1],d[1].c);if(!f)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(h){const m=u[h*i]=We.copy(o[h*i]);m.x+=(h?c:l)*d[h].n.x,m.y+=(h?c:l)*d[h].n.y}),s?([0,1].forEach(function(h){if(!(i===2&&h)){var m=o[h+1],g={x:m.x-f.x,y:m.y-f.y},b=s?s((h+1)/i):n;s&&!a&&(b=-b);var j=Va(g.x*g.x+g.y*g.y);g.x/=j,g.y/=j,u[h+1]={x:m.x+b*g.x,y:m.y+b*g.y}}}),new Ut(u)):([0,1].forEach(h=>{if(i===2&&h)return;const m=u[h*i],g=this.derivative(h),b={x:m.x+g.x,y:m.y+g.y};u[h+1]=We.lli4(m,b,f,o[h+1])}),new Ut(u))}outline(n,i,s,a){if(i=i===void 0?n:i,this._linear){const C=this.normal(0),w=this.points[0],_=this.points[this.points.length-1];let I,O,E;s===void 0&&(s=n,a=i),I={x:w.x+C.x*n,y:w.y+C.y*n},E={x:_.x+C.x*s,y:_.y+C.y*s},O={x:(I.x+E.x)/2,y:(I.y+E.y)/2};const S=[I,O,E];I={x:w.x-C.x*i,y:w.y-C.y*i},E={x:_.x-C.x*a,y:_.y-C.y*a},O={x:(I.x+E.x)/2,y:(I.y+E.y)/2};const k=[E,O,I],D=We.makeline(k[2],S[0]),T=We.makeline(S[2],k[0]),P=[D,new Ut(S),T,new Ut(k)];return new xo(P)}const o=this.reduce(),l=o.length,c=[];let d=[],u,f=0,h=this.length();const m=typeof s<"u"&&typeof a<"u";function g(C,w,_,I,O){return function(E){const S=I/_,k=(I+O)/_,D=w-C;return We.map(E,0,1,C+S*D,C+k*D)}}o.forEach(function(C){const w=C.length();m?(c.push(C.scale(g(n,s,h,f,w))),d.push(C.scale(g(-i,-a,h,f,w)))):(c.push(C.scale(n)),d.push(C.scale(-i))),f+=w}),d=d.map(function(C){return u=C.points,u[3]?C.points=[u[3],u[2],u[1],u[0]]:C.points=[u[2],u[1],u[0]],C}).reverse();const b=c[0].points[0],j=c[l-1].points[c[l-1].points.length-1],y=d[l-1].points[d[l-1].points.length-1],x=d[0].points[0],v=We.makeline(y,b),A=We.makeline(j,x),N=[v].concat(c).concat([A]).concat(d);return new xo(N)}outlineshapes(n,i,s){i=i||n;const a=this.outline(n,i).curves,o=[];for(let l=1,c=a.length;l<c/2;l++){const d=We.makeshape(a[l],a[c-l],s);d.startcap.virtual=l>1,d.endcap.virtual=l<c/2-1,o.push(d)}return o}intersects(n,i){return n?n.p1&&n.p2?this.lineIntersects(n):(n instanceof Ut&&(n=n.reduce()),this.curveintersects(this.reduce(),n,i)):this.selfintersects(i)}lineIntersects(n){const i=Iy(n.p1.x,n.p2.x),s=Iy(n.p1.y,n.p2.y),a=Ty(n.p1.x,n.p2.x),o=Ty(n.p1.y,n.p2.y);return We.roots(this.points,n).filter(l=>{var c=this.get(l);return We.between(c.x,i,a)&&We.between(c.y,s,o)})}selfintersects(n){const i=this.reduce(),s=i.length-2,a=[];for(let o=0,l,c,d;o<s;o++)c=i.slice(o,o+1),d=i.slice(o+2),l=this.curveintersects(c,d,n),a.push(...l);return a}curveintersects(n,i,s){const a=[];n.forEach(function(l){i.forEach(function(c){l.overlaps(c)&&a.push({left:l,right:c})})});let o=[];return a.forEach(function(l){const c=We.pairiteration(l.left,l.right,s);c.length>0&&(o=o.concat(c))}),o}arcs(n){return n=n||.5,this._iterate(n,[])}_error(n,i,s,a){const o=(a-s)/4,l=this.get(s+o),c=this.get(a-o),d=We.dist(n,i),u=We.dist(n,l),f=We.dist(n,c);return Ga(u-d)+Ga(f-d)}_iterate(n,i){let s=0,a=1,o;do{o=0,a=1;let l=this.get(s),c,d,u,f,h=!1,m=!1,g,b=a,j=1;do if(m=h,f=u,b=(s+a)/2,c=this.get(b),d=this.get(a),u=We.getccenter(l,c,d),u.interval={start:s,end:a},h=this._error(u,l,s,a)<=n,g=m&&!h,g||(j=a),h){if(a>=1){if(u.interval.end=j=1,f=u,a>1){let x={x:u.x+u.r*z4(u.e),y:u.y+u.r*M4(u.e)};u.e+=We.angle({x:u.x,y:u.y},x,this.get(1))}break}a=a+(a-s)/2}else a=b;while(!g&&o++<100);if(o>=100)break;f=f||u,i.push(f),s=j}while(a<1);return i}}function Kf(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,s=Array(n);i<n;i++)s[i]=e[i];return s}function L4(e){if(Array.isArray(e))return e}function W4(e){if(Array.isArray(e))return Kf(e)}function B4(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function F4(e,n){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var s,a,o,l,c=[],d=!0,u=!1;try{if(o=(i=i.call(e)).next,n!==0)for(;!(d=(s=o.call(i)).done)&&(c.push(s.value),c.length!==n);d=!0);}catch(f){u=!0,a=f}finally{try{if(!d&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(u)throw a}}return c}}function q4(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function U4(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function H4(e,n){if(e==null)return{};var i,s,a=Y4(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.includes(i)||{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function Y4(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.includes(s))continue;i[s]=e[s]}return i}function K4(e,n){return L4(e)||F4(e,n)||t1(e,n)||q4()}function G4(e){return W4(e)||B4(e)||t1(e)||U4()}function V4(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function X4(e){var n=V4(e,"string");return typeof n=="symbol"?n:n+""}function t1(e,n){if(e){if(typeof e=="string")return Kf(e,n);var i={}.toString.call(e).slice(8,-1);return i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set"?Array.from(e):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Kf(e,n):void 0}}var Q4=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,a=(n instanceof Array?n.length?n:[void 0]:[n]).map(function(c){return{keyAccessor:c,isProp:!(c instanceof Function)}}),o=e.reduce(function(c,d){var u=c,f=d;return a.forEach(function(h,m){var g=h.keyAccessor,b=h.isProp,j;if(b){var y=f,x=y[g],v=H4(y,[g].map(X4));j=x,f=v}else j=g(f,m);m+1<a.length?(u.hasOwnProperty(j)||(u[j]={}),u=u[j]):i?(u.hasOwnProperty(j)||(u[j]=[]),u[j].push(f)):u[j]=f}),c},{});i instanceof Function&&function c(d){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;u===a.length?Object.keys(d).forEach(function(f){return d[f]=i(d[f])}):Object.values(d).forEach(function(f){return c(f,u+1)})}(o);var l=o;return s&&(l=[],function c(d){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];u.length===a.length?l.push({keys:u,vals:d}):Object.entries(d).forEach(function(f){var h=K4(f,2),m=h[0],g=h[1];return c(g,[].concat(G4(u),[m]))})}(o),n instanceof Array&&n.length===0&&l.length===1&&(l[0].keys=[])),l};function Or(e,n){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(n).domain(e);break}return this}function Bi(e,n){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof n=="function"?this.interpolator(n):this.range(n);break}}return this}const Gf=Symbol("implicit");function jd(){var e=new ey,n=[],i=[],s=Gf;function a(o){let l=e.get(o);if(l===void 0){if(s!==Gf)return s;e.set(o,l=n.push(o)-1)}return i[l%i.length]}return a.domain=function(o){if(!arguments.length)return n.slice();n=[],e=new ey;for(const l of o)e.has(l)||e.set(l,n.push(l)-1);return a},a.range=function(o){return arguments.length?(i=Array.from(o),a):i.slice()},a.unknown=function(o){return arguments.length?(s=o,a):s},a.copy=function(){return jd(n,i).unknown(s)},Or.apply(a,arguments),a}function up(){var e=jd().unknown(void 0),n=e.domain,i=e.range,s=0,a=1,o,l,c=!1,d=0,u=0,f=.5;delete e.unknown;function h(){var m=n().length,g=a<s,b=g?a:s,j=g?s:a;o=(j-b)/Math.max(1,m-d+u*2),c&&(o=Math.floor(o)),b+=(j-b-o*(m-d))*f,l=o*(1-d),c&&(b=Math.round(b),l=Math.round(l));var y=DI(m).map(function(x){return b+o*x});return i(g?y.reverse():y)}return e.domain=function(m){return arguments.length?(n(m),h()):n()},e.range=function(m){return arguments.length?([s,a]=m,s=+s,a=+a,h()):[s,a]},e.rangeRound=function(m){return[s,a]=m,s=+s,a=+a,c=!0,h()},e.bandwidth=function(){return l},e.step=function(){return o},e.round=function(m){return arguments.length?(c=!!m,h()):c},e.padding=function(m){return arguments.length?(d=Math.min(1,u=+m),h()):d},e.paddingInner=function(m){return arguments.length?(d=Math.min(1,m),h()):d},e.paddingOuter=function(m){return arguments.length?(u=+m,h()):u},e.align=function(m){return arguments.length?(f=Math.max(0,Math.min(1,m)),h()):f},e.copy=function(){return up(n(),[s,a]).round(c).paddingInner(d).paddingOuter(u).align(f)},Or.apply(h(),arguments)}function n1(e){var n=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return n1(n())},e}function J4(){return n1(up.apply(null,arguments).paddingInner(1))}function Z4(e){return function(){return e}}function Cc(e){return+e}var Ey=[0,1];function Xn(e){return e}function Vf(e,n){return(n-=e=+e)?function(i){return(i-e)/n}:Z4(isNaN(n)?NaN:.5)}function eP(e,n){var i;return e>n&&(i=e,e=n,n=i),function(s){return Math.max(e,Math.min(n,s))}}function tP(e,n,i){var s=e[0],a=e[1],o=n[0],l=n[1];return a<s?(s=Vf(a,s),o=i(l,o)):(s=Vf(s,a),o=i(o,l)),function(c){return o(s(c))}}function nP(e,n,i){var s=Math.min(e.length,n.length)-1,a=new Array(s),o=new Array(s),l=-1;for(e[s]<e[0]&&(e=e.slice().reverse(),n=n.slice().reverse());++l<s;)a[l]=Vf(e[l],e[l+1]),o[l]=i(n[l],n[l+1]);return function(c){var d=Go(e,c,1,s)-1;return o[d](a[d](c))}}function Xo(e,n){return n.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function wd(){var e=Ey,n=Ey,i=Na,s,a,o,l=Xn,c,d,u;function f(){var m=Math.min(e.length,n.length);return l!==Xn&&(l=eP(e[0],e[m-1])),c=m>2?nP:tP,d=u=null,h}function h(m){return m==null||isNaN(m=+m)?o:(d||(d=c(e.map(s),n,i)))(s(l(m)))}return h.invert=function(m){return l(a((u||(u=c(n,e.map(s),Lr)))(m)))},h.domain=function(m){return arguments.length?(e=Array.from(m,Cc),f()):e.slice()},h.range=function(m){return arguments.length?(n=Array.from(m),f()):n.slice()},h.rangeRound=function(m){return n=Array.from(m),i=Vh,f()},h.clamp=function(m){return arguments.length?(l=m?!0:Xn,f()):l!==Xn},h.interpolate=function(m){return arguments.length?(i=m,f()):i},h.unknown=function(m){return arguments.length?(o=m,h):o},function(m,g){return s=m,a=g,f()}}function fp(){return wd()(Xn,Xn)}function rP(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Ac(e,n){if((i=(e=n?e.toExponential(n-1):e.toExponential()).indexOf("e"))<0)return null;var i,s=e.slice(0,i);return[s.length>1?s[0]+s.slice(2):s,+e.slice(i+1)]}function xa(e){return e=Ac(Math.abs(e)),e?e[1]:NaN}function iP(e,n){return function(i,s){for(var a=i.length,o=[],l=0,c=e[0],d=0;a>0&&c>0&&(d+c+1>s&&(c=Math.max(1,s-d)),o.push(i.substring(a-=c,a+c)),!((d+=c+1)>s));)c=e[l=(l+1)%e.length];return o.reverse().join(n)}}function sP(e){return function(n){return n.replace(/[0-9]/g,function(i){return e[+i]})}}var aP=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Eo(e){if(!(n=aP.exec(e)))throw new Error("invalid format: "+e);var n;return new hp({fill:n[1],align:n[2],sign:n[3],symbol:n[4],zero:n[5],width:n[6],comma:n[7],precision:n[8]&&n[8].slice(1),trim:n[9],type:n[10]})}Eo.prototype=hp.prototype;function hp(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}hp.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function oP(e){e:for(var n=e.length,i=1,s=-1,a;i<n;++i)switch(e[i]){case".":s=a=i;break;case"0":s===0&&(s=i),a=i;break;default:if(!+e[i])break e;s>0&&(s=0);break}return s>0?e.slice(0,s)+e.slice(a+1):e}var r1;function lP(e,n){var i=Ac(e,n);if(!i)return e+"";var s=i[0],a=i[1],o=a-(r1=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,l=s.length;return o===l?s:o>l?s+new Array(o-l+1).join("0"):o>0?s.slice(0,o)+"."+s.slice(o):"0."+new Array(1-o).join("0")+Ac(e,Math.max(0,n+o-1))[0]}function Py(e,n){var i=Ac(e,n);if(!i)return e+"";var s=i[0],a=i[1];return a<0?"0."+new Array(-a).join("0")+s:s.length>a+1?s.slice(0,a+1)+"."+s.slice(a+1):s+new Array(a-s.length+2).join("0")}const Oy={"%":(e,n)=>(e*100).toFixed(n),b:e=>Math.round(e).toString(2),c:e=>e+"",d:rP,e:(e,n)=>e.toExponential(n),f:(e,n)=>e.toFixed(n),g:(e,n)=>e.toPrecision(n),o:e=>Math.round(e).toString(8),p:(e,n)=>Py(e*100,n),r:Py,s:lP,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function Dy(e){return e}var zy=Array.prototype.map,My=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function cP(e){var n=e.grouping===void 0||e.thousands===void 0?Dy:iP(zy.call(e.grouping,Number),e.thousands+""),i=e.currency===void 0?"":e.currency[0]+"",s=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",o=e.numerals===void 0?Dy:sP(zy.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"−":e.minus+"",d=e.nan===void 0?"NaN":e.nan+"";function u(h){h=Eo(h);var m=h.fill,g=h.align,b=h.sign,j=h.symbol,y=h.zero,x=h.width,v=h.comma,A=h.precision,N=h.trim,C=h.type;C==="n"?(v=!0,C="g"):Oy[C]||(A===void 0&&(A=12),N=!0,C="g"),(y||m==="0"&&g==="=")&&(y=!0,m="0",g="=");var w=j==="$"?i:j==="#"&&/[boxX]/.test(C)?"0"+C.toLowerCase():"",_=j==="$"?s:/[%p]/.test(C)?l:"",I=Oy[C],O=/[defgprs%]/.test(C);A=A===void 0?6:/[gprs]/.test(C)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function E(S){var k=w,D=_,T,P,R;if(C==="c")D=I(S)+D,S="";else{S=+S;var Y=S<0||1/S<0;if(S=isNaN(S)?d:I(Math.abs(S),A),N&&(S=oP(S)),Y&&+S==0&&b!=="+"&&(Y=!1),k=(Y?b==="("?b:c:b==="-"||b==="("?"":b)+k,D=(C==="s"?My[8+r1/3]:"")+D+(Y&&b==="("?")":""),O){for(T=-1,P=S.length;++T<P;)if(R=S.charCodeAt(T),48>R||R>57){D=(R===46?a+S.slice(T+1):S.slice(T))+D,S=S.slice(0,T);break}}}v&&!y&&(S=n(S,1/0));var X=k.length+S.length+D.length,H=X<x?new Array(x-X+1).join(m):"";switch(v&&y&&(S=n(H+S,H.length?x-D.length:1/0),H=""),g){case"<":S=k+S+D+H;break;case"=":S=k+H+S+D;break;case"^":S=H.slice(0,X=H.length>>1)+k+S+D+H.slice(X);break;default:S=H+k+S+D;break}return o(S)}return E.toString=function(){return h+""},E}function f(h,m){var g=u((h=Eo(h),h.type="f",h)),b=Math.max(-8,Math.min(8,Math.floor(xa(m)/3)))*3,j=Math.pow(10,-b),y=My[8+b/3];return function(x){return g(j*x)+y}}return{format:u,formatPrefix:f}}var Al,pp,i1;dP({thousands:",",grouping:[3],currency:["$",""]});function dP(e){return Al=cP(e),pp=Al.format,i1=Al.formatPrefix,Al}function uP(e){return Math.max(0,-xa(Math.abs(e)))}function fP(e,n){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(xa(n)/3)))*3-xa(Math.abs(e)))}function hP(e,n){return e=Math.abs(e),n=Math.abs(n)-e,Math.max(0,xa(n)-xa(e))+1}function s1(e,n,i,s){var a=$f(e,n,i),o;switch(s=Eo(s??",f"),s.type){case"s":{var l=Math.max(Math.abs(e),Math.abs(n));return s.precision==null&&!isNaN(o=fP(a,l))&&(s.precision=o),i1(s,l)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(o=hP(a,Math.max(Math.abs(e),Math.abs(n))))&&(s.precision=o-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(o=uP(a))&&(s.precision=o-(s.type==="%")*2);break}}return pp(s)}function ls(e){var n=e.domain;return e.ticks=function(i){var s=n();return Mf(s[0],s[s.length-1],i??10)},e.tickFormat=function(i,s){var a=n();return s1(a[0],a[a.length-1],i??10,s)},e.nice=function(i){i==null&&(i=10);var s=n(),a=0,o=s.length-1,l=s[a],c=s[o],d,u,f=10;for(c<l&&(u=l,l=c,c=u,u=a,a=o,o=u);f-- >0;){if(u=Rf(l,c,i),u===d)return s[a]=l,s[o]=c,n(s);if(u>0)l=Math.floor(l/u)*u,c=Math.ceil(c/u)*u;else if(u<0)l=Math.ceil(l*u)/u,c=Math.floor(c*u)/u;else break;d=u}return e},e}function a1(){var e=fp();return e.copy=function(){return Xo(e,a1())},Or.apply(e,arguments),ls(e)}function o1(e){var n;function i(s){return s==null||isNaN(s=+s)?n:s}return i.invert=i,i.domain=i.range=function(s){return arguments.length?(e=Array.from(s,Cc),i):e.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return o1(e).unknown(n)},e=arguments.length?Array.from(e,Cc):[0,1],ls(i)}function l1(e,n){e=e.slice();var i=0,s=e.length-1,a=e[i],o=e[s],l;return o<a&&(l=i,i=s,s=l,l=a,a=o,o=l),e[i]=n.floor(a),e[s]=n.ceil(o),e}function Ry(e){return Math.log(e)}function $y(e){return Math.exp(e)}function pP(e){return-Math.log(-e)}function mP(e){return-Math.exp(-e)}function gP(e){return isFinite(e)?+("1e"+e):e<0?0:e}function yP(e){return e===10?gP:e===Math.E?Math.exp:n=>Math.pow(e,n)}function xP(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),n=>Math.log(n)/e)}function Ly(e){return(n,i)=>-e(-n,i)}function mp(e){const n=e(Ry,$y),i=n.domain;let s=10,a,o;function l(){return a=xP(s),o=yP(s),i()[0]<0?(a=Ly(a),o=Ly(o),e(pP,mP)):e(Ry,$y),n}return n.base=function(c){return arguments.length?(s=+c,l()):s},n.domain=function(c){return arguments.length?(i(c),l()):i()},n.ticks=c=>{const d=i();let u=d[0],f=d[d.length-1];const h=f<u;h&&([u,f]=[f,u]);let m=a(u),g=a(f),b,j;const y=c==null?10:+c;let x=[];if(!(s%1)&&g-m<y){if(m=Math.floor(m),g=Math.ceil(g),u>0){for(;m<=g;++m)for(b=1;b<s;++b)if(j=m<0?b/o(-m):b*o(m),!(j<u)){if(j>f)break;x.push(j)}}else for(;m<=g;++m)for(b=s-1;b>=1;--b)if(j=m>0?b/o(-m):b*o(m),!(j<u)){if(j>f)break;x.push(j)}x.length*2<y&&(x=Mf(u,f,y))}else x=Mf(m,g,Math.min(g-m,y)).map(o);return h?x.reverse():x},n.tickFormat=(c,d)=>{if(c==null&&(c=10),d==null&&(d=s===10?"s":","),typeof d!="function"&&(!(s%1)&&(d=Eo(d)).precision==null&&(d.trim=!0),d=pp(d)),c===1/0)return d;const u=Math.max(1,s*c/n.ticks().length);return f=>{let h=f/o(Math.round(a(f)));return h*s<s-.5&&(h*=s),h<=u?d(f):""}},n.nice=()=>i(l1(i(),{floor:c=>o(Math.floor(a(c))),ceil:c=>o(Math.ceil(a(c)))})),n}function c1(){const e=mp(wd()).domain([1,10]);return e.copy=()=>Xo(e,c1()).base(e.base()),Or.apply(e,arguments),e}function Wy(e){return function(n){return Math.sign(n)*Math.log1p(Math.abs(n/e))}}function By(e){return function(n){return Math.sign(n)*Math.expm1(Math.abs(n))*e}}function gp(e){var n=1,i=e(Wy(n),By(n));return i.constant=function(s){return arguments.length?e(Wy(n=+s),By(n)):n},ls(i)}function d1(){var e=gp(wd());return e.copy=function(){return Xo(e,d1()).constant(e.constant())},Or.apply(e,arguments)}function Fy(e){return function(n){return n<0?-Math.pow(-n,e):Math.pow(n,e)}}function vP(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function bP(e){return e<0?-e*e:e*e}function yp(e){var n=e(Xn,Xn),i=1;function s(){return i===1?e(Xn,Xn):i===.5?e(vP,bP):e(Fy(i),Fy(1/i))}return n.exponent=function(a){return arguments.length?(i=+a,s()):i},ls(n)}function xp(){var e=yp(wd());return e.copy=function(){return Xo(e,xp()).exponent(e.exponent())},Or.apply(e,arguments),e}function jP(){return xp.apply(null,arguments).exponent(.5)}function qy(e){return Math.sign(e)*e*e}function wP(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function u1(){var e=fp(),n=[0,1],i=!1,s;function a(o){var l=wP(e(o));return isNaN(l)?s:i?Math.round(l):l}return a.invert=function(o){return e.invert(qy(o))},a.domain=function(o){return arguments.length?(e.domain(o),a):e.domain()},a.range=function(o){return arguments.length?(e.range((n=Array.from(o,Cc)).map(qy)),a):n.slice()},a.rangeRound=function(o){return a.range(o).round(!0)},a.round=function(o){return arguments.length?(i=!!o,a):i},a.clamp=function(o){return arguments.length?(e.clamp(o),a):e.clamp()},a.unknown=function(o){return arguments.length?(s=o,a):s},a.copy=function(){return u1(e.domain(),n).round(i).clamp(e.clamp()).unknown(s)},Or.apply(a,arguments),ls(a)}function f1(){var e=[],n=[],i=[],s;function a(){var l=0,c=Math.max(1,n.length);for(i=new Array(c-1);++l<c;)i[l-1]=OI(e,l/c);return o}function o(l){return l==null||isNaN(l=+l)?s:n[Go(i,l)]}return o.invertExtent=function(l){var c=n.indexOf(l);return c<0?[NaN,NaN]:[c>0?i[c-1]:e[0],c<i.length?i[c]:e[e.length-1]]},o.domain=function(l){if(!arguments.length)return e.slice();e=[];for(let c of l)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(ns),a()},o.range=function(l){return arguments.length?(n=Array.from(l),a()):n.slice()},o.unknown=function(l){return arguments.length?(s=l,o):s},o.quantiles=function(){return i.slice()},o.copy=function(){return f1().domain(e).range(n).unknown(s)},Or.apply(o,arguments)}function h1(){var e=0,n=1,i=1,s=[.5],a=[0,1],o;function l(d){return d!=null&&d<=d?a[Go(s,d,0,i)]:o}function c(){var d=-1;for(s=new Array(i);++d<i;)s[d]=((d+1)*n-(d-i)*e)/(i+1);return l}return l.domain=function(d){return arguments.length?([e,n]=d,e=+e,n=+n,c()):[e,n]},l.range=function(d){return arguments.length?(i=(a=Array.from(d)).length-1,c()):a.slice()},l.invertExtent=function(d){var u=a.indexOf(d);return u<0?[NaN,NaN]:u<1?[e,s[0]]:u>=i?[s[i-1],n]:[s[u-1],s[u]]},l.unknown=function(d){return arguments.length&&(o=d),l},l.thresholds=function(){return s.slice()},l.copy=function(){return h1().domain([e,n]).range(a).unknown(o)},Or.apply(ls(l),arguments)}function p1(){var e=[.5],n=[0,1],i,s=1;function a(o){return o!=null&&o<=o?n[Go(e,o,0,s)]:i}return a.domain=function(o){return arguments.length?(e=Array.from(o),s=Math.min(e.length,n.length-1),a):e.slice()},a.range=function(o){return arguments.length?(n=Array.from(o),s=Math.min(e.length,n.length-1),a):n.slice()},a.invertExtent=function(o){var l=n.indexOf(o);return[e[l-1],e[l]]},a.unknown=function(o){return arguments.length?(i=o,a):i},a.copy=function(){return p1().domain(e).range(n).unknown(i)},Or.apply(a,arguments)}const Fu=new Date,qu=new Date;function jn(e,n,i,s){function a(o){return e(o=arguments.length===0?new Date:new Date(+o)),o}return a.floor=o=>(e(o=new Date(+o)),o),a.ceil=o=>(e(o=new Date(o-1)),n(o,1),e(o),o),a.round=o=>{const l=a(o),c=a.ceil(o);return o-l<c-o?l:c},a.offset=(o,l)=>(n(o=new Date(+o),l==null?1:Math.floor(l)),o),a.range=(o,l,c)=>{const d=[];if(o=a.ceil(o),c=c==null?1:Math.floor(c),!(o<l)||!(c>0))return d;let u;do d.push(u=new Date(+o)),n(o,c),e(o);while(u<o&&o<l);return d},a.filter=o=>jn(l=>{if(l>=l)for(;e(l),!o(l);)l.setTime(l-1)},(l,c)=>{if(l>=l)if(c<0)for(;++c<=0;)for(;n(l,-1),!o(l););else for(;--c>=0;)for(;n(l,1),!o(l););}),i&&(a.count=(o,l)=>(Fu.setTime(+o),qu.setTime(+l),e(Fu),e(qu),Math.floor(i(Fu,qu))),a.every=o=>(o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?a.filter(s?l=>s(l)%o===0:l=>a.count(0,l)%o===0):a)),a}const Ic=jn(()=>{},(e,n)=>{e.setTime(+e+n)},(e,n)=>n-e);Ic.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?jn(n=>{n.setTime(Math.floor(n/e)*e)},(n,i)=>{n.setTime(+n+i*e)},(n,i)=>(i-n)/e):Ic);Ic.range;const Si=1e3,Ir=Si*60,ki=Ir*60,Oi=ki*24,vp=Oi*7,Uy=Oi*30,Uu=Oi*365,ks=jn(e=>{e.setTime(e-e.getMilliseconds())},(e,n)=>{e.setTime(+e+n*Si)},(e,n)=>(n-e)/Si,e=>e.getUTCSeconds());ks.range;const bp=jn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Si)},(e,n)=>{e.setTime(+e+n*Ir)},(e,n)=>(n-e)/Ir,e=>e.getMinutes());bp.range;const jp=jn(e=>{e.setUTCSeconds(0,0)},(e,n)=>{e.setTime(+e+n*Ir)},(e,n)=>(n-e)/Ir,e=>e.getUTCMinutes());jp.range;const wp=jn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Si-e.getMinutes()*Ir)},(e,n)=>{e.setTime(+e+n*ki)},(e,n)=>(n-e)/ki,e=>e.getHours());wp.range;const Sp=jn(e=>{e.setUTCMinutes(0,0,0)},(e,n)=>{e.setTime(+e+n*ki)},(e,n)=>(n-e)/ki,e=>e.getUTCHours());Sp.range;const Qo=jn(e=>e.setHours(0,0,0,0),(e,n)=>e.setDate(e.getDate()+n),(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Ir)/Oi,e=>e.getDate()-1);Qo.range;const Sd=jn(e=>{e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n)},(e,n)=>(n-e)/Oi,e=>e.getUTCDate()-1);Sd.range;const m1=jn(e=>{e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n)},(e,n)=>(n-e)/Oi,e=>Math.floor(e/Oi));m1.range;function qs(e){return jn(n=>{n.setDate(n.getDate()-(n.getDay()+7-e)%7),n.setHours(0,0,0,0)},(n,i)=>{n.setDate(n.getDate()+i*7)},(n,i)=>(i-n-(i.getTimezoneOffset()-n.getTimezoneOffset())*Ir)/vp)}const kd=qs(0),Tc=qs(1),SP=qs(2),kP=qs(3),va=qs(4),NP=qs(5),_P=qs(6);kd.range;Tc.range;SP.range;kP.range;va.range;NP.range;_P.range;function Us(e){return jn(n=>{n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-e)%7),n.setUTCHours(0,0,0,0)},(n,i)=>{n.setUTCDate(n.getUTCDate()+i*7)},(n,i)=>(i-n)/vp)}const Nd=Us(0),Ec=Us(1),CP=Us(2),AP=Us(3),ba=Us(4),IP=Us(5),TP=Us(6);Nd.range;Ec.range;CP.range;AP.range;ba.range;IP.range;TP.range;const kp=jn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,n)=>{e.setMonth(e.getMonth()+n)},(e,n)=>n.getMonth()-e.getMonth()+(n.getFullYear()-e.getFullYear())*12,e=>e.getMonth());kp.range;const Np=jn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCMonth(e.getUTCMonth()+n)},(e,n)=>n.getUTCMonth()-e.getUTCMonth()+(n.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());Np.range;const Di=jn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n)},(e,n)=>n.getFullYear()-e.getFullYear(),e=>e.getFullYear());Di.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:jn(n=>{n.setFullYear(Math.floor(n.getFullYear()/e)*e),n.setMonth(0,1),n.setHours(0,0,0,0)},(n,i)=>{n.setFullYear(n.getFullYear()+i*e)});Di.range;const zi=jn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n)},(e,n)=>n.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());zi.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:jn(n=>{n.setUTCFullYear(Math.floor(n.getUTCFullYear()/e)*e),n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,i)=>{n.setUTCFullYear(n.getUTCFullYear()+i*e)});zi.range;function g1(e,n,i,s,a,o){const l=[[ks,1,Si],[ks,5,5*Si],[ks,15,15*Si],[ks,30,30*Si],[o,1,Ir],[o,5,5*Ir],[o,15,15*Ir],[o,30,30*Ir],[a,1,ki],[a,3,3*ki],[a,6,6*ki],[a,12,12*ki],[s,1,Oi],[s,2,2*Oi],[i,1,vp],[n,1,Uy],[n,3,3*Uy],[e,1,Uu]];function c(u,f,h){const m=f<u;m&&([u,f]=[f,u]);const g=h&&typeof h.range=="function"?h:d(u,f,h),b=g?g.range(u,+f+1):[];return m?b.reverse():b}function d(u,f,h){const m=Math.abs(f-u)/h,g=tp(([,,y])=>y).right(l,m);if(g===l.length)return e.every($f(u/Uu,f/Uu,h));if(g===0)return Ic.every(Math.max($f(u,f,h),1));const[b,j]=l[m/l[g-1][2]<l[g][2]/m?g-1:g];return b.every(j)}return[c,d]}const[EP,PP]=g1(zi,Np,Nd,m1,Sp,jp),[OP,DP]=g1(Di,kp,kd,Qo,wp,bp);function Hu(e){if(0<=e.y&&e.y<100){var n=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return n.setFullYear(e.y),n}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Yu(e){if(0<=e.y&&e.y<100){var n=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return n.setUTCFullYear(e.y),n}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Xa(e,n,i){return{y:e,m:n,d:i,H:0,M:0,S:0,L:0}}function zP(e){var n=e.dateTime,i=e.date,s=e.time,a=e.periods,o=e.days,l=e.shortDays,c=e.months,d=e.shortMonths,u=Qa(a),f=Ja(a),h=Qa(o),m=Ja(o),g=Qa(l),b=Ja(l),j=Qa(c),y=Ja(c),x=Qa(d),v=Ja(d),A={a:Y,A:X,b:H,B:q,c:null,d:Xy,e:Xy,f:i8,g:p8,G:g8,H:t8,I:n8,j:r8,L:y1,m:s8,M:a8,p:M,q:L,Q:Zy,s:ex,S:o8,u:l8,U:c8,V:d8,w:u8,W:f8,x:null,X:null,y:h8,Y:m8,Z:y8,"%":Jy},N={a:B,A:F,b:te,B:$,c:null,d:Qy,e:Qy,f:j8,g:E8,G:O8,H:x8,I:v8,j:b8,L:v1,m:w8,M:S8,p:W,q:U,Q:Zy,s:ex,S:k8,u:N8,U:_8,V:C8,w:A8,W:I8,x:null,X:null,y:T8,Y:P8,Z:D8,"%":Jy},C={a:E,A:S,b:k,B:D,c:T,d:Gy,e:Gy,f:QP,g:Ky,G:Yy,H:Vy,I:Vy,j:KP,L:XP,m:YP,M:GP,p:O,q:HP,Q:ZP,s:e8,S:VP,u:WP,U:BP,V:FP,w:LP,W:qP,x:P,X:R,y:Ky,Y:Yy,Z:UP,"%":JP};A.x=w(i,A),A.X=w(s,A),A.c=w(n,A),N.x=w(i,N),N.X=w(s,N),N.c=w(n,N);function w(Z,ee){return function(K){var ne=[],pe=-1,G=0,ae=Z.length,ie,J,re;for(K instanceof Date||(K=new Date(+K));++pe<ae;)Z.charCodeAt(pe)===37&&(ne.push(Z.slice(G,pe)),(J=Hy[ie=Z.charAt(++pe)])!=null?ie=Z.charAt(++pe):J=ie==="e"?" ":"0",(re=ee[ie])&&(ie=re(K,J)),ne.push(ie),G=pe+1);return ne.push(Z.slice(G,pe)),ne.join("")}}function _(Z,ee){return function(K){var ne=Xa(1900,void 0,1),pe=I(ne,Z,K+="",0),G,ae;if(pe!=K.length)return null;if("Q"in ne)return new Date(ne.Q);if("s"in ne)return new Date(ne.s*1e3+("L"in ne?ne.L:0));if(ee&&!("Z"in ne)&&(ne.Z=0),"p"in ne&&(ne.H=ne.H%12+ne.p*12),ne.m===void 0&&(ne.m="q"in ne?ne.q:0),"V"in ne){if(ne.V<1||ne.V>53)return null;"w"in ne||(ne.w=1),"Z"in ne?(G=Yu(Xa(ne.y,0,1)),ae=G.getUTCDay(),G=ae>4||ae===0?Ec.ceil(G):Ec(G),G=Sd.offset(G,(ne.V-1)*7),ne.y=G.getUTCFullYear(),ne.m=G.getUTCMonth(),ne.d=G.getUTCDate()+(ne.w+6)%7):(G=Hu(Xa(ne.y,0,1)),ae=G.getDay(),G=ae>4||ae===0?Tc.ceil(G):Tc(G),G=Qo.offset(G,(ne.V-1)*7),ne.y=G.getFullYear(),ne.m=G.getMonth(),ne.d=G.getDate()+(ne.w+6)%7)}else("W"in ne||"U"in ne)&&("w"in ne||(ne.w="u"in ne?ne.u%7:"W"in ne?1:0),ae="Z"in ne?Yu(Xa(ne.y,0,1)).getUTCDay():Hu(Xa(ne.y,0,1)).getDay(),ne.m=0,ne.d="W"in ne?(ne.w+6)%7+ne.W*7-(ae+5)%7:ne.w+ne.U*7-(ae+6)%7);return"Z"in ne?(ne.H+=ne.Z/100|0,ne.M+=ne.Z%100,Yu(ne)):Hu(ne)}}function I(Z,ee,K,ne){for(var pe=0,G=ee.length,ae=K.length,ie,J;pe<G;){if(ne>=ae)return-1;if(ie=ee.charCodeAt(pe++),ie===37){if(ie=ee.charAt(pe++),J=C[ie in Hy?ee.charAt(pe++):ie],!J||(ne=J(Z,K,ne))<0)return-1}else if(ie!=K.charCodeAt(ne++))return-1}return ne}function O(Z,ee,K){var ne=u.exec(ee.slice(K));return ne?(Z.p=f.get(ne[0].toLowerCase()),K+ne[0].length):-1}function E(Z,ee,K){var ne=g.exec(ee.slice(K));return ne?(Z.w=b.get(ne[0].toLowerCase()),K+ne[0].length):-1}function S(Z,ee,K){var ne=h.exec(ee.slice(K));return ne?(Z.w=m.get(ne[0].toLowerCase()),K+ne[0].length):-1}function k(Z,ee,K){var ne=x.exec(ee.slice(K));return ne?(Z.m=v.get(ne[0].toLowerCase()),K+ne[0].length):-1}function D(Z,ee,K){var ne=j.exec(ee.slice(K));return ne?(Z.m=y.get(ne[0].toLowerCase()),K+ne[0].length):-1}function T(Z,ee,K){return I(Z,n,ee,K)}function P(Z,ee,K){return I(Z,i,ee,K)}function R(Z,ee,K){return I(Z,s,ee,K)}function Y(Z){return l[Z.getDay()]}function X(Z){return o[Z.getDay()]}function H(Z){return d[Z.getMonth()]}function q(Z){return c[Z.getMonth()]}function M(Z){return a[+(Z.getHours()>=12)]}function L(Z){return 1+~~(Z.getMonth()/3)}function B(Z){return l[Z.getUTCDay()]}function F(Z){return o[Z.getUTCDay()]}function te(Z){return d[Z.getUTCMonth()]}function $(Z){return c[Z.getUTCMonth()]}function W(Z){return a[+(Z.getUTCHours()>=12)]}function U(Z){return 1+~~(Z.getUTCMonth()/3)}return{format:function(Z){var ee=w(Z+="",A);return ee.toString=function(){return Z},ee},parse:function(Z){var ee=_(Z+="",!1);return ee.toString=function(){return Z},ee},utcFormat:function(Z){var ee=w(Z+="",N);return ee.toString=function(){return Z},ee},utcParse:function(Z){var ee=_(Z+="",!0);return ee.toString=function(){return Z},ee}}}var Hy={"-":"",_:" ",0:"0"},In=/^\s*\d+/,MP=/^%/,RP=/[\\^$*+?|[\]().{}]/g;function kt(e,n,i){var s=e<0?"-":"",a=(s?-e:e)+"",o=a.length;return s+(o<i?new Array(i-o+1).join(n)+a:a)}function $P(e){return e.replace(RP,"\\$&")}function Qa(e){return new RegExp("^(?:"+e.map($P).join("|")+")","i")}function Ja(e){return new Map(e.map((n,i)=>[n.toLowerCase(),i]))}function LP(e,n,i){var s=In.exec(n.slice(i,i+1));return s?(e.w=+s[0],i+s[0].length):-1}function WP(e,n,i){var s=In.exec(n.slice(i,i+1));return s?(e.u=+s[0],i+s[0].length):-1}function BP(e,n,i){var s=In.exec(n.slice(i,i+2));return s?(e.U=+s[0],i+s[0].length):-1}function FP(e,n,i){var s=In.exec(n.slice(i,i+2));return s?(e.V=+s[0],i+s[0].length):-1}function qP(e,n,i){var s=In.exec(n.slice(i,i+2));return s?(e.W=+s[0],i+s[0].length):-1}function Yy(e,n,i){var s=In.exec(n.slice(i,i+4));return s?(e.y=+s[0],i+s[0].length):-1}function Ky(e,n,i){var s=In.exec(n.slice(i,i+2));return s?(e.y=+s[0]+(+s[0]>68?1900:2e3),i+s[0].length):-1}function UP(e,n,i){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(n.slice(i,i+6));return s?(e.Z=s[1]?0:-(s[2]+(s[3]||"00")),i+s[0].length):-1}function HP(e,n,i){var s=In.exec(n.slice(i,i+1));return s?(e.q=s[0]*3-3,i+s[0].length):-1}function YP(e,n,i){var s=In.exec(n.slice(i,i+2));return s?(e.m=s[0]-1,i+s[0].length):-1}function Gy(e,n,i){var s=In.exec(n.slice(i,i+2));return s?(e.d=+s[0],i+s[0].length):-1}function KP(e,n,i){var s=In.exec(n.slice(i,i+3));return s?(e.m=0,e.d=+s[0],i+s[0].length):-1}function Vy(e,n,i){var s=In.exec(n.slice(i,i+2));return s?(e.H=+s[0],i+s[0].length):-1}function GP(e,n,i){var s=In.exec(n.slice(i,i+2));return s?(e.M=+s[0],i+s[0].length):-1}function VP(e,n,i){var s=In.exec(n.slice(i,i+2));return s?(e.S=+s[0],i+s[0].length):-1}function XP(e,n,i){var s=In.exec(n.slice(i,i+3));return s?(e.L=+s[0],i+s[0].length):-1}function QP(e,n,i){var s=In.exec(n.slice(i,i+6));return s?(e.L=Math.floor(s[0]/1e3),i+s[0].length):-1}function JP(e,n,i){var s=MP.exec(n.slice(i,i+1));return s?i+s[0].length:-1}function ZP(e,n,i){var s=In.exec(n.slice(i));return s?(e.Q=+s[0],i+s[0].length):-1}function e8(e,n,i){var s=In.exec(n.slice(i));return s?(e.s=+s[0],i+s[0].length):-1}function Xy(e,n){return kt(e.getDate(),n,2)}function t8(e,n){return kt(e.getHours(),n,2)}function n8(e,n){return kt(e.getHours()%12||12,n,2)}function r8(e,n){return kt(1+Qo.count(Di(e),e),n,3)}function y1(e,n){return kt(e.getMilliseconds(),n,3)}function i8(e,n){return y1(e,n)+"000"}function s8(e,n){return kt(e.getMonth()+1,n,2)}function a8(e,n){return kt(e.getMinutes(),n,2)}function o8(e,n){return kt(e.getSeconds(),n,2)}function l8(e){var n=e.getDay();return n===0?7:n}function c8(e,n){return kt(kd.count(Di(e)-1,e),n,2)}function x1(e){var n=e.getDay();return n>=4||n===0?va(e):va.ceil(e)}function d8(e,n){return e=x1(e),kt(va.count(Di(e),e)+(Di(e).getDay()===4),n,2)}function u8(e){return e.getDay()}function f8(e,n){return kt(Tc.count(Di(e)-1,e),n,2)}function h8(e,n){return kt(e.getFullYear()%100,n,2)}function p8(e,n){return e=x1(e),kt(e.getFullYear()%100,n,2)}function m8(e,n){return kt(e.getFullYear()%1e4,n,4)}function g8(e,n){var i=e.getDay();return e=i>=4||i===0?va(e):va.ceil(e),kt(e.getFullYear()%1e4,n,4)}function y8(e){var n=e.getTimezoneOffset();return(n>0?"-":(n*=-1,"+"))+kt(n/60|0,"0",2)+kt(n%60,"0",2)}function Qy(e,n){return kt(e.getUTCDate(),n,2)}function x8(e,n){return kt(e.getUTCHours(),n,2)}function v8(e,n){return kt(e.getUTCHours()%12||12,n,2)}function b8(e,n){return kt(1+Sd.count(zi(e),e),n,3)}function v1(e,n){return kt(e.getUTCMilliseconds(),n,3)}function j8(e,n){return v1(e,n)+"000"}function w8(e,n){return kt(e.getUTCMonth()+1,n,2)}function S8(e,n){return kt(e.getUTCMinutes(),n,2)}function k8(e,n){return kt(e.getUTCSeconds(),n,2)}function N8(e){var n=e.getUTCDay();return n===0?7:n}function _8(e,n){return kt(Nd.count(zi(e)-1,e),n,2)}function b1(e){var n=e.getUTCDay();return n>=4||n===0?ba(e):ba.ceil(e)}function C8(e,n){return e=b1(e),kt(ba.count(zi(e),e)+(zi(e).getUTCDay()===4),n,2)}function A8(e){return e.getUTCDay()}function I8(e,n){return kt(Ec.count(zi(e)-1,e),n,2)}function T8(e,n){return kt(e.getUTCFullYear()%100,n,2)}function E8(e,n){return e=b1(e),kt(e.getUTCFullYear()%100,n,2)}function P8(e,n){return kt(e.getUTCFullYear()%1e4,n,4)}function O8(e,n){var i=e.getUTCDay();return e=i>=4||i===0?ba(e):ba.ceil(e),kt(e.getUTCFullYear()%1e4,n,4)}function D8(){return"+0000"}function Jy(){return"%"}function Zy(e){return+e}function ex(e){return Math.floor(+e/1e3)}var Xs,j1,w1;z8({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function z8(e){return Xs=zP(e),j1=Xs.format,Xs.parse,w1=Xs.utcFormat,Xs.utcParse,Xs}function M8(e){return new Date(e)}function R8(e){return e instanceof Date?+e:+new Date(+e)}function _p(e,n,i,s,a,o,l,c,d,u){var f=fp(),h=f.invert,m=f.domain,g=u(".%L"),b=u(":%S"),j=u("%I:%M"),y=u("%I %p"),x=u("%a %d"),v=u("%b %d"),A=u("%B"),N=u("%Y");function C(w){return(d(w)<w?g:c(w)<w?b:l(w)<w?j:o(w)<w?y:s(w)<w?a(w)<w?x:v:i(w)<w?A:N)(w)}return f.invert=function(w){return new Date(h(w))},f.domain=function(w){return arguments.length?m(Array.from(w,R8)):m().map(M8)},f.ticks=function(w){var _=m();return e(_[0],_[_.length-1],w??10)},f.tickFormat=function(w,_){return _==null?C:u(_)},f.nice=function(w){var _=m();return(!w||typeof w.range!="function")&&(w=n(_[0],_[_.length-1],w??10)),w?m(l1(_,w)):f},f.copy=function(){return Xo(f,_p(e,n,i,s,a,o,l,c,d,u))},f}function $8(){return Or.apply(_p(OP,DP,Di,kp,kd,Qo,wp,bp,ks,j1).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function L8(){return Or.apply(_p(EP,PP,zi,Np,Nd,Sd,Sp,jp,ks,w1).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function _d(){var e=0,n=1,i,s,a,o,l=Xn,c=!1,d;function u(h){return h==null||isNaN(h=+h)?d:l(a===0?.5:(h=(o(h)-i)*a,c?Math.max(0,Math.min(1,h)):h))}u.domain=function(h){return arguments.length?([e,n]=h,i=o(e=+e),s=o(n=+n),a=i===s?0:1/(s-i),u):[e,n]},u.clamp=function(h){return arguments.length?(c=!!h,u):c},u.interpolator=function(h){return arguments.length?(l=h,u):l};function f(h){return function(m){var g,b;return arguments.length?([g,b]=m,l=h(g,b),u):[l(0),l(1)]}}return u.range=f(Na),u.rangeRound=f(Vh),u.unknown=function(h){return arguments.length?(d=h,u):d},function(h){return o=h,i=h(e),s=h(n),a=i===s?0:1/(s-i),u}}function cs(e,n){return n.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function S1(){var e=ls(_d()(Xn));return e.copy=function(){return cs(e,S1())},Bi.apply(e,arguments)}function k1(){var e=mp(_d()).domain([1,10]);return e.copy=function(){return cs(e,k1()).base(e.base())},Bi.apply(e,arguments)}function N1(){var e=gp(_d());return e.copy=function(){return cs(e,N1()).constant(e.constant())},Bi.apply(e,arguments)}function Cp(){var e=yp(_d());return e.copy=function(){return cs(e,Cp()).exponent(e.exponent())},Bi.apply(e,arguments)}function W8(){return Cp.apply(null,arguments).exponent(.5)}function _1(){var e=[],n=Xn;function i(s){if(s!=null&&!isNaN(s=+s))return n((Go(e,s,1)-1)/(e.length-1))}return i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let a of s)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(ns),i},i.interpolator=function(s){return arguments.length?(n=s,i):n},i.range=function(){return e.map((s,a)=>n(a/(e.length-1)))},i.quantiles=function(s){return Array.from({length:s+1},(a,o)=>PI(e,o/s))},i.copy=function(){return _1(n).domain(e)},Bi.apply(i,arguments)}function Cd(){var e=0,n=.5,i=1,s=1,a,o,l,c,d,u=Xn,f,h=!1,m;function g(j){return isNaN(j=+j)?m:(j=.5+((j=+f(j))-o)*(s*j<s*o?c:d),u(h?Math.max(0,Math.min(1,j)):j))}g.domain=function(j){return arguments.length?([e,n,i]=j,a=f(e=+e),o=f(n=+n),l=f(i=+i),c=a===o?0:.5/(o-a),d=o===l?0:.5/(l-o),s=o<a?-1:1,g):[e,n,i]},g.clamp=function(j){return arguments.length?(h=!!j,g):h},g.interpolator=function(j){return arguments.length?(u=j,g):u};function b(j){return function(y){var x,v,A;return arguments.length?([x,v,A]=y,u=n6(j,[x,v,A]),g):[u(0),u(.5),u(1)]}}return g.range=b(Na),g.rangeRound=b(Vh),g.unknown=function(j){return arguments.length?(m=j,g):m},function(j){return f=j,a=j(e),o=j(n),l=j(i),c=a===o?0:.5/(o-a),d=o===l?0:.5/(l-o),s=o<a?-1:1,g}}function C1(){var e=ls(Cd()(Xn));return e.copy=function(){return cs(e,C1())},Bi.apply(e,arguments)}function A1(){var e=mp(Cd()).domain([.1,1,10]);return e.copy=function(){return cs(e,A1()).base(e.base())},Bi.apply(e,arguments)}function I1(){var e=gp(Cd());return e.copy=function(){return cs(e,I1()).constant(e.constant())},Bi.apply(e,arguments)}function Ap(){var e=yp(Cd());return e.copy=function(){return cs(e,Ap()).exponent(e.exponent())},Bi.apply(e,arguments)}function B8(){return Ap.apply(null,arguments).exponent(.5)}function F8(e){for(var n=e.length/6|0,i=new Array(n),s=0;s<n;)i[s]="#"+e.slice(s*6,++s*6);return i}const q8=F8("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928");function U8(e,n){n===void 0&&(n={});var i=n.insertAt;if(!(typeof document>"u")){var s=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",i==="top"&&s.firstChild?s.insertBefore(a,s.firstChild):s.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}}var H8=`.force-graph-container canvas {
  display: block;
  user-select: none;
  outline: none;
  -webkit-tap-highlight-color: transparent;
}

.force-graph-container .clickable {
  cursor: pointer;
}

.force-graph-container .grabbable {
  cursor: move;
  cursor: grab;
  cursor: -moz-grab;
  cursor: -webkit-grab;
}

.force-graph-container .grabbable:active {
  cursor: grabbing;
  cursor: -moz-grabbing;
  cursor: -webkit-grabbing;
}
`;U8(H8);function Xf(e,n){(n==null||n>e.length)&&(n=e.length);for(var i=0,s=Array(n);i<n;i++)s[i]=e[i];return s}function Y8(e){if(Array.isArray(e))return e}function K8(e){if(Array.isArray(e))return Xf(e)}function tx(e,n,i){if(T1())return Reflect.construct.apply(null,arguments);var s=[null];s.push.apply(s,n);var a=new(e.bind.apply(e,s));return a}function Po(e,n,i){return(n=Z8(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function T1(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(T1=function(){return!!e})()}function G8(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function V8(e,n){var i=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(i!=null){var s,a,o,l,c=[],d=!0,u=!1;try{if(o=(i=i.call(e)).next,n!==0)for(;!(d=(s=o.call(i)).done)&&(c.push(s.value),c.length!==n);d=!0);}catch(f){u=!0,a=f}finally{try{if(!d&&i.return!=null&&(l=i.return(),Object(l)!==l))return}finally{if(u)throw a}}return c}}function X8(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Q8(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function nx(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function Qs(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?nx(Object(i),!0).forEach(function(s){Po(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):nx(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function vo(e,n){return Y8(e)||V8(e,n)||E1(e,n)||X8()}function Ar(e){return K8(e)||G8(e)||E1(e)||Q8()}function J8(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Z8(e){var n=J8(e,"string");return typeof n=="symbol"?n:n+""}function Qf(e){"@babel/helpers - typeof";return Qf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},Qf(e)}function E1(e,n){if(e){if(typeof e=="string")return Xf(e,n);var i={}.toString.call(e).slice(8,-1);return i==="Object"&&e.constructor&&(i=e.constructor.name),i==="Map"||i==="Set"?Array.from(e):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Xf(e,n):void 0}}var e3=jd(q8);function rx(e,n,i){!n||typeof i!="string"||e.filter(function(s){return!s[i]}).forEach(function(s){s[i]=e3(n(s))})}function t3(e,n){var i=e.nodes,s=e.links,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=a.nodeFilter,l=o===void 0?function(){return!0}:o,c=a.onLoopError,d=c===void 0?function(g){throw"Invalid DAG structure! Found cycle in node path: ".concat(g.join(" -> "),".")}:c,u={};i.forEach(function(g){return u[n(g)]={data:g,out:[],depth:-1,skip:!l(g)}}),s.forEach(function(g){var b=g.source,j=g.target,y=N(b),x=N(j);if(!u.hasOwnProperty(y))throw"Missing source node with id: ".concat(y);if(!u.hasOwnProperty(x))throw"Missing target node with id: ".concat(x);var v=u[y],A=u[x];v.out.push(A);function N(C){return Qf(C)==="object"?n(C):C}});var f=[];m(Object.values(u));var h=Object.assign.apply(Object,[{}].concat(Ar(Object.entries(u).filter(function(g){var b=vo(g,2),j=b[1];return!j.skip}).map(function(g){var b=vo(g,2),j=b[0],y=b[1];return Po({},j,y.depth)}))));return h;function m(g){for(var b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],j=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,y=function(){var N=g[x];if(b.indexOf(N)!==-1){var C=[].concat(Ar(b.slice(b.indexOf(N))),[N]).map(function(w){return n(w.data)});return f.some(function(w){return w.length===C.length&&w.every(function(_,I){return _===C[I]})})||(f.push(C),d(C)),1}j>N.depth&&(N.depth=j,m(N.out,[].concat(Ar(b),[N]),j+(N.skip?0:1)))},x=0,v=g.length;x<v;x++)y()}}var n3=2,$n=function(n,i){return i.onNeedsRedraw&&i.onNeedsRedraw()},ix=function(n,i){if(!i.isShadow){var s=Tt(i.linkDirectionalParticles);i.graphData.links.forEach(function(a){var o=Math.round(Math.abs(s(a)));o?a.__photons=Ar(Array(o)).map(function(){return{}}):delete a.__photons})}},Pc=np({props:{graphData:{default:{nodes:[],links:[]},onChange:function(n,i){i.engineRunning=!1,ix(n,i)}},dagMode:{onChange:function(n,i){!n&&(i.graphData.nodes||[]).forEach(function(s){return s.fx=s.fy=void 0})}},dagLevelDistance:{},dagNodeFilter:{default:function(n){return!0}},onDagError:{triggerUpdate:!1},nodeRelSize:{default:4,triggerUpdate:!1,onChange:$n},nodeId:{default:"id"},nodeVal:{default:"val",triggerUpdate:!1,onChange:$n},nodeColor:{default:"color",triggerUpdate:!1,onChange:$n},nodeAutoColorBy:{},nodeCanvasObject:{triggerUpdate:!1,onChange:$n},nodeCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:$n},nodeVisibility:{default:!0,triggerUpdate:!1,onChange:$n},linkSource:{default:"source"},linkTarget:{default:"target"},linkVisibility:{default:!0,triggerUpdate:!1,onChange:$n},linkColor:{default:"color",triggerUpdate:!1,onChange:$n},linkAutoColorBy:{},linkLineDash:{triggerUpdate:!1,onChange:$n},linkWidth:{default:1,triggerUpdate:!1,onChange:$n},linkCurvature:{default:0,triggerUpdate:!1,onChange:$n},linkCanvasObject:{triggerUpdate:!1,onChange:$n},linkCanvasObjectMode:{default:function(){return"replace"},triggerUpdate:!1,onChange:$n},linkDirectionalArrowLength:{default:0,triggerUpdate:!1,onChange:$n},linkDirectionalArrowColor:{triggerUpdate:!1,onChange:$n},linkDirectionalArrowRelPos:{default:.5,triggerUpdate:!1,onChange:$n},linkDirectionalParticles:{default:0,triggerUpdate:!1,onChange:ix},linkDirectionalParticleSpeed:{default:.01,triggerUpdate:!1},linkDirectionalParticleOffset:{default:0,triggerUpdate:!1},linkDirectionalParticleWidth:{default:4,triggerUpdate:!1},linkDirectionalParticleColor:{triggerUpdate:!1},linkDirectionalParticleCanvasObject:{triggerUpdate:!1},globalScale:{default:1,triggerUpdate:!1},d3AlphaMin:{default:0,triggerUpdate:!1},d3AlphaDecay:{default:.0228,triggerUpdate:!1,onChange:function(n,i){i.forceLayout.alphaDecay(n)}},d3AlphaTarget:{default:0,triggerUpdate:!1,onChange:function(n,i){i.forceLayout.alphaTarget(n)}},d3VelocityDecay:{default:.4,triggerUpdate:!1,onChange:function(n,i){i.forceLayout.velocityDecay(n)}},warmupTicks:{default:0,triggerUpdate:!1},cooldownTicks:{default:1/0,triggerUpdate:!1},cooldownTime:{default:15e3,triggerUpdate:!1},onUpdate:{default:function(){},triggerUpdate:!1},onFinishUpdate:{default:function(){},triggerUpdate:!1},onEngineTick:{default:function(){},triggerUpdate:!1},onEngineStop:{default:function(){},triggerUpdate:!1},onNeedsRedraw:{triggerUpdate:!1},isShadow:{default:!1,triggerUpdate:!1}},methods:{d3Force:function(n,i,s){return s===void 0?n.forceLayout.force(i):(n.forceLayout.force(i,s),this)},d3ReheatSimulation:function(n){return n.forceLayout.alpha(1),this.resetCountdown(),this},resetCountdown:function(n){return n.cntTicks=0,n.startTickTime=new Date,n.engineRunning=!0,this},isEngineRunning:function(n){return!!n.engineRunning},tickFrame:function(n){return!n.isShadow&&i(),a(),!n.isShadow&&o(),!n.isShadow&&l(),s(),this;function i(){n.engineRunning&&(++n.cntTicks>n.cooldownTicks||new Date-n.startTickTime>n.cooldownTime||n.d3AlphaMin>0&&n.forceLayout.alpha()<n.d3AlphaMin?(n.engineRunning=!1,n.onEngineStop()):(n.forceLayout.tick(),n.onEngineTick()))}function s(){var c=Tt(n.nodeVisibility),d=Tt(n.nodeVal),u=Tt(n.nodeColor),f=Tt(n.nodeCanvasObjectMode),h=n.ctx,m=n.isShadow/n.globalScale,g=n.graphData.nodes.filter(c);h.save(),g.forEach(function(b){var j=f(b);if(n.nodeCanvasObject&&(j==="before"||j==="replace")&&(n.nodeCanvasObject(b,h,n.globalScale),j==="replace")){h.restore();return}var y=Math.sqrt(Math.max(0,d(b)||1))*n.nodeRelSize+m;h.beginPath(),h.arc(b.x,b.y,y,0,2*Math.PI,!1),h.fillStyle=u(b)||"rgba(31, 120, 180, 0.92)",h.fill(),n.nodeCanvasObject&&j==="after"&&n.nodeCanvasObject(b,n.ctx,n.globalScale)}),h.restore()}function a(){var c=Tt(n.linkVisibility),d=Tt(n.linkColor),u=Tt(n.linkWidth),f=Tt(n.linkLineDash),h=Tt(n.linkCurvature),m=Tt(n.linkCanvasObjectMode),g=n.ctx,b=n.isShadow*2,j=n.graphData.links.filter(c);j.forEach(w);var y=[],x=[],v=j;if(n.linkCanvasObject){var A=[],N=[];j.forEach(function(_){return({before:y,after:x,replace:A}[m(_)]||N).push(_)}),v=[].concat(Ar(y),x,N),y=y.concat(A)}g.save(),y.forEach(function(_){return n.linkCanvasObject(_,g,n.globalScale)}),g.restore();var C=Q4(v,[d,u,f]);g.save(),Object.entries(C).forEach(function(_){var I=vo(_,2),O=I[0],E=I[1],S=!O||O==="undefined"?"rgba(0,0,0,0.15)":O;Object.entries(E).forEach(function(k){var D=vo(k,2),T=D[0],P=D[1],R=(T||1)/n.globalScale+b;Object.entries(P).forEach(function(Y){var X=vo(Y,2);X[0];var H=X[1],q=f(H[0]);g.beginPath(),H.forEach(function(M){var L=M.source,B=M.target;if(!(!L||!B||!L.hasOwnProperty("x")||!B.hasOwnProperty("x"))){g.moveTo(L.x,L.y);var F=M.__controlPoints;F?g[F.length===2?"quadraticCurveTo":"bezierCurveTo"].apply(g,Ar(F).concat([B.x,B.y])):g.lineTo(B.x,B.y)}}),g.strokeStyle=S,g.lineWidth=R,g.setLineDash(q||[]),g.stroke()})})}),g.restore(),g.save(),x.forEach(function(_){return n.linkCanvasObject(_,g,n.globalScale)}),g.restore();function w(_){var I=h(_);if(!I){_.__controlPoints=null;return}var O=_.source,E=_.target;if(!(!O||!E||!O.hasOwnProperty("x")||!E.hasOwnProperty("x"))){var S=Math.sqrt(Math.pow(E.x-O.x,2)+Math.pow(E.y-O.y,2));if(S>0){var k=Math.atan2(E.y-O.y,E.x-O.x),D=S*I,T={x:(O.x+E.x)/2+D*Math.cos(k-Math.PI/2),y:(O.y+E.y)/2+D*Math.sin(k-Math.PI/2)};_.__controlPoints=[T.x,T.y]}else{var P=I*70;_.__controlPoints=[E.x,E.y-P,E.x+P,E.y]}}}}function o(){var c=1.6,d=.2,u=Tt(n.linkDirectionalArrowLength),f=Tt(n.linkDirectionalArrowRelPos),h=Tt(n.linkVisibility),m=Tt(n.linkDirectionalArrowColor||n.linkColor),g=Tt(n.nodeVal),b=n.ctx;b.save(),n.graphData.links.filter(h).forEach(function(j){var y=u(j);if(!(!y||y<0)){var x=j.source,v=j.target;if(!(!x||!v||!x.hasOwnProperty("x")||!v.hasOwnProperty("x"))){var A=Math.sqrt(Math.max(0,g(x)||1))*n.nodeRelSize,N=Math.sqrt(Math.max(0,g(v)||1))*n.nodeRelSize,C=Math.min(1,Math.max(0,f(j))),w=m(j)||"rgba(0,0,0,0.28)",_=y/c/2,I=j.__controlPoints&&tx(Ut,[x.x,x.y].concat(Ar(j.__controlPoints),[v.x,v.y])),O=I?function(R){return I.get(R)}:function(R){return{x:x.x+(v.x-x.x)*R||0,y:x.y+(v.y-x.y)*R||0}},E=I?I.length():Math.sqrt(Math.pow(v.x-x.x,2)+Math.pow(v.y-x.y,2)),S=A+y+(E-A-N-y)*C,k=O(S/E),D=O((S-y)/E),T=O((S-y*(1-d))/E),P=Math.atan2(k.y-D.y,k.x-D.x)-Math.PI/2;b.beginPath(),b.moveTo(k.x,k.y),b.lineTo(D.x+_*Math.cos(P),D.y+_*Math.sin(P)),b.lineTo(T.x,T.y),b.lineTo(D.x-_*Math.cos(P),D.y-_*Math.sin(P)),b.fillStyle=w,b.fill()}}}),b.restore()}function l(){var c=Tt(n.linkDirectionalParticles),d=Tt(n.linkDirectionalParticleSpeed),u=Tt(n.linkDirectionalParticleOffset),f=Tt(n.linkDirectionalParticleWidth),h=Tt(n.linkVisibility),m=Tt(n.linkDirectionalParticleColor||n.linkColor),g=n.ctx;g.save(),n.graphData.links.filter(h).forEach(function(b){var j=c(b);if(!(!b.hasOwnProperty("__photons")||!b.__photons.length)){var y=b.source,x=b.target;if(!(!y||!x||!y.hasOwnProperty("x")||!x.hasOwnProperty("x"))){var v=d(b),A=Math.abs(u(b)),N=b.__photons||[],C=Math.max(0,f(b)/2)/Math.sqrt(n.globalScale),w=m(b)||"rgba(0,0,0,0.28)";g.fillStyle=w;var _=b.__controlPoints?tx(Ut,[y.x,y.y].concat(Ar(b.__controlPoints),[x.x,x.y])):null,I=0,O=!1;N.forEach(function(E){var S=!!E.__singleHop;if(E.hasOwnProperty("__progressRatio")||(E.__progressRatio=S?0:(I+A)/j),!S&&I++,E.__progressRatio+=v,E.__progressRatio>=1)if(!S)E.__progressRatio=E.__progressRatio%1;else{O=!0;return}var k=E.__progressRatio,D=_?_.get(k):{x:y.x+(x.x-y.x)*k||0,y:y.y+(x.y-y.y)*k||0};n.linkDirectionalParticleCanvasObject?n.linkDirectionalParticleCanvasObject(D.x,D.y,b,g,n.globalScale):(g.beginPath(),g.arc(D.x,D.y,C,0,2*Math.PI,!1),g.fill())}),O&&(b.__photons=b.__photons.filter(function(E){return!E.__singleHop||E.__progressRatio<=1}))}}}),g.restore()}},emitParticle:function(n,i){return i&&(!i.__photons&&(i.__photons=[]),i.__photons.push({__singleHop:!0})),this}},stateInit:function(){return{forceLayout:I4().force("link",j4()).force("charge",T4()).force("center",SE()).force("dagRadial",null).stop(),engineRunning:!1}},init:function(n,i){i.ctx=n},update:function(n,i){n.engineRunning=!1,n.onUpdate(),n.nodeAutoColorBy!==null&&rx(n.graphData.nodes,Tt(n.nodeAutoColorBy),n.nodeColor),n.linkAutoColorBy!==null&&rx(n.graphData.links,Tt(n.linkAutoColorBy),n.linkColor),n.graphData.links.forEach(function(m){m.source=m[n.linkSource],m.target=m[n.linkTarget]}),n.forceLayout.stop().alpha(1).nodes(n.graphData.nodes);var s=n.forceLayout.force("link");s&&s.id(function(m){return m[n.nodeId]}).links(n.graphData.links);var a=n.dagMode&&t3(n.graphData,function(m){return m[n.nodeId]},{nodeFilter:n.dagNodeFilter,onLoopError:n.onDagError||void 0}),o=Math.max.apply(Math,Ar(Object.values(a||[]))),l=n.dagLevelDistance||n.graphData.nodes.length/(o||1)*n3*(["radialin","radialout"].indexOf(n.dagMode)!==-1?.7:1);if(["lr","rl","td","bu"].includes(i.dagMode)){var c=["lr","rl"].includes(i.dagMode)?"fx":"fy";n.graphData.nodes.filter(n.dagNodeFilter).forEach(function(m){return delete m[c]})}if(["lr","rl","td","bu"].includes(n.dagMode)){var d=["rl","bu"].includes(n.dagMode),u=function(g){return(a[g[n.nodeId]]-o/2)*l*(d?-1:1)},f=["lr","rl"].includes(n.dagMode)?"fx":"fy";n.graphData.nodes.filter(n.dagNodeFilter).forEach(function(m){return m[f]=u(m)})}n.forceLayout.force("dagRadial",["radialin","radialout"].indexOf(n.dagMode)!==-1?E4(function(m){var g=a[m[n.nodeId]]||-1;return(n.dagMode==="radialin"?o-g:g)*l}).strength(function(m){return n.dagNodeFilter(m)?1:0}):null);for(var h=0;h<n.warmupTicks&&!(n.d3AlphaMin>0&&n.forceLayout.alpha()<n.d3AlphaMin);h++)n.forceLayout.tick();this.resetCountdown(),n.onFinishUpdate()}});function P1(e,n){var i=e instanceof Array?e:[e],s=new n;return s._destructor&&s._destructor(),{linkProp:function(o){return{default:s[o](),onChange:function(c,d){i.forEach(function(u){return d[u][o](c)})},triggerUpdate:!1}},linkMethod:function(o){return function(l){for(var c=arguments.length,d=new Array(c>1?c-1:0),u=1;u<c;u++)d[u-1]=arguments[u];var f=[];return i.forEach(function(h){var m=l[h],g=m[o].apply(m,d);g!==m&&f.push(g)}),f.length?f[0]:this}}}}var r3=800,i3=4,s3=5,O1=P1("forceGraph",Pc),a3=P1(["forceGraph","shadowGraph"],Pc),o3=Object.assign.apply(Object,Ar(["nodeColor","nodeAutoColorBy","nodeCanvasObject","nodeCanvasObjectMode","linkColor","linkAutoColorBy","linkLineDash","linkWidth","linkCanvasObject","linkCanvasObjectMode","linkDirectionalArrowLength","linkDirectionalArrowColor","linkDirectionalArrowRelPos","linkDirectionalParticles","linkDirectionalParticleSpeed","linkDirectionalParticleOffset","linkDirectionalParticleWidth","linkDirectionalParticleColor","linkDirectionalParticleCanvasObject","dagMode","dagLevelDistance","dagNodeFilter","onDagError","d3AlphaMin","d3AlphaDecay","d3VelocityDecay","warmupTicks","cooldownTicks","cooldownTime","onEngineTick","onEngineStop"].map(function(e){return Po({},e,O1.linkProp(e))})).concat(Ar(["nodeRelSize","nodeId","nodeVal","nodeVisibility","linkSource","linkTarget","linkVisibility","linkCurvature"].map(function(e){return Po({},e,a3.linkProp(e))})))),l3=Object.assign.apply(Object,Ar(["d3Force","d3ReheatSimulation","emitParticle"].map(function(e){return Po({},e,O1.linkMethod(e))})));function Ku(e){if(e.canvas){var n=e.canvas.width,i=e.canvas.height;n===300&&i===150&&(n=i=0);var s=window.devicePixelRatio;n/=s,i/=s,[e.canvas,e.shadowCanvas].forEach(function(o){o.style.width="".concat(e.width,"px"),o.style.height="".concat(e.height,"px"),o.width=e.width*s,o.height=e.height*s,!n&&!i&&o.getContext("2d").scale(s,s)});var a=Qr(e.canvas).k;e.zoom.translateBy(e.zoom.__baseElem,(e.width-n)/2/a,(e.height-i)/2/a),e.needsRedraw=!0}}function D1(e){var n=window.devicePixelRatio;e.setTransform(n,0,0,n,0,0)}function sx(e,n,i){e.save(),D1(e),e.clearRect(0,0,n,i),e.restore()}var c3=np({props:Qs({width:{default:window.innerWidth,onChange:function(n,i){return Ku(i)},triggerUpdate:!1},height:{default:window.innerHeight,onChange:function(n,i){return Ku(i)},triggerUpdate:!1},graphData:{default:{nodes:[],links:[]},onChange:function(n,i){[n.nodes,n.links].every(function(a){return(a||[]).every(function(o){return!o.hasOwnProperty("__indexColor")})})&&i.colorTracker.reset(),[{type:"Node",objs:n.nodes},{type:"Link",objs:n.links}].forEach(s),i.forceGraph.graphData(n),i.shadowGraph.graphData(n);function s(a){var o=a.type,l=a.objs;l.filter(function(c){if(!c.hasOwnProperty("__indexColor"))return!0;var d=i.colorTracker.lookup(c.__indexColor);return!d||!d.hasOwnProperty("d")||d.d!==c}).forEach(function(c){c.__indexColor=i.colorTracker.register({type:o,d:c})})}},triggerUpdate:!1},backgroundColor:{onChange:function(n,i){i.canvas&&n&&(i.canvas.style.background=n)},triggerUpdate:!1},nodeLabel:{default:"name",triggerUpdate:!1},nodePointerAreaPaint:{onChange:function(n,i){i.shadowGraph.nodeCanvasObject(n?function(s,a,o){return n(s,s.__indexColor,a,o)}:null),i.flushShadowCanvas&&i.flushShadowCanvas()},triggerUpdate:!1},linkPointerAreaPaint:{onChange:function(n,i){i.shadowGraph.linkCanvasObject(n?function(s,a,o){return n(s,s.__indexColor,a,o)}:null),i.flushShadowCanvas&&i.flushShadowCanvas()},triggerUpdate:!1},linkLabel:{default:"name",triggerUpdate:!1},linkHoverPrecision:{default:4,triggerUpdate:!1},minZoom:{default:.01,onChange:function(n,i){i.zoom.scaleExtent([n,i.zoom.scaleExtent()[1]])},triggerUpdate:!1},maxZoom:{default:1e3,onChange:function(n,i){i.zoom.scaleExtent([i.zoom.scaleExtent()[0],n])},triggerUpdate:!1},enableNodeDrag:{default:!0,triggerUpdate:!1},enableZoomInteraction:{default:!0,triggerUpdate:!1},enablePanInteraction:{default:!0,triggerUpdate:!1},enableZoomPanInteraction:{default:!0,triggerUpdate:!1},enablePointerInteraction:{default:!0,onChange:function(n,i){i.hoverObj=null},triggerUpdate:!1},autoPauseRedraw:{default:!0,triggerUpdate:!1},onNodeDrag:{default:function(){},triggerUpdate:!1},onNodeDragEnd:{default:function(){},triggerUpdate:!1},onNodeClick:{triggerUpdate:!1},onNodeRightClick:{triggerUpdate:!1},onNodeHover:{triggerUpdate:!1},onLinkClick:{triggerUpdate:!1},onLinkRightClick:{triggerUpdate:!1},onLinkHover:{triggerUpdate:!1},onBackgroundClick:{triggerUpdate:!1},onBackgroundRightClick:{triggerUpdate:!1},showPointerCursor:{default:!0,triggerUpdate:!1},onZoom:{triggerUpdate:!1},onZoomEnd:{triggerUpdate:!1},onRenderFramePre:{triggerUpdate:!1},onRenderFramePost:{triggerUpdate:!1}},o3),aliases:{stopAnimation:"pauseAnimation"},methods:Qs({graph2ScreenCoords:function(n,i,s){var a=Qr(n.canvas);return{x:i*a.k+a.x,y:s*a.k+a.y}},screen2GraphCoords:function(n,i,s){var a=Qr(n.canvas);return{x:(i-a.x)/a.k,y:(s-a.y)/a.k}},centerAt:function(n,i,s,a){if(!n.canvas)return null;if(i!==void 0||s!==void 0){var o=Object.assign({},i!==void 0?{x:i}:{},s!==void 0?{y:s}:{});return a?n.tweenGroup.add(new sy(l()).to(o,a).easing(As.Quadratic.Out).onUpdate(c).start()):c(o),this}return l();function l(){var d=Qr(n.canvas);return{x:(n.width/2-d.x)/d.k,y:(n.height/2-d.y)/d.k}}function c(d){var u=d.x,f=d.y;n.zoom.translateTo(n.zoom.__baseElem,u===void 0?l().x:u,f===void 0?l().y:f),n.needsRedraw=!0}},zoom:function(n,i,s){if(!n.canvas)return null;if(i!==void 0)return s?n.tweenGroup.add(new sy({k:a()}).to({k:i},s).easing(As.Quadratic.Out).onUpdate(function(l){var c=l.k;return o(c)}).start()):o(i),this;return a();function a(){return Qr(n.canvas).k}function o(l){n.zoom.scaleTo(n.zoom.__baseElem,l),n.needsRedraw=!0}},zoomToFit:function(n){for(var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:10,a=arguments.length,o=new Array(a>3?a-3:0),l=3;l<a;l++)o[l-3]=arguments[l];var c=this.getGraphBbox.apply(this,o);if(c){var d={x:(c.x[0]+c.x[1])/2,y:(c.y[0]+c.y[1])/2},u=Math.max(1e-12,Math.min(1e12,(n.width-s*2)/(c.x[1]-c.x[0]),(n.height-s*2)/(c.y[1]-c.y[0])));this.centerAt(d.x,d.y,i),this.zoom(u,i)}return this},getGraphBbox:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:function(){return!0},s=Tt(n.nodeVal),a=function(c){return Math.sqrt(Math.max(0,s(c)||1))*n.nodeRelSize},o=n.graphData.nodes.filter(i).map(function(l){return{x:l.x,y:l.y,r:a(l)}});return o.length?{x:[jc(o,function(l){return l.x-l.r}),bc(o,function(l){return l.x+l.r})],y:[jc(o,function(l){return l.y-l.r}),bc(o,function(l){return l.y+l.r})]}:null},pauseAnimation:function(n){return n.animationFrameRequestId&&(cancelAnimationFrame(n.animationFrameRequestId),n.animationFrameRequestId=null),this},resumeAnimation:function(n){return n.animationFrameRequestId||this._animationCycle(),this},_destructor:function(){this.pauseAnimation(),this.graphData({nodes:[],links:[]})}},l3),stateInit:function(){return{lastSetZoom:1,zoom:bI(),forceGraph:new Pc,shadowGraph:new Pc().cooldownTicks(0).nodeColor("__indexColor").linkColor("__indexColor").isShadow(!0),colorTracker:new tE,tweenGroup:new Tb}},init:function(n,i){var s=this;n.innerHTML="";var a=document.createElement("div");a.classList.add("force-graph-container"),a.style.position="relative",n.appendChild(a),i.canvas=document.createElement("canvas"),i.backgroundColor&&(i.canvas.style.background=i.backgroundColor),a.appendChild(i.canvas),i.shadowCanvas=document.createElement("canvas");var o=i.canvas.getContext("2d"),l=i.shadowCanvas.getContext("2d",{willReadFrequently:!0}),c={x:-1e12,y:-1e12},d=function(){var h=null,m=window.devicePixelRatio,g=c.x>0&&c.y>0?l.getImageData(c.x*m,c.y*m,1,1):null;return g&&(h=i.colorTracker.lookup(g.data)),h};Cr(i.canvas).call(NA().subject(function(){if(!i.enableNodeDrag)return null;var f=d();return f&&f.type==="Node"?f.d:null}).on("start",function(f){var h=f.subject;h.__initialDragPos={x:h.x,y:h.y,fx:h.fx,fy:h.fy},f.active||(h.fx=h.x,h.fy=h.y),i.canvas.classList.add("grabbable")}).on("drag",function(f){var h=f.subject,m=h.__initialDragPos,g=f,b=Qr(i.canvas).k,j={x:m.x+(g.x-m.x)/b-h.x,y:m.y+(g.y-m.y)/b-h.y};["x","y"].forEach(function(y){return h["f".concat(y)]=h[y]=m[y]+(g[y]-m[y])/b}),!(!h.__dragged&&s3>=Math.sqrt(zI(["x","y"].map(function(y){return Math.pow(f[y]-m[y],2)}))))&&(i.forceGraph.d3AlphaTarget(.3).resetCountdown(),i.isPointerDragging=!0,h.__dragged=!0,i.onNodeDrag(h,j))}).on("end",function(f){var h=f.subject,m=h.__initialDragPos,g={x:h.x-m.x,y:h.y-m.y};m.fx===void 0&&(h.fx=void 0),m.fy===void 0&&(h.fy=void 0),delete h.__initialDragPos,i.forceGraph.d3AlphaTarget()&&i.forceGraph.d3AlphaTarget(0).resetCountdown(),i.canvas.classList.remove("grabbable"),i.isPointerDragging=!1,h.__dragged&&(delete h.__dragged,i.onNodeDragEnd(h,g))})),i.zoom(i.zoom.__baseElem=Cr(i.canvas)),i.zoom.__baseElem.on("dblclick.zoom",null),i.zoom.filter(function(f){return!f.button&&i.enableZoomPanInteraction&&(f.type!=="wheel"||Tt(i.enableZoomInteraction)(f))&&(f.type==="wheel"||Tt(i.enablePanInteraction)(f))}).on("zoom",function(f){var h=f.transform;[o,l].forEach(function(m){D1(m),m.translate(h.x,h.y),m.scale(h.k,h.k)}),i.isPointerDragging=!0,i.onZoom&&i.onZoom(Qs(Qs({},h),s.centerAt())),i.needsRedraw=!0}).on("end",function(f){i.isPointerDragging=!1,i.onZoomEnd&&i.onZoomEnd(Qs(Qs({},f.transform),s.centerAt()))}),Ku(i),i.forceGraph.onNeedsRedraw(function(){return i.needsRedraw=!0}).onFinishUpdate(function(){Qr(i.canvas).k===i.lastSetZoom&&i.graphData.nodes.length&&(i.zoom.scaleTo(i.zoom.__baseElem,i.lastSetZoom=i3/Math.cbrt(i.graphData.nodes.length)),i.needsRedraw=!0)}),i.tooltip=new wE(a),["pointermove","pointerdown"].forEach(function(f){return a.addEventListener(f,function(h){f==="pointerdown"&&(i.isPointerPressed=!0,i.pointerDownEvent=h),!i.isPointerDragging&&h.type==="pointermove"&&i.onBackgroundClick&&(h.pressure>0||i.isPointerPressed)&&(h.pointerType==="mouse"||h.movementX===void 0||[h.movementX,h.movementY].some(function(b){return Math.abs(b)>1}))&&(i.isPointerDragging=!0);var m=g(a);c.x=h.pageX-m.left,c.y=h.pageY-m.top;function g(b){var j=b.getBoundingClientRect(),y=window.pageXOffset||document.documentElement.scrollLeft,x=window.pageYOffset||document.documentElement.scrollTop;return{top:j.top+x,left:j.left+y}}},{passive:!0})}),a.addEventListener("pointerup",function(f){if(i.isPointerPressed){if(i.isPointerPressed=!1,i.isPointerDragging){i.isPointerDragging=!1;return}var h=[f,i.pointerDownEvent];requestAnimationFrame(function(){if(f.button===0)if(i.hoverObj){var m=i["on".concat(i.hoverObj.type,"Click")];m&&m.apply(void 0,[i.hoverObj.d].concat(h))}else i.onBackgroundClick&&i.onBackgroundClick.apply(i,h);if(f.button===2)if(i.hoverObj){var g=i["on".concat(i.hoverObj.type,"RightClick")];g&&g.apply(void 0,[i.hoverObj.d].concat(h))}else i.onBackgroundRightClick&&i.onBackgroundRightClick.apply(i,h)})}},{passive:!0}),a.addEventListener("contextmenu",function(f){return!i.onBackgroundRightClick&&!i.onNodeRightClick&&!i.onLinkRightClick?!0:(f.preventDefault(),!1)}),i.forceGraph(o),i.shadowGraph(l);var u=lT(function(){sx(l,i.width,i.height),i.shadowGraph.linkWidth(function(h){return Tt(i.linkWidth)(h)+i.linkHoverPrecision});var f=Qr(i.canvas);i.shadowGraph.globalScale(f.k).tickFrame()},r3);i.flushShadowCanvas=u.flush,(this._animationCycle=function f(){var h=!i.autoPauseRedraw||!!i.needsRedraw||i.forceGraph.isEngineRunning()||i.graphData.links.some(function(A){return A.__photons&&A.__photons.length});if(i.needsRedraw=!1,i.enablePointerInteraction){var m=i.isPointerDragging?null:d();if(m!==i.hoverObj){var g=i.hoverObj,b=g?g.type:null,j=m?m.type:null;if(b&&b!==j){var y=i["on".concat(b,"Hover")];y&&y(null,g.d)}if(j){var x=i["on".concat(j,"Hover")];x&&x(m.d,b===j?g.d:null)}i.tooltip.content(m&&Tt(i["".concat(m.type.toLowerCase(),"Label")])(m.d)||null),i.canvas.classList[(m&&i["on".concat(j,"Click")]||!m&&i.onBackgroundClick)&&Tt(i.showPointerCursor)(m==null?void 0:m.d)?"add":"remove"]("clickable"),i.hoverObj=m}h&&u()}if(h){sx(o,i.width,i.height);var v=Qr(i.canvas).k;i.onRenderFramePre&&i.onRenderFramePre(o,v),i.forceGraph.globalScale(v).tickFrame(),i.onRenderFramePost&&i.onRenderFramePost(o,v)}i.tweenGroup.update(),i.animationFrameRequestId=requestAnimationFrame(f)})()},update:function(n){}}),z1={exports:{}},d3="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",u3=d3,f3=u3;function M1(){}function R1(){}R1.resetWarningCache=M1;var h3=function(){function e(s,a,o,l,c,d){if(d!==f3){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function n(){return e}var i={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:n,element:e,elementType:e,instanceOf:n,node:e,objectOf:n,oneOf:n,oneOfType:n,shape:n,exact:n,checkPropTypes:R1,resetWarningCache:M1};return i.PropTypes=i,i};z1.exports=h3();var p3=z1.exports;const xe=Wi(p3),Ad={width:xe.number,height:xe.number,graphData:xe.shape({nodes:xe.arrayOf(xe.object).isRequired,links:xe.arrayOf(xe.object).isRequired}),backgroundColor:xe.string,nodeRelSize:xe.number,nodeId:xe.string,nodeLabel:xe.oneOfType([xe.string,xe.func]),nodeVal:xe.oneOfType([xe.number,xe.string,xe.func]),nodeVisibility:xe.oneOfType([xe.bool,xe.string,xe.func]),nodeColor:xe.oneOfType([xe.string,xe.func]),nodeAutoColorBy:xe.oneOfType([xe.string,xe.func]),onNodeHover:xe.func,onNodeClick:xe.func,linkSource:xe.string,linkTarget:xe.string,linkLabel:xe.oneOfType([xe.string,xe.func]),linkVisibility:xe.oneOfType([xe.bool,xe.string,xe.func]),linkColor:xe.oneOfType([xe.string,xe.func]),linkAutoColorBy:xe.oneOfType([xe.string,xe.func]),linkWidth:xe.oneOfType([xe.number,xe.string,xe.func]),linkCurvature:xe.oneOfType([xe.number,xe.string,xe.func]),linkDirectionalArrowLength:xe.oneOfType([xe.number,xe.string,xe.func]),linkDirectionalArrowColor:xe.oneOfType([xe.string,xe.func]),linkDirectionalArrowRelPos:xe.oneOfType([xe.number,xe.string,xe.func]),linkDirectionalParticles:xe.oneOfType([xe.number,xe.string,xe.func]),linkDirectionalParticleSpeed:xe.oneOfType([xe.number,xe.string,xe.func]),linkDirectionalParticleOffset:xe.oneOfType([xe.number,xe.string,xe.func]),linkDirectionalParticleWidth:xe.oneOfType([xe.number,xe.string,xe.func]),linkDirectionalParticleColor:xe.oneOfType([xe.string,xe.func]),onLinkHover:xe.func,onLinkClick:xe.func,dagMode:xe.oneOf(["td","bu","lr","rl","zin","zout","radialin","radialout"]),dagLevelDistance:xe.number,dagNodeFilter:xe.func,onDagError:xe.func,d3AlphaMin:xe.number,d3AlphaDecay:xe.number,d3VelocityDecay:xe.number,warmupTicks:xe.number,cooldownTicks:xe.number,cooldownTime:xe.number,onEngineTick:xe.func,onEngineStop:xe.func,getGraphBbox:xe.func},$1={zoomToFit:xe.func,onNodeRightClick:xe.func,onNodeDrag:xe.func,onNodeDragEnd:xe.func,onLinkRightClick:xe.func,linkHoverPrecision:xe.number,onBackgroundClick:xe.func,onBackgroundRightClick:xe.func,showPointerCursor:xe.oneOfType([xe.bool,xe.func]),enablePointerInteraction:xe.bool,enableNodeDrag:xe.bool},Ip={showNavInfo:xe.bool,nodeOpacity:xe.number,nodeResolution:xe.number,nodeThreeObject:xe.oneOfType([xe.object,xe.string,xe.func]),nodeThreeObjectExtend:xe.oneOfType([xe.bool,xe.string,xe.func]),nodePositionUpdate:xe.func,linkOpacity:xe.number,linkResolution:xe.number,linkCurveRotation:xe.oneOfType([xe.number,xe.string,xe.func]),linkMaterial:xe.oneOfType([xe.object,xe.string,xe.func]),linkThreeObject:xe.oneOfType([xe.object,xe.string,xe.func]),linkThreeObjectExtend:xe.oneOfType([xe.bool,xe.string,xe.func]),linkPositionUpdate:xe.func,linkDirectionalArrowResolution:xe.number,linkDirectionalParticleResolution:xe.number,linkDirectionalParticleThreeObject:xe.oneOfType([xe.object,xe.string,xe.func]),forceEngine:xe.oneOf(["d3","ngraph"]),ngraphPhysics:xe.object,numDimensions:xe.oneOf([1,2,3])},m3=Object.assign({},Ad,$1,{linkLineDash:xe.oneOfType([xe.arrayOf(xe.number),xe.string,xe.func]),nodeCanvasObjectMode:xe.oneOfType([xe.string,xe.func]),nodeCanvasObject:xe.func,nodePointerAreaPaint:xe.func,linkCanvasObjectMode:xe.oneOfType([xe.string,xe.func]),linkCanvasObject:xe.func,linkPointerAreaPaint:xe.func,linkDirectionalParticleCanvasObject:xe.func,autoPauseRedraw:xe.bool,minZoom:xe.number,maxZoom:xe.number,enableZoomInteraction:xe.oneOfType([xe.bool,xe.func]),enablePanInteraction:xe.oneOfType([xe.bool,xe.func]),onZoom:xe.func,onZoomEnd:xe.func,onRenderFramePre:xe.func,onRenderFramePost:xe.func});Object.assign({},Ad,$1,Ip,{enableNavigationControls:xe.bool,controlType:xe.oneOf(["trackball","orbit","fly"]),rendererConfig:xe.object,extraRenderers:xe.arrayOf(xe.shape({render:xe.func.isRequired}))});Object.assign({},Ad,Ip,{nodeDesc:xe.oneOfType([xe.string,xe.func]),linkDesc:xe.oneOfType([xe.string,xe.func])});Object.assign({},Ad,Ip,{markerAttrs:xe.object,yOffset:xe.number,glScale:xe.number});const Tp=R_(c3,{methodNames:["emitParticle","d3Force","d3ReheatSimulation","stopAnimation","pauseAnimation","resumeAnimation","centerAt","zoom","zoomToFit","getGraphBbox","screen2GraphCoords","graph2ScreenCoords"]});Tp.displayName="ForceGraph2D";Tp.propTypes=m3;function ia(e){return function(){return e}}function ax(e){return(e()-.5)*1e-6}function g3(e){return e.x+e.vx}function y3(e){return e.y+e.vy}function x3(e){var n,i,s,a=1,o=1;typeof e!="function"&&(e=ia(e==null?1:+e));function l(){for(var u,f=n.length,h,m,g,b,j,y,x=0;x<o;++x)for(h=lp(n,g3,y3).visitAfter(c),u=0;u<f;++u)m=n[u],j=i[m.index],y=j*j,g=m.x+m.vx,b=m.y+m.vy,h.visit(v);function v(A,N,C,w,_){var I=A.data,O=A.r,E=j+O;if(I){if(I.index>m.index){var S=g-I.x-I.vx,k=b-I.y-I.vy,D=S*S+k*k;D<E*E&&(S===0&&(S=ax(s),D+=S*S),k===0&&(k=ax(s),D+=k*k),D=(E-(D=Math.sqrt(D)))/D*a,m.vx+=(S*=D)*(E=(O*=O)/(y+O)),m.vy+=(k*=D)*E,I.vx-=S*(E=1-E),I.vy-=k*E)}return}return N>g+E||w<g-E||C>b+E||_<b-E}}function c(u){if(u.data)return u.r=i[u.data.index];for(var f=u.r=0;f<4;++f)u[f]&&u[f].r>u.r&&(u.r=u[f].r)}function d(){if(n){var u,f=n.length,h;for(i=new Array(f),u=0;u<f;++u)h=n[u],i[h.index]=+e(h,u,n)}}return l.initialize=function(u,f){n=u,s=f,d()},l.iterations=function(u){return arguments.length?(o=+u,l):o},l.strength=function(u){return arguments.length?(a=+u,l):a},l.radius=function(u){return arguments.length?(e=typeof u=="function"?u:ia(+u),d(),l):e},l}function v3(e,n,i){var s,a=ia(.1),o,l;typeof e!="function"&&(e=ia(+e)),n==null&&(n=0),i==null&&(i=0);function c(u){for(var f=0,h=s.length;f<h;++f){var m=s[f],g=m.x-n||1e-6,b=m.y-i||1e-6,j=Math.sqrt(g*g+b*b),y=(l[f]-j)*o[f]*u/j;m.vx+=g*y,m.vy+=b*y}}function d(){if(s){var u,f=s.length;for(o=new Array(f),l=new Array(f),u=0;u<f;++u)l[u]=+e(s[u],u,s),o[u]=isNaN(l[u])?0:+a(s[u],u,s)}}return c.initialize=function(u){s=u,d()},c.strength=function(u){return arguments.length?(a=typeof u=="function"?u:ia(+u),d(),c):a},c.radius=function(u){return arguments.length?(e=typeof u=="function"?u:ia(+u),d(),c):e},c.x=function(u){return arguments.length?(n=+u,c):n},c.y=function(u){return arguments.length?(i=+u,c):i},c}const b3={customer:"거래처",employee:"담당자",sales_activity:"영업활동",revenue:"매출"},Rr={customer:"#3b82f6",employee:"#ef4444",sales_activity:"#10b981",revenue:"#f59e0b",customer_inactive:"#94a3b8"};function j3({customer:e,onClose:n,initialMode:i="customer"}){const s=p.useRef(null),a=p.useRef(null),[o,l]=p.useState(i),[c,d]=p.useState(!0),[u,f]=p.useState(null),[h,m]=p.useState({nodes:[],links:[]}),[g,b]=p.useState(new Set),[j,y]=p.useState(new Set),[x,v]=p.useState(null),[A,N]=p.useState(null),[C,w]=p.useState({width:800,height:600}),[_,I]=p.useState(null),[O,E]=p.useState([]),[S,k]=p.useState({}),[D,T]=p.useState([]);p.useEffect(()=>{const ee=()=>{s.current&&w({width:s.current.clientWidth,height:s.current.clientHeight})};return window.addEventListener("resize",ee),setTimeout(ee,100),()=>window.removeEventListener("resize",ee)},[]);const P=typeof window<"u"?localStorage.getItem("tnt.sales.empId")||e.empId||null:e.empId||null,R=p.useCallback(async()=>{d(!0),f(null);try{d(!0),f(null);let ee="";if(o==="customer"){const pe=new URLSearchParams;e.customerSeq!=null&&pe.set("customerSeq",String(e.customerSeq));const G=pe.toString();ee=`/api/v1/graph/customer/${e.customerId}${G?`?${G}`:""}`}else o==="all-customers"?ee=`/api/v1/graph/employee/${P||e.assigneeId||"1001"}/customers`:o==="all-employees"&&(ee="/api/v1/graph/employees");const ne=await(await fetch(ee)).json();if(ne.error)throw new Error(ne.error);if(o==="all-employees"){const pe=ne.nodes.map(G=>({...G,...G,val:30,color:Rr.employee}));T(pe),m({nodes:pe,links:[]}),E([]),k({}),E([]),k({}),I(ne.insights||null)}else{const pe=ne.nodes.map(G=>({...G,val:G.type==="customer"?7:G.type==="employee"?10:(G.type==="customer_inactive",3),color:Rr[G.type]||"#999"}));m({nodes:pe,links:ne.edges}),I(ne.insights)}}catch(ee){f(ee.message)}finally{d(!1)}},[e.customerId,o]);p.useEffect(()=>{R()},[R]);const Y=async ee=>{try{const ne=`/api/v1/graph/employee/${ee.split("_")[1]}/customers`,G=await(await fetch(ne)).json();if(!G.error)return{nodes:G.nodes.map(ie=>({...ie,val:ie.type==="customer"?7:ie.type==="employee"?10:(ie.type==="customer_inactive",3),color:Rr[ie.type]||"#999"})),links:G.edges,insights:G.insights}}catch(K){console.error(K)}return null},X=(ee,K)=>{const ne=new Map,pe=new Map;D.forEach(G=>ne.set(G.id,G)),ee.forEach(G=>{const ae=K[G];ae&&(ae.nodes.forEach(ie=>ne.set(ie.id,ie)),ae.links.forEach(ie=>pe.set(ie.id,ie)))}),m({nodes:Array.from(ne.values()),links:Array.from(pe.values())})};p.useEffect(()=>{const ee=K=>{K.key==="Escape"&&n()};return window.addEventListener("keydown",ee),()=>window.removeEventListener("keydown",ee)},[n]);const H=async ee=>{if(o==="all-employees"&&ee.type==="employee"){if(N(ee),O.includes(ee.id)){a.current&&(a.current.centerAt(ee.x,ee.y,1e3),a.current.zoom(1.5,1e3));return}let K=[...O,ee.id];if(K.length>5&&K.shift(),E(K),S[ee.id]){X(K,S);const ne=S[ee.id];ne&&ne.insights&&I(ne.insights)}else{const ne=await Y(ee.id);ne&&(k(pe=>({...pe,[ee.id]:ne})),X(K,{...S,[ee.id]:ne}),ne.insights&&I(ne.insights))}}else N(ee),a.current&&ee.x&&ee.y&&(a.current.centerAt(ee.x,ee.y,1e3),a.current.zoom(2.5,1e3))},q=ee=>{v(ee);const K=new Set,ne=new Set;if(ee&&(K.add(ee.id),h.links.forEach(ae=>{const ie=typeof ae.source=="object"?ae.source.id:ae.source,J=typeof ae.target=="object"?ae.target.id:ae.target;(ie===ee.id||J===ee.id)&&(ne.add(ae.id),K.add(ie),K.add(J))})),!ee){b(new Set),y(new Set);return}const pe=new Set,G=new Set;h.links.forEach(ae=>{const ie=typeof ae.source=="object"?ae.source.id:ae.source,J=typeof ae.target=="object"?ae.target.id:ae.target;(ie===ee.id||J===ee.id)&&(G.add(ae.id),pe.add(ie),pe.add(J))}),b(pe),y(G)},M=()=>{a.current&&a.current.zoom(a.current.zoom()*1.2,400)},L=()=>{a.current&&a.current.zoom(a.current.zoom()*.8,400)},B=()=>{R(),a.current&&a.current.zoomToFit(400)},F=ee=>ee>=1e8?`${(ee/1e8).toFixed(1)}억`:ee>=1e4?`${(ee/1e4).toFixed(0)}만`:ee.toLocaleString(),te=p.useCallback(()=>{if(a.current){const ee=o==="all-customers",K=o==="all-employees",ne=a.current.graphData(),pe={};ne.links.forEach(G=>{const ae=typeof G.source=="object"?G.source.id:G.source,ie=typeof G.target=="object"?G.target.id:G.target;pe[ae]=(pe[ae]||0)+1,pe[ie]=(pe[ie]||0)+1}),a.current.d3Force("collide",x3().radius(G=>(G.type==="customer"?15:G.type==="customer_inactive"?5:10)*(K?1.2:ee?1.5:3))),a.current.d3Force("charge").strength(G=>G.type==="customer_inactive"?-10:K?-30-(pe[G.id]||0)*3:ee?-100:-300),a.current.d3Force("link").distance(G=>{if((typeof G.target=="object"?G.target:{type:""}).type==="customer_inactive")return 250;if(K){const ie=typeof G.source=="object"?G.source.id:G.source,J=typeof G.target=="object"?G.target.id:G.target,re=pe[ie]||0,de=pe[J]||0,he=Math.max(re,de);return 20+Math.min(he,50)}return ee?40:60}),K?a.current.d3Force("radial",v3(0,0,0).strength(.08)):a.current.d3Force("radial",null)}},[o]);p.useEffect(()=>{h.nodes.length>0&&setTimeout(te,100)},[h,te]);const $=p.useCallback((ee,K,ne)=>{const pe=ee.label,ae=(ee.val||5)*(ee.type==="customer"?1.5:1),ie=g.has(ee.id),J=g.size>0,re=ee.id===(x==null?void 0:x.id),de=!J||ie;let he=!1;if(o==="all-employees"?(he=!0,ee.type!=="employee"&&(he=ie||re||ne>=1.5)):o==="all-customers"?ie||re||ee.type==="employee"?he=!0:ee.type==="customer"?he=ne>=1.2:he=ne>=2.5:ie||re||ee.type==="customer"||ee.type==="employee"?he=!0:ee.type==="customer_inactive"?he=ne>=1.5:he=ne>=1,K.globalAlpha=de?1:.2,K.beginPath(),K.arc(ee.x,ee.y,ae,0,2*Math.PI,!1),K.fillStyle=ee.color||"#999",K.fill(),(re||ie&&J)&&(K.lineWidth=2/ne,K.strokeStyle="#333",K.stroke()),he&&de){const V=Math.min(6/Math.pow(ne,.6)*1.3,15);K.font=`${V}px Sans-Serif`,K.textAlign="center",K.textBaseline="middle",K.fillStyle="#1e293b",pe.split(`
`).forEach((Ve,tt)=>{const ot=ae+V*.6+tt*V*1.1+2;K.fillText(Ve,ee.x,ee.y+ot)})}K.globalAlpha=1},[g,x,h.nodes.length,o]),W=p.useCallback((ee,K)=>{const ne=j.has(ee.id)||j.size===0;K.globalAlpha=ne?1:.1,K.beginPath(),K.moveTo(ee.source.x,ee.source.y),K.lineTo(ee.target.x,ee.target.y),K.lineWidth=1,K.strokeStyle="#cbd5e1",j.has(ee.id)&&(K.strokeStyle="#64748b",K.lineWidth=2),K.stroke(),K.globalAlpha=1},[j]),U=()=>{if(!_)return null;const ee="totalEmployees"in _,K="totalCustomers"in _;return r.jsxs("div",{style:{position:"absolute",top:16,left:16,display:"flex",flexDirection:"column",gap:12,zIndex:10},children:[!ee&&r.jsxs("div",{style:{backgroundColor:"white",padding:16,borderRadius:12,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",border:"1px solid #f1f5f9",display:"flex",alignItems:"center",gap:16},children:[r.jsx("div",{style:{padding:8,backgroundColor:"#eff6ff",borderRadius:8},children:r.jsx(Ig,{size:24,color:"#2563eb"})}),r.jsxs("div",{children:[r.jsx("p",{style:{fontSize:11,color:"#64748b",fontWeight:600,textTransform:"uppercase"},children:"Recent Activities"}),r.jsxs("p",{style:{fontSize:18,fontWeight:700,color:"#1e293b",margin:0},children:[_.recentActivities||0,"건"]})]})]}),ee&&r.jsxs("div",{style:{backgroundColor:"white",padding:16,borderRadius:12,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",border:"1px solid #f1f5f9",display:"flex",alignItems:"center",gap:16},children:[r.jsx("div",{style:{padding:8,backgroundColor:"#eff6ff",borderRadius:8},children:r.jsx(ao,{size:24,color:"#2563eb"})}),r.jsxs("div",{children:[r.jsx("p",{style:{fontSize:11,color:"#64748b",fontWeight:600,textTransform:"uppercase"},children:"Total Employees"}),r.jsxs("p",{style:{fontSize:18,fontWeight:700,color:"#1e293b",margin:0},children:[_.totalEmployees,"명"]})]})]}),!ee&&r.jsxs("div",{style:{backgroundColor:"white",padding:16,borderRadius:12,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",border:"1px solid #f1f5f9",display:"flex",alignItems:"center",gap:16},children:[r.jsx("div",{style:{padding:8,backgroundColor:"#ecfdf5",borderRadius:8},children:r.jsx(Ni,{size:24,color:"#059669"})}),r.jsxs("div",{children:[r.jsx("p",{style:{fontSize:11,color:"#64748b",fontWeight:600,textTransform:"uppercase"},children:"Total Revenue (90일)"}),r.jsxs("p",{style:{fontSize:18,fontWeight:700,color:"#1e293b",margin:0},children:[F(_.totalRevenue||0),"원"]})]})]}),K&&r.jsxs("div",{style:{backgroundColor:"white",padding:16,borderRadius:12,boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)",border:"1px solid #f1f5f9",display:"flex",alignItems:"center",gap:16},children:[r.jsx("div",{style:{padding:8,backgroundColor:"#f0fdf4",borderRadius:8},children:r.jsx(ao,{size:24,color:"#15803d"})}),r.jsxs("div",{children:[r.jsx("p",{style:{fontSize:11,color:"#64748b",fontWeight:600,textTransform:"uppercase"},children:"Total Customers"}),r.jsxs("p",{style:{fontSize:18,fontWeight:700,color:"#1e293b",margin:0},children:[_.totalCustomers,"개사"]})]})]}),h._sample&&r.jsx("div",{style:{padding:"8px 12px",background:"#fef3c7",borderRadius:8,fontSize:11,color:"#92400e",width:"fit-content"},children:"샘플 데이터입니다"})]})},Z=()=>{if(!A)return null;const ee=A.properties||{},K=Object.entries(ee).filter(([ae])=>!["elementId","id","x","y","vx","vy","index","color","val"].includes(ae));let ne=A.label.split(`
`)[0],pe=b3[A.type]||A.type,G=r.jsx(ao,{size:20,color:Rr[A.type]});return A.type==="sales_activity"?G=r.jsx(Ig,{size:20,color:Rr.sales_activity}):A.type==="revenue"&&(G=r.jsx(Ni,{size:20,color:Rr.revenue})),r.jsxs("div",{style:{position:"absolute",top:16,right:16,width:320,backgroundColor:"white",borderRadius:16,boxShadow:"0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1)",zIndex:20,border:"1px solid #e2e8f0",overflow:"hidden",maxHeight:"calc(100% - 32px)",display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #f1f5f9",display:"flex",alignItems:"start",justifyContent:"space-between",backgroundColor:"#f8fafc"},children:[r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsx("div",{style:{padding:8,backgroundColor:"white",borderRadius:8,boxShadow:"0 1px 2px rgba(0,0,0,0.05)",height:"fit-content"},children:G}),r.jsxs("div",{children:[r.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:600,color:"#1e293b"},children:ne}),r.jsx("span",{style:{fontSize:12,color:"#64748b",fontWeight:500},children:pe})]})]}),r.jsx("button",{onClick:()=>N(null),style:{background:"transparent",border:"none",cursor:"pointer",color:"#94a3b8"},children:r.jsx(On,{size:18})})]}),r.jsx("div",{style:{padding:"16px 20px",overflowY:"auto"},children:K.length>0?r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:K.map(([ae,ie])=>r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[r.jsx("span",{style:{fontSize:11,color:"#94a3b8",textTransform:"uppercase",fontWeight:600},children:ae.replace(/_/g," ")}),r.jsx("span",{style:{fontSize:14,color:"#334155"},children:String(ie)})]},ae))}):r.jsx("div",{style:{color:"#94a3b8",fontSize:13,textAlign:"center",padding:"20px 0"},children:"상세 정보가 없습니다"})})]})};return r.jsx("div",{style:{position:"fixed",inset:0,zIndex:50,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(0, 0, 0, 0.5)",backdropFilter:"blur(4px)"},children:r.jsxs("div",{style:{backgroundColor:"white",borderRadius:16,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",width:"95%",height:"90%",display:"flex",flexDirection:"column",overflow:"hidden"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"16px 24px",borderBottom:"1px solid #e2e8f0"},children:[r.jsx("div",{children:r.jsxs("h2",{style:{fontSize:20,fontWeight:600,color:"#1e293b"},children:[e.customerName," ",r.jsx("span",{style:{fontSize:14,fontWeight:400,color:"#64748b"},children:"관계도 분석"})]})}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsxs("div",{style:{display:"flex",background:"#f1f5f9",padding:4,borderRadius:8},children:[r.jsx("button",{onClick:()=>l("customer"),style:{padding:"6px 12px",borderRadius:6,fontSize:13,fontWeight:500,backgroundColor:o==="customer"?"white":"transparent",color:o==="customer"?"#0f172a":"#64748b",boxShadow:o==="customer"?"0 1px 3px rgba(0,0,0,0.1)":"none",border:"none",cursor:"pointer"},children:"현재 거래처"}),r.jsx("button",{onClick:()=>l("all-customers"),style:{padding:"6px 12px",borderRadius:6,fontSize:13,fontWeight:500,backgroundColor:o==="all-customers"?"white":"transparent",color:o==="all-customers"?"#0f172a":"#64748b",boxShadow:o==="all-customers"?"0 1px 3px rgba(0,0,0,0.1)":"none",border:"none",cursor:"pointer"},children:"내 전체 거래처"}),r.jsx("button",{onClick:()=>l("all-employees"),style:{padding:"6px 12px",borderRadius:6,fontSize:13,fontWeight:500,backgroundColor:o==="all-employees"?"white":"transparent",color:o==="all-employees"?"#0f172a":"#64748b",boxShadow:o==="all-employees"?"0 1px 3px rgba(0,0,0,0.1)":"none",border:"none",cursor:"pointer"},children:"전체 영업사원"})]}),r.jsx("button",{onClick:n,style:{padding:8,borderRadius:"50%",border:"none",background:"#f1f5f9",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(On,{size:20,color:"#64748b"})})]})]}),r.jsxs("div",{ref:s,style:{flex:1,position:"relative",backgroundColor:"#f8fafc",overflow:"hidden",cursor:"grab"},children:[c&&r.jsx("div",{style:{position:"absolute",inset:0,zIndex:10,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(255,255,255,0.8)"},children:r.jsx("div",{className:"animate-spin",style:{width:32,height:32,borderRadius:"50%",border:"3px solid #e2e8f0",borderTopColor:"#3b82f6"}})}),u&&r.jsxs("div",{style:{position:"absolute",inset:0,zIndex:10,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:12,color:"#ef4444"},children:[r.jsx("div",{children:u}),r.jsx("button",{onClick:R,style:{padding:"8px 16px",borderRadius:6,backgroundColor:"white",border:"1px solid #e2e8f0",fontSize:13,fontWeight:500},children:"다시 시도"})]}),!c&&!u&&r.jsxs(r.Fragment,{children:[U(),Z(),r.jsxs("div",{style:{position:"absolute",right:16,bottom:24,zIndex:5,display:"flex",flexDirection:"column",gap:8},children:[r.jsx(Gu,{onClick:M,icon:r.jsx(s_,{size:18}),title:"확대"}),r.jsx(Gu,{onClick:L,icon:r.jsx(o_,{size:18}),title:"축소"}),r.jsx(Gu,{onClick:B,icon:r.jsx(ln,{size:18}),title:"새로고침"})]}),r.jsx(Tp,{ref:a,width:C.width,height:C.height,graphData:h,nodeLabel:"label",nodeColor:"color",nodeRelSize:6,nodeCanvasObject:$,linkCanvasObject:W,onNodeClick:ee=>{H(ee),N(ee)},onNodeHover:q,onNodeDragEnd:ee=>{ee.fx=ee.x,ee.fy=ee.y},d3VelocityDecay:.1,cooldownTicks:100,onEngineStop:()=>{var ee;return(ee=a.current)==null?void 0:ee.zoomToFit(400,50)}})]})]}),r.jsxs("div",{style:{padding:"12px 24px",borderTop:"1px solid #e2e8f0",display:"flex",gap:24,fontSize:12,color:"#64748b"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:Rr.customer}}),"거래처"]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:Rr.employee}}),"담당자"]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:Rr.sales_activity}}),"영업활동"]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:Rr.revenue}}),"매출"]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:Rr.customer_inactive}}),"활동/매출 없음"]}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:8},children:[r.jsx(ao,{size:14}),h.nodes.length," Nodes"]})]})]})})}const Gu=({onClick:e,icon:n,title:i})=>r.jsx("button",{onClick:e,title:i,style:{width:36,height:36,borderRadius:"50%",backgroundColor:"white",border:"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"center",color:"#475569",boxShadow:"0 2px 4px rgba(0,0,0,0.05)",cursor:"pointer"},children:n});function Il(e){if(!e)return"";const n=e instanceof Date?e:new Date(e);if(isNaN(n.getTime()))return"";const i=String(n.getFullYear()%100).padStart(2,"0"),s=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0");return`${i}-${s}-${a} ${o}:${l}`}function Ep({compact:e=!1,maxHeight:n,context:i="list",onSelect:s,autoSelectFirst:a=!0}){const[o,l]=p.useState(""),[c,d]=p.useState(""),[u,f]=p.useState(""),[h,m]=p.useState(!1),[g,b]=p.useState(null),[j,y]=p.useState([]),[x,v]=p.useState("mine"),[A,N]=p.useState({open:!1,x:0,y:0}),[C,w]=p.useState(()=>new Set),[_,I]=p.useState({open:!1,x:0,y:0}),[O,E]=p.useState({open:!1}),[S,k]=p.useState({}),[D,T]=p.useState({}),[P,R]=p.useState(!1),[Y,X]=p.useState(0),H=100,[q,M]=p.useState(0),[L,B]=p.useState(!0),[F,te]=p.useState(!1),$=Be.useRef(null),[W,U]=p.useState(()=>{try{const he=localStorage.getItem("tnt.sales.selectedCustomer");if(he){const oe=JSON.parse(he),V=Number(oe==null?void 0:oe.customerSeq);return Number.isFinite(V)?V:null}}catch{}return null}),[Z,ee]=p.useState(()=>{try{const he=localStorage.getItem("tnt.sales.selectedCustomer");if(he){const oe=JSON.parse(he);return String((oe==null?void 0:oe.customerId)||"")||null}}catch{}return null}),K=p.useMemo(()=>{const he=typeof window<"u"?localStorage.getItem("tnt.sales.empName"):"",oe=typeof window<"u"?localStorage.getItem("tnt.sales.assigneeId"):"";return he||oe||""},[]);function ne(he,oe){w(V=>{const Pe=new Set(V);return oe?Pe.add(he):Pe.delete(he),Pe})}function pe(he){if(!he){w(new Set);return}const oe=new Set;j.forEach(V=>{V.customerId&&oe.add(V.customerId)}),w(oe)}async function G(he=!0){b(null),he?(m(!0),M(0),B(!0)):te(!0);try{const oe=localStorage.getItem("tnt.sales.assigneeId");if(!oe){y([]),b(zt.loginRequired);return}const V=new URL("/api/v1/customers",window.location.origin);o.trim()&&V.searchParams.set("name",o.trim()),c.trim()&&V.searchParams.set("provinceName",c.trim()),u.trim()&&V.searchParams.set("cityName",u.trim());const Pe=x==="mine";V.searchParams.set("mineOnly",Pe?"true":"false"),Pe&&oe&&V.searchParams.set("assigneeId",oe),V.searchParams.set("limit",String(H)),V.searchParams.set("offset",String(he?0:q));const Ve=await fetch(V.toString());if(!Ve.ok){let je=`HTTP ${Ve.status}`;try{const Te=await Ve.json();Te!=null&&Te.error&&(je=Te.error)}catch{const Le=await Ve.text();Le&&(je=Le)}throw new Error(je)}const tt=await Ve.json(),ot=Array.isArray(tt)?tt:[],ht=[...ot].sort((je,Te)=>{const Le=(je.customerName||"").toString(),ke=(Te.customerName||"").toString();return Le.localeCompare(ke,"ko",{sensitivity:"base"})}),vt=(he?ht:ot).map(je=>Number(je.customerSeq||0)).filter(je=>Number.isFinite(je)&&je>0),Se=Array.from(new Set(vt)).join(",");try{if(vt.length>0){const je=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);je.searchParams.set("custSeq",Se),je.searchParams.set("years","2");const Te=new URL("/api/v1/customers/demand-flags",window.location.origin);Te.searchParams.set("custSeq",Se);const[Le,ke]=await Promise.all([fetch(je.toString()),fetch(Te.toString())]);if(Le.ok){const Ue=await Le.json(),st={};Array.isArray(Ue)&&Ue.forEach(Ee=>{const dt=Number((Ee==null?void 0:Ee.customerSeq)||0);Number.isFinite(dt)&&(st[dt]=!!(Ee!=null&&Ee.hasRecent))}),k(Ee=>he?st:{...Ee,...st})}else he&&k({});if(ke.ok){const Ue=await ke.json(),st={};Array.isArray(Ue)&&Ue.forEach(Ee=>{const dt=Number((Ee==null?void 0:Ee.customerSeq)||0);Number.isFinite(dt)&&(st[dt]=!!(Ee!=null&&Ee.hasDemand))}),T(Ee=>he?st:{...Ee,...st})}else he&&T({})}else he&&(k({}),T({}))}catch{he&&(k({}),T({}))}y(he?ht:je=>[...je,...ht]),B(ot.length>=H),M(he?H:je=>je+H),he&&!P&&ht.length>0&&a&&(ae(ht[0]),R(!0));try{if(oe&&x==="mine"){const je=new URL("/api/v1/customers/count",window.location.origin);je.searchParams.set("mineOnly","true"),je.searchParams.set("assigneeId",oe);const Te=await fetch(je.toString());if(Te.ok){const Le=await Te.json().catch(()=>({})),ke=Number((Le==null?void 0:Le.total)??0);X(Number.isFinite(ke)?ke:0)}else X(0)}else X(0)}catch{X(0)}}catch(oe){b(oe.message||"조회 중 오류가 발생했습니다")}finally{he?m(!1):te(!1)}}p.useEffect(()=>{G(!0)},[]),p.useEffect(()=>{const he=()=>{try{const oe=localStorage.getItem("tnt.sales.selectedCustomer");if(oe){const V=JSON.parse(oe),Pe=Number(V==null?void 0:V.customerSeq);U(Number.isFinite(Pe)?Pe:null),ee((V==null?void 0:V.customerId)||null)}}catch{}};return window.addEventListener("tnt.sales.customer.selected",he),()=>window.removeEventListener("tnt.sales.customer.selected",he)},[]),p.useEffect(()=>{G(!0)},[x]),p.useEffect(()=>{const he=$.current;if(!he)return;function oe(){he.scrollTop+he.clientHeight>=he.scrollHeight-48&&L&&!F&&!h&&G(!1)}return he.addEventListener("scroll",oe),()=>he.removeEventListener("scroll",oe)},[L,F,h,q,o,c,u,x]),p.useEffect(()=>{if(!A.open)return;const he=()=>N({open:!1,x:0,y:0});return window.addEventListener("click",he),()=>window.removeEventListener("click",he)},[A.open]),p.useEffect(()=>{if(!A.open)return;const he=oe=>{oe.key==="Escape"&&N({open:!1,x:0,y:0})};return window.addEventListener("keydown",he),()=>window.removeEventListener("keydown",he)},[A.open]),p.useEffect(()=>{if(!_.open)return;const he=()=>I({open:!1,x:0,y:0}),oe=V=>{V.key==="Escape"&&I({open:!1,x:0,y:0})};return window.addEventListener("click",he),window.addEventListener("keydown",oe),()=>{window.removeEventListener("click",he),window.removeEventListener("keydown",oe)}},[_.open]),p.useEffect(()=>{const he=oe=>{((oe==null?void 0:oe.key)==="Escape"||(oe==null?void 0:oe.key)==="Esc"||(oe==null?void 0:oe.keyCode)===27)&&(N({open:!1,x:0,y:0}),I({open:!1,x:0,y:0}))};return document.addEventListener("keydown",he,!0),()=>document.removeEventListener("keydown",he,!0)},[]);function ae(he){try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(he||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:he}})),s&&s(he)}catch{}U((()=>{const oe=Number(he.customerSeq);return Number.isFinite(oe)?oe:null})()),ee(he.customerId||null),N({open:!1,x:0,y:0}),I({open:!1,x:0,y:0})}function ie(he,oe){const V=he.clientX,Pe=he.clientY;I({open:!0,x:V,y:Pe,row:oe,loading:!1,error:null,data:[]})}function J(he){_.open&&I(oe=>({...oe,x:he.clientX,y:he.clientY}))}function re(){I({open:!1,x:0,y:0})}const de=p.useMemo(()=>{const he=oe=>{const V=(oe||"").trim().toUpperCase();if(V!=="TNT"&&V!=="DYS")return null;const Pe=V==="TNT"?"#2563eb":"#16a34a";return r.jsx("span",{"aria-label":V,style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:"50%",color:"#fff",fontWeight:700,fontSize:11,background:Pe,flexShrink:0},children:V==="TNT"?"T":"D"})};return r.jsx(r.Fragment,{children:r.jsxs("div",{ref:$,className:"table-container",onClick:()=>N({open:!1,x:0,y:0}),style:{maxHeight:n??(e?"32vh":void 0),overflow:"auto"},children:[j.length===0?r.jsx("div",{className:"empty-state",children:zt.empty}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:36,textAlign:"center"},children:r.jsx("input",{type:"checkbox",checked:j.length>0&&C.size===j.length,onChange:oe=>pe(oe.target.checked)})}),r.jsx("th",{style:{width:140},children:"거래처번호"}),r.jsx("th",{style:{width:200},children:"거래처명"}),r.jsx("th",{style:{width:80},children:"추가정보"}),r.jsx("th",{style:{width:140},children:"사업자번호"}),r.jsx("th",{style:{width:120},children:"대표자명"}),r.jsx("th",{style:{width:120},children:"업태"}),r.jsx("th",{style:{width:120},children:"종목"}),r.jsx("th",{style:{width:130},children:"전화번호"}),r.jsx("th",{style:{width:120},children:"담당자명"}),r.jsx("th",{style:{width:140},children:"부서명"}),r.jsx("th",{style:{width:120},children:"시/도"}),r.jsx("th",{style:{width:120},children:"시/군/구"}),r.jsx("th",{style:{width:120},children:"고객유형"}),r.jsx("th",{children:"비고"}),r.jsx("th",{style:{width:120},children:"생성자"}),r.jsx("th",{style:{width:120},children:"수정자"}),r.jsx("th",{style:{width:180},children:"생성일시"}),r.jsx("th",{style:{width:180},children:"수정일시"})]})}),r.jsx("tbody",{children:j.map((oe,V)=>r.jsxs("tr",{className:Number(oe.customerSeq||0)===(W||-1)||Z&&oe.customerId===Z?"selected":void 0,onClick:()=>ae(oe),onContextMenu:Pe=>{Pe.preventDefault(),Pe.stopPropagation(),re(),N({open:!0,x:Pe.clientX,y:Pe.clientY,row:oe})},children:[r.jsx("td",{style:{textAlign:"center"},onClick:Pe=>Pe.stopPropagation(),children:r.jsx("input",{type:"checkbox",checked:C.has(oe.customerId),onChange:Pe=>ne(oe.customerId,Pe.target.checked)})}),r.jsx("td",{onMouseEnter:Pe=>ie(Pe,oe),onMouseMove:J,onMouseLeave:re,children:oe.customerId}),r.jsx("td",{children:i==="c360"?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[he(oe.companyType),r.jsx("span",{children:oe.customerName})]}):oe.customerName}),r.jsx("td",{children:(()=>{const Pe=Number(oe.customerSeq||0),Ve=!!S[Pe],tt=!!D[Pe];return!Ve&&!tt?"":r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[Ve&&r.jsx("img",{src:y_,className:"icon",alt:"",title:"최근2년 매출 있음",style:{width:14,height:14}}),tt&&r.jsx("img",{src:x_,className:"icon",alt:"",title:"수요 있음",style:{width:14,height:14}})]})})()}),r.jsx("td",{children:oe.bizNo||""}),r.jsx("td",{children:oe.ownerName||""}),r.jsx("td",{children:oe.bizKind||""}),r.jsx("td",{children:oe.bizType||""}),r.jsx("td",{children:oe.telNo||""}),r.jsx("td",{children:oe.empName||""}),r.jsx("td",{children:oe.deptName||""}),r.jsx("td",{children:oe.addrProvinceName||""}),r.jsx("td",{children:oe.addrCityName||""}),r.jsx("td",{children:oe.customerTypeName||""}),r.jsx("td",{children:oe.customerRemark||""}),r.jsx("td",{children:oe.createdBy??""}),r.jsx("td",{children:oe.updatedBy??""}),r.jsx("td",{children:Il(oe.createdAt)}),r.jsx("td",{children:Il(oe.updatedAt)})]},V))})]}),F&&r.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:zt.loading}),!h&&!F&&!L&&j.length>0&&r.jsx("div",{className:"muted",style:{padding:"8px 10px",textAlign:"center"},children:"마지막 데이터입니다."}),A.open&&r.jsxs("div",{className:"context-menu",style:{left:A.x+4,top:A.y+4},onClick:oe=>oe.stopPropagation(),children:[i!=="c360"?r.jsxs(r.Fragment,{children:[r.jsx("button",{className:"context-item",onClick:()=>{try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(A.row||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:A.row}}))}catch{}const oe=document.querySelector('button[data-key="customer:c360"]');oe&&oe.click(),N({open:!1,x:0,y:0})},children:"C360"}),r.jsx("button",{className:"context-item",onClick:()=>{try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(A.row||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:A.row}}))}catch{}window.dispatchEvent(new CustomEvent("tnt.sales.navigate",{detail:{key:"sales-mgmt:receivables"}})),N({open:!1,x:0,y:0})},children:"미수현황"})]}):null,r.jsx("button",{className:"context-item",onClick:()=>{try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(A.row||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:A.row}}))}catch{}if(i==="c360")try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.create.inline",{detail:{customer:A.row}}))}catch{}else{const oe=document.querySelector('button[data-key="customer:sales-activity-new"]');oe&&oe.click()}N({open:!1,x:0,y:0})},children:"활동등록"}),i==="c360"&&r.jsx("button",{className:"context-item",onClick:()=>{E({open:!0,customer:A.row}),N({open:!1,x:0,y:0})},children:"Graph 보기"})]}),_.open&&_.row&&r.jsxs("div",{className:"context-menu",style:{left:_.x+6,top:_.y+6,maxWidth:500,padding:10},onClick:oe=>oe.stopPropagation(),onMouseLeave:re,children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 정보"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr",gap:6,maxWidth:480},children:[r.jsx("div",{className:"muted",children:"거래처번호"}),r.jsx("div",{children:_.row.customerId||""}),r.jsx("div",{className:"muted",children:"거래처명"}),r.jsx("div",{children:_.row.customerName||""}),_.row.customerFullName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"정식명"}),r.jsx("div",{children:_.row.customerFullName})]}):null,_.row.bizNo?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"사업자번호"}),r.jsx("div",{children:_.row.bizNo})]}):null,_.row.ownerName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"대표자명"}),r.jsx("div",{children:_.row.ownerName})]}):null,_.row.bizKind?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"업태"}),r.jsx("div",{children:_.row.bizKind})]}):null,_.row.bizType?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"종목"}),r.jsx("div",{children:_.row.bizType})]}):null,_.row.telNo?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"전화번호"}),r.jsx("div",{children:_.row.telNo})]}):null,_.row.empName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"담당자명"}),r.jsx("div",{children:_.row.empName})]}):null,_.row.deptName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"부서명"}),r.jsx("div",{children:_.row.deptName})]}):null,_.row.addrProvinceName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"시/도"}),r.jsx("div",{children:_.row.addrProvinceName})]}):null,_.row.addrCityName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"시/군/구"}),r.jsx("div",{children:_.row.addrCityName})]}):null,_.row.customerTypeName?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"고객유형"}),r.jsx("div",{children:_.row.customerTypeName})]}):null,_.row.customerRemark?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"비고"}),r.jsx("div",{children:_.row.customerRemark})]}):null,_.row.createdAt?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"생성일시"}),r.jsx("div",{children:Il(_.row.createdAt)})]}):null,_.row.updatedAt?r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"muted",children:"수정일시"}),r.jsx("div",{children:Il(_.row.updatedAt)})]}):null]})]})]})})},[j,A,C,_]);return r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,alignItems:"center",flex:"1 1 auto",minWidth:0},children:[r.jsxs("select",{value:x,onChange:he=>v(he.target.value),style:{height:30,padding:"2px 8px",fontSize:11,background:x==="mine"?"rgba(59,130,246,.15)":"#fff",borderRadius:8,border:x==="mine"?"1px solid var(--accent)":"1px solid var(--border)"},children:[r.jsx("option",{value:"mine",children:"내 거래처"}),r.jsx("option",{value:"hq",children:"본부 거래처"}),r.jsx("option",{value:"all",children:"전체"})]}),r.jsx("input",{className:"search-input",value:o,onChange:he=>l(he.target.value),onKeyDown:he=>{he.key==="Enter"&&G()},placeholder:"거래처명",style:{background:"#fff",borderRadius:8,border:"1px solid var(--border)"}}),r.jsx("input",{className:"search-input",value:c,onChange:he=>d(he.target.value),onKeyDown:he=>{he.key==="Enter"&&G()},placeholder:"시/도",style:{background:"#fff",borderRadius:8,border:"1px solid var(--border)",minWidth:100}}),r.jsx("input",{className:"search-input",value:u,onChange:he=>f(he.target.value),onKeyDown:he=>{he.key==="Enter"&&G()},placeholder:"시/군/구",style:{background:"#fff",borderRadius:8,border:"1px solid var(--border)",minWidth:120}}),r.jsx("button",{className:"btn",onClick:()=>G(),disabled:h,style:{height:30,padding:"0 12px"},children:"조회"}),h&&r.jsx("span",{className:"muted",style:{lineHeight:"30px"},children:zt.loading})]}),r.jsx("div",{className:"meta",style:{gap:0},children:r.jsxs("span",{className:"muted count-text",children:[x==="mine"&&K?`${K} · `:"",(x==="mine"?Y:j.length).toLocaleString(),"개 거래처",C.size?` · 선택 ${C.size}건`:""]})})]}),g&&r.jsx("div",{className:"error",children:g||zt.errorGeneric}),r.jsx("div",{style:{marginTop:12},children:de}),O.open&&O.customer&&r.jsx(j3,{customer:{customerId:O.customer.customerId,customerName:O.customer.customerName,customerSeq:O.customer.customerSeq,empSeq:O.customer.empSeq,empId:typeof window<"u"&&localStorage.getItem("tnt.sales.empId")||void 0,empName:O.customer.empName},onClose:()=>E({open:!1})})]})}function gi(e){if(!e)return"";const n=e instanceof Date?e:new Date(e);if(isNaN(n.getTime()))return"";const i=String(n.getFullYear()%100).padStart(2,"0"),s=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0");return`${i}-${s}-${a} ${o}:${l}`}function Pp({customerSeq:e,customerId:n,hideHeader:i=!1,hideRefresh:s=!1,enableContextMenu:a=!1}){const[o,l]=p.useState([]),[c,d]=p.useState(!1),[u,f]=p.useState(null),[h,m]=p.useState({open:!1,x:0,y:0}),g=p.useRef(null),[b,j]=p.useState(null);async function y(){f(null),d(!0);try{const C=new URL("/api/v1/sales-activities",window.location.origin);C.searchParams.set("mineOnly","false");const w=n&&n.trim()||(()=>{try{const O=localStorage.getItem("tnt.sales.selectedCustomer");if(O){const E=JSON.parse(O);return(E==null?void 0:E.customerId)||""}}catch{}return""})();C.searchParams.set("sfAccountId",w||"");const _=await fetch(C.toString());if(!_.ok){let O=`HTTP ${_.status}`;try{const E=await _.json();E!=null&&E.error&&(O=E.error)}catch{}throw new Error(O)}const I=await _.json();l(Array.isArray(I)?I:[])}catch(C){f(C.message||"조회 중 오류가 발생했습니다")}finally{d(!1)}}p.useEffect(()=>{e&&y()},[e,n]);async function x(C){try{const w=new URL("/api/v1/sales-activities",window.location.origin);w.searchParams.set("mineOnly","false");const _=n&&n.trim()||(()=>{try{const S=localStorage.getItem("tnt.sales.selectedCustomer");if(S){const k=JSON.parse(S);return(k==null?void 0:k.customerId)||""}}catch{}return""})();w.searchParams.set("sfAccountId",_||""),w.searchParams.set("parentSeq",String(C)),w.searchParams.set("includeParent","true");const I=await fetch(w.toString());if(!I.ok)return;const O=await I.json(),E=Array.isArray(O)?O:[];E.sort((S,k)=>{const D=!S.parentSeq,T=!k.parentSeq;if(D&&!T)return-1;if(!D&&T)return 1;const P=S.createdAt?new Date(S.createdAt).getTime():0;return(k.createdAt?new Date(k.createdAt).getTime():0)-P}),j(E)}catch{j([])}}p.useEffect(()=>{if(!h.open)return;const C=w=>{if(w.button!==0)return;const _=w.target;g.current&&_&&g.current.contains(_)||m({open:!1,x:0,y:0})};return window.addEventListener("mousedown",C,!0),()=>window.removeEventListener("mousedown",C,!0)},[h.open]),p.useEffect(()=>{if(!h.open)return;const C=w=>{((w==null?void 0:w.key)==="Escape"||(w==null?void 0:w.key)==="Esc"||(w==null?void 0:w.keyCode)===27)&&m({open:!1,x:0,y:0})};return document.addEventListener("keydown",C,!0),()=>document.removeEventListener("keydown",C,!0)},[h.open]),p.useEffect(()=>{if(!b)return;const C=w=>{w.key==="Escape"&&(w.preventDefault(),w.stopPropagation(),j(null))};return window.addEventListener("keydown",C,!0),()=>window.removeEventListener("keydown",C,!0)},[b]);const v=(C,w)=>C?w==="type"?{site_visit:"정기방문",opportunity:"영업기회",AR_mgmt:"채권관리",meeting:"미팅",call:"전화",email:"이메일",demo:"데모",task:"업무",other:"기타"}[C]||C:w==="status"?{scheduled:"계획",completed:"완료",canceled:"취소",postponed:"연기",no_show:"미방문"}[C]||C:w==="channel"&&{in_person:"방문",phone:"전화",email:"문자/메일/팩스",other:"기타",video:"영상",chat:"채팅",sms:"문자"}[C]||C:"",A=C=>[`제목: ${C.subject||""}`,`활동설명: ${C.description||""}`,`활동유형: ${v(C.activityType,"type")}`,`활동방법: ${v(C.channel,"channel")}`,`상태: ${v(C.activityStatus,"status")}`,`상위활동: ${C.parentSubject||""}`,`계획 일시: ${gi(C.plannedStartAt)}`,`종료 일시: ${gi(C.plannedEndAt)}`,`생성일시: ${gi(C.createdAt)}`,C.customerName?`거래처명: ${C.customerName}`:""].filter(Boolean).join(`
`),N=p.useMemo(()=>r.jsxs(r.Fragment,{children:[!i&&r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[r.jsx("div",{className:"muted"}),r.jsxs("div",{className:"muted count-text",children:["총 ",o.length,"건"]})]}),r.jsx("div",{className:"table-container",children:o.length===0?r.jsx("div",{className:"empty-state",children:"활동이 없습니다."}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:240},children:"제목"}),r.jsx("th",{style:{width:280},children:"활동설명"}),r.jsx("th",{style:{width:120},children:"활동유형"}),r.jsx("th",{style:{width:120},children:"활동방법"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:220},children:"상위활동"}),r.jsx("th",{style:{width:180},children:"계획 일시"}),r.jsx("th",{style:{width:180},children:"종료 일시"}),r.jsx("th",{style:{width:180},children:"생성일시"})]})}),r.jsx("tbody",{children:o.map((C,w)=>r.jsxs("tr",{title:A(C),onContextMenu:_=>{a&&C.parentSeq&&(_.preventDefault(),_.stopPropagation(),m({open:!0,x:_.clientX,y:_.clientY,row:C}))},children:[r.jsx("td",{children:C.subject||""}),r.jsx("td",{title:C.description||"",style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:C.description||""}),r.jsx("td",{children:v(C.activityType,"type")}),r.jsx("td",{children:v(C.channel,"channel")}),r.jsx("td",{children:v(C.activityStatus,"status")}),r.jsx("td",{children:C.parentSubject||""}),r.jsx("td",{children:gi(C.plannedStartAt)}),r.jsx("td",{children:gi(C.plannedEndAt)}),r.jsx("td",{children:gi(C.createdAt)})]},w))})]})})]}),[o]);return r.jsxs("section",{children:[!s&&r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("button",{className:"btn",onClick:y,disabled:c,children:c?"새로고침…":"새로고침"}),u&&r.jsx("span",{className:"error",children:u})]}),s&&u&&r.jsx("div",{className:"error",children:u}),r.jsx("div",{style:{marginTop:12},children:N}),h.open&&r.jsx("div",{ref:g,className:"context-menu",style:{left:h.x+4,top:h.y+4},onClick:C=>C.stopPropagation(),children:r.jsx("button",{className:"context-item",onClick:()=>{var C,w;(C=h.row)!=null&&C.parentSeq?x(h.row.parentSeq):(w=h.row)!=null&&w.id&&x(h.row.id),m({open:!1,x:0,y:0})},children:"관련활동"})}),b&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.4)"},onClick:()=>j(null),children:r.jsxs("div",{className:"card",style:{width:"min(1200px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:C=>C.stopPropagation(),children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsxs("div",{className:"list-title",style:{display:"flex",alignItems:"center",gap:6},children:[r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",style:{color:"#555"},children:[r.jsx("circle",{cx:"6",cy:"6",r:"3",stroke:"currentColor",strokeWidth:"1.8"}),r.jsx("circle",{cx:"18",cy:"6",r:"3",stroke:"currentColor",strokeWidth:"1.8"}),r.jsx("circle",{cx:"12",cy:"18",r:"3",stroke:"currentColor",strokeWidth:"1.8"}),r.jsx("line",{x1:"8.5",y1:"7.4",x2:"15.5",y2:"7.4",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),r.jsx("line",{x1:"7.2",y1:"8.9",x2:"10.8",y2:"15.1",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),r.jsx("line",{x1:"16.8",y1:"8.9",x2:"13.2",y2:"15.1",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]}),r.jsx("span",{style:{fontWeight:600,fontSize:14},children:"관련활동"}),r.jsxs("span",{className:"muted count-text",style:{marginLeft:8},children:["총 ",b.length,"건"]})]}),r.jsx("button",{onClick:()=>j(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:C=>{C.currentTarget.style.background="var(--panel-2)",C.currentTarget.style.color="var(--text)"},onMouseLeave:C=>{C.currentTarget.style.background="transparent",C.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)",children:"×"})]}),r.jsx("div",{className:"table-container",children:b.length===0?r.jsx("div",{className:"empty-state",children:"관련활동이 없습니다."}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:200},children:"상위활동"}),r.jsx("th",{style:{width:240},children:"제목"}),r.jsx("th",{style:{width:280},children:"활동설명"}),r.jsx("th",{style:{width:120},children:"활동유형"}),r.jsx("th",{style:{width:120},children:"활동방법"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:180},children:"계획 일시"}),r.jsx("th",{style:{width:180},children:"종료 일시"}),r.jsx("th",{style:{width:180},children:"생성일시"})]})}),r.jsx("tbody",{children:b.map((C,w)=>r.jsxs("tr",{title:A(C),className:C.parentSeq?void 0:"row-parent",children:[r.jsx("td",{children:C.parentSubject||""}),r.jsx("td",{children:C.subject||""}),r.jsx("td",{style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:C.description||""}),r.jsx("td",{children:v(C.activityType,"type")}),r.jsx("td",{children:v(C.channel,"channel")}),r.jsx("td",{children:v(C.activityStatus,"status")}),r.jsx("td",{children:gi(C.plannedStartAt)}),r.jsx("td",{children:gi(C.plannedEndAt)}),r.jsx("td",{children:gi(C.createdAt)})]},`rel-${w}`))})]})})]})})]})}function w3(){const[e,n]=p.useState(null),[i,s]=p.useState("form");p.useEffect(()=>{try{const o=localStorage.getItem("tnt.sales.selectedCustomer");n(o?JSON.parse(o):null)}catch{n(null)}},[]);const a=p.useMemo(()=>e?r.jsx("section",{className:"card compact-form",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"거래처번호"}),r.jsx(fn,{value:e.customerId||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"거래처명"}),r.jsx(fn,{value:e.customerName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"정식명"}),r.jsx(fn,{value:e.customerFullName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"사업자번호"}),r.jsx(fn,{value:e.bizNo||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"대표자명"}),r.jsx(fn,{value:e.ownerName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"고객유형"}),r.jsx(fn,{value:e.customerTypeName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"시/도"}),r.jsx(fn,{value:e.addrProvinceName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"시/군/구"}),r.jsx(fn,{value:e.addrCityName||"",readOnly:!0})]}),r.jsxs("div",{className:"field row-2",children:[r.jsx("label",{children:"비고"}),r.jsx(fn,{value:e.customerRemark||"",readOnly:!0})]})]})}):null,[e]);return r.jsxs("section",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"영업활동"}),r.jsx("div",{className:"muted count-text"})]}),a,r.jsxs("section",{className:"card sales-activity-panel",style:{marginTop:12},children:[r.jsxs("div",{className:"tabs c360-tabs",children:[r.jsx("button",{className:i==="form"?"tab active":"tab",onClick:()=>s("form"),children:"영업활동 등록"}),r.jsx("button",{className:i==="list"?"tab active":"tab",onClick:()=>s("list"),children:"영업활동"})]}),r.jsx("div",{className:"sales-activity-content",children:i==="form"?r.jsx(Ps,{bare:!0}):r.jsx(Pp,{customerSeq:(()=>{try{const o=localStorage.getItem("tnt.sales.selectedCustomer");if(o){const l=JSON.parse(o);return Number(l==null?void 0:l.customerSeq)||0}}catch{}return 0})(),customerId:(()=>{try{const o=localStorage.getItem("tnt.sales.selectedCustomer");if(o){const l=JSON.parse(o);return String((l==null?void 0:l.customerId)||"")}}catch{}return""})(),hideRefresh:!0,enableContextMenu:!0})})]})]})}function L1({customerSeq:e}){const[n,i]=p.useState([]),[s,a]=p.useState(!1),[o,l]=p.useState(null),[c,d]=p.useState([]);async function u(){l(null),a(!0);try{const b=e??(()=>{try{const w=localStorage.getItem("tnt.sales.selectedCustomer");if(w){const _=JSON.parse(w);return Number(_==null?void 0:_.customerSeq)}}catch{}})();if(!b||Number.isNaN(b)){i([]),d([]),a(!1);return}const j=new URL(`/api/v1/customers/${b}/transactions`,window.location.origin),y=await fetch(j.toString());if(!y.ok){let w=`HTTP ${y.status}`;try{const _=await y.json();_!=null&&_.error&&(w=_.error)}catch{}throw new Error(w)}const x=await y.json(),v=Array.isArray(x)?x:[];i(v);let A=[];if(v.length>0){const w=new Map;v.forEach(_=>{const I=_.minorName||"na",O=w.get(I)||{qty:0,amt:0};O.qty+=Number(_.qty??_.qty??0)||0,O.amt+=Number(_.curAmt||0)||0,w.set(I,O)}),A=Array.from(w.entries()).map(([_,I])=>({name:_,qty:I.qty,amt:I.amt})),A.sort((_,I)=>I.qty-_.qty||I.amt-_.amt),d(A)}else d([]);const N=await fetch(`/api/v1/customers/${b}/transactions/summary`);let C=[];if(N.ok)try{const w=await N.json();C=(Array.isArray(w)?w:[]).map(_=>({name:_.minorName||"na",qty:Number(_.qty||0),amt:Number(_.amt||0)}))}catch{C=[]}C.sort((w,_)=>_.qty-w.qty||_.amt-w.amt),C.length>0&&d(C)}catch(b){l(b.message||"조회 중 오류가 발생했습니다")}finally{a(!1)}}p.useEffect(()=>{u()},[e]);const f=p.useMemo(()=>{const b=[...c];return b.sort((j,y)=>y.qty-j.qty||y.amt-j.amt),b},[c]),h=p.useMemo(()=>{const b=[...c];return b.sort((j,y)=>y.amt-j.amt||y.qty-j.qty),b},[c]);function m({data:b,type:j}){const x={top:10,right:10,bottom:60,left:10},v=Math.max(360,b.length*80),A=v-x.left-x.right,N=180-x.top-x.bottom,C=Math.max(1,...b.map(_=>_.value)),w=A/Math.max(1,b.length);return r.jsx("div",{style:{overflowX:"auto"},children:r.jsx("svg",{width:v,height:180,children:r.jsx("g",{transform:`translate(${x.left},${x.top})`,children:b.map((_,I)=>{const O=I*w+w*.15,E=w*.7,S=Math.max(0,_.value/C*N),k=N-S;return r.jsxs("g",{transform:`translate(${O},0)`,children:[r.jsx("rect",{x:0,y:k,width:E,height:S,fill:j==="amt"?"#4e79a7":"#f28e2b"}),r.jsx("text",{x:E/2,y:N+14,fontSize:11,textAnchor:"middle",fill:"var(--muted)",transform:`rotate(25 ${E/2},${N+14})`,children:_.name}),r.jsx("text",{x:E/2,y:k-4,fontSize:11,textAnchor:"middle",fill:"var(--text)",children:_.value.toLocaleString()})]},I)})})})})}const g=p.useMemo(()=>r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:6},children:r.jsxs("div",{className:"muted count-text",children:["총 ",n.length,"건"]})}),n.length>0&&r.jsxs("div",{className:"card",style:{padding:12,marginBottom:8},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[r.jsx("b",{children:"중분류별 금액/수량"}),r.jsx("span",{className:"muted",style:{fontSize:12},children:"가로축: 중분류"})]}),r.jsxs("div",{style:{marginTop:8},children:[r.jsxs("div",{style:{marginBottom:12},children:[r.jsx("div",{className:"muted",style:{marginBottom:4},children:"금액"}),r.jsx(m,{type:"amt",data:h.map(b=>({name:b.name,value:b.amt}))})]}),r.jsxs("div",{children:[r.jsx("div",{className:"muted",style:{marginBottom:4},children:"수량"}),r.jsx(m,{type:"qty",data:f.map(b=>({name:b.name,value:b.qty}))})]})]})]}),r.jsx("div",{className:"table-container",children:n.length===0?r.jsx("div",{className:"empty-state",children:"거래 내역이 없습니다."}):r.jsxs("table",{className:"table transactions",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:160},children:"전표번호"}),r.jsx("th",{style:{width:160},children:"중분류"}),r.jsx("th",{children:"품목명"}),r.jsx("th",{style:{width:100,textAlign:"right"},children:"수량"}),r.jsx("th",{style:{width:160,textAlign:"right"},children:"금액"}),r.jsx("th",{style:{width:140},children:"전표일자"})]})}),r.jsx("tbody",{children:(()=>{let b="",j="",y="";const x=[];return n.forEach((v,A)=>{const N=v.invoiceNo!==b;let C="",w="",_="",I;N?(A>0&&x.push(r.jsx("tr",{className:"sep-row",children:r.jsx("td",{colSpan:6})},`sep-${A}`)),C=v.invoiceNo,w=v.invoiceDate,_=v.minorName||"na",I=void 0,b=v.invoiceNo,j=v.invoiceDate,y=v.minorName):(v.invoiceDate!==j&&(w=v.invoiceDate,j=v.invoiceDate),v.minorName!==y&&(_=v.minorName||"na",y=v.minorName),I="same-invoice"),x.push(r.jsxs("tr",{className:I,children:[r.jsx("td",{className:"col-invno",children:C}),r.jsx("td",{children:_}),r.jsx("td",{children:v.itemName}),r.jsx("td",{style:{textAlign:"right"},children:Number(v.qty??v.qty??0).toLocaleString()}),r.jsx("td",{style:{textAlign:"right"},children:Number(v.curAmt||0).toLocaleString()}),r.jsx("td",{className:"col-invdate",children:w?(()=>{const O=new Date(w);if(isNaN(O.getTime()))return w;const E=String(O.getFullYear()%100).padStart(2,"0"),S=String(O.getMonth()+1).padStart(2,"0"),k=String(O.getDate()).padStart(2,"0"),D=String(O.getHours()).padStart(2,"0"),T=String(O.getMinutes()).padStart(2,"0");return`${E}-${S}-${k} ${D}:${T}`})():""})]},`row-${A}`))}),x})()})]})})]}),[n]);return r.jsxs("div",{children:[r.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:o&&r.jsx("span",{className:"error",children:o})}),g]})}function S3(e){if(e==null)return"";const n=Number(e);return isFinite(n)?`${(n<=1?n*100:n).toLocaleString(void 0,{maximumFractionDigits:2})}%`:""}function W1({customerName:e,refreshTick:n=0}){const[i,s]=p.useState([]),[a,o]=p.useState(!1),[l,c]=p.useState(null);async function d(){if(e!=null&&e.trim()){o(!0),c(null);try{const f=new URLSearchParams({customer:e,limit:"1000"}),h=await fetch(`/api/v1/demand?${f.toString()}`);if(!h.ok){const b=await h.json().catch(()=>({}));throw new Error((b==null?void 0:b.error)||`HTTP ${h.status}`)}const g=(await h.json()||[]).map(b=>({itemSubcategory:b.itemSubcategory??null,supplierName:b.supplierName??null,salesMgmtUnit:b.salesMgmtUnit??null,shareRate:b.shareRate??null}));s(g)}catch(f){c(f.message||"로드 중 오류가 발생했습니다")}finally{o(!1)}}}p.useEffect(()=>{d()},[e,n]);const u=p.useMemo(()=>{const f=new Set,h=new Set,m=new Map;for(const j of i){const y=j.itemSubcategory||"-",x=`${j.supplierName||"-"}|${j.salesMgmtUnit||"-"}`;f.add(y),h.add(x);const v=`${y}::${x}`;m.set(v,j.shareRate)}const g=Array.from(f).sort((j,y)=>j.localeCompare(y)),b=Array.from(h).sort((j,y)=>j.localeCompare(y));return{rows:g,cols:b,cell:m}},[i]);return r.jsxs("section",{children:[a&&r.jsx("div",{className:"muted",style:{marginBottom:8},children:"불러오는 중…"}),l&&r.jsx("div",{className:"error",style:{marginTop:8},children:l}),r.jsx("div",{className:"table-container",style:{marginTop:8,border:"1px solid var(--border)",borderRadius:8},children:r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"separate",borderSpacing:0},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{position:"sticky",left:0,background:"var(--bg)",textAlign:"left",padding:"8px 10px",zIndex:1},children:"중분류"}),u.cols.map(f=>{const[h,m]=f.split("|");return r.jsxs("th",{style:{textAlign:"center",padding:"8px 10px",whiteSpace:"nowrap"},children:[r.jsx("div",{children:h}),r.jsx("div",{className:"muted",style:{fontSize:12},children:m})]},f)})]})}),r.jsx("tbody",{children:u.rows.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:Math.max(1,u.cols.length+1),className:"muted",style:{padding:"12px 10px"},children:a?"불러오는 중…":"데이터가 없습니다"})}):u.rows.map(f=>r.jsxs("tr",{children:[r.jsx("td",{style:{position:"sticky",left:0,background:"var(--bg)",padding:"8px 10px"},children:f}),u.cols.map(h=>{const m=`${f}::${h}`,g=u.cell.get(m)??null;return r.jsx("td",{style:{textAlign:"right",padding:"8px 10px"},children:S3(g)},h)})]},f))})]})})]})}function k3(e){if(e==null)return 0;const n=Number(e);return isFinite(n)?n<=1?n*100:n:0}const bo=["#4e79a7","#f28e2b","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab","#1f77b4","#ff7f0e"];function N3({data:e,size:n=140}){const i=n/2,s=i,a=i,o=e.filter(u=>(u.value||0)>0),l=o.reduce((u,f)=>u+Math.max(0,f.value),0)||1;if(o.length===1)return r.jsx("svg",{width:n,height:n,viewBox:`0 0 ${n} ${n}`,children:r.jsx("circle",{cx:s,cy:a,r:i,fill:bo[0],stroke:"#0b1324",strokeWidth:1})});let c=-Math.PI/2;const d=o.map((u,f)=>{const g=Math.max(0,u.value)/l*Math.PI*2,b=s+i*Math.cos(c),j=a+i*Math.sin(c),y=s+i*Math.cos(c+g),x=a+i*Math.sin(c+g),v=g>Math.PI?1:0,A=`M ${s} ${a} L ${b} ${j} A ${i} ${i} 0 ${v} 1 ${y} ${x} Z`;return c+=g,{path:A,color:bo[f%bo.length],label:u.label,value:u.value}});return r.jsx("svg",{width:n,height:n,viewBox:`0 0 ${n} ${n}`,children:d.map((u,f)=>r.jsx("path",{d:u.path,fill:u.color,stroke:"#0b1324",strokeWidth:1},f))})}function B1({customerName:e,refreshTick:n=0}){const[i,s]=p.useState([]),[a,o]=p.useState(!1),[l,c]=p.useState(null);async function d(){o(!0),c(null);try{const f=new URLSearchParams({customer:e,limit:"1000"}),h=await fetch(`/api/v1/demand?${f.toString()}`);if(!h.ok){const b=await h.json().catch(()=>({}));throw new Error((b==null?void 0:b.error)||`HTTP ${h.status}`)}const g=(await h.json()||[]).map(b=>({itemSubcategory:b.itemSubcategory??null,supplierName:b.supplierName??null,salesMgmtUnit:b.salesMgmtUnit??null,shareRate:b.shareRate??null}));s(g)}catch(f){c(f.message||"로드 중 오류가 발생했습니다")}finally{o(!1)}}p.useEffect(()=>{e&&d()},[e,n]);const u=p.useMemo(()=>{const f=new Map;for(const h of i){const m=h.itemSubcategory||"-",g=`${h.supplierName||"-"} / ${h.salesMgmtUnit||"-"}`,b=k3(h.shareRate);f.has(m)||f.set(m,[]);const j=f.get(m),y=j.find(x=>x.label===g);y?y.value+=b:j.push({label:g,value:b})}for(const[h,m]of f)m.sort((g,b)=>b.value-g.value);return f},[i]);return e?r.jsxs("section",{className:"card",style:{marginTop:12},children:[a&&r.jsx("div",{className:"muted",children:zt.loading}),l&&r.jsx("div",{className:"error",children:l||zt.errorGeneric}),!a&&!l&&r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16},children:[Array.from(u.entries()).map(([f,h])=>r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",border:"1px solid var(--border)",borderRadius:12,padding:12,width:"calc((100% - 16px) / 2)"},children:[r.jsx("div",{style:{flex:"0 0 auto"},children:r.jsx(N3,{data:h})}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6,fontSize:13},children:f}),r.jsxs("div",{style:{fontSize:12},children:[h.slice(0,8).map((m,g)=>r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[r.jsx("span",{style:{width:10,height:10,borderRadius:2,background:bo[g%bo.length],display:"inline-block"}}),r.jsx("span",{style:{minWidth:160},children:m.label}),r.jsxs("span",{style:{color:"var(--muted)"},children:[m.value.toLocaleString(void 0,{maximumFractionDigits:2}),"%"]})]},g)),h.length>8&&r.jsxs("div",{className:"muted",children:["외 ",h.length-8,"개…"]})]})]})]},f)),u.size===0&&r.jsx("div",{className:"empty-state",children:"데이터가 없습니다"})]})]}):null}function F1({customerName:e,customerSeq:n,empSeq:i,empName:s,onSuccess:a}){const[o,l]=p.useState([]),[c,d]=p.useState([]),[u,f]=p.useState([]),[h,m]=p.useState(""),[g,b]=p.useState(""),[j,y]=p.useState(""),[x,v]=p.useState(""),[A,N]=p.useState({subcats:!1,suppliers:!1,units:!1,submit:!1}),[C,w]=p.useState(null),[_,I]=p.useState(null);p.useEffect(()=>{async function S(){N(k=>({...k,subcats:!0})),w(null);try{const k=await fetch("/api/v1/supplier/subcategories");if(!k.ok)throw new Error(`HTTP ${k.status}`);const D=await k.json();l(D||[])}catch(k){w(k.message||"중분류 목록을 불러오지 못했습니다")}finally{N(k=>({...k,subcats:!1}))}}S()},[]),p.useEffect(()=>{if(b(""),d([]),y(""),f([]),!h)return;async function S(){N(k=>({...k,suppliers:!0})),w(null);try{const k=new URLSearchParams({subcategory:h}),D=await fetch(`/api/v1/supplier/names?${k.toString()}`);if(!D.ok)throw new Error(`HTTP ${D.status}`);const T=await D.json();d(T||[])}catch(k){w(k.message||"공급사 목록을 불러오지 못했습니다")}finally{N(k=>({...k,suppliers:!1}))}}S()},[h]),p.useEffect(()=>{if(y(""),f([]),!h||!g)return;async function S(){N(k=>({...k,units:!0})),w(null);try{const k=new URLSearchParams({subcategory:h,supplier:g}),D=await fetch(`/api/v1/supplier/units?${k.toString()}`);if(!D.ok)throw new Error(`HTTP ${D.status}`);const T=await D.json();f(T||[])}catch(k){w(k.message||"영업관리단위를 불러오지 못했습니다")}finally{N(k=>({...k,units:!1}))}}S()},[h,g]);const O=p.useMemo(()=>{if(!x)return"";const S=Number(x);if(!isFinite(S))return"숫자를 입력하세요";const k=S<=1?S*100:S;return zt.hint.sharePreview(k)},[x]);async function E(){if(I(null),w(null),!h||!g||!j){w("중분류/공급사/영업관리단위를 선택하세요");return}const S=Number(x);if(!isFinite(S)||S<=0){w("점유율을 올바르게 입력하세요");return}N(k=>({...k,submit:!0}));try{const k={customerSeq:n,customerName:e||void 0,empSeq:i&&i>0?i:void 0,empName:s||void 0,itemSubcategory:h,supplierName:g,salesMgmtUnit:j,share:S},D=await fetch("/api/v1/demand/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)}),T=await D.json().catch(()=>({}));if(!D.ok)throw new Error((T==null?void 0:T.error)||`HTTP ${D.status}`);I("등록되었습니다"),a&&a()}catch(k){w(k.message||"등록 중 오류가 발생했습니다")}finally{N(k=>({...k,submit:!1}))}}return r.jsxs("section",{style:{marginTop:16},children:[r.jsx("h3",{style:{marginTop:0},children:"수요등록"}),r.jsxs("div",{className:"card",style:{padding:12},children:[r.jsxs("div",{className:"form-grid",style:{gridTemplateColumns:"1fr 1fr 1fr 1fr"},children:[r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"중분류"}),r.jsxs("select",{value:h,onChange:S=>m(S.target.value),children:[r.jsx("option",{value:"",children:"선택하세요"}),o.map(S=>r.jsx("option",{value:S,children:S},S))]}),A.subcats&&r.jsx("div",{className:"muted",style:{marginTop:4},children:"불러오는 중…"})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"공급사"}),r.jsxs("select",{value:g,onChange:S=>b(S.target.value),disabled:!h||A.suppliers,children:[r.jsx("option",{value:"",children:"선택하세요"}),c.map(S=>r.jsx("option",{value:S,children:S},S))]})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"영업관리단위"}),r.jsxs("select",{value:j,onChange:S=>y(S.target.value),disabled:!h||!g||A.units,children:[r.jsx("option",{value:"",children:"선택하세요"}),u.map(S=>r.jsx("option",{value:S,children:S},S))]})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"점유율(%)"}),r.jsx(fn,{value:x,onChange:S=>v(S),placeholder:"예: 0.25 또는 25"}),O&&r.jsx("div",{className:"muted",style:{marginTop:4},children:O})]})]}),C&&r.jsx("div",{className:"error",style:{marginTop:8},children:C||zt.errorGeneric}),_&&r.jsx("div",{className:"muted",style:{marginTop:8},children:_}),r.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:r.jsx("button",{className:"btn",onClick:E,disabled:A.submit,children:A.submit?zt.fetching:e?`${e}에 ${zt.action.register}`:zt.action.register})})]})]})}const q1=[{value:"Credit / Receivable",label:"신용·채권"},{value:"Pricing / Terms",label:"가격·조건"},{value:"Quality / Claim",label:"품질·클레임"},{value:"Logistics / Delivery",label:"물류·납기"},{value:"Contract / Legal",label:"계약·법무"},{value:"Relationship / Strategic",label:"관계·전략"},{value:"Operational",label:"운영 이슈"},{value:"기타",label:"기타"}],_3=e=>{if(!e)return"미정";const n=q1.find(i=>i.value===e);return(n==null?void 0:n.label)??e},ox={noteTitle:"",noteContent:"",noteType:"",importanceLevel:1},C3=e=>{try{const n=new Date(e),i=String(n.getFullYear()).slice(-2),s=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0");return`${i}-${s}-${a} ${o}:${l}`}catch{return e}},lx=e=>e==null?"중요도 미정":["하","중","상"][Math.min(Math.max(e,0),2)];function A3({customerSeq:e,customerId:n,empName:i}){const[s,a]=p.useState([]),[o,l]=p.useState(!1),[c,d]=p.useState(null),[u,f]=p.useState(0),[h,m]=p.useState(!1),[g,b]=p.useState(!1),[j,y]=p.useState(null),[x,v]=p.useState(()=>({...ox})),[A,N]=p.useState(null),C=p.useMemo(()=>typeof window>"u"?"":localStorage.getItem("tnt.sales.assigneeId")??"",[]),[w,_]=p.useState(null),[I,O]=p.useState(null),[E,S]=p.useState(!1);p.useEffect(()=>{if(!n){d("고객 ID가 없어 특이사항을 불러올 수 없습니다."),a([]);return}let H=!1;async function q(){l(!0),d(null);try{const M=await fetch(`/api/v1/customers/${n}/special-notes`);if(!M.ok)throw new Error(`HTTP ${M.status}`);const L=await M.json();if(H)return;const B=Array.isArray(L)?L:[];B.sort((F,te)=>new Date(te.updatedAt??te.createdAt).getTime()-new Date(F.updatedAt??F.createdAt).getTime()),a(B)}catch(M){if(H)return;d(M.message||"특이사항을 불러오지 못했습니다."),a([])}finally{H||l(!1)}}return q(),()=>{H=!0}},[n,u]);const k=async H=>{if(H.preventDefault(),!n)return;b(!0),y(null);const q=A!=null,M=C||"system";try{const L={customerId:n,customerSeq:e,noteTitle:x.noteTitle.trim()||"특이사항",noteContent:x.noteContent.trim(),noteType:x.noteType||void 0,importanceLevel:x.importanceLevel},B=q?`/api/v1/customers/${n}/special-notes/${A.id}`:`/api/v1/customers/${n}/special-notes`,F=q?"PUT":"POST";q||(L.createdBy=M),L.updatedBy=M;const te=await fetch(B,{method:F,headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(!te.ok){const $=await te.json().catch(()=>null);throw new Error(($==null?void 0:$.error)||`HTTP ${te.status}`)}T(),f($=>$+1)}catch(L){y(L.message||(q?"수정 중 오류가 발생했습니다.":"등록 중 오류가 발생했습니다."))}finally{b(!1)}};p.useEffect(()=>{if(!h)return;const H=q=>{q.key==="Escape"&&T()};return window.addEventListener("keydown",H),()=>window.removeEventListener("keydown",H)},[h]);const D=()=>v({...ox}),T=()=>{m(!1),N(null),D(),y(null)},P=H=>{N(H??null),v({noteTitle:(H==null?void 0:H.noteTitle)??"",noteContent:(H==null?void 0:H.noteContent)??"",noteType:(H==null?void 0:H.noteType)??"",importanceLevel:(H==null?void 0:H.importanceLevel)??1}),y(null),m(!0)},R=H=>{_(H)},Y=async()=>{if(!n||!w)return;const H=w;y(null),S(!0);try{const q=C||"system",M=await fetch(`/api/v1/customers/${n}/special-notes/${H.id}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({updatedBy:q})});if(!M.ok){const L=await M.json().catch(()=>null);throw new Error((L==null?void 0:L.error)||`HTTP ${M.status}`)}O("특이사항을 삭제했습니다."),a(L=>L.filter(B=>B.id!==H.id)),f(L=>L+1)}catch(q){y(q.message||"삭제 중 오류가 발생했습니다.")}finally{S(!1),_(null)}};p.useEffect(()=>{if(!I)return;const H=window.setTimeout(()=>O(null),4e3);return()=>window.clearTimeout(H)},[I]);const X=H=>H==null?"unknown":H>=2?"high":H===1?"medium":"low";return r.jsxs("div",{className:"special-notes",children:[r.jsx("header",{className:"special-notes-header",children:r.jsx("button",{className:"btn btn-card btn-3d",type:"button",onClick:()=>P(),children:"신규"})}),c?r.jsx("div",{className:"empty-state",children:c}):o?r.jsx("div",{className:"empty-state",children:"특이사항을 불러오는 중입니다…"}):s.length===0?r.jsx("div",{className:"empty-state",children:"등록된 특이사항이 없습니다."}):r.jsx("div",{className:"special-notes-list",children:s.map(H=>r.jsxs("article",{className:"special-note-card",children:[r.jsxs("div",{className:"note-actions",children:[r.jsx("button",{type:"button",className:"note-edit-button","aria-label":"특이사항 수정",onClick:()=>P(H),children:"✎"}),r.jsx("button",{type:"button",className:"note-delete-button","aria-label":"특이사항 삭제",onClick:()=>R(H),children:"🗑"})]}),r.jsxs("div",{className:"note-top",children:[r.jsx("span",{className:`importance-dot level-${X(H.importanceLevel)}`,"aria-label":`중요도 ${lx(H.importanceLevel)}`,children:lx(H.importanceLevel)}),r.jsxs("div",{className:"note-meta-info",children:[r.jsx("span",{className:"note-type",children:_3(H.noteType)}),r.jsx("strong",{className:"note-date",children:C3(H.updatedAt??H.createdAt)})]})]}),r.jsx("strong",{className:"note-title",children:H.noteTitle||"특이사항"}),r.jsx("p",{className:"note-content",children:H.noteContent}),r.jsxs("div",{className:"special-note-meta",children:[r.jsxs("span",{className:"meta-pill",children:[r.jsx("span",{className:"meta-icon edit-icon","aria-hidden":"true",children:"✎"}),r.jsx("span",{children:"수정자"}),r.jsx("strong",{children:H.updatedByName||H.updatedBy||"-"})]}),r.jsxs("span",{className:"meta-pill",children:[r.jsx("span",{className:"meta-icon user-icon","aria-hidden":"true",children:"👤"}),r.jsx("span",{children:"등록자"}),r.jsx("strong",{children:H.createdByName||H.createdBy})]})]})]},H.id))}),h&&r.jsx("div",{className:"overlay-modal",role:"dialog","aria-modal":"true",children:r.jsxs("div",{className:"overlay-card",children:[r.jsx("button",{type:"button",className:"modal-close","aria-label":"닫기",onClick:T,children:"×"}),r.jsx("h4",{children:"특이사항 등록"}),r.jsxs("form",{className:"special-note-form",onSubmit:k,children:[r.jsxs("label",{children:[r.jsx("span",{children:"제목"}),r.jsx("input",{type:"text",value:x.noteTitle,onChange:H=>v(q=>({...q,noteTitle:H.target.value})),placeholder:"예: 신용이슈",required:!0})]}),r.jsxs("label",{children:[r.jsx("span",{children:"유형"}),r.jsxs("select",{value:x.noteType,onChange:H=>v(q=>({...q,noteType:H.target.value})),children:[r.jsx("option",{value:"",children:"선택 안 함"}),q1.map(H=>r.jsx("option",{value:H.value,children:H.label},H.value))]})]}),r.jsxs("label",{children:[r.jsx("span",{children:"중요도"}),r.jsxs("select",{value:x.importanceLevel,onChange:H=>v(q=>({...q,importanceLevel:Number(H.target.value)})),children:[r.jsx("option",{value:2,children:"상"}),r.jsx("option",{value:1,children:"중"}),r.jsx("option",{value:0,children:"하"})]})]}),r.jsxs("label",{children:[r.jsx("span",{children:"내용"}),r.jsx("textarea",{value:x.noteContent,onChange:H=>v(q=>({...q,noteContent:H.target.value})),rows:4,required:!0})]}),j?r.jsx("div",{className:"empty-state",children:j}):null,r.jsxs("footer",{children:[r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>m(!1),disabled:g,children:"취소"}),r.jsx("button",{type:"submit",className:"btn btn-card btn-3d",disabled:g,children:g?"등록 중…":"등록"})]})]})]})}),I&&r.jsxs("div",{className:"toast-message",children:[r.jsx("span",{children:I}),r.jsx("button",{type:"button",onClick:()=>O(null),children:"×"})]}),w&&r.jsx("div",{className:"confirm-overlay",role:"dialog","aria-modal":"true",children:r.jsxs("div",{className:"confirm-card",children:[r.jsxs("p",{children:[r.jsx("strong",{children:w.noteTitle||"특이사항"}),"을(를) 삭제하시겠습니까?",r.jsx("br",{}),"삭제하면 되돌릴 수 없습니다."]}),r.jsxs("div",{className:"confirm-actions",children:[r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>_(null),disabled:E,children:"취소"}),r.jsx("button",{type:"button",className:"btn btn-card btn-3d",onClick:Y,disabled:E,children:E?"삭제 중…":"삭제"})]})]})})]})}function I3(){const[e,n]=p.useState(()=>{try{const f=localStorage.getItem("tnt.sales.selectedCustomer");return f?JSON.parse(f):null}catch{return null}}),[i,s]=p.useState("transactions"),[a,o]=p.useState(0),[l,c]=p.useState(null);p.useEffect(()=>{try{const f=localStorage.getItem("tnt.sales.selectedCustomer");n(f?JSON.parse(f):null)}catch{n(null)}},[]),p.useEffect(()=>{const f=()=>{try{const h=localStorage.getItem("tnt.sales.selectedCustomer");n(h?JSON.parse(h):null)}catch{n(null)}};return window.addEventListener("tnt.sales.customer.selected",f),()=>window.removeEventListener("tnt.sales.customer.selected",f)},[]),p.useEffect(()=>{const f=h=>{var j;const m=((j=h==null?void 0:h.detail)==null?void 0:j.customer)||e,g=(m==null?void 0:m.customerId)??(m==null?void 0:m.customer_id),b=(m==null?void 0:m.customerName)??(m==null?void 0:m.customer_name);c({sfAccountId:g?String(g):void 0,customerName:b})};return window.addEventListener("tnt.sales.activity.create.inline",f),()=>window.removeEventListener("tnt.sales.activity.create.inline",f)},[e]),p.useEffect(()=>{if(!l)return;const f=h=>{h.key==="Escape"&&(h.preventDefault(),h.stopPropagation(),c(null))};return window.addEventListener("keydown",f,!0),()=>window.removeEventListener("keydown",f,!0)},[l]);const d=p.useMemo(()=>r.jsx(Ep,{compact:!0,maxHeight:"32vh",context:"c360"}),[]),u=()=>!e||e.customerSeq==null?r.jsx("div",{className:"empty-state",children:"거래처를 선택하세요."}):i==="transactions"?r.jsx(L1,{customerSeq:e.customerSeq}):i==="activities"?r.jsx(Pp,{customerSeq:e.customerSeq,customerId:e.customerId||"",hideRefresh:!0,enableContextMenu:!0}):i==="demand"?e.customerName?r.jsxs("div",{className:"c360-demand-stack",children:[r.jsx(W1,{customerName:e.customerName,refreshTick:a}),r.jsx(B1,{customerName:e.customerName,refreshTick:a}),r.jsx(F1,{customerName:e.customerName,customerSeq:e.customerSeq,empSeq:e.empSeq,empName:e.empName||void 0,onSuccess:()=>o(f=>f+1)})]}):r.jsx("div",{className:"empty-state",children:"수요정보를 보려면 거래처명을 확인하세요."}):i==="special-notes"?r.jsx(A3,{customerSeq:e.customerSeq,customerId:e.customerId,empName:e.empName}):i==="complaint"?r.jsx("div",{className:"card",style:{padding:12},children:r.jsx("div",{className:"muted",children:"Complaint 기능은 추후 제공될 예정입니다."})}):null;return r.jsxs("section",{className:"c360",children:[d,r.jsxs("section",{className:"card c360-panel",style:{marginTop:12,minHeight:240},children:[r.jsxs("div",{className:"tabs c360-tabs",children:[r.jsx("button",{className:i==="transactions"?"tab active":"tab",onClick:()=>s("transactions"),children:"거래 내역"}),r.jsx("button",{className:i==="activities"?"tab active":"tab",onClick:()=>s("activities"),children:"영업활동"}),r.jsx("button",{className:i==="demand"?"tab active":"tab",onClick:()=>s("demand"),children:"수요정보"}),r.jsx("button",{className:i==="special-notes"?"tab active":"tab",onClick:()=>s("special-notes"),children:"특이사항"}),r.jsx("button",{className:i==="complaint"?"tab active":"tab",onClick:()=>s("complaint"),children:"Complaint"})]}),r.jsx("div",{className:`c360-tab-panel-wrapper ${i==="demand"?"c360-demand-scroll":""}`,children:r.jsx("div",{className:"c360-tab-panel",children:u()})})]}),l&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",zIndex:120,display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>c(null),children:r.jsxs("div",{className:"card",style:{width:"min(920px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:f=>f.stopPropagation(),children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[r.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"영업활동 등록"}),r.jsx("button",{onClick:()=>c(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:f=>{f.currentTarget.style.background="var(--panel-2)",f.currentTarget.style.color="var(--text)"},onMouseLeave:f=>{f.currentTarget.style.background="transparent",f.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)","aria-label":"닫기",children:"×"})]}),r.jsx(Ps,{bare:!0,initial:l,onSaved:()=>{c(null);try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated"))}catch{}},onNoticeClose:()=>c(null)})]})})]})}function U1({open:e,onClose:n,leadId:i,leadName:s,targetKind:a,targetCompanyType:o,editId:l,initial:c,onSaved:d}){const{ref:u,style:f,bindHeader:h,bindContainer:m}=tr("lead.activity",e,C=>{const w=document.querySelector(".pane.center"),_=w?w.getBoundingClientRect():null,I=C.getBoundingClientRect(),O=I.width,E=I.height,S=_?_.left+(_.width-O)/2:(window.innerWidth-O)/2,k=_?_.top+Math.max(24,(_.height-E)*.2):Math.max(24,(window.innerHeight-E)*.2);return{x:S,y:k}},{persist:!1,resetOnOpen:!0});p.useEffect(()=>{if(!e)return;const C=w=>{w.key==="Escape"&&n()};return window.addEventListener("keydown",C,!0),()=>window.removeEventListener("keydown",C,!0)},[e,n]);const g=p.useCallback(()=>{l||n()},[l,n]),b=a||(i?"lead":void 0),j=(()=>{const C=(s??"").toString().trim();return C||((c==null?void 0:c.customerName)??"").toString().trim()})(),y=(o??"").toString().trim().toUpperCase(),x=b==="lead"?"잠":y.includes("TNT")?"T":y.includes("DYS")?"D":y?y.slice(0,1):"거",v=b==="lead"?"잠재고객":y||"거래처",A=b?r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:22,height:22,borderRadius:"50%",fontSize:12,fontWeight:700,background:b==="lead"?"rgba(236,72,153,.2)":"rgba(59,130,246,.2)",color:b==="lead"?"#be185d":"#1d4ed8"},title:v,children:x}):null,N=l?"영업활동":"영업활동 등록";return e?r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:11e3,pointerEvents:"none"},children:[r.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)",pointerEvents:"none"}}),r.jsxs("div",{ref:u,className:"card",style:{...f,width:"min(880px, 96vw)",maxHeight:"86vh",overflow:"auto",padding:16,pointerEvents:"auto"},...m,children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6,cursor:"move"},...h,children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[r.jsx("h3",{style:{margin:0},children:N}),j||A?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13,fontWeight:600,color:"var(--text)"},children:[j?r.jsx("span",{children:j}):null,A]}):null]}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:n,children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})})]}),r.jsx(Ps,{bare:!0,editId:l??void 0,leadId:i??void 0,initial:c,onNoticeClose:g,onSaved:C=>{d?d():n()}})]})]}):null}function Za(e){if(!e)return"";const n=new Date(e);if(isNaN(n.getTime()))return"";const i=n.getFullYear(),s=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0");return`${i}-${s}-${a}`}function Tl(e,n=0){if(!e)return;const i=e.trim();if(!i)return;const[s,a,o]=i.split("-").map(c=>Number(c));if(!s||!a||!o)return;const l=new Date(s,a-1,o,n,0,0,0);if(!isNaN(l.getTime()))return l.toISOString()}function cx(e){if(e.type==="customer"){const n=(e.companyType??"").toString().trim(),i=n||"거래처",s=n.toUpperCase(),a=s.includes("TNT")?"T":s.includes("DYS")?"D":(s||"거")[0];return{label:i,bg:"rgba(59,130,246,.12)",color:"#1d4ed8",icon:a,iconBg:"#1d4ed8"}}return{label:"잠재",bg:"rgba(236,72,153,.12)",color:"#be185d",icon:"잠",iconBg:"#be185d"}}function T3({onClose:e,prefillAt:n}){const[i,s]=Be.useState(""),[a,o]=Be.useState([]),[l,c]=Be.useState(!1),[d,u]=Be.useState(null),[f,h]=Be.useState([]),[m,g]=Be.useState(null);async function b(){c(!0),u(null);try{const v=new URL("/api/v1/customers",window.location.origin);v.searchParams.set("mineOnly","false"),i.trim()&&v.searchParams.set("name",i.trim()),v.searchParams.set("limit","100");try{console.debug("[customer search]",v.toString())}catch{}const A=await fetch(v.toString());if(!A.ok)throw new Error(`HTTP ${A.status}`);const N=await A.json(),C=Array.isArray(N)?N.map(w=>({customerSeq:(w==null?void 0:w.customerSeq)??(w==null?void 0:w.customer_seq)??null,customerId:(w==null?void 0:w.customerId)??(w==null?void 0:w.customer_id)??null,customerName:(w==null?void 0:w.customerName)??(w==null?void 0:w.customer_name)??null,ownerName:(w==null?void 0:w.ownerName)??(w==null?void 0:w.owner_name)??null,companyType:(w==null?void 0:w.companyType)??(w==null?void 0:w.company_type)??null})).sort((w,_)=>String(w.customerName||"").localeCompare(String(_.customerName||""),"ko-KR")):[];o(C)}catch(v){u((v==null?void 0:v.message)||"조회 실패"),o([])}finally{c(!1)}}function j(v){h(A=>{const C=A.some(w=>(w.customerId||"")===(v.customerId||""))?A:[v,...A];return!m&&C.length>0&&x(C[0]),C})}function y(v){if(h(A=>A.filter(N=>(N.customerId||"")!==(v.customerId||""))),m&&(m.customerId||"")===(v.customerId||"")){const A=f.filter(N=>(N.customerId||"")!==(v.customerId||""));x(A[0]||null)}}function x(v){g(v||null);try{v&&localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify({customerId:v.customerId||"",customerName:v.customerName||""}))}catch{}}return Be.useEffect(()=>{const v=A=>{A.key==="Escape"&&e()};return window.addEventListener("keydown",v,!0),()=>window.removeEventListener("keydown",v,!0)},[e]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:12e3},children:[r.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"6%",left:"50%",transform:"translateX(-50%)",width:"min(1200px,96vw)",maxHeight:"88vh",overflow:"auto",padding:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"거래처 활동계획수립"}),r.jsx("button",{className:"btn-plain","aria-label":"닫기",title:"닫기",onClick:e,style:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:12,minHeight:520,alignItems:"start"},children:[r.jsxs("div",{className:"card",style:{padding:12,overflow:"auto"},children:[r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"거래처명",value:i,onChange:v=>s(v.target.value),onKeyDown:v=>{v.key==="Enter"&&b()},style:{flex:"0 0 220px",height:28,fontSize:12}}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button",title:"조회","aria-label":"조회",onClick:b,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("path",{d:"m21 21-4.35-4.35"})]})})]}),r.jsx("div",{className:"table-container",style:{maxHeight:240,overflowY:"auto",overflowX:"hidden",fontSize:12},children:a.length===0?r.jsx("div",{className:"empty-state",children:l?"불러오는 중…":d||"검색 결과가 없습니다"}):r.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:100},children:"회사구분"}),r.jsx("th",{style:{width:180},children:"거래처명"}),r.jsx("th",{style:{width:120},children:"대표자명"}),r.jsx("th",{style:{width:48}})]})}),r.jsx("tbody",{children:a.map((v,A)=>r.jsxs("tr",{children:[r.jsx("td",{title:v.companyType||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:v.companyType||""}),r.jsx("td",{title:v.customerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:v.customerName||""}),r.jsx("td",{title:v.ownerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:v.ownerName||""}),r.jsx("td",{style:{textAlign:"center"},children:r.jsx("span",{role:"button",tabIndex:0,className:"icon-button",title:"계획수립대상 담기","aria-label":"계획수립대상 담기",onClick:()=>j(v),children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:[r.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})})]},A))})]})}),r.jsxs("div",{style:{marginTop:12,fontWeight:700},children:["계획수립대상(",f.length,")"]}),r.jsx("div",{className:"table-container",style:{maxHeight:220,overflowY:"auto",overflowX:"hidden",fontSize:12},children:f.length===0?r.jsx("div",{className:"empty-state",children:"담긴 거래처가 없습니다."}):r.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:100},children:"회사구분"}),r.jsx("th",{style:{width:180},children:"거래처명"}),r.jsx("th",{style:{width:120},children:"대표자명"}),r.jsx("th",{style:{width:60},children:"작업"})]})}),r.jsx("tbody",{children:f.map((v,A)=>r.jsxs("tr",{className:m&&(m.customerId||"")===(v.customerId||"")?"selected":"",onClick:()=>x(v),children:[r.jsx("td",{title:v.companyType||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:v.companyType||""}),r.jsx("td",{title:v.customerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:v.customerName||""}),r.jsx("td",{title:v.ownerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:v.ownerName||""}),r.jsx("td",{style:{textAlign:"center"},children:r.jsx("span",{role:"button",tabIndex:0,className:"icon-button",title:"삭제","aria-label":"삭제",onClick:N=>{N.stopPropagation(),y(v)},children:r.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:r.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})})})]},A))})]})})]}),r.jsxs("div",{className:"card plan-compact-card",style:{overflow:"auto"},children:[!m&&r.jsx("div",{className:"empty-state",children:"좌측에서 거래처를 선택해 주세요."}),r.jsx(Ps,{bare:!0,initial:{plannedStartAt:n||void 0,...m?{sfAccountId:m.customerId||"",customerName:m.customerName||"",subject:m!=null&&m.customerName?`${m.customerName} (활동계획) 으로 저장됩니다.`:""}:{}},lockSubject:!0,planMode:!0,multiTargets:f})]})]})]})]})}function E3(e){const n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),i=n.getDay()||7;return i!==1&&n.setDate(n.getDate()-(i-1)),n.setHours(0,0,0,0),n}function P3(e){const n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),i=n.getUTCDay()||7;n.setUTCDate(n.getUTCDate()+4-i);const s=new Date(Date.UTC(n.getUTCFullYear(),0,1)),a=Math.ceil(((n.getTime()-s.getTime())/864e5+1)/7);return{year:n.getUTCFullYear(),week:a}}function O3(e){const n=e.getFullYear(),i=e.getMonth()+1;return`${n}년 ${i}월`}function D3(e){return String(e.getDate())}const z3=Array.from({length:24},(e,n)=>n),Js=60,dx=18,Vu=18;function M3(){const[e,n]=Be.useState(()=>new Date),i=Be.useMemo(()=>P3(e),[e]),s=Be.useMemo(()=>E3(e),[e]),a=Be.useMemo(()=>{const me=new Date(s);return me.setDate(s.getDate()+6),me.setHours(23,59,59,999),me},[s]),o=Be.useMemo(()=>Array.from({length:7}).map((me,ze)=>{const Oe=new Date(s);return Oe.setDate(s.getDate()+ze),Oe}),[s]),l=Be.useRef(null),[c,d]=Be.useState(()=>({open:!1,x:0,y:0})),u=Be.useRef(null),[f,h]=Be.useState(!1),[m,g]=Be.useState(!1),[b,j]=Be.useState([]),[y,x]=Be.useState(""),[v,A]=Be.useState([]),[N,C]=Be.useState(""),[w,_]=Be.useState(""),[I,O]=Be.useState(""),[E,S]=Be.useState(""),[k,D]=Be.useState(""),[T,P]=Be.useState(""),[R,Y]=Be.useState(""),[X,H]=Be.useState(!1),[q,M]=Be.useState(null),[L,B]=Be.useState(null),[F,te]=Be.useState(null),[$,W]=Be.useState(""),[U,Z]=Be.useState([]),[ee,K]=Be.useState(!1),[ne,pe]=Be.useState(null),[G,ae]=Be.useState([]),[ie,J]=Be.useState(null),[re,de]=Be.useState([]),[he,oe]=Be.useState([]),[V,Pe]=Be.useState(null),[Ve,tt]=Be.useState(null),[ot,ht]=Be.useState(""),[vt,Se]=Be.useState(null),[je,Te]=Be.useState(""),[Le,ke]=Be.useState(void 0),[Ue,st]=Be.useState(!1),Ee=Be.useRef(null),dt=Be.useMemo(()=>{const me=new Array(24).fill(0).map(()=>Js);if(!re||re.length===0)return me;const ze=new Array(24).fill(0),Oe=new Date(s.getFullYear(),s.getMonth(),s.getDate());for(let Ze=0;Ze<24;Ze++){let Ne=0;for(let Xe=0;Xe<7;Xe++){const $e=new Date(Oe);$e.setDate($e.getDate()+Xe);const ct=$e.getFullYear(),ut=$e.getMonth(),yt=$e.getDate(),ft=re.reduce((nn,Et)=>{if(!Et.plannedStartAt)return nn;const At=new Date(Et.plannedStartAt);return At.getFullYear()===ct&&At.getMonth()===ut&&At.getDate()===yt&&At.getHours()===Ze?nn+1:nn},0);ft>Ne&&(Ne=ft)}ze[Ze]=Ne}for(let Ze=0;Ze<24;Ze++){const Ne=Math.max(0,ze[Ze]-1);me[Ze]=Math.min(Js+Ne*Vu,Js+64)}return me},[re,s]),gt=Be.useMemo(()=>{const me=[0];for(let ze=0;ze<24;ze++)me[ze+1]=me[ze]+(dt[ze]||Js);return me},[dt]),Nt=Be.useCallback(async()=>{try{const me=localStorage.getItem("tnt.sales.assigneeId")||"",ze=localStorage.getItem("tnt.sales.empId")||"",Oe=new URL("/api/v1/sales-activities",window.location.origin);me?Oe.searchParams.set("assigneeId",me):ze&&Oe.searchParams.set("empId",ze),Oe.searchParams.set("mineOnly","true"),Oe.searchParams.set("start",s.toISOString()),Oe.searchParams.set("end",a.toISOString()),Oe.searchParams.set("_t",Date.now().toString());const Ze=await fetch(Oe.toString(),{cache:"no-cache"});if(!Ze.ok)throw new Error(`HTTP ${Ze.status}`);const Ne=await Ze.json(),Xe=Array.isArray(Ne)?Ne:[];de(Xe.map($e=>{const ct=$e.plannedStartAt||$e.planned_start_at,ut=($e.activityStatus||$e.activity_status||"").toString().toLowerCase(),yt=ut==="completed"||ut==="완료";return{id:Number($e.id),subject:$e.subject,description:$e.description,activityType:$e.activityType||$e.activity_type,activityStatus:$e.activityStatus||$e.activity_status,channel:$e.channel,plannedStartAt:ct?new Date(ct).toISOString():void 0,plannedEndAt:$e.plannedEndAt||$e.planned_end_at||null,actualStartAt:$e.actualStartAt||$e.actual_start_at||void 0,sfAccountId:$e.sfAccountId||$e.sf_account_id||void 0,customerName:$e.customerName||$e.customer_name||"",leadId:$e.sfLeadId||$e.sf_lead_id||null,companyType:$e.companyType||$e.company_type||$e.companyTypeName||$e.company_type_name||null,isCompleted:yt}}))}catch{de([])}},[s,a]),St=Be.useCallback(async()=>{try{const me=localStorage.getItem("tnt.sales.assigneeId")||localStorage.getItem("tnt.sales.empId")||"";if(!me){oe([]);return}const ze=new URL("/api/v1/region-activity-plans",window.location.origin);ze.searchParams.set("assigneeId",me),ze.searchParams.set("start",s.toISOString()),ze.searchParams.set("end",a.toISOString());const Oe=await fetch(ze.toString());if(!Oe.ok)throw new Error(`HTTP ${Oe.status}`);const Ze=await Oe.json(),Ne=Array.isArray(Ze)?Ze:[];oe(Ne.map(Xe=>({id:Number(Xe.id),subject:Xe.subject,plannedStartAt:Xe.planned_start_at||Xe.plannedStartAt||null,plannedEndAt:Xe.planned_end_at||Xe.plannedEndAt||null,actualStartAt:Xe.actual_start_at||Xe.actualStartAt||null,actualEndAt:Xe.actual_end_at||Xe.actualEndAt||null,isCompleted:!!(Xe.actual_start_at||Xe.actualStartAt||Xe.actual_end_at||Xe.actualEndAt)})))}catch{oe([])}},[s,a]);Be.useEffect(()=>{Nt()},[Nt]),Be.useEffect(()=>{St()},[St]),Be.useEffect(()=>{const me=()=>{try{Nt()}catch{}};return window.addEventListener("tnt.sales.activity.updated",me),()=>window.removeEventListener("tnt.sales.activity.updated",me)},[Nt]);const yn=`${i.week}주차`,Kr=O3(e),Ot=Be.useCallback(()=>{n(me=>{const ze=new Date(me);return ze.setDate(ze.getDate()-7),ze})},[]),En=Be.useCallback(()=>{n(me=>{const ze=new Date(me);return ze.setDate(ze.getDate()+7),ze})},[]),Gr=Be.useCallback(()=>{n(new Date)},[]);Be.useEffect(()=>{function me(Oe){let Ze=Oe;for(;Ze;){const Ne=(Ze.tagName||"").toLowerCase();if(["input","textarea","select","button","label","a"].includes(Ne)||Ze!=null&&Ze.isContentEditable)return!0;Ze=Ze.parentElement}return!1}function ze(Oe){const Ze=Oe.target;me(Ze)||me(document.activeElement)||(Oe.key==="ArrowLeft"?(Oe.preventDefault(),Ot()):Oe.key==="ArrowRight"&&(Oe.preventDefault(),En()))}return window.addEventListener("keydown",ze,!0),()=>window.removeEventListener("keydown",ze,!0)},[Ot,En]);const Yt=Be.useRef(!1);Be.useEffect(()=>{if(Yt.current)return;const me=l.current;if(!me)return;const ze=gt[7]||7*Js;let Oe=0;const Ze=30,Ne=()=>{if(me){if(me.scrollTop=ze,Oe+=1,Math.abs(me.scrollTop-ze)<2||Oe>=Ze){Yt.current=!0;return}setTimeout(()=>requestAnimationFrame(Ne),50)}};requestAnimationFrame(Ne)},[gt]),Be.useEffect(()=>{if(!c.open)return;const me=Oe=>{const Ze=(Oe==null?void 0:Oe.target)||null;u.current&&Ze&&u.current.contains(Ze)||d({open:!1,x:0,y:0})},ze=Oe=>{Oe.key==="Escape"&&me()};return window.addEventListener("click",me,!0),window.addEventListener("contextmenu",me,!0),window.addEventListener("keydown",ze,!0),()=>{window.removeEventListener("click",me,!0),window.removeEventListener("contextmenu",me,!0),window.removeEventListener("keydown",ze,!0)}},[c.open]);const vr=Be.useCallback(async()=>{try{const me=await fetch("/api/v1/address/provinces"),ze=me.ok?await me.json():[],Oe=Array.isArray(ze)?ze.filter(Boolean):[];j(Oe)}catch{j([])}},[]),zn=Be.useCallback(async me=>{try{if(!me){A([]);return}const ze=new URL("/api/v1/address/districts",window.location.origin);ze.searchParams.set("province",me);const Oe=await fetch(ze.toString()),Ze=Oe.ok?await Oe.json():[],Ne=Array.isArray(Ze)?Ze.filter(Boolean):[];A(Ne)}catch{A([])}},[]),Zn=Be.useCallback(()=>{_(""),O(""),S(""),D(""),P(""),Y(""),M(null),ae([]),te(null)},[]),ue=Be.useCallback(()=>{Zn();const me=ie?Za(ie):"";S(me),x(""),C(""),A([]),g(!0),vr()},[ie,vr,Zn]),De=Be.useCallback(()=>{Zn(),B(null),g(!1)},[Zn]);Be.useEffect(()=>{if(!m)return;const me=ze=>{ze.key==="Escape"&&(ze.preventDefault(),De())};return window.addEventListener("keydown",me,!0),()=>window.removeEventListener("keydown",me,!0)},[m,De]);const Ke=Be.useCallback(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||localStorage.getItem("tnt.sales.empId")||""}catch{return""}},[]);Be.useEffect(()=>{if(!m||w&&w.trim().length>0||!y)return;const me=N?`${y} ${N}`:y;_(`${me} 지역활동`)},[m,w,y,N]);async function lt(me){try{const ze=await fetch(`/api/v1/region-activity-plans/${me}`);if(!ze.ok)throw new Error(`HTTP ${ze.status}`);const Oe=await ze.json();Zn(),te(me),_((Oe==null?void 0:Oe.subject)||""),O((Oe==null?void 0:Oe.description)||"");const Ze=(Oe==null?void 0:Oe.addrProvinceName)||(Oe==null?void 0:Oe.addr_province_name)||"",Ne=(Oe==null?void 0:Oe.addrDistrictName)||(Oe==null?void 0:Oe.addr_district_name)||"";await vr(),x(Ze),Ze?await zn(Ze):A([]),C(Ne),S(Oe!=null&&Oe.planned_start_at?Za(Oe.planned_start_at):""),D(Oe!=null&&Oe.planned_end_at?Za(Oe.planned_end_at):""),P(Oe!=null&&Oe.actual_start_at?Za(Oe.actual_start_at):""),Y(Oe!=null&&Oe.actual_end_at?Za(Oe.actual_end_at):"");const Xe=Array.isArray(Oe==null?void 0:Oe.targets)?Oe.targets:[];ae(Xe.map(($e,ct)=>{const ut=($e==null?void 0:$e.customerId)||($e==null?void 0:$e.customer_id)||"",yt=($e==null?void 0:$e.leadId)||($e==null?void 0:$e.lead_id)||"",ft=ut?"customer":"lead";return{key:ut?`customer-${ut}`:yt?`lead-${yt}`:`target-${ct}-${me}`,type:ft,name:($e==null?void 0:$e.displayName)||($e==null?void 0:$e.display_name)||ut||yt||"(대상)",companyType:($e==null?void 0:$e.companyType)||($e==null?void 0:$e.company_type)||null,customerId:ut||void 0,leadId:yt||void 0}})),g(!0)}catch(ze){window.alert((ze==null?void 0:ze.message)||"지역활동 계획을 불러오지 못했습니다.")}}async function pt(){const me=w.trim();if(!me){M("제목을 입력해 주세요."),B(null);return}if(!y){M("방문 도(Province)를 선택해 주세요."),B(null);return}if(!N){M("방문 시/군/구(District)를 선택해 주세요."),B(null);return}const ze=Ke().trim();if(!ze){M("담당자 정보를 확인할 수 없습니다. 다시 로그인해 주세요."),B(null);return}const Oe={subject:me,addrProvinceName:y,addrDistrictName:N,assigneeId:ze},Ze=I==null?void 0:I.trim();Ze&&(Oe.description=Ze);const Ne=Tl(E,8),Xe=Tl(k);Ne&&(Oe.plannedStartAt=Ne),Xe&&(Oe.plannedEndAt=Xe);const $e=Tl(T),ct=Tl(R);$e&&(Oe.actualStartAt=$e),ct&&(Oe.actualEndAt=ct);const ut=G.map(ft=>ft.type==="customer"&&ft.customerId?{customerId:ft.customerId}:ft.type==="lead"&&ft.leadId?{leadId:ft.leadId}:null).filter(Boolean);ut.length>0&&(Oe.targets=ut);const yt=Number(ze);Number.isNaN(yt)||(F||(Oe.createdBy=yt),Oe.updatedBy=yt),H(!0),M(null),B(null);try{const ft=F?`/api/v1/region-activity-plans/${F}`:"/api/v1/region-activity-plans",Et=await fetch(ft,{method:F?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Oe)});let At=null;try{At=await Et.json()}catch{At=null}if(!Et.ok){const Nn=(At==null?void 0:At.message)||(At==null?void 0:At.error)||`HTTP ${Et.status}`;throw new Error(Nn)}B(F?"지역활동 계획이 수정되었습니다.":"지역활동 계획이 등록되었습니다."),M(null),await St()}catch(ft){M((ft==null?void 0:ft.message)||"등록에 실패했습니다."),B(null)}finally{H(!1)}}async function jt(){const me=$.trim();if(!me){pe("검색어를 입력해 주세요."),Z([]);return}K(!0),pe(null);try{const[ze,Oe]=await Promise.all([(async()=>{const Ne=new URL("/api/v1/customers",window.location.origin);Ne.searchParams.set("mineOnly","false"),Ne.searchParams.set("limit","50"),Ne.searchParams.set("name",me);const Xe=await fetch(Ne.toString());if(!Xe.ok)throw new Error(`거래처 조회 실패 (HTTP ${Xe.status})`);const $e=await Xe.json();return Array.isArray($e)?$e:[]})(),(async()=>{const Ne=new URL("/api/v1/leads",window.location.origin);Ne.searchParams.set("limit","50"),Ne.searchParams.set("company_name",me);const Xe=await fetch(Ne.toString());if(!Xe.ok)throw new Error(`잠재고객 조회 실패 (HTTP ${Xe.status})`);const $e=await Xe.json();return Array.isArray($e)?$e:[]})()]),Ze=[...ze.map((Ne,Xe)=>{const $e=(Ne==null?void 0:Ne.customerId)??(Ne==null?void 0:Ne.customer_id)??(Ne==null?void 0:Ne.customerSeq)??(Ne==null?void 0:Ne.customer_seq)??"",ct=$e!=null?String($e).trim():"",ut=ct?`customer-${ct}`:`customer-${Xe}-${Math.random().toString(36).slice(2)}`,yt=(Ne==null?void 0:Ne.companyType)??(Ne==null?void 0:Ne.company_type)??(Ne==null?void 0:Ne.companyTypeName)??(Ne==null?void 0:Ne.company_type_name)??(Ne==null?void 0:Ne.companyClass)??(Ne==null?void 0:Ne.company_class)??(Ne==null?void 0:Ne.companyGroup)??(Ne==null?void 0:Ne.company_group)??null;return{key:ut,type:"customer",name:(Ne==null?void 0:Ne.customerName)??(Ne==null?void 0:Ne.customer_name)??"(이름 없음)",companyType:yt!=null?String(yt):null,customerId:ct||void 0}}),...Oe.map((Ne,Xe)=>{const $e=(Ne==null?void 0:Ne.id)??(Ne==null?void 0:Ne.lead_id)??"",ct=$e!=null?String($e).trim():"";return{key:ct?`lead-${ct}`:`lead-${Xe}-${Math.random().toString(36).slice(2)}`,type:"lead",name:(Ne==null?void 0:Ne.company_name)??(Ne==null?void 0:Ne.companyName)??(Ne==null?void 0:Ne.contact_name)??"(이름 없음)",leadId:ct||void 0}})];Z(Ze),Ze.length===0&&pe("조회 결과가 없습니다.")}catch(ze){pe((ze==null?void 0:ze.message)||"조회에 실패했습니다."),Z([])}finally{K(!1)}}function Dt(me){ae(ze=>ze.some(Oe=>Oe.key===me.key)?ze:[...ze,me])}function cn(me){ae(ze=>ze.filter(Oe=>Oe.key!==me))}const Un=Be.useCallback(me=>{Pe(me.id);const ze=me.leadId?"lead":"customer";Ee.current!==me.id?(tt(me.leadId??null),ht(me.customerName||""),Se(ze),Te(ze==="customer"&&me.companyType||""),ke({id:me.id,subject:me.subject,description:me.description,activityType:me.activityType,activityStatus:me.activityStatus,channel:me.channel,plannedStartAt:me.plannedStartAt,actualStartAt:me.actualStartAt,sfAccountId:me.sfAccountId,customerName:me.customerName}),Ee.current=me.id):Se(ze),st(!0)},[]),Ct=Be.useCallback(()=>{st(!1),Pe(null),tt(null),ht(""),Se(null),Te(""),ke(void 0),Ee.current=null},[]),Mt=Be.useMemo(()=>{const me=re.length,ze=re.filter(ct=>ct.isCompleted).length,Oe=he.length,Ze=he.filter(ct=>ct.isCompleted).length,Ne=me+Oe,Xe=ze+Ze,$e=Ne>0?Math.round(Xe/Ne*100):0;return{customerTotal:me,customerCompleted:ze,regionTotal:Oe,regionCompleted:Ze,totalPlanned:Ne,totalCompleted:Xe,achievementRate:$e}},[re,he]);return r.jsxs("section",{className:"activity-plan-page",children:[r.jsx("div",{className:"card",style:{padding:"12px 16px",marginBottom:12,flexShrink:0},children:r.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[r.jsx("button",{onClick:Ot,title:"이전 주",style:{width:32,height:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"var(--text)",transition:"background-color 0.2s"},onMouseEnter:me=>me.currentTarget.style.backgroundColor="var(--hover)",onMouseLeave:me=>me.currentTarget.style.backgroundColor="transparent",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("polyline",{points:"15 18 9 12 15 6"})})}),r.jsx("button",{onClick:En,title:"다음 주",style:{width:32,height:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"var(--text)",transition:"background-color 0.2s"},onMouseEnter:me=>me.currentTarget.style.backgroundColor="var(--hover)",onMouseLeave:me=>me.currentTarget.style.backgroundColor="transparent",children:r.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:r.jsx("polyline",{points:"9 18 15 12 9 6"})})}),r.jsx("button",{className:"btn",onClick:Gr,style:{marginLeft:4},children:"오늘"}),r.jsxs("span",{className:"badge",style:{marginLeft:"auto"},children:[Kr," ",yn]})]})}),r.jsxs("div",{className:"activity-kpi-grid",children:[r.jsxs("div",{className:"card kpi-card",style:{background:"linear-gradient(135deg, rgba(59,130,246,0.1) 0%, rgba(147,51,234,0.1) 100%)"},children:[r.jsx("div",{className:"kpi-label",children:"주간 달성률"}),r.jsxs("div",{className:"kpi-value",children:[r.jsx("span",{className:"kpi-number",children:Mt.achievementRate}),r.jsx("span",{className:"kpi-unit",children:"%"})]}),r.jsxs("div",{className:"kpi-desc",children:["목표 ",Mt.totalPlanned,"건 / 완료 ",Mt.totalCompleted,"건"]})]}),r.jsxs("div",{className:"card kpi-card",children:[r.jsx("div",{className:"kpi-label",children:"거래처 활동"}),r.jsxs("div",{className:"kpi-stats",children:[r.jsxs("div",{children:[r.jsx("div",{className:"kpi-stat-label",style:{color:"#dc2626"},children:"목표"}),r.jsx("div",{className:"kpi-stat-value",style:{color:"#dc2626"},children:Mt.customerTotal})]}),r.jsx("div",{className:"kpi-arrow",children:"→"}),r.jsxs("div",{children:[r.jsx("div",{className:"kpi-stat-label",style:{color:"#2563eb"},children:"완료"}),r.jsx("div",{className:"kpi-stat-value",style:{color:"#2563eb"},children:Mt.customerCompleted})]})]}),r.jsx("div",{className:"kpi-progress",children:r.jsx("div",{style:{width:`${Mt.customerTotal>0?Mt.customerCompleted/Mt.customerTotal*100:0}%`,background:"linear-gradient(90deg, #dc2626 0%, #2563eb 100%)"}})})]}),r.jsxs("div",{className:"card kpi-card",children:[r.jsx("div",{className:"kpi-label",children:"지역 활동"}),r.jsxs("div",{className:"kpi-stats",children:[r.jsxs("div",{children:[r.jsx("div",{className:"kpi-stat-label",style:{color:"#dc2626"},children:"목표"}),r.jsx("div",{className:"kpi-stat-value",style:{color:"#dc2626"},children:Mt.regionTotal})]}),r.jsx("div",{className:"kpi-arrow",children:"→"}),r.jsxs("div",{children:[r.jsx("div",{className:"kpi-stat-label",style:{color:"#10b981"},children:"완료"}),r.jsx("div",{className:"kpi-stat-value",style:{color:"#10b981"},children:Mt.regionCompleted})]})]}),r.jsx("div",{className:"kpi-progress",children:r.jsx("div",{style:{width:`${Mt.regionTotal>0?Mt.regionCompleted/Mt.regionTotal*100:0}%`,background:"linear-gradient(90deg, #dc2626 0%, #10b981 100%)"}})})]})]}),r.jsxs("div",{className:"card",style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",minHeight:0},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px repeat(7, 1fr)",background:"var(--panel)",borderBottom:"1px solid var(--border)",flex:"0 0 auto"},children:[r.jsx("div",{style:{padding:8,fontSize:12,color:"var(--text-muted)"},children:"시간"}),o.map((me,ze)=>r.jsx("div",{style:{padding:8,textAlign:"center",borderLeft:ze>0?"1px solid var(--border)":"none"},children:r.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[["월","화","수","목","금","토","일"][ze]," ",D3(me)]})},ze))]}),r.jsx("div",{ref:l,className:"calendar-scroll",onContextMenu:me=>{me.preventDefault();const ze=me.target;let Oe=null,Ze=null;const Ne=ct=>{var Et,At;if(!ct)return!1;const ut=ct.getAttribute("data-day")||((Et=ct.dataset)==null?void 0:Et.day),yt=ct.getAttribute("data-hour")||((At=ct.dataset)==null?void 0:At.hour),ft=ut?parseInt(ut,10):NaN,nn=yt?parseInt(yt,10):NaN;return!Number.isNaN(ft)&&!Number.isNaN(nn)?(Oe=ft,Ze=nn,!0):!1},Xe=ze?ze.closest(".week-event"):null,$e=ze?ze.closest(".week-cell"):null;if(!(Ne(Xe)||Ne($e))){const ct=l.current;if(ct){const ut=ct.getBoundingClientRect(),yt=me.clientX-ut.left,ft=me.clientY-ut.top+ct.scrollTop,nn=yt-60,Et=Math.max(1,(ut.width-60)/7),At=Math.floor(nn/Et);let ci=0;for(let Nn=0;Nn<24&&ft>=gt[Nn];Nn++)ci=Nn;At>=0&&At<=6&&ci>=0&&ci<=23&&(Oe=At,Ze=ci)}}if(Oe!=null&&Ze!=null){const ct=new Date(s);ct.setDate(ct.getDate()+Oe),ct.setHours(Ze,0,0,0),J(new Date(ct).toISOString())}d({open:!0,x:me.clientX,y:me.clientY})},style:{flex:1,overflowY:"scroll",overflowX:"hidden",minHeight:0},children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px repeat(7, 1fr)",gridTemplateRows:dt.map(me=>`${me}px`).join(" "),position:"relative"},children:[z3.map(me=>r.jsxs(Be.Fragment,{children:[r.jsxs("div",{style:{gridColumn:"1",gridRow:`${me+1}`,height:dt[me]||Js,padding:"4px 8px",fontSize:11,color:"var(--text-muted)",borderTop:"1px solid var(--border)"},children:[String(me).padStart(2,"0"),":00"]}),o.map((ze,Oe)=>r.jsx("div",{className:"week-cell","data-day":Oe,"data-hour":me,style:{gridColumn:`${Oe+2}`,gridRow:`${me+1}`,borderTop:"1px solid var(--border)",borderLeft:"1px solid var(--border)"}},`${me}-${Oe}`))]},me)),(()=>{const me=new Map,ze=re.map(Ne=>{if(!Ne.plannedStartAt)return null;const Xe=new Date(Ne.plannedStartAt),$e=Math.floor((new Date(Xe.getFullYear(),Xe.getMonth(),Xe.getDate()).getTime()-new Date(s.getFullYear(),s.getMonth(),s.getDate()).getTime())/864e5);if($e<0||$e>6)return null;const ct=Xe.getHours(),ut=`${$e}-${ct}`,yt=me.get(ut)||0;me.set(ut,yt+1);const ft=Ne.isCompleted?"(완)":"(계)",nn=Ne.isCompleted?"#2563eb":"#dc2626";return r.jsxs("div",{className:"week-event","data-day":$e,"data-hour":ct,onDoubleClick:Et=>{Et.stopPropagation(),Un(Ne)},style:{gridColumn:`${$e+2}`,gridRow:`${ct+1}`,height:dx,padding:"0 6px",fontSize:10,background:"rgba(59,130,246,.12)",border:"1px solid var(--accent)",borderRadius:6,margin:1,marginTop:yt*Vu,display:"flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left"},title:`${Ne.customerName||"(거래처명 없음)"} - ${Ne.subject||"(제목 없음)"}`,children:[r.jsx("span",{style:{color:nn,fontWeight:700,marginRight:4},children:ft}),r.jsx("span",{children:Ne.customerName||"(거래처명 없음)"})]},`ev-${Ne.id}-${yt}`)}),Oe=new Date(s.getFullYear(),s.getMonth(),s.getDate()),Ze=he.map(Ne=>{if(!Ne.plannedStartAt)return null;const Xe=new Date(Ne.plannedStartAt);if(isNaN(Xe.getTime()))return null;const $e=Math.floor((new Date(Xe.getFullYear(),Xe.getMonth(),Xe.getDate()).getTime()-Oe.getTime())/864e5);if($e<0||$e>6)return null;const ct=Xe.getHours(),ut=`${$e}-${ct}`,yt=me.get(ut)||0;me.set(ut,yt+1);const ft=Ne.isCompleted||!!Ne.actualEndAt,nn=ft?"(완)":"(계)",Et=ft?"#2563eb":"#dc2626";return r.jsxs("div",{className:"week-event","data-day":$e,"data-hour":ct,onDoubleClick:At=>{At.stopPropagation(),lt(Ne.id)},style:{gridColumn:`${$e+2}`,gridRow:`${ct+1}`,height:dx,padding:"0 6px",fontSize:10,background:"rgba(16,185,129,.18)",border:"1px solid rgba(16,185,129,.6)",borderRadius:6,margin:1,marginTop:yt*Vu,display:"flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left"},title:Ne.subject||"",children:[r.jsx("span",{style:{color:Et,fontWeight:700,marginRight:4},children:nn}),r.jsx("span",{children:Ne.subject||"(지역활동)"})]},`region-${Ne.id}-${$e}-${ct}-${yt}`)}).filter(Boolean);return[...ze,...Ze]})()]})})]}),c.open&&r.jsxs("div",{className:"context-menu",role:"menu",ref:u,style:{position:"fixed",left:c.x+6,top:c.y+6,zIndex:20050},children:[r.jsx("button",{className:"context-item",role:"menuitem",onClick:()=>{d({open:!1,x:0,y:0}),h(!0)},children:"거래처활동"}),r.jsx("button",{className:"context-item",role:"menuitem",onClick:()=>{d({open:!1,x:0,y:0}),ue()},children:"지역활동"})]}),f&&r.jsx(T3,{onClose:()=>h(!1),prefillAt:ie}),m&&r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:13e3},children:[r.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),r.jsx("div",{style:{position:"absolute",top:"8%",left:"50%",transform:"translateX(-50%)",width:"min(920px,96vw)",maxHeight:"84vh"},children:r.jsxs("div",{className:"card plan-compact-card",style:{height:"100%",overflow:"auto",padding:12,position:"relative"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[r.jsx("h3",{style:{margin:0},children:"지역활동 계획"}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:De,children:r.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:[r.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),r.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0,1fr) minmax(0,380px)",gap:12},children:[r.jsxs("div",{className:"plan-compact",style:{display:"flex",flexDirection:"column",gap:8},children:[r.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[r.jsx("label",{children:"제목"}),r.jsx("input",{className:"subject-input",value:w,onChange:me=>_(me.target.value),placeholder:"예: 서울 강남구 지역활동"})]}),r.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[r.jsx("label",{children:"도 선택"}),r.jsxs("select",{value:y,onChange:me=>{const ze=me.target.value;x(ze),C(""),zn(ze)},style:{height:32},children:[r.jsx("option",{value:"",children:"— 선택 —"}),b.map((me,ze)=>r.jsx("option",{value:me,children:me},`${me}-${ze}`))]})]}),r.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[r.jsx("label",{children:"시군 선택"}),r.jsxs("select",{value:N,onChange:me=>C(me.target.value),disabled:!y,style:{height:32},children:[r.jsx("option",{value:"",children:"— 선택 —"}),v.map((me,ze)=>r.jsx("option",{value:me,children:me},`${me}-${ze}`))]})]}),r.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[r.jsx("label",{children:"계획 일정"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:r.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[r.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:r.jsx("input",{className:"subject-input",type:"date",value:E,onChange:me=>S(me.target.value),style:{flex:1}})}),r.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"~"}),r.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:r.jsx("input",{className:"subject-input",type:"date",value:k,onChange:me=>D(me.target.value),style:{flex:1}})})]})})]}),r.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[r.jsx("label",{children:"완료일"}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:r.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[r.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:r.jsx("input",{className:"subject-input",type:"date",value:T,onChange:me=>P(me.target.value),style:{flex:1}})}),r.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"~"}),r.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:r.jsx("input",{className:"subject-input",type:"date",value:R,onChange:me=>Y(me.target.value),style:{flex:1}})})]})})]}),r.jsxs("div",{className:"field",style:{display:"flex",flexDirection:"column",gap:4},children:[r.jsx("label",{children:"활동계획/설명"}),r.jsx("textarea",{value:I,onChange:me=>O(me.target.value),placeholder:"방문 목적, 세부 활동계획, 비고 등을 입력해 주세요.",rows:4,style:{resize:"vertical",padding:8}})]})]}),r.jsxs("div",{className:"card",style:{padding:10,background:"var(--panel-2)",borderRadius:12,display:"flex",flexDirection:"column",gap:8,minHeight:0},children:[r.jsx("div",{style:{fontWeight:600,fontSize:13},children:"영업대상 조회/등록"}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[r.jsx("input",{className:"subject-input",placeholder:"거래처 또는 잠재고객명으로 검색",value:$,onChange:me=>W(me.target.value),onKeyDown:me=>{me.key==="Enter"&&(me.preventDefault(),jt())}}),r.jsx("button",{className:"btn",type:"button",onClick:jt,disabled:ee,children:"조회"})]}),r.jsx("div",{className:"table-container",style:{maxHeight:220,overflowY:"auto",overflowX:"hidden",background:"var(--panel)",borderRadius:8,padding:6},children:ee?r.jsx("div",{className:"empty-state",children:"조회 중…"}):U.length===0?r.jsx("div",{className:"empty-state",children:ne||"조회 결과가 없습니다."}):U.map(me=>{const ze=cx(me);return r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 4px",borderBottom:"1px solid var(--border)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,minWidth:0},children:[r.jsx("span",{title:me.name,style:{fontSize:13,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:1},children:me.name}),r.jsx("span",{title:ze.label,style:{width:22,height:22,borderRadius:"50%",background:ze.bg,color:ze.color,fontWeight:700,display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:12},children:r.jsx("span",{style:{width:18,height:18,borderRadius:"50%",background:ze.iconBg,color:"#fff",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:11},children:ze.icon})})]}),r.jsx("button",{className:"btn-ghost",type:"button",onClick:()=>Dt(me),style:{width:28,height:28,display:"inline-flex",alignItems:"center",justifyContent:"center",border:"none"},"aria-label":"등록",children:r.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})]},me.key)})}),r.jsxs("div",{style:{fontWeight:600,fontSize:12},children:["등록된 대상 (",G.length,")"]}),r.jsx("div",{className:"table-container",style:{maxHeight:140,overflowY:"auto",background:"var(--panel)",borderRadius:8,padding:6},children:G.length===0?r.jsx("div",{className:"empty-state",children:"등록된 대상이 없습니다."}):G.map(me=>{const ze=cx(me);return r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 2px",borderBottom:"1px dashed var(--border)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,minWidth:0},children:[r.jsx("span",{title:me.name,style:{fontSize:13,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:1},children:me.name}),r.jsx("span",{title:ze.label,style:{width:22,height:22,borderRadius:"50%",background:ze.bg,color:ze.color,fontWeight:700,display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:12},children:r.jsx("span",{style:{width:18,height:18,borderRadius:"50%",background:ze.iconBg,color:"#fff",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:11},children:ze.icon})})]}),r.jsx("button",{className:"btn-ghost",type:"button",onClick:()=>cn(me.key),style:{width:28,height:28,display:"inline-flex",alignItems:"center",justifyContent:"center",border:"none"},"aria-label":"삭제",children:r.jsx("span",{style:{fontSize:22,lineHeight:1},children:"−"})})]},`selected-${me.key}`)})})]})]}),q&&r.jsx("div",{style:{color:"#dc2626",fontSize:12,marginTop:8},children:q}),L&&r.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center",gap:8,border:"1px solid #10b981",background:"#ecfdf5",padding:"6px 10px",borderRadius:6},children:[r.jsx("span",{style:{color:"#047857",fontWeight:600},children:L}),r.jsx("button",{className:"btn btn-plain",type:"button",onClick:()=>B(null),style:{padding:"2px 8px",fontSize:12},children:"확인"})]}),r.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[r.jsx("button",{className:"btn",type:"button",onClick:De,children:"취소"}),r.jsx("button",{className:"btn btn-accent",type:"button",onClick:pt,disabled:X,children:X?"저장 중…":"저장"})]})]})})]}),r.jsx(U1,{open:Ue&&V!=null,onClose:Ct,editId:V??void 0,leadId:Ve&&/^\d+$/.test(Ve)?Number(Ve):void 0,leadName:ot,targetKind:vt??void 0,targetCompanyType:je||void 0,initial:Le,onSaved:()=>{setTimeout(()=>Nt(),50)}})]})}function R3(){const[e,n]=p.useState(()=>{try{const c=localStorage.getItem("tnt.sales.selectedCustomer");return c?JSON.parse(c):null}catch{return null}}),[i,s]=p.useState("transactions"),[a,o]=p.useState(0);p.useEffect(()=>{try{const c=localStorage.getItem("tnt.sales.selectedCustomer");n(c?JSON.parse(c):null)}catch{n(null)}},[]);const l=p.useMemo(()=>e?r.jsx("section",{className:"card compact-form",children:r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"거래처번호"}),r.jsx(fn,{value:e.customerId||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"거래처명"}),r.jsx(fn,{value:e.customerName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"정식명"}),r.jsx(fn,{value:e.customerFullName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"사업자번호"}),r.jsx(fn,{value:e.bizNo||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"대표자명"}),r.jsx(fn,{value:e.ownerName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"전화번호"}),r.jsx(fn,{value:e.telNo||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"고객유형"}),r.jsx(fn,{value:e.customerTypeName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"시/도"}),r.jsx(fn,{value:e.addrProvinceName||"",readOnly:!0})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"시/군/구"}),r.jsx(fn,{value:e.addrCityName||"",readOnly:!0})]}),r.jsxs("div",{className:"field row-2",children:[r.jsx("label",{children:"비고"}),r.jsx(fn,{value:e.customerRemark||"",readOnly:!0})]})]})}):r.jsx("div",{className:"empty-state",children:"선택된 거래처가 없습니다."}),[e]);return r.jsxs("section",{className:"c360",children:[r.jsx("div",{className:"page-title"}),l,r.jsxs("section",{className:"card",style:{marginTop:12,minHeight:240},children:[r.jsxs("div",{className:"tabs c360-tabs",children:[r.jsx("button",{className:i==="transactions"?"tab active":"tab",onClick:()=>s("transactions"),children:"거래 내역"}),r.jsx("button",{className:i==="activities"?"tab active":"tab",onClick:()=>s("activities"),children:"영업활동"}),r.jsx("button",{className:i==="demand"?"tab active":"tab",onClick:()=>s("demand"),children:"수요정보"})]}),r.jsxs("div",{style:{marginTop:12},children:[i==="transactions"&&(e==null?void 0:e.customerSeq)!=null&&r.jsx(L1,{customerSeq:e.customerSeq}),i==="activities"&&(e==null?void 0:e.customerSeq)!=null&&r.jsx(Pp,{customerSeq:e.customerSeq,customerId:e.customerId||"",hideRefresh:!0,enableContextMenu:!0}),i==="demand"&&(e==null?void 0:e.customerName)&&r.jsxs(r.Fragment,{children:[r.jsx(W1,{customerName:e.customerName,refreshTick:a}),r.jsx(B1,{customerName:e.customerName,refreshTick:a}),r.jsx(F1,{customerName:e.customerName,customerSeq:e.customerSeq,empSeq:e.empSeq,empName:e.empName||void 0,onSuccess:()=>o(c=>c+1)})]}),(!e||e.customerSeq==null)&&r.jsx("div",{className:"empty-state",children:"탭을 선택하세요"})]})]})]})}function El(e){const n=new Date(e);return n.setDate(1),n.setHours(0,0,0,0),n}function ux(e,n){const i=new Date(e);return i.setMonth(i.getMonth()+n),i}function Zs(e,n){const i=new Date(e);return i.setDate(i.getDate()+n),i}function Xu(e,n){return e.getFullYear()===n.getFullYear()&&e.getMonth()===n.getMonth()&&e.getDate()===n.getDate()}function $3(){const[e,n]=p.useState(()=>El(new Date)),i=new Date,[s,a]=p.useState([]),[o,l]=p.useState([]),[c,d]=p.useState(!1),[u,f]=p.useState(null),[h,m]=p.useState("month"),[g,b]=p.useState({open:!1,x:0,y:0,event:void 0,date:void 0}),[j,y]=p.useState(0),[x,v]=p.useState(null),[A,N]=p.useState(null),[C,w]=p.useState({open:!1}),_=p.useMemo(()=>{const q=[];if(h==="month"){const M=El(e),L=M.getDay(),B=new Date(M);B.setDate(M.getDate()-L);for(let F=0;F<42;F++){const te=new Date(B);te.setDate(B.getDate()+F),q.push({date:te,inMonth:te.getMonth()===e.getMonth(),isToday:Xu(te,i)})}}else if(h==="week"){const M=new Date(e),L=M.getDay(),B=new Date(M);B.setDate(M.getDate()-L);for(let F=0;F<7;F++){const te=new Date(B);te.setDate(B.getDate()+F),q.push({date:te,inMonth:!0,isToday:Xu(te,i)})}}else{const M=new Date(e);q.push({date:M,inMonth:!0,isToday:Xu(M,i)})}return q},[e,h]),I=p.useMemo(()=>{const q=e.getFullYear(),M=String(e.getMonth()+1).padStart(2,"0"),L=String(e.getDate()).padStart(2,"0");if(h==="month")return`${q}.${M}`;if(h==="week"){const B=e.getDay(),F=Zs(new Date(e),-B),te=Zs(new Date(F),6),$=String(F.getMonth()+1).padStart(2,"0"),W=String(F.getDate()).padStart(2,"0"),U=String(te.getMonth()+1).padStart(2,"0"),Z=String(te.getDate()).padStart(2,"0");return`${q}.${$}.${W} ~ ${te.getFullYear()}.${U}.${Z}`}return`${q}.${M}.${L}`},[e,h]);p.useEffect(()=>{const q=localStorage.getItem("tnt.sales.assigneeId");if(!q){f("로그인이 필요합니다"),a([]),l([]),d(!1);return}f(null),d(!0),(async()=>{const M=[],L=new Date(_[0].date);L.setHours(0,0,0,0);const B=new Date(_[_.length-1].date);B.setHours(23,59,59,999);try{const F=new URL("/api/v1/sales-activities",window.location.origin);F.searchParams.set("mineOnly","true"),F.searchParams.set("assigneeId",String(q)),F.searchParams.set("start",L.toISOString()),F.searchParams.set("end",B.toISOString());const te=await fetch(F.toString());if(!te.ok){let U=`HTTP ${te.status}`;try{const Z=await te.json();Z!=null&&Z.error&&(U=Z.error)}catch{}throw new Error(U)}const $=await te.json(),W=Array.isArray($)?$.map(U=>({id:Number(U==null?void 0:U.id),subject:(U==null?void 0:U.subject)??void 0,customerName:(U==null?void 0:U.customerName)??(U==null?void 0:U.customer_name)??void 0,plannedStartAt:(U==null?void 0:U.plannedStartAt)??(U==null?void 0:U.planned_start_at)??void 0,plannedEndAt:(U==null?void 0:U.plannedEndAt)??(U==null?void 0:U.planned_end_at)??null,activityStatus:(U==null?void 0:U.activityStatus)??(U==null?void 0:U.activity_status)??void 0,leadId:(U==null?void 0:U.sfLeadId)??(U==null?void 0:U.sf_lead_id)??(U==null?void 0:U.leadId)??(U==null?void 0:U.lead_id)??null,source:"sales"})):[];a(W)}catch(F){M.push((F==null?void 0:F.message)||"활동 조회 중 오류가 발생했습니다"),a([])}try{const F=new URL("/api/v1/region-activity-plans",window.location.origin);F.searchParams.set("assigneeId",String(q)),F.searchParams.set("start",L.toISOString()),F.searchParams.set("end",B.toISOString());const te=await fetch(F.toString());if(!te.ok)throw new Error(`HTTP ${te.status}`);const $=await te.json(),W=Array.isArray($)?$.map(U=>{const Z=(U==null?void 0:U.plannedStartAt)??(U==null?void 0:U.planned_start_at)??null,ee=(U==null?void 0:U.plannedEndAt)??(U==null?void 0:U.planned_end_at)??null,K=!!(U!=null&&U.actualStartAt||U!=null&&U.actual_start_at||U!=null&&U.actualEndAt||U!=null&&U.actual_end_at),ne=U!=null&&U.subject?`[지역] ${U.subject}`:"지역활동";return{id:Number(U==null?void 0:U.id),subject:ne,plannedStartAt:Z||void 0,plannedEndAt:ee||null,activityStatus:K?"completed":"region",leadId:null,source:"region"}}):[];l(W)}catch(F){M.push((F==null?void 0:F.message)||"지역활동 조회 중 오류가 발생했습니다"),l([])}f(M.length?M.join(" / "):null),d(!1)})()},[e,h,_,j]);const O=p.useMemo(()=>{const q=new Map,M=[...s,...o];if(!M||M.length===0)return q;const L=new Date(_[0].date),B=new Date(_[_.length-1].date);B.setHours(23,59,59,999);for(const F of M){if(!F.plannedStartAt&&!F.plannedEndAt)continue;const te=F.plannedStartAt?new Date(F.plannedStartAt):null,$=F.plannedEndAt?new Date(F.plannedEndAt):te;if(!te)continue;const W=te,U=$||te;if(U<L||W>B)continue;const Z=`${W.getFullYear()}-${String(W.getMonth()+1).padStart(2,"0")}-${String(W.getDate()).padStart(2,"0")}`,ee=W.toTimeString().slice(0,5),K=U.toTimeString().slice(0,5),ne=q.get(Z)||[];ne.push({id:F.id,subject:F.subject,customerName:F.customerName,time:ee,endTime:K,status:F.activityStatus,start:W,end:U,leadId:F.leadId??null,source:F.source}),q.set(Z,ne)}return q},[s,o,_]);function E(q){return q.getHours()*60+q.getMinutes()}function S(q){const M=Math.floor(q/60).toString().padStart(2,"0"),L=(q%60).toString().padStart(2,"0");return`${M}:${L}`}const k=Be.useCallback(q=>{const M=new Date(q);M.setHours(0,0,0,0);const L=new Date(q);L.setHours(23,59,59,999);const B=[],F=[...s,...o];for(const te of F){const $=te.plannedStartAt?new Date(te.plannedStartAt):null,W=te.plannedEndAt?new Date(te.plannedEndAt):$;if(!$)continue;const U=W||$;if(U<M||$>L)continue;const Z=$<M?M:$,ee=U>L?L:U;B.push({id:te.id,subject:te.subject,customerName:te.customerName,status:te.activityStatus,start:Z,end:ee,leadId:te.leadId??null,source:te.source})}return B.sort((te,$)=>te.start.getTime()-$.start.getTime()),B},[s,o]),D=p.useCallback(()=>{b({open:!1,x:0,y:0,event:void 0,date:void 0})},[]);p.useEffect(()=>{if(!g.open)return;const q=L=>{L.target.closest(".context-menu")||D()},M=L=>{L.key==="Escape"&&D()};return window.addEventListener("click",q,!0),window.addEventListener("contextmenu",q,!1),window.addEventListener("keydown",M,!0),()=>{window.removeEventListener("click",q,!0),window.removeEventListener("contextmenu",q,!0),window.removeEventListener("keydown",M,!0)}},[g.open,D]);function T(q,M){M.source!=="region"&&(q.preventDefault(),q.stopPropagation(),b({open:!0,x:q.clientX,y:q.clientY,event:M,date:M.start}))}async function P(q){const M=q==null?void 0:q.id;if(M)try{const L=await fetch(`/api/v1/sales-activities/${M}`);if(!L.ok)throw new Error(`HTTP ${L.status}`);const B=await L.json(),F=(B==null?void 0:B.customerName)||(B==null?void 0:B.customer_name)||"";w({open:!0,event:q,customerName:F})}catch(L){console.error("활동 상세 조회 실패:",L),w({open:!0,event:q,customerName:""})}}async function R(){var M;const q=(M=C.event)==null?void 0:M.id;if(!q){w({open:!1});return}try{const L=await fetch(`/api/v1/sales-activities/${q}`,{method:"DELETE"});if(!L.ok)throw new Error(`HTTP ${L.status}`);a(B=>B.filter(F=>F.id!==q));try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated",{detail:{id:q}}))}catch{}w({open:!1}),D()}catch(L){window.alert((L==null?void 0:L.message)||"삭제 중 오류가 발생했습니다"),w({open:!1})}}function Y(){w({open:!1})}p.useEffect(()=>{(h==="week"||h==="day")&&setTimeout(()=>{document.querySelectorAll(".day-timeline").forEach(q=>{q.scrollTop=7*40})},0)},[h,_]);async function X(q){q.source!=="region"&&q!=null&&q.id&&v(q.id)}p.useEffect(()=>{if(h!=="week")return;const q=Array.from(document.querySelectorAll(".day-timeline"));if(q.length===0)return;const M=L=>{const B=L.target,F=B.scrollTop;q.forEach(te=>{te!==B&&(te.scrollTop=F)})};return q.forEach(L=>L.addEventListener("scroll",M)),()=>q.forEach(L=>L.removeEventListener("scroll",M))},[h,_]),p.useEffect(()=>{if(!x)return;const q=M=>{M.key==="Escape"&&(M.preventDefault(),M.stopPropagation(),v(null))};return window.addEventListener("keydown",q,!0),()=>window.removeEventListener("keydown",q,!0)},[x]),p.useEffect(()=>{if(!A)return;const q=M=>{M.key==="Escape"&&(M.preventDefault(),M.stopPropagation(),N(null))};return window.addEventListener("keydown",q,!0),()=>window.removeEventListener("keydown",q,!0)},[A]);const H=p.useCallback((q,M)=>{const L=new Date(q);L.setHours(9,0,0,0);const B=$=>{const W=$.getFullYear(),U=String($.getMonth()+1).padStart(2,"0"),Z=String($.getDate()).padStart(2,"0"),ee=String($.getHours()).padStart(2,"0"),K=String($.getMinutes()).padStart(2,"0");return`${W}-${U}-${Z}T${ee}:${K}`},F=(M==null?void 0:M.customerId)??(M==null?void 0:M.customer_id)??void 0,te=(M==null?void 0:M.customerName)??(M==null?void 0:M.customer_name)??void 0;N({plannedStartAt:B(L),sfAccountId:F,customerName:te})},[]);return p.useEffect(()=>{const q=M=>{var F,te;const L=(F=M==null?void 0:M.detail)!=null&&F.date?new Date(M.detail.date):new Date,B=(te=M==null?void 0:M.detail)==null?void 0:te.customer;H(L,B)};return window.addEventListener("tnt.sales.calendar.create",q),window.addEventListener("tnt.sales.activity.create.inline",q),()=>{window.removeEventListener("tnt.sales.calendar.create",q),window.removeEventListener("tnt.sales.activity.create.inline",q)}},[H]),r.jsxs(r.Fragment,{children:[r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",children:[r.jsx("h2",{children:"일정"}),r.jsx("div",{className:"meta",children:r.jsx("button",{className:"btn",onClick:()=>n(El(new Date)),children:"오늘"})})]}),r.jsxs("div",{className:"card",style:{padding:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("button",{className:"btn",onClick:()=>n(q=>h==="month"?ux(q,-1):h==="week"?Zs(q,-7):Zs(q,-1)),children:"〈"}),r.jsx("div",{style:{fontWeight:700},children:I}),r.jsx("button",{className:"btn",onClick:()=>n(q=>h==="month"?ux(q,1):h==="week"?Zs(q,7):Zs(q,1)),children:"〉"})]}),r.jsxs("div",{style:{display:"flex",gap:6},children:[r.jsx("button",{className:"btn",onClick:()=>{m("month"),n(El(new Date))},disabled:h==="month",children:"월"}),r.jsx("button",{className:"btn",onClick:()=>{m("week"),n(new Date)},disabled:h==="week",children:"주"}),r.jsx("button",{className:"btn",onClick:()=>{m("day"),n(new Date)},disabled:h==="day",children:"일"})]})]}),u&&r.jsx("div",{className:"error",style:{marginBottom:8},children:u}),c&&r.jsx("div",{className:"muted",style:{marginBottom:8},children:"활동 불러오는 중…"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:`repeat(${h==="day"?1:7}, 1fr)`,gap:4},children:[(h==="day"?[""]:["일","월","화","수","목","금","토"]).map((q,M)=>r.jsx("div",{style:{textAlign:"center",color:"var(--muted)",padding:"6px 0"},children:q},M)),h==="month"&&_.map((q,M)=>r.jsxs("div",{style:{position:"relative",border:"1px solid var(--border)",borderRadius:8,padding:8,height:120,overflow:"hidden",display:"flex",flexDirection:"column",background:q.inMonth?"transparent":"var(--panel-2)",outline:q.isToday?"2px solid var(--accent)":"none"},onContextMenu:L=>{L.preventDefault(),L.stopPropagation(),b({open:!0,x:L.clientX,y:L.clientY,date:q.date,event:void 0})},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6,opacity:q.inMonth?1:.6},children:q.date.getDate()}),(()=>{const L=`${q.date.getFullYear()}-${String(q.date.getMonth()+1).padStart(2,"0")}-${String(q.date.getDate()).padStart(2,"0")}`,B=O.get(L)||[];return B.length?r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{position:"absolute",top:6,right:8,fontSize:11,fontWeight:700,color:"#dc2626"},children:B.length}),r.jsx("div",{className:"cal-events",style:{flex:1,minHeight:0,overflowY:"auto",display:"flex",flexDirection:"column",gap:4},children:B.map((F,te)=>{const $=F.customerName||F.subject||"활동",W=F.customerName&&F.subject?`${F.customerName} · ${F.subject}`:F.customerName||F.subject||"";return r.jsxs("div",{className:`cal-pill status-${(F.status||"scheduled").replaceAll(" ","_")}`,title:W,onClick:()=>{F.source!=="region"&&X(F)},onContextMenu:U=>{F.source!=="region"&&T(U,F)},style:{cursor:F.source==="region"?"default":"pointer"},children:[r.jsx("span",{className:"time",children:F.time}),r.jsx("span",{className:"subj",children:$})]},te)})})]}):null})()]},M)),(h==="week"||h==="day")&&_.map((B,F)=>{const te=`${B.date.getFullYear()}-${String(B.date.getMonth()+1).padStart(2,"0")}-${String(B.date.getDate()).padStart(2,"0")}`,$=(O.get(te)||[]).sort((ne,pe)=>ne.start.getTime()-pe.start.getTime()),W=h==="day"?k(B.date):$,U=Array.from({length:24},()=>[]);W.forEach(ne=>{const pe=E(ne.start),G=E(ne.end),ae=G>pe?G:pe,ie=Math.floor(pe/60),J=Math.floor(ae/60);for(let re=ie;re<=Math.min(J,23);re++)U[re].push(ne)});const Z=U.map(ne=>ne.length===0?40:40+(ne.length-1)*20),ee=[0];for(let ne=0;ne<24;ne++)ee.push(ee[ne]+Z[ne]);const K=ee[24];return r.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8,padding:8},onContextMenu:ne=>{ne.preventDefault(),ne.stopPropagation(),b({open:!0,x:ne.clientX,y:ne.clientY,date:B.date,event:void 0})},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:B.date.getDate()}),r.jsx("div",{className:"day-timeline",style:{position:"relative",height:K,borderTop:"1px solid var(--border)",overflowY:"auto",maxHeight:640},children:[...Array(24)].map((ne,pe)=>{const G=U[pe],ae=ee[pe],ie=Z[pe];return r.jsxs("div",{style:{position:"absolute",top:ae,left:0,right:0,height:ie},children:[r.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,borderTop:"1px dashed var(--border)",fontSize:10,color:"var(--muted)"},children:r.jsxs("span",{style:{position:"absolute",left:0,transform:"translateY(-50%)",paddingLeft:4},children:[pe,":00"]})}),G.map((J,re)=>{const de=E(J.start),he=E(J.end),oe=he>de?he:de;if(Math.floor(de/60)!==pe)return null;const tt=de%60/60*40+re*20,ot=oe-de,ht=ot>0?Math.max(18,ot/60*40):18,vt=J.customerName||J.subject||"활동",Se=J.customerName&&J.subject?`${J.customerName} · ${J.subject}`:J.customerName||J.subject||"";return r.jsxs("div",{className:`cal-pill status-${(J.status||"scheduled").replaceAll(" ","_")}`,style:{position:"absolute",top:tt,left:"60px",width:"calc(100% - 64px)",height:ht,zIndex:re},title:`${S(de)}~${S(oe)} ${Se}`,onClick:()=>{J.source!=="region"&&X(J)},onContextMenu:je=>{J.source!=="region"&&T(je,J)},"aria-disabled":J.source==="region"?!0:void 0,children:[r.jsx("span",{className:"time",children:S(de)}),r.jsx("span",{className:"subj",children:vt})]},J.id)})]},pe)})})]},F)})]}),g.open&&r.jsxs("div",{className:"context-menu",style:{left:g.x+4,top:g.y+4},onClick:q=>q.stopPropagation(),children:[r.jsx("button",{className:"context-item",onClick:()=>{g.date&&(H(g.date),D())},disabled:!g.date,children:"활동 등록"}),r.jsx("button",{className:"context-item",onClick:()=>{g.event&&(v(g.event.id),D())},disabled:!g.event,style:g.event?void 0:{opacity:.35,cursor:"not-allowed"},children:"활동 수정"}),r.jsx("button",{className:"context-item",onClick:()=>{g.event&&(D(),P(g.event))},disabled:!g.event,style:g.event?void 0:{opacity:.35,cursor:"not-allowed"},children:"활동 삭제"})]})]})]}),x&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.4)"},onClick:()=>v(null),children:r.jsxs("div",{className:"card",style:{width:"min(920px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:q=>q.stopPropagation(),children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[r.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"영업활동 수정"}),r.jsx("button",{onClick:()=>v(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:q=>{q.currentTarget.style.background="var(--panel-2)",q.currentTarget.style.color="var(--text)"},onMouseLeave:q=>{q.currentTarget.style.background="transparent",q.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)",children:"×"})]}),r.jsx(Ps,{bare:!0,editId:x,onSaved:()=>{v(null),y(q=>q+1)},onNoticeClose:()=>v(null)})]})}),A&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.4)"},onClick:()=>N(null),children:r.jsxs("div",{className:"card",style:{width:"min(920px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:q=>q.stopPropagation(),children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[r.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"영업활동 등록"}),r.jsx("button",{onClick:()=>N(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:q=>{q.currentTarget.style.background="var(--panel-2)",q.currentTarget.style.color="var(--text)"},onMouseLeave:q=>{q.currentTarget.style.background="transparent",q.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)",children:"×"})]}),r.jsx(Ps,{bare:!0,initial:A,onSaved:()=>{N(null),y(q=>q+1)},onNoticeClose:()=>N(null)})]})}),C.open&&r.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.5)"},onClick:Y,children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:20,border:"1px solid var(--border)",borderRadius:12,minWidth:320,maxWidth:"86vw",boxShadow:"0 8px 32px rgba(0,0,0,.3)"},onClick:q=>q.stopPropagation(),children:[r.jsx("div",{style:{marginBottom:16,fontSize:16,fontWeight:700,color:"var(--text)",textAlign:"center"},children:"활동 삭제"}),r.jsxs("div",{style:{marginBottom:20,fontSize:14,color:"var(--text)",textAlign:"center",lineHeight:1.6},children:[C.customerName&&r.jsx("div",{style:{marginBottom:8,fontWeight:600,color:"var(--primary)"},children:C.customerName}),r.jsx("div",{children:"정말로 삭제하시겠습니까?"})]}),r.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[r.jsx("button",{className:"btn",onClick:Y,style:{minWidth:80,background:"var(--panel-2)",border:"1px solid var(--border)",color:"var(--text)",display:"flex",alignItems:"center",justifyContent:"center"},children:"취소"}),r.jsx("button",{className:"btn",onClick:R,style:{minWidth:80,background:"#dc2626",border:"1px solid #b91c1c",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center"},children:"삭제"})]})]})})]})}function H1(e){var n,i,s="";if(typeof e=="string"||typeof e=="number")s+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(n=0;n<a;n++)e[n]&&(i=H1(e[n]))&&(s&&(s+=" "),s+=i)}else for(i in e)e[i]&&(s&&(s+=" "),s+=i);return s}function _t(){for(var e,n,i=0,s="",a=arguments.length;i<a;i++)(e=arguments[i])&&(n=H1(e))&&(s&&(s+=" "),s+=n);return s}var L3=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Op(e){if(typeof e!="string")return!1;var n=L3;return n.includes(e)}var W3=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function Y1(e){if(typeof e!="string")return!1;var n=W3;return n.includes(e)}function K1(e){return typeof e=="string"&&e.startsWith("data-")}function yr(e){var n=Object.entries(e).filter(i=>{var[s]=i;return Y1(s)||K1(s)});return Object.fromEntries(n)}function zs(e){if(e==null)return null;if(p.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var n=e.props;return yr(n)}return typeof e=="object"&&!Array.isArray(e)?yr(e):null}function Qn(e){var n=Object.entries(e).filter(i=>{var[s]=i;return Y1(s)||K1(s)||Op(s)});return Object.fromEntries(n)}function B3(e){return e==null?null:p.isValidElement(e)?Qn(e.props):typeof e=="object"&&!Array.isArray(e)?Qn(e):null}var F3=["children","width","height","viewBox","className","style","title","desc"];function Jf(){return Jf=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Jf.apply(null,arguments)}function q3(e,n){if(e==null)return{};var i,s,a=U3(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function U3(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var G1=p.forwardRef((e,n)=>{var{children:i,width:s,height:a,viewBox:o,className:l,style:c,title:d,desc:u}=e,f=q3(e,F3),h=o||{width:s,height:a,x:0,y:0},m=_t("recharts-surface",l);return p.createElement("svg",Jf({},Qn(f),{className:m,width:s,height:a,style:c,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:n}),p.createElement("title",null,d),p.createElement("desc",null,u),i)}),H3=["children","className"];function Zf(){return Zf=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Zf.apply(null,arguments)}function Y3(e,n){if(e==null)return{};var i,s,a=K3(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function K3(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var An=p.forwardRef((e,n)=>{var{children:i,className:s}=e,a=Y3(e,H3),o=_t("recharts-layer",s);return p.createElement("g",Zf({className:o},Qn(a),{ref:n}),i)}),G3=p.createContext(null);function Bt(e){return function(){return e}}const V1=Math.cos,Oc=Math.sin,Yr=Math.sqrt,Dc=Math.PI,Id=2*Dc,eh=Math.PI,th=2*eh,xs=1e-6,V3=th-xs;function X1(e){this._+=e[0];for(let n=1,i=e.length;n<i;++n)this._+=arguments[n]+e[n]}function X3(e){let n=Math.floor(e);if(!(n>=0))throw new Error(`invalid digits: ${e}`);if(n>15)return X1;const i=10**n;return function(s){this._+=s[0];for(let a=1,o=s.length;a<o;++a)this._+=Math.round(arguments[a]*i)/i+s[a]}}class Q3{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?X1:X3(n)}moveTo(n,i){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+i}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,i){this._append`L${this._x1=+n},${this._y1=+i}`}quadraticCurveTo(n,i,s,a){this._append`Q${+n},${+i},${this._x1=+s},${this._y1=+a}`}bezierCurveTo(n,i,s,a,o,l){this._append`C${+n},${+i},${+s},${+a},${this._x1=+o},${this._y1=+l}`}arcTo(n,i,s,a,o){if(n=+n,i=+i,s=+s,a=+a,o=+o,o<0)throw new Error(`negative radius: ${o}`);let l=this._x1,c=this._y1,d=s-n,u=a-i,f=l-n,h=c-i,m=f*f+h*h;if(this._x1===null)this._append`M${this._x1=n},${this._y1=i}`;else if(m>xs)if(!(Math.abs(h*d-u*f)>xs)||!o)this._append`L${this._x1=n},${this._y1=i}`;else{let g=s-l,b=a-c,j=d*d+u*u,y=g*g+b*b,x=Math.sqrt(j),v=Math.sqrt(m),A=o*Math.tan((eh-Math.acos((j+m-y)/(2*x*v)))/2),N=A/v,C=A/x;Math.abs(N-1)>xs&&this._append`L${n+N*f},${i+N*h}`,this._append`A${o},${o},0,0,${+(h*g>f*b)},${this._x1=n+C*d},${this._y1=i+C*u}`}}arc(n,i,s,a,o,l){if(n=+n,i=+i,s=+s,l=!!l,s<0)throw new Error(`negative radius: ${s}`);let c=s*Math.cos(a),d=s*Math.sin(a),u=n+c,f=i+d,h=1^l,m=l?a-o:o-a;this._x1===null?this._append`M${u},${f}`:(Math.abs(this._x1-u)>xs||Math.abs(this._y1-f)>xs)&&this._append`L${u},${f}`,s&&(m<0&&(m=m%th+th),m>V3?this._append`A${s},${s},0,1,${h},${n-c},${i-d}A${s},${s},0,1,${h},${this._x1=u},${this._y1=f}`:m>xs&&this._append`A${s},${s},0,${+(m>=eh)},${h},${this._x1=n+s*Math.cos(o)},${this._y1=i+s*Math.sin(o)}`)}rect(n,i,s,a){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+i}h${s=+s}v${+a}h${-s}Z`}toString(){return this._}}function Dp(e){let n=3;return e.digits=function(i){if(!arguments.length)return n;if(i==null)n=null;else{const s=Math.floor(i);if(!(s>=0))throw new RangeError(`invalid digits: ${i}`);n=s}return e},()=>new Q3(n)}function zp(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Q1(e){this._context=e}Q1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:this._context.lineTo(e,n);break}}};function Td(e){return new Q1(e)}function J1(e){return e[0]}function Z1(e){return e[1]}function ej(e,n){var i=Bt(!0),s=null,a=Td,o=null,l=Dp(c);e=typeof e=="function"?e:e===void 0?J1:Bt(e),n=typeof n=="function"?n:n===void 0?Z1:Bt(n);function c(d){var u,f=(d=zp(d)).length,h,m=!1,g;for(s==null&&(o=a(g=l())),u=0;u<=f;++u)!(u<f&&i(h=d[u],u,d))===m&&((m=!m)?o.lineStart():o.lineEnd()),m&&o.point(+e(h,u,d),+n(h,u,d));if(g)return o=null,g+""||null}return c.x=function(d){return arguments.length?(e=typeof d=="function"?d:Bt(+d),c):e},c.y=function(d){return arguments.length?(n=typeof d=="function"?d:Bt(+d),c):n},c.defined=function(d){return arguments.length?(i=typeof d=="function"?d:Bt(!!d),c):i},c.curve=function(d){return arguments.length?(a=d,s!=null&&(o=a(s)),c):a},c.context=function(d){return arguments.length?(d==null?s=o=null:o=a(s=d),c):s},c}function Pl(e,n,i){var s=null,a=Bt(!0),o=null,l=Td,c=null,d=Dp(u);e=typeof e=="function"?e:e===void 0?J1:Bt(+e),n=typeof n=="function"?n:Bt(n===void 0?0:+n),i=typeof i=="function"?i:i===void 0?Z1:Bt(+i);function u(h){var m,g,b,j=(h=zp(h)).length,y,x=!1,v,A=new Array(j),N=new Array(j);for(o==null&&(c=l(v=d())),m=0;m<=j;++m){if(!(m<j&&a(y=h[m],m,h))===x)if(x=!x)g=m,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),b=m-1;b>=g;--b)c.point(A[b],N[b]);c.lineEnd(),c.areaEnd()}x&&(A[m]=+e(y,m,h),N[m]=+n(y,m,h),c.point(s?+s(y,m,h):A[m],i?+i(y,m,h):N[m]))}if(v)return c=null,v+""||null}function f(){return ej().defined(a).curve(l).context(o)}return u.x=function(h){return arguments.length?(e=typeof h=="function"?h:Bt(+h),s=null,u):e},u.x0=function(h){return arguments.length?(e=typeof h=="function"?h:Bt(+h),u):e},u.x1=function(h){return arguments.length?(s=h==null?null:typeof h=="function"?h:Bt(+h),u):s},u.y=function(h){return arguments.length?(n=typeof h=="function"?h:Bt(+h),i=null,u):n},u.y0=function(h){return arguments.length?(n=typeof h=="function"?h:Bt(+h),u):n},u.y1=function(h){return arguments.length?(i=h==null?null:typeof h=="function"?h:Bt(+h),u):i},u.lineX0=u.lineY0=function(){return f().x(e).y(n)},u.lineY1=function(){return f().x(e).y(i)},u.lineX1=function(){return f().x(s).y(n)},u.defined=function(h){return arguments.length?(a=typeof h=="function"?h:Bt(!!h),u):a},u.curve=function(h){return arguments.length?(l=h,o!=null&&(c=l(o)),u):l},u.context=function(h){return arguments.length?(h==null?o=c=null:c=l(o=h),u):o},u}class tj{constructor(n,i){this._context=n,this._x=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(n,i){switch(n=+n,i=+i,this._point){case 0:{this._point=1,this._line?this._context.lineTo(n,i):this._context.moveTo(n,i);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+n)/2,this._y0,this._x0,i,n,i):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+i)/2,n,this._y0,n,i);break}}this._x0=n,this._y0=i}}function J3(e){return new tj(e,!0)}function Z3(e){return new tj(e,!1)}const Mp={draw(e,n){const i=Yr(n/Dc);e.moveTo(i,0),e.arc(0,0,i,0,Id)}},eO={draw(e,n){const i=Yr(n/5)/2;e.moveTo(-3*i,-i),e.lineTo(-i,-i),e.lineTo(-i,-3*i),e.lineTo(i,-3*i),e.lineTo(i,-i),e.lineTo(3*i,-i),e.lineTo(3*i,i),e.lineTo(i,i),e.lineTo(i,3*i),e.lineTo(-i,3*i),e.lineTo(-i,i),e.lineTo(-3*i,i),e.closePath()}},nj=Yr(1/3),tO=nj*2,nO={draw(e,n){const i=Yr(n/tO),s=i*nj;e.moveTo(0,-i),e.lineTo(s,0),e.lineTo(0,i),e.lineTo(-s,0),e.closePath()}},rO={draw(e,n){const i=Yr(n),s=-i/2;e.rect(s,s,i,i)}},iO=.8908130915292852,rj=Oc(Dc/10)/Oc(7*Dc/10),sO=Oc(Id/10)*rj,aO=-V1(Id/10)*rj,oO={draw(e,n){const i=Yr(n*iO),s=sO*i,a=aO*i;e.moveTo(0,-i),e.lineTo(s,a);for(let o=1;o<5;++o){const l=Id*o/5,c=V1(l),d=Oc(l);e.lineTo(d*i,-c*i),e.lineTo(c*s-d*a,d*s+c*a)}e.closePath()}},Qu=Yr(3),lO={draw(e,n){const i=-Yr(n/(Qu*3));e.moveTo(0,i*2),e.lineTo(-Qu*i,-i),e.lineTo(Qu*i,-i),e.closePath()}},Sr=-.5,kr=Yr(3)/2,nh=1/Yr(12),cO=(nh/2+1)*3,dO={draw(e,n){const i=Yr(n/cO),s=i/2,a=i*nh,o=s,l=i*nh+i,c=-o,d=l;e.moveTo(s,a),e.lineTo(o,l),e.lineTo(c,d),e.lineTo(Sr*s-kr*a,kr*s+Sr*a),e.lineTo(Sr*o-kr*l,kr*o+Sr*l),e.lineTo(Sr*c-kr*d,kr*c+Sr*d),e.lineTo(Sr*s+kr*a,Sr*a-kr*s),e.lineTo(Sr*o+kr*l,Sr*l-kr*o),e.lineTo(Sr*c+kr*d,Sr*d-kr*c),e.closePath()}};function uO(e,n){let i=null,s=Dp(a);e=typeof e=="function"?e:Bt(e||Mp),n=typeof n=="function"?n:Bt(n===void 0?64:+n);function a(){let o;if(i||(i=o=s()),e.apply(this,arguments).draw(i,+n.apply(this,arguments)),o)return i=null,o+""||null}return a.type=function(o){return arguments.length?(e=typeof o=="function"?o:Bt(o),a):e},a.size=function(o){return arguments.length?(n=typeof o=="function"?o:Bt(+o),a):n},a.context=function(o){return arguments.length?(i=o??null,a):i},a}function zc(){}function Mc(e,n,i){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+n)/6,(e._y0+4*e._y1+i)/6)}function ij(e){this._context=e}ij.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Mc(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Mc(this,e,n);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n}};function fO(e){return new ij(e)}function sj(e){this._context=e}sj.prototype={areaStart:zc,areaEnd:zc,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._x2=e,this._y2=n;break;case 1:this._point=2,this._x3=e,this._y3=n;break;case 2:this._point=3,this._x4=e,this._y4=n,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+n)/6);break;default:Mc(this,e,n);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n}};function hO(e){return new sj(e)}function aj(e){this._context=e}aj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var i=(this._x0+4*this._x1+e)/6,s=(this._y0+4*this._y1+n)/6;this._line?this._context.lineTo(i,s):this._context.moveTo(i,s);break;case 3:this._point=4;default:Mc(this,e,n);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n}};function pO(e){return new aj(e)}function oj(e){this._context=e}oj.prototype={areaStart:zc,areaEnd:zc,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,n){e=+e,n=+n,this._point?this._context.lineTo(e,n):(this._point=1,this._context.moveTo(e,n))}};function mO(e){return new oj(e)}function fx(e){return e<0?-1:1}function hx(e,n,i){var s=e._x1-e._x0,a=n-e._x1,o=(e._y1-e._y0)/(s||a<0&&-0),l=(i-e._y1)/(a||s<0&&-0),c=(o*a+l*s)/(s+a);return(fx(o)+fx(l))*Math.min(Math.abs(o),Math.abs(l),.5*Math.abs(c))||0}function px(e,n){var i=e._x1-e._x0;return i?(3*(e._y1-e._y0)/i-n)/2:n}function Ju(e,n,i){var s=e._x0,a=e._y0,o=e._x1,l=e._y1,c=(o-s)/3;e._context.bezierCurveTo(s+c,a+c*n,o-c,l-c*i,o,l)}function Rc(e){this._context=e}Rc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ju(this,this._t0,px(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,n){var i=NaN;if(e=+e,n=+n,!(e===this._x1&&n===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;break;case 2:this._point=3,Ju(this,px(this,i=hx(this,e,n)),i);break;default:Ju(this,this._t0,i=hx(this,e,n));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=n,this._t0=i}}};function lj(e){this._context=new cj(e)}(lj.prototype=Object.create(Rc.prototype)).point=function(e,n){Rc.prototype.point.call(this,n,e)};function cj(e){this._context=e}cj.prototype={moveTo:function(e,n){this._context.moveTo(n,e)},closePath:function(){this._context.closePath()},lineTo:function(e,n){this._context.lineTo(n,e)},bezierCurveTo:function(e,n,i,s,a,o){this._context.bezierCurveTo(n,e,s,i,o,a)}};function gO(e){return new Rc(e)}function yO(e){return new lj(e)}function dj(e){this._context=e}dj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,n=this._y,i=e.length;if(i)if(this._line?this._context.lineTo(e[0],n[0]):this._context.moveTo(e[0],n[0]),i===2)this._context.lineTo(e[1],n[1]);else for(var s=mx(e),a=mx(n),o=0,l=1;l<i;++o,++l)this._context.bezierCurveTo(s[0][o],a[0][o],s[1][o],a[1][o],e[l],n[l]);(this._line||this._line!==0&&i===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,n){this._x.push(+e),this._y.push(+n)}};function mx(e){var n,i=e.length-1,s,a=new Array(i),o=new Array(i),l=new Array(i);for(a[0]=0,o[0]=2,l[0]=e[0]+2*e[1],n=1;n<i-1;++n)a[n]=1,o[n]=4,l[n]=4*e[n]+2*e[n+1];for(a[i-1]=2,o[i-1]=7,l[i-1]=8*e[i-1]+e[i],n=1;n<i;++n)s=a[n]/o[n-1],o[n]-=s,l[n]-=s*l[n-1];for(a[i-1]=l[i-1]/o[i-1],n=i-2;n>=0;--n)a[n]=(l[n]-a[n+1])/o[n];for(o[i-1]=(e[i]+a[i-1])/2,n=0;n<i-1;++n)o[n]=2*e[n+1]-a[n+1];return[a,o]}function xO(e){return new dj(e)}function Ed(e,n){this._context=e,this._t=n}Ed.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,n){switch(e=+e,n=+n,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,n),this._context.lineTo(e,n);else{var i=this._x*(1-this._t)+e*this._t;this._context.lineTo(i,this._y),this._context.lineTo(i,n)}break}}this._x=e,this._y=n}};function vO(e){return new Ed(e,.5)}function bO(e){return new Ed(e,0)}function jO(e){return new Ed(e,1)}function ja(e,n){if((l=e.length)>1)for(var i=1,s,a,o=e[n[0]],l,c=o.length;i<l;++i)for(a=o,o=e[n[i]],s=0;s<c;++s)o[s][1]+=o[s][0]=isNaN(a[s][1])?a[s][0]:a[s][1]}function rh(e){for(var n=e.length,i=new Array(n);--n>=0;)i[n]=n;return i}function wO(e,n){return e[n]}function SO(e){const n=[];return n.key=e,n}function kO(){var e=Bt([]),n=rh,i=ja,s=wO;function a(o){var l=Array.from(e.apply(this,arguments),SO),c,d=l.length,u=-1,f;for(const h of o)for(c=0,++u;c<d;++c)(l[c][u]=[0,+s(h,l[c].key,u,o)]).data=h;for(c=0,f=zp(n(l));c<d;++c)l[f[c]].index=c;return i(l,f),l}return a.keys=function(o){return arguments.length?(e=typeof o=="function"?o:Bt(Array.from(o)),a):e},a.value=function(o){return arguments.length?(s=typeof o=="function"?o:Bt(+o),a):s},a.order=function(o){return arguments.length?(n=o==null?rh:typeof o=="function"?o:Bt(Array.from(o)),a):n},a.offset=function(o){return arguments.length?(i=o??ja,a):i},a}function NO(e,n){if((s=e.length)>0){for(var i,s,a=0,o=e[0].length,l;a<o;++a){for(l=i=0;i<s;++i)l+=e[i][a][1]||0;if(l)for(i=0;i<s;++i)e[i][a][1]/=l}ja(e,n)}}function _O(e,n){if((a=e.length)>0){for(var i=0,s=e[n[0]],a,o=s.length;i<o;++i){for(var l=0,c=0;l<a;++l)c+=e[l][i][1]||0;s[i][1]+=s[i][0]=-c/2}ja(e,n)}}function CO(e,n){if(!(!((l=e.length)>0)||!((o=(a=e[n[0]]).length)>0))){for(var i=0,s=1,a,o,l;s<o;++s){for(var c=0,d=0,u=0;c<l;++c){for(var f=e[n[c]],h=f[s][1]||0,m=f[s-1][1]||0,g=(h-m)/2,b=0;b<c;++b){var j=e[n[b]],y=j[s][1]||0,x=j[s-1][1]||0;g+=y-x}d+=h,u+=g*h}a[s-1][1]+=a[s-1][0]=i,d&&(i-=u/d)}a[s-1][1]+=a[s-1][0]=i,ja(e,n)}}var Pd={},uj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){return i==="__proto__"}e.isUnsafeProperty=n})(uj);var Rp={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){switch(typeof i){case"number":case"symbol":return!1;case"string":return i.includes(".")||i.includes("[")||i.includes("]")}}e.isDeepKey=n})(Rp);var Od={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){var s;return typeof i=="string"||typeof i=="symbol"?i:Object.is((s=i==null?void 0:i.valueOf)==null?void 0:s.call(i),-0)?"-0":String(i)}e.toKey=n})(Od);var Dd={},fj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){if(i==null)return"";if(typeof i=="string")return i;if(Array.isArray(i))return i.map(n).join(",");const s=String(i);return s==="0"&&Object.is(Number(i),-0)?"-0":s}e.toString=n})(fj);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=fj,i=Od;function s(a){if(Array.isArray(a))return a.map(i.toKey);if(typeof a=="symbol")return[a];a=n.toString(a);const o=[],l=a.length;if(l===0)return o;let c=0,d="",u="",f=!1;for(a.charCodeAt(0)===46&&(o.push(""),c++);c<l;){const h=a[c];u?h==="\\"&&c+1<l?(c++,d+=a[c]):h===u?u="":d+=h:f?h==='"'||h==="'"?u=h:h==="]"?(f=!1,o.push(d),d=""):d+=h:h==="["?(f=!0,d&&(o.push(d),d="")):h==="."?d&&(o.push(d),d=""):d+=h,c++}return d&&o.push(d),o}e.toPath=s})(Dd);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=uj,i=Rp,s=Od,a=Dd;function o(c,d,u){if(c==null)return u;switch(typeof d){case"string":{if(n.isUnsafeProperty(d))return u;const f=c[d];return f===void 0?i.isDeepKey(d)?o(c,a.toPath(d),u):u:f}case"number":case"symbol":{typeof d=="number"&&(d=s.toKey(d));const f=c[d];return f===void 0?u:f}default:{if(Array.isArray(d))return l(c,d,u);if(Object.is(d==null?void 0:d.valueOf(),-0)?d="-0":d=String(d),n.isUnsafeProperty(d))return u;const f=c[d];return f===void 0?u:f}}}function l(c,d,u){if(d.length===0)return u;let f=c;for(let h=0;h<d.length;h++){if(f==null||n.isUnsafeProperty(d[h]))return u;f=f[d[h]]}return f===void 0?u:f}e.get=o})(Pd);var AO=Pd.get;const Ms=Wi(AO);var Cn=e=>e===0?0:e>0?1:-1,Ur=e=>typeof e=="number"&&e!=+e,Mi=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Qe=e=>(typeof e=="number"||e instanceof Number)&&!Ur(e),si=e=>Qe(e)||typeof e=="string",IO=0,Oo=e=>{var n=++IO;return"".concat(e||"").concat(n)},Bn=function(n,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Qe(n)&&typeof n!="string")return s;var o;if(Mi(n)){if(i==null)return s;var l=n.indexOf("%");o=i*parseFloat(n.slice(0,l))/100}else o=+n;return Ur(o)&&(o=s),a&&i!=null&&o>i&&(o=i),o},hj=e=>{if(!Array.isArray(e))return!1;for(var n=e.length,i={},s=0;s<n;s++)if(!i[e[s]])i[e[s]]=!0;else return!0;return!1};function Vt(e,n,i){return Qe(e)&&Qe(n)?e+i*(n-e):n}function pj(e,n,i){if(!(!e||!e.length))return e.find(s=>s&&(typeof n=="function"?n(s):Ms(s,n))===i)}var Zt=e=>e===null||typeof e>"u",Jo=e=>Zt(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function TO(e){return e!=null}function Hs(){}var EO=["type","size","sizeType"];function ih(){return ih=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},ih.apply(null,arguments)}function gx(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function yx(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?gx(Object(i),!0).forEach(function(s){PO(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):gx(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function PO(e,n,i){return(n=OO(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function OO(e){var n=DO(e,"string");return typeof n=="symbol"?n:n+""}function DO(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function zO(e,n){if(e==null)return{};var i,s,a=MO(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function MO(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var mj={symbolCircle:Mp,symbolCross:eO,symbolDiamond:nO,symbolSquare:rO,symbolStar:oO,symbolTriangle:lO,symbolWye:dO},RO=Math.PI/180,$O=e=>{var n="symbol".concat(Jo(e));return mj[n]||Mp},LO=(e,n,i)=>{if(n==="area")return e;switch(i){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var s=18*RO;return 1.25*e*e*(Math.tan(s)-Math.tan(s*2)*Math.tan(s)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},WO=(e,n)=>{mj["symbol".concat(Jo(e))]=n},gj=e=>{var{type:n="circle",size:i=64,sizeType:s="area"}=e,a=zO(e,EO),o=yx(yx({},a),{},{type:n,size:i,sizeType:s}),l="circle";typeof n=="string"&&(l=n);var c=()=>{var m=$O(l),g=uO().type(m).size(LO(i,s,l)),b=g();if(b!==null)return b},{className:d,cx:u,cy:f}=o,h=Qn(o);return Qe(u)&&Qe(f)&&Qe(i)?p.createElement("path",ih({},h,{className:_t("recharts-symbols",d),transform:"translate(".concat(u,", ").concat(f,")"),d:c()})):null};gj.registerSymbol=WO;var yj=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,$p=(e,n)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var i=e;if(p.isValidElement(e)&&(i=e.props),typeof i!="object"&&typeof i!="function")return null;var s={};return Object.keys(i).forEach(a=>{Op(a)&&(s[a]=o=>i[a](i,o))}),s},BO=(e,n,i)=>s=>(e(n,i,s),null),zd=(e,n,i)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var s=null;return Object.keys(e).forEach(a=>{var o=e[a];Op(a)&&typeof o=="function"&&(s||(s={}),s[a]=BO(o,n,i))}),s};function xx(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function FO(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?xx(Object(i),!0).forEach(function(s){qO(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):xx(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function qO(e,n,i){return(n=UO(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function UO(e){var n=HO(e,"string");return typeof n=="symbol"?n:n+""}function HO(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Tn(e,n){var i=FO({},e),s=n,a=Object.keys(n),o=a.reduce((l,c)=>(l[c]===void 0&&s[c]!==void 0&&(l[c]=s[c]),l),i);return o}var xj={},vj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i,s){const a=new Map;for(let o=0;o<i.length;o++){const l=i[o],c=s(l);a.has(c)||a.set(c,l)}return Array.from(a.values())}e.uniqBy=n})(vj);var Lp={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){return i}e.identity=n})(Lp);var bj={},Md={},jj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){return Number.isSafeInteger(i)&&i>=0}e.isLength=n})(jj);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=jj;function i(s){return s!=null&&typeof s!="function"&&n.isLength(s.length)}e.isArrayLike=i})(Md);var wj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){return typeof i=="object"&&i!==null}e.isObjectLike=n})(wj);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Md,i=wj;function s(a){return i.isObjectLike(a)&&n.isArrayLike(a)}e.isArrayLikeObject=s})(bj);var Sj={},kj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Pd;function i(s){return function(a){return n.get(a,s)}}e.property=i})(kj);var Nj={},Wp={},_j={},Bp={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){return i!==null&&(typeof i=="object"||typeof i=="function")}e.isObject=n})(Bp);var Fp={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){return i==null||typeof i!="object"&&typeof i!="function"}e.isPrimitive=n})(Fp);var qp={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i,s){return i===s||Number.isNaN(i)&&Number.isNaN(s)}e.eq=n})(qp);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Bp,i=Fp,s=qp;function a(f,h,m){return typeof m!="function"?a(f,h,()=>{}):o(f,h,function g(b,j,y,x,v,A){const N=m(b,j,y,x,v,A);return N!==void 0?!!N:o(b,j,g,A)},new Map)}function o(f,h,m,g){if(h===f)return!0;switch(typeof h){case"object":return l(f,h,m,g);case"function":return Object.keys(h).length>0?o(f,{...h},m,g):s.eq(f,h);default:return n.isObject(f)?typeof h=="string"?h==="":!0:s.eq(f,h)}}function l(f,h,m,g){if(h==null)return!0;if(Array.isArray(h))return d(f,h,m,g);if(h instanceof Map)return c(f,h,m,g);if(h instanceof Set)return u(f,h,m,g);const b=Object.keys(h);if(f==null)return b.length===0;if(b.length===0)return!0;if(g!=null&&g.has(h))return g.get(h)===f;g==null||g.set(h,f);try{for(let j=0;j<b.length;j++){const y=b[j];if(!i.isPrimitive(f)&&!(y in f)||h[y]===void 0&&f[y]!==void 0||h[y]===null&&f[y]!==null||!m(f[y],h[y],y,f,h,g))return!1}return!0}finally{g==null||g.delete(h)}}function c(f,h,m,g){if(h.size===0)return!0;if(!(f instanceof Map))return!1;for(const[b,j]of h.entries()){const y=f.get(b);if(m(y,j,b,f,h,g)===!1)return!1}return!0}function d(f,h,m,g){if(h.length===0)return!0;if(!Array.isArray(f))return!1;const b=new Set;for(let j=0;j<h.length;j++){const y=h[j];let x=!1;for(let v=0;v<f.length;v++){if(b.has(v))continue;const A=f[v];let N=!1;if(m(A,y,j,f,h,g)&&(N=!0),N){b.add(v),x=!0;break}}if(!x)return!1}return!0}function u(f,h,m,g){return h.size===0?!0:f instanceof Set?d([...f],[...h],m,g):!1}e.isMatchWith=a,e.isSetMatch=u})(_j);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=_j;function i(s,a){return n.isMatchWith(s,a,()=>{})}e.isMatch=i})(Wp);var Cj={},Up={},Aj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){return Object.getOwnPropertySymbols(i).filter(s=>Object.prototype.propertyIsEnumerable.call(i,s))}e.getSymbols=n})(Aj);var Hp={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){return i==null?i===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(i)}e.getTag=n})(Hp);var Yp={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n="[object RegExp]",i="[object String]",s="[object Number]",a="[object Boolean]",o="[object Arguments]",l="[object Symbol]",c="[object Date]",d="[object Map]",u="[object Set]",f="[object Array]",h="[object Function]",m="[object ArrayBuffer]",g="[object Object]",b="[object Error]",j="[object DataView]",y="[object Uint8Array]",x="[object Uint8ClampedArray]",v="[object Uint16Array]",A="[object Uint32Array]",N="[object BigUint64Array]",C="[object Int8Array]",w="[object Int16Array]",_="[object Int32Array]",I="[object BigInt64Array]",O="[object Float32Array]",E="[object Float64Array]";e.argumentsTag=o,e.arrayBufferTag=m,e.arrayTag=f,e.bigInt64ArrayTag=I,e.bigUint64ArrayTag=N,e.booleanTag=a,e.dataViewTag=j,e.dateTag=c,e.errorTag=b,e.float32ArrayTag=O,e.float64ArrayTag=E,e.functionTag=h,e.int16ArrayTag=w,e.int32ArrayTag=_,e.int8ArrayTag=C,e.mapTag=d,e.numberTag=s,e.objectTag=g,e.regexpTag=n,e.setTag=u,e.stringTag=i,e.symbolTag=l,e.uint16ArrayTag=v,e.uint32ArrayTag=A,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=x})(Yp);var Ij={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){return ArrayBuffer.isView(i)&&!(i instanceof DataView)}e.isTypedArray=n})(Ij);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Aj,i=Hp,s=Yp,a=Fp,o=Ij;function l(f,h){return c(f,void 0,f,new Map,h)}function c(f,h,m,g=new Map,b=void 0){const j=b==null?void 0:b(f,h,m,g);if(j!==void 0)return j;if(a.isPrimitive(f))return f;if(g.has(f))return g.get(f);if(Array.isArray(f)){const y=new Array(f.length);g.set(f,y);for(let x=0;x<f.length;x++)y[x]=c(f[x],x,m,g,b);return Object.hasOwn(f,"index")&&(y.index=f.index),Object.hasOwn(f,"input")&&(y.input=f.input),y}if(f instanceof Date)return new Date(f.getTime());if(f instanceof RegExp){const y=new RegExp(f.source,f.flags);return y.lastIndex=f.lastIndex,y}if(f instanceof Map){const y=new Map;g.set(f,y);for(const[x,v]of f)y.set(x,c(v,x,m,g,b));return y}if(f instanceof Set){const y=new Set;g.set(f,y);for(const x of f)y.add(c(x,void 0,m,g,b));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(f))return f.subarray();if(o.isTypedArray(f)){const y=new(Object.getPrototypeOf(f)).constructor(f.length);g.set(f,y);for(let x=0;x<f.length;x++)y[x]=c(f[x],x,m,g,b);return y}if(f instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&f instanceof SharedArrayBuffer)return f.slice(0);if(f instanceof DataView){const y=new DataView(f.buffer.slice(0),f.byteOffset,f.byteLength);return g.set(f,y),d(y,f,m,g,b),y}if(typeof File<"u"&&f instanceof File){const y=new File([f],f.name,{type:f.type});return g.set(f,y),d(y,f,m,g,b),y}if(typeof Blob<"u"&&f instanceof Blob){const y=new Blob([f],{type:f.type});return g.set(f,y),d(y,f,m,g,b),y}if(f instanceof Error){const y=new f.constructor;return g.set(f,y),y.message=f.message,y.name=f.name,y.stack=f.stack,y.cause=f.cause,d(y,f,m,g,b),y}if(f instanceof Boolean){const y=new Boolean(f.valueOf());return g.set(f,y),d(y,f,m,g,b),y}if(f instanceof Number){const y=new Number(f.valueOf());return g.set(f,y),d(y,f,m,g,b),y}if(f instanceof String){const y=new String(f.valueOf());return g.set(f,y),d(y,f,m,g,b),y}if(typeof f=="object"&&u(f)){const y=Object.create(Object.getPrototypeOf(f));return g.set(f,y),d(y,f,m,g,b),y}return f}function d(f,h,m=f,g,b){const j=[...Object.keys(h),...n.getSymbols(h)];for(let y=0;y<j.length;y++){const x=j[y],v=Object.getOwnPropertyDescriptor(f,x);(v==null||v.writable)&&(f[x]=c(h[x],x,m,g,b))}}function u(f){switch(i.getTag(f)){case s.argumentsTag:case s.arrayTag:case s.arrayBufferTag:case s.dataViewTag:case s.booleanTag:case s.dateTag:case s.float32ArrayTag:case s.float64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.mapTag:case s.numberTag:case s.objectTag:case s.regexpTag:case s.setTag:case s.stringTag:case s.symbolTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=l,e.cloneDeepWithImpl=c,e.copyProperties=d})(Up);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Up;function i(s){return n.cloneDeepWithImpl(s,void 0,s,new Map,void 0)}e.cloneDeep=i})(Cj);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Wp,i=Cj;function s(a){return a=i.cloneDeep(a),o=>n.isMatch(o,a)}e.matches=s})(Nj);var Tj={},Ej={},Pj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Up,i=Yp;function s(a,o){return n.cloneDeepWith(a,(l,c,d,u)=>{const f=o==null?void 0:o(l,c,d,u);if(f!==void 0)return f;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case i.numberTag:case i.stringTag:case i.booleanTag:{const h=new a.constructor(a==null?void 0:a.valueOf());return n.copyProperties(h,a),h}case i.argumentsTag:{const h={};return n.copyProperties(h,a),h.length=a.length,h[Symbol.iterator]=a[Symbol.iterator],h}default:return}})}e.cloneDeepWith=s})(Pj);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Pj;function i(s){return n.cloneDeepWith(s)}e.cloneDeep=i})(Ej);var Oj={},Kp={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=/^(?:0|[1-9]\d*)$/;function i(s,a=Number.MAX_SAFE_INTEGER){switch(typeof s){case"number":return Number.isInteger(s)&&s>=0&&s<a;case"symbol":return!1;case"string":return n.test(s)}}e.isIndex=i})(Kp);var Dj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Hp;function i(s){return s!==null&&typeof s=="object"&&n.getTag(s)==="[object Arguments]"}e.isArguments=i})(Dj);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Rp,i=Kp,s=Dj,a=Dd;function o(l,c){let d;if(Array.isArray(c)?d=c:typeof c=="string"&&n.isDeepKey(c)&&(l==null?void 0:l[c])==null?d=a.toPath(c):d=[c],d.length===0)return!1;let u=l;for(let f=0;f<d.length;f++){const h=d[f];if((u==null||!Object.hasOwn(u,h))&&!((Array.isArray(u)||s.isArguments(u))&&i.isIndex(h)&&h<u.length))return!1;u=u[h]}return!0}e.has=o})(Oj);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Wp,i=Od,s=Ej,a=Pd,o=Oj;function l(c,d){switch(typeof c){case"object":{Object.is(c==null?void 0:c.valueOf(),-0)&&(c="-0");break}case"number":{c=i.toKey(c);break}}return d=s.cloneDeep(d),function(u){const f=a.get(u,c);return f===void 0?o.has(u,c):d===void 0?f===void 0:n.isMatch(f,d)}}e.matchesProperty=l})(Tj);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Lp,i=kj,s=Nj,a=Tj;function o(l){if(l==null)return n.identity;switch(typeof l){case"function":return l;case"object":return Array.isArray(l)&&l.length===2?a.matchesProperty(l[0],l[1]):s.matches(l);case"string":case"symbol":case"number":return i.property(l)}}e.iteratee=o})(Sj);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=vj,i=Lp,s=bj,a=Sj;function o(l,c=i.identity){return s.isArrayLikeObject(l)?n.uniqBy(Array.from(l),a.iteratee(c)):[]}e.uniqBy=o})(xj);var YO=xj.uniqBy;const vx=Wi(YO);function KO(e,n,i){return n===!0?vx(e,i):typeof n=="function"?vx(e,n):e}var zj={exports:{}},Mj={},Rj={exports:{}},$j={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wa=p;function GO(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var VO=typeof Object.is=="function"?Object.is:GO,XO=wa.useState,QO=wa.useEffect,JO=wa.useLayoutEffect,ZO=wa.useDebugValue;function eD(e,n){var i=n(),s=XO({inst:{value:i,getSnapshot:n}}),a=s[0].inst,o=s[1];return JO(function(){a.value=i,a.getSnapshot=n,Zu(a)&&o({inst:a})},[e,i,n]),QO(function(){return Zu(a)&&o({inst:a}),e(function(){Zu(a)&&o({inst:a})})},[e]),ZO(i),i}function Zu(e){var n=e.getSnapshot;e=e.value;try{var i=n();return!VO(e,i)}catch{return!0}}function tD(e,n){return n()}var nD=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?tD:eD;$j.useSyncExternalStore=wa.useSyncExternalStore!==void 0?wa.useSyncExternalStore:nD;Rj.exports=$j;var rD=Rj.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rd=p,iD=rD;function sD(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var aD=typeof Object.is=="function"?Object.is:sD,oD=iD.useSyncExternalStore,lD=Rd.useRef,cD=Rd.useEffect,dD=Rd.useMemo,uD=Rd.useDebugValue;Mj.useSyncExternalStoreWithSelector=function(e,n,i,s,a){var o=lD(null);if(o.current===null){var l={hasValue:!1,value:null};o.current=l}else l=o.current;o=dD(function(){function d(g){if(!u){if(u=!0,f=g,g=s(g),a!==void 0&&l.hasValue){var b=l.value;if(a(b,g))return h=b}return h=g}if(b=h,aD(f,g))return b;var j=s(g);return a!==void 0&&a(b,j)?(f=g,b):(f=g,h=j)}var u=!1,f,h,m=i===void 0?null:i;return[function(){return d(n())},m===null?void 0:function(){return d(m())}]},[n,i,s,a]);var c=oD(e,o[0],o[1]);return cD(function(){l.hasValue=!0,l.value=c},[c]),uD(c),c};zj.exports=Mj;var fD=zj.exports,Gp=p.createContext(null),hD=e=>e,en=()=>{var e=p.useContext(Gp);return e?e.store.dispatch:hD},oc=()=>{},pD=()=>oc,mD=(e,n)=>e===n;function Je(e){var n=p.useContext(Gp);return fD.useSyncExternalStoreWithSelector(n?n.subscription.addNestedSub:pD,n?n.store.getState:oc,n?n.store.getState:oc,n?e:oc,mD)}function gD(e,n=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(n)}function yD(e,n=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(n)}function xD(e,n="expected all items to be functions, instead received the following types: "){if(!e.every(i=>typeof i=="function")){const i=e.map(s=>typeof s=="function"?`function ${s.name||"unnamed"}()`:typeof s).join(", ");throw new TypeError(`${n}[${i}]`)}}var bx=e=>Array.isArray(e)?e:[e];function vD(e){const n=Array.isArray(e[0])?e[0]:e;return xD(n,"createSelector expects all input-selectors to be functions, but received the following types: "),n}function bD(e,n){const i=[],{length:s}=e;for(let a=0;a<s;a++)i.push(e[a].apply(null,n));return i}var jD=class{constructor(e){this.value=e}deref(){return this.value}},wD=typeof WeakRef<"u"?WeakRef:jD,SD=0,jx=1;function Ol(){return{s:SD,v:void 0,o:null,p:null}}function Lj(e,n={}){let i=Ol();const{resultEqualityCheck:s}=n;let a,o=0;function l(){var h;let c=i;const{length:d}=arguments;for(let m=0,g=d;m<g;m++){const b=arguments[m];if(typeof b=="function"||typeof b=="object"&&b!==null){let j=c.o;j===null&&(c.o=j=new WeakMap);const y=j.get(b);y===void 0?(c=Ol(),j.set(b,c)):c=y}else{let j=c.p;j===null&&(c.p=j=new Map);const y=j.get(b);y===void 0?(c=Ol(),j.set(b,c)):c=y}}const u=c;let f;if(c.s===jx)f=c.v;else if(f=e.apply(null,arguments),o++,s){const m=((h=a==null?void 0:a.deref)==null?void 0:h.call(a))??a;m!=null&&s(m,f)&&(f=m,o!==0&&o--),a=typeof f=="object"&&f!==null||typeof f=="function"?new wD(f):f}return u.s=jx,u.v=f,f}return l.clearCache=()=>{i=Ol(),l.resetResultsCount()},l.resultsCount=()=>o,l.resetResultsCount=()=>{o=0},l}function kD(e,...n){const i=typeof e=="function"?{memoize:e,memoizeOptions:n}:e,s=(...a)=>{let o=0,l=0,c,d={},u=a.pop();typeof u=="object"&&(d=u,u=a.pop()),gD(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const f={...i,...d},{memoize:h,memoizeOptions:m=[],argsMemoize:g=Lj,argsMemoizeOptions:b=[]}=f,j=bx(m),y=bx(b),x=vD(a),v=h(function(){return o++,u.apply(null,arguments)},...j),A=g(function(){l++;const C=bD(x,arguments);return c=v.apply(null,C),c},...y);return Object.assign(A,{resultFunc:u,memoizedResultFunc:v,dependencies:x,dependencyRecomputations:()=>l,resetDependencyRecomputations:()=>{l=0},lastResult:()=>c,recomputations:()=>o,resetRecomputations:()=>{o=0},memoize:h,argsMemoize:g})};return Object.assign(s,{withTypes:()=>s}),s}var Ie=kD(Lj),ND=Object.assign((e,n=Ie)=>{yD(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const i=Object.keys(e),s=i.map(o=>e[o]);return n(s,(...o)=>o.reduce((l,c,d)=>(l[i[d]]=c,l),{}))},{withTypes:()=>ND}),Wj={},Bj={},Fj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(s){return typeof s=="symbol"?1:s===null?2:s===void 0?3:s!==s?4:0}const i=(s,a,o)=>{if(s!==a){const l=n(s),c=n(a);if(l===c&&l===0){if(s<a)return o==="desc"?1:-1;if(s>a)return o==="desc"?-1:1}return o==="desc"?c-l:l-c}return 0};e.compareValues=i})(Fj);var qj={},Vp={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){return typeof i=="symbol"||i instanceof Symbol}e.isSymbol=n})(Vp);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Vp,i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;function a(o,l){return Array.isArray(o)?!1:typeof o=="number"||typeof o=="boolean"||o==null||n.isSymbol(o)?!0:typeof o=="string"&&(s.test(o)||!i.test(o))||l!=null&&Object.hasOwn(l,o)}e.isKey=a})(qj);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Fj,i=qj,s=Dd;function a(o,l,c,d){if(o==null)return[];c=d?void 0:c,Array.isArray(o)||(o=Object.values(o)),Array.isArray(l)||(l=l==null?[null]:[l]),l.length===0&&(l=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(g=>String(g));const u=(g,b)=>{let j=g;for(let y=0;y<b.length&&j!=null;++y)j=j[b[y]];return j},f=(g,b)=>b==null||g==null?b:typeof g=="object"&&"key"in g?Object.hasOwn(b,g.key)?b[g.key]:u(b,g.path):typeof g=="function"?g(b):Array.isArray(g)?u(b,g):typeof b=="object"?b[g]:b,h=l.map(g=>(Array.isArray(g)&&g.length===1&&(g=g[0]),g==null||typeof g=="function"||Array.isArray(g)||i.isKey(g)?g:{key:g,path:s.toPath(g)}));return o.map(g=>({original:g,criteria:h.map(b=>f(b,g))})).slice().sort((g,b)=>{for(let j=0;j<h.length;j++){const y=n.compareValues(g.criteria[j],b.criteria[j],c[j]);if(y!==0)return y}return 0}).map(g=>g.original)}e.orderBy=a})(Bj);var Uj={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i,s=1){const a=[],o=Math.floor(s),l=(c,d)=>{for(let u=0;u<c.length;u++){const f=c[u];Array.isArray(f)&&d<o?l(f,d+1):a.push(f)}};return l(i,0),a}e.flatten=n})(Uj);var Xp={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Kp,i=Md,s=Bp,a=qp;function o(l,c,d){return s.isObject(d)&&(typeof c=="number"&&i.isArrayLike(d)&&n.isIndex(c)&&c<d.length||typeof c=="string"&&c in d)?a.eq(d[c],l):!1}e.isIterateeCall=o})(Xp);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Bj,i=Uj,s=Xp;function a(o,...l){const c=l.length;return c>1&&s.isIterateeCall(o,l[0],l[1])?l=[]:c>2&&s.isIterateeCall(l[0],l[1],l[2])&&(l=[l[0]]),n.orderBy(o,i.flatten(l),["asc"])}e.sortBy=a})(Wj);var _D=Wj.sortBy;const $d=Wi(_D);var Hj=e=>e.legend.settings,CD=e=>e.legend.size,AD=e=>e.legend.payload;Ie([AD,Hj],(e,n)=>{var{itemSorter:i}=n,s=e.flat(1);return i?$d(s,i):s});var Dl=1;function ID(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[n,i]=p.useState({height:0,left:0,top:0,width:0}),s=p.useCallback(a=>{if(a!=null){var o=a.getBoundingClientRect(),l={height:o.height,left:o.left,top:o.top,width:o.width};(Math.abs(l.height-n.height)>Dl||Math.abs(l.left-n.left)>Dl||Math.abs(l.top-n.top)>Dl||Math.abs(l.width-n.width)>Dl)&&i({height:l.height,left:l.left,top:l.top,width:l.width})}},[n.width,n.height,n.top,n.left,...e]);return[n,s]}function Pn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var TD=typeof Symbol=="function"&&Symbol.observable||"@@observable",wx=TD,ef=()=>Math.random().toString(36).substring(7).split("").join("."),ED={INIT:`@@redux/INIT${ef()}`,REPLACE:`@@redux/REPLACE${ef()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${ef()}`},$c=ED;function Qp(e){if(typeof e!="object"||e===null)return!1;let n=e;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(e)===n||Object.getPrototypeOf(e)===null}function Yj(e,n,i){if(typeof e!="function")throw new Error(Pn(2));if(typeof n=="function"&&typeof i=="function"||typeof i=="function"&&typeof arguments[3]=="function")throw new Error(Pn(0));if(typeof n=="function"&&typeof i>"u"&&(i=n,n=void 0),typeof i<"u"){if(typeof i!="function")throw new Error(Pn(1));return i(Yj)(e,n)}let s=e,a=n,o=new Map,l=o,c=0,d=!1;function u(){l===o&&(l=new Map,o.forEach((y,x)=>{l.set(x,y)}))}function f(){if(d)throw new Error(Pn(3));return a}function h(y){if(typeof y!="function")throw new Error(Pn(4));if(d)throw new Error(Pn(5));let x=!0;u();const v=c++;return l.set(v,y),function(){if(x){if(d)throw new Error(Pn(6));x=!1,u(),l.delete(v),o=null}}}function m(y){if(!Qp(y))throw new Error(Pn(7));if(typeof y.type>"u")throw new Error(Pn(8));if(typeof y.type!="string")throw new Error(Pn(17));if(d)throw new Error(Pn(9));try{d=!0,a=s(a,y)}finally{d=!1}return(o=l).forEach(v=>{v()}),y}function g(y){if(typeof y!="function")throw new Error(Pn(10));s=y,m({type:$c.REPLACE})}function b(){const y=h;return{subscribe(x){if(typeof x!="object"||x===null)throw new Error(Pn(11));function v(){const N=x;N.next&&N.next(f())}return v(),{unsubscribe:y(v)}},[wx](){return this}}}return m({type:$c.INIT}),{dispatch:m,subscribe:h,getState:f,replaceReducer:g,[wx]:b}}function PD(e){Object.keys(e).forEach(n=>{const i=e[n];if(typeof i(void 0,{type:$c.INIT})>"u")throw new Error(Pn(12));if(typeof i(void 0,{type:$c.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Pn(13))})}function Kj(e){const n=Object.keys(e),i={};for(let o=0;o<n.length;o++){const l=n[o];typeof e[l]=="function"&&(i[l]=e[l])}const s=Object.keys(i);let a;try{PD(i)}catch(o){a=o}return function(l={},c){if(a)throw a;let d=!1;const u={};for(let f=0;f<s.length;f++){const h=s[f],m=i[h],g=l[h],b=m(g,c);if(typeof b>"u")throw c&&c.type,new Error(Pn(14));u[h]=b,d=d||b!==g}return d=d||s.length!==Object.keys(l).length,d?u:l}}function Lc(...e){return e.length===0?n=>n:e.length===1?e[0]:e.reduce((n,i)=>(...s)=>n(i(...s)))}function OD(...e){return n=>(i,s)=>{const a=n(i,s);let o=()=>{throw new Error(Pn(15))};const l={getState:a.getState,dispatch:(d,...u)=>o(d,...u)},c=e.map(d=>d(l));return o=Lc(...c)(a.dispatch),{...a,dispatch:o}}}function Gj(e){return Qp(e)&&"type"in e&&typeof e.type=="string"}var Vj=Symbol.for("immer-nothing"),Sx=Symbol.for("immer-draftable"),xr=Symbol.for("immer-state");function Br(e,...n){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Do=Object.getPrototypeOf;function Rs(e){return!!e&&!!e[xr]}function Ri(e){var n;return e?Xj(e)||Array.isArray(e)||!!e[Sx]||!!((n=e.constructor)!=null&&n[Sx])||Zo(e)||Wd(e):!1}var DD=Object.prototype.constructor.toString(),kx=new WeakMap;function Xj(e){if(!e||typeof e!="object")return!1;const n=Object.getPrototypeOf(e);if(n===null||n===Object.prototype)return!0;const i=Object.hasOwnProperty.call(n,"constructor")&&n.constructor;if(i===Object)return!0;if(typeof i!="function")return!1;let s=kx.get(i);return s===void 0&&(s=Function.toString.call(i),kx.set(i,s)),s===DD}function Wc(e,n,i=!0){Ld(e)===0?(i?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{n(a,e[a],e)}):e.forEach((s,a)=>n(a,s,e))}function Ld(e){const n=e[xr];return n?n.type_:Array.isArray(e)?1:Zo(e)?2:Wd(e)?3:0}function sh(e,n){return Ld(e)===2?e.has(n):Object.prototype.hasOwnProperty.call(e,n)}function Qj(e,n,i){const s=Ld(e);s===2?e.set(n,i):s===3?e.add(i):e[n]=i}function zD(e,n){return e===n?e!==0||1/e===1/n:e!==e&&n!==n}function Zo(e){return e instanceof Map}function Wd(e){return e instanceof Set}function vs(e){return e.copy_||e.base_}function ah(e,n){if(Zo(e))return new Map(e);if(Wd(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const i=Xj(e);if(n===!0||n==="class_only"&&!i){const s=Object.getOwnPropertyDescriptors(e);delete s[xr];let a=Reflect.ownKeys(s);for(let o=0;o<a.length;o++){const l=a[o],c=s[l];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(s[l]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[l]})}return Object.create(Do(e),s)}else{const s=Do(e);if(s!==null&&i)return{...e};const a=Object.create(s);return Object.assign(a,e)}}function Jp(e,n=!1){return Bd(e)||Rs(e)||!Ri(e)||(Ld(e)>1&&Object.defineProperties(e,{set:zl,add:zl,clear:zl,delete:zl}),Object.freeze(e),n&&Object.values(e).forEach(i=>Jp(i,!0))),e}function MD(){Br(2)}var zl={value:MD};function Bd(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var RD={};function $s(e){const n=RD[e];return n||Br(0,e),n}var zo;function Jj(){return zo}function $D(e,n){return{drafts_:[],parent_:e,immer_:n,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Nx(e,n){n&&($s("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=n)}function oh(e){lh(e),e.drafts_.forEach(LD),e.drafts_=null}function lh(e){e===zo&&(zo=e.parent_)}function _x(e){return zo=$D(zo,e)}function LD(e){const n=e[xr];n.type_===0||n.type_===1?n.revoke_():n.revoked_=!0}function Cx(e,n){n.unfinalizedDrafts_=n.drafts_.length;const i=n.drafts_[0];return e!==void 0&&e!==i?(i[xr].modified_&&(oh(n),Br(4)),Ri(e)&&(e=Bc(n,e),n.parent_||Fc(n,e)),n.patches_&&$s("Patches").generateReplacementPatches_(i[xr].base_,e,n.patches_,n.inversePatches_)):e=Bc(n,i,[]),oh(n),n.patches_&&n.patchListener_(n.patches_,n.inversePatches_),e!==Vj?e:void 0}function Bc(e,n,i){if(Bd(n))return n;const s=e.immer_.shouldUseStrictIteration(),a=n[xr];if(!a)return Wc(n,(o,l)=>Ax(e,a,n,o,l,i),s),n;if(a.scope_!==e)return n;if(!a.modified_)return Fc(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const o=a.copy_;let l=o,c=!1;a.type_===3&&(l=new Set(o),o.clear(),c=!0),Wc(l,(d,u)=>Ax(e,a,o,d,u,i,c),s),Fc(e,o,!1),i&&e.patches_&&$s("Patches").generatePatches_(a,i,e.patches_,e.inversePatches_)}return a.copy_}function Ax(e,n,i,s,a,o,l){if(a==null||typeof a!="object"&&!l)return;const c=Bd(a);if(!(c&&!l)){if(Rs(a)){const d=o&&n&&n.type_!==3&&!sh(n.assigned_,s)?o.concat(s):void 0,u=Bc(e,a,d);if(Qj(i,s,u),Rs(u))e.canAutoFreeze_=!1;else return}else l&&i.add(a);if(Ri(a)&&!c){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||n&&n.base_&&n.base_[s]===a&&c)return;Bc(e,a),(!n||!n.scope_.parent_)&&typeof s!="symbol"&&(Zo(i)?i.has(s):Object.prototype.propertyIsEnumerable.call(i,s))&&Fc(e,a)}}}function Fc(e,n,i=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Jp(n,i)}function WD(e,n){const i=Array.isArray(e),s={type_:i?1:0,scope_:n?n.scope_:Jj(),modified_:!1,finalized_:!1,assigned_:{},parent_:n,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=s,o=Zp;i&&(a=[s],o=Mo);const{revoke:l,proxy:c}=Proxy.revocable(a,o);return s.draft_=c,s.revoke_=l,c}var Zp={get(e,n){if(n===xr)return e;const i=vs(e);if(!sh(i,n))return BD(e,i,n);const s=i[n];return e.finalized_||!Ri(s)?s:s===tf(e.base_,n)?(nf(e),e.copy_[n]=dh(s,e)):s},has(e,n){return n in vs(e)},ownKeys(e){return Reflect.ownKeys(vs(e))},set(e,n,i){const s=Zj(vs(e),n);if(s!=null&&s.set)return s.set.call(e.draft_,i),!0;if(!e.modified_){const a=tf(vs(e),n),o=a==null?void 0:a[xr];if(o&&o.base_===i)return e.copy_[n]=i,e.assigned_[n]=!1,!0;if(zD(i,a)&&(i!==void 0||sh(e.base_,n)))return!0;nf(e),ch(e)}return e.copy_[n]===i&&(i!==void 0||n in e.copy_)||Number.isNaN(i)&&Number.isNaN(e.copy_[n])||(e.copy_[n]=i,e.assigned_[n]=!0),!0},deleteProperty(e,n){return tf(e.base_,n)!==void 0||n in e.base_?(e.assigned_[n]=!1,nf(e),ch(e)):delete e.assigned_[n],e.copy_&&delete e.copy_[n],!0},getOwnPropertyDescriptor(e,n){const i=vs(e),s=Reflect.getOwnPropertyDescriptor(i,n);return s&&{writable:!0,configurable:e.type_!==1||n!=="length",enumerable:s.enumerable,value:i[n]}},defineProperty(){Br(11)},getPrototypeOf(e){return Do(e.base_)},setPrototypeOf(){Br(12)}},Mo={};Wc(Zp,(e,n)=>{Mo[e]=function(){return arguments[0]=arguments[0][0],n.apply(this,arguments)}});Mo.deleteProperty=function(e,n){return Mo.set.call(this,e,n,void 0)};Mo.set=function(e,n,i){return Zp.set.call(this,e[0],n,i,e[0])};function tf(e,n){const i=e[xr];return(i?vs(i):e)[n]}function BD(e,n,i){var a;const s=Zj(n,i);return s?"value"in s?s.value:(a=s.get)==null?void 0:a.call(e.draft_):void 0}function Zj(e,n){if(!(n in e))return;let i=Do(e);for(;i;){const s=Object.getOwnPropertyDescriptor(i,n);if(s)return s;i=Do(i)}}function ch(e){e.modified_||(e.modified_=!0,e.parent_&&ch(e.parent_))}function nf(e){e.copy_||(e.copy_=ah(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var FD=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(n,i,s)=>{if(typeof n=="function"&&typeof i!="function"){const o=i;i=n;const l=this;return function(d=o,...u){return l.produce(d,f=>i.call(this,f,...u))}}typeof i!="function"&&Br(6),s!==void 0&&typeof s!="function"&&Br(7);let a;if(Ri(n)){const o=_x(this),l=dh(n,void 0);let c=!0;try{a=i(l),c=!1}finally{c?oh(o):lh(o)}return Nx(o,s),Cx(a,o)}else if(!n||typeof n!="object"){if(a=i(n),a===void 0&&(a=n),a===Vj&&(a=void 0),this.autoFreeze_&&Jp(a,!0),s){const o=[],l=[];$s("Patches").generateReplacementPatches_(n,a,o,l),s(o,l)}return a}else Br(1,n)},this.produceWithPatches=(n,i)=>{if(typeof n=="function")return(l,...c)=>this.produceWithPatches(l,d=>n(d,...c));let s,a;return[this.produce(n,i,(l,c)=>{s=l,a=c}),s,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Ri(e)||Br(8),Rs(e)&&(e=Ci(e));const n=_x(this),i=dh(e,void 0);return i[xr].isManual_=!0,lh(n),i}finishDraft(e,n){const i=e&&e[xr];(!i||!i.isManual_)&&Br(9);const{scope_:s}=i;return Nx(s,n),Cx(void 0,s)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,n){let i;for(i=n.length-1;i>=0;i--){const a=n[i];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}i>-1&&(n=n.slice(i+1));const s=$s("Patches").applyPatches_;return Rs(e)?s(e,n):this.produce(e,a=>s(a,n))}};function dh(e,n){const i=Zo(e)?$s("MapSet").proxyMap_(e,n):Wd(e)?$s("MapSet").proxySet_(e,n):WD(e,n);return(n?n.scope_:Jj()).drafts_.push(i),i}function Ci(e){return Rs(e)||Br(10,e),ew(e)}function ew(e){if(!Ri(e)||Bd(e))return e;const n=e[xr];let i,s=!0;if(n){if(!n.modified_)return n.base_;n.finalized_=!0,i=ah(e,n.scope_.immer_.useStrictShallowCopy_),s=n.scope_.immer_.shouldUseStrictIteration()}else i=ah(e,!0);return Wc(i,(a,o)=>{Qj(i,a,ew(o))},s),n&&(n.finalized_=!1),i}var uh=new FD,tw=uh.produce,qD=uh.setUseStrictIteration.bind(uh);function nw(e){return({dispatch:i,getState:s})=>a=>o=>typeof o=="function"?o(i,s,e):a(o)}var UD=nw(),HD=nw,YD=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Lc:Lc.apply(null,arguments)};function Er(e,n){function i(...s){if(n){let a=n(...s);if(!a)throw new Error(pr(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:s[0]}}return i.toString=()=>`${e}`,i.type=e,i.match=s=>Gj(s)&&s.type===e,i}var rw=class ho extends Array{constructor(...n){super(...n),Object.setPrototypeOf(this,ho.prototype)}static get[Symbol.species](){return ho}concat(...n){return super.concat.apply(this,n)}prepend(...n){return n.length===1&&Array.isArray(n[0])?new ho(...n[0].concat(this)):new ho(...n.concat(this))}};function Ix(e){return Ri(e)?tw(e,()=>{}):e}function Ml(e,n,i){return e.has(n)?e.get(n):e.set(n,i(n)).get(n)}function KD(e){return typeof e=="boolean"}var GD=()=>function(n){const{thunk:i=!0,immutableCheck:s=!0,serializableCheck:a=!0,actionCreatorCheck:o=!0}=n??{};let l=new rw;return i&&(KD(i)?l.push(UD):l.push(HD(i.extraArgument))),l},iw="RTK_autoBatch",bn=()=>e=>({payload:e,meta:{[iw]:!0}}),Tx=e=>n=>{setTimeout(n,e)},sw=(e={type:"raf"})=>n=>(...i)=>{const s=n(...i);let a=!0,o=!1,l=!1;const c=new Set,d=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Tx(10):e.type==="callback"?e.queueNotification:Tx(e.timeout),u=()=>{l=!1,o&&(o=!1,c.forEach(f=>f()))};return Object.assign({},s,{subscribe(f){const h=()=>a&&f(),m=s.subscribe(h);return c.add(f),()=>{m(),c.delete(f)}},dispatch(f){var h;try{return a=!((h=f==null?void 0:f.meta)!=null&&h[iw]),o=!a,o&&(l||(l=!0,d(u))),s.dispatch(f)}finally{a=!0}}})},VD=e=>function(i){const{autoBatch:s=!0}=i??{};let a=new rw(e);return s&&a.push(sw(typeof s=="object"?s:void 0)),a};function XD(e){const n=GD(),{reducer:i=void 0,middleware:s,devTools:a=!0,preloadedState:o=void 0,enhancers:l=void 0}=e||{};let c;if(typeof i=="function")c=i;else if(Qp(i))c=Kj(i);else throw new Error(pr(1));let d;typeof s=="function"?d=s(n):d=n();let u=Lc;a&&(u=YD({trace:!1,...typeof a=="object"&&a}));const f=OD(...d),h=VD(f);let m=typeof l=="function"?l(h):h();const g=u(...m);return Yj(c,o,g)}function aw(e){const n={},i=[];let s;const a={addCase(o,l){const c=typeof o=="string"?o:o.type;if(!c)throw new Error(pr(28));if(c in n)throw new Error(pr(29));return n[c]=l,a},addAsyncThunk(o,l){return l.pending&&(n[o.pending.type]=l.pending),l.rejected&&(n[o.rejected.type]=l.rejected),l.fulfilled&&(n[o.fulfilled.type]=l.fulfilled),l.settled&&i.push({matcher:o.settled,reducer:l.settled}),a},addMatcher(o,l){return i.push({matcher:o,reducer:l}),a},addDefaultCase(o){return s=o,a}};return e(a),[n,i,s]}qD(!1);function QD(e){return typeof e=="function"}function JD(e,n){let[i,s,a]=aw(n),o;if(QD(e))o=()=>Ix(e());else{const c=Ix(e);o=()=>c}function l(c=o(),d){let u=[i[d.type],...s.filter(({matcher:f})=>f(d)).map(({reducer:f})=>f)];return u.filter(f=>!!f).length===0&&(u=[a]),u.reduce((f,h)=>{if(h)if(Rs(f)){const g=h(f,d);return g===void 0?f:g}else{if(Ri(f))return tw(f,m=>h(m,d));{const m=h(f,d);if(m===void 0){if(f===null)return f;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return f},c)}return l.getInitialState=o,l}var ZD="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",ez=(e=21)=>{let n="",i=e;for(;i--;)n+=ZD[Math.random()*64|0];return n},tz=Symbol.for("rtk-slice-createasyncthunk");function nz(e,n){return`${e}/${n}`}function rz({creators:e}={}){var i;const n=(i=e==null?void 0:e.asyncThunk)==null?void 0:i[tz];return function(a){const{name:o,reducerPath:l=o}=a;if(!o)throw new Error(pr(11));const c=(typeof a.reducers=="function"?a.reducers(sz()):a.reducers)||{},d=Object.keys(c),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},f={addCase(N,C){const w=typeof N=="string"?N:N.type;if(!w)throw new Error(pr(12));if(w in u.sliceCaseReducersByType)throw new Error(pr(13));return u.sliceCaseReducersByType[w]=C,f},addMatcher(N,C){return u.sliceMatchers.push({matcher:N,reducer:C}),f},exposeAction(N,C){return u.actionCreators[N]=C,f},exposeCaseReducer(N,C){return u.sliceCaseReducersByName[N]=C,f}};d.forEach(N=>{const C=c[N],w={reducerName:N,type:nz(o,N),createNotation:typeof a.reducers=="function"};oz(C)?cz(w,C,f,n):az(w,C,f)});function h(){const[N={},C=[],w=void 0]=typeof a.extraReducers=="function"?aw(a.extraReducers):[a.extraReducers],_={...N,...u.sliceCaseReducersByType};return JD(a.initialState,I=>{for(let O in _)I.addCase(O,_[O]);for(let O of u.sliceMatchers)I.addMatcher(O.matcher,O.reducer);for(let O of C)I.addMatcher(O.matcher,O.reducer);w&&I.addDefaultCase(w)})}const m=N=>N,g=new Map,b=new WeakMap;let j;function y(N,C){return j||(j=h()),j(N,C)}function x(){return j||(j=h()),j.getInitialState()}function v(N,C=!1){function w(I){let O=I[N];return typeof O>"u"&&C&&(O=Ml(b,w,x)),O}function _(I=m){const O=Ml(g,C,()=>new WeakMap);return Ml(O,I,()=>{const E={};for(const[S,k]of Object.entries(a.selectors??{}))E[S]=iz(k,I,()=>Ml(b,I,x),C);return E})}return{reducerPath:N,getSelectors:_,get selectors(){return _(w)},selectSlice:w}}const A={name:o,reducer:y,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:x,...v(l),injectInto(N,{reducerPath:C,...w}={}){const _=C??l;return N.inject({reducerPath:_,reducer:y},w),{...A,...v(_,!0)}}};return A}}function iz(e,n,i,s){function a(o,...l){let c=n(o);return typeof c>"u"&&s&&(c=i()),e(c,...l)}return a.unwrapped=e,a}var sr=rz();function sz(){function e(n,i){return{_reducerDefinitionType:"asyncThunk",payloadCreator:n,...i}}return e.withTypes=()=>e,{reducer(n){return Object.assign({[n.name](...i){return n(...i)}}[n.name],{_reducerDefinitionType:"reducer"})},preparedReducer(n,i){return{_reducerDefinitionType:"reducerWithPrepare",prepare:n,reducer:i}},asyncThunk:e}}function az({type:e,reducerName:n,createNotation:i},s,a){let o,l;if("reducer"in s){if(i&&!lz(s))throw new Error(pr(17));o=s.reducer,l=s.prepare}else o=s;a.addCase(e,o).exposeCaseReducer(n,o).exposeAction(n,l?Er(e,l):Er(e))}function oz(e){return e._reducerDefinitionType==="asyncThunk"}function lz(e){return e._reducerDefinitionType==="reducerWithPrepare"}function cz({type:e,reducerName:n},i,s,a){if(!a)throw new Error(pr(18));const{payloadCreator:o,fulfilled:l,pending:c,rejected:d,settled:u,options:f}=i,h=a(e,o,f);s.exposeAction(n,h),l&&s.addCase(h.fulfilled,l),c&&s.addCase(h.pending,c),d&&s.addCase(h.rejected,d),u&&s.addMatcher(h.settled,u),s.exposeCaseReducer(n,{fulfilled:l||Rl,pending:c||Rl,rejected:d||Rl,settled:u||Rl})}function Rl(){}var dz="task",ow="listener",lw="completed",em="cancelled",uz=`task-${em}`,fz=`task-${lw}`,fh=`${ow}-${em}`,hz=`${ow}-${lw}`,Fd=class{constructor(e){Au(this,"name","TaskAbortError");Au(this,"message");this.code=e,this.message=`${dz} ${em} (reason: ${e})`}},tm=(e,n)=>{if(typeof e!="function")throw new TypeError(pr(32))},qc=()=>{},cw=(e,n=qc)=>(e.catch(n),e),dw=(e,n)=>(e.addEventListener("abort",n,{once:!0}),()=>e.removeEventListener("abort",n)),Is=(e,n)=>{const i=e.signal;i.aborted||("reason"in i||Object.defineProperty(i,"reason",{enumerable:!0,value:n,configurable:!0,writable:!0}),e.abort(n))},Ts=e=>{if(e.aborted){const{reason:n}=e;throw new Fd(n)}};function uw(e,n){let i=qc;return new Promise((s,a)=>{const o=()=>a(new Fd(e.reason));if(e.aborted){o();return}i=dw(e,o),n.finally(()=>i()).then(s,a)}).finally(()=>{i=qc})}var pz=async(e,n)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(i){return{status:i instanceof Fd?"cancelled":"rejected",error:i}}finally{n==null||n()}},Uc=e=>n=>cw(uw(e,n).then(i=>(Ts(e),i))),fw=e=>{const n=Uc(e);return i=>n(new Promise(s=>setTimeout(s,i)))},{assign:ua}=Object,Ex={},qd="listenerMiddleware",mz=(e,n)=>{const i=s=>dw(e,()=>Is(s,e.reason));return(s,a)=>{tm(s);const o=new AbortController;i(o);const l=pz(async()=>{Ts(e),Ts(o.signal);const c=await s({pause:Uc(o.signal),delay:fw(o.signal),signal:o.signal});return Ts(o.signal),c},()=>Is(o,fz));return a!=null&&a.autoJoin&&n.push(l.catch(qc)),{result:Uc(e)(l),cancel(){Is(o,uz)}}}},gz=(e,n)=>{const i=async(s,a)=>{Ts(n);let o=()=>{};const c=[new Promise((d,u)=>{let f=e({predicate:s,effect:(h,m)=>{m.unsubscribe(),d([h,m.getState(),m.getOriginalState()])}});o=()=>{f(),u()}})];a!=null&&c.push(new Promise(d=>setTimeout(d,a,null)));try{const d=await uw(n,Promise.race(c));return Ts(n),d}finally{o()}};return(s,a)=>cw(i(s,a))},hw=e=>{let{type:n,actionCreator:i,matcher:s,predicate:a,effect:o}=e;if(n)a=Er(n).match;else if(i)n=i.type,a=i.match;else if(s)a=s;else if(!a)throw new Error(pr(21));return tm(o),{predicate:a,type:n,effect:o}},pw=ua(e=>{const{type:n,predicate:i,effect:s}=hw(e);return{id:ez(),effect:s,type:n,predicate:i,pending:new Set,unsubscribe:()=>{throw new Error(pr(22))}}},{withTypes:()=>pw}),Px=(e,n)=>{const{type:i,effect:s,predicate:a}=hw(n);return Array.from(e.values()).find(o=>(typeof i=="string"?o.type===i:o.predicate===a)&&o.effect===s)},hh=e=>{e.pending.forEach(n=>{Is(n,fh)})},yz=(e,n)=>()=>{for(const i of n.keys())hh(i);e.clear()},Ox=(e,n,i)=>{try{e(n,i)}catch(s){setTimeout(()=>{throw s},0)}},mw=ua(Er(`${qd}/add`),{withTypes:()=>mw}),xz=Er(`${qd}/removeAll`),gw=ua(Er(`${qd}/remove`),{withTypes:()=>gw}),vz=(...e)=>{console.error(`${qd}/error`,...e)},el=(e={})=>{const n=new Map,i=new Map,s=g=>{const b=i.get(g)??0;i.set(g,b+1)},a=g=>{const b=i.get(g)??1;b===1?i.delete(g):i.set(g,b-1)},{extra:o,onError:l=vz}=e;tm(l);const c=g=>(g.unsubscribe=()=>n.delete(g.id),n.set(g.id,g),b=>{g.unsubscribe(),b!=null&&b.cancelActive&&hh(g)}),d=g=>{const b=Px(n,g)??pw(g);return c(b)};ua(d,{withTypes:()=>d});const u=g=>{const b=Px(n,g);return b&&(b.unsubscribe(),g.cancelActive&&hh(b)),!!b};ua(u,{withTypes:()=>u});const f=async(g,b,j,y)=>{const x=new AbortController,v=gz(d,x.signal),A=[];try{g.pending.add(x),s(g),await Promise.resolve(g.effect(b,ua({},j,{getOriginalState:y,condition:(N,C)=>v(N,C).then(Boolean),take:v,delay:fw(x.signal),pause:Uc(x.signal),extra:o,signal:x.signal,fork:mz(x.signal,A),unsubscribe:g.unsubscribe,subscribe:()=>{n.set(g.id,g)},cancelActiveListeners:()=>{g.pending.forEach((N,C,w)=>{N!==x&&(Is(N,fh),w.delete(N))})},cancel:()=>{Is(x,fh),g.pending.delete(x)},throwIfCancelled:()=>{Ts(x.signal)}})))}catch(N){N instanceof Fd||Ox(l,N,{raisedBy:"effect"})}finally{await Promise.all(A),Is(x,hz),a(g),g.pending.delete(x)}},h=yz(n,i);return{middleware:g=>b=>j=>{if(!Gj(j))return b(j);if(mw.match(j))return d(j.payload);if(xz.match(j)){h();return}if(gw.match(j))return u(j.payload);let y=g.getState();const x=()=>{if(y===Ex)throw new Error(pr(23));return y};let v;try{if(v=b(j),n.size>0){const A=g.getState(),N=Array.from(n.values());for(const C of N){let w=!1;try{w=C.predicate(j,A,y)}catch(_){w=!1,Ox(l,_,{raisedBy:"predicate"})}w&&f(C,j,g,x)}}}finally{y=Ex}return v},startListening:d,stopListening:u,clearListeners:h}};function pr(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var bz={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},yw=sr({name:"chartLayout",initialState:bz,reducers:{setLayout(e,n){e.layoutType=n.payload},setChartSize(e,n){e.width=n.payload.width,e.height=n.payload.height},setMargin(e,n){var i,s,a,o;e.margin.top=(i=n.payload.top)!==null&&i!==void 0?i:0,e.margin.right=(s=n.payload.right)!==null&&s!==void 0?s:0,e.margin.bottom=(a=n.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(o=n.payload.left)!==null&&o!==void 0?o:0},setScale(e,n){e.scale=n.payload}}}),{setMargin:jz,setLayout:wz,setChartSize:Sz,setScale:kz}=yw.actions,Nz=yw.reducer;function xw(e,n,i){return Array.isArray(e)&&e&&n+i!==0?e.slice(n,i+1):e}function Dx(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function sa(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Dx(Object(i),!0).forEach(function(s){_z(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Dx(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function _z(e,n,i){return(n=Cz(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function Cz(e){var n=Az(e,"string");return typeof n=="symbol"?n:n+""}function Az(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Ft(e,n,i){return Zt(e)||Zt(n)?i:si(n)?Ms(e,n,i):typeof n=="function"?n(e):i}var Iz=(e,n,i)=>{if(n&&i){var{width:s,height:a}=i,{align:o,verticalAlign:l,layout:c}=n;if((c==="vertical"||c==="horizontal"&&l==="middle")&&o!=="center"&&Qe(e[o]))return sa(sa({},e),{},{[o]:e[o]+(s||0)});if((c==="horizontal"||c==="vertical"&&o==="center")&&l!=="middle"&&Qe(e[l]))return sa(sa({},e),{},{[l]:e[l]+(a||0)})}return e},ds=(e,n)=>e==="horizontal"&&n==="xAxis"||e==="vertical"&&n==="yAxis"||e==="centric"&&n==="angleAxis"||e==="radial"&&n==="radiusAxis",vw=(e,n,i,s)=>{if(s)return e.map(c=>c.coordinate);var a,o,l=e.map(c=>(c.coordinate===n&&(a=!0),c.coordinate===i&&(o=!0),c.coordinate));return a||l.push(n),o||l.push(i),l},bw=(e,n,i)=>{if(!e)return null;var{duplicateDomain:s,type:a,range:o,scale:l,realScaleType:c,isCategorical:d,categoricalDomain:u,tickCount:f,ticks:h,niceTicks:m,axisType:g}=e;if(!l)return null;var b=c==="scaleBand"&&l.bandwidth?l.bandwidth()/2:2,j=a==="category"&&l.bandwidth?l.bandwidth()/b:0;if(j=g==="angleAxis"&&o&&o.length>=2?Cn(o[0]-o[1])*2*j:j,h||m){var y=(h||m||[]).map((x,v)=>{var A=s?s.indexOf(x):x;return{coordinate:l(A)+j,value:x,offset:j,index:v}});return y.filter(x=>!Ur(x.coordinate))}return d&&u?u.map((x,v)=>({coordinate:l(x)+j,value:x,index:v,offset:j})):l.ticks&&f!=null?l.ticks(f).map((x,v)=>({coordinate:l(x)+j,value:x,offset:j,index:v})):l.domain().map((x,v)=>({coordinate:l(x)+j,value:s?s[x]:x,index:v,offset:j}))},zx=1e-4,Tz=e=>{var n=e.domain();if(!(!n||n.length<=2)){var i=n.length,s=e.range(),a=Math.min(s[0],s[1])-zx,o=Math.max(s[0],s[1])+zx,l=e(n[0]),c=e(n[i-1]);(l<a||l>o||c<a||c>o)&&e.domain([n[0],n[i-1]])}},Ez=(e,n)=>{if(!n||n.length!==2||!Qe(n[0])||!Qe(n[1]))return e;var i=Math.min(n[0],n[1]),s=Math.max(n[0],n[1]),a=[e[0],e[1]];return(!Qe(e[0])||e[0]<i)&&(a[0]=i),(!Qe(e[1])||e[1]>s)&&(a[1]=s),a[0]>s&&(a[0]=s),a[1]<i&&(a[1]=i),a},Pz=e=>{var n=e.length;if(!(n<=0))for(var i=0,s=e[0].length;i<s;++i)for(var a=0,o=0,l=0;l<n;++l){var c=Ur(e[l][i][1])?e[l][i][0]:e[l][i][1];c>=0?(e[l][i][0]=a,e[l][i][1]=a+c,a=e[l][i][1]):(e[l][i][0]=o,e[l][i][1]=o+c,o=e[l][i][1])}},Oz=e=>{var n=e.length;if(!(n<=0))for(var i=0,s=e[0].length;i<s;++i)for(var a=0,o=0;o<n;++o){var l=Ur(e[o][i][1])?e[o][i][0]:e[o][i][1];l>=0?(e[o][i][0]=a,e[o][i][1]=a+l,a=e[o][i][1]):(e[o][i][0]=0,e[o][i][1]=0)}},Dz={sign:Pz,expand:NO,none:ja,silhouette:_O,wiggle:CO,positive:Oz},zz=(e,n,i)=>{var s=Dz[i],a=kO().keys(n).value((o,l)=>Number(Ft(o,l,0))).order(rh).offset(s);return a(e)};function Mz(e){return e==null?void 0:String(e)}function Mx(e){var{axis:n,ticks:i,bandSize:s,entry:a,index:o,dataKey:l}=e;if(n.type==="category"){if(!n.allowDuplicatedCategory&&n.dataKey&&!Zt(a[n.dataKey])){var c=pj(i,"value",a[n.dataKey]);if(c)return c.coordinate+s/2}return i[o]?i[o].coordinate+s/2:null}var d=Ft(a,Zt(l)?n.dataKey:l);return Zt(d)?null:n.scale(d)}var Rx=e=>{var{axis:n,ticks:i,offset:s,bandSize:a,entry:o,index:l}=e;if(n.type==="category")return i[l]?i[l].coordinate+s:null;var c=Ft(o,n.dataKey,n.scale.domain()[l]);return Zt(c)?null:n.scale(c)-a/2+s},Rz=e=>{var{numericAxis:n}=e,i=n.scale.domain();if(n.type==="number"){var s=Math.min(i[0],i[1]),a=Math.max(i[0],i[1]);return s<=0&&a>=0?0:a<0?a:s}return i[0]},$z=e=>{var n=e.flat(2).filter(Qe);return[Math.min(...n),Math.max(...n)]},Lz=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],Wz=(e,n,i)=>{if(e!=null)return Lz(Object.keys(e).reduce((s,a)=>{var o=e[a],{stackedData:l}=o,c=l.reduce((d,u)=>{var f=xw(u,n,i),h=$z(f);return[Math.min(d[0],h[0]),Math.max(d[1],h[1])]},[1/0,-1/0]);return[Math.min(c[0],s[0]),Math.max(c[1],s[1])]},[1/0,-1/0]))},$x=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Lx=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Sa=(e,n,i)=>{if(e&&e.scale&&e.scale.bandwidth){var s=e.scale.bandwidth();if(!i||s>0)return s}if(e&&n&&n.length>=2){for(var a=$d(n,f=>f.coordinate),o=1/0,l=1,c=a.length;l<c;l++){var d=a[l],u=a[l-1];o=Math.min((d.coordinate||0)-(u.coordinate||0),o)}return o===1/0?0:o}return i?void 0:0};function Wx(e){var{tooltipEntrySettings:n,dataKey:i,payload:s,value:a,name:o}=e;return sa(sa({},n),{},{dataKey:i,payload:s,value:a,name:o})}function _a(e,n){if(e)return String(e);if(typeof n=="string")return n}var Bz=(e,n)=>{if(n==="horizontal")return e.chartX;if(n==="vertical")return e.chartY},Fz=(e,n)=>n==="centric"?e.angle:e.radius,Fi=e=>e.layout.width,qi=e=>e.layout.height,qz=e=>e.layout.scale,jw=e=>e.layout.margin,Ud=Ie(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Hd=Ie(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),ww="data-recharts-item-index",Sw="data-recharts-item-data-key",tl=60;function Bx(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function $l(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Bx(Object(i),!0).forEach(function(s){Uz(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Bx(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function Uz(e,n,i){return(n=Hz(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function Hz(e){var n=Yz(e,"string");return typeof n=="symbol"?n:n+""}function Yz(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var Kz=e=>e.brush.height;function Gz(e){var n=Hd(e);return n.reduce((i,s)=>{if(s.orientation==="left"&&!s.mirror&&!s.hide){var a=typeof s.width=="number"?s.width:tl;return i+a}return i},0)}function Vz(e){var n=Hd(e);return n.reduce((i,s)=>{if(s.orientation==="right"&&!s.mirror&&!s.hide){var a=typeof s.width=="number"?s.width:tl;return i+a}return i},0)}function Xz(e){var n=Ud(e);return n.reduce((i,s)=>s.orientation==="top"&&!s.mirror&&!s.hide?i+s.height:i,0)}function Qz(e){var n=Ud(e);return n.reduce((i,s)=>s.orientation==="bottom"&&!s.mirror&&!s.hide?i+s.height:i,0)}var wn=Ie([Fi,qi,jw,Kz,Gz,Vz,Xz,Qz,Hj,CD],(e,n,i,s,a,o,l,c,d,u)=>{var f={left:(i.left||0)+a,right:(i.right||0)+o},h={top:(i.top||0)+l,bottom:(i.bottom||0)+c},m=$l($l({},h),f),g=m.bottom;m.bottom+=s,m=Iz(m,d,u);var b=e-m.left-m.right,j=n-m.top-m.bottom;return $l($l({brushBottom:g},m),{},{width:Math.max(b,0),height:Math.max(j,0)})}),Jz=Ie(wn,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),nm=Ie(Fi,qi,(e,n)=>({x:0,y:0,width:e,height:n})),Zz=p.createContext(null),qn=()=>p.useContext(Zz)!=null,Yd=e=>e.brush,Kd=Ie([Yd,wn,jw],(e,n,i)=>({height:e.height,x:Qe(e.x)?e.x:n.left,y:Qe(e.y)?e.y:n.top+n.height+n.brushBottom-((i==null?void 0:i.bottom)||0),width:Qe(e.width)?e.width:n.width})),kw={},Nw={},_w={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i,s,{signal:a,edges:o}={}){let l,c=null;const d=o!=null&&o.includes("leading"),u=o==null||o.includes("trailing"),f=()=>{c!==null&&(i.apply(l,c),l=void 0,c=null)},h=()=>{u&&f(),j()};let m=null;const g=()=>{m!=null&&clearTimeout(m),m=setTimeout(()=>{m=null,h()},s)},b=()=>{m!==null&&(clearTimeout(m),m=null)},j=()=>{b(),l=void 0,c=null},y=()=>{f()},x=function(...v){if(a!=null&&a.aborted)return;l=this,c=v;const A=m==null;g(),d&&A&&f()};return x.schedule=g,x.cancel=j,x.flush=y,a==null||a.addEventListener("abort",j,{once:!0}),x}e.debounce=n})(_w);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=_w;function i(s,a=0,o={}){typeof o!="object"&&(o={});const{leading:l=!1,trailing:c=!0,maxWait:d}=o,u=Array(2);l&&(u[0]="leading"),c&&(u[1]="trailing");let f,h=null;const m=n.debounce(function(...j){f=s.apply(this,j),h=null},a,{edges:u}),g=function(...j){return d!=null&&(h===null&&(h=Date.now()),Date.now()-h>=d)?(f=s.apply(this,j),h=Date.now(),m.cancel(),m.schedule(),f):(m.apply(this,j),f)},b=()=>(m.flush(),f);return g.cancel=m.cancel,g.flush=b,g}e.debounce=i})(Nw);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Nw;function i(s,a=0,o={}){const{leading:l=!0,trailing:c=!0}=o;return n.debounce(s,a,{leading:l,maxWait:a,trailing:c})}e.throttle=i})(kw);var e5=kw.throttle;const t5=Wi(e5);var Hc=function(n,i){for(var s=arguments.length,a=new Array(s>2?s-2:0),o=2;o<s;o++)a[o-2]=arguments[o]},Cw=(e,n,i)=>{var{width:s="100%",height:a="100%",aspect:o,maxHeight:l}=i,c=Mi(s)?e:Number(s),d=Mi(a)?n:Number(a);return o&&o>0&&(c?d=c/o:d&&(c=d*o),l&&d!=null&&d>l&&(d=l)),{calculatedWidth:c,calculatedHeight:d}},n5={width:0,height:0,overflow:"visible"},r5={width:0,overflowX:"visible"},i5={height:0,overflowY:"visible"},s5={},a5=e=>{var{width:n,height:i}=e,s=Mi(n),a=Mi(i);return s&&a?n5:s?r5:a?i5:s5};function o5(e){var{width:n,height:i,aspect:s}=e,a=n,o=i;return a===void 0&&o===void 0?(a="100%",o="100%"):a===void 0?a=s&&s>0?void 0:"100%":o===void 0&&(o=s&&s>0?void 0:"100%"),{width:a,height:o}}function un(e){return Number.isFinite(e)}function ai(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function ph(){return ph=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},ph.apply(null,arguments)}function Fx(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function qx(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Fx(Object(i),!0).forEach(function(s){l5(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Fx(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function l5(e,n,i){return(n=c5(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function c5(e){var n=d5(e,"string");return typeof n=="symbol"?n:n+""}function d5(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var Aw=p.createContext({width:-1,height:-1});function u5(e){return ai(e.width)&&ai(e.height)}function Iw(e){var{children:n,width:i,height:s}=e,a=p.useMemo(()=>({width:i,height:s}),[i,s]);return u5(a)?p.createElement(Aw.Provider,{value:a},n):null}var rm=()=>p.useContext(Aw),f5=p.forwardRef((e,n)=>{var{aspect:i,initialDimension:s={width:-1,height:-1},width:a,height:o,minWidth:l=0,minHeight:c,maxHeight:d,children:u,debounce:f=0,id:h,className:m,onResize:g,style:b={}}=e,j=p.useRef(null),y=p.useRef();y.current=g,p.useImperativeHandle(n,()=>j.current);var[x,v]=p.useState({containerWidth:s.width,containerHeight:s.height}),A=p.useCallback((I,O)=>{v(E=>{var S=Math.round(I),k=Math.round(O);return E.containerWidth===S&&E.containerHeight===k?E:{containerWidth:S,containerHeight:k}})},[]);p.useEffect(()=>{if(j.current==null||typeof ResizeObserver>"u")return Hs;var I=k=>{var D,{width:T,height:P}=k[0].contentRect;A(T,P),(D=y.current)===null||D===void 0||D.call(y,T,P)};f>0&&(I=t5(I,f,{trailing:!0,leading:!1}));var O=new ResizeObserver(I),{width:E,height:S}=j.current.getBoundingClientRect();return A(E,S),O.observe(j.current),()=>{O.disconnect()}},[A,f]);var{containerWidth:N,containerHeight:C}=x;Hc(!i||i>0,"The aspect(%s) must be greater than zero.",i);var{calculatedWidth:w,calculatedHeight:_}=Cw(N,C,{width:a,height:o,aspect:i,maxHeight:d});return Hc(w!=null&&w>0||_!=null&&_>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,w,_,a,o,l,c,i),p.createElement("div",{id:h?"".concat(h):void 0,className:_t("recharts-responsive-container",m),style:qx(qx({},b),{},{width:a,height:o,minWidth:l,minHeight:c,maxHeight:d}),ref:j},p.createElement("div",{style:a5({width:a,height:o})},p.createElement(Iw,{width:w,height:_},u)))}),Ro=p.forwardRef((e,n)=>{var i=rm();if(ai(i.width)&&ai(i.height))return e.children;var{width:s,height:a}=o5({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:o,calculatedHeight:l}=Cw(void 0,void 0,{width:s,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return Qe(o)&&Qe(l)?p.createElement(Iw,{width:o,height:l},e.children):p.createElement(f5,ph({},e,{width:s,height:a,ref:n}))});function Tw(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var Gd=()=>{var e,n=qn(),i=Je(Jz),s=Je(Kd),a=(e=Je(Yd))===null||e===void 0?void 0:e.padding;return!n||!s||!a?i:{width:s.width-a.left-a.right,height:s.height-a.top-a.bottom,x:a.left,y:a.top}},h5={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Ew=()=>{var e;return(e=Je(wn))!==null&&e!==void 0?e:h5},Pw=()=>Je(Fi),Ow=()=>Je(qi),wt=e=>e.layout.layoutType,nl=()=>Je(wt),p5=()=>{var e=nl();return e!==void 0},Vd=e=>{var n=en(),i=qn(),{width:s,height:a}=e,o=rm(),l=s,c=a;return o&&(l=o.width>0?o.width:s,c=o.height>0?o.height:a),p.useEffect(()=>{!i&&ai(l)&&ai(c)&&n(Sz({width:l,height:c}))},[n,i,l,c]),null},m5={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Dw=sr({name:"legend",initialState:m5,reducers:{setLegendSize(e,n){e.size.width=n.payload.width,e.size.height=n.payload.height},setLegendSettings(e,n){e.settings.align=n.payload.align,e.settings.layout=n.payload.layout,e.settings.verticalAlign=n.payload.verticalAlign,e.settings.itemSorter=n.payload.itemSorter},addLegendPayload:{reducer(e,n){e.payload.push(n.payload)},prepare:bn()},removeLegendPayload:{reducer(e,n){var i=Ci(e).payload.indexOf(n.payload);i>-1&&e.payload.splice(i,1)},prepare:bn()}}}),{setLegendSize:_K,setLegendSettings:CK,addLegendPayload:zw,removeLegendPayload:Mw}=Dw.actions,g5=Dw.reducer;function mh(){return mh=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},mh.apply(null,arguments)}function Ux(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function rf(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Ux(Object(i),!0).forEach(function(s){y5(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Ux(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function y5(e,n,i){return(n=x5(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function x5(e){var n=v5(e,"string");return typeof n=="symbol"?n:n+""}function v5(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function b5(e){return Array.isArray(e)&&si(e[0])&&si(e[1])?e.join(" ~ "):e}var j5=e=>{var{separator:n=" : ",contentStyle:i={},itemStyle:s={},labelStyle:a={},payload:o,formatter:l,itemSorter:c,wrapperClassName:d,labelClassName:u,label:f,labelFormatter:h,accessibilityLayer:m=!1}=e,g=()=>{if(o&&o.length){var C={padding:0,margin:0},w=(c?$d(o,c):o).map((_,I)=>{if(_.type==="none")return null;var O=_.formatter||l||b5,{value:E,name:S}=_,k=E,D=S;if(O){var T=O(E,S,_,I,o);if(Array.isArray(T))[k,D]=T;else if(T!=null)k=T;else return null}var P=rf({display:"block",paddingTop:4,paddingBottom:4,color:_.color||"#000"},s);return p.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(I),style:P},si(D)?p.createElement("span",{className:"recharts-tooltip-item-name"},D):null,si(D)?p.createElement("span",{className:"recharts-tooltip-item-separator"},n):null,p.createElement("span",{className:"recharts-tooltip-item-value"},k),p.createElement("span",{className:"recharts-tooltip-item-unit"},_.unit||""))});return p.createElement("ul",{className:"recharts-tooltip-item-list",style:C},w)}return null},b=rf({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),j=rf({margin:0},a),y=!Zt(f),x=y?f:"",v=_t("recharts-default-tooltip",d),A=_t("recharts-tooltip-label",u);y&&h&&o!==void 0&&o!==null&&(x=h(f,o));var N=m?{role:"status","aria-live":"assertive"}:{};return p.createElement("div",mh({className:v,style:b},N),p.createElement("p",{className:A,style:j},p.isValidElement(x)?x:"".concat(x)),g())},eo="recharts-tooltip-wrapper",w5={visibility:"hidden"};function S5(e){var{coordinate:n,translateX:i,translateY:s}=e;return _t(eo,{["".concat(eo,"-right")]:Qe(i)&&n&&Qe(n.x)&&i>=n.x,["".concat(eo,"-left")]:Qe(i)&&n&&Qe(n.x)&&i<n.x,["".concat(eo,"-bottom")]:Qe(s)&&n&&Qe(n.y)&&s>=n.y,["".concat(eo,"-top")]:Qe(s)&&n&&Qe(n.y)&&s<n.y})}function Hx(e){var{allowEscapeViewBox:n,coordinate:i,key:s,offsetTopLeft:a,position:o,reverseDirection:l,tooltipDimension:c,viewBox:d,viewBoxDimension:u}=e;if(o&&Qe(o[s]))return o[s];var f=i[s]-c-(a>0?a:0),h=i[s]+a;if(n[s])return l[s]?f:h;var m=d[s];if(m==null)return 0;if(l[s]){var g=f,b=m;return g<b?Math.max(h,m):Math.max(f,m)}if(u==null)return 0;var j=h+c,y=m+u;return j>y?Math.max(f,m):Math.max(h,m)}function k5(e){var{translateX:n,translateY:i,useTranslate3d:s}=e;return{transform:s?"translate3d(".concat(n,"px, ").concat(i,"px, 0)"):"translate(".concat(n,"px, ").concat(i,"px)")}}function N5(e){var{allowEscapeViewBox:n,coordinate:i,offsetTopLeft:s,position:a,reverseDirection:o,tooltipBox:l,useTranslate3d:c,viewBox:d}=e,u,f,h;return l.height>0&&l.width>0&&i?(f=Hx({allowEscapeViewBox:n,coordinate:i,key:"x",offsetTopLeft:s,position:a,reverseDirection:o,tooltipDimension:l.width,viewBox:d,viewBoxDimension:d.width}),h=Hx({allowEscapeViewBox:n,coordinate:i,key:"y",offsetTopLeft:s,position:a,reverseDirection:o,tooltipDimension:l.height,viewBox:d,viewBoxDimension:d.height}),u=k5({translateX:f,translateY:h,useTranslate3d:c})):u=w5,{cssProperties:u,cssClasses:S5({translateX:f,translateY:h,coordinate:i})}}function Yx(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function Ll(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Yx(Object(i),!0).forEach(function(s){gh(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Yx(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function gh(e,n,i){return(n=_5(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function _5(e){var n=C5(e,"string");return typeof n=="symbol"?n:n+""}function C5(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}class A5 extends p.PureComponent{constructor(){super(...arguments),gh(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),gh(this,"handleKeyDown",n=>{if(n.key==="Escape"){var i,s,a,o;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(i=(s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==null&&i!==void 0?i:0,y:(a=(o=this.props.coordinate)===null||o===void 0?void 0:o.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var n,i;this.state.dismissed&&(((n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==this.state.dismissedAtCoordinate.x||((i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:n,allowEscapeViewBox:i,animationDuration:s,animationEasing:a,children:o,coordinate:l,hasPayload:c,isAnimationActive:d,offset:u,position:f,reverseDirection:h,useTranslate3d:m,viewBox:g,wrapperStyle:b,lastBoundingBox:j,innerRef:y,hasPortalFromProps:x}=this.props,{cssClasses:v,cssProperties:A}=N5({allowEscapeViewBox:i,coordinate:l,offsetTopLeft:u,position:f,reverseDirection:h,tooltipBox:{height:j.height,width:j.width},useTranslate3d:m,viewBox:g}),N=x?{}:Ll(Ll({transition:d&&n?"transform ".concat(s,"ms ").concat(a):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&n&&c?"visible":"hidden",position:"absolute",top:0,left:0}),C=Ll(Ll({},N),{},{visibility:!this.state.dismissed&&n&&c?"visible":"hidden"},b);return p.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:v,style:C,ref:y},o)}}var I5=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),us={devToolsEnabled:!1,isSsr:I5()},Rw=()=>{var e;return(e=Je(n=>n.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function yh(){return yh=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},yh.apply(null,arguments)}function Kx(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function Gx(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Kx(Object(i),!0).forEach(function(s){T5(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Kx(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function T5(e,n,i){return(n=E5(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function E5(e){var n=P5(e,"string");return typeof n=="symbol"?n:n+""}function P5(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var Vx={curveBasisClosed:hO,curveBasisOpen:pO,curveBasis:fO,curveBumpX:J3,curveBumpY:Z3,curveLinearClosed:mO,curveLinear:Td,curveMonotoneX:gO,curveMonotoneY:yO,curveNatural:xO,curveStep:vO,curveStepAfter:jO,curveStepBefore:bO},Yc=e=>un(e.x)&&un(e.y),Xx=e=>e.base!=null&&Yc(e.base)&&Yc(e),to=e=>e.x,no=e=>e.y,O5=(e,n)=>{if(typeof e=="function")return e;var i="curve".concat(Jo(e));return(i==="curveMonotone"||i==="curveBump")&&n?Vx["".concat(i).concat(n==="vertical"?"Y":"X")]:Vx[i]||Td},D5=e=>{var{type:n="linear",points:i=[],baseLine:s,layout:a,connectNulls:o=!1}=e,l=O5(n,a),c=o?i.filter(Yc):i,d;if(Array.isArray(s)){var u=i.map((g,b)=>Gx(Gx({},g),{},{base:s[b]}));a==="vertical"?d=Pl().y(no).x1(to).x0(g=>g.base.x):d=Pl().x(to).y1(no).y0(g=>g.base.y);var f=d.defined(Xx).curve(l),h=o?u.filter(Xx):u;return f(h)}a==="vertical"&&Qe(s)?d=Pl().y(no).x1(to).x0(s):Qe(s)?d=Pl().x(to).y1(no).y0(s):d=ej().x(to).y(no);var m=d.defined(Yc).curve(l);return m(c)},im=e=>{var{className:n,points:i,path:s,pathRef:a}=e;if((!i||!i.length)&&!s)return null;var o=i&&i.length?D5(e):s;return p.createElement("path",yh({},yr(e),$p(e),{className:_t("recharts-curve",n),d:o===null?void 0:o,ref:a}))},z5=["x","y","top","left","width","height","className"];function xh(){return xh=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},xh.apply(null,arguments)}function Qx(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function M5(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Qx(Object(i),!0).forEach(function(s){R5(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Qx(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function R5(e,n,i){return(n=$5(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function $5(e){var n=L5(e,"string");return typeof n=="symbol"?n:n+""}function L5(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function W5(e,n){if(e==null)return{};var i,s,a=B5(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function B5(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var F5=(e,n,i,s,a,o)=>"M".concat(e,",").concat(a,"v").concat(s,"M").concat(o,",").concat(n,"h").concat(i),q5=e=>{var{x:n=0,y:i=0,top:s=0,left:a=0,width:o=0,height:l=0,className:c}=e,d=W5(e,z5),u=M5({x:n,y:i,top:s,left:a,width:o,height:l},d);return!Qe(n)||!Qe(i)||!Qe(o)||!Qe(l)||!Qe(s)||!Qe(a)?null:p.createElement("path",xh({},Qn(u),{className:_t("recharts-cross",c),d:F5(n,i,o,l,s,a)}))};function U5(e,n,i,s){var a=s/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?n.x-a:i.left+.5,y:e==="horizontal"?i.top+.5:n.y-a,width:e==="horizontal"?s:i.width-1,height:e==="horizontal"?i.height-1:s}}function Jx(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function Zx(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Jx(Object(i),!0).forEach(function(s){H5(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Jx(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function H5(e,n,i){return(n=Y5(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function Y5(e){var n=K5(e,"string");return typeof n=="symbol"?n:n+""}function K5(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var G5=e=>e.replace(/([A-Z])/g,n=>"-".concat(n.toLowerCase())),$w=(e,n,i)=>e.map(s=>"".concat(G5(s)," ").concat(n,"ms ").concat(i)).join(","),V5=(e,n)=>[Object.keys(e),Object.keys(n)].reduce((i,s)=>i.filter(a=>s.includes(a))),$o=(e,n)=>Object.keys(n).reduce((i,s)=>Zx(Zx({},i),{},{[s]:e(s,n[s])}),{});function e0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function vn(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?e0(Object(i),!0).forEach(function(s){X5(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):e0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function X5(e,n,i){return(n=Q5(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function Q5(e){var n=J5(e,"string");return typeof n=="symbol"?n:n+""}function J5(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var Kc=(e,n,i)=>e+(n-e)*i,vh=e=>{var{from:n,to:i}=e;return n!==i},Lw=(e,n,i)=>{var s=$o((a,o)=>{if(vh(o)){var[l,c]=e(o.from,o.to,o.velocity);return vn(vn({},o),{},{from:l,velocity:c})}return o},n);return i<1?$o((a,o)=>vh(o)?vn(vn({},o),{},{velocity:Kc(o.velocity,s[a].velocity,i),from:Kc(o.from,s[a].from,i)}):o,n):Lw(e,s,i-1)};function Z5(e,n,i,s,a,o){var l,c=s.reduce((m,g)=>vn(vn({},m),{},{[g]:{from:e[g],velocity:0,to:n[g]}}),{}),d=()=>$o((m,g)=>g.from,c),u=()=>!Object.values(c).filter(vh).length,f=null,h=m=>{l||(l=m);var g=m-l,b=g/i.dt;c=Lw(i,c,b),a(vn(vn(vn({},e),n),d())),l=m,u()||(f=o.setTimeout(h))};return()=>(f=o.setTimeout(h),()=>{var m;(m=f)===null||m===void 0||m()})}function eM(e,n,i,s,a,o,l){var c=null,d=a.reduce((h,m)=>vn(vn({},h),{},{[m]:[e[m],n[m]]}),{}),u,f=h=>{u||(u=h);var m=(h-u)/s,g=$o((j,y)=>Kc(...y,i(m)),d);if(o(vn(vn(vn({},e),n),g)),m<1)c=l.setTimeout(f);else{var b=$o((j,y)=>Kc(...y,i(1)),d);o(vn(vn(vn({},e),n),b))}};return()=>(c=l.setTimeout(f),()=>{var h;(h=c)===null||h===void 0||h()})}const tM=(e,n,i,s,a,o)=>{var l=V5(e,n);return i==null?()=>(a(vn(vn({},e),n)),()=>{}):i.isStepper===!0?Z5(e,n,i,l,a,o):eM(e,n,i,s,l,a,o)};var Gc=1e-4,Ww=(e,n)=>[0,3*e,3*n-6*e,3*e-3*n+1],Bw=(e,n)=>e.map((i,s)=>i*n**s).reduce((i,s)=>i+s),t0=(e,n)=>i=>{var s=Ww(e,n);return Bw(s,i)},nM=(e,n)=>i=>{var s=Ww(e,n),a=[...s.map((o,l)=>o*l).slice(1),0];return Bw(a,i)},rM=function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];if(i.length===1)switch(i[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a,o=i[0].split("(");if(o[0]==="cubic-bezier"&&((a=o[1])===null||a===void 0?void 0:a.split(")")[0].split(",").length)===4){var l=o[1].split(")")[0].split(",").map(c=>parseFloat(c));return[l[0],l[1],l[2],l[3]]}}}return i.length===4?i:[0,0,1,1]},iM=(e,n,i,s)=>{var a=t0(e,i),o=t0(n,s),l=nM(e,i),c=u=>u>1?1:u<0?0:u,d=u=>{for(var f=u>1?1:u,h=f,m=0;m<8;++m){var g=a(h)-f,b=l(h);if(Math.abs(g-f)<Gc||b<Gc)return o(h);h=c(h-g/b)}return o(h)};return d.isStepper=!1,d},n0=function(){return iM(...rM(...arguments))},sM=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:i=100,damping:s=8,dt:a=17}=n,o=(l,c,d)=>{var u=-(l-c)*i,f=d*s,h=d+(u-f)*a/1e3,m=d*a/1e3+l;return Math.abs(m-c)<Gc&&Math.abs(h)<Gc?[c,0]:[m,h]};return o.isStepper=!0,o.dt=a,o},aM=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return n0(e);case"spring":return sM();default:if(e.split("(")[0]==="cubic-bezier")return n0(e)}return typeof e=="function"?e:null};function oM(e){var n,i=()=>null,s=!1,a=null,o=l=>{if(!s){if(Array.isArray(l)){if(!l.length)return;var c=l,[d,...u]=c;if(typeof d=="number"){a=e.setTimeout(o.bind(null,u),d);return}o(d),a=e.setTimeout(o.bind(null,u));return}typeof l=="string"&&(n=l,i(n)),typeof l=="object"&&(n=l,i(n)),typeof l=="function"&&l()}};return{stop:()=>{s=!0},start:l=>{s=!1,a&&(a(),a=null),o(l)},subscribe:l=>(i=l,()=>{i=()=>null}),getTimeoutController:()=>e}}class lM{setTimeout(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=performance.now(),a=null,o=l=>{l-s>=i?n(l):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(o))};return a=requestAnimationFrame(o),()=>{a!=null&&cancelAnimationFrame(a)}}}function cM(){return oM(new lM)}var dM=p.createContext(cM);function uM(e,n){var i=p.useContext(dM);return p.useMemo(()=>n??i(e),[e,n,i])}var fM={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},r0={t:0},sf={t:1};function rl(e){var n=Tn(e,fM),{isActive:i,canBegin:s,duration:a,easing:o,begin:l,onAnimationEnd:c,onAnimationStart:d,children:u}=n,f=uM(n.animationId,n.animationManager),[h,m]=p.useState(i?r0:sf),g=p.useRef(null);return p.useEffect(()=>{i||m(sf)},[i]),p.useEffect(()=>{if(!i||!s)return Hs;var b=tM(r0,sf,aM(o),a,m,f.getTimeoutController()),j=()=>{g.current=b()};return f.start([d,l,j,a,c]),()=>{f.stop(),g.current&&g.current(),c()}},[i,s,a,o,l,d,c,f]),u(h.t)}function il(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",i=p.useRef(Oo(n)),s=p.useRef(e);return s.current!==e&&(i.current=Oo(n),s.current=e),i.current}var hM=["radius"],pM=["radius"];function i0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function s0(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?i0(Object(i),!0).forEach(function(s){mM(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):i0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function mM(e,n,i){return(n=gM(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function gM(e){var n=yM(e,"string");return typeof n=="symbol"?n:n+""}function yM(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Vc(){return Vc=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Vc.apply(null,arguments)}function a0(e,n){if(e==null)return{};var i,s,a=xM(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function xM(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var o0=(e,n,i,s,a)=>{var o=Math.min(Math.abs(i)/2,Math.abs(s)/2),l=s>=0?1:-1,c=i>=0?1:-1,d=s>=0&&i>=0||s<0&&i<0?1:0,u;if(o>0&&a instanceof Array){for(var f=[0,0,0,0],h=0,m=4;h<m;h++)f[h]=a[h]>o?o:a[h];u="M".concat(e,",").concat(n+l*f[0]),f[0]>0&&(u+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(d,",").concat(e+c*f[0],",").concat(n)),u+="L ".concat(e+i-c*f[1],",").concat(n),f[1]>0&&(u+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(d,`,
        `).concat(e+i,",").concat(n+l*f[1])),u+="L ".concat(e+i,",").concat(n+s-l*f[2]),f[2]>0&&(u+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(d,`,
        `).concat(e+i-c*f[2],",").concat(n+s)),u+="L ".concat(e+c*f[3],",").concat(n+s),f[3]>0&&(u+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(d,`,
        `).concat(e,",").concat(n+s-l*f[3])),u+="Z"}else if(o>0&&a===+a&&a>0){var g=Math.min(o,a);u="M ".concat(e,",").concat(n+l*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(d,",").concat(e+c*g,",").concat(n,`
            L `).concat(e+i-c*g,",").concat(n,`
            A `).concat(g,",").concat(g,",0,0,").concat(d,",").concat(e+i,",").concat(n+l*g,`
            L `).concat(e+i,",").concat(n+s-l*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(d,",").concat(e+i-c*g,",").concat(n+s,`
            L `).concat(e+c*g,",").concat(n+s,`
            A `).concat(g,",").concat(g,",0,0,").concat(d,",").concat(e,",").concat(n+s-l*g," Z")}else u="M ".concat(e,",").concat(n," h ").concat(i," v ").concat(s," h ").concat(-i," Z");return u},l0={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Fw=e=>{var n=Tn(e,l0),i=p.useRef(null),[s,a]=p.useState(-1);p.useEffect(()=>{if(i.current&&i.current.getTotalLength)try{var Y=i.current.getTotalLength();Y&&a(Y)}catch{}},[]);var{x:o,y:l,width:c,height:d,radius:u,className:f}=n,{animationEasing:h,animationDuration:m,animationBegin:g,isAnimationActive:b,isUpdateAnimationActive:j}=n,y=p.useRef(c),x=p.useRef(d),v=p.useRef(o),A=p.useRef(l),N=p.useMemo(()=>({x:o,y:l,width:c,height:d,radius:u}),[o,l,c,d,u]),C=il(N,"rectangle-");if(o!==+o||l!==+l||c!==+c||d!==+d||c===0||d===0)return null;var w=_t("recharts-rectangle",f);if(!j){var _=Qn(n),{radius:I}=_,O=a0(_,hM);return p.createElement("path",Vc({},O,{radius:typeof u=="number"?u:void 0,className:w,d:o0(o,l,c,d,u)}))}var E=y.current,S=x.current,k=v.current,D=A.current,T="0px ".concat(s===-1?1:s,"px"),P="".concat(s,"px 0px"),R=$w(["strokeDasharray"],m,typeof h=="string"?h:l0.animationEasing);return p.createElement(rl,{animationId:C,key:C,canBegin:s>0,duration:m,easing:h,isActive:j,begin:g},Y=>{var X=Vt(E,c,Y),H=Vt(S,d,Y),q=Vt(k,o,Y),M=Vt(D,l,Y);i.current&&(y.current=X,x.current=H,v.current=q,A.current=M);var L;b?Y>0?L={transition:R,strokeDasharray:P}:L={strokeDasharray:T}:L={strokeDasharray:P};var B=Qn(n),{radius:F}=B,te=a0(B,pM);return p.createElement("path",Vc({},te,{radius:typeof u=="number"?u:void 0,className:w,d:o0(q,M,X,H,u),ref:i,style:s0(s0({},L),n.style)}))})};function c0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function d0(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?c0(Object(i),!0).forEach(function(s){vM(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):c0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function vM(e,n,i){return(n=bM(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function bM(e){var n=jM(e,"string");return typeof n=="symbol"?n:n+""}function jM(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var Xc=Math.PI/180,wM=e=>e*180/Math.PI,pn=(e,n,i,s)=>({x:e+Math.cos(-Xc*s)*i,y:n+Math.sin(-Xc*s)*i}),qw=function(n,i){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(n-(s.left||0)-(s.right||0)),Math.abs(i-(s.top||0)-(s.bottom||0)))/2},SM=(e,n)=>{var{x:i,y:s}=e,{x:a,y:o}=n;return Math.sqrt((i-a)**2+(s-o)**2)},kM=(e,n)=>{var{x:i,y:s}=e,{cx:a,cy:o}=n,l=SM({x:i,y:s},{x:a,y:o});if(l<=0)return{radius:l,angle:0};var c=(i-a)/l,d=Math.acos(c);return s>o&&(d=2*Math.PI-d),{radius:l,angle:wM(d),angleInRadian:d}},NM=e=>{var{startAngle:n,endAngle:i}=e,s=Math.floor(n/360),a=Math.floor(i/360),o=Math.min(s,a);return{startAngle:n-o*360,endAngle:i-o*360}},_M=(e,n)=>{var{startAngle:i,endAngle:s}=n,a=Math.floor(i/360),o=Math.floor(s/360),l=Math.min(a,o);return e+l*360},CM=(e,n)=>{var{chartX:i,chartY:s}=e,{radius:a,angle:o}=kM({x:i,y:s},n),{innerRadius:l,outerRadius:c}=n;if(a<l||a>c||a===0)return null;var{startAngle:d,endAngle:u}=NM(n),f=o,h;if(d<=u){for(;f>u;)f-=360;for(;f<d;)f+=360;h=f>=d&&f<=u}else{for(;f>d;)f-=360;for(;f<u;)f+=360;h=f>=u&&f<=d}return h?d0(d0({},n),{},{radius:a,angle:_M(f,n)}):null};function Uw(e){var{cx:n,cy:i,radius:s,startAngle:a,endAngle:o}=e,l=pn(n,i,s,a),c=pn(n,i,s,o);return{points:[l,c],cx:n,cy:i,radius:s,startAngle:a,endAngle:o}}function bh(){return bh=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},bh.apply(null,arguments)}var AM=(e,n)=>{var i=Cn(n-e),s=Math.min(Math.abs(n-e),359.999);return i*s},Wl=e=>{var{cx:n,cy:i,radius:s,angle:a,sign:o,isExternal:l,cornerRadius:c,cornerIsExternal:d}=e,u=c*(l?1:-1)+s,f=Math.asin(c/u)/Xc,h=d?a:a+o*f,m=pn(n,i,u,h),g=pn(n,i,s,h),b=d?a-o*f:a,j=pn(n,i,u*Math.cos(f*Xc),b);return{center:m,circleTangency:g,lineTangency:j,theta:f}},Hw=e=>{var{cx:n,cy:i,innerRadius:s,outerRadius:a,startAngle:o,endAngle:l}=e,c=AM(o,l),d=o+c,u=pn(n,i,a,o),f=pn(n,i,a,d),h="M ".concat(u.x,",").concat(u.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>d),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(s>0){var m=pn(n,i,s,o),g=pn(n,i,s,d);h+="L ".concat(g.x,",").concat(g.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=d),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(n,",").concat(i," Z");return h},IM=e=>{var{cx:n,cy:i,innerRadius:s,outerRadius:a,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:c,startAngle:d,endAngle:u}=e,f=Cn(u-d),{circleTangency:h,lineTangency:m,theta:g}=Wl({cx:n,cy:i,radius:a,angle:d,sign:f,cornerRadius:o,cornerIsExternal:c}),{circleTangency:b,lineTangency:j,theta:y}=Wl({cx:n,cy:i,radius:a,angle:u,sign:-f,cornerRadius:o,cornerIsExternal:c}),x=c?Math.abs(d-u):Math.abs(d-u)-g-y;if(x<0)return l?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):Hw({cx:n,cy:i,innerRadius:s,outerRadius:a,startAngle:d,endAngle:u});var v="M ".concat(m.x,",").concat(m.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(x>180),",").concat(+(f<0),",").concat(b.x,",").concat(b.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(j.x,",").concat(j.y,`
  `);if(s>0){var{circleTangency:A,lineTangency:N,theta:C}=Wl({cx:n,cy:i,radius:s,angle:d,sign:f,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),{circleTangency:w,lineTangency:_,theta:I}=Wl({cx:n,cy:i,radius:s,angle:u,sign:-f,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),O=c?Math.abs(d-u):Math.abs(d-u)-C-I;if(O<0&&o===0)return"".concat(v,"L").concat(n,",").concat(i,"Z");v+="L".concat(_.x,",").concat(_.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(w.x,",").concat(w.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(O>180),",").concat(+(f>0),",").concat(A.x,",").concat(A.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(f<0),",").concat(N.x,",").concat(N.y,"Z")}else v+="L".concat(n,",").concat(i,"Z");return v},TM={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},Yw=e=>{var n=Tn(e,TM),{cx:i,cy:s,innerRadius:a,outerRadius:o,cornerRadius:l,forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:f,className:h}=n;if(o<a||u===f)return null;var m=_t("recharts-sector",h),g=o-a,b=Bn(l,g,0,!0),j;return b>0&&Math.abs(u-f)<360?j=IM({cx:i,cy:s,innerRadius:a,outerRadius:o,cornerRadius:Math.min(b,g/2),forceCornerRadius:c,cornerIsExternal:d,startAngle:u,endAngle:f}):j=Hw({cx:i,cy:s,innerRadius:a,outerRadius:o,startAngle:u,endAngle:f}),p.createElement("path",bh({},Qn(n),{className:m,d:j}))};function EM(e,n,i){if(e==="horizontal")return[{x:n.x,y:i.top},{x:n.x,y:i.top+i.height}];if(e==="vertical")return[{x:i.left,y:n.y},{x:i.left+i.width,y:n.y}];if(yj(n)){if(e==="centric"){var{cx:s,cy:a,innerRadius:o,outerRadius:l,angle:c}=n,d=pn(s,a,o,c),u=pn(s,a,l,c);return[{x:d.x,y:d.y},{x:u.x,y:u.y}]}return Uw(n)}}var Kw={},Gw={},Vw={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Vp;function i(s){return n.isSymbol(s)?NaN:Number(s)}e.toNumber=i})(Vw);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Vw;function i(s){return s?(s=n.toNumber(s),s===1/0||s===-1/0?(s<0?-1:1)*Number.MAX_VALUE:s===s?s:0):s===0?s:0}e.toFinite=i})(Gw);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=Xp,i=Gw;function s(a,o,l){l&&typeof l!="number"&&n.isIterateeCall(a,o,l)&&(o=l=void 0),a=i.toFinite(a),o===void 0?(o=a,a=0):o=i.toFinite(o),l=l===void 0?a<o?1:-1:i.toFinite(l);const c=Math.max(Math.ceil((o-a)/(l||1)),0),d=new Array(c);for(let u=0;u<c;u++)d[u]=a,a+=l;return d}e.range=s})(Kw);var PM=Kw.range;const Xw=Wi(PM),po=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:up,scaleDiverging:C1,scaleDivergingLog:A1,scaleDivergingPow:Ap,scaleDivergingSqrt:B8,scaleDivergingSymlog:I1,scaleIdentity:o1,scaleImplicit:Gf,scaleLinear:a1,scaleLog:c1,scaleOrdinal:jd,scalePoint:J4,scalePow:xp,scaleQuantile:f1,scaleQuantize:h1,scaleRadial:u1,scaleSequential:S1,scaleSequentialLog:k1,scaleSequentialPow:Cp,scaleSequentialQuantile:_1,scaleSequentialSqrt:W8,scaleSequentialSymlog:N1,scaleSqrt:jP,scaleSymlog:d1,scaleThreshold:p1,scaleTime:$8,scaleUtc:L8,tickFormat:s1},Symbol.toStringTag,{value:"Module"}));var fs=e=>e.chartData,sm=Ie([fs],e=>{var n=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:n,dataStartIndex:0}}),Xd=(e,n,i,s)=>s?sm(e):fs(e);function Ls(e){if(Array.isArray(e)&&e.length===2){var[n,i]=e;if(un(n)&&un(i))return!0}return!1}function u0(e,n,i){return i?e:[Math.min(e[0],n[0]),Math.max(e[1],n[1])]}function Qw(e,n){if(n&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[i,s]=e,a,o;if(un(i))a=i;else if(typeof i=="function")return;if(un(s))o=s;else if(typeof s=="function")return;var l=[a,o];if(Ls(l))return l}}function OM(e,n,i){if(!(!i&&n==null)){if(typeof e=="function"&&n!=null)try{var s=e(n,i);if(Ls(s))return u0(s,n,i)}catch{}if(Array.isArray(e)&&e.length===2){var[a,o]=e,l,c;if(a==="auto")n!=null&&(l=Math.min(...n));else if(Qe(a))l=a;else if(typeof a=="function")try{n!=null&&(l=a(n==null?void 0:n[0]))}catch{}else if(typeof a=="string"&&$x.test(a)){var d=$x.exec(a);if(d==null||n==null)l=void 0;else{var u=+d[1];l=n[0]-u}}else l=n==null?void 0:n[0];if(o==="auto")n!=null&&(c=Math.max(...n));else if(Qe(o))c=o;else if(typeof o=="function")try{n!=null&&(c=o(n==null?void 0:n[1]))}catch{}else if(typeof o=="string"&&Lx.test(o)){var f=Lx.exec(o);if(f==null||n==null)c=void 0;else{var h=+f[1];c=n[1]+h}}else c=n==null?void 0:n[1];var m=[l,c];if(Ls(m))return n==null?m:u0(m,n,i)}}}var Ca=1e9,DM={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},om,Jt=!0,Pr="[DecimalError] ",Es=Pr+"Invalid argument: ",am=Pr+"Exponent out of range: ",Aa=Math.floor,bs=Math.pow,zM=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,hr,_n=1e7,Ht=7,Jw=9007199254740991,Qc=Aa(Jw/Ht),Ge={};Ge.absoluteValue=Ge.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Ge.comparedTo=Ge.cmp=function(e){var n,i,s,a,o=this;if(e=new o.constructor(e),o.s!==e.s)return o.s||-e.s;if(o.e!==e.e)return o.e>e.e^o.s<0?1:-1;for(s=o.d.length,a=e.d.length,n=0,i=s<a?s:a;n<i;++n)if(o.d[n]!==e.d[n])return o.d[n]>e.d[n]^o.s<0?1:-1;return s===a?0:s>a^o.s<0?1:-1};Ge.decimalPlaces=Ge.dp=function(){var e=this,n=e.d.length-1,i=(n-e.e)*Ht;if(n=e.d[n],n)for(;n%10==0;n/=10)i--;return i<0?0:i};Ge.dividedBy=Ge.div=function(e){return Ai(this,new this.constructor(e))};Ge.dividedToIntegerBy=Ge.idiv=function(e){var n=this,i=n.constructor;return Lt(Ai(n,new i(e),0,1),i.precision)};Ge.equals=Ge.eq=function(e){return!this.cmp(e)};Ge.exponent=function(){return gn(this)};Ge.greaterThan=Ge.gt=function(e){return this.cmp(e)>0};Ge.greaterThanOrEqualTo=Ge.gte=function(e){return this.cmp(e)>=0};Ge.isInteger=Ge.isint=function(){return this.e>this.d.length-2};Ge.isNegative=Ge.isneg=function(){return this.s<0};Ge.isPositive=Ge.ispos=function(){return this.s>0};Ge.isZero=function(){return this.s===0};Ge.lessThan=Ge.lt=function(e){return this.cmp(e)<0};Ge.lessThanOrEqualTo=Ge.lte=function(e){return this.cmp(e)<1};Ge.logarithm=Ge.log=function(e){var n,i=this,s=i.constructor,a=s.precision,o=a+5;if(e===void 0)e=new s(10);else if(e=new s(e),e.s<1||e.eq(hr))throw Error(Pr+"NaN");if(i.s<1)throw Error(Pr+(i.s?"NaN":"-Infinity"));return i.eq(hr)?new s(0):(Jt=!1,n=Ai(Lo(i,o),Lo(e,o),o),Jt=!0,Lt(n,a))};Ge.minus=Ge.sub=function(e){var n=this;return e=new n.constructor(e),n.s==e.s?tS(n,e):Zw(n,(e.s=-e.s,e))};Ge.modulo=Ge.mod=function(e){var n,i=this,s=i.constructor,a=s.precision;if(e=new s(e),!e.s)throw Error(Pr+"NaN");return i.s?(Jt=!1,n=Ai(i,e,0,1).times(e),Jt=!0,i.minus(n)):Lt(new s(i),a)};Ge.naturalExponential=Ge.exp=function(){return eS(this)};Ge.naturalLogarithm=Ge.ln=function(){return Lo(this)};Ge.negated=Ge.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Ge.plus=Ge.add=function(e){var n=this;return e=new n.constructor(e),n.s==e.s?Zw(n,e):tS(n,(e.s=-e.s,e))};Ge.precision=Ge.sd=function(e){var n,i,s,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Es+e);if(n=gn(a)+1,s=a.d.length-1,i=s*Ht+1,s=a.d[s],s){for(;s%10==0;s/=10)i--;for(s=a.d[0];s>=10;s/=10)i++}return e&&n>i?n:i};Ge.squareRoot=Ge.sqrt=function(){var e,n,i,s,a,o,l,c=this,d=c.constructor;if(c.s<1){if(!c.s)return new d(0);throw Error(Pr+"NaN")}for(e=gn(c),Jt=!1,a=Math.sqrt(+c),a==0||a==1/0?(n=ni(c.d),(n.length+e)%2==0&&(n+="0"),a=Math.sqrt(n),e=Aa((e+1)/2)-(e<0||e%2),a==1/0?n="5e"+e:(n=a.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),s=new d(n)):s=new d(a.toString()),i=d.precision,a=l=i+3;;)if(o=s,s=o.plus(Ai(c,o,l+2)).times(.5),ni(o.d).slice(0,l)===(n=ni(s.d)).slice(0,l)){if(n=n.slice(l-3,l+1),a==l&&n=="4999"){if(Lt(o,i+1,0),o.times(o).eq(c)){s=o;break}}else if(n!="9999")break;l+=4}return Jt=!0,Lt(s,i)};Ge.times=Ge.mul=function(e){var n,i,s,a,o,l,c,d,u,f=this,h=f.constructor,m=f.d,g=(e=new h(e)).d;if(!f.s||!e.s)return new h(0);for(e.s*=f.s,i=f.e+e.e,d=m.length,u=g.length,d<u&&(o=m,m=g,g=o,l=d,d=u,u=l),o=[],l=d+u,s=l;s--;)o.push(0);for(s=u;--s>=0;){for(n=0,a=d+s;a>s;)c=o[a]+g[s]*m[a-s-1]+n,o[a--]=c%_n|0,n=c/_n|0;o[a]=(o[a]+n)%_n|0}for(;!o[--l];)o.pop();return n?++i:o.shift(),e.d=o,e.e=i,Jt?Lt(e,h.precision):e};Ge.toDecimalPlaces=Ge.todp=function(e,n){var i=this,s=i.constructor;return i=new s(i),e===void 0?i:(oi(e,0,Ca),n===void 0?n=s.rounding:oi(n,0,8),Lt(i,e+gn(i)+1,n))};Ge.toExponential=function(e,n){var i,s=this,a=s.constructor;return e===void 0?i=Ws(s,!0):(oi(e,0,Ca),n===void 0?n=a.rounding:oi(n,0,8),s=Lt(new a(s),e+1,n),i=Ws(s,!0,e+1)),i};Ge.toFixed=function(e,n){var i,s,a=this,o=a.constructor;return e===void 0?Ws(a):(oi(e,0,Ca),n===void 0?n=o.rounding:oi(n,0,8),s=Lt(new o(a),e+gn(a)+1,n),i=Ws(s.abs(),!1,e+gn(s)+1),a.isneg()&&!a.isZero()?"-"+i:i)};Ge.toInteger=Ge.toint=function(){var e=this,n=e.constructor;return Lt(new n(e),gn(e)+1,n.rounding)};Ge.toNumber=function(){return+this};Ge.toPower=Ge.pow=function(e){var n,i,s,a,o,l,c=this,d=c.constructor,u=12,f=+(e=new d(e));if(!e.s)return new d(hr);if(c=new d(c),!c.s){if(e.s<1)throw Error(Pr+"Infinity");return c}if(c.eq(hr))return c;if(s=d.precision,e.eq(hr))return Lt(c,s);if(n=e.e,i=e.d.length-1,l=n>=i,o=c.s,l){if((i=f<0?-f:f)<=Jw){for(a=new d(hr),n=Math.ceil(s/Ht+4),Jt=!1;i%2&&(a=a.times(c),h0(a.d,n)),i=Aa(i/2),i!==0;)c=c.times(c),h0(c.d,n);return Jt=!0,e.s<0?new d(hr).div(a):Lt(a,s)}}else if(o<0)throw Error(Pr+"NaN");return o=o<0&&e.d[Math.max(n,i)]&1?-1:1,c.s=1,Jt=!1,a=e.times(Lo(c,s+u)),Jt=!0,a=eS(a),a.s=o,a};Ge.toPrecision=function(e,n){var i,s,a=this,o=a.constructor;return e===void 0?(i=gn(a),s=Ws(a,i<=o.toExpNeg||i>=o.toExpPos)):(oi(e,1,Ca),n===void 0?n=o.rounding:oi(n,0,8),a=Lt(new o(a),e,n),i=gn(a),s=Ws(a,e<=i||i<=o.toExpNeg,e)),s};Ge.toSignificantDigits=Ge.tosd=function(e,n){var i=this,s=i.constructor;return e===void 0?(e=s.precision,n=s.rounding):(oi(e,1,Ca),n===void 0?n=s.rounding:oi(n,0,8)),Lt(new s(i),e,n)};Ge.toString=Ge.valueOf=Ge.val=Ge.toJSON=Ge[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,n=gn(e),i=e.constructor;return Ws(e,n<=i.toExpNeg||n>=i.toExpPos)};function Zw(e,n){var i,s,a,o,l,c,d,u,f=e.constructor,h=f.precision;if(!e.s||!n.s)return n.s||(n=new f(e)),Jt?Lt(n,h):n;if(d=e.d,u=n.d,l=e.e,a=n.e,d=d.slice(),o=l-a,o){for(o<0?(s=d,o=-o,c=u.length):(s=u,a=l,c=d.length),l=Math.ceil(h/Ht),c=l>c?l+1:c+1,o>c&&(o=c,s.length=1),s.reverse();o--;)s.push(0);s.reverse()}for(c=d.length,o=u.length,c-o<0&&(o=c,s=u,u=d,d=s),i=0;o;)i=(d[--o]=d[o]+u[o]+i)/_n|0,d[o]%=_n;for(i&&(d.unshift(i),++a),c=d.length;d[--c]==0;)d.pop();return n.d=d,n.e=a,Jt?Lt(n,h):n}function oi(e,n,i){if(e!==~~e||e<n||e>i)throw Error(Es+e)}function ni(e){var n,i,s,a=e.length-1,o="",l=e[0];if(a>0){for(o+=l,n=1;n<a;n++)s=e[n]+"",i=Ht-s.length,i&&(o+=Zi(i)),o+=s;l=e[n],s=l+"",i=Ht-s.length,i&&(o+=Zi(i))}else if(l===0)return"0";for(;l%10===0;)l/=10;return o+l}var Ai=function(){function e(s,a){var o,l=0,c=s.length;for(s=s.slice();c--;)o=s[c]*a+l,s[c]=o%_n|0,l=o/_n|0;return l&&s.unshift(l),s}function n(s,a,o,l){var c,d;if(o!=l)d=o>l?1:-1;else for(c=d=0;c<o;c++)if(s[c]!=a[c]){d=s[c]>a[c]?1:-1;break}return d}function i(s,a,o){for(var l=0;o--;)s[o]-=l,l=s[o]<a[o]?1:0,s[o]=l*_n+s[o]-a[o];for(;!s[0]&&s.length>1;)s.shift()}return function(s,a,o,l){var c,d,u,f,h,m,g,b,j,y,x,v,A,N,C,w,_,I,O=s.constructor,E=s.s==a.s?1:-1,S=s.d,k=a.d;if(!s.s)return new O(s);if(!a.s)throw Error(Pr+"Division by zero");for(d=s.e-a.e,_=k.length,C=S.length,g=new O(E),b=g.d=[],u=0;k[u]==(S[u]||0);)++u;if(k[u]>(S[u]||0)&&--d,o==null?v=o=O.precision:l?v=o+(gn(s)-gn(a))+1:v=o,v<0)return new O(0);if(v=v/Ht+2|0,u=0,_==1)for(f=0,k=k[0],v++;(u<C||f)&&v--;u++)A=f*_n+(S[u]||0),b[u]=A/k|0,f=A%k|0;else{for(f=_n/(k[0]+1)|0,f>1&&(k=e(k,f),S=e(S,f),_=k.length,C=S.length),N=_,j=S.slice(0,_),y=j.length;y<_;)j[y++]=0;I=k.slice(),I.unshift(0),w=k[0],k[1]>=_n/2&&++w;do f=0,c=n(k,j,_,y),c<0?(x=j[0],_!=y&&(x=x*_n+(j[1]||0)),f=x/w|0,f>1?(f>=_n&&(f=_n-1),h=e(k,f),m=h.length,y=j.length,c=n(h,j,m,y),c==1&&(f--,i(h,_<m?I:k,m))):(f==0&&(c=f=1),h=k.slice()),m=h.length,m<y&&h.unshift(0),i(j,h,y),c==-1&&(y=j.length,c=n(k,j,_,y),c<1&&(f++,i(j,_<y?I:k,y))),y=j.length):c===0&&(f++,j=[0]),b[u++]=f,c&&j[0]?j[y++]=S[N]||0:(j=[S[N]],y=1);while((N++<C||j[0]!==void 0)&&v--)}return b[0]||b.shift(),g.e=d,Lt(g,l?o+gn(g)+1:o)}}();function eS(e,n){var i,s,a,o,l,c,d=0,u=0,f=e.constructor,h=f.precision;if(gn(e)>16)throw Error(am+gn(e));if(!e.s)return new f(hr);for(Jt=!1,c=h,l=new f(.03125);e.abs().gte(.1);)e=e.times(l),u+=5;for(s=Math.log(bs(2,u))/Math.LN10*2+5|0,c+=s,i=a=o=new f(hr),f.precision=c;;){if(a=Lt(a.times(e),c),i=i.times(++d),l=o.plus(Ai(a,i,c)),ni(l.d).slice(0,c)===ni(o.d).slice(0,c)){for(;u--;)o=Lt(o.times(o),c);return f.precision=h,n==null?(Jt=!0,Lt(o,h)):o}o=l}}function gn(e){for(var n=e.e*Ht,i=e.d[0];i>=10;i/=10)n++;return n}function af(e,n,i){if(n>e.LN10.sd())throw Jt=!0,i&&(e.precision=i),Error(Pr+"LN10 precision limit exceeded");return Lt(new e(e.LN10),n)}function Zi(e){for(var n="";e--;)n+="0";return n}function Lo(e,n){var i,s,a,o,l,c,d,u,f,h=1,m=10,g=e,b=g.d,j=g.constructor,y=j.precision;if(g.s<1)throw Error(Pr+(g.s?"NaN":"-Infinity"));if(g.eq(hr))return new j(0);if(n==null?(Jt=!1,u=y):u=n,g.eq(10))return n==null&&(Jt=!0),af(j,u);if(u+=m,j.precision=u,i=ni(b),s=i.charAt(0),o=gn(g),Math.abs(o)<15e14){for(;s<7&&s!=1||s==1&&i.charAt(1)>3;)g=g.times(e),i=ni(g.d),s=i.charAt(0),h++;o=gn(g),s>1?(g=new j("0."+i),o++):g=new j(s+"."+i.slice(1))}else return d=af(j,u+2,y).times(o+""),g=Lo(new j(s+"."+i.slice(1)),u-m).plus(d),j.precision=y,n==null?(Jt=!0,Lt(g,y)):g;for(c=l=g=Ai(g.minus(hr),g.plus(hr),u),f=Lt(g.times(g),u),a=3;;){if(l=Lt(l.times(f),u),d=c.plus(Ai(l,new j(a),u)),ni(d.d).slice(0,u)===ni(c.d).slice(0,u))return c=c.times(2),o!==0&&(c=c.plus(af(j,u+2,y).times(o+""))),c=Ai(c,new j(h),u),j.precision=y,n==null?(Jt=!0,Lt(c,y)):c;c=d,a+=2}}function f0(e,n){var i,s,a;for((i=n.indexOf("."))>-1&&(n=n.replace(".","")),(s=n.search(/e/i))>0?(i<0&&(i=s),i+=+n.slice(s+1),n=n.substring(0,s)):i<0&&(i=n.length),s=0;n.charCodeAt(s)===48;)++s;for(a=n.length;n.charCodeAt(a-1)===48;)--a;if(n=n.slice(s,a),n){if(a-=s,i=i-s-1,e.e=Aa(i/Ht),e.d=[],s=(i+1)%Ht,i<0&&(s+=Ht),s<a){for(s&&e.d.push(+n.slice(0,s)),a-=Ht;s<a;)e.d.push(+n.slice(s,s+=Ht));n=n.slice(s),s=Ht-n.length}else s-=a;for(;s--;)n+="0";if(e.d.push(+n),Jt&&(e.e>Qc||e.e<-Qc))throw Error(am+i)}else e.s=0,e.e=0,e.d=[0];return e}function Lt(e,n,i){var s,a,o,l,c,d,u,f,h=e.d;for(l=1,o=h[0];o>=10;o/=10)l++;if(s=n-l,s<0)s+=Ht,a=n,u=h[f=0];else{if(f=Math.ceil((s+1)/Ht),o=h.length,f>=o)return e;for(u=o=h[f],l=1;o>=10;o/=10)l++;s%=Ht,a=s-Ht+l}if(i!==void 0&&(o=bs(10,l-a-1),c=u/o%10|0,d=n<0||h[f+1]!==void 0||u%o,d=i<4?(c||d)&&(i==0||i==(e.s<0?3:2)):c>5||c==5&&(i==4||d||i==6&&(s>0?a>0?u/bs(10,l-a):0:h[f-1])%10&1||i==(e.s<0?8:7))),n<1||!h[0])return d?(o=gn(e),h.length=1,n=n-o-1,h[0]=bs(10,(Ht-n%Ht)%Ht),e.e=Aa(-n/Ht)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(s==0?(h.length=f,o=1,f--):(h.length=f+1,o=bs(10,Ht-s),h[f]=a>0?(u/bs(10,l-a)%bs(10,a)|0)*o:0),d)for(;;)if(f==0){(h[0]+=o)==_n&&(h[0]=1,++e.e);break}else{if(h[f]+=o,h[f]!=_n)break;h[f--]=0,o=1}for(s=h.length;h[--s]===0;)h.pop();if(Jt&&(e.e>Qc||e.e<-Qc))throw Error(am+gn(e));return e}function tS(e,n){var i,s,a,o,l,c,d,u,f,h,m=e.constructor,g=m.precision;if(!e.s||!n.s)return n.s?n.s=-n.s:n=new m(e),Jt?Lt(n,g):n;if(d=e.d,h=n.d,s=n.e,u=e.e,d=d.slice(),l=u-s,l){for(f=l<0,f?(i=d,l=-l,c=h.length):(i=h,s=u,c=d.length),a=Math.max(Math.ceil(g/Ht),c)+2,l>a&&(l=a,i.length=1),i.reverse(),a=l;a--;)i.push(0);i.reverse()}else{for(a=d.length,c=h.length,f=a<c,f&&(c=a),a=0;a<c;a++)if(d[a]!=h[a]){f=d[a]<h[a];break}l=0}for(f&&(i=d,d=h,h=i,n.s=-n.s),c=d.length,a=h.length-c;a>0;--a)d[c++]=0;for(a=h.length;a>l;){if(d[--a]<h[a]){for(o=a;o&&d[--o]===0;)d[o]=_n-1;--d[o],d[a]+=_n}d[a]-=h[a]}for(;d[--c]===0;)d.pop();for(;d[0]===0;d.shift())--s;return d[0]?(n.d=d,n.e=s,Jt?Lt(n,g):n):new m(0)}function Ws(e,n,i){var s,a=gn(e),o=ni(e.d),l=o.length;return n?(i&&(s=i-l)>0?o=o.charAt(0)+"."+o.slice(1)+Zi(s):l>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(a<0?"e":"e+")+a):a<0?(o="0."+Zi(-a-1)+o,i&&(s=i-l)>0&&(o+=Zi(s))):a>=l?(o+=Zi(a+1-l),i&&(s=i-a-1)>0&&(o=o+"."+Zi(s))):((s=a+1)<l&&(o=o.slice(0,s)+"."+o.slice(s)),i&&(s=i-l)>0&&(a+1===l&&(o+="."),o+=Zi(s))),e.s<0?"-"+o:o}function h0(e,n){if(e.length>n)return e.length=n,!0}function nS(e){var n,i,s;function a(o){var l=this;if(!(l instanceof a))return new a(o);if(l.constructor=a,o instanceof a){l.s=o.s,l.e=o.e,l.d=(o=o.d)?o.slice():o;return}if(typeof o=="number"){if(o*0!==0)throw Error(Es+o);if(o>0)l.s=1;else if(o<0)o=-o,l.s=-1;else{l.s=0,l.e=0,l.d=[0];return}if(o===~~o&&o<1e7){l.e=0,l.d=[o];return}return f0(l,o.toString())}else if(typeof o!="string")throw Error(Es+o);if(o.charCodeAt(0)===45?(o=o.slice(1),l.s=-1):l.s=1,zM.test(o))f0(l,o);else throw Error(Es+o)}if(a.prototype=Ge,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=nS,a.config=a.set=MM,e===void 0&&(e={}),e)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],n=0;n<s.length;)e.hasOwnProperty(i=s[n++])||(e[i]=this[i]);return a.config(e),a}function MM(e){if(!e||typeof e!="object")throw Error(Pr+"Object expected");var n,i,s,a=["precision",1,Ca,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(n=0;n<a.length;n+=3)if((s=e[i=a[n]])!==void 0)if(Aa(s)===s&&s>=a[n+1]&&s<=a[n+2])this[i]=s;else throw Error(Es+i+": "+s);if((s=e[i="LN10"])!==void 0)if(s==Math.LN10)this[i]=new this(s);else throw Error(Es+i+": "+s);return this}var om=nS(DM);hr=new om(1);const Pt=om;var RM=e=>e,rS={},iS=e=>e===rS,p0=e=>function n(){return arguments.length===0||arguments.length===1&&iS(arguments.length<=0?void 0:arguments[0])?n:e(...arguments)},sS=(e,n)=>e===1?n:p0(function(){for(var i=arguments.length,s=new Array(i),a=0;a<i;a++)s[a]=arguments[a];var o=s.filter(l=>l!==rS).length;return o>=e?n(...s):sS(e-o,p0(function(){for(var l=arguments.length,c=new Array(l),d=0;d<l;d++)c[d]=arguments[d];var u=s.map(f=>iS(f)?c.shift():f);return n(...u,...c)}))}),Qd=e=>sS(e.length,e),jh=(e,n)=>{for(var i=[],s=e;s<n;++s)i[s-e]=s;return i},$M=Qd((e,n)=>Array.isArray(n)?n.map(e):Object.keys(n).map(i=>n[i]).map(e)),LM=function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];if(!i.length)return RM;var a=i.reverse(),o=a[0],l=a.slice(1);return function(){return l.reduce((c,d)=>d(c),o(...arguments))}},wh=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),aS=e=>{var n=null,i=null;return function(){for(var s=arguments.length,a=new Array(s),o=0;o<s;o++)a[o]=arguments[o];return n&&a.every((l,c)=>{var d;return l===((d=n)===null||d===void 0?void 0:d[c])})||(n=a,i=e(...a)),i}};function oS(e){var n;return e===0?n=1:n=Math.floor(new Pt(e).abs().log(10).toNumber())+1,n}function lS(e,n,i){for(var s=new Pt(e),a=0,o=[];s.lt(n)&&a<1e5;)o.push(s.toNumber()),s=s.add(i),a++;return o}Qd((e,n,i)=>{var s=+e,a=+n;return s+i*(a-s)});Qd((e,n,i)=>{var s=n-+e;return s=s||1/0,(i-e)/s});Qd((e,n,i)=>{var s=n-+e;return s=s||1/0,Math.max(0,Math.min(1,(i-e)/s))});var cS=e=>{var[n,i]=e,[s,a]=[n,i];return n>i&&([s,a]=[i,n]),[s,a]},dS=(e,n,i)=>{if(e.lte(0))return new Pt(0);var s=oS(e.toNumber()),a=new Pt(10).pow(s),o=e.div(a),l=s!==1?.05:.1,c=new Pt(Math.ceil(o.div(l).toNumber())).add(i).mul(l),d=c.mul(a);return n?new Pt(d.toNumber()):new Pt(Math.ceil(d.toNumber()))},WM=(e,n,i)=>{var s=new Pt(1),a=new Pt(e);if(!a.isint()&&i){var o=Math.abs(e);o<1?(s=new Pt(10).pow(oS(e)-1),a=new Pt(Math.floor(a.div(s).toNumber())).mul(s)):o>1&&(a=new Pt(Math.floor(e)))}else e===0?a=new Pt(Math.floor((n-1)/2)):i||(a=new Pt(Math.floor(e)));var l=Math.floor((n-1)/2),c=LM($M(d=>a.add(new Pt(d-l).mul(s)).toNumber()),jh);return c(0,n)},uS=function(n,i,s,a){var o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((i-n)/(s-1)))return{step:new Pt(0),tickMin:new Pt(0),tickMax:new Pt(0)};var l=dS(new Pt(i).sub(n).div(s-1),a,o),c;n<=0&&i>=0?c=new Pt(0):(c=new Pt(n).add(i).div(2),c=c.sub(new Pt(c).mod(l)));var d=Math.ceil(c.sub(n).div(l).toNumber()),u=Math.ceil(new Pt(i).sub(c).div(l).toNumber()),f=d+u+1;return f>s?uS(n,i,s,a,o+1):(f<s&&(u=i>0?u+(s-f):u,d=i>0?d:d+(s-f)),{step:l,tickMin:c.sub(new Pt(d).mul(l)),tickMax:c.add(new Pt(u).mul(l))})};function BM(e){var[n,i]=e,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(s,2),[l,c]=cS([n,i]);if(l===-1/0||c===1/0){var d=c===1/0?[l,...jh(0,s-1).map(()=>1/0)]:[...jh(0,s-1).map(()=>-1/0),c];return n>i?wh(d):d}if(l===c)return WM(l,s,a);var{step:u,tickMin:f,tickMax:h}=uS(l,c,o,a,0),m=lS(f,h.add(new Pt(.1).mul(u)),u);return n>i?wh(m):m}function FM(e,n){var[i,s]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[o,l]=cS([i,s]);if(o===-1/0||l===1/0)return[i,s];if(o===l)return[o];var c=Math.max(n,2),d=dS(new Pt(l).sub(o).div(c-1),a,0),u=[...lS(new Pt(o),new Pt(l),d),l];return a===!1&&(u=u.map(f=>Math.round(f))),i>s?wh(u):u}var qM=aS(BM),UM=aS(FM),fS=e=>e.rootProps.maxBarSize,HM=e=>e.rootProps.barGap,hS=e=>e.rootProps.barCategoryGap,YM=e=>e.rootProps.barSize,sl=e=>e.rootProps.stackOffset,lm=e=>e.options.chartName,cm=e=>e.rootProps.syncId,pS=e=>e.rootProps.syncMethod,dm=e=>e.options.eventEmitter,mn={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},vi={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},ur={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},Jd=(e,n)=>{if(!(!e||!n))return e!=null&&e.reversed?[n[1],n[0]]:n},KM={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:vi.angleAxisId,includeHidden:!1,name:void 0,reversed:vi.reversed,scale:vi.scale,tick:vi.tick,tickCount:void 0,ticks:void 0,type:vi.type,unit:void 0},GM={allowDataOverflow:ur.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ur.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ur.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ur.scale,tick:ur.tick,tickCount:ur.tickCount,ticks:void 0,type:ur.type,unit:void 0},VM={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:vi.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:vi.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:vi.scale,tick:vi.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},XM={allowDataOverflow:ur.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:ur.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:ur.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:ur.scale,tick:ur.tick,tickCount:ur.tickCount,ticks:void 0,type:"category",unit:void 0},um=(e,n)=>e.polarAxis.angleAxis[n]!=null?e.polarAxis.angleAxis[n]:e.layout.layoutType==="radial"?VM:KM,fm=(e,n)=>e.polarAxis.radiusAxis[n]!=null?e.polarAxis.radiusAxis[n]:e.layout.layoutType==="radial"?XM:GM,Zd=e=>e.polarOptions,hm=Ie([Fi,qi,wn],qw),mS=Ie([Zd,hm],(e,n)=>{if(e!=null)return Bn(e.innerRadius,n,0)}),gS=Ie([Zd,hm],(e,n)=>{if(e!=null)return Bn(e.outerRadius,n,n*.8)}),QM=e=>{if(e==null)return[0,0];var{startAngle:n,endAngle:i}=e;return[n,i]},yS=Ie([Zd],QM);Ie([um,yS],Jd);var xS=Ie([hm,mS,gS],(e,n,i)=>{if(!(e==null||n==null||i==null))return[n,i]});Ie([fm,xS],Jd);var vS=Ie([wt,Zd,mS,gS,Fi,qi],(e,n,i,s,a,o)=>{if(!(e!=="centric"&&e!=="radial"||n==null||i==null||s==null)){var{cx:l,cy:c,startAngle:d,endAngle:u}=n;return{cx:Bn(l,a,a/2),cy:Bn(c,o,o/2),innerRadius:i,outerRadius:s,startAngle:d,endAngle:u,clockWise:!1}}}),tn=(e,n)=>n,al=(e,n,i)=>i;function pm(e){return e==null?void 0:e.id}function bS(e,n,i){var{chartData:s=[]}=n,{allowDuplicatedCategory:a,dataKey:o}=i,l=new Map;return e.forEach(c=>{var d,u=(d=c.data)!==null&&d!==void 0?d:s;if(!(u==null||u.length===0)){var f=pm(c);u.forEach((h,m)=>{var g=o==null||a?m:String(Ft(h,o,null)),b=Ft(h,c.dataKey,0),j;l.has(g)?j=l.get(g):j={},Object.assign(j,{[f]:b}),l.set(g,j)})}}),Array.from(l.values())}function eu(e){return e.stackId!=null&&e.dataKey!=null}var tu=(e,n)=>e===n?!0:e==null||n==null?!1:e[0]===n[0]&&e[1]===n[1];function nu(e,n){return Array.isArray(e)&&Array.isArray(n)&&e.length===0&&n.length===0?!0:e===n}function JM(e,n){if(e.length===n.length){for(var i=0;i<e.length;i++)if(e[i]!==n[i])return!1;return!0}return!1}var Sn=e=>{var n=wt(e);return n==="horizontal"?"xAxis":n==="vertical"?"yAxis":n==="centric"?"angleAxis":"radiusAxis"},Ia=e=>e.tooltip.settings.axisId;function m0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function Jc(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?m0(Object(i),!0).forEach(function(s){ZM(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):m0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function ZM(e,n,i){return(n=eR(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function eR(e){var n=tR(e,"string");return typeof n=="symbol"?n:n+""}function tR(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var Sh=[0,"auto"],cr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},jS=(e,n)=>e.cartesianAxis.xAxis[n],Ui=(e,n)=>{var i=jS(e,n);return i??cr},dr={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Sh,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:tl},wS=(e,n)=>e.cartesianAxis.yAxis[n],Hi=(e,n)=>{var i=wS(e,n);return i??dr},nR={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},mm=(e,n)=>{var i=e.cartesianAxis.zAxis[n];return i??nR},an=(e,n,i)=>{switch(n){case"xAxis":return Ui(e,i);case"yAxis":return Hi(e,i);case"zAxis":return mm(e,i);case"angleAxis":return um(e,i);case"radiusAxis":return fm(e,i);default:throw new Error("Unexpected axis type: ".concat(n))}},rR=(e,n,i)=>{switch(n){case"xAxis":return Ui(e,i);case"yAxis":return Hi(e,i);default:throw new Error("Unexpected axis type: ".concat(n))}},ol=(e,n,i)=>{switch(n){case"xAxis":return Ui(e,i);case"yAxis":return Hi(e,i);case"angleAxis":return um(e,i);case"radiusAxis":return fm(e,i);default:throw new Error("Unexpected axis type: ".concat(n))}},SS=e=>e.graphicalItems.cartesianItems.some(n=>n.type==="bar")||e.graphicalItems.polarItems.some(n=>n.type==="radialBar");function gm(e,n){return i=>{switch(e){case"xAxis":return"xAxisId"in i&&i.xAxisId===n;case"yAxis":return"yAxisId"in i&&i.yAxisId===n;case"zAxis":return"zAxisId"in i&&i.zAxisId===n;case"angleAxis":return"angleAxisId"in i&&i.angleAxisId===n;case"radiusAxis":return"radiusAxisId"in i&&i.radiusAxisId===n;default:return!1}}}var ru=e=>e.graphicalItems.cartesianItems,iR=Ie([tn,al],gm),ym=(e,n,i)=>e.filter(i).filter(s=>(n==null?void 0:n.includeHidden)===!0?!0:!s.hide),ll=Ie([ru,an,iR],ym,{memoizeOptions:{resultEqualityCheck:nu}}),kS=Ie([ll],e=>e.filter(n=>n.type==="area"||n.type==="bar").filter(eu)),NS=e=>e.filter(n=>!("stackId"in n)||n.stackId===void 0),sR=Ie([ll],NS),xm=e=>e.map(n=>n.data).filter(Boolean).flat(1),aR=Ie([ll],xm,{memoizeOptions:{resultEqualityCheck:nu}}),vm=(e,n)=>{var{chartData:i=[],dataStartIndex:s,dataEndIndex:a}=n;return e.length>0?e:i.slice(s,a+1)},bm=Ie([aR,Xd],vm),jm=(e,n,i)=>(n==null?void 0:n.dataKey)!=null?e.map(s=>({value:Ft(s,n.dataKey)})):i.length>0?i.map(s=>s.dataKey).flatMap(s=>e.map(a=>({value:Ft(a,s)}))):e.map(s=>({value:s})),iu=Ie([bm,an,ll],jm);function _S(e,n){switch(e){case"xAxis":return n.direction==="x";case"yAxis":return n.direction==="y";default:return!1}}function lc(e){if(si(e)||e instanceof Date){var n=Number(e);if(un(n))return n}}function g0(e){if(Array.isArray(e)){var n=[lc(e[0]),lc(e[1])];return Ls(n)?n:void 0}var i=lc(e);if(i!=null)return[i,i]}function $i(e){return e.map(lc).filter(TO)}function oR(e,n,i){return!i||typeof n!="number"||Ur(n)?[]:i.length?$i(i.flatMap(s=>{var a=Ft(e,s.dataKey),o,l;if(Array.isArray(a)?[o,l]=a:o=l=a,!(!un(o)||!un(l)))return[n-o,n+l]})):[]}var kn=e=>{var n=Sn(e),i=Ia(e);return ol(e,n,i)},CS=Ie([kn],e=>e==null?void 0:e.dataKey),lR=Ie([kS,Xd,kn],bS),AS=(e,n,i)=>{var s={},a=n.reduce((o,l)=>(l.stackId==null||(o[l.stackId]==null&&(o[l.stackId]=[]),o[l.stackId].push(l)),o),s);return Object.fromEntries(Object.entries(a).map(o=>{var[l,c]=o,d=c.map(pm);return[l,{stackedData:zz(e,d,i),graphicalItems:c}]}))},kh=Ie([lR,kS,sl],AS),IS=(e,n,i,s)=>{var{dataStartIndex:a,dataEndIndex:o}=n;if(s==null&&i!=="zAxis"){var l=Wz(e,a,o);if(!(l!=null&&l[0]===0&&l[1]===0))return l}},cR=Ie([an],e=>e.allowDataOverflow),wm=e=>{var n;if(e==null||!("domain"in e))return Sh;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var i=$i(e.ticks);return[Math.min(...i),Math.max(...i)]}if(e.type==="category")return e.ticks.map(String)}return(n=e==null?void 0:e.domain)!==null&&n!==void 0?n:Sh},Sm=Ie([an],wm),km=Ie([Sm,cR],Qw),dR=Ie([kh,fs,tn,km],IS,{memoizeOptions:{resultEqualityCheck:tu}}),su=e=>e.errorBars,uR=(e,n,i)=>e.flatMap(s=>n[s.id]).filter(Boolean).filter(s=>_S(i,s)),Zc=function(){for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];var a=i.filter(Boolean);if(a.length!==0){var o=a.flat(),l=Math.min(...o),c=Math.max(...o);return[l,c]}},Nm=(e,n,i,s,a)=>{var o,l;if(i.length>0&&e.forEach(c=>{i.forEach(d=>{var u,f,h=(u=s[d.id])===null||u===void 0?void 0:u.filter(x=>_S(a,x)),m=Ft(c,(f=n.dataKey)!==null&&f!==void 0?f:d.dataKey),g=oR(c,m,h);if(g.length>=2){var b=Math.min(...g),j=Math.max(...g);(o==null||b<o)&&(o=b),(l==null||j>l)&&(l=j)}var y=g0(m);y!=null&&(o=o==null?y[0]:Math.min(o,y[0]),l=l==null?y[1]:Math.max(l,y[1]))})}),(n==null?void 0:n.dataKey)!=null&&e.forEach(c=>{var d=g0(Ft(c,n.dataKey));d!=null&&(o=o==null?d[0]:Math.min(o,d[0]),l=l==null?d[1]:Math.max(l,d[1]))}),un(o)&&un(l))return[o,l]},fR=Ie([bm,an,sR,su,tn],Nm,{memoizeOptions:{resultEqualityCheck:tu}});function hR(e){var{value:n}=e;if(si(n)||n instanceof Date)return n}var pR=(e,n,i)=>{var s=e.map(hR).filter(a=>a!=null);return i&&(n.dataKey==null||n.allowDuplicatedCategory&&hj(s))?Xw(0,e.length):n.allowDuplicatedCategory?s:Array.from(new Set(s))},TS=e=>e.referenceElements.dots,Ta=(e,n,i)=>e.filter(s=>s.ifOverflow==="extendDomain").filter(s=>n==="xAxis"?s.xAxisId===i:s.yAxisId===i),mR=Ie([TS,tn,al],Ta),ES=e=>e.referenceElements.areas,gR=Ie([ES,tn,al],Ta),PS=e=>e.referenceElements.lines,yR=Ie([PS,tn,al],Ta),OS=(e,n)=>{var i=$i(e.map(s=>n==="xAxis"?s.x:s.y));if(i.length!==0)return[Math.min(...i),Math.max(...i)]},xR=Ie(mR,tn,OS),DS=(e,n)=>{var i=$i(e.flatMap(s=>[n==="xAxis"?s.x1:s.y1,n==="xAxis"?s.x2:s.y2]));if(i.length!==0)return[Math.min(...i),Math.max(...i)]},vR=Ie([gR,tn],DS);function bR(e){var n;if(e.x!=null)return $i([e.x]);var i=(n=e.segment)===null||n===void 0?void 0:n.map(s=>s.x);return i==null||i.length===0?[]:$i(i)}function jR(e){var n;if(e.y!=null)return $i([e.y]);var i=(n=e.segment)===null||n===void 0?void 0:n.map(s=>s.y);return i==null||i.length===0?[]:$i(i)}var zS=(e,n)=>{var i=e.flatMap(s=>n==="xAxis"?bR(s):jR(s));if(i.length!==0)return[Math.min(...i),Math.max(...i)]},wR=Ie([yR,tn],zS),SR=Ie(xR,wR,vR,(e,n,i)=>Zc(e,i,n)),_m=(e,n,i,s,a,o,l,c)=>{if(i!=null)return i;var d=l==="vertical"&&c==="xAxis"||l==="horizontal"&&c==="yAxis",u=d?Zc(s,o,a):Zc(o,a);return OM(n,u,e.allowDataOverflow)},kR=Ie([an,Sm,km,dR,fR,SR,wt,tn],_m,{memoizeOptions:{resultEqualityCheck:tu}}),NR=[0,1],Cm=(e,n,i,s,a,o,l)=>{if(!((e==null||i==null||i.length===0)&&l===void 0)){var{dataKey:c,type:d}=e,u=ds(n,o);if(u&&c==null){var f;return Xw(0,(f=i==null?void 0:i.length)!==null&&f!==void 0?f:0)}return d==="category"?pR(s,e,u):a==="expand"?NR:l}},Am=Ie([an,wt,bm,iu,sl,tn,kR],Cm),MS=(e,n,i,s,a)=>{if(e!=null){var{scale:o,type:l}=e;if(o==="auto")return n==="radial"&&a==="radiusAxis"?"band":n==="radial"&&a==="angleAxis"?"linear":l==="category"&&s&&(s.indexOf("LineChart")>=0||s.indexOf("AreaChart")>=0||s.indexOf("ComposedChart")>=0&&!i)?"point":l==="category"?"band":"linear";if(typeof o=="string"){var c="scale".concat(Jo(o));return c in po?c:"point"}}},Ea=Ie([an,wt,SS,lm,tn],MS);function _R(e){if(e!=null){if(e in po)return po[e]();var n="scale".concat(Jo(e));if(n in po)return po[n]()}}function Im(e,n,i,s){if(!(i==null||s==null)){if(typeof e.scale=="function")return e.scale.copy().domain(i).range(s);var a=_R(n);if(a!=null){var o=a.domain(i).range(s);return Tz(o),o}}}var Tm=(e,n,i)=>{var s=wm(n);if(!(i!=="auto"&&i!=="linear")){if(n!=null&&n.tickCount&&Array.isArray(s)&&(s[0]==="auto"||s[1]==="auto")&&Ls(e))return qM(e,n.tickCount,n.allowDecimals);if(n!=null&&n.tickCount&&n.type==="number"&&Ls(e))return UM(e,n.tickCount,n.allowDecimals)}},Em=Ie([Am,ol,Ea],Tm),Pm=(e,n,i,s)=>{if(s!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&Ls(n)&&Array.isArray(i)&&i.length>0){var a=n[0],o=i[0],l=n[1],c=i[i.length-1];return[Math.min(a,o),Math.max(l,c)]}return n},CR=Ie([an,Am,Em,tn],Pm),AR=Ie(iu,an,(e,n)=>{if(!(!n||n.type!=="number")){var i=1/0,s=Array.from($i(e.map(c=>c.value))).sort((c,d)=>c-d);if(s.length<2)return 1/0;var a=s[s.length-1]-s[0];if(a===0)return 1/0;for(var o=0;o<s.length-1;o++){var l=s[o+1]-s[o];i=Math.min(i,l)}return i/a}}),RS=Ie(AR,wt,hS,wn,(e,n,i,s)=>s,(e,n,i,s,a)=>{if(!un(e))return 0;var o=n==="vertical"?s.height:s.width;if(a==="gap")return e*o/2;if(a==="no-gap"){var l=Bn(i,e*o),c=e*o/2;return c-l-(c-l)/o*l}return 0}),IR=(e,n)=>{var i=Ui(e,n);return i==null||typeof i.padding!="string"?0:RS(e,"xAxis",n,i.padding)},TR=(e,n)=>{var i=Hi(e,n);return i==null||typeof i.padding!="string"?0:RS(e,"yAxis",n,i.padding)},ER=Ie(Ui,IR,(e,n)=>{var i,s;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:n,right:n}:{left:((i=a.left)!==null&&i!==void 0?i:0)+n,right:((s=a.right)!==null&&s!==void 0?s:0)+n}}),PR=Ie(Hi,TR,(e,n)=>{var i,s;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:n,bottom:n}:{top:((i=a.top)!==null&&i!==void 0?i:0)+n,bottom:((s=a.bottom)!==null&&s!==void 0?s:0)+n}}),OR=Ie([wn,ER,Kd,Yd,(e,n,i)=>i],(e,n,i,s,a)=>{var{padding:o}=s;return a?[o.left,i.width-o.right]:[e.left+n.left,e.left+e.width-n.right]}),DR=Ie([wn,wt,PR,Kd,Yd,(e,n,i)=>i],(e,n,i,s,a,o)=>{var{padding:l}=a;return o?[s.height-l.bottom,l.top]:n==="horizontal"?[e.top+e.height-i.bottom,e.top+i.top]:[e.top+i.top,e.top+e.height-i.bottom]}),cl=(e,n,i,s)=>{var a;switch(n){case"xAxis":return OR(e,i,s);case"yAxis":return DR(e,i,s);case"zAxis":return(a=mm(e,i))===null||a===void 0?void 0:a.range;case"angleAxis":return yS(e);case"radiusAxis":return xS(e,i);default:return}},$S=Ie([an,cl],Jd),Pa=Ie([an,Ea,CR,$S],Im);Ie([ll,su,tn],uR);function LS(e,n){return e.id<n.id?-1:e.id>n.id?1:0}var au=(e,n)=>n,ou=(e,n,i)=>i,zR=Ie(Ud,au,ou,(e,n,i)=>e.filter(s=>s.orientation===n).filter(s=>s.mirror===i).sort(LS)),MR=Ie(Hd,au,ou,(e,n,i)=>e.filter(s=>s.orientation===n).filter(s=>s.mirror===i).sort(LS)),WS=(e,n)=>({width:e.width,height:n.height}),RR=(e,n)=>{var i=typeof n.width=="number"?n.width:tl;return{width:i,height:e.height}},BS=Ie(wn,Ui,WS),$R=(e,n,i)=>{switch(n){case"top":return e.top;case"bottom":return i-e.bottom;default:return 0}},LR=(e,n,i)=>{switch(n){case"left":return e.left;case"right":return i-e.right;default:return 0}},WR=Ie(qi,wn,zR,au,ou,(e,n,i,s,a)=>{var o={},l;return i.forEach(c=>{var d=WS(n,c);l==null&&(l=$R(n,s,e));var u=s==="top"&&!a||s==="bottom"&&a;o[c.id]=l-Number(u)*d.height,l+=(u?-1:1)*d.height}),o}),BR=Ie(Fi,wn,MR,au,ou,(e,n,i,s,a)=>{var o={},l;return i.forEach(c=>{var d=RR(n,c);l==null&&(l=LR(n,s,e));var u=s==="left"&&!a||s==="right"&&a;o[c.id]=l-Number(u)*d.width,l+=(u?-1:1)*d.width}),o}),FR=(e,n)=>{var i=Ui(e,n);if(i!=null)return WR(e,i.orientation,i.mirror)},qR=Ie([wn,Ui,FR,(e,n)=>n],(e,n,i,s)=>{if(n!=null){var a=i==null?void 0:i[s];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),UR=(e,n)=>{var i=Hi(e,n);if(i!=null)return BR(e,i.orientation,i.mirror)},HR=Ie([wn,Hi,UR,(e,n)=>n],(e,n,i,s)=>{if(n!=null){var a=i==null?void 0:i[s];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),FS=Ie(wn,Hi,(e,n)=>{var i=typeof n.width=="number"?n.width:tl;return{width:i,height:e.height}}),y0=(e,n,i)=>{switch(n){case"xAxis":return BS(e,i).width;case"yAxis":return FS(e,i).height;default:return}},qS=(e,n,i,s)=>{if(i!=null){var{allowDuplicatedCategory:a,type:o,dataKey:l}=i,c=ds(e,s),d=n.map(u=>u.value);if(l&&c&&o==="category"&&a&&hj(d))return d}},Om=Ie([wt,iu,an,tn],qS),US=(e,n,i,s)=>{if(!(i==null||i.dataKey==null)){var{type:a,scale:o}=i,l=ds(e,s);if(l&&(a==="number"||o!=="auto"))return n.map(c=>c.value)}},Dm=Ie([wt,iu,ol,tn],US),x0=Ie([wt,rR,Ea,Pa,Om,Dm,cl,Em,tn],(e,n,i,s,a,o,l,c,d)=>{if(n!=null){var u=ds(e,d);return{angle:n.angle,interval:n.interval,minTickGap:n.minTickGap,orientation:n.orientation,tick:n.tick,tickCount:n.tickCount,tickFormatter:n.tickFormatter,ticks:n.ticks,type:n.type,unit:n.unit,axisType:d,categoricalDomain:o,duplicateDomain:a,isCategorical:u,niceTicks:c,range:l,realScaleType:i,scale:s}}}),YR=(e,n,i,s,a,o,l,c,d)=>{if(!(n==null||s==null)){var u=ds(e,d),{type:f,ticks:h,tickCount:m}=n,g=i==="scaleBand"&&typeof s.bandwidth=="function"?s.bandwidth()/2:2,b=f==="category"&&s.bandwidth?s.bandwidth()/g:0;b=d==="angleAxis"&&o!=null&&o.length>=2?Cn(o[0]-o[1])*2*b:b;var j=h||a;if(j){var y=j.map((x,v)=>{var A=l?l.indexOf(x):x;return{index:v,coordinate:s(A)+b,value:x,offset:b}});return y.filter(x=>un(x.coordinate))}return u&&c?c.map((x,v)=>({coordinate:s(x)+b,value:x,index:v,offset:b})).filter(x=>un(x.coordinate)):s.ticks?s.ticks(m).map(x=>({coordinate:s(x)+b,value:x,offset:b})):s.domain().map((x,v)=>({coordinate:s(x)+b,value:l?l[x]:x,index:v,offset:b}))}},HS=Ie([wt,ol,Ea,Pa,Em,cl,Om,Dm,tn],YR),KR=(e,n,i,s,a,o,l)=>{if(!(n==null||i==null||s==null||s[0]===s[1])){var c=ds(e,l),{tickCount:d}=n,u=0;return u=l==="angleAxis"&&(s==null?void 0:s.length)>=2?Cn(s[0]-s[1])*2*u:u,c&&o?o.map((f,h)=>({coordinate:i(f)+u,value:f,index:h,offset:u})):i.ticks?i.ticks(d).map(f=>({coordinate:i(f)+u,value:f,offset:u})):i.domain().map((f,h)=>({coordinate:i(f)+u,value:a?a[f]:f,index:h,offset:u}))}},is=Ie([wt,ol,Pa,cl,Om,Dm,tn],KR),ss=Ie(an,Pa,(e,n)=>{if(!(e==null||n==null))return Jc(Jc({},e),{},{scale:n})}),GR=Ie([an,Ea,Am,$S],Im);Ie((e,n,i)=>mm(e,i),GR,(e,n)=>{if(!(e==null||n==null))return Jc(Jc({},e),{},{scale:n})});var VR=Ie([wt,Ud,Hd],(e,n,i)=>{switch(e){case"horizontal":return n.some(s=>s.reversed)?"right-to-left":"left-to-right";case"vertical":return i.some(s=>s.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),YS=e=>e.options.defaultTooltipEventType,KS=e=>e.options.validateTooltipEventTypes;function GS(e,n,i){if(e==null)return n;var s=e?"axis":"item";return i==null?n:i.includes(s)?s:n}function zm(e,n){var i=YS(e),s=KS(e);return GS(n,i,s)}function XR(e){return Je(n=>zm(n,e))}var VS=(e,n)=>{var i,s=Number(n);if(!(Ur(s)||n==null))return s>=0?e==null||(i=e[s])===null||i===void 0?void 0:i.value:void 0},QR=e=>e.tooltip.settings,ts={active:!1,index:null,dataKey:void 0,coordinate:void 0},JR={itemInteraction:{click:ts,hover:ts},axisInteraction:{click:ts,hover:ts},keyboardInteraction:ts,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},XS=sr({name:"tooltip",initialState:JR,reducers:{addTooltipEntrySettings:{reducer(e,n){e.tooltipItemPayloads.push(n.payload)},prepare:bn()},removeTooltipEntrySettings:{reducer(e,n){var i=Ci(e).tooltipItemPayloads.indexOf(n.payload);i>-1&&e.tooltipItemPayloads.splice(i,1)},prepare:bn()},setTooltipSettingsState(e,n){e.settings=n.payload},setActiveMouseOverItemIndex(e,n){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=n.payload.activeIndex,e.itemInteraction.hover.dataKey=n.payload.activeDataKey,e.itemInteraction.hover.coordinate=n.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,n){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=n.payload.activeIndex,e.itemInteraction.click.dataKey=n.payload.activeDataKey,e.itemInteraction.click.coordinate=n.payload.activeCoordinate},setMouseOverAxisIndex(e,n){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=n.payload.activeIndex,e.axisInteraction.hover.dataKey=n.payload.activeDataKey,e.axisInteraction.hover.coordinate=n.payload.activeCoordinate},setMouseClickAxisIndex(e,n){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=n.payload.activeIndex,e.axisInteraction.click.dataKey=n.payload.activeDataKey,e.axisInteraction.click.coordinate=n.payload.activeCoordinate},setSyncInteraction(e,n){e.syncInteraction=n.payload},setKeyboardInteraction(e,n){e.keyboardInteraction.active=n.payload.active,e.keyboardInteraction.index=n.payload.activeIndex,e.keyboardInteraction.coordinate=n.payload.activeCoordinate,e.keyboardInteraction.dataKey=n.payload.activeDataKey}}}),{addTooltipEntrySettings:ZR,removeTooltipEntrySettings:e$,setTooltipSettingsState:t$,setActiveMouseOverItemIndex:QS,mouseLeaveItem:n$,mouseLeaveChart:JS,setActiveClickItemIndex:r$,setMouseOverAxisIndex:ZS,setMouseClickAxisIndex:i$,setSyncInteraction:Nh,setKeyboardInteraction:_h}=XS.actions,s$=XS.reducer;function v0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function Bl(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?v0(Object(i),!0).forEach(function(s){a$(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):v0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function a$(e,n,i){return(n=o$(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function o$(e){var n=l$(e,"string");return typeof n=="symbol"?n:n+""}function l$(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function c$(e,n,i){return n==="axis"?i==="click"?e.axisInteraction.click:e.axisInteraction.hover:i==="click"?e.itemInteraction.click:e.itemInteraction.hover}function d$(e){return e.index!=null}var e2=(e,n,i,s)=>{if(n==null)return ts;var a=c$(e,n,i);if(a==null)return ts;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var o=e.settings.active===!0;if(d$(a)){if(o)return Bl(Bl({},a),{},{active:!0})}else if(s!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:s};return Bl(Bl({},ts),{},{coordinate:a.coordinate})},Mm=(e,n)=>{var i=e==null?void 0:e.index;if(i==null)return null;var s=Number(i);if(!un(s))return i;var a=0,o=1/0;return n.length>0&&(o=n.length-1),String(Math.max(a,Math.min(s,o)))},t2=(e,n,i,s,a,o,l,c)=>{if(!(o==null||c==null)){var d=l[0],u=d==null?void 0:c(d.positions,o);if(u!=null)return u;var f=a==null?void 0:a[Number(o)];if(f)switch(i){case"horizontal":return{x:f.coordinate,y:(s.top+n)/2};default:return{x:(s.left+e)/2,y:f.coordinate}}}},n2=(e,n,i,s)=>{if(n==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return i==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&s!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(o=>{var l;return((l=o.settings)===null||l===void 0?void 0:l.dataKey)===a})},dl=e=>e.options.tooltipPayloadSearcher,Oa=e=>e.tooltip;function b0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function j0(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?b0(Object(i),!0).forEach(function(s){u$(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):b0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function u$(e,n,i){return(n=f$(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function f$(e){var n=h$(e,"string");return typeof n=="symbol"?n:n+""}function h$(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function p$(e,n){return e??n}var r2=(e,n,i,s,a,o,l)=>{if(!(n==null||o==null)){var{chartData:c,computedData:d,dataStartIndex:u,dataEndIndex:f}=i,h=[];return e.reduce((m,g)=>{var b,{dataDefinedOnItem:j,settings:y}=g,x=p$(j,c),v=Array.isArray(x)?xw(x,u,f):x,A=(b=y==null?void 0:y.dataKey)!==null&&b!==void 0?b:s,N=y==null?void 0:y.nameKey,C;if(s&&Array.isArray(v)&&!Array.isArray(v[0])&&l==="axis"?C=pj(v,s,a):C=o(v,n,d,N),Array.isArray(C))C.forEach(_=>{var I=j0(j0({},y),{},{name:_.name,unit:_.unit,color:void 0,fill:void 0});m.push(Wx({tooltipEntrySettings:I,dataKey:_.dataKey,payload:_.payload,value:Ft(_.payload,_.dataKey),name:_.name}))});else{var w;m.push(Wx({tooltipEntrySettings:y,dataKey:A,payload:C,value:Ft(C,A),name:(w=Ft(C,N))!==null&&w!==void 0?w:y==null?void 0:y.name}))}return m},h)}},Rm=Ie([kn,wt,SS,lm,Sn],MS),m$=Ie([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,n)=>[...e,...n]),g$=Ie([Sn,Ia],gm),ul=Ie([m$,kn,g$],ym,{memoizeOptions:{resultEqualityCheck:nu}}),y$=Ie([ul],e=>e.filter(eu)),x$=Ie([ul],xm,{memoizeOptions:{resultEqualityCheck:nu}}),Da=Ie([x$,fs],vm),v$=Ie([y$,fs,kn],bS),$m=Ie([Da,kn,ul],jm),i2=Ie([kn],wm),b$=Ie([kn],e=>e.allowDataOverflow),s2=Ie([i2,b$],Qw),j$=Ie([ul],e=>e.filter(eu)),w$=Ie([v$,j$,sl],AS),S$=Ie([w$,fs,Sn,s2],IS),k$=Ie([ul],NS),N$=Ie([Da,kn,k$,su,Sn],Nm,{memoizeOptions:{resultEqualityCheck:tu}}),_$=Ie([TS,Sn,Ia],Ta),C$=Ie([_$,Sn],OS),A$=Ie([ES,Sn,Ia],Ta),I$=Ie([A$,Sn],DS),T$=Ie([PS,Sn,Ia],Ta),E$=Ie([T$,Sn],zS),P$=Ie([C$,E$,I$],Zc),O$=Ie([kn,i2,s2,S$,N$,P$,wt,Sn],_m),a2=Ie([kn,wt,Da,$m,sl,Sn,O$],Cm),D$=Ie([a2,kn,Rm],Tm),z$=Ie([kn,a2,D$,Sn],Pm),o2=e=>{var n=Sn(e),i=Ia(e),s=!1;return cl(e,n,i,s)},l2=Ie([kn,o2],Jd),c2=Ie([kn,Rm,z$,l2],Im),M$=Ie([wt,$m,kn,Sn],qS),R$=Ie([wt,$m,kn,Sn],US),$$=(e,n,i,s,a,o,l,c)=>{if(n){var{type:d}=n,u=ds(e,c);if(s){var f=i==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,h=d==="category"&&s.bandwidth?s.bandwidth()/f:0;return h=c==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Cn(a[0]-a[1])*2*h:h,u&&l?l.map((m,g)=>({coordinate:s(m)+h,value:m,index:g,offset:h})):s.domain().map((m,g)=>({coordinate:s(m)+h,value:o?o[m]:m,index:g,offset:h}))}}},Yi=Ie([wt,kn,Rm,c2,o2,M$,R$,Sn],$$),Lm=Ie([YS,KS,QR],(e,n,i)=>GS(i.shared,e,n)),d2=e=>e.tooltip.settings.trigger,Wm=e=>e.tooltip.settings.defaultIndex,lu=Ie([Oa,Lm,d2,Wm],e2),as=Ie([lu,Da],Mm),u2=Ie([Yi,as],VS),f2=Ie([lu],e=>{if(e)return e.dataKey}),h2=Ie([Oa,Lm,d2,Wm],n2),L$=Ie([Fi,qi,wt,wn,Yi,Wm,h2,dl],t2),W$=Ie([lu,L$],(e,n)=>e!=null&&e.coordinate?e.coordinate:n),B$=Ie([lu],e=>e.active),F$=Ie([h2,as,fs,CS,u2,dl,Lm],r2),q$=Ie([F$],e=>{if(e!=null){var n=e.map(i=>i.payload).filter(i=>i!=null);return Array.from(new Set(n))}});function w0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function S0(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?w0(Object(i),!0).forEach(function(s){U$(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):w0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function U$(e,n,i){return(n=H$(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function H$(e){var n=Y$(e,"string");return typeof n=="symbol"?n:n+""}function Y$(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var K$=()=>Je(kn),G$=()=>{var e=K$(),n=Je(Yi),i=Je(c2);return Sa(!e||!i?void 0:S0(S0({},e),{},{scale:i}),n)};function k0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function ea(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?k0(Object(i),!0).forEach(function(s){V$(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):k0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function V$(e,n,i){return(n=X$(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function X$(e){var n=Q$(e,"string");return typeof n=="symbol"?n:n+""}function Q$(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var J$=(e,n,i,s)=>{var a=n.find(o=>o&&o.index===i);if(a){if(e==="horizontal")return{x:a.coordinate,y:s.chartY};if(e==="vertical")return{x:s.chartX,y:a.coordinate}}return{x:0,y:0}},Z$=(e,n,i,s)=>{var a=n.find(u=>u&&u.index===i);if(a){if(e==="centric"){var o=a.coordinate,{radius:l}=s;return ea(ea(ea({},s),pn(s.cx,s.cy,l,o)),{},{angle:o,radius:l})}var c=a.coordinate,{angle:d}=s;return ea(ea(ea({},s),pn(s.cx,s.cy,c,d)),{},{angle:d,radius:c})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function eL(e,n){var{chartX:i,chartY:s}=e;return i>=n.left&&i<=n.left+n.width&&s>=n.top&&s<=n.top+n.height}var p2=(e,n,i,s,a)=>{var o,l=-1,c=(o=n==null?void 0:n.length)!==null&&o!==void 0?o:0;if(c<=1||e==null)return 0;if(s==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var d=0;d<c;d++){var u=d>0?i[d-1].coordinate:i[c-1].coordinate,f=i[d].coordinate,h=d>=c-1?i[0].coordinate:i[d+1].coordinate,m=void 0;if(Cn(f-u)!==Cn(h-f)){var g=[];if(Cn(h-f)===Cn(a[1]-a[0])){m=h;var b=f+a[1]-a[0];g[0]=Math.min(b,(b+u)/2),g[1]=Math.max(b,(b+u)/2)}else{m=u;var j=h+a[1]-a[0];g[0]=Math.min(f,(j+f)/2),g[1]=Math.max(f,(j+f)/2)}var y=[Math.min(f,(m+f)/2),Math.max(f,(m+f)/2)];if(e>y[0]&&e<=y[1]||e>=g[0]&&e<=g[1]){({index:l}=i[d]);break}}else{var x=Math.min(u,h),v=Math.max(u,h);if(e>(x+f)/2&&e<=(v+f)/2){({index:l}=i[d]);break}}}else if(n){for(var A=0;A<c;A++)if(A===0&&e<=(n[A].coordinate+n[A+1].coordinate)/2||A>0&&A<c-1&&e>(n[A].coordinate+n[A-1].coordinate)/2&&e<=(n[A].coordinate+n[A+1].coordinate)/2||A===c-1&&e>(n[A].coordinate+n[A-1].coordinate)/2){({index:l}=n[A]);break}}return l},tL=()=>Je(lm),Bm=(e,n)=>n,m2=(e,n,i)=>i,Fm=(e,n,i,s)=>s,nL=Ie(Yi,e=>$d(e,n=>n.coordinate)),qm=Ie([Oa,Bm,m2,Fm],e2),g2=Ie([qm,Da],Mm),rL=(e,n,i)=>{if(n!=null){var s=Oa(e);return n==="axis"?i==="hover"?s.axisInteraction.hover.dataKey:s.axisInteraction.click.dataKey:i==="hover"?s.itemInteraction.hover.dataKey:s.itemInteraction.click.dataKey}},y2=Ie([Oa,Bm,m2,Fm],n2),ed=Ie([Fi,qi,wt,wn,Yi,Fm,y2,dl],t2),iL=Ie([qm,ed],(e,n)=>{var i;return(i=e.coordinate)!==null&&i!==void 0?i:n}),x2=Ie([Yi,g2],VS),sL=Ie([y2,g2,fs,CS,x2,dl,Bm],r2),aL=Ie([qm],e=>({isActive:e.active,activeIndex:e.index})),oL=(e,n,i,s,a,o,l)=>{if(!(!e||!i||!s||!a)&&eL(e,l)){var c=Bz(e,n),d=p2(c,o,a,i,s),u=J$(n,a,d,e);return{activeIndex:String(d),activeCoordinate:u}}},lL=(e,n,i,s,a,o,l)=>{if(!(!e||!s||!a||!o||!i)){var c=CM(e,i);if(c){var d=Fz(c,n),u=p2(d,l,o,s,a),f=Z$(n,o,u,c);return{activeIndex:String(u),activeCoordinate:f}}}},cL=(e,n,i,s,a,o,l,c)=>{if(!(!e||!n||!s||!a||!o))return n==="horizontal"||n==="vertical"?oL(e,n,s,a,o,l,c):lL(e,n,i,s,a,o,l)},dL=Ie(e=>e.zIndex.zIndexMap,(e,n)=>n,(e,n,i)=>i,(e,n,i)=>{if(n!=null){var s=e[n];if(s!=null)return i?s.panoramaElementId:s.elementId}}),uL=Ie(e=>e.zIndex.zIndexMap,e=>{var n=Object.keys(e).map(s=>parseInt(s,10)).concat(Object.values(mn)),i=Array.from(new Set(n));return i.sort((s,a)=>s-a)},{memoizeOptions:{resultEqualityCheck:JM}});function N0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function _0(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?N0(Object(i),!0).forEach(function(s){fL(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):N0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function fL(e,n,i){return(n=hL(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function hL(e){var n=pL(e,"string");return typeof n=="symbol"?n:n+""}function pL(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var mL={},gL={zIndexMap:Object.values(mn).reduce((e,n)=>_0(_0({},e),{},{[n]:{elementId:void 0,panoramaElementId:void 0,consumers:0}}),mL)},yL=new Set(Object.values(mn));function xL(e){return yL.has(e)}var v2=sr({name:"zIndex",initialState:gL,reducers:{registerZIndexPortal:{reducer:(e,n)=>{var{zIndex:i}=n.payload;e.zIndexMap[i]?e.zIndexMap[i].consumers+=1:e.zIndexMap[i]={consumers:1,elementId:void 0,panoramaElementId:void 0}},prepare:bn()},unregisterZIndexPortal:{reducer:(e,n)=>{var{zIndex:i}=n.payload;e.zIndexMap[i]&&(e.zIndexMap[i].consumers-=1,e.zIndexMap[i].consumers<=0&&!xL(i)&&delete e.zIndexMap[i])},prepare:bn()},registerZIndexPortalId:{reducer:(e,n)=>{var{zIndex:i,elementId:s,isPanorama:a}=n.payload;e.zIndexMap[i]?a?e.zIndexMap[i].panoramaElementId=s:e.zIndexMap[i].elementId=s:e.zIndexMap[i]={consumers:0,elementId:a?void 0:s,panoramaElementId:a?s:void 0}},prepare:bn()},unregisterZIndexPortalId:{reducer:(e,n)=>{var{zIndex:i}=n.payload;e.zIndexMap[i]&&(n.payload.isPanorama?e.zIndexMap[i].panoramaElementId=void 0:e.zIndexMap[i].elementId=void 0)},prepare:bn()}}}),{registerZIndexPortal:vL,unregisterZIndexPortal:bL,registerZIndexPortalId:jL,unregisterZIndexPortalId:wL}=v2.actions,SL=v2.reducer;function ar(e){var{zIndex:n,children:i}=e,s=p5(),a=s&&n!==void 0&&n!==0,o=qn(),l=en();p.useLayoutEffect(()=>a?(l(vL({zIndex:n})),()=>{l(bL({zIndex:n}))}):Hs,[l,n,a]);var c=Je(u=>dL(u,n,o));if(!a)return i;if(!c)return null;var d=document.getElementById(c);return d?Bh.createPortal(i,d):null}function Ch(){return Ch=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Ch.apply(null,arguments)}function C0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function Fl(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?C0(Object(i),!0).forEach(function(s){kL(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):C0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function kL(e,n,i){return(n=NL(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function NL(e){var n=_L(e,"string");return typeof n=="symbol"?n:n+""}function _L(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function CL(e){var{cursor:n,cursorComp:i,cursorProps:s}=e;return p.isValidElement(n)?p.cloneElement(n,s):p.createElement(i,s)}function AL(e){var n,{coordinate:i,payload:s,index:a,offset:o,tooltipAxisBandSize:l,layout:c,cursor:d,tooltipEventType:u,chartName:f}=e,h=i,m=s,g=a;if(!d||!h||f!=="ScatterChart"&&u!=="axis")return null;var b,j,y;if(f==="ScatterChart")b=h,j=q5,y=mn.cursorLine;else if(f==="BarChart")b=U5(c,h,o,l),j=Fw,y=mn.cursorRectangle;else if(c==="radial"&&yj(h)){var{cx:x,cy:v,radius:A,startAngle:N,endAngle:C}=Uw(h);b={cx:x,cy:v,startAngle:N,endAngle:C,innerRadius:A,outerRadius:A},j=Yw,y=mn.cursorLine}else b={points:EM(c,h,o)},j=im,y=mn.cursorLine;var w=typeof d=="object"&&"className"in d?d.className:void 0,_=Fl(Fl(Fl(Fl({stroke:"#ccc",pointerEvents:"none"},o),b),zs(d)),{},{payload:m,payloadIndex:g,className:_t("recharts-tooltip-cursor",w)});return p.createElement(ar,{zIndex:(n=e.zIndex)!==null&&n!==void 0?n:y},p.createElement(CL,{cursor:d,cursorComp:j,cursorProps:_}))}function IL(e){var n=G$(),i=Ew(),s=nl(),a=tL();return n==null||i==null||s==null||a==null?null:p.createElement(AL,Ch({},e,{offset:i,layout:s,tooltipAxisBandSize:n,chartName:a}))}var b2=p.createContext(null),TL=()=>p.useContext(b2),j2={exports:{}};(function(e){var n=Object.prototype.hasOwnProperty,i="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(i=!1));function a(d,u,f){this.fn=d,this.context=u,this.once=f||!1}function o(d,u,f,h,m){if(typeof f!="function")throw new TypeError("The listener must be a function");var g=new a(f,h||d,m),b=i?i+u:u;return d._events[b]?d._events[b].fn?d._events[b]=[d._events[b],g]:d._events[b].push(g):(d._events[b]=g,d._eventsCount++),d}function l(d,u){--d._eventsCount===0?d._events=new s:delete d._events[u]}function c(){this._events=new s,this._eventsCount=0}c.prototype.eventNames=function(){var u=[],f,h;if(this._eventsCount===0)return u;for(h in f=this._events)n.call(f,h)&&u.push(i?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},c.prototype.listeners=function(u){var f=i?i+u:u,h=this._events[f];if(!h)return[];if(h.fn)return[h.fn];for(var m=0,g=h.length,b=new Array(g);m<g;m++)b[m]=h[m].fn;return b},c.prototype.listenerCount=function(u){var f=i?i+u:u,h=this._events[f];return h?h.fn?1:h.length:0},c.prototype.emit=function(u,f,h,m,g,b){var j=i?i+u:u;if(!this._events[j])return!1;var y=this._events[j],x=arguments.length,v,A;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),x){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,f),!0;case 3:return y.fn.call(y.context,f,h),!0;case 4:return y.fn.call(y.context,f,h,m),!0;case 5:return y.fn.call(y.context,f,h,m,g),!0;case 6:return y.fn.call(y.context,f,h,m,g,b),!0}for(A=1,v=new Array(x-1);A<x;A++)v[A-1]=arguments[A];y.fn.apply(y.context,v)}else{var N=y.length,C;for(A=0;A<N;A++)switch(y[A].once&&this.removeListener(u,y[A].fn,void 0,!0),x){case 1:y[A].fn.call(y[A].context);break;case 2:y[A].fn.call(y[A].context,f);break;case 3:y[A].fn.call(y[A].context,f,h);break;case 4:y[A].fn.call(y[A].context,f,h,m);break;default:if(!v)for(C=1,v=new Array(x-1);C<x;C++)v[C-1]=arguments[C];y[A].fn.apply(y[A].context,v)}}return!0},c.prototype.on=function(u,f,h){return o(this,u,f,h,!1)},c.prototype.once=function(u,f,h){return o(this,u,f,h,!0)},c.prototype.removeListener=function(u,f,h,m){var g=i?i+u:u;if(!this._events[g])return this;if(!f)return l(this,g),this;var b=this._events[g];if(b.fn)b.fn===f&&(!m||b.once)&&(!h||b.context===h)&&l(this,g);else{for(var j=0,y=[],x=b.length;j<x;j++)(b[j].fn!==f||m&&!b[j].once||h&&b[j].context!==h)&&y.push(b[j]);y.length?this._events[g]=y.length===1?y[0]:y:l(this,g)}return this},c.prototype.removeAllListeners=function(u){var f;return u?(f=i?i+u:u,this._events[f]&&l(this,f)):(this._events=new s,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=i,c.EventEmitter=c,e.exports=c})(j2);var EL=j2.exports;const PL=Wi(EL);var Wo=new PL,Ah="recharts.syncEvent.tooltip",A0="recharts.syncEvent.brush";function Um(e,n){if(n){var i=Number.parseInt(n,10);if(!Ur(i))return e==null?void 0:e[i]}}var OL={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},w2=sr({name:"options",initialState:OL,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),DL=w2.reducer,{createEventEmitter:zL}=w2.actions;function ML(e){return e.tooltip.syncInteraction}var RL={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},S2=sr({name:"chartData",initialState:RL,reducers:{setChartData(e,n){if(e.chartData=n.payload,n.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}n.payload.length>0&&e.dataEndIndex!==n.payload.length-1&&(e.dataEndIndex=n.payload.length-1)},setComputedData(e,n){e.computedData=n.payload},setDataStartEndIndexes(e,n){var{startIndex:i,endIndex:s}=n.payload;i!=null&&(e.dataStartIndex=i),s!=null&&(e.dataEndIndex=s)}}}),{setChartData:I0,setDataStartEndIndexes:$L,setComputedData:AK}=S2.actions,LL=S2.reducer,WL=["x","y"];function T0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function ta(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?T0(Object(i),!0).forEach(function(s){BL(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):T0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function BL(e,n,i){return(n=FL(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function FL(e){var n=qL(e,"string");return typeof n=="symbol"?n:n+""}function qL(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function UL(e,n){if(e==null)return{};var i,s,a=HL(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function HL(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function YL(){var e=Je(cm),n=Je(dm),i=en(),s=Je(pS),a=Je(Yi),o=nl(),l=Gd(),c=Je(d=>d.rootProps.className);p.useEffect(()=>{if(e==null)return Hs;var d=(u,f,h)=>{if(n!==h&&e===u){if(s==="index"){var m;if(l&&f!==null&&f!==void 0&&(m=f.payload)!==null&&m!==void 0&&m.coordinate&&f.payload.sourceViewBox){var g=f.payload.coordinate,{x:b,y:j}=g,y=UL(g,WL),{x,y:v,width:A,height:N}=f.payload.sourceViewBox,C=ta(ta({},y),{},{x:l.x+(A?(b-x)/A:0)*l.width,y:l.y+(N?(j-v)/N:0)*l.height});i(ta(ta({},f),{},{payload:ta(ta({},f.payload),{},{coordinate:C})}))}else i(f);return}if(a!=null){var w;if(typeof s=="function"){var _={activeTooltipIndex:f.payload.index==null?void 0:Number(f.payload.index),isTooltipActive:f.payload.active,activeIndex:f.payload.index==null?void 0:Number(f.payload.index),activeLabel:f.payload.label,activeDataKey:f.payload.dataKey,activeCoordinate:f.payload.coordinate},I=s(a,_);w=a[I]}else s==="value"&&(w=a.find(R=>String(R.value)===f.payload.label));var{coordinate:O}=f.payload;if(w==null||f.payload.active===!1||O==null||l==null){i(Nh({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:E,y:S}=O,k=Math.min(E,l.x+l.width),D=Math.min(S,l.y+l.height),T={x:o==="horizontal"?w.coordinate:k,y:o==="horizontal"?D:w.coordinate},P=Nh({active:f.payload.active,coordinate:T,dataKey:f.payload.dataKey,index:String(w.index),label:f.payload.label,sourceViewBox:f.payload.sourceViewBox});i(P)}}};return Wo.on(Ah,d),()=>{Wo.off(Ah,d)}},[c,i,n,e,s,a,o,l])}function KL(){var e=Je(cm),n=Je(dm),i=en();p.useEffect(()=>{if(e==null)return Hs;var s=(a,o,l)=>{n!==l&&e===a&&i($L(o))};return Wo.on(A0,s),()=>{Wo.off(A0,s)}},[i,n,e])}function GL(){var e=en();p.useEffect(()=>{e(zL())},[e]),YL(),KL()}function VL(e,n,i,s,a,o){var l=Je(g=>rL(g,e,n)),c=Je(dm),d=Je(cm),u=Je(pS),f=Je(ML),h=f==null?void 0:f.active,m=Gd();p.useEffect(()=>{if(!h&&d!=null&&c!=null){var g=Nh({active:o,coordinate:i,dataKey:l,index:a,label:typeof s=="number"?String(s):s,sourceViewBox:m});Wo.emit(Ah,d,g,c)}},[h,i,l,a,s,c,d,u,o,m])}function E0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function P0(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?E0(Object(i),!0).forEach(function(s){XL(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):E0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function XL(e,n,i){return(n=QL(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function QL(e){var n=JL(e,"string");return typeof n=="symbol"?n:n+""}function JL(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function ZL(e){return e.dataKey}function e7(e,n){return p.isValidElement(e)?p.cloneElement(e,n):typeof e=="function"?p.createElement(e,n):p.createElement(j5,n)}var O0=[],t7={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!us.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function td(e){var n,i,s=Tn(e,t7),{active:a,allowEscapeViewBox:o,animationDuration:l,animationEasing:c,content:d,filterNull:u,isAnimationActive:f,offset:h,payloadUniqBy:m,position:g,reverseDirection:b,useTranslate3d:j,wrapperStyle:y,cursor:x,shared:v,trigger:A,defaultIndex:N,portal:C,axisId:w}=s,_=en(),I=typeof N=="number"?String(N):N;p.useEffect(()=>{_(t$({shared:v,trigger:A,axisId:w,active:a,defaultIndex:I}))},[_,v,A,w,a,I]);var O=Gd(),E=Rw(),S=XR(v),{activeIndex:k,isActive:D}=(n=Je(W=>aL(W,S,A,I)))!==null&&n!==void 0?n:{},T=Je(W=>sL(W,S,A,I)),P=Je(W=>x2(W,S,A,I)),R=Je(W=>iL(W,S,A,I)),Y=T,X=TL(),H=(i=a??D)!==null&&i!==void 0?i:!1,[q,M]=ID([Y,H]),L=S==="axis"?P:void 0;VL(S,A,R,L,k,H);var B=C??X;if(B==null||O==null||S==null)return null;var F=Y??O0;H||(F=O0),u&&F.length&&(F=KO(F.filter(W=>W.value!=null&&(W.hide!==!0||s.includeHidden)),m,ZL));var te=F.length>0,$=p.createElement(A5,{allowEscapeViewBox:o,animationDuration:l,animationEasing:c,isAnimationActive:f,active:H,coordinate:R,hasPayload:te,offset:h,position:g,reverseDirection:b,useTranslate3d:j,viewBox:O,wrapperStyle:y,lastBoundingBox:q,innerRef:M,hasPortalFromProps:!!C},e7(d,P0(P0({},s),{},{payload:F,label:L,active:H,activeIndex:k,coordinate:R,accessibilityLayer:E})));return p.createElement(p.Fragment,null,Bh.createPortal($,B),H&&p.createElement(IL,{cursor:x,tooltipEventType:S,coordinate:R,payload:F,index:k}))}var za=e=>null;za.displayName="Cell";function n7(e,n,i){return(n=r7(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function r7(e){var n=i7(e,"string");return typeof n=="symbol"?n:n+""}function i7(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}class s7{constructor(n){n7(this,"cache",new Map),this.maxSize=n}get(n){var i=this.cache.get(n);return i!==void 0&&(this.cache.delete(n),this.cache.set(n,i)),i}set(n,i){if(this.cache.has(n))this.cache.delete(n);else if(this.cache.size>=this.maxSize){var s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(n,i)}clear(){this.cache.clear()}size(){return this.cache.size}}function D0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function a7(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?D0(Object(i),!0).forEach(function(s){o7(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):D0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function o7(e,n,i){return(n=l7(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function l7(e){var n=c7(e,"string");return typeof n=="symbol"?n:n+""}function c7(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var d7={cacheSize:2e3,enableCache:!0},k2=a7({},d7),z0=new s7(k2.cacheSize),u7={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},M0="recharts_measurement_span";function f7(e,n){var i=n.fontSize||"",s=n.fontFamily||"",a=n.fontWeight||"",o=n.fontStyle||"",l=n.letterSpacing||"",c=n.textTransform||"";return"".concat(e,"|").concat(i,"|").concat(s,"|").concat(a,"|").concat(o,"|").concat(l,"|").concat(c)}var R0=(e,n)=>{try{var i=document.getElementById(M0);i||(i=document.createElement("span"),i.setAttribute("id",M0),i.setAttribute("aria-hidden","true"),document.body.appendChild(i)),Object.assign(i.style,u7,n),i.textContent="".concat(e);var s=i.getBoundingClientRect();return{width:s.width,height:s.height}}catch{return{width:0,height:0}}},jo=function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n==null||us.isSsr)return{width:0,height:0};if(!k2.enableCache)return R0(n,i);var s=f7(n,i),a=z0.get(s);if(a)return a;var o=R0(n,i);return z0.set(s,o),o},$0=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,L0=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,h7=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,p7=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,N2={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},m7=Object.keys(N2),aa="NaN";function g7(e,n){return e*N2[n]}class er{static parse(n){var i,[,s,a]=(i=p7.exec(n))!==null&&i!==void 0?i:[];return new er(parseFloat(s),a??"")}constructor(n,i){this.num=n,this.unit=i,this.num=n,this.unit=i,Ur(n)&&(this.unit=""),i!==""&&!h7.test(i)&&(this.num=NaN,this.unit=""),m7.includes(i)&&(this.num=g7(n,i),this.unit="px")}add(n){return this.unit!==n.unit?new er(NaN,""):new er(this.num+n.num,this.unit)}subtract(n){return this.unit!==n.unit?new er(NaN,""):new er(this.num-n.num,this.unit)}multiply(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new er(NaN,""):new er(this.num*n.num,this.unit||n.unit)}divide(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new er(NaN,""):new er(this.num/n.num,this.unit||n.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Ur(this.num)}}function _2(e){if(e.includes(aa))return aa;for(var n=e;n.includes("*")||n.includes("/");){var i,[,s,a,o]=(i=$0.exec(n))!==null&&i!==void 0?i:[],l=er.parse(s??""),c=er.parse(o??""),d=a==="*"?l.multiply(c):l.divide(c);if(d.isNaN())return aa;n=n.replace($0,d.toString())}for(;n.includes("+")||/.-\d+(?:\.\d+)?/.test(n);){var u,[,f,h,m]=(u=L0.exec(n))!==null&&u!==void 0?u:[],g=er.parse(f??""),b=er.parse(m??""),j=h==="+"?g.add(b):g.subtract(b);if(j.isNaN())return aa;n=n.replace(L0,j.toString())}return n}var W0=/\(([^()]*)\)/;function y7(e){for(var n=e,i;(i=W0.exec(n))!=null;){var[,s]=i;n=n.replace(W0,_2(s))}return n}function x7(e){var n=e.replace(/\s+/g,"");return n=y7(n),n=_2(n),n}function v7(e){try{return x7(e)}catch{return aa}}function of(e){var n=v7(e.slice(5,-1));return n===aa?"":n}var b7=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],j7=["dx","dy","angle","className","breakAll"];function Ih(){return Ih=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Ih.apply(null,arguments)}function B0(e,n){if(e==null)return{};var i,s,a=w7(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function w7(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var C2=/[ \f\n\r\t\v\u2028\u2029]+/,A2=e=>{var{children:n,breakAll:i,style:s}=e;try{var a=[];Zt(n)||(i?a=n.toString().split(""):a=n.toString().split(C2));var o=a.map(c=>({word:c,width:jo(c,s).width})),l=i?0:jo(" ",s).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch{return null}};function S7(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var I2=(e,n,i,s)=>e.reduce((a,o)=>{var{word:l,width:c}=o,d=a[a.length-1];if(d&&c!=null&&(n==null||s||d.width+c+i<Number(n)))d.words.push(l),d.width+=c+i;else{var u={words:[l],width:c};a.push(u)}return a},[]),T2=e=>e.reduce((n,i)=>n.width>i.width?n:i),k7="…",F0=(e,n,i,s,a,o,l,c)=>{var d=e.slice(0,n),u=A2({breakAll:i,style:s,children:d+k7});if(!u)return[!1,[]];var f=I2(u.wordsWithComputedWidth,o,l,c),h=f.length>a||T2(f).width>Number(o);return[h,f]},N7=(e,n,i,s,a)=>{var{maxLines:o,children:l,style:c,breakAll:d}=e,u=Qe(o),f=String(l),h=I2(n,s,i,a);if(!u||a)return h;var m=h.length>o||T2(h).width>Number(s);if(!m)return h;for(var g=0,b=f.length-1,j=0,y;g<=b&&j<=f.length-1;){var x=Math.floor((g+b)/2),v=x-1,[A,N]=F0(f,v,d,c,o,s,i,a),[C]=F0(f,x,d,c,o,s,i,a);if(!A&&!C&&(g=x+1),A&&C&&(b=x-1),!A&&C){y=N;break}j++}return y||h},q0=e=>{var n=Zt(e)?[]:e.toString().split(C2);return[{words:n,width:void 0}]},_7=e=>{var{width:n,scaleToFit:i,children:s,style:a,breakAll:o,maxLines:l}=e;if((n||i)&&!us.isSsr){var c,d,u=A2({breakAll:o,children:s,style:a});if(u){var{wordsWithComputedWidth:f,spaceWidth:h}=u;c=f,d=h}else return q0(s);return N7({breakAll:o,children:s,maxLines:l,style:a},c,d,n,!!i)}return q0(s)},E2="#808080",C7={breakAll:!1,capHeight:"0.71em",fill:E2,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},cu=p.forwardRef((e,n)=>{var i=Tn(e,C7),{x:s,y:a,lineHeight:o,capHeight:l,fill:c,scaleToFit:d,textAnchor:u,verticalAnchor:f}=i,h=B0(i,b7),m=p.useMemo(()=>_7({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:d,style:h.style,width:h.width}),[h.breakAll,h.children,h.maxLines,d,h.style,h.width]),{dx:g,dy:b,angle:j,className:y,breakAll:x}=h,v=B0(h,j7);if(!si(s)||!si(a)||m.length===0)return null;var A=Number(s)+(Qe(g)?g:0),N=Number(a)+(Qe(b)?b:0);if(!un(A)||!un(N))return null;var C;switch(f){case"start":C=of("calc(".concat(l,")"));break;case"middle":C=of("calc(".concat((m.length-1)/2," * -").concat(o," + (").concat(l," / 2))"));break;default:C=of("calc(".concat(m.length-1," * -").concat(o,")"));break}var w=[];if(d){var _=m[0].width,{width:I}=h;w.push("scale(".concat(Qe(I)&&Qe(_)?I/_:1,")"))}return j&&w.push("rotate(".concat(j,", ").concat(A,", ").concat(N,")")),w.length&&(v.transform=w.join(" ")),p.createElement("text",Ih({},Qn(v),{ref:n,x:A,y:N,className:_t("recharts-text",y),textAnchor:u,fill:c.includes("url")?E2:c}),m.map((O,E)=>{var S=O.words.join(x?"":" ");return p.createElement("tspan",{x:A,dy:E===0?C:o,key:"".concat(S,"-").concat(E)},S)}))});cu.displayName="Text";var A7=["labelRef"];function I7(e,n){if(e==null)return{};var i,s,a=T7(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function T7(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function U0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function dn(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?U0(Object(i),!0).forEach(function(s){E7(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):U0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function E7(e,n,i){return(n=P7(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function P7(e){var n=O7(e,"string");return typeof n=="symbol"?n:n+""}function O7(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function bi(){return bi=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},bi.apply(null,arguments)}var P2=p.createContext(null),D7=e=>{var{x:n,y:i,upperWidth:s,lowerWidth:a,width:o,height:l,children:c}=e,d=p.useMemo(()=>({x:n,y:i,upperWidth:s,lowerWidth:a,width:o,height:l}),[n,i,s,a,o,l]);return p.createElement(P2.Provider,{value:d},c)},O2=()=>{var e=p.useContext(P2),n=Gd();return e||Tw(n)},z7=p.createContext(null),M7=()=>{var e=p.useContext(z7),n=Je(vS);return e||n},R7=e=>{var{value:n,formatter:i}=e,s=Zt(e.children)?n:e.children;return typeof i=="function"?i(s):s},Hm=e=>e!=null&&typeof e=="function",$7=(e,n)=>{var i=Cn(n-e),s=Math.min(Math.abs(n-e),360);return i*s},L7=(e,n,i,s,a)=>{var{offset:o,className:l}=e,{cx:c,cy:d,innerRadius:u,outerRadius:f,startAngle:h,endAngle:m,clockWise:g}=a,b=(u+f)/2,j=$7(h,m),y=j>=0?1:-1,x,v;switch(n){case"insideStart":x=h+y*o,v=g;break;case"insideEnd":x=m-y*o,v=!g;break;case"end":x=m+y*o,v=g;break;default:throw new Error("Unsupported position ".concat(n))}v=j<=0?v:!v;var A=pn(c,d,b,x),N=pn(c,d,b,x+(v?1:-1)*359),C="M".concat(A.x,",").concat(A.y,`
    A`).concat(b,",").concat(b,",0,1,").concat(v?0:1,`,
    `).concat(N.x,",").concat(N.y),w=Zt(e.id)?Oo("recharts-radial-line-"):e.id;return p.createElement("text",bi({},s,{dominantBaseline:"central",className:_t("recharts-radial-bar-label",l)}),p.createElement("defs",null,p.createElement("path",{id:w,d:C})),p.createElement("textPath",{xlinkHref:"#".concat(w)},i))},W7=(e,n,i)=>{var{cx:s,cy:a,innerRadius:o,outerRadius:l,startAngle:c,endAngle:d}=e,u=(c+d)/2;if(i==="outside"){var{x:f,y:h}=pn(s,a,l+n,u);return{x:f,y:h,textAnchor:f>=s?"start":"end",verticalAnchor:"middle"}}if(i==="center")return{x:s,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(i==="centerTop")return{x:s,y:a,textAnchor:"middle",verticalAnchor:"start"};if(i==="centerBottom")return{x:s,y:a,textAnchor:"middle",verticalAnchor:"end"};var m=(o+l)/2,{x:g,y:b}=pn(s,a,m,u);return{x:g,y:b,textAnchor:"middle",verticalAnchor:"middle"}},Th=e=>"cx"in e&&Qe(e.cx),B7=(e,n)=>{var{parentViewBox:i,offset:s,position:a}=e,o;i!=null&&!Th(i)&&(o=i);var{x:l,y:c,upperWidth:d,lowerWidth:u,height:f}=n,h=l,m=l+(d-u)/2,g=(h+m)/2,b=(d+u)/2,j=h+d/2,y=f>=0?1:-1,x=y*s,v=y>0?"end":"start",A=y>0?"start":"end",N=d>=0?1:-1,C=N*s,w=N>0?"end":"start",_=N>0?"start":"end";if(a==="top"){var I={x:h+d/2,y:c-x,textAnchor:"middle",verticalAnchor:v};return dn(dn({},I),o?{height:Math.max(c-o.y,0),width:d}:{})}if(a==="bottom"){var O={x:m+u/2,y:c+f+x,textAnchor:"middle",verticalAnchor:A};return dn(dn({},O),o?{height:Math.max(o.y+o.height-(c+f),0),width:u}:{})}if(a==="left"){var E={x:g-C,y:c+f/2,textAnchor:w,verticalAnchor:"middle"};return dn(dn({},E),o?{width:Math.max(E.x-o.x,0),height:f}:{})}if(a==="right"){var S={x:g+b+C,y:c+f/2,textAnchor:_,verticalAnchor:"middle"};return dn(dn({},S),o?{width:Math.max(o.x+o.width-S.x,0),height:f}:{})}var k=o?{width:b,height:f}:{};return a==="insideLeft"?dn({x:g+C,y:c+f/2,textAnchor:_,verticalAnchor:"middle"},k):a==="insideRight"?dn({x:g+b-C,y:c+f/2,textAnchor:w,verticalAnchor:"middle"},k):a==="insideTop"?dn({x:h+d/2,y:c+x,textAnchor:"middle",verticalAnchor:A},k):a==="insideBottom"?dn({x:m+u/2,y:c+f-x,textAnchor:"middle",verticalAnchor:v},k):a==="insideTopLeft"?dn({x:h+C,y:c+x,textAnchor:_,verticalAnchor:A},k):a==="insideTopRight"?dn({x:h+d-C,y:c+x,textAnchor:w,verticalAnchor:A},k):a==="insideBottomLeft"?dn({x:m+C,y:c+f-x,textAnchor:_,verticalAnchor:v},k):a==="insideBottomRight"?dn({x:m+u-C,y:c+f-x,textAnchor:w,verticalAnchor:v},k):a&&typeof a=="object"&&(Qe(a.x)||Mi(a.x))&&(Qe(a.y)||Mi(a.y))?dn({x:l+Bn(a.x,b),y:c+Bn(a.y,f),textAnchor:"end",verticalAnchor:"end"},k):dn({x:j,y:c+f/2,textAnchor:"middle",verticalAnchor:"middle"},k)},F7={offset:5,zIndex:mn.label};function es(e){var n=Tn(e,F7),{viewBox:i,position:s,value:a,children:o,content:l,className:c="",textBreakAll:d,labelRef:u}=n,f=M7(),h=O2(),m=s==="center"?h:f??h,g,b,j;if(i==null?g=m:Th(i)?g=i:g=Tw(i),!g||Zt(a)&&Zt(o)&&!p.isValidElement(l)&&typeof l!="function")return null;var y=dn(dn({},n),{},{viewBox:g});if(p.isValidElement(l)){var{labelRef:x}=y,v=I7(y,A7);return p.cloneElement(l,v)}if(typeof l=="function"){if(b=p.createElement(l,y),p.isValidElement(b))return b}else b=R7(n);var A=Qn(n);if(Th(g)){if(s==="insideStart"||s==="insideEnd"||s==="end")return L7(n,s,b,A,g);j=W7(g,n.offset,n.position)}else j=B7(n,g);return p.createElement(ar,{zIndex:n.zIndex},p.createElement(cu,bi({ref:u,className:_t("recharts-label",c)},A,j,{textAnchor:S7(A.textAnchor)?A.textAnchor:j.textAnchor,breakAll:d}),b))}es.displayName="Label";var q7=(e,n,i)=>{if(!e)return null;var s={viewBox:n,labelRef:i};return e===!0?p.createElement(es,bi({key:"label-implicit"},s)):si(e)?p.createElement(es,bi({key:"label-implicit",value:e},s)):p.isValidElement(e)?e.type===es?p.cloneElement(e,dn({key:"label-implicit"},s)):p.createElement(es,bi({key:"label-implicit",content:e},s)):Hm(e)?p.createElement(es,bi({key:"label-implicit",content:e},s)):e&&typeof e=="object"?p.createElement(es,bi({},e,{key:"label-implicit"},s)):null};function U7(e){var{label:n,labelRef:i}=e,s=O2();return q7(n,s,i)||null}var D2={},z2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){return i[i.length-1]}e.last=n})(z2);var M2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){return Array.isArray(i)?i:Array.from(i)}e.toArray=n})(M2);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const n=z2,i=M2,s=Md;function a(o){if(s.isArrayLike(o))return n.last(i.toArray(o))}e.last=a})(D2);var H7=D2.last;const Y7=Wi(H7);var K7=["valueAccessor"],G7=["dataKey","clockWise","id","textBreakAll","zIndex"];function nd(){return nd=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},nd.apply(null,arguments)}function H0(e,n){if(e==null)return{};var i,s,a=V7(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function V7(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var X7=e=>Array.isArray(e.value)?Y7(e.value):e.value,R2=p.createContext(void 0),$2=R2.Provider,L2=p.createContext(void 0),Q7=L2.Provider;function J7(){return p.useContext(R2)}function Z7(){return p.useContext(L2)}function fa(e){var{valueAccessor:n=X7}=e,i=H0(e,K7),{dataKey:s,clockWise:a,id:o,textBreakAll:l,zIndex:c}=i,d=H0(i,G7),u=J7(),f=Z7(),h=u||f;return!h||!h.length?null:p.createElement(ar,{zIndex:c??mn.label},p.createElement(An,{className:"recharts-label-list"},h.map((m,g)=>{var b,j=Zt(s)?n(m,g):Ft(m&&m.payload,s),y=Zt(o)?{}:{id:"".concat(o,"-").concat(g)};return p.createElement(es,nd({key:"label-".concat(g)},Qn(m),d,y,{fill:(b=i.fill)!==null&&b!==void 0?b:m.fill,parentViewBox:m.parentViewBox,value:j,textBreakAll:l,viewBox:m.viewBox,index:g,zIndex:0}))})))}fa.displayName="LabelList";function Ym(e){var{label:n}=e;return n?n===!0?p.createElement(fa,{key:"labelList-implicit"}):p.isValidElement(n)||Hm(n)?p.createElement(fa,{key:"labelList-implicit",content:n}):typeof n=="object"?p.createElement(fa,nd({key:"labelList-implicit"},n,{type:String(n.type)})):null:null}function Eh(){return Eh=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Eh.apply(null,arguments)}var W2=e=>{var{cx:n,cy:i,r:s,className:a}=e,o=_t("recharts-dot",a);return Qe(n)&&Qe(i)&&Qe(s)?p.createElement("circle",Eh({},yr(e),$p(e),{className:o,cx:n,cy:i,r:s})):null},B2=e=>e.graphicalItems.polarItems,eW=Ie([tn,al],gm),du=Ie([B2,an,eW],ym),tW=Ie([du],xm),uu=Ie([tW,sm],vm),nW=Ie([uu,an,du],jm);Ie([uu,an,du],(e,n,i)=>i.length>0?e.flatMap(s=>i.flatMap(a=>{var o,l=Ft(s,(o=n.dataKey)!==null&&o!==void 0?o:a.dataKey);return{value:l,errorDomain:[]}})).filter(Boolean):(n==null?void 0:n.dataKey)!=null?e.map(s=>({value:Ft(s,n.dataKey),errorDomain:[]})):e.map(s=>({value:s,errorDomain:[]})));var Y0=()=>{},rW=Ie([uu,an,du,su,tn],Nm),iW=Ie([an,Sm,km,Y0,rW,Y0,wt,tn],_m),F2=Ie([an,wt,uu,nW,sl,tn,iW],Cm),sW=Ie([F2,an,Ea],Tm);Ie([an,F2,sW,tn],Pm);var aW={radiusAxis:{},angleAxis:{}},q2=sr({name:"polarAxis",initialState:aW,reducers:{addRadiusAxis(e,n){e.radiusAxis[n.payload.id]=n.payload},removeRadiusAxis(e,n){delete e.radiusAxis[n.payload.id]},addAngleAxis(e,n){e.angleAxis[n.payload.id]=n.payload},removeAngleAxis(e,n){delete e.angleAxis[n.payload.id]}}}),{addRadiusAxis:IK,removeRadiusAxis:TK,addAngleAxis:EK,removeAngleAxis:PK}=q2.actions,oW=q2.reducer;function K0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function G0(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?K0(Object(i),!0).forEach(function(s){lW(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):K0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function lW(e,n,i){return(n=cW(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function cW(e){var n=dW(e,"string");return typeof n=="symbol"?n:n+""}function dW(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var uW=(e,n)=>n,Km=Ie([B2,uW],(e,n)=>e.filter(i=>i.type==="pie").find(i=>i.id===n)),fW=[],Gm=(e,n,i)=>(i==null?void 0:i.length)===0?fW:i,U2=Ie([sm,Km,Gm],(e,n,i)=>{var{chartData:s}=e;if(n!=null){var a;if((n==null?void 0:n.data)!=null&&n.data.length>0?a=n.data:a=s,(!a||!a.length)&&i!=null&&(a=i.map(o=>G0(G0({},n.presentationProps),o.props))),a!=null)return a}}),hW=Ie([U2,Km,Gm],(e,n,i)=>{if(!(e==null||n==null))return e.map((s,a)=>{var o,l=Ft(s,n.nameKey,n.name),c;return i!=null&&(o=i[a])!==null&&o!==void 0&&(o=o.props)!==null&&o!==void 0&&o.fill?c=i[a].props.fill:typeof s=="object"&&s!=null&&"fill"in s?c=s.fill:c=n.fill,{value:_a(l,n.dataKey),color:c,payload:s,type:n.legendType}})}),pW=Ie([U2,Km,Gm,wn],(e,n,i,s)=>{if(!(n==null||e==null))return uB({offset:s,pieSettings:n,displayedData:e,cells:i})}),H2={exports:{}},Wt={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vm=Symbol.for("react.transitional.element"),Xm=Symbol.for("react.portal"),fu=Symbol.for("react.fragment"),hu=Symbol.for("react.strict_mode"),pu=Symbol.for("react.profiler"),mu=Symbol.for("react.consumer"),gu=Symbol.for("react.context"),yu=Symbol.for("react.forward_ref"),xu=Symbol.for("react.suspense"),vu=Symbol.for("react.suspense_list"),bu=Symbol.for("react.memo"),ju=Symbol.for("react.lazy"),mW=Symbol.for("react.view_transition"),gW=Symbol.for("react.client.reference");function Dr(e){if(typeof e=="object"&&e!==null){var n=e.$$typeof;switch(n){case Vm:switch(e=e.type,e){case fu:case pu:case hu:case xu:case vu:case mW:return e;default:switch(e=e&&e.$$typeof,e){case gu:case yu:case ju:case bu:return e;case mu:return e;default:return n}}case Xm:return n}}}Wt.ContextConsumer=mu;Wt.ContextProvider=gu;Wt.Element=Vm;Wt.ForwardRef=yu;Wt.Fragment=fu;Wt.Lazy=ju;Wt.Memo=bu;Wt.Portal=Xm;Wt.Profiler=pu;Wt.StrictMode=hu;Wt.Suspense=xu;Wt.SuspenseList=vu;Wt.isContextConsumer=function(e){return Dr(e)===mu};Wt.isContextProvider=function(e){return Dr(e)===gu};Wt.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Vm};Wt.isForwardRef=function(e){return Dr(e)===yu};Wt.isFragment=function(e){return Dr(e)===fu};Wt.isLazy=function(e){return Dr(e)===ju};Wt.isMemo=function(e){return Dr(e)===bu};Wt.isPortal=function(e){return Dr(e)===Xm};Wt.isProfiler=function(e){return Dr(e)===pu};Wt.isStrictMode=function(e){return Dr(e)===hu};Wt.isSuspense=function(e){return Dr(e)===xu};Wt.isSuspenseList=function(e){return Dr(e)===vu};Wt.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===fu||e===pu||e===hu||e===xu||e===vu||typeof e=="object"&&e!==null&&(e.$$typeof===ju||e.$$typeof===bu||e.$$typeof===gu||e.$$typeof===mu||e.$$typeof===yu||e.$$typeof===gW||e.getModuleId!==void 0)};Wt.typeOf=Dr;H2.exports=Wt;var yW=H2.exports,V0=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",X0=null,lf=null,Y2=e=>{if(e===X0&&Array.isArray(lf))return lf;var n=[];return p.Children.forEach(e,i=>{Zt(i)||(yW.isFragment(i)?n=n.concat(Y2(i.props.children)):n.push(i))}),lf=n,X0=e,n};function Qm(e,n){var i=[],s=[];return Array.isArray(n)?s=n.map(a=>V0(a)):s=[V0(n)],Y2(e).forEach(a=>{var o=Ms(a,"type.displayName")||Ms(a,"type.name");o&&s.indexOf(o)!==-1&&i.push(a)}),i}var K2=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,G2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function n(i){var a;if(typeof i!="object"||i==null)return!1;if(Object.getPrototypeOf(i)===null)return!0;if(Object.prototype.toString.call(i)!=="[object Object]"){const o=i[Symbol.toStringTag];return o==null||!((a=Object.getOwnPropertyDescriptor(i,Symbol.toStringTag))!=null&&a.writable)?!1:i.toString()===`[object ${o}]`}let s=i;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(i)===s}e.isPlainObject=n})(G2);var xW=G2.isPlainObject;const vW=Wi(xW);function Q0(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function J0(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?Q0(Object(i),!0).forEach(function(s){bW(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):Q0(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function bW(e,n,i){return(n=jW(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function jW(e){var n=wW(e,"string");return typeof n=="symbol"?n:n+""}function wW(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function rd(){return rd=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},rd.apply(null,arguments)}var Z0=(e,n,i,s,a)=>{var o=i-s,l;return l="M ".concat(e,",").concat(n),l+="L ".concat(e+i,",").concat(n),l+="L ".concat(e+i-o/2,",").concat(n+a),l+="L ".concat(e+i-o/2-s,",").concat(n+a),l+="L ".concat(e,",").concat(n," Z"),l},SW={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},kW=e=>{var n=Tn(e,SW),{x:i,y:s,upperWidth:a,lowerWidth:o,height:l,className:c}=n,{animationEasing:d,animationDuration:u,animationBegin:f,isUpdateAnimationActive:h}=n,m=p.useRef(null),[g,b]=p.useState(-1),j=p.useRef(a),y=p.useRef(o),x=p.useRef(l),v=p.useRef(i),A=p.useRef(s),N=il(e,"trapezoid-");if(p.useEffect(()=>{if(m.current&&m.current.getTotalLength)try{var T=m.current.getTotalLength();T&&b(T)}catch{}},[]),i!==+i||s!==+s||a!==+a||o!==+o||l!==+l||a===0&&o===0||l===0)return null;var C=_t("recharts-trapezoid",c);if(!h)return p.createElement("g",null,p.createElement("path",rd({},Qn(n),{className:C,d:Z0(i,s,a,o,l)})));var w=j.current,_=y.current,I=x.current,O=v.current,E=A.current,S="0px ".concat(g===-1?1:g,"px"),k="".concat(g,"px 0px"),D=$w(["strokeDasharray"],u,d);return p.createElement(rl,{animationId:N,key:N,canBegin:g>0,duration:u,easing:d,isActive:h,begin:f},T=>{var P=Vt(w,a,T),R=Vt(_,o,T),Y=Vt(I,l,T),X=Vt(O,i,T),H=Vt(E,s,T);m.current&&(j.current=P,y.current=R,x.current=Y,v.current=X,A.current=H);var q=T>0?{transition:D,strokeDasharray:k}:{strokeDasharray:S};return p.createElement("path",rd({},Qn(n),{className:C,d:Z0(X,H,P,R,Y),ref:m,style:J0(J0({},q),n.style)}))})},NW=["option","shapeType","propTransformer","activeClassName","isActive"];function _W(e,n){if(e==null)return{};var i,s,a=CW(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function CW(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function ev(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function id(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?ev(Object(i),!0).forEach(function(s){AW(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ev(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function AW(e,n,i){return(n=IW(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function IW(e){var n=TW(e,"string");return typeof n=="symbol"?n:n+""}function TW(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function EW(e,n){return id(id({},n),e)}function PW(e,n){return e==="symbols"}function tv(e){var{shapeType:n,elementProps:i}=e;switch(n){case"rectangle":return p.createElement(Fw,i);case"trapezoid":return p.createElement(kW,i);case"sector":return p.createElement(Yw,i);case"symbols":if(PW(n))return p.createElement(gj,i);break;case"curve":return p.createElement(im,i);default:return null}}function OW(e){return p.isValidElement(e)?e.props:e}function Jm(e){var{option:n,shapeType:i,propTransformer:s=EW,activeClassName:a="recharts-active-shape",isActive:o}=e,l=_W(e,NW),c;if(p.isValidElement(n))c=p.cloneElement(n,id(id({},l),OW(n)));else if(typeof n=="function")c=n(l);else if(vW(n)&&typeof n!="boolean"){var d=s(n,l);c=p.createElement(tv,{shapeType:i,elementProps:d})}else{var u=l;c=p.createElement(tv,{shapeType:i,elementProps:u})}return o?p.createElement(An,{className:a},c):c}var Zm=(e,n)=>{var i=en();return(s,a)=>o=>{e==null||e(s,a,o),i(QS({activeIndex:String(a),activeDataKey:n,activeCoordinate:s.tooltipPosition}))}},eg=e=>{var n=en();return(i,s)=>a=>{e==null||e(i,s,a),n(n$())}},tg=(e,n)=>{var i=en();return(s,a)=>o=>{e==null||e(s,a,o),i(r$({activeIndex:String(a),activeDataKey:n,activeCoordinate:s.tooltipPosition}))}};function ng(e){var{fn:n,args:i}=e,s=en(),a=qn();return p.useLayoutEffect(()=>{if(!a){var o=n(i);return s(ZR(o)),()=>{s(e$(o))}}},[n,i,s,a]),null}function V2(e){var{legendPayload:n}=e,i=en(),s=qn();return p.useLayoutEffect(()=>s?Hs:(i(zw(n)),()=>{i(Mw(n))}),[i,s,n]),null}function DW(e){var{legendPayload:n}=e,i=en(),s=Je(wt);return p.useLayoutEffect(()=>s!=="centric"&&s!=="radial"?Hs:(i(zw(n)),()=>{i(Mw(n))}),[i,s,n]),null}var cf,zW=()=>{var[e]=p.useState(()=>Oo("uid-"));return e},MW=(cf=Qk.useId)!==null&&cf!==void 0?cf:zW;function X2(e,n){var i=MW();return n||(e?"".concat(e,"-").concat(i):i)}var RW=p.createContext(void 0),rg=e=>{var{id:n,type:i,children:s}=e,a=X2("recharts-".concat(i),n);return p.createElement(RW.Provider,{value:a},s(a))},$W={cartesianItems:[],polarItems:[]},Q2=sr({name:"graphicalItems",initialState:$W,reducers:{addCartesianGraphicalItem:{reducer(e,n){e.cartesianItems.push(n.payload)},prepare:bn()},replaceCartesianGraphicalItem:{reducer(e,n){var{prev:i,next:s}=n.payload,a=Ci(e).cartesianItems.indexOf(i);a>-1&&(e.cartesianItems[a]=s)},prepare:bn()},removeCartesianGraphicalItem:{reducer(e,n){var i=Ci(e).cartesianItems.indexOf(n.payload);i>-1&&e.cartesianItems.splice(i,1)},prepare:bn()},addPolarGraphicalItem:{reducer(e,n){e.polarItems.push(n.payload)},prepare:bn()},removePolarGraphicalItem:{reducer(e,n){var i=Ci(e).polarItems.indexOf(n.payload);i>-1&&e.polarItems.splice(i,1)},prepare:bn()}}}),{addCartesianGraphicalItem:LW,replaceCartesianGraphicalItem:WW,removeCartesianGraphicalItem:BW,addPolarGraphicalItem:FW,removePolarGraphicalItem:qW}=Q2.actions,UW=Q2.reducer;function J2(e){var n=en(),i=p.useRef(null);return p.useLayoutEffect(()=>{i.current===null?n(LW(e)):i.current!==e&&n(WW({prev:i.current,next:e})),i.current=e},[n,e]),p.useLayoutEffect(()=>()=>{i.current&&(n(BW(i.current)),i.current=null)},[n]),null}function HW(e){var n=en();return p.useLayoutEffect(()=>(n(FW(e)),()=>{n(qW(e))}),[n,e]),null}var YW=["onMouseEnter","onClick","onMouseLeave"],KW=["id"],GW=["id"];function ig(e,n){if(e==null)return{};var i,s,a=VW(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function VW(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function nv(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function Xt(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?nv(Object(i),!0).forEach(function(s){XW(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):nv(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function XW(e,n,i){return(n=QW(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function QW(e){var n=JW(e,"string");return typeof n=="symbol"?n:n+""}function JW(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function os(){return os=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},os.apply(null,arguments)}function ZW(e){var n=p.useMemo(()=>Qm(e.children,za),[e.children]),i=Je(s=>hW(s,e.id,n));return i==null?null:p.createElement(DW,{legendPayload:i})}function eB(e){var{dataKey:n,nameKey:i,sectors:s,stroke:a,strokeWidth:o,fill:l,name:c,hide:d,tooltipType:u}=e;return{dataDefinedOnItem:s.map(f=>f.tooltipPayload),positions:s.map(f=>f.tooltipPosition),settings:{stroke:a,strokeWidth:o,fill:l,dataKey:n,nameKey:i,name:_a(c,n),hide:d,type:u,color:l,unit:""}}}var tB=(e,n)=>e>n?"start":e<n?"end":"middle",nB=(e,n,i)=>Bn(typeof n=="function"?n(e):n,i,i*.8),rB=(e,n,i)=>{var{top:s,left:a,width:o,height:l}=n,c=qw(o,l),d=a+Bn(e.cx,o,o/2),u=s+Bn(e.cy,l,l/2),f=Bn(e.innerRadius,c,0),h=nB(i,e.outerRadius,c),m=e.maxRadius||Math.sqrt(o*o+l*l)/2;return{cx:d,cy:u,innerRadius:f,outerRadius:h,maxRadius:m}},iB=(e,n)=>{var i=Cn(n-e),s=Math.min(Math.abs(n-e),360);return i*s};function sB(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var aB=(e,n)=>{if(p.isValidElement(e))return p.cloneElement(e,n);if(typeof e=="function")return e(n);var i=_t("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return p.createElement(im,os({},n,{type:"linear",className:i}))},oB=(e,n,i)=>{if(p.isValidElement(e))return p.cloneElement(e,n);var s=i;if(typeof e=="function"&&(s=e(n),p.isValidElement(s)))return s;var a=_t("recharts-pie-label-text",sB(e));return p.createElement(cu,os({},n,{alignmentBaseline:"middle",className:a}),s)};function lB(e){var{sectors:n,props:i,showLabels:s}=e,{label:a,labelLine:o,dataKey:l}=i;if(!s||!a||!n)return null;var c=yr(i),d=zs(a),u=zs(o),f=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,h=n.map((m,g)=>{var b=(m.startAngle+m.endAngle)/2,j=pn(m.cx,m.cy,m.outerRadius+f,b),y=Xt(Xt(Xt(Xt({},c),m),{},{stroke:"none"},d),{},{index:g,textAnchor:tB(j.x,m.cx)},j),x=Xt(Xt(Xt(Xt({},c),m),{},{fill:"none",stroke:m.fill},u),{},{index:g,points:[pn(m.cx,m.cy,m.outerRadius,b),j],key:"line"});return p.createElement(ar,{zIndex:mn.label,key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(g)},p.createElement(An,null,o&&aB(o,x),oB(a,y,Ft(m,l))))});return p.createElement(An,{className:"recharts-pie-labels"},h)}function cB(e){var{sectors:n,props:i,showLabels:s}=e,{label:a}=i;return typeof a=="object"&&a!=null&&"position"in a?p.createElement(Ym,{label:a}):p.createElement(lB,{sectors:n,props:i,showLabels:s})}function dB(e){var{sectors:n,activeShape:i,inactiveShape:s,allOtherPieProps:a}=e,o=Je(as),{onMouseEnter:l,onClick:c,onMouseLeave:d}=a,u=ig(a,YW),f=Zm(l,a.dataKey),h=eg(d),m=tg(c,a.dataKey);return n==null||n.length===0?null:p.createElement(p.Fragment,null,n.map((g,b)=>{if((g==null?void 0:g.startAngle)===0&&(g==null?void 0:g.endAngle)===0&&n.length!==1)return null;var j=i&&String(b)===o,y=o?s:null,x=j?i:y,v=Xt(Xt({},g),{},{stroke:g.stroke,tabIndex:-1,[ww]:b,[Sw]:a.dataKey});return p.createElement(An,os({key:"sector-".concat(g==null?void 0:g.startAngle,"-").concat(g==null?void 0:g.endAngle,"-").concat(g.midAngle,"-").concat(b),tabIndex:-1,className:"recharts-pie-sector"},zd(u,g,b),{onMouseEnter:f(g,b),onMouseLeave:h(g,b),onClick:m(g,b)}),p.createElement(Jm,os({option:x,isActive:j,shapeType:"sector"},v)))}))}function uB(e){var n,{pieSettings:i,displayedData:s,cells:a,offset:o}=e,{cornerRadius:l,startAngle:c,endAngle:d,dataKey:u,nameKey:f,tooltipType:h}=i,m=Math.abs(i.minAngle),g=iB(c,d),b=Math.abs(g),j=s.length<=1?0:(n=i.paddingAngle)!==null&&n!==void 0?n:0,y=s.filter(w=>Ft(w,u,0)!==0).length,x=(b>=360?y:y-1)*j,v=b-y*m-x,A=s.reduce((w,_)=>{var I=Ft(_,u,0);return w+(Qe(I)?I:0)},0),N;if(A>0){var C;N=s.map((w,_)=>{var I=Ft(w,u,0),O=Ft(w,f,_),E=rB(i,o,w),S=(Qe(I)?I:0)/A,k,D=Xt(Xt({},w),a&&a[_]&&a[_].props);_?k=C.endAngle+Cn(g)*j*(I!==0?1:0):k=c;var T=k+Cn(g)*((I!==0?m:0)+S*v),P=(k+T)/2,R=(E.innerRadius+E.outerRadius)/2,Y=[{name:O,value:I,payload:D,dataKey:u,type:h}],X=pn(E.cx,E.cy,R,P);return C=Xt(Xt(Xt(Xt({},i.presentationProps),{},{percent:S,cornerRadius:typeof l=="string"?parseFloat(l):l,name:O,tooltipPayload:Y,midAngle:P,middleRadius:R,tooltipPosition:X},D),E),{},{value:I,startAngle:k,endAngle:T,payload:D,paddingAngle:Cn(g)*j}),C})}return N}function fB(e){var{showLabels:n,sectors:i,children:s}=e,a=p.useMemo(()=>!n||!i?[]:i.map(o=>({value:o.value,payload:o.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:o.cx,cy:o.cy,innerRadius:o.innerRadius,outerRadius:o.outerRadius,startAngle:o.startAngle,endAngle:o.endAngle,clockWise:!1},fill:o.fill})),[i,n]);return p.createElement(Q7,{value:n?a:void 0},s)}function hB(e){var{props:n,previousSectorsRef:i}=e,{sectors:s,isAnimationActive:a,animationBegin:o,animationDuration:l,animationEasing:c,activeShape:d,inactiveShape:u,onAnimationStart:f,onAnimationEnd:h}=n,m=il(n,"recharts-pie-"),g=i.current,[b,j]=p.useState(!1),y=p.useCallback(()=>{typeof h=="function"&&h(),j(!1)},[h]),x=p.useCallback(()=>{typeof f=="function"&&f(),j(!0)},[f]);return p.createElement(fB,{showLabels:!b,sectors:s},p.createElement(rl,{animationId:m,begin:o,duration:l,isActive:a,easing:c,onAnimationStart:x,onAnimationEnd:y,key:m},v=>{var A=[],N=s&&s[0],C=N==null?void 0:N.startAngle;return s==null||s.forEach((w,_)=>{var I=g&&g[_],O=_>0?Ms(w,"paddingAngle",0):0;if(I){var E=Vt(I.endAngle-I.startAngle,w.endAngle-w.startAngle,v),S=Xt(Xt({},w),{},{startAngle:C+O,endAngle:C+E+O});A.push(S),C=S.endAngle}else{var{endAngle:k,startAngle:D}=w,T=Vt(0,k-D,v),P=Xt(Xt({},w),{},{startAngle:C+O,endAngle:C+T+O});A.push(P),C=P.endAngle}}),i.current=A,p.createElement(An,null,p.createElement(dB,{sectors:A,activeShape:d,inactiveShape:u,allOtherPieProps:n}))}),p.createElement(cB,{showLabels:!b,sectors:s,props:n}),n.children)}var pB={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!us.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:mn.area};function mB(e){var{id:n}=e,i=ig(e,KW),{hide:s,className:a,rootTabIndex:o}=e,l=p.useMemo(()=>Qm(e.children,za),[e.children]),c=Je(f=>pW(f,n,l)),d=p.useRef(null),u=_t("recharts-pie",a);return s||c==null?(d.current=null,p.createElement(An,{tabIndex:o,className:u})):p.createElement(ar,{zIndex:e.zIndex},p.createElement(ng,{fn:eB,args:Xt(Xt({},e),{},{sectors:c})}),p.createElement(An,{tabIndex:o,className:u},p.createElement(hB,{props:Xt(Xt({},i),{},{sectors:c}),previousSectorsRef:d})))}function Z2(e){var n=Tn(e,pB),{id:i}=n,s=ig(n,GW),a=yr(s);return p.createElement(rg,{id:i,type:"pie"},o=>p.createElement(p.Fragment,null,p.createElement(HW,{type:"pie",id:o,data:s.data,dataKey:s.dataKey,hide:s.hide,angleAxisId:0,radiusAxisId:0,name:s.name,nameKey:s.nameKey,tooltipType:s.tooltipType,legendType:s.legendType,fill:s.fill,cx:s.cx,cy:s.cy,startAngle:s.startAngle,endAngle:s.endAngle,paddingAngle:s.paddingAngle,minAngle:s.minAngle,innerRadius:s.innerRadius,outerRadius:s.outerRadius,cornerRadius:s.cornerRadius,presentationProps:a,maxRadius:n.maxRadius}),p.createElement(ZW,os({},s,{id:o})),p.createElement(mB,os({},s,{id:o}))))}Z2.displayName="Pie";var gB=["points"];function rv(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function df(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?rv(Object(i),!0).forEach(function(s){yB(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):rv(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function yB(e,n,i){return(n=xB(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function xB(e){var n=vB(e,"string");return typeof n=="symbol"?n:n+""}function vB(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function sd(){return sd=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},sd.apply(null,arguments)}function bB(e,n){if(e==null)return{};var i,s,a=jB(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function jB(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function wB(e){var{option:n,dotProps:i,className:s}=e;if(p.isValidElement(n))return p.cloneElement(n,i);if(typeof n=="function")return n(i);var a=_t(s,typeof n!="boolean"?n.className:""),o=i??{},{points:l}=o,c=bB(o,gB);return p.createElement(W2,sd({},c,{className:a}))}function SB(e,n){return e==null?!1:n?!0:e.length===1}function kB(e){var{points:n,dot:i,className:s,dotClassName:a,dataKey:o,baseProps:l,needClip:c,clipPathId:d,zIndex:u=mn.scatter}=e;if(!SB(n,i))return null;var f=K2(i),h=B3(i),m=n.map((b,j)=>{var y,x,v=df(df(df({r:3},l),h),{},{index:j,cx:(y=b.x)!==null&&y!==void 0?y:void 0,cy:(x=b.y)!==null&&x!==void 0?x:void 0,dataKey:o,value:b.value,payload:b.payload,points:n});return p.createElement(wB,{key:"dot-".concat(j),option:i,dotProps:v,className:a})}),g={};return c&&d!=null&&(g.clipPath="url(#clipPath-".concat(f?"":"dots-").concat(d,")")),p.createElement(ar,{zIndex:u},p.createElement(An,sd({className:s},g),m))}function iv(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function sv(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?iv(Object(i),!0).forEach(function(s){NB(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):iv(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function NB(e,n,i){return(n=_B(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function _B(e){var n=CB(e,"string");return typeof n=="symbol"?n:n+""}function CB(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var AB={xAxis:{},yAxis:{},zAxis:{}},ek=sr({name:"cartesianAxis",initialState:AB,reducers:{addXAxis:{reducer(e,n){e.xAxis[n.payload.id]=n.payload},prepare:bn()},removeXAxis:{reducer(e,n){delete e.xAxis[n.payload.id]},prepare:bn()},addYAxis:{reducer(e,n){e.yAxis[n.payload.id]=n.payload},prepare:bn()},removeYAxis:{reducer(e,n){delete e.yAxis[n.payload.id]},prepare:bn()},addZAxis:{reducer(e,n){e.zAxis[n.payload.id]=n.payload},prepare:bn()},removeZAxis:{reducer(e,n){delete e.zAxis[n.payload.id]},prepare:bn()},updateYAxisWidth(e,n){var{id:i,width:s}=n.payload,a=e.yAxis[i];if(a){var o=a.widthHistory||[];if(o.length===3&&o[0]===o[2]&&s===o[1]&&s!==a.width&&Math.abs(s-o[0])<=1)return;var l=[...o,s].slice(-3);e.yAxis[i]=sv(sv({},e.yAxis[i]),{},{width:s,widthHistory:l})}}}}),{addXAxis:IB,removeXAxis:TB,addYAxis:EB,removeYAxis:PB,addZAxis:OK,removeZAxis:DK,updateYAxisWidth:OB}=ek.actions,DB=ek.reducer,zB=Ie([wn],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),MB=Ie([zB,Fi,qi],(e,n,i)=>{if(!(!e||n==null||i==null))return{x:e.left,y:e.top,width:Math.max(0,n-e.left-e.right),height:Math.max(0,i-e.top-e.bottom)}}),sg=()=>Je(MB),RB=()=>Je(q$);function av(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function uf(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?av(Object(i),!0).forEach(function(s){$B(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):av(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function $B(e,n,i){return(n=LB(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function LB(e){var n=WB(e,"string");return typeof n=="symbol"?n:n+""}function WB(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var BB=e=>{var{point:n,childIndex:i,mainColor:s,activeDot:a,dataKey:o}=e;if(a===!1||n.x==null||n.y==null)return null;var l={index:i,dataKey:o,cx:n.x,cy:n.y,r:4,fill:s??"none",strokeWidth:2,stroke:"#fff",payload:n.payload,value:n.value},c=uf(uf(uf({},l),zs(a)),$p(a)),d;return p.isValidElement(a)?d=p.cloneElement(a,c):typeof a=="function"?d=a(c):d=p.createElement(W2,c),p.createElement(An,{className:"recharts-active-dot"},d)};function FB(e){var{points:n,mainColor:i,activeDot:s,itemDataKey:a,zIndex:o=mn.activeDot}=e,l=Je(as),c=RB();if(n==null||c==null)return null;var d=n.find(u=>c.includes(u.payload));return Zt(d)?null:p.createElement(ar,{zIndex:o},p.createElement(BB,{point:d,childIndex:Number(l),mainColor:i,dataKey:a,activeDot:s}))}var qB="Invariant failed";function UB(e,n){throw new Error(qB)}var HB=["x","y"];function Ph(){return Ph=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Ph.apply(null,arguments)}function ov(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function ro(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?ov(Object(i),!0).forEach(function(s){YB(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):ov(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function YB(e,n,i){return(n=KB(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function KB(e){var n=GB(e,"string");return typeof n=="symbol"?n:n+""}function GB(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function VB(e,n){if(e==null)return{};var i,s,a=XB(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function XB(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function QB(e,n){var{x:i,y:s}=e,a=VB(e,HB),o="".concat(i),l=parseInt(o,10),c="".concat(s),d=parseInt(c,10),u="".concat(n.height||a.height),f=parseInt(u,10),h="".concat(n.width||a.width),m=parseInt(h,10);return ro(ro(ro(ro(ro({},n),a),l?{x:l}:{}),d?{y:d}:{}),{},{height:f,width:m,name:n.name,radius:n.radius})}function ad(e){return p.createElement(Jm,Ph({shapeType:"rectangle",propTransformer:QB,activeClassName:"recharts-active-bar"},e))}var JB=function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,a)=>{if(Qe(n))return n;var o=Qe(s)||Zt(s);return o?n(s,a):(o||UB(),i)}},ZB={},tk=sr({name:"errorBars",initialState:ZB,reducers:{addErrorBar:(e,n)=>{var{itemId:i,errorBar:s}=n.payload;e[i]||(e[i]=[]),e[i].push(s)},replaceErrorBar:(e,n)=>{var{itemId:i,prev:s,next:a}=n.payload;e[i]&&(e[i]=e[i].map(o=>o.dataKey===s.dataKey&&o.direction===s.direction?a:o))},removeErrorBar:(e,n)=>{var{itemId:i,errorBar:s}=n.payload;e[i]&&(e[i]=e[i].filter(a=>a.dataKey!==s.dataKey||a.direction!==s.direction))}}}),{addErrorBar:zK,replaceErrorBar:MK,removeErrorBar:RK}=tk.actions,e9=tk.reducer,t9=["children"];function n9(e,n){if(e==null)return{};var i,s,a=r9(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function r9(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var i9={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},s9=p.createContext(i9);function nk(e){var{children:n}=e,i=n9(e,t9);return p.createElement(s9.Provider,{value:i},n)}function ag(e,n){var i,s,a=Je(u=>Ui(u,e)),o=Je(u=>Hi(u,n)),l=(i=a==null?void 0:a.allowDataOverflow)!==null&&i!==void 0?i:cr.allowDataOverflow,c=(s=o==null?void 0:o.allowDataOverflow)!==null&&s!==void 0?s:dr.allowDataOverflow,d=l||c;return{needClip:d,needClipX:l,needClipY:c}}function rk(e){var{xAxisId:n,yAxisId:i,clipPathId:s}=e,a=sg(),{needClipX:o,needClipY:l,needClip:c}=ag(n,i);if(!c||!a)return null;var{x:d,y:u,width:f,height:h}=a;return p.createElement("clipPath",{id:"clipPath-".concat(s)},p.createElement("rect",{x:o?d:d-f/2,y:l?u:u-h/2,width:o?f:f*2,height:l?h:h*2}))}function a9(e,n){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&un(e.zIndex)?e.zIndex:n}var o9=["onMouseEnter","onMouseLeave","onClick"],l9=["value","background","tooltipPosition"],c9=["id"],d9=["onMouseEnter","onClick","onMouseLeave"];function Li(){return Li=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Li.apply(null,arguments)}function lv(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function Gn(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?lv(Object(i),!0).forEach(function(s){u9(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):lv(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function u9(e,n,i){return(n=f9(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function f9(e){var n=h9(e,"string");return typeof n=="symbol"?n:n+""}function h9(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function od(e,n){if(e==null)return{};var i,s,a=p9(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function p9(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var m9=e=>{var{dataKey:n,name:i,fill:s,legendType:a,hide:o}=e;return[{inactive:o,dataKey:n,type:a,color:s,value:_a(i,n),payload:e}]};function g9(e){var{dataKey:n,stroke:i,strokeWidth:s,fill:a,name:o,hide:l,unit:c}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:i,strokeWidth:s,fill:a,dataKey:n,nameKey:void 0,name:_a(o,n),hide:l,type:e.tooltipType,color:e.fill,unit:c}}}function y9(e){var n=Je(as),{data:i,dataKey:s,background:a,allOtherBarProps:o}=e,{onMouseEnter:l,onMouseLeave:c,onClick:d}=o,u=od(o,o9),f=Zm(l,s),h=eg(c),m=tg(d,s);if(!a||i==null)return null;var g=zs(a);return p.createElement(ar,{zIndex:a9(a,mn.barBackground)},i.map((b,j)=>{var{value:y,background:x,tooltipPosition:v}=b,A=od(b,l9);if(!x)return null;var N=f(b,j),C=h(b,j),w=m(b,j),_=Gn(Gn(Gn(Gn(Gn({option:a,isActive:String(j)===n},A),{},{fill:"#eee"},x),g),zd(u,b,j)),{},{onMouseEnter:N,onMouseLeave:C,onClick:w,dataKey:s,index:j,className:"recharts-bar-background-rectangle"});return p.createElement(ad,Li({key:"background-bar-".concat(j)},_))}))}function x9(e){var{showLabels:n,children:i,rects:s}=e,a=s==null?void 0:s.map(o=>{var l={x:o.x,y:o.y,width:o.width,lowerWidth:o.width,upperWidth:o.width,height:o.height};return Gn(Gn({},l),{},{value:o.value,payload:o.payload,parentViewBox:o.parentViewBox,viewBox:l,fill:o.fill})});return p.createElement($2,{value:n?a:void 0},i)}function v9(e){var{shape:n,activeBar:i,baseProps:s,entry:a,index:o,dataKey:l}=e,c=Je(as),d=Je(f2),u=i&&String(o)===c&&(d==null||l===d),f=u?i:n;return u?p.createElement(ar,{zIndex:mn.activeBar},p.createElement(ad,Li({},s,{name:String(s.name)},a,{isActive:u,option:f,index:o,dataKey:l}))):p.createElement(ad,Li({},s,{name:String(s.name)},a,{isActive:u,option:f,index:o,dataKey:l}))}function b9(e){var{shape:n,baseProps:i,entry:s,index:a,dataKey:o}=e;return p.createElement(ad,Li({},i,{name:String(i.name)},s,{isActive:!1,option:n,index:a,dataKey:o}))}function j9(e){var n,{data:i,props:s}=e,a=(n=yr(s))!==null&&n!==void 0?n:{},{id:o}=a,l=od(a,c9),{shape:c,dataKey:d,activeBar:u}=s,{onMouseEnter:f,onClick:h,onMouseLeave:m}=s,g=od(s,d9),b=Zm(f,d),j=eg(m),y=tg(h,d);return i?p.createElement(p.Fragment,null,i.map((x,v)=>p.createElement(An,Li({key:"rectangle-".concat(x==null?void 0:x.x,"-").concat(x==null?void 0:x.y,"-").concat(x==null?void 0:x.value,"-").concat(v),className:"recharts-bar-rectangle"},zd(g,x,v),{onMouseEnter:b(x,v),onMouseLeave:j(x,v),onClick:y(x,v)}),u?p.createElement(v9,{shape:c,activeBar:u,baseProps:l,entry:x,index:v,dataKey:d}):p.createElement(b9,{shape:c,baseProps:l,entry:x,index:v,dataKey:d})))):null}function w9(e){var{props:n,previousRectanglesRef:i}=e,{data:s,layout:a,isAnimationActive:o,animationBegin:l,animationDuration:c,animationEasing:d,onAnimationEnd:u,onAnimationStart:f}=n,h=i.current,m=il(n,"recharts-bar-"),[g,b]=p.useState(!1),j=!g,y=p.useCallback(()=>{typeof u=="function"&&u(),b(!1)},[u]),x=p.useCallback(()=>{typeof f=="function"&&f(),b(!0)},[f]);return p.createElement(x9,{showLabels:j,rects:s},p.createElement(rl,{animationId:m,begin:l,duration:c,isActive:o,easing:d,onAnimationEnd:y,onAnimationStart:x,key:m},v=>{var A=v===1?s:s==null?void 0:s.map((N,C)=>{var w=h&&h[C];if(w)return Gn(Gn({},N),{},{x:Vt(w.x,N.x,v),y:Vt(w.y,N.y,v),width:Vt(w.width,N.width,v),height:Vt(w.height,N.height,v)});if(a==="horizontal"){var _=Vt(0,N.height,v),I=Vt(N.stackedBarStart,N.y,v);return Gn(Gn({},N),{},{y:I,height:_})}var O=Vt(0,N.width,v),E=Vt(N.stackedBarStart,N.x,v);return Gn(Gn({},N),{},{width:O,x:E})});return v>0&&(i.current=A??null),A==null?null:p.createElement(An,null,p.createElement(j9,{props:n,data:A}))}),p.createElement(Ym,{label:n.label}),n.children)}function S9(e){var n=p.useRef(null);return p.createElement(w9,{previousRectanglesRef:n,props:e})}var ik=0,k9=(e,n)=>{var i=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:i,errorVal:Ft(e,n)}};class N9 extends p.PureComponent{render(){var{hide:n,data:i,dataKey:s,className:a,xAxisId:o,yAxisId:l,needClip:c,background:d,id:u}=this.props;if(n||i==null)return null;var f=_t("recharts-bar",a),h=u;return p.createElement(An,{className:f,id:u},c&&p.createElement("defs",null,p.createElement(rk,{clipPathId:h,xAxisId:o,yAxisId:l})),p.createElement(An,{className:"recharts-bar-rectangles",clipPath:c?"url(#clipPath-".concat(h,")"):void 0},p.createElement(y9,{data:i,dataKey:s,background:d,allOtherBarProps:this.props}),p.createElement(S9,this.props)))}}var _9={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!us.isSsr,legendType:"rect",minPointSize:ik,xAxisId:0,yAxisId:0,zIndex:mn.bar};function C9(e){var{xAxisId:n,yAxisId:i,hide:s,legendType:a,minPointSize:o,activeBar:l,animationBegin:c,animationDuration:d,animationEasing:u,isAnimationActive:f}=e,{needClip:h}=ag(n,i),m=nl(),g=qn(),b=Qm(e.children,za),j=Je(v=>tF(v,n,i,g,e.id,b));if(m!=="vertical"&&m!=="horizontal")return null;var y,x=j==null?void 0:j[0];return x==null||x.height==null||x.width==null?y=0:y=m==="vertical"?x.height/2:x.width/2,p.createElement(nk,{xAxisId:n,yAxisId:i,data:j,dataPointFormatter:k9,errorBarOffset:y},p.createElement(N9,Li({},e,{layout:m,needClip:h,data:j,xAxisId:n,yAxisId:i,hide:s,legendType:a,minPointSize:o,activeBar:l,animationBegin:c,animationDuration:d,animationEasing:u,isAnimationActive:f})))}function A9(e){var{layout:n,barSettings:{dataKey:i,minPointSize:s},pos:a,bandSize:o,xAxis:l,yAxis:c,xAxisTicks:d,yAxisTicks:u,stackedData:f,displayedData:h,offset:m,cells:g,parentViewBox:b,dataStartIndex:j}=e,y=n==="horizontal"?c:l,x=f?y.scale.domain():null,v=Rz({numericAxis:y}),A=y.scale(v);return h.map((N,C)=>{var w,_,I,O,E,S;f?w=Ez(f[C+j],x):(w=Ft(N,i),Array.isArray(w)||(w=[v,w]));var k=JB(s,ik)(w[1],C);if(n==="horizontal"){var D,[T,P]=[c.scale(w[0]),c.scale(w[1])];_=Rx({axis:l,ticks:d,bandSize:o,offset:a.offset,entry:N,index:C}),I=(D=P??T)!==null&&D!==void 0?D:void 0,O=a.size;var R=T-P;if(E=Ur(R)?0:R,S={x:_,y:m.top,width:O,height:m.height},Math.abs(k)>0&&Math.abs(E)<Math.abs(k)){var Y=Cn(E||k)*(Math.abs(k)-Math.abs(E));I-=Y,E+=Y}}else{var[X,H]=[l.scale(w[0]),l.scale(w[1])];if(_=X,I=Rx({axis:c,ticks:u,bandSize:o,offset:a.offset,entry:N,index:C}),O=H-X,E=a.size,S={x:m.left,y:I,width:m.width,height:E},Math.abs(k)>0&&Math.abs(O)<Math.abs(k)){var q=Cn(O||k)*(Math.abs(k)-Math.abs(O));O+=q}}if(_==null||I==null||O==null||E==null)return null;var M=Gn(Gn({},N),{},{stackedBarStart:A,x:_,y:I,width:O,height:E,value:f?w:w[1],payload:N,background:S,tooltipPosition:{x:_+O/2,y:I+E/2},parentViewBox:b},g&&g[C]&&g[C].props);return M}).filter(Boolean)}function I9(e){var n=Tn(e,_9),i=qn();return p.createElement(rg,{id:n.id,type:"bar"},s=>p.createElement(p.Fragment,null,p.createElement(V2,{legendPayload:m9(n)}),p.createElement(ng,{fn:g9,args:n}),p.createElement(J2,{type:"bar",id:s,data:void 0,xAxisId:n.xAxisId,yAxisId:n.yAxisId,zAxisId:0,dataKey:n.dataKey,stackId:Mz(n.stackId),hide:n.hide,barSize:n.barSize,minPointSize:n.minPointSize,maxBarSize:n.maxBarSize,isPanorama:i}),p.createElement(ar,{zIndex:n.zIndex},p.createElement(C9,Li({},n,{id:s})))))}var og=p.memo(I9);og.displayName="Bar";function cv(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function ql(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?cv(Object(i),!0).forEach(function(s){T9(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):cv(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function T9(e,n,i){return(n=E9(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function E9(e){var n=P9(e,"string");return typeof n=="symbol"?n:n+""}function P9(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var O9=(e,n)=>n,D9=(e,n,i)=>i,z9=(e,n,i,s)=>s,M9=(e,n,i,s,a)=>a,fl=Ie([ru,M9],(e,n)=>e.filter(i=>i.type==="bar").find(i=>i.id===n)),R9=Ie([fl],e=>e==null?void 0:e.maxBarSize),$9=(e,n,i,s,a,o)=>o,dv=(e,n,i)=>{var s=i??e;if(!Zt(s))return Bn(s,n,0)},L9=Ie([wt,ru,O9,D9,z9],(e,n,i,s,a)=>n.filter(o=>e==="horizontal"?o.xAxisId===i:o.yAxisId===s).filter(o=>o.isPanorama===a).filter(o=>o.hide===!1).filter(o=>o.type==="bar")),W9=(e,n,i,s)=>{var a=wt(e);return a==="horizontal"?kh(e,"yAxis",i,s):kh(e,"xAxis",n,s)},B9=(e,n,i)=>{var s=wt(e);return s==="horizontal"?y0(e,"xAxis",n):y0(e,"yAxis",i)},F9=(e,n,i)=>{var s={},a=e.filter(eu),o=e.filter(u=>u.stackId==null),l=a.reduce((u,f)=>(u[f.stackId]||(u[f.stackId]=[]),u[f.stackId].push(f),u),s),c=Object.entries(l).map(u=>{var[f,h]=u,m=h.map(b=>b.dataKey),g=dv(n,i,h[0].barSize);return{stackId:f,dataKeys:m,barSize:g}}),d=o.map(u=>{var f=[u.dataKey].filter(m=>m!=null),h=dv(n,i,u.barSize);return{stackId:void 0,dataKeys:f,barSize:h}});return[...c,...d]},q9=Ie([L9,YM,B9],F9),U9=(e,n,i,s,a)=>{var o,l,c=fl(e,n,i,s,a);if(c!=null){var d=wt(e),u=fS(e),{maxBarSize:f}=c,h=Zt(f)?u:f,m,g;return d==="horizontal"?(m=ss(e,"xAxis",n,s),g=is(e,"xAxis",n,s)):(m=ss(e,"yAxis",i,s),g=is(e,"yAxis",i,s)),(o=(l=Sa(m,g,!0))!==null&&l!==void 0?l:h)!==null&&o!==void 0?o:0}},sk=(e,n,i,s)=>{var a=wt(e),o,l;return a==="horizontal"?(o=ss(e,"xAxis",n,s),l=is(e,"xAxis",n,s)):(o=ss(e,"yAxis",i,s),l=is(e,"yAxis",i,s)),Sa(o,l)};function H9(e,n,i,s,a){var o=s.length;if(!(o<1)){var l=Bn(e,i,0,!0),c,d=[];if(un(s[0].barSize)){var u=!1,f=i/o,h=s.reduce((x,v)=>x+(v.barSize||0),0);h+=(o-1)*l,h>=i&&(h-=(o-1)*l,l=0),h>=i&&f>0&&(u=!0,f*=.9,h=o*f);var m=(i-h)/2>>0,g={offset:m-l,size:0};c=s.reduce((x,v)=>{var A,N={stackId:v.stackId,dataKeys:v.dataKeys,position:{offset:g.offset+g.size+l,size:u?f:(A=v.barSize)!==null&&A!==void 0?A:0}},C=[...x,N];return g=C[C.length-1].position,C},d)}else{var b=Bn(n,i,0,!0);i-2*b-(o-1)*l<=0&&(l=0);var j=(i-2*b-(o-1)*l)/o;j>1&&(j>>=0);var y=un(a)?Math.min(j,a):j;c=s.reduce((x,v,A)=>[...x,{stackId:v.stackId,dataKeys:v.dataKeys,position:{offset:b+(j+l)*A+(j-y)/2,size:y}}],d)}return c}}var Y9=(e,n,i,s,a,o,l)=>{var c=Zt(l)?n:l,d=H9(i,s,a!==o?a:o,e,c);return a!==o&&d!=null&&(d=d.map(u=>ql(ql({},u),{},{position:ql(ql({},u.position),{},{offset:u.position.offset-a/2})}))),d},K9=Ie([q9,fS,HM,hS,U9,sk,R9],Y9),G9=(e,n,i,s)=>ss(e,"xAxis",n,s),V9=(e,n,i,s)=>ss(e,"yAxis",i,s),X9=(e,n,i,s)=>is(e,"xAxis",n,s),Q9=(e,n,i,s)=>is(e,"yAxis",i,s),J9=Ie([K9,fl],(e,n)=>{if(!(e==null||n==null)){var i=e.find(s=>s.stackId===n.stackId&&n.dataKey!=null&&s.dataKeys.includes(n.dataKey));if(i!=null)return i.position}}),Z9=(e,n)=>{var i=pm(n);if(!(!e||i==null||n==null)){var{stackId:s}=n;if(s!=null){var a=e[s];if(a){var{stackedData:o}=a;if(o)return o.find(l=>l.key===i)}}}},eF=Ie([W9,fl],Z9),tF=Ie([wn,nm,G9,V9,X9,Q9,J9,wt,Xd,sk,eF,fl,$9],(e,n,i,s,a,o,l,c,d,u,f,h,m)=>{var{chartData:g,dataStartIndex:b,dataEndIndex:j}=d;if(!(h==null||l==null||n==null||c!=="horizontal"&&c!=="vertical"||i==null||s==null||a==null||o==null||u==null)){var{data:y}=h,x;if(y!=null&&y.length>0?x=y:x=g==null?void 0:g.slice(b,j+1),x!=null)return A9({layout:c,barSettings:h,pos:l,parentViewBox:n,bandSize:u,xAxis:i,yAxis:s,xAxisTicks:a,yAxisTicks:o,stackedData:f,displayedData:x,offset:e,cells:m,dataStartIndex:b})}}),ak=e=>{var{chartData:n}=e,i=en(),s=qn();return p.useEffect(()=>s?()=>{}:(i(I0(n)),()=>{i(I0(void 0))}),[n,i,s]),null},uv={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},ok=sr({name:"brush",initialState:uv,reducers:{setBrushSettings(e,n){return n.payload==null?uv:n.payload}}}),{setBrushSettings:$K}=ok.actions,nF=ok.reducer;function rF(e,n,i){return(n=iF(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function iF(e){var n=sF(e,"string");return typeof n=="symbol"?n:n+""}function sF(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}class lg{static create(n){return new lg(n)}constructor(n){this.scale=n}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(n){var{bandAware:i,position:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n!==void 0){if(s)switch(s){case"start":return this.scale(n);case"middle":{var a=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+a}case"end":{var o=this.bandwidth?this.bandwidth():0;return this.scale(n)+o}default:return this.scale(n)}if(i){var l=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+l}return this.scale(n)}}isInRange(n){var i=this.range(),s=i[0],a=i[i.length-1];return s<=a?n>=s&&n<=a:n>=a&&n<=s}}rF(lg,"EPS",1e-4);function aF(e){return(e%180+180)%180}var oF=function(n){var{width:i,height:s}=n,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,o=aF(a),l=o*Math.PI/180,c=Math.atan(s/i),d=l>c&&l<Math.PI-c?s/Math.sin(l):i/Math.cos(l);return Math.abs(d)},lF={dots:[],areas:[],lines:[]},lk=sr({name:"referenceElements",initialState:lF,reducers:{addDot:(e,n)=>{e.dots.push(n.payload)},removeDot:(e,n)=>{var i=Ci(e).dots.findIndex(s=>s===n.payload);i!==-1&&e.dots.splice(i,1)},addArea:(e,n)=>{e.areas.push(n.payload)},removeArea:(e,n)=>{var i=Ci(e).areas.findIndex(s=>s===n.payload);i!==-1&&e.areas.splice(i,1)},addLine:(e,n)=>{e.lines.push(n.payload)},removeLine:(e,n)=>{var i=Ci(e).lines.findIndex(s=>s===n.payload);i!==-1&&e.lines.splice(i,1)}}}),{addDot:LK,removeDot:WK,addArea:BK,removeArea:FK,addLine:qK,removeLine:UK}=lk.actions,cF=lk.reducer,dF=p.createContext(void 0),uF=e=>{var{children:n}=e,[i]=p.useState("".concat(Oo("recharts"),"-clip")),s=sg();if(s==null)return null;var{x:a,y:o,width:l,height:c}=s;return p.createElement(dF.Provider,{value:i},p.createElement("defs",null,p.createElement("clipPath",{id:i},p.createElement("rect",{x:a,y:o,height:c,width:l}))),n)};function ka(e,n){for(var i in e)if({}.hasOwnProperty.call(e,i)&&(!{}.hasOwnProperty.call(n,i)||e[i]!==n[i]))return!1;for(var s in n)if({}.hasOwnProperty.call(n,s)&&!{}.hasOwnProperty.call(e,s))return!1;return!0}function ck(e,n){if(n<1)return[];if(n===1)return e;for(var i=[],s=0;s<e.length;s+=n)i.push(e[s]);return i}function fF(e,n,i){var s={width:e.width+n.width,height:e.height+n.height};return oF(s,i)}function hF(e,n,i){var s=i==="width",{x:a,y:o,width:l,height:c}=e;return n===1?{start:s?a:o,end:s?a+l:o+c}:{start:s?a+l:o+c,end:s?a:o}}function ld(e,n,i,s,a){if(e*n<e*s||e*n>e*a)return!1;var o=i();return e*(n-e*o/2-s)>=0&&e*(n+e*o/2-a)<=0}function pF(e,n){return ck(e,n+1)}function mF(e,n,i,s,a){for(var o=(s||[]).slice(),{start:l,end:c}=n,d=0,u=1,f=l,h=function(){var b=s==null?void 0:s[d];if(b===void 0)return{v:ck(s,u)};var j=d,y,x=()=>(y===void 0&&(y=i(b,j)),y),v=b.coordinate,A=d===0||ld(e,v,x,f,c);A||(d=0,f=l,u+=1),A&&(f=v+e*(x()/2+a),d+=u)},m;u<=o.length;)if(m=h(),m)return m.v;return[]}function fv(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function Ln(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?fv(Object(i),!0).forEach(function(s){gF(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):fv(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function gF(e,n,i){return(n=yF(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function yF(e){var n=xF(e,"string");return typeof n=="symbol"?n:n+""}function xF(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function vF(e,n,i,s,a){for(var o=(s||[]).slice(),l=o.length,{start:c}=n,{end:d}=n,u=function(m){var g=o[m],b,j=()=>(b===void 0&&(b=i(g,m)),b);if(m===l-1){var y=e*(g.coordinate+e*j()/2-d);o[m]=g=Ln(Ln({},g),{},{tickCoord:y>0?g.coordinate-y*e:g.coordinate})}else o[m]=g=Ln(Ln({},g),{},{tickCoord:g.coordinate});if(g.tickCoord!=null){var x=ld(e,g.tickCoord,j,c,d);x&&(d=g.tickCoord-e*(j()/2+a),o[m]=Ln(Ln({},g),{},{isShow:!0}))}},f=l-1;f>=0;f--)u(f);return o}function bF(e,n,i,s,a,o){var l=(s||[]).slice(),c=l.length,{start:d,end:u}=n;if(o){var f=s[c-1],h=i(f,c-1),m=e*(f.coordinate+e*h/2-u);if(l[c-1]=f=Ln(Ln({},f),{},{tickCoord:m>0?f.coordinate-m*e:f.coordinate}),f.tickCoord!=null){var g=ld(e,f.tickCoord,()=>h,d,u);g&&(u=f.tickCoord-e*(h/2+a),l[c-1]=Ln(Ln({},f),{},{isShow:!0}))}}for(var b=o?c-1:c,j=function(v){var A=l[v],N,C=()=>(N===void 0&&(N=i(A,v)),N);if(v===0){var w=e*(A.coordinate-e*C()/2-d);l[v]=A=Ln(Ln({},A),{},{tickCoord:w<0?A.coordinate-w*e:A.coordinate})}else l[v]=A=Ln(Ln({},A),{},{tickCoord:A.coordinate});if(A.tickCoord!=null){var _=ld(e,A.tickCoord,C,d,u);_&&(d=A.tickCoord+e*(C()/2+a),l[v]=Ln(Ln({},A),{},{isShow:!0}))}},y=0;y<b;y++)j(y);return l}function cg(e,n,i){var{tick:s,ticks:a,viewBox:o,minTickGap:l,orientation:c,interval:d,tickFormatter:u,unit:f,angle:h}=e;if(!a||!a.length||!s)return[];if(Qe(d)||us.isSsr){var m;return(m=pF(a,Qe(d)?d:0))!==null&&m!==void 0?m:[]}var g=[],b=c==="top"||c==="bottom"?"width":"height",j=f&&b==="width"?jo(f,{fontSize:n,letterSpacing:i}):{width:0,height:0},y=(A,N)=>{var C=typeof u=="function"?u(A.value,N):A.value;return b==="width"?fF(jo(C,{fontSize:n,letterSpacing:i}),j,h):jo(C,{fontSize:n,letterSpacing:i})[b]},x=a.length>=2?Cn(a[1].coordinate-a[0].coordinate):1,v=hF(o,x,b);return d==="equidistantPreserveStart"?mF(x,v,y,a,l):(d==="preserveStart"||d==="preserveStartEnd"?g=bF(x,v,y,a,l,d==="preserveStartEnd"):g=vF(x,v,y,a,l),g.filter(A=>A.isShow))}var jF=e=>{var{ticks:n,label:i,labelGapWithTick:s=5,tickSize:a=0,tickMargin:o=0}=e,l=0;if(n){Array.from(n).forEach(f=>{if(f){var h=f.getBoundingClientRect();h.width>l&&(l=h.width)}});var c=i?i.getBoundingClientRect().width:0,d=a+o,u=l+d+c+(i?s:0);return Math.round(u)}return 0},wF=["axisLine","width","height","className","hide","ticks","axisType"],SF=["viewBox"],kF=["viewBox"];function Oh(e,n){if(e==null)return{};var i,s,a=NF(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function NF(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function Bs(){return Bs=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Bs.apply(null,arguments)}function hv(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function hn(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?hv(Object(i),!0).forEach(function(s){_F(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):hv(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function _F(e,n,i){return(n=CF(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function CF(e){var n=AF(e,"string");return typeof n=="symbol"?n:n+""}function AF(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}var dg={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:mn.axis};function IF(e){var{x:n,y:i,width:s,height:a,orientation:o,mirror:l,axisLine:c,otherSvgProps:d}=e;if(!c)return null;var u=hn(hn(hn({},d),yr(c)),{},{fill:"none"});if(o==="top"||o==="bottom"){var f=+(o==="top"&&!l||o==="bottom"&&l);u=hn(hn({},u),{},{x1:n,y1:i+f*a,x2:n+s,y2:i+f*a})}else{var h=+(o==="left"&&!l||o==="right"&&l);u=hn(hn({},u),{},{x1:n+h*s,y1:i,x2:n+h*s,y2:i+a})}return p.createElement("line",Bs({},u,{className:_t("recharts-cartesian-axis-line",Ms(c,"className"))}))}function TF(e,n,i,s,a,o,l,c,d){var u,f,h,m,g,b,j=c?-1:1,y=e.tickSize||l,x=Qe(e.tickCoord)?e.tickCoord:e.coordinate;switch(o){case"top":u=f=e.coordinate,m=i+ +!c*a,h=m-j*y,b=h-j*d,g=x;break;case"left":h=m=e.coordinate,f=n+ +!c*s,u=f-j*y,g=u-j*d,b=x;break;case"right":h=m=e.coordinate,f=n+ +c*s,u=f+j*y,g=u+j*d,b=x;break;default:u=f=e.coordinate,m=i+ +c*a,h=m+j*y,b=h+j*d,g=x;break}return{line:{x1:u,y1:h,x2:f,y2:m},tick:{x:g,y:b}}}function EF(e,n){switch(e){case"left":return n?"start":"end";case"right":return n?"end":"start";default:return"middle"}}function PF(e,n){switch(e){case"left":case"right":return"middle";case"top":return n?"start":"end";default:return n?"end":"start"}}function OF(e){var{option:n,tickProps:i,value:s}=e,a,o=_t(i.className,"recharts-cartesian-axis-tick-value");if(p.isValidElement(n))a=p.cloneElement(n,hn(hn({},i),{},{className:o}));else if(typeof n=="function")a=n(hn(hn({},i),{},{className:o}));else{var l="recharts-cartesian-axis-tick-value";typeof n!="boolean"&&(l=_t(l,n==null?void 0:n.className)),a=p.createElement(cu,Bs({},i,{className:l}),s)}return a}var DF=p.forwardRef((e,n)=>{var{ticks:i=[],tick:s,tickLine:a,stroke:o,tickFormatter:l,unit:c,padding:d,tickTextProps:u,orientation:f,mirror:h,x:m,y:g,width:b,height:j,tickSize:y,tickMargin:x,fontSize:v,letterSpacing:A,getTicksConfig:N,events:C,axisType:w}=e,_=cg(hn(hn({},N),{},{ticks:i}),v,A),I=EF(f,h),O=PF(f,h),E=yr(N),S=zs(s),k={};typeof a=="object"&&(k=a);var D=hn(hn({},E),{},{fill:"none"},k),T=_.map(Y=>hn({entry:Y},TF(Y,m,g,b,j,f,y,h,x))),P=T.map(Y=>{var{entry:X,line:H}=Y;return p.createElement(An,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(X.value,"-").concat(X.coordinate,"-").concat(X.tickCoord)},a&&p.createElement("line",Bs({},D,H,{className:_t("recharts-cartesian-axis-tick-line",Ms(a,"className"))})))}),R=T.map((Y,X)=>{var{entry:H,tick:q}=Y,M=hn(hn(hn(hn({textAnchor:I,verticalAnchor:O},E),{},{stroke:"none",fill:o},S),q),{},{index:X,payload:H,visibleTicksCount:_.length,tickFormatter:l,padding:d},u);return p.createElement(An,Bs({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(H.value,"-").concat(H.coordinate,"-").concat(H.tickCoord)},zd(C,H,X)),s&&p.createElement(OF,{option:s,tickProps:M,value:"".concat(typeof l=="function"?l(H.value,X):H.value).concat(c||"")}))});return p.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(w,"-ticks")},R.length>0&&p.createElement(ar,{zIndex:mn.label},p.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(w,"-tick-labels"),ref:n},R)),P.length>0&&p.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(w,"-tick-lines")},P))}),zF=p.forwardRef((e,n)=>{var{axisLine:i,width:s,height:a,className:o,hide:l,ticks:c,axisType:d}=e,u=Oh(e,wF),[f,h]=p.useState(""),[m,g]=p.useState(""),b=p.useRef(null);p.useImperativeHandle(n,()=>({getCalculatedWidth:()=>{var y;return jF({ticks:b.current,label:(y=e.labelRef)===null||y===void 0?void 0:y.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var j=p.useCallback(y=>{if(y){var x=y.getElementsByClassName("recharts-cartesian-axis-tick-value");b.current=x;var v=x[0];if(v){var A=window.getComputedStyle(v),N=A.fontSize,C=A.letterSpacing;(N!==f||C!==m)&&(h(N),g(C))}}},[f,m]);return l||s!=null&&s<=0||a!=null&&a<=0?null:p.createElement(ar,{zIndex:e.zIndex},p.createElement(An,{className:_t("recharts-cartesian-axis",o)},p.createElement(IF,{x:e.x,y:e.y,width:s,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:i,otherSvgProps:yr(e)}),p.createElement(DF,{ref:j,axisType:d,events:u,fontSize:f,getTicksConfig:e,height:e.height,letterSpacing:m,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:c,unit:e.unit,width:e.width,x:e.x,y:e.y}),p.createElement(D7,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},p.createElement(U7,{label:e.label,labelRef:e.labelRef}),e.children)))}),MF=p.memo(zF,(e,n)=>{var{viewBox:i}=e,s=Oh(e,SF),{viewBox:a}=n,o=Oh(n,kF);return ka(i,a)&&ka(s,o)}),ug=p.forwardRef((e,n)=>{var i=Tn(e,dg);return p.createElement(MF,Bs({},i,{ref:n}))});ug.displayName="CartesianAxis";var RF=["x1","y1","x2","y2","key"],$F=["offset"],LF=["xAxisId","yAxisId"],WF=["xAxisId","yAxisId"];function pv(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function Wn(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?pv(Object(i),!0).forEach(function(s){BF(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):pv(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function BF(e,n,i){return(n=FF(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function FF(e){var n=qF(e,"string");return typeof n=="symbol"?n:n+""}function qF(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Ns(){return Ns=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Ns.apply(null,arguments)}function cd(e,n){if(e==null)return{};var i,s,a=UF(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function UF(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var HF=e=>{var{fill:n}=e;if(!n||n==="none")return null;var{fillOpacity:i,x:s,y:a,width:o,height:l,ry:c}=e;return p.createElement("rect",{x:s,y:a,ry:c,width:o,height:l,stroke:"none",fill:n,fillOpacity:i,className:"recharts-cartesian-grid-bg"})};function dk(e){var{option:n,lineItemProps:i}=e,s;if(p.isValidElement(n))s=p.cloneElement(n,i);else if(typeof n=="function")s=n(i);else{var a,{x1:o,y1:l,x2:c,y2:d,key:u}=i,f=cd(i,RF),h=(a=yr(f))!==null&&a!==void 0?a:{},{offset:m}=h,g=cd(h,$F);s=p.createElement("line",Ns({},g,{x1:o,y1:l,x2:c,y2:d,fill:"none",key:u}))}return s}function YF(e){var{x:n,width:i,horizontal:s=!0,horizontalPoints:a}=e;if(!s||!a||!a.length)return null;var{xAxisId:o,yAxisId:l}=e,c=cd(e,LF),d=a.map((u,f)=>{var h=Wn(Wn({},c),{},{x1:n,y1:u,x2:n+i,y2:u,key:"line-".concat(f),index:f});return p.createElement(dk,{key:"line-".concat(f),option:s,lineItemProps:h})});return p.createElement("g",{className:"recharts-cartesian-grid-horizontal"},d)}function KF(e){var{y:n,height:i,vertical:s=!0,verticalPoints:a}=e;if(!s||!a||!a.length)return null;var{xAxisId:o,yAxisId:l}=e,c=cd(e,WF),d=a.map((u,f)=>{var h=Wn(Wn({},c),{},{x1:u,y1:n,x2:u,y2:n+i,key:"line-".concat(f),index:f});return p.createElement(dk,{option:s,lineItemProps:h,key:"line-".concat(f)})});return p.createElement("g",{className:"recharts-cartesian-grid-vertical"},d)}function GF(e){var{horizontalFill:n,fillOpacity:i,x:s,y:a,width:o,height:l,horizontalPoints:c,horizontal:d=!0}=e;if(!d||!n||!n.length||c==null)return null;var u=c.map(h=>Math.round(h+a-a)).sort((h,m)=>h-m);a!==u[0]&&u.unshift(0);var f=u.map((h,m)=>{var g=!u[m+1],b=g?a+l-h:u[m+1]-h;if(b<=0)return null;var j=m%n.length;return p.createElement("rect",{key:"react-".concat(m),y:h,x:s,height:b,width:o,stroke:"none",fill:n[j],fillOpacity:i,className:"recharts-cartesian-grid-bg"})});return p.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},f)}function VF(e){var{vertical:n=!0,verticalFill:i,fillOpacity:s,x:a,y:o,width:l,height:c,verticalPoints:d}=e;if(!n||!i||!i.length)return null;var u=d.map(h=>Math.round(h+a-a)).sort((h,m)=>h-m);a!==u[0]&&u.unshift(0);var f=u.map((h,m)=>{var g=!u[m+1],b=g?a+l-h:u[m+1]-h;if(b<=0)return null;var j=m%i.length;return p.createElement("rect",{key:"react-".concat(m),x:h,y:o,width:b,height:c,stroke:"none",fill:i[j],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return p.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},f)}var XF=(e,n)=>{var{xAxis:i,width:s,height:a,offset:o}=e;return vw(cg(Wn(Wn(Wn({},dg),i),{},{ticks:bw(i),viewBox:{x:0,y:0,width:s,height:a}})),o.left,o.left+o.width,n)},QF=(e,n)=>{var{yAxis:i,width:s,height:a,offset:o}=e;return vw(cg(Wn(Wn(Wn({},dg),i),{},{ticks:bw(i),viewBox:{x:0,y:0,width:s,height:a}})),o.top,o.top+o.height,n)},JF={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:mn.grid};function Bo(e){var n=Pw(),i=Ow(),s=Ew(),a=Wn(Wn({},Tn(e,JF)),{},{x:Qe(e.x)?e.x:s.left,y:Qe(e.y)?e.y:s.top,width:Qe(e.width)?e.width:s.width,height:Qe(e.height)?e.height:s.height}),{xAxisId:o,yAxisId:l,x:c,y:d,width:u,height:f,syncWithTicks:h,horizontalValues:m,verticalValues:g}=a,b=qn(),j=Je(O=>x0(O,"xAxis",o,b)),y=Je(O=>x0(O,"yAxis",l,b));if(!ai(u)||!ai(f)||!Qe(c)||!Qe(d))return null;var x=a.verticalCoordinatesGenerator||XF,v=a.horizontalCoordinatesGenerator||QF,{horizontalPoints:A,verticalPoints:N}=a;if((!A||!A.length)&&typeof v=="function"){var C=m&&m.length,w=v({yAxis:y?Wn(Wn({},y),{},{ticks:C?m:y.ticks}):void 0,width:n??u,height:i??f,offset:s},C?!0:h);Hc(Array.isArray(w),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof w,"]")),Array.isArray(w)&&(A=w)}if((!N||!N.length)&&typeof x=="function"){var _=g&&g.length,I=x({xAxis:j?Wn(Wn({},j),{},{ticks:_?g:j.ticks}):void 0,width:n??u,height:i??f,offset:s},_?!0:h);Hc(Array.isArray(I),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof I,"]")),Array.isArray(I)&&(N=I)}return p.createElement(ar,{zIndex:a.zIndex},p.createElement("g",{className:"recharts-cartesian-grid"},p.createElement(HF,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),p.createElement(GF,Ns({},a,{horizontalPoints:A})),p.createElement(VF,Ns({},a,{verticalPoints:N})),p.createElement(YF,Ns({},a,{offset:s,horizontalPoints:A,xAxis:j,yAxis:y})),p.createElement(KF,Ns({},a,{offset:s,verticalPoints:N,xAxis:j,yAxis:y}))))}Bo.displayName="CartesianGrid";var uk=(e,n,i,s)=>ss(e,"xAxis",n,s),fk=(e,n,i,s)=>is(e,"xAxis",n,s),hk=(e,n,i,s)=>ss(e,"yAxis",i,s),pk=(e,n,i,s)=>is(e,"yAxis",i,s),ZF=Ie([wt,uk,hk,fk,pk],(e,n,i,s,a)=>ds(e,"xAxis")?Sa(n,s,!1):Sa(i,a,!1)),eq=(e,n,i,s,a)=>a;function tq(e){return e.type==="line"}var nq=Ie([ru,eq],(e,n)=>e.filter(tq).find(i=>i.id===n)),rq=Ie([wt,uk,hk,fk,pk,nq,ZF,Xd],(e,n,i,s,a,o,l,c)=>{var{chartData:d,dataStartIndex:u,dataEndIndex:f}=c;if(!(o==null||n==null||i==null||s==null||a==null||s.length===0||a.length===0||l==null)){var{dataKey:h,data:m}=o,g;if(m!=null&&m.length>0?g=m:g=d==null?void 0:d.slice(u,f+1),g!=null)return kq({layout:e,xAxis:n,yAxis:i,xAxisTicks:s,yAxisTicks:a,dataKey:h,bandSize:l,displayedData:g})}});function iq(e){var n=zs(e),i=3,s=2;if(n!=null){var{r:a,strokeWidth:o}=n,l=Number(a),c=Number(o);return(Number.isNaN(l)||l<0)&&(l=i),(Number.isNaN(c)||c<0)&&(c=s),{r:l,strokeWidth:c}}return{r:i,strokeWidth:s}}var sq=["id"],aq=["type","layout","connectNulls","needClip","shape"],oq=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function Fo(){return Fo=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Fo.apply(null,arguments)}function mv(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function Zr(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?mv(Object(i),!0).forEach(function(s){lq(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):mv(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function lq(e,n,i){return(n=cq(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function cq(e){var n=dq(e,"string");return typeof n=="symbol"?n:n+""}function dq(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function fg(e,n){if(e==null)return{};var i,s,a=uq(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function uq(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var fq=e=>{var{dataKey:n,name:i,stroke:s,legendType:a,hide:o}=e;return[{inactive:o,dataKey:n,type:a,color:s,value:_a(i,n),payload:e}]};function hq(e){var{dataKey:n,data:i,stroke:s,strokeWidth:a,fill:o,name:l,hide:c,unit:d}=e;return{dataDefinedOnItem:i,positions:void 0,settings:{stroke:s,strokeWidth:a,fill:o,dataKey:n,nameKey:void 0,name:_a(l,n),hide:c,type:e.tooltipType,color:e.stroke,unit:d}}}var mk=(e,n)=>"".concat(n,"px ").concat(e-n,"px");function pq(e,n){for(var i=e.length%2!==0?[...e,0]:e,s=[],a=0;a<n;++a)s=[...s,...i];return s}var mq=(e,n,i)=>{var s=i.reduce((h,m)=>h+m);if(!s)return mk(n,e);for(var a=Math.floor(e/s),o=e%s,l=n-e,c=[],d=0,u=0;d<i.length;u+=i[d],++d)if(u+i[d]>o){c=[...i.slice(0,d),o-u];break}var f=c.length%2===0?[0,l]:[l];return[...pq(i,a),...c,...f].map(h=>"".concat(h,"px")).join(", ")};function gq(e){var{clipPathId:n,points:i,props:s}=e,{dot:a,dataKey:o,needClip:l}=s,{id:c}=s,d=fg(s,sq),u=yr(d);return p.createElement(kB,{points:i,dot:a,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:o,baseProps:u,needClip:l,clipPathId:n})}function yq(e){var{showLabels:n,children:i,points:s}=e,a=p.useMemo(()=>s==null?void 0:s.map(o=>{var l,c,d={x:(l=o.x)!==null&&l!==void 0?l:0,y:(c=o.y)!==null&&c!==void 0?c:0,width:0,lowerWidth:0,upperWidth:0,height:0};return Zr(Zr({},d),{},{value:o.value,payload:o.payload,viewBox:d,parentViewBox:void 0,fill:void 0})}),[s]);return p.createElement($2,{value:n?a:void 0},i)}function gv(e){var{clipPathId:n,pathRef:i,points:s,strokeDasharray:a,props:o}=e,{type:l,layout:c,connectNulls:d,needClip:u,shape:f}=o,h=fg(o,aq),m=Zr(Zr({},Qn(h)),{},{fill:"none",className:"recharts-line-curve",clipPath:u?"url(#clipPath-".concat(n,")"):void 0,points:s,type:l,layout:c,connectNulls:d,strokeDasharray:a??o.strokeDasharray});return p.createElement(p.Fragment,null,(s==null?void 0:s.length)>1&&p.createElement(Jm,Fo({shapeType:"curve",option:f},m,{pathRef:i})),p.createElement(gq,{points:s,clipPathId:n,props:o}))}function xq(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function vq(e){var{clipPathId:n,props:i,pathRef:s,previousPointsRef:a,longestAnimatedLengthRef:o}=e,{points:l,strokeDasharray:c,isAnimationActive:d,animationBegin:u,animationDuration:f,animationEasing:h,animateNewValues:m,width:g,height:b,onAnimationEnd:j,onAnimationStart:y}=i,x=a.current,v=il(i,"recharts-line-"),[A,N]=p.useState(!1),C=!A,w=p.useCallback(()=>{typeof j=="function"&&j(),N(!1)},[j]),_=p.useCallback(()=>{typeof y=="function"&&y(),N(!0)},[y]),I=xq(s.current),O=o.current;return p.createElement(yq,{points:l,showLabels:C},i.children,p.createElement(rl,{animationId:v,begin:u,duration:f,isActive:d,easing:h,onAnimationEnd:w,onAnimationStart:_,key:v},E=>{var S=Vt(O,I+O,E),k=Math.min(S,I),D;if(d)if(c){var T="".concat(c).split(/[,\s]+/gim).map(Y=>parseFloat(Y));D=mq(k,I,T)}else D=mk(I,k);else D=c==null?void 0:String(c);if(x){var P=x.length/l.length,R=E===1?l:l.map((Y,X)=>{var H=Math.floor(X*P);if(x[H]){var q=x[H];return Zr(Zr({},Y),{},{x:Vt(q.x,Y.x,E),y:Vt(q.y,Y.y,E)})}return m?Zr(Zr({},Y),{},{x:Vt(g*2,Y.x,E),y:Vt(b/2,Y.y,E)}):Zr(Zr({},Y),{},{x:Y.x,y:Y.y})});return a.current=R,p.createElement(gv,{props:i,points:R,clipPathId:n,pathRef:s,strokeDasharray:D})}return E>0&&I>0&&(a.current=l,o.current=k),p.createElement(gv,{props:i,points:l,clipPathId:n,pathRef:s,strokeDasharray:D})}),p.createElement(Ym,{label:i.label}))}function bq(e){var{clipPathId:n,props:i}=e,s=p.useRef(null),a=p.useRef(0),o=p.useRef(null);return p.createElement(vq,{props:i,clipPathId:n,previousPointsRef:s,longestAnimatedLengthRef:a,pathRef:o})}var jq=(e,n)=>{var i,s;return{x:(i=e.x)!==null&&i!==void 0?i:void 0,y:(s=e.y)!==null&&s!==void 0?s:void 0,value:e.value,errorVal:Ft(e.payload,n)}};class wq extends p.Component{render(){var{hide:n,dot:i,points:s,className:a,xAxisId:o,yAxisId:l,top:c,left:d,width:u,height:f,id:h,needClip:m,zIndex:g}=this.props;if(n)return null;var b=_t("recharts-line",a),j=h,{r:y,strokeWidth:x}=iq(i),v=K2(i),A=y*2+x;return p.createElement(ar,{zIndex:g},p.createElement(An,{className:b},m&&p.createElement("defs",null,p.createElement(rk,{clipPathId:j,xAxisId:o,yAxisId:l}),!v&&p.createElement("clipPath",{id:"clipPath-dots-".concat(j)},p.createElement("rect",{x:d-A/2,y:c-A/2,width:u+A,height:f+A}))),p.createElement(nk,{xAxisId:o,yAxisId:l,data:s,dataPointFormatter:jq,errorBarOffset:0},p.createElement(bq,{props:this.props,clipPathId:j}))),p.createElement(FB,{activeDot:this.props.activeDot,points:s,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var gk={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!us.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:mn.line};function Sq(e){var n=Tn(e,gk),{activeDot:i,animateNewValues:s,animationBegin:a,animationDuration:o,animationEasing:l,connectNulls:c,dot:d,hide:u,isAnimationActive:f,label:h,legendType:m,xAxisId:g,yAxisId:b,id:j}=n,y=fg(n,oq),{needClip:x}=ag(g,b),v=sg(),A=nl(),N=qn(),C=Je(E=>rq(E,g,b,N,j));if(A!=="horizontal"&&A!=="vertical"||C==null||v==null)return null;var{height:w,width:_,x:I,y:O}=v;return p.createElement(wq,Fo({},y,{id:j,connectNulls:c,dot:d,activeDot:i,animateNewValues:s,animationBegin:a,animationDuration:o,animationEasing:l,isAnimationActive:f,hide:u,label:h,legendType:m,xAxisId:g,yAxisId:b,points:C,layout:A,height:w,width:_,left:I,top:O,needClip:x}))}function kq(e){var{layout:n,xAxis:i,yAxis:s,xAxisTicks:a,yAxisTicks:o,dataKey:l,bandSize:c,displayedData:d}=e;return d.map((u,f)=>{var h=Ft(u,l);if(n==="horizontal"){var m=Mx({axis:i,ticks:a,bandSize:c,entry:u,index:f}),g=Zt(h)?null:s.scale(h);return{x:m,y:g,value:h,payload:u}}var b=Zt(h)?null:i.scale(h),j=Mx({axis:s,ticks:o,bandSize:c,entry:u,index:f});return b==null||j==null?null:{x:b,y:j,value:h,payload:u}}).filter(Boolean)}function Nq(e){var n=Tn(e,gk),i=qn();return p.createElement(rg,{id:n.id,type:"line"},s=>p.createElement(p.Fragment,null,p.createElement(V2,{legendPayload:fq(n)}),p.createElement(ng,{fn:hq,args:n}),p.createElement(J2,{type:"line",id:s,data:n.data,xAxisId:n.xAxisId,yAxisId:n.yAxisId,zAxisId:0,dataKey:n.dataKey,hide:n.hide,isPanorama:i}),p.createElement(Sq,Fo({},n,{id:s}))))}var hg=p.memo(Nq);hg.displayName="Line";var _q=["dangerouslySetInnerHTML","ticks"],Cq=["id"],Aq=["domain"],Iq=["domain"];function Dh(){return Dh=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Dh.apply(null,arguments)}function dd(e,n){if(e==null)return{};var i,s,a=Tq(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function Tq(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function Eq(e){var n=en();return p.useLayoutEffect(()=>(n(IB(e)),()=>{n(TB(e))}),[e,n]),null}var Pq=e=>{var{xAxisId:n,className:i}=e,s=Je(nm),a=qn(),o="xAxis",l=Je(y=>Pa(y,o,n,a)),c=Je(y=>HS(y,o,n,a)),d=Je(y=>BS(y,n)),u=Je(y=>qR(y,n)),f=Je(y=>jS(y,n));if(d==null||u==null||f==null)return null;var{dangerouslySetInnerHTML:h,ticks:m}=e,g=dd(e,_q),{id:b}=f,j=dd(f,Cq);return p.createElement(ug,Dh({},g,j,{scale:l,x:u.x,y:u.y,width:d.width,height:d.height,className:_t("recharts-".concat(o," ").concat(o),i),viewBox:s,ticks:c,axisType:o}))},Oq={allowDataOverflow:cr.allowDataOverflow,allowDecimals:cr.allowDecimals,allowDuplicatedCategory:cr.allowDuplicatedCategory,height:cr.height,hide:!1,mirror:cr.mirror,orientation:cr.orientation,padding:cr.padding,reversed:cr.reversed,scale:cr.scale,tickCount:cr.tickCount,type:cr.type,xAxisId:0},Dq=e=>{var n,i,s,a,o,l=Tn(e,Oq);return p.createElement(p.Fragment,null,p.createElement(Eq,{interval:(n=l.interval)!==null&&n!==void 0?n:"preserveEnd",id:l.xAxisId,scale:l.scale,type:l.type,padding:l.padding,allowDataOverflow:l.allowDataOverflow,domain:l.domain,dataKey:l.dataKey,allowDuplicatedCategory:l.allowDuplicatedCategory,allowDecimals:l.allowDecimals,tickCount:l.tickCount,includeHidden:(i=l.includeHidden)!==null&&i!==void 0?i:!1,reversed:l.reversed,ticks:l.ticks,height:l.height,orientation:l.orientation,mirror:l.mirror,hide:l.hide,unit:l.unit,name:l.name,angle:(s=l.angle)!==null&&s!==void 0?s:0,minTickGap:(a=l.minTickGap)!==null&&a!==void 0?a:5,tick:(o=l.tick)!==null&&o!==void 0?o:!0,tickFormatter:l.tickFormatter}),p.createElement(Pq,l))},zq=(e,n)=>{var{domain:i}=e,s=dd(e,Aq),{domain:a}=n,o=dd(n,Iq);return ka(s,o)?Array.isArray(i)&&i.length===2&&Array.isArray(a)&&a.length===2?i[0]===a[0]&&i[1]===a[1]:ka({domain:i},{domain:a}):!1},qo=p.memo(Dq,zq);qo.displayName="XAxis";var Mq=["dangerouslySetInnerHTML","ticks"],Rq=["id"],$q=["domain"],Lq=["domain"];function zh(){return zh=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},zh.apply(null,arguments)}function ud(e,n){if(e==null)return{};var i,s,a=Wq(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function Wq(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function Bq(e){var n=en();return p.useLayoutEffect(()=>(n(EB(e)),()=>{n(PB(e))}),[e,n]),null}var Fq=e=>{var{yAxisId:n,className:i,width:s,label:a}=e,o=p.useRef(null),l=p.useRef(null),c=Je(nm),d=qn(),u=en(),f="yAxis",h=Je(C=>Pa(C,f,n,d)),m=Je(C=>FS(C,n)),g=Je(C=>HR(C,n)),b=Je(C=>HS(C,f,n,d)),j=Je(C=>wS(C,n));if(p.useLayoutEffect(()=>{if(!(s!=="auto"||!m||Hm(a)||p.isValidElement(a)||j==null)){var C=o.current;if(C){var w=C.getCalculatedWidth();Math.round(m.width)!==Math.round(w)&&u(OB({id:n,width:w}))}}},[b,m,u,a,n,s,j]),m==null||g==null||j==null)return null;var{dangerouslySetInnerHTML:y,ticks:x}=e,v=ud(e,Mq),{id:A}=j,N=ud(j,Rq);return p.createElement(ug,zh({},v,N,{ref:o,labelRef:l,scale:h,x:g.x,y:g.y,tickTextProps:s==="auto"?{width:void 0}:{width:s},width:m.width,height:m.height,className:_t("recharts-".concat(f," ").concat(f),i),viewBox:c,ticks:b,axisType:f}))},qq={allowDataOverflow:dr.allowDataOverflow,allowDecimals:dr.allowDecimals,allowDuplicatedCategory:dr.allowDuplicatedCategory,hide:!1,mirror:dr.mirror,orientation:dr.orientation,padding:dr.padding,reversed:dr.reversed,scale:dr.scale,tickCount:dr.tickCount,type:dr.type,width:dr.width,yAxisId:0},Uq=e=>{var n,i,s,a,o,l=Tn(e,qq);return p.createElement(p.Fragment,null,p.createElement(Bq,{interval:(n=l.interval)!==null&&n!==void 0?n:"preserveEnd",id:l.yAxisId,scale:l.scale,type:l.type,domain:l.domain,allowDataOverflow:l.allowDataOverflow,dataKey:l.dataKey,allowDuplicatedCategory:l.allowDuplicatedCategory,allowDecimals:l.allowDecimals,tickCount:l.tickCount,padding:l.padding,includeHidden:(i=l.includeHidden)!==null&&i!==void 0?i:!1,reversed:l.reversed,ticks:l.ticks,width:l.width,orientation:l.orientation,mirror:l.mirror,hide:l.hide,unit:l.unit,name:l.name,angle:(s=l.angle)!==null&&s!==void 0?s:0,minTickGap:(a=l.minTickGap)!==null&&a!==void 0?a:5,tick:(o=l.tick)!==null&&o!==void 0?o:!0,tickFormatter:l.tickFormatter}),p.createElement(Fq,l))},Hq=(e,n)=>{var{domain:i}=e,s=ud(e,$q),{domain:a}=n,o=ud(n,Lq);return ka(s,o)?Array.isArray(i)&&i.length===2&&Array.isArray(a)&&a.length===2?i[0]===a[0]&&i[1]===a[1]:ka({domain:i},{domain:a}):!1},Uo=p.memo(Uq,Hq);Uo.displayName="YAxis";var Yq={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hl=p;function Kq(e,n){return e===n&&(e!==0||1/e===1/n)||e!==e&&n!==n}var Gq=typeof Object.is=="function"?Object.is:Kq,Vq=hl.useSyncExternalStore,Xq=hl.useRef,Qq=hl.useEffect,Jq=hl.useMemo,Zq=hl.useDebugValue;Yq.useSyncExternalStoreWithSelector=function(e,n,i,s,a){var o=Xq(null);if(o.current===null){var l={hasValue:!1,value:null};o.current=l}else l=o.current;o=Jq(function(){function d(g){if(!u){if(u=!0,f=g,g=s(g),a!==void 0&&l.hasValue){var b=l.value;if(a(b,g))return h=b}return h=g}if(b=h,Gq(f,g))return b;var j=s(g);return a!==void 0&&a(b,j)?(f=g,b):(f=g,h=j)}var u=!1,f,h,m=i===void 0?null:i;return[function(){return d(n())},m===null?void 0:function(){return d(m())}]},[n,i,s,a]);var c=Vq(e,o[0],o[1]);return Qq(function(){l.hasValue=!0,l.value=c},[c]),Zq(c),c};function eU(e){e()}function tU(){let e=null,n=null;return{clear(){e=null,n=null},notify(){eU(()=>{let i=e;for(;i;)i.callback(),i=i.next})},get(){const i=[];let s=e;for(;s;)i.push(s),s=s.next;return i},subscribe(i){let s=!0;const a=n={callback:i,next:null,prev:n};return a.prev?a.prev.next=a:e=a,function(){!s||e===null||(s=!1,a.next?a.next.prev=a.prev:n=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var yv={notify(){},get:()=>[]};function nU(e,n){let i,s=yv,a=0,o=!1;function l(j){f();const y=s.subscribe(j);let x=!1;return()=>{x||(x=!0,y(),h())}}function c(){s.notify()}function d(){b.onStateChange&&b.onStateChange()}function u(){return o}function f(){a++,i||(i=e.subscribe(d),s=tU())}function h(){a--,i&&a===0&&(i(),i=void 0,s.clear(),s=yv)}function m(){o||(o=!0,f())}function g(){o&&(o=!1,h())}const b={addNestedSub:l,notifyNestedSubs:c,handleChangeWrapper:d,isSubscribed:u,trySubscribe:m,tryUnsubscribe:g,getListeners:()=>s};return b}var rU=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",iU=rU(),sU=()=>typeof navigator<"u"&&navigator.product==="ReactNative",aU=sU(),oU=()=>iU||aU?p.useLayoutEffect:p.useEffect,lU=oU(),ff=Symbol.for("react-redux-context"),hf=typeof globalThis<"u"?globalThis:{};function cU(){if(!p.createContext)return{};const e=hf[ff]??(hf[ff]=new Map);let n=e.get(p.createContext);return n||(n=p.createContext(null),e.set(p.createContext,n)),n}var dU=cU();function uU(e){const{children:n,context:i,serverState:s,store:a}=e,o=p.useMemo(()=>{const d=nU(a);return{store:a,subscription:d,getServerState:s?()=>s:void 0}},[a,s]),l=p.useMemo(()=>a.getState(),[a]);lU(()=>{const{subscription:d}=o;return d.onStateChange=d.notifyNestedSubs,d.trySubscribe(),l!==a.getState()&&d.notifyNestedSubs(),()=>{d.tryUnsubscribe(),d.onStateChange=void 0}},[o,l]);const c=i||dU;return p.createElement(c.Provider,{value:o},n)}var fU=uU,hU=(e,n)=>n,pg=Ie([hU,wt,vS,Sn,l2,Yi,nL,wn],cL),mg=e=>{var n=e.currentTarget.getBoundingClientRect(),i=n.width/e.currentTarget.offsetWidth,s=n.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-n.left)/i),chartY:Math.round((e.clientY-n.top)/s)}},yk=Er("mouseClick"),xk=el();xk.startListening({actionCreator:yk,effect:(e,n)=>{var i=e.payload,s=pg(n.getState(),mg(i));(s==null?void 0:s.activeIndex)!=null&&n.dispatch(i$({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}});var Mh=Er("mouseMove"),vk=el();vk.startListening({actionCreator:Mh,effect:(e,n)=>{var i=e.payload,s=n.getState(),a=zm(s,s.tooltip.settings.shared),o=pg(s,mg(i));a==="axis"&&((o==null?void 0:o.activeIndex)!=null?n.dispatch(ZS({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate})):n.dispatch(JS()))}});var xv={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0},bk=sr({name:"rootProps",initialState:xv,reducers:{updateOptions:(e,n)=>{var i;e.accessibilityLayer=n.payload.accessibilityLayer,e.barCategoryGap=n.payload.barCategoryGap,e.barGap=(i=n.payload.barGap)!==null&&i!==void 0?i:xv.barGap,e.barSize=n.payload.barSize,e.maxBarSize=n.payload.maxBarSize,e.stackOffset=n.payload.stackOffset,e.syncId=n.payload.syncId,e.syncMethod=n.payload.syncMethod,e.className=n.payload.className,e.baseValue=n.payload.baseValue}}}),pU=bk.reducer,{updateOptions:mU}=bk.actions,jk=sr({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,n)=>n.payload}}),{updatePolarOptions:gU}=jk.actions,yU=jk.reducer,wk=Er("keyDown"),Sk=Er("focus"),gg=el();gg.startListening({actionCreator:wk,effect:(e,n)=>{var i=n.getState(),s=i.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:a}=i.tooltip,o=e.payload;if(!(o!=="ArrowRight"&&o!=="ArrowLeft"&&o!=="Enter")){var l=Number(Mm(a,Da(i))),c=Yi(i);if(o==="Enter"){var d=ed(i,"axis","hover",String(a.index));n.dispatch(_h({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:d}));return}var u=VR(i),f=u==="left-to-right"?1:-1,h=o==="ArrowRight"?1:-1,m=l+h*f;if(!(c==null||m>=c.length||m<0)){var g=ed(i,"axis","hover",String(m));n.dispatch(_h({active:!0,activeIndex:m.toString(),activeDataKey:void 0,activeCoordinate:g}))}}}}});gg.startListening({actionCreator:Sk,effect:(e,n)=>{var i=n.getState(),s=i.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:a}=i.tooltip;if(!a.active&&a.index==null){var o="0",l=ed(i,"axis","hover",String(o));n.dispatch(_h({activeDataKey:void 0,active:!0,activeIndex:o,activeCoordinate:l}))}}}});var Nr=Er("externalEvent"),kk=el();kk.startListening({actionCreator:Nr,effect:(e,n)=>{if(e.payload.handler!=null){var i=n.getState(),s={activeCoordinate:W$(i),activeDataKey:f2(i),activeIndex:as(i),activeLabel:u2(i),activeTooltipIndex:as(i),isTooltipActive:B$(i)};e.payload.handler(s,e.payload.reactEvent)}}});var xU=Ie([Oa],e=>e.tooltipItemPayloads),vU=Ie([xU,dl,(e,n,i)=>n,(e,n,i)=>i],(e,n,i,s)=>{var a=e.find(c=>c.settings.dataKey===s);if(a!=null){var{positions:o}=a;if(o!=null){var l=n(o,i);return l}}}),Nk=Er("touchMove"),_k=el();_k.startListening({actionCreator:Nk,effect:(e,n)=>{var i=e.payload;if(!(i.touches==null||i.touches.length===0)){var s=n.getState(),a=zm(s,s.tooltip.settings.shared);if(a==="axis"){var o=pg(s,mg({clientX:i.touches[0].clientX,clientY:i.touches[0].clientY,currentTarget:i.currentTarget}));(o==null?void 0:o.activeIndex)!=null&&n.dispatch(ZS({activeIndex:o.activeIndex,activeDataKey:void 0,activeCoordinate:o.activeCoordinate}))}else if(a==="item"){var l,c=i.touches[0];if(document.elementFromPoint==null)return;var d=document.elementFromPoint(c.clientX,c.clientY);if(!d||!d.getAttribute)return;var u=d.getAttribute(ww),f=(l=d.getAttribute(Sw))!==null&&l!==void 0?l:void 0,h=vU(n.getState(),u,f);n.dispatch(QS({activeDataKey:f,activeIndex:u,activeCoordinate:h}))}}}});var bU=Kj({brush:nF,cartesianAxis:DB,chartData:LL,errorBars:e9,graphicalItems:UW,layout:Nz,legend:g5,options:DL,polarAxis:oW,polarOptions:yU,referenceElements:cF,rootProps:pU,tooltip:s$,zIndex:SL}),jU=function(n){return XD({reducer:bU,preloadedState:n,middleware:i=>i({serializableCheck:!1}).concat([xk.middleware,vk.middleware,gg.middleware,kk.middleware,_k.middleware]),enhancers:i=>{var s=i;return typeof i=="function"&&(s=i()),s.concat(sw({type:"raf"}))},devTools:us.devToolsEnabled})};function Ck(e){var{preloadedState:n,children:i,reduxStoreName:s}=e,a=qn(),o=p.useRef(null);if(a)return i;o.current==null&&(o.current=jU(n));var l=Gp;return p.createElement(fU,{context:l,store:o.current},i)}function Ak(e){var{layout:n,margin:i}=e,s=en(),a=qn();return p.useEffect(()=>{a||(s(wz(n)),s(jz(i)))},[s,a,n,i]),null}function Ik(e){var n=en();return p.useEffect(()=>{n(mU(e))},[n,e]),null}function vv(e){var{zIndex:n,isPanorama:i}=e,s=i?"recharts-zindex-panorama-":"recharts-zindex-",a=X2("".concat(s).concat(n)),o=en();return p.useLayoutEffect(()=>(o(jL({zIndex:n,elementId:a,isPanorama:i})),()=>{o(wL({zIndex:n,isPanorama:i}))}),[o,n,a,i]),p.createElement("g",{id:a})}function bv(e){var{children:n,isPanorama:i}=e,s=Je(uL);if(!s||s.length===0)return n;var a=s.filter(l=>l<0),o=s.filter(l=>l>0);return p.createElement(p.Fragment,null,a.map(l=>p.createElement(vv,{key:l,zIndex:l,isPanorama:i})),n,o.map(l=>p.createElement(vv,{key:l,zIndex:l,isPanorama:i})))}var wU=["children"];function SU(e,n){if(e==null)return{};var i,s,a=kU(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function kU(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}function fd(){return fd=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},fd.apply(null,arguments)}var NU={width:"100%",height:"100%",display:"block"},_U=p.forwardRef((e,n)=>{var i=Pw(),s=Ow(),a=Rw();if(!ai(i)||!ai(s))return null;var{children:o,otherAttributes:l,title:c,desc:d}=e,u,f;return l!=null&&(typeof l.tabIndex=="number"?u=l.tabIndex:u=a?0:void 0,typeof l.role=="string"?f=l.role:f=a?"application":void 0),p.createElement(G1,fd({},l,{title:c,desc:d,role:f,tabIndex:u,width:i,height:s,style:NU,ref:n}),o)}),CU=e=>{var{children:n}=e,i=Je(Kd);if(!i)return null;var{width:s,height:a,y:o,x:l}=i;return p.createElement(G1,{width:s,height:a,x:l,y:o},n)},jv=p.forwardRef((e,n)=>{var{children:i}=e,s=SU(e,wU),a=qn();return a?p.createElement(CU,null,p.createElement(bv,{isPanorama:!0},i)):p.createElement(_U,fd({ref:n},s),p.createElement(bv,{isPanorama:!1},i))});function AU(){var e=en(),[n,i]=p.useState(null),s=Je(qz);return p.useEffect(()=>{if(n!=null){var a=n.getBoundingClientRect(),o=a.width/n.offsetWidth;un(o)&&o!==s&&e(kz(o))}},[n,e,s]),i}function wv(e,n){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);n&&(s=s.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),i.push.apply(i,s)}return i}function IU(e){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?wv(Object(i),!0).forEach(function(s){TU(e,s,i[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):wv(Object(i)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(i,s))})}return e}function TU(e,n,i){return(n=EU(n))in e?Object.defineProperty(e,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[n]=i,e}function EU(e){var n=PU(e,"string");return typeof n=="symbol"?n:n+""}function PU(e,n){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var s=i.call(e,n);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(n==="string"?String:Number)(e)}function Fs(){return Fs=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Fs.apply(null,arguments)}var OU=()=>(GL(),null);function hd(e){if(typeof e=="number")return e;if(typeof e=="string"){var n=parseFloat(e);if(!Number.isNaN(n))return n}return 0}var DU=p.forwardRef((e,n)=>{var i,s,a=p.useRef(null),[o,l]=p.useState({containerWidth:hd((i=e.style)===null||i===void 0?void 0:i.width),containerHeight:hd((s=e.style)===null||s===void 0?void 0:s.height)}),c=p.useCallback((u,f)=>{l(h=>{var m=Math.round(u),g=Math.round(f);return h.containerWidth===m&&h.containerHeight===g?h:{containerWidth:m,containerHeight:g}})},[]),d=p.useCallback(u=>{if(typeof n=="function"&&n(u),u!=null&&typeof ResizeObserver<"u"){var{width:f,height:h}=u.getBoundingClientRect();c(f,h);var m=b=>{var{width:j,height:y}=b[0].contentRect;c(j,y)},g=new ResizeObserver(m);g.observe(u),a.current=g}},[n,c]);return p.useEffect(()=>()=>{var u=a.current;u!=null&&u.disconnect()},[c]),p.createElement(p.Fragment,null,p.createElement(Vd,{width:o.containerWidth,height:o.containerHeight}),p.createElement("div",Fs({ref:d},e)))}),zU=p.forwardRef((e,n)=>{var{width:i,height:s}=e,[a,o]=p.useState({containerWidth:hd(i),containerHeight:hd(s)}),l=p.useCallback((d,u)=>{o(f=>{var h=Math.round(d),m=Math.round(u);return f.containerWidth===h&&f.containerHeight===m?f:{containerWidth:h,containerHeight:m}})},[]),c=p.useCallback(d=>{if(typeof n=="function"&&n(d),d!=null){var{width:u,height:f}=d.getBoundingClientRect();l(u,f)}},[n,l]);return p.createElement(p.Fragment,null,p.createElement(Vd,{width:a.containerWidth,height:a.containerHeight}),p.createElement("div",Fs({ref:c},e)))}),MU=p.forwardRef((e,n)=>{var{width:i,height:s}=e;return p.createElement(p.Fragment,null,p.createElement(Vd,{width:i,height:s}),p.createElement("div",Fs({ref:n},e)))}),RU=p.forwardRef((e,n)=>{var{width:i,height:s}=e;return Mi(i)||Mi(s)?p.createElement(zU,Fs({},e,{ref:n})):p.createElement(MU,Fs({},e,{ref:n}))});function $U(e){return e===!0?DU:RU}var LU=p.forwardRef((e,n)=>{var{children:i,className:s,height:a,onClick:o,onContextMenu:l,onDoubleClick:c,onMouseDown:d,onMouseEnter:u,onMouseLeave:f,onMouseMove:h,onMouseUp:m,onTouchEnd:g,onTouchMove:b,onTouchStart:j,style:y,width:x,responsive:v,dispatchTouchEvents:A=!0}=e,N=p.useRef(null),C=en(),[w,_]=p.useState(null),[I,O]=p.useState(null),E=AU(),S=rm(),k=(S==null?void 0:S.width)>0?S.width:x,D=(S==null?void 0:S.height)>0?S.height:a,T=p.useCallback(Z=>{E(Z),typeof n=="function"&&n(Z),_(Z),O(Z),Z!=null&&(N.current=Z)},[E,n,_,O]),P=p.useCallback(Z=>{C(yk(Z)),C(Nr({handler:o,reactEvent:Z}))},[C,o]),R=p.useCallback(Z=>{C(Mh(Z)),C(Nr({handler:u,reactEvent:Z}))},[C,u]),Y=p.useCallback(Z=>{C(JS()),C(Nr({handler:f,reactEvent:Z}))},[C,f]),X=p.useCallback(Z=>{C(Mh(Z)),C(Nr({handler:h,reactEvent:Z}))},[C,h]),H=p.useCallback(()=>{C(Sk())},[C]),q=p.useCallback(Z=>{C(wk(Z.key))},[C]),M=p.useCallback(Z=>{C(Nr({handler:l,reactEvent:Z}))},[C,l]),L=p.useCallback(Z=>{C(Nr({handler:c,reactEvent:Z}))},[C,c]),B=p.useCallback(Z=>{C(Nr({handler:d,reactEvent:Z}))},[C,d]),F=p.useCallback(Z=>{C(Nr({handler:m,reactEvent:Z}))},[C,m]),te=p.useCallback(Z=>{C(Nr({handler:j,reactEvent:Z}))},[C,j]),$=p.useCallback(Z=>{A&&C(Nk(Z)),C(Nr({handler:b,reactEvent:Z}))},[C,A,b]),W=p.useCallback(Z=>{C(Nr({handler:g,reactEvent:Z}))},[C,g]),U=$U(v);return p.createElement(b2.Provider,{value:w},p.createElement(G3.Provider,{value:I},p.createElement(U,{width:k??(y==null?void 0:y.width),height:D??(y==null?void 0:y.height),className:_t("recharts-wrapper",s),style:IU({position:"relative",cursor:"default",width:k,height:D},y),onClick:P,onContextMenu:M,onDoubleClick:L,onFocus:H,onKeyDown:q,onMouseDown:B,onMouseEnter:R,onMouseLeave:Y,onMouseMove:X,onMouseUp:F,onTouchEnd:W,onTouchMove:$,onTouchStart:te,ref:T},p.createElement(OU,null),i)))}),WU=["width","height","responsive","children","className","style","compact","title","desc"];function BU(e,n){if(e==null)return{};var i,s,a=FU(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function FU(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var Tk=p.forwardRef((e,n)=>{var{width:i,height:s,responsive:a,children:o,className:l,style:c,compact:d,title:u,desc:f}=e,h=BU(e,WU),m=yr(h);return d?p.createElement(p.Fragment,null,p.createElement(Vd,{width:i,height:s}),p.createElement(jv,{otherAttributes:m,title:u,desc:f},o)):p.createElement(LU,{className:l,style:c,width:i,height:s,responsive:a??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},p.createElement(jv,{otherAttributes:m,title:u,desc:f,ref:n},p.createElement(uF,null,o)))});function Rh(){return Rh=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},Rh.apply(null,arguments)}var qU={top:5,right:5,bottom:5,left:5},UU={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:qU,reverseStackOrder:!1,syncMethod:"index",responsive:!1},Ek=p.forwardRef(function(n,i){var s,a=Tn(n.categoricalChartProps,UU),{chartName:o,defaultTooltipEventType:l,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,categoricalChartProps:u}=n,f={chartName:o,defaultTooltipEventType:l,validateTooltipEventTypes:c,tooltipPayloadSearcher:d,eventEmitter:void 0};return p.createElement(Ck,{preloadedState:{options:f},reduxStoreName:(s=u.id)!==null&&s!==void 0?s:o},p.createElement(ak,{chartData:u.data}),p.createElement(Ak,{layout:a.layout,margin:a.margin}),p.createElement(Ik,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),p.createElement(Tk,Rh({},a,{ref:i})))}),HU=["axis"],Pk=p.forwardRef((e,n)=>p.createElement(Ek,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:HU,tooltipPayloadSearcher:Um,categoricalChartProps:e,ref:n})),YU=["axis","item"],Ok=p.forwardRef((e,n)=>p.createElement(Ek,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:YU,tooltipPayloadSearcher:Um,categoricalChartProps:e,ref:n}));function KU(e){var n=en();return p.useEffect(()=>{n(gU(e))},[n,e]),null}var GU=["layout"];function $h(){return $h=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var s in i)({}).hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},$h.apply(null,arguments)}function VU(e,n){if(e==null)return{};var i,s,a=XU(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)i=o[s],n.indexOf(i)===-1&&{}.propertyIsEnumerable.call(e,i)&&(a[i]=e[i])}return a}function XU(e,n){if(e==null)return{};var i={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(n.indexOf(s)!==-1)continue;i[s]=e[s]}return i}var QU={top:5,right:5,bottom:5,left:5},JU={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:QU,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},ZU=p.forwardRef(function(n,i){var s,a=Tn(n.categoricalChartProps,JU),{layout:o}=a,l=VU(a,GU),{chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:f}=n,h={chartName:c,defaultTooltipEventType:d,validateTooltipEventTypes:u,tooltipPayloadSearcher:f,eventEmitter:void 0};return p.createElement(Ck,{preloadedState:{options:h},reduxStoreName:(s=a.id)!==null&&s!==void 0?s:c},p.createElement(ak,{chartData:a.data}),p.createElement(Ak,{layout:o,margin:a.margin}),p.createElement(Ik,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),p.createElement(KU,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),p.createElement(Tk,$h({},l,{ref:i})))}),eH=["item"],tH={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},nH=p.forwardRef((e,n)=>{var i=Tn(e,tH);return p.createElement(ZU,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:eH,tooltipPayloadSearcher:Um,categoricalChartProps:i,ref:n})});function pf(e){e=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),e.setUTCDate(e.getUTCDate()+4-(e.getUTCDay()||7));var n=new Date(Date.UTC(e.getUTCFullYear(),0,1)),i=Math.ceil(((e.getTime()-n.getTime())/864e5+1)/7);return i}function Sv(e,n){const i=new Date(e,0,1+(n-1)*7),s=i.getDay(),a=i;s<=4?a.setDate(i.getDate()-i.getDay()+1):a.setDate(i.getDate()+8-i.getDay());const o=new Date(a),l=new Date(a);return l.setDate(l.getDate()+6),{start:o,end:l}}function rH(){const e=new Date,n=e.getFullYear(),i=e.getMonth()+1,s=pf(e),[a,o]=p.useState({year:n,month:i,week:s,activityType:"all"}),[l,c]=p.useState([]),[d,u]=p.useState([]),[f,h]=p.useState(!1);p.useEffect(()=>{async function S(){try{const k=await fetch(`/api/v1/dashboard/activity-analysis?year=${a.year}&activityType=${a.activityType.toUpperCase()}`);if(k.ok){const D=await k.json();c(Array.isArray(D)?D:[])}}catch(k){console.error(k)}}S()},[a.year,a.activityType]),p.useEffect(()=>{async function S(){h(!0);try{const{year:k,month:D,week:T}=a;if(T!=="all"){const{start:P,end:R}=Sv(k,T),Y=P.toISOString().split("T")[0],X=R.toISOString().split("T")[0],H=await fetch(`/api/v1/dashboard/daily-activity?from=${Y}&to=${X}&activityType=${a.activityType.toUpperCase()}`);H.ok&&u(await H.json())}else if(D!=="all"){const P=new Date(k,D-1,1),R=new Date(k,D,0),Y=P.toISOString().split("T")[0],X=R.toISOString().split("T")[0],H=await fetch(`/api/v1/dashboard/daily-activity?from=${Y}&to=${X}&activityType=${a.activityType.toUpperCase()}`);H.ok&&u(await H.json())}else u([])}catch(k){console.error(k)}finally{h(!1)}}S()},[a]);const m=()=>{o({year:g,month:j,week:x,activityType:A})},[g,b]=p.useState(n),[j,y]=p.useState(i),[x,v]=p.useState(s),[A,N]=p.useState("all");function C(S,k){const D=[],T=new Date(S,k-1,1),P=new Date(S,k,0);for(;T<=P;){const R=pf(T);(D.length===0||D[D.length-1]!==R)&&D.push(R),T.setDate(T.getDate()+1)}return D}const w=p.useMemo(()=>{const{year:S,month:k,week:D}=a,T=new Map;if(d.forEach(P=>{var R;T.has(P.empId)||T.set(P.empId,[]),(R=T.get(P.empId))==null||R.push(P)}),D!=="all"){const{start:P}=Sv(S,D),R=Array.from({length:7},(Y,X)=>{const H=new Date(P);return H.setDate(H.getDate()+X),{date:H.toISOString().split("T")[0],label:["일","월","화","수","목","금","토"][H.getDay()]}});return l.map(Y=>{const X=T.get(Y.empId)||[],H=X.reduce((L,B)=>L+B.planned,0),q=X.reduce((L,B)=>L+B.completed,0),M=R.map(L=>{const B=X.find(F=>F.date===L.date);return{label:L.label,value:(B==null?void 0:B.completed)||0,subValue:(B==null?void 0:B.planned)||0,tooltip:`${L.date}: ${(B==null?void 0:B.completed)||0}/${(B==null?void 0:B.planned)||0}`}});return{empId:Y.empId,empName:Y.empName,deptName:Y.deptName,planned:H,completed:q,chartData:M}})}else if(k!=="all"){const P=C(S,k);return l.map(R=>{const Y=T.get(R.empId)||[],X=Y.reduce((L,B)=>L+B.planned,0),H=Y.reduce((L,B)=>L+B.completed,0),q=new Map;Y.forEach(L=>{const B=pf(new Date(L.date));q.has(B)||q.set(B,{p:0,c:0});const F=q.get(B);F.p+=L.planned,F.c+=L.completed});const M=P.map(L=>{var B,F,te,$;return{label:`${L}주차`,value:((B=q.get(L))==null?void 0:B.c)||0,subValue:((F=q.get(L))==null?void 0:F.p)||0,tooltip:`${L}주차: ${((te=q.get(L))==null?void 0:te.c)||0}/${(($=q.get(L))==null?void 0:$.p)||0}`}});return{empId:R.empId,empName:R.empName,deptName:R.deptName,planned:X,completed:H,chartData:M}})}else return l.map(P=>({empId:P.empId,empName:P.empName,deptName:P.deptName,planned:P.months.reduce((R,Y)=>R+Y.planned,0),completed:P.months.reduce((R,Y)=>R+Y.completed,0),chartData:Array.from({length:12},(R,Y)=>Y+1).map(R=>{const Y=P.months.find(X=>X.month===R);return{label:`${R}월`,value:(Y==null?void 0:Y.completed)||0,subValue:(Y==null?void 0:Y.planned)||0,tooltip:`${R}월: ${(Y==null?void 0:Y.completed)||0}/${(Y==null?void 0:Y.planned)||0}`}})}))},[a,l,d]),_=w.reduce((S,k)=>S+k.planned,0),I=w.reduce((S,k)=>S+k.completed,0),O=_>0?Math.round(I/_*100):0,E=[...w].sort((S,k)=>k.completed-S.completed)[0];return p.useEffect(()=>{async function S(){try{const{year:k,month:D,week:T,activityType:P}=a;let R=`/api/v1/dashboard/activity-by-region?year=${k}&activityType=${P.toUpperCase()}`;D!=="all"&&(R+=`&month=${D}`),T!=="all"&&(R+=`&week=${T}`);const Y=await fetch(R);if(Y.ok){const X=await Y.json(),q={year:k,month:D,week:T,activityType:P==="all"?"전체":P==="sales"?"활동":"지역활동",totalPlanned:_,totalCompleted:I};window.dispatchEvent(new CustomEvent("tnt.sales.dashboard.activityRegion",{detail:{regionData:X,mapInfo:q}}))}}catch(k){console.error("Failed to load region activity data:",k)}}S()},[a,_,I]),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8,height:"calc(100vh - 120px)"},children:[r.jsxs("div",{className:"page-title",style:{marginBottom:0,padding:"8px 0",minHeight:"auto",height:"auto"},children:[r.jsx("h2",{style:{background:"linear-gradient(90deg, #2563eb, #9333ea)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",margin:0,fontSize:18},children:"영업 활동 분석"}),r.jsxs("div",{className:"controls",style:{display:"flex",gap:8,marginRight:380},children:[r.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex"},children:["all","sales","region"].map(S=>{const k=S==="all"?"전체":S==="sales"?"활동":"지역활동",D=A===S;return r.jsx("button",{onClick:()=>N(S),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:D?"#fff":"transparent",color:D?"#2563eb":"#6b7280",boxShadow:D?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:k},S)})}),r.jsx("select",{className:"subject-input",value:g,onChange:S=>{b(Number(S.target.value)),v("all")},style:{width:100,height:30},children:Array.from({length:5},(S,k)=>new Date().getFullYear()-2+k).map(S=>r.jsxs("option",{value:S,children:[S,"년"]},S))}),r.jsxs("select",{className:"subject-input",value:j,onChange:S=>{y(S.target.value==="all"?"all":Number(S.target.value)),v("all")},disabled:x!=="all",style:{width:100,opacity:x!=="all"?.5:1,height:30},children:[r.jsx("option",{value:"all",children:"전체 월"}),Array.from({length:12},(S,k)=>k+1).map(S=>r.jsxs("option",{value:S,children:[S,"월"]},S))]}),r.jsxs("select",{className:"subject-input",value:x,onChange:S=>{v(S.target.value==="all"?"all":Number(S.target.value))},style:{width:100,height:30},children:[r.jsx("option",{value:"all",children:"전체 주"}),j!=="all"?C(g,j).map(S=>r.jsxs("option",{value:S,children:[S,"주차"]},S)):Array.from({length:53},(S,k)=>k+1).map(S=>r.jsxs("option",{value:S,children:[S,"주차"]},S))]}),r.jsx("button",{onClick:m,disabled:f,style:{height:30,padding:"0 12px",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:4,color:"var(--text)",fontSize:12,cursor:"pointer",display:"flex",alignItems:"center",gap:4},children:f?"조회중...":"조회"})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:8},children:[r.jsx(Ul,{title:"총 계획",value:_.toLocaleString(),icon:"📅",color:"#64748b"}),r.jsx(Ul,{title:"총 완료",value:I.toLocaleString(),icon:"✅",color:"#2563eb"}),r.jsx(Ul,{title:"달성률",value:`${O}%`,icon:"📈",color:O>=80?"#10b981":"#f59e0b"}),r.jsx(Ul,{title:"최우수 사원",value:E?E.empName:"-",icon:"🏆",color:"#8b5cf6",sub:E==null?void 0:E.deptName})]}),f&&w.length===0?r.jsx("div",{className:"card",style:{padding:24,textAlign:"center",color:"#666"},children:"데이터 분석 중..."}):r.jsxs("div",{style:{flex:1,overflowY:"auto",minHeight:0,paddingRight:4},children:[r.jsxs("div",{className:"card",style:{padding:16,marginBottom:8},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsxs("h3",{style:{fontSize:14,fontWeight:600,margin:0},children:["월별 활동 히트맵 (",a.year,"년)"]}),r.jsx("div",{style:{fontSize:11,color:"#64748b"},children:"* 수치는 '계획/완료' 건수입니다 | 히트맵은 항상 연간 데이터를 표시합니다"})]}),r.jsx(iH,{data:l})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(300px, 1fr))",gap:8},children:w.map(S=>r.jsx(sH,{empName:S.empName,deptName:S.deptName,planned:S.planned,completed:S.completed,chartData:S.chartData},S.empId))})]})]})}function Ul({title:e,value:n,icon:i,color:s,sub:a}){return r.jsxs("div",{className:"card",style:{padding:16,display:"flex",alignItems:"center",gap:16,borderLeft:`4px solid ${s}`},children:[r.jsx("div",{style:{fontSize:24,background:`${s}20`,width:48,height:48,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center"},children:i}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:12,color:"#64748b",fontWeight:500},children:e}),r.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#1e293b"},children:n}),a&&r.jsx("div",{style:{fontSize:11,color:"#94a3b8"},children:a})]})]})}function iH({data:e}){const n=Array.from({length:12},(a,o)=>o+1);let i=0;e.forEach(a=>{a.months.forEach(o=>{o.completed>i&&(i=o.completed)})});const s=a=>a===0?"#f1f5f9":`rgba(37, 99, 235, ${.1+Math.min(1,a/Math.max(1,i))*.9})`;return r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:8,color:"#64748b"},children:"Employee"}),n.map(a=>r.jsxs("th",{style:{padding:8,color:"#64748b"},children:[a,"월"]},a)),r.jsx("th",{style:{padding:8,color:"#64748b"},children:"Total"})]})}),r.jsx("tbody",{children:e.map(a=>{const o=a.months.reduce((l,c)=>l+c.completed,0);return r.jsxs("tr",{style:{borderTop:"1px solid #e2e8f0"},children:[r.jsxs("td",{style:{padding:"8px 12px",fontWeight:500},children:[a.empName," ",r.jsx("span",{style:{fontSize:10,color:"#94a3b8",marginLeft:4},children:a.deptName})]}),n.map(l=>{const c=a.months.find(f=>f.month===l),d=(c==null?void 0:c.completed)||0,u=(c==null?void 0:c.planned)||0;return r.jsx("td",{style:{padding:4,textAlign:"center"},children:r.jsxs("div",{style:{background:s(d),color:d>i/2?"#fff":"#1e293b",borderRadius:4,padding:"4px 0",fontSize:10,fontWeight:600,whiteSpace:"nowrap"},children:[u,"/",d]})},l)}),r.jsx("td",{style:{padding:8,textAlign:"center",fontWeight:700},children:o})]},a.empId)})})]})})}function sH({empName:e,deptName:n,planned:i,completed:s,chartData:a}){const o=i>0?Math.round(s/i*100):0,l=Math.max(...a.map(c=>Math.max(c.value,c.subValue||0)),1);return r.jsxs("div",{className:"card",style:{padding:16,display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start"},children:[r.jsxs("div",{children:[r.jsx("div",{style:{fontWeight:700,fontSize:15},children:e}),r.jsx("div",{style:{fontSize:11,color:"#64748b"},children:n})]}),r.jsxs("div",{style:{background:o>=90?"#dcfce7":o>=70?"#fef9c3":"#fee2e2",color:o>=90?"#166534":o>=70?"#854d0e":"#991b1b",padding:"2px 8px",borderRadius:12,fontSize:11,fontWeight:700},children:[o,"%"]})]}),r.jsxs("div",{style:{display:"flex",gap:8,fontSize:12},children:[r.jsxs("div",{style:{flex:1,background:"#f8fafc",padding:8,borderRadius:6,textAlign:"center"},children:[r.jsx("div",{style:{color:"#64748b",fontSize:10},children:"Planned"}),r.jsx("div",{style:{fontWeight:600},children:i})]}),r.jsxs("div",{style:{flex:1,background:"#eff6ff",padding:8,borderRadius:6,textAlign:"center"},children:[r.jsx("div",{style:{color:"#3b82f6",fontSize:10},children:"Completed"}),r.jsx("div",{style:{fontWeight:600,color:"#2563eb"},children:s})]})]}),r.jsx("div",{style:{height:100,display:"flex",alignItems:"flex-end",gap:4,paddingTop:16,borderTop:"1px solid #f1f5f9"},children:a.map((c,d)=>{const u=Math.min(100,c.value/l*100);return r.jsxs("div",{style:{flex:1,height:"100%",display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"center"},title:c.tooltip,children:[r.jsxs("div",{style:{width:"100%",background:"#f1f5f9",height:"100%",maxHeight:80,borderRadius:4,position:"relative",overflow:"hidden"},children:[r.jsx("div",{style:{position:"absolute",bottom:0,left:0,right:0,background:c.value>0?"#3b82f6":"transparent",height:`${u}%`,transition:"height 0.3s ease"}}),r.jsxs("div",{style:{position:"absolute",bottom:4,left:0,right:0,display:"flex",justifyContent:"center",fontSize:10,fontWeight:700,lineHeight:1,color:u>15?"#fff":"#1e293b",textShadow:u>15?"0 1px 2px rgba(0,0,0,0.3)":"none",zIndex:1},children:[c.subValue,"/",c.value]})]}),r.jsx("div",{style:{fontSize:9,color:"#94a3b8",marginTop:4,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},children:c.label})]},d)})})]})}function aH({companyType:e}){const[n,i]=p.useState([]),[s,a]=p.useState(!1),[o,l]=p.useState("ALL"),[c,d]=p.useState(null),[u,f]=p.useState(null),h=p.useRef(null),[m,g]=p.useState(null);p.useEffect(()=>{(async()=>{a(!0);try{const I=await fetch(`/api/v1/dashboard/arrears?companyType=${e}`);if(I.ok){const O=await I.json();i(O)}}catch(I){console.error(I)}finally{a(!1)}})()},[e]);const b=p.useMemo(()=>{const _=R=>(R.m1||0)+(R.m2||0)+(R.m3||0),I=R=>(R.m4||0)+(R.m5||0)+(R.m6||0),O=R=>(R.m7||0)+(R.m8||0)+(R.m9||0)+(R.m10||0)+(R.m11||0)+(R.m12||0),E=R=>R.over12||0;let S=0,k=0,D=0,T=0,P=0;return n.forEach(R=>{S+=R.totalAr||0;const Y=_(R)>0,X=I(R)+O(R)+E(R)>0;Y&&!X&&(k+=_(R));const H=I(R)>0,q=_(R)>0,M=O(R)+E(R)>0;H&&!q&&!M&&(D+=I(R));const L=O(R)>0,B=_(R)+I(R)>0,F=E(R)>0;L&&!B&&!F&&(T+=O(R));const te=E(R)>0,$=_(R)+I(R)+O(R)>0;te&&!$&&(P+=E(R))}),{total:S,overdue1_3m:k,overdue3_6m:D,overdue6_12m:T,overdue12m:P}},[n]),j=p.useMemo(()=>{let _=[...n];const I=k=>(k.m1||0)+(k.m2||0)+(k.m3||0),O=k=>(k.m4||0)+(k.m5||0)+(k.m6||0),E=k=>(k.m7||0)+(k.m8||0)+(k.m9||0)+(k.m10||0)+(k.m11||0)+(k.m12||0),S=k=>k.over12||0;return o==="OVERDUE_1_3M"?_=_.filter(k=>{const D=I(k)>0,T=O(k)+E(k)+S(k)>0;return D&&!T}).sort((k,D)=>I(D)-I(k)):o==="OVERDUE_3_6M"?_=_.filter(k=>{const D=O(k)>0,T=I(k)>0,P=E(k)+S(k)>0;return D&&!T&&!P}).sort((k,D)=>O(D)-O(k)):o==="OVERDUE_6_12M"?_=_.filter(k=>{const D=E(k)>0,T=I(k)+O(k)>0,P=S(k)>0;return D&&!T&&!P}).sort((k,D)=>E(D)-E(k)):o==="OVERDUE_12M"?_=_.filter(k=>{const D=S(k)>0,T=I(k)+O(k)+E(k)>0;return D&&!T}).sort((k,D)=>S(D)-S(k)):_=_.sort((k,D)=>D.totalAr-k.totalAr),_},[n,o]),y=p.useMemo(()=>[{name:"1개월",key:"m1",color:"#3b82f6"},{name:"2개월",key:"m2",color:"#3b82f6"},{name:"3개월",key:"m3",color:"#3b82f6"},{name:"4~6개월",keys:["m4","m5","m6"],color:"#f59e0b"},{name:"7~12개월",keys:["m7","m8","m9","m10","m11","m12"],color:"#ea580c"},{name:"12개월+",key:"over12",color:"#ef4444"}].map(I=>{let O=0;const E=[];return I.key?n.forEach(S=>{const k=S[I.key]||0;O+=k,k>0&&E.push({name:S.customerName,totalAr:S.totalAr,agingValue:k,dept:S.deptName,emp:S.empName,original:S})}):I.keys&&n.forEach(S=>{var D;let k=0;(D=I.keys)==null||D.forEach(T=>k+=S[T]||0),O+=k,k>0&&E.push({name:S.customerName,totalAr:S.totalAr,agingValue:k,dept:S.deptName,emp:S.empName,original:S})}),E.sort((S,k)=>k.agingValue-S.agingValue),{name:I.name,value:O,color:I.color,customers:E}}),[n]),x=p.useMemo(()=>n.map(_=>{const I=(_.m4||0)+(_.m5||0)+(_.m6||0)+(_.m7||0)+(_.m8||0)+(_.m9||0)+(_.m10||0)+(_.m11||0)+(_.over12||0),O=_.totalAr>0?I/_.totalAr*100:0;return{name:_.customerName,totalAr:_.totalAr,longTermAr:I,ratio:Math.round(O*10)/10,dept:_.deptName,emp:_.empName,original:_}}).filter(_=>_.totalAr>0),[n]),v=p.useMemo(()=>{if(x.length===0)return{maxX:1e8,xTicks:[],yTicks:[]};const _=Math.max(...x.map(S=>S.totalAr)),I=_/5,O=[0,I,I*2,I*3,I*4,I*5];return{maxX:_,xTicks:O,yTicks:[0,20,40,60,80,100]}},[x]);p.useEffect(()=>{if(!h.current)return;const _=new ResizeObserver(I=>{for(const O of I)g({width:O.contentRect.width,height:O.contentRect.height})});return _.observe(h.current),()=>_.disconnect()},[]);const A=p.useMemo(()=>{const{maxX:_}=v,I=_/5,O=[];for(let E=0;E<5;E++)for(let S=0;S<5;S++){const k=E*I,D=(E+1)*I,T=S*20,P=(S+1)*20,R=E===4,Y=S===4,X=x.filter(H=>H.totalAr>=k&&(R?H.totalAr<=D:H.totalAr<D)&&H.ratio>=T&&(Y?H.ratio<=P:H.ratio<P));O.push({xIdx:E,yIdx:S,xMin:k,xMax:D,yMin:T,yMax:P,customers:X})}return O},[x,v]),N=p.useCallback((_,I)=>{const O=A.find(P=>P.xIdx===_&&P.yIdx===I);if(!O)return;const{xMin:E,xMax:S,yMin:k,yMax:D,customers:T}=O;d({xMin:E,xMax:S,yMin:k,yMax:D}),f(null),window.dispatchEvent(new CustomEvent("tnt.sales.dashboard.arrearsCell",{detail:{customers:T.sort((P,R)=>R.totalAr-P.totalAr).map(P=>({...P,cellInfo:{xMin:E,xMax:S,yMin:k,yMax:D}})),cellInfo:{xMin:E,xMax:S,yMin:k,yMax:D}}}))},[A]),C=p.useCallback((_,I,O)=>{f(_),d(null),window.dispatchEvent(new CustomEvent("tnt.sales.dashboard.agingBar",{detail:{name:_,customers:I,totalValue:O}}))},[]),w=_=>new Intl.NumberFormat("ko-KR",{minimumFractionDigits:2,maximumFractionDigits:2}).format(_/1e6);return s?r.jsx("div",{style:{padding:20},children:"로딩중..."}):r.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",gap:12},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:12},children:[r.jsx(io,{label:"총 미수채권",value:w(b.total),unit:"백만원",color:"#0f172a",active:o==="ALL",onClick:()=>l("ALL")}),r.jsx(io,{label:"1~3개월",value:w(b.overdue1_3m),unit:"백만원",color:"#3b82f6",active:o==="OVERDUE_1_3M",onClick:()=>l("OVERDUE_1_3M")}),r.jsx(io,{label:"3~6개월",value:w(b.overdue3_6m),unit:"백만원",color:"#f59e0b",active:o==="OVERDUE_3_6M",onClick:()=>l("OVERDUE_3_6M")}),r.jsx(io,{label:"6~12개월",value:w(b.overdue6_12m),unit:"백만원",color:"#ea580c",active:o==="OVERDUE_6_12M",onClick:()=>l("OVERDUE_6_12M")}),r.jsx(io,{label:"1년 초과",value:w(b.overdue12m),unit:"백만원",color:"#dc2626",active:o==="OVERDUE_12M",onClick:()=>l("OVERDUE_12M")})]}),r.jsx("div",{style:{fontSize:11,color:"#9ca3af",textAlign:"right",marginTop:-4},children:"* 총 미수채권 금액과 각 카드의 합계는 다를 수 있습니다. (각 카드는 해당 기간에만 연체가 있는 거래처 기준)"}),r.jsxs("div",{style:{display:"flex",gap:12,height:320},children:[r.jsxs("div",{className:"card",style:{flex:1,padding:12,display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h3",{style:{fontSize:14,fontWeight:600},children:"미수채권 연령 분포"}),r.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"바 클릭 시 거래처 표시"})]}),r.jsx("div",{style:{flex:1,minHeight:0},children:r.jsx(oH,{data:y,selectedBar:u,onBarClick:C})}),r.jsx("div",{style:{textAlign:"right",fontSize:10,color:"#6b7280"},children:"(단위: 억원)"})]}),r.jsxs("div",{className:"card",style:{flex:1,padding:12,display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsx("h3",{style:{fontSize:14,fontWeight:600},children:"부실 위험도 분석 (Risk Map)"}),r.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"격자 클릭 시 해당 영역 거래처 표시"})]}),r.jsx("div",{ref:h,style:{flex:1,minHeight:0,position:"relative"},children:r.jsx(lH,{data:x,gridCellData:A,bounds:v,selectedCell:c,onCellClick:N,fmt:w})}),c&&r.jsxs("div",{style:{fontSize:10,color:"#6b7280",marginTop:4,textAlign:"center"},children:["선택 영역: 채권 ",w(c.xMin),"~",w(c.xMax),"백만, 연체율 ",c.yMin,"~",c.yMax,"%"]})]})]}),r.jsxs("div",{className:"card",style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{fontSize:14,fontWeight:600},children:["거래처별 미수 현황 상세",o!=="ALL"&&r.jsxs("span",{style:{color:"#ef4444",marginLeft:8},children:["(",o==="OVERDUE_1_3M"?"1~3개월":o==="OVERDUE_3_6M"?"3~6개월":o==="OVERDUE_6_12M"?"6~12개월":"1년 초과"," 기준 정렬)"]})]}),r.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["총 ",j.length,"개 업체"]})]}),r.jsx("div",{style:{flex:1,overflow:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f8fafc",zIndex:1},children:r.jsxs("tr",{children:[r.jsx("th",{style:Lh,children:"거래처명"}),r.jsx("th",{style:Lh,children:"부서/담당자"}),r.jsx("th",{style:gs,children:"총 미수액"}),r.jsx("th",{style:gs,children:"1개월"}),r.jsx("th",{style:gs,children:"2개월"}),r.jsx("th",{style:gs,children:"3개월"}),r.jsx("th",{style:gs,children:"4~6개월"}),r.jsx("th",{style:gs,children:"7~12개월"}),r.jsx("th",{style:gs,children:"12개월+"})]})}),r.jsx("tbody",{children:j.map((_,I)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f1f5f9"},children:[r.jsx("td",{style:Wh,children:_.customerName}),r.jsxs("td",{style:Wh,children:[_.deptName," / ",_.empName]}),r.jsx("td",{style:{...ys,fontWeight:600},children:w(_.totalAr)}),r.jsx("td",{style:ys,children:w(_.m1)}),r.jsx("td",{style:ys,children:w(_.m2)}),r.jsx("td",{style:ys,children:w(_.m3)}),r.jsx("td",{style:{...ys,color:_.m4+_.m5+_.m6>0?"#ea580c":"inherit"},children:w(_.m4+_.m5+_.m6)}),r.jsx("td",{style:{...ys,color:_.m7+_.m8+_.m9+_.m10+_.m11+_.m12>0?"#dc2626":"inherit"},children:w(_.m7+_.m8+_.m9+_.m10+_.m11+_.m12)}),r.jsx("td",{style:{...ys,color:_.over12>0?"#991b1b":"inherit",fontWeight:_.over12>0?600:400},children:w(_.over12)})]},I))})]})})]})]})}function oH({data:e,selectedBar:n,onBarClick:i}){const s=p.useRef(null),[a,o]=p.useState({width:0,height:0}),[l,c]=p.useState(null),[d,u]=p.useState(null);p.useEffect(()=>{if(!s.current)return;const N=new ResizeObserver(C=>{for(const w of C)o({width:w.contentRect.width,height:w.contentRect.height})});return N.observe(s.current),()=>N.disconnect()},[]);const f={top:15,right:15,bottom:45,left:55},h=Math.max(0,a.width-f.left-f.right),m=Math.max(0,a.height-f.top-f.bottom),g=Math.max(...e.map(N=>N.value),1),b=e.length,j=.2,y=h/b,x=y*(1-j),v=N=>new Intl.NumberFormat("ko-KR").format(Math.round(N/1e6)),A=N=>(N/1e8).toFixed(0);return a.width===0||a.height===0?r.jsx("div",{ref:s,style:{width:"100%",height:"100%"}}):r.jsxs("div",{ref:s,style:{width:"100%",height:"100%",position:"relative"},children:[r.jsx("svg",{width:a.width,height:a.height,children:r.jsxs("g",{transform:`translate(${f.left}, ${f.top})`,children:[[0,.25,.5,.75,1].map(N=>{const C=m*(1-N);return r.jsx("line",{x1:0,y1:C,x2:h,y2:C,stroke:"#e5e7eb",strokeDasharray:"3 3"},`grid-${N}`)}),e.map((N,C)=>{const w=C*y+(y-x)/2,_=N.value/g*m,I=m-_,O=n===N.name,E=l===N.name;return r.jsxs("g",{children:[r.jsx("rect",{x:w,y:I,width:x,height:_,fill:N.color,fillOpacity:O?1:E?.85:.75,stroke:O?"#1e40af":"none",strokeWidth:O?2:0,rx:4,ry:4,style:{cursor:"pointer",transition:"all 0.15s ease"},onClick:()=>i(N.name,N.customers,N.value),onMouseEnter:S=>{var D;c(N.name);const k=(D=s.current)==null?void 0:D.getBoundingClientRect();k&&u({x:S.clientX-k.left,y:S.clientY-k.top,name:N.name,value:N.value})},onMouseMove:S=>{var D;const k=(D=s.current)==null?void 0:D.getBoundingClientRect();k&&u({x:S.clientX-k.left,y:S.clientY-k.top,name:N.name,value:N.value})},onMouseLeave:()=>{c(null),u(null)}}),_>20&&r.jsx("text",{x:w+x/2,y:I-5,fill:"#475569",fontSize:10,textAnchor:"middle",style:{pointerEvents:"none"},children:v(N.value)})]},N.name)}),r.jsx("line",{x1:0,y1:m,x2:h,y2:m,stroke:"#94a3b8"}),e.map((N,C)=>{const w=C*y+y/2;return r.jsx("text",{x:w,y:m+18,fill:"#475569",fontSize:11,textAnchor:"middle",children:N.name},`x-label-${N.name}`)}),r.jsx("line",{x1:0,y1:0,x2:0,y2:m,stroke:"#94a3b8"}),[0,.25,.5,.75,1].map(N=>{const C=g*N,w=m*(1-N);return r.jsxs("g",{children:[r.jsx("line",{x1:-5,y1:w,x2:0,y2:w,stroke:"#94a3b8"}),r.jsx("text",{x:-10,y:w+4,fill:"#64748b",fontSize:10,textAnchor:"end",children:A(C)})]},`y-tick-${N}`)})]})}),d&&r.jsxs("div",{style:{position:"absolute",left:Math.min(d.x+10,a.width-120),top:Math.max(d.y-60,10),background:"#fff",padding:"8px 12px",border:"1px solid #e5e7eb",borderRadius:6,fontSize:11,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",pointerEvents:"none",zIndex:1e3},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:4,color:"#1e293b"},children:d.name}),r.jsxs("div",{style:{color:"#475569"},children:["금액: ",r.jsx("span",{style:{fontWeight:600},children:v(d.value)})," 백만원"]}),r.jsx("div",{style:{fontSize:10,color:"#94a3b8",marginTop:4},children:"클릭하여 상세 보기"})]})]})}function lH({data:e,gridCellData:n,bounds:i,selectedCell:s,onCellClick:a,fmt:o}){const l=p.useRef(null),[c,d]=p.useState({width:0,height:0}),[u,f]=p.useState(null),[h,m]=p.useState(null);p.useEffect(()=>{if(!l.current)return;const w=new ResizeObserver(_=>{for(const I of _)d({width:I.contentRect.width,height:I.contentRect.height})});return w.observe(l.current),()=>w.disconnect()},[]);const g={top:15,right:20,bottom:35,left:55},b=Math.max(0,c.width-g.left-g.right),j=Math.max(0,c.height-g.top-g.bottom),y=p.useCallback(w=>i.maxX===0?0:w/i.maxX*b,[i.maxX,b]),x=p.useCallback(w=>j-w/100*j,[j]),v=b/5,A=j/5,N=p.useCallback(w=>{const _=Math.max(...e.map(E=>E.longTermAr),1),I=4;return I+w/_*(16-I)},[e]),C=p.useCallback(w=>w>50?"#ef4444":w>20?"#f59e0b":"#3b82f6",[]);return c.width===0||c.height===0?r.jsx("div",{ref:l,style:{width:"100%",height:"100%"}}):r.jsxs("div",{ref:l,style:{width:"100%",height:"100%",position:"relative"},children:[r.jsx("svg",{width:c.width,height:c.height,children:r.jsxs("g",{transform:`translate(${g.left}, ${g.top})`,children:[[0,1,2,3,4].map(w=>[0,1,2,3,4].map(_=>{const I=n.find(D=>D.xIdx===_&&D.yIdx===w),O=s&&s.xMin===(I==null?void 0:I.xMin)&&s.yMin===(I==null?void 0:I.yMin),E=(u==null?void 0:u.xIdx)===_&&(u==null?void 0:u.yIdx)===w,S=_*v,k=(4-w)*A;return r.jsx("rect",{x:S,y:k,width:v,height:A,fill:O?"rgba(59, 130, 246, 0.15)":E?"rgba(59, 130, 246, 0.08)":"transparent",stroke:O?"rgba(59, 130, 246, 0.5)":E?"rgba(59, 130, 246, 0.3)":"#e5e7eb",strokeWidth:O?2:1,style:{cursor:"pointer"},onClick:()=>a(_,w),onMouseEnter:()=>f({xIdx:_,yIdx:w}),onMouseLeave:()=>f(null)},`cell-${_}-${w}`)})),[1,2,3,4].map(w=>r.jsxs(Be.Fragment,{children:[r.jsx("line",{x1:w*v,y1:0,x2:w*v,y2:j,stroke:"#e5e7eb",strokeDasharray:"3 3"}),r.jsx("line",{x1:0,y1:w*A,x2:b,y2:w*A,stroke:"#e5e7eb",strokeDasharray:"3 3"})]},`grid-${w}`)),r.jsx("line",{x1:0,y1:x(50),x2:b,y2:x(50),stroke:"#ef4444",strokeWidth:1.5,strokeDasharray:"5 3"}),r.jsx("text",{x:b-5,y:x(50)-5,fill:"#ef4444",fontSize:10,textAnchor:"end",children:"위험 (50%)"}),e.map((w,_)=>{const I=y(w.totalAr),O=x(w.ratio),E=N(w.longTermAr),S=C(w.ratio);return r.jsx("circle",{cx:I,cy:O,r:E,fill:S,fillOpacity:.7,stroke:S,strokeWidth:1,style:{cursor:"pointer"},onMouseEnter:k=>{var T;const D=(T=l.current)==null?void 0:T.getBoundingClientRect();D&&m({x:k.clientX-D.left,y:k.clientY-D.top,data:w})},onMouseLeave:()=>m(null)},`point-${_}`)}),r.jsx("line",{x1:0,y1:j,x2:b,y2:j,stroke:"#94a3b8"}),[0,1,2,3,4,5].map(w=>{const _=i.maxX/5*w,I=y(_);return r.jsxs("g",{children:[r.jsx("line",{x1:I,y1:j,x2:I,y2:j+5,stroke:"#94a3b8"}),r.jsx("text",{x:I,y:j+16,fill:"#64748b",fontSize:10,textAnchor:"middle",children:(_/1e6).toFixed(0)})]},`x-tick-${w}`)}),r.jsx("text",{x:b/2,y:j+30,fill:"#475569",fontSize:11,textAnchor:"middle",children:"총채권액 (백만)"}),r.jsx("line",{x1:0,y1:0,x2:0,y2:j,stroke:"#94a3b8"}),[0,20,40,60,80,100].map(w=>{const _=x(w);return r.jsxs("g",{children:[r.jsx("line",{x1:-5,y1:_,x2:0,y2:_,stroke:"#94a3b8"}),r.jsx("text",{x:-10,y:_+4,fill:"#64748b",fontSize:10,textAnchor:"end",children:w})]},`y-tick-${w}`)}),r.jsx("text",{transform:`rotate(-90) translate(${-j/2}, -40)`,fill:"#475569",fontSize:11,textAnchor:"middle",children:"장기연체율 (%)"})]})}),h&&r.jsxs("div",{style:{position:"absolute",left:h.x+10,top:h.y-10,background:"#fff",padding:"8px 12px",border:"1px solid #ccc",borderRadius:4,fontSize:12,boxShadow:"0 2px 8px rgba(0,0,0,0.15)",pointerEvents:"none",zIndex:1e3},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:4},children:h.data.name}),r.jsxs("div",{children:["총채권: ",o(h.data.totalAr)," 백만"]}),r.jsxs("div",{children:["장기연체: ",o(h.data.longTermAr)," 백만"]}),r.jsxs("div",{style:{color:h.data.ratio>50?"#dc2626":"#0f172a"},children:["비중: ",h.data.ratio,"%"]}),r.jsxs("div",{style:{marginTop:4,color:"#6b7280"},children:[h.data.dept," / ",h.data.emp]})]}),u&&r.jsx("div",{style:{position:"absolute",bottom:5,left:5,background:"rgba(255,255,255,0.95)",padding:"4px 8px",borderRadius:4,fontSize:10,color:"#475569",border:"1px solid #e5e7eb"},children:(()=>{const w=n.find(_=>_.xIdx===u.xIdx&&_.yIdx===u.yIdx);return w?`채권: ${o(w.xMin)}~${o(w.xMax)}백만 / 연체율: ${w.yMin}~${w.yMax}% / 거래처: ${w.customers.length}개`:null})()})]})}function io({label:e,value:n,unit:i,color:s,active:a,onClick:o}){return r.jsxs("div",{className:"card",onClick:o,style:{padding:16,cursor:o?"pointer":"default",border:a?`2px solid ${s}`:"1px solid transparent",background:a?`${s}08`:"#fff",transition:"all 0.2s"},children:[r.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:e}),r.jsx("div",{style:{fontSize:20,fontWeight:700,color:s},children:n}),r.jsx("div",{style:{fontSize:11,color:"#9ca3af"},children:i})]})}const Lh={padding:"8px 12px",textAlign:"left",fontWeight:600,color:"#475569",borderBottom:"1px solid #e2e8f0"},gs={...Lh,textAlign:"right"},Wh={padding:"8px 12px",color:"#334155"},ys={...Wh,textAlign:"right"};function cH(){const[e,n]=p.useState(()=>{const P=new Date;return P.setMinutes(P.getMinutes()-P.getTimezoneOffset()),P.toISOString().slice(0,10)}),[i,s]=p.useState("ALL"),[a,o]=p.useState(null),[l,c]=p.useState(new Array(12).fill(0)),[d,u]=p.useState(new Array(12).fill(0)),[f,h]=p.useState([]),[m,g]=p.useState([]),[b,j]=p.useState(!1),[y,x]=p.useState(null),[v,A]=p.useState("compare"),N=P=>{A(P);try{window.dispatchEvent(new CustomEvent("tnt.sales.dashboard.tabChange",{detail:{tab:P}}))}catch{}};async function C(P){j(!0),x(null);try{const R=i!=="ALL"?`&companyType=${encodeURIComponent(i)}`:"",Y=await fetch(`/api/v1/dashboard/sales-summary?date=${encodeURIComponent(P)}${R}`),X=await Y.json().catch(()=>({}));if(!Y.ok||X&&X.error)throw new Error(X.error||`HTTP ${Y.status} `);o(X);const H=new Date(P),q=H.getFullYear(),M=q-1,L=P,[B,F]=await Promise.all([fetch(`/api/v1/dashboard/monthly?year=${M}${R}`),fetch(`/api/v1/dashboard/monthly?year=${q}&until=${encodeURIComponent(L)}${R}`)]),te=await B.json().catch(()=>[]),$=await F.json().catch(()=>[]),W=G=>{const ae=new Array(12).fill(0);return Array.isArray(G)&&G.forEach(ie=>{const J=Number(ie==null?void 0:ie.month),re=Number((ie==null?void 0:ie.amount)||0);J>=1&&J<=12&&(ae[J-1]=re)}),ae};c(W(te)),u(W($));const U=H.getMonth()+1,[Z,ee]=await Promise.all([fetch(`/api/v1/dashboard/daily?year=${M}&month=${U}${R}`),fetch(`/api/v1/dashboard/daily?year=${q}&month=${U}&until=${encodeURIComponent(L)}${R}`)]),K=await Z.json().catch(()=>[]),ne=await ee.json().catch(()=>[]),pe=(G,ae,ie)=>{let J=31;try{J=new Date(ae,ie,0).getDate()}catch{}const re=new Array(J).fill(0);return Array.isArray(G)&&G.forEach(de=>{const he=Number(de==null?void 0:de.day),oe=Number((de==null?void 0:de.amount)||0);he>=1&&he<=J&&(re[he-1]=oe)}),re};h(pe(K,M,U)),g(pe(ne,q,U))}catch(R){x((R==null?void 0:R.message)||"조회 중 오류가 발생했습니다"),o(null)}finally{j(!1)}}p.useEffect(()=>{C(e)},[i]);const w=P=>{if(P==null)return"-";try{return new Intl.NumberFormat("ko-KR").format(P)}catch{return String(P)}},_=new Date(e),I=_.getFullYear(),O=_.getMonth()+1,E=_.getDate(),S=P=>String(P).padStart(2,"0"),k=I-1,D=new Date(k,O,0).getDate(),T=Math.min(E,D);return r.jsxs("section",{style:{display:"flex",flexDirection:"column",fontSize:12,height:"100%"},children:[r.jsxs("div",{className:"tabs",style:{display:"flex",gap:8,padding:"6px 8px",marginBottom:8},children:[r.jsx("button",{className:v==="compare"?"tab active":"tab",onClick:()=>N("compare"),children:"전년동기 매출비교"}),r.jsx("button",{className:v==="sales-status"?"tab active":"tab",onClick:()=>N("sales-status"),children:"매출현황분석"}),r.jsx("button",{className:v==="activity-ag"?"tab active":"tab",onClick:()=>N("activity-ag"),children:"활동분석"}),r.jsx("button",{className:v==="arrears"?"tab active":"tab",onClick:()=>N("arrears"),children:"미수 분석"})]}),v==="compare"?r.jsxs("div",{style:{flex:1,overflowY:"auto",paddingBottom:12},children:[r.jsxs("div",{className:"page-title",children:[r.jsx("h2",{children:"전년동기 매출비교"}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex"},children:["ALL","TNT","DYS"].map(P=>r.jsx("button",{onClick:()=>s(P),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:i===P?"#fff":"transparent",color:i===P?"#2563eb":"#6b7280",boxShadow:i===P?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:P},P))}),r.jsx("input",{type:"date",className:"subject-input",value:e,onChange:P=>{n(P.target.value),C(P.target.value)}})]})]}),y&&r.jsx("div",{className:"error",style:{marginBottom:8},children:y}),r.jsx("div",{className:"card",style:{padding:12},children:b?r.jsx("div",{className:"empty-state",children:"불러오는 중…"}):a?r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:12},children:[r.jsx(na,{label:`${k} 전체`,value:w(a.prevYearTotal)}),r.jsx(na,{label:`${k}-01-01 ~${k} -${S(O)} -${S(E)} `,value:w(a.prevYearToDate)}),r.jsx(na,{label:`${I}-01-01 ~${I} -${S(O)} -${S(E)} `,value:w(a.currentYearToDate)}),r.jsx(na,{label:`${k} -${S(O)} 전체`,value:w(a.prevYearMonthTotal)}),r.jsx(na,{label:`${k} -${S(O)}-01 ~${k} -${S(O)} -${S(T)} `,value:w(a.prevYearMonthToDate)}),r.jsx(na,{label:`${I} -${S(O)}-01 ~${I} -${S(O)} -${S(E)} `,value:w(a.currentYearMonthToDate)})]}):r.jsx("div",{className:"empty-state",children:"데이터가 없습니다"})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[r.jsxs("div",{className:"card",style:{padding:16,display:"flex",flexDirection:"column"},children:[r.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#1e293b",marginBottom:12},children:"월별 매출 (올해 vs 전년)"}),r.jsx("div",{style:{flex:1,minHeight:280},children:r.jsx(dH,{prev:l,cur:d,upToMonth:new Date(e).getMonth()+1})})]}),r.jsxs("div",{className:"card",style:{padding:16,display:"flex",flexDirection:"column"},children:[r.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#1e293b",marginBottom:12},children:"일별 매출 (해당 월: 올해 vs 전년)"}),r.jsx("div",{style:{flex:1,minHeight:280},children:r.jsx(uH,{prev:f,cur:m,upToDay:new Date(e).getDate()})})]})]}),r.jsxs("div",{className:"controls",style:{justifyContent:"flex-start",marginTop:12},children:[r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"8px 12px",borderRadius:10},onClick:async()=>{try{const P=await fetch(`/api/v1/dashboard/churn?date=${encodeURIComponent(e)}`),R=await P.json().catch(()=>[]);if(!P.ok||R&&R.error)throw new Error(R.error||`HTTP ${P.status} `);try{window.dispatchEvent(new CustomEvent("tnt.sales.dashboard.churn",{detail:{items:R}}))}catch{}}catch{alert("이탈거래처 조회 실패")}},children:"이탈거래처"}),r.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"8px 12px",borderRadius:10,marginLeft:12},onClick:async()=>{try{const P=await fetch(`/api/v1/dashboard/newcustomers?date=${encodeURIComponent(e)}`),R=await P.json().catch(()=>[]);if(!P.ok||R&&R.error)throw new Error(R.error||`HTTP ${P.status} `);try{window.dispatchEvent(new CustomEvent("tnt.sales.dashboard.newcustomers",{detail:{items:R}}))}catch{}}catch{alert("신규 거래처 조회 실패")}},children:"신규 거래처"})]})]}):v==="sales-status"?r.jsx(fH,{companyType:i,setCompanyType:s}):v==="arrears"?r.jsxs("div",{style:{flex:1,overflowY:"auto",paddingBottom:12},children:[r.jsxs("div",{className:"page-title",children:[r.jsx("h2",{children:"미수 분석"}),r.jsx("div",{className:"controls",style:{gap:8},children:r.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex"},children:["ALL","TNT","DYS"].map(P=>r.jsx("button",{onClick:()=>s(P),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:i===P?"#fff":"transparent",color:i===P?"#2563eb":"#6b7280",boxShadow:i===P?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:P},P))})})]}),r.jsx(aH,{companyType:i})]}):r.jsx("div",{style:{flex:1,overflowY:"auto"},children:r.jsx(rH,{})})]})}function na({label:e,value:n}){return r.jsxs("div",{className:"card",style:{padding:12},children:[r.jsx("div",{className:"muted",style:{fontSize:10,marginBottom:8},children:e}),r.jsx("div",{style:{fontSize:16,fontWeight:700},children:n})]})}function dH({prev:e,cur:n,upToMonth:i}){const s=p.useRef(null),[a,o]=p.useState(0),[l,c]=p.useState(null),[d,u]=p.useState(null),f=320;p.useEffect(()=>{if(!s.current)return;const O=new ResizeObserver(E=>{for(const S of E)o(S.contentRect.width)});return O.observe(s.current),()=>O.disconnect()},[]);const h={top:30,right:20,bottom:40,left:60},m=Math.max(0,a-h.left-h.right),g=Math.max(0,f-h.top-h.bottom),b=Array.from({length:12},(O,E)=>E+1),j=Math.max(1,...e,...n),y=O=>O*m/11,x=O=>g-O/j*g,v=(O,E)=>b.filter(k=>!E||k<=E).map((k,D)=>`${D===0?"M":"L"} ${y(k-1)} ${x(O[k-1]||0)}`).join(" "),A=(O,E)=>{const S=b.filter(P=>!E||P<=E);if(S.length===0)return"";const k=S.map((P,R)=>`${R===0?"M":"L"} ${y(P-1)} ${x(O[P-1]||0)}`).join(" "),D=y(S[S.length-1]-1),T=y(S[0]-1);return`${k} L ${D} ${g} L ${T} ${g} Z`},N=5,C=Array.from({length:N},(O,E)=>Math.round((E+1)*j/N)),w=O=>`${Math.round((O||0)/1e6)}`,_=O=>new Intl.NumberFormat("ko-KR",{maximumFractionDigits:0}).format((O||0)/1e6),I={prev:"#94a3b8",prevArea:"#94a3b8",cur:"#3b82f6",curArea:"#3b82f6"};return a===0?r.jsx("div",{ref:s,style:{width:"100%",height:f}}):r.jsxs("div",{ref:s,style:{width:"100%",height:f,position:"relative"},children:[r.jsxs("div",{style:{position:"absolute",top:0,right:0,display:"inline-flex",gap:12,alignItems:"center",background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:8,padding:"6px 10px",boxShadow:"0 4px 10px rgba(0,0,0,0.05)",zIndex:2,fontSize:11,color:"#64748b"},children:[r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{width:20,height:2.5,background:I.prev,borderRadius:2,position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center"},children:r.jsx("span",{style:{width:7,height:7,borderRadius:"50%",background:"#fff",border:`2px solid ${I.prev}`,position:"absolute"}})}),"전년"]}),r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{width:20,height:2.5,background:I.cur,borderRadius:2,position:"relative",display:"inline-flex",alignItems:"center",justifyContent:"center"},children:r.jsx("span",{style:{width:7,height:7,borderRadius:"50%",background:"#fff",border:`2.5px solid ${I.cur}`,position:"absolute"}})}),"올해"]})]}),r.jsxs("svg",{width:a,height:f,children:[r.jsxs("defs",{children:[r.jsxs("linearGradient",{id:"prevAreaGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[r.jsx("stop",{offset:"0%",stopColor:I.prevArea,stopOpacity:"0.3"}),r.jsx("stop",{offset:"100%",stopColor:I.prevArea,stopOpacity:"0.05"})]}),r.jsxs("linearGradient",{id:"curAreaGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[r.jsx("stop",{offset:"0%",stopColor:I.curArea,stopOpacity:"0.4"}),r.jsx("stop",{offset:"100%",stopColor:I.curArea,stopOpacity:"0.05"})]}),r.jsx("filter",{id:"lineShadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:r.jsx("feDropShadow",{dx:"0",dy:"2",stdDeviation:"2",floodOpacity:"0.15"})})]}),r.jsxs("g",{transform:`translate(${h.left}, ${h.top})`,children:[[0,...C].map((O,E)=>{const S=x(O);return r.jsxs("g",{children:[r.jsx("line",{x1:0,y1:S,x2:m,y2:S,stroke:"#e5e7eb",strokeDasharray:E===0?"0":"4 4"}),r.jsx("text",{x:-10,y:S+4,textAnchor:"end",fontSize:11,fill:"#64748b",children:w(O)})]},E)}),r.jsx("text",{x:-52,y:-10,fontSize:10,fill:"#94a3b8",children:"(백만원)"}),r.jsx("path",{d:A(e),fill:"url(#prevAreaGradient)"}),r.jsx("path",{d:A(n,i),fill:"url(#curAreaGradient)"}),r.jsx("path",{d:v(e),fill:"none",stroke:I.prev,strokeWidth:2.5,strokeLinecap:"round",strokeLinejoin:"round"}),r.jsx("path",{d:v(n,i),fill:"none",stroke:I.cur,strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round",filter:"url(#lineShadow)"}),b.map(O=>{const E=e[O-1]||0,S=y(O-1),k=x(E),D=l===O;return r.jsx("g",{children:r.jsx("circle",{cx:S,cy:k,r:D?6:4,fill:"#fff",stroke:I.prev,strokeWidth:2,style:{transition:"r 0.15s ease"}})},`prev-${O}`)}),b.filter(O=>O<=i).map(O=>{const E=n[O-1]||0,S=y(O-1),k=x(E),D=l===O;return r.jsx("g",{children:r.jsx("circle",{cx:S,cy:k,r:D?7:5,fill:"#fff",stroke:I.cur,strokeWidth:2.5,style:{transition:"r 0.15s ease",filter:"drop-shadow(0 2px 3px rgba(59, 130, 246, 0.3))"}})},`cur-${O}`)}),b.map(O=>{const E=y(O-1);return r.jsx("rect",{x:E-m/24,y:0,width:m/12,height:g,fill:"transparent",style:{cursor:"pointer"},onMouseEnter:S=>{var D;c(O);const k=(D=s.current)==null?void 0:D.getBoundingClientRect();k&&u({x:S.clientX-k.left,y:S.clientY-k.top,month:O})},onMouseMove:S=>{var D;const k=(D=s.current)==null?void 0:D.getBoundingClientRect();k&&u({x:S.clientX-k.left,y:S.clientY-k.top,month:O})},onMouseLeave:()=>{c(null),u(null)}},`hover-${O}`)}),l&&r.jsx("line",{x1:y(l-1),y1:0,x2:y(l-1),y2:g,stroke:"#cbd5e1",strokeDasharray:"4 4",style:{pointerEvents:"none"}}),b.map(O=>r.jsxs("text",{x:y(O-1),y:g+24,textAnchor:"middle",fontSize:11,fill:l===O?"#1e293b":"#64748b",fontWeight:l===O?600:400,children:[O,"월"]},O))]})]}),d&&l&&r.jsxs("div",{style:{position:"absolute",left:Math.min(d.x+12,a-150),top:Math.max(d.y-80,10),background:"#fff",padding:"10px 14px",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",pointerEvents:"none",zIndex:1e3,minWidth:120},children:[r.jsxs("div",{style:{fontWeight:600,marginBottom:8,color:"#1e293b",borderBottom:"1px solid #f1f5f9",paddingBottom:6},children:[l,"월"]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[r.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:I.prev}}),r.jsx("span",{style:{color:"#64748b"},children:"전년:"}),r.jsx("span",{style:{fontWeight:600,color:"#475569"},children:_(e[l-1]||0)})]}),l<=i&&r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{style:{width:8,height:8,borderRadius:"50%",background:I.cur}}),r.jsx("span",{style:{color:"#64748b"},children:"올해:"}),r.jsx("span",{style:{fontWeight:600,color:"#3b82f6"},children:_(n[l-1]||0)})]})]})]})}function uH({prev:e,cur:n,upToDay:i}){const s=p.useRef(null),[a,o]=p.useState(0),[l,c]=p.useState(null),[d,u]=p.useState(null),f=320;p.useEffect(()=>{if(!s.current)return;const E=new ResizeObserver(S=>{for(const k of S)o(k.contentRect.width)});return E.observe(s.current),()=>E.disconnect()},[]);const h={top:30,right:20,bottom:40,left:60},m=Math.max(0,a-h.left-h.right),g=Math.max(0,f-h.top-h.bottom),b=31,j=Math.max(1,...e,...n),y=m/b,x=Math.max(2,y*.35),v=2,A=E=>E*y+y/2,N=E=>g-E/j*g,C=5,w=Array.from({length:C},(E,S)=>Math.round((S+1)*j/C)),_=E=>`${Math.round((E||0)/1e6)}`,I=E=>new Intl.NumberFormat("ko-KR",{maximumFractionDigits:0}).format((E||0)/1e6),O={prev:"#94a3b8",cur:"#3b82f6"};return a===0?r.jsx("div",{ref:s,style:{width:"100%",height:f}}):r.jsxs("div",{ref:s,style:{width:"100%",height:f,position:"relative"},children:[r.jsxs("div",{style:{position:"absolute",top:0,right:0,display:"inline-flex",gap:12,alignItems:"center",background:"#f8fafc",border:"1px solid #e2e8f0",borderRadius:8,padding:"6px 10px",boxShadow:"0 4px 10px rgba(0,0,0,0.05)",zIndex:2,fontSize:11,color:"#64748b"},children:[r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{width:12,height:12,borderRadius:2,background:"#94a3b8",border:"1px solid #cbd5e1"}}),"전년"]}),r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{width:12,height:12,borderRadius:2,background:"#3b82f6",border:"1px solid #60a5fa"}}),"올해"]})]}),r.jsxs("svg",{width:a,height:f,children:[r.jsxs("defs",{children:[r.jsxs("linearGradient",{id:"barPrevGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[r.jsx("stop",{offset:"0%",stopColor:"#94a3b8"}),r.jsx("stop",{offset:"100%",stopColor:"#cbd5e1"})]}),r.jsxs("linearGradient",{id:"barCurGradient",x1:"0%",y1:"0%",x2:"0%",y2:"100%",children:[r.jsx("stop",{offset:"0%",stopColor:"#3b82f6"}),r.jsx("stop",{offset:"100%",stopColor:"#60a5fa"})]}),r.jsx("filter",{id:"barShadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:r.jsx("feDropShadow",{dx:"0",dy:"1",stdDeviation:"1",floodOpacity:"0.15"})})]}),r.jsxs("g",{transform:`translate(${h.left}, ${h.top})`,children:[[0,...w].map((E,S)=>{const k=N(E);return r.jsxs("g",{children:[r.jsx("line",{x1:0,y1:k,x2:m,y2:k,stroke:"#e5e7eb",strokeDasharray:S===0?"0":"4 4"}),r.jsx("text",{x:-10,y:k+4,textAnchor:"end",fontSize:11,fill:"#64748b",children:_(E)})]},S)}),r.jsx("text",{x:-52,y:-10,fontSize:10,fill:"#94a3b8",children:"(백만원)"}),Array.from({length:b},(E,S)=>S).map(E=>{const S=A(E),k=e[E]||0,D=n[E]||0,T=k/j*g,P=D/j*g,R=l===E;return r.jsxs("g",{children:[r.jsx("rect",{x:S-x-v/2,y:g-T,width:x,height:T,fill:"url(#barPrevGradient)",rx:2,ry:2,opacity:R?1:.85,style:{transition:"opacity 0.15s ease"}}),E<i&&r.jsx("rect",{x:S+v/2,y:g-P,width:x,height:P,fill:"url(#barCurGradient)",rx:2,ry:2,opacity:R?1:.85,filter:R?"url(#barShadow)":void 0,style:{transition:"opacity 0.15s ease"}}),r.jsx("rect",{x:S-y/2,y:0,width:y,height:g,fill:"transparent",style:{cursor:"pointer"},onMouseEnter:Y=>{var H;c(E);const X=(H=s.current)==null?void 0:H.getBoundingClientRect();X&&u({x:Y.clientX-X.left,y:Y.clientY-X.top,day:E+1})},onMouseMove:Y=>{var H;const X=(H=s.current)==null?void 0:H.getBoundingClientRect();X&&u({x:Y.clientX-X.left,y:Y.clientY-X.top,day:E+1})},onMouseLeave:()=>{c(null),u(null)}})]},E)}),l!==null&&r.jsx("line",{x1:A(l),y1:0,x2:A(l),y2:g,stroke:"#cbd5e1",strokeDasharray:"4 4",style:{pointerEvents:"none"}}),Array.from({length:b},(E,S)=>S+1).filter(E=>E===1||E%5===0||E===b).map(E=>r.jsx("text",{x:A(E-1),y:g+20,textAnchor:"middle",fontSize:11,fill:l===E-1?"#1e293b":"#64748b",fontWeight:l===E-1?600:400,children:E},E)),r.jsx("text",{x:m/2,y:g+34,textAnchor:"middle",fontSize:10,fill:"#94a3b8",children:"(일)"})]})]}),d&&l!==null&&r.jsxs("div",{style:{position:"absolute",left:Math.min(d.x+12,a-150),top:Math.max(d.y-80,10),background:"#fff",padding:"10px 14px",border:"1px solid #e5e7eb",borderRadius:8,fontSize:12,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",pointerEvents:"none",zIndex:1e3,minWidth:120},children:[r.jsxs("div",{style:{fontWeight:600,marginBottom:8,color:"#1e293b",borderBottom:"1px solid #f1f5f9",paddingBottom:6},children:[d.day,"일"]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[r.jsx("span",{style:{width:10,height:10,borderRadius:2,background:O.prev}}),r.jsx("span",{style:{color:"#64748b"},children:"전년:"}),r.jsx("span",{style:{fontWeight:600,color:"#475569"},children:I(e[l]||0)})]}),l<i&&r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{style:{width:10,height:10,borderRadius:2,background:O.cur}}),r.jsx("span",{style:{color:"#64748b"},children:"올해:"}),r.jsx("span",{style:{fontWeight:600,color:"#3b82f6"},children:I(n[l]||0)})]})]})]})}function fH({companyType:e,setCompanyType:n}){const[i,s]=p.useState("MONTH"),[a,o]=p.useState(new Date),[l,c]=p.useState(!1),[d,u]=p.useState(null),[f,h]=p.useState([]),[m,g]=p.useState("TREND"),b=N=>{const C=new Date(Date.UTC(N.getFullYear(),N.getMonth(),N.getDate())),w=C.getUTCDay()||7;C.setUTCDate(C.getUTCDate()+4-w);const _=new Date(Date.UTC(C.getUTCFullYear(),0,1));return Math.ceil(((C.getTime()-_.getTime())/864e5+1)/7)},j=N=>{if(!N||!N.includes("-"))return new Date;const[C,w]=N.split("-"),_=parseInt(C,10),I=parseInt(w,10),O=new Date(_,0,1+(I-1)*7),E=O.getDay(),S=O;return E<=4?S.setDate(O.getDate()-O.getDay()+1):S.setDate(O.getDate()+8-O.getDay()),S};p.useEffect(()=>{(async()=>{c(!0);try{if(m==="TREND"){const C=new Date;let w,_=C,I="WEEKLY";if(i==="MONTH")w=new Date(C.getFullYear(),0,1),I="MONTHLY";else{const R=C.getMonth(),Y=Math.floor((R+3)/3);let X=C.getFullYear(),H=(Y-2)*3;H<0&&(H+=12,X-=1),w=new Date(X,H,1)}const O=R=>{const Y=R.getFullYear(),X=String(R.getMonth()+1).padStart(2,"0"),H=String(R.getDate()).padStart(2,"0");return`${Y}-${X}-${H}`},E=await fetch(`/api/v1/analysis/sales-trend?startDate=${O(w)}&endDate=${O(_)}&companyType=${e}&groupBy=${I}`);if(!E.ok)throw new Error("Failed to fetch trend data");const S=await E.json();let k=-1;const D=S.map(R=>{let Y="",X=null;if(I==="MONTHLY"){const[H,q]=R.date.split("-");Y=`${parseInt(q,10)}월`,X=Math.round(R.amount/1e6)}else{const q=j(R.date).getMonth()+1,M=parseInt(R.date.split("-")[1],10);Y=`${q}월 ${M}주`,q!==k&&(X=Math.round(R.amount/1e6),k=q)}return{...R,displayDate:Y,labelAmount:X}});h(D);let T=`/api/v1/analysis/sales-status?type=${i}&year=${a.getFullYear()}`;if(i==="MONTH")T+=`&month=${a.getMonth()+1}`;else{const R=b(a);T+=`&week=${R}`}e&&e!=="ALL"&&(T+=`&companyType=${e}`);const P=await fetch(T);if(P.ok){const R=await P.json();u(R)}}else{let C=`/api/v1/analysis/sales-status?type=${i}&year=${a.getFullYear()}`;if(i==="MONTH")C+=`&month=${a.getMonth()+1}`;else{const I=b(a);C+=`&week=${I}`}e&&e!=="ALL"&&(C+=`&companyType=${e}`);const w=await fetch(C);if(!w.ok)throw new Error("Failed to fetch");const _=await w.json();u(_)}}catch(C){console.error(C)}finally{c(!1)}})()},[i,a,e,m]);const y=()=>{const N=new Date(a);i==="MONTH"?N.setMonth(N.getMonth()-1):N.setDate(N.getDate()-7),o(N)},x=()=>{const N=new Date(a);i==="MONTH"?N.setMonth(N.getMonth()+1):N.setDate(N.getDate()+7),o(N)},v=()=>i==="MONTH"?`${a.getFullYear()}년 ${a.getMonth()+1}월`:`${a.getFullYear()}년 ${b(a)}주차`,A=()=>{var w;if(l)return r.jsx("div",{style:{height:300,display:"flex",alignItems:"center",justifyContent:"center"},children:"로딩중..."});const N=_=>new Intl.NumberFormat("ko-KR").format(_),C=(d==null?void 0:d.summary)||{totalAmt:0,tntAmt:0,dysAmt:0};return r.jsxs("div",{style:{flex:1,height:"100%",minHeight:0,display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:12,padding:"12px 12px 0"},children:[r.jsxs("div",{className:"card",style:{padding:12,background:"#f8fafc"},children:[r.jsx("div",{className:"muted",style:{fontSize:11,marginBottom:4},children:"전체 매출"}),r.jsx("div",{style:{fontSize:15,fontWeight:700,color:"#0f172a"},children:N(C.totalAmt||0)})]}),r.jsxs("div",{className:"card",style:{padding:12,background:"#f0f9ff"},children:[r.jsx("div",{className:"muted",style:{fontSize:11,marginBottom:4},children:"TNT 매출"}),r.jsx("div",{style:{fontSize:15,fontWeight:700,color:"#0369a1"},children:N(C.tntAmt||0)})]}),r.jsxs("div",{className:"card",style:{padding:12,background:"#fdf2f8"},children:[r.jsx("div",{className:"muted",style:{fontSize:11,marginBottom:4},children:"DYS 매출"}),r.jsx("div",{style:{fontSize:15,fontWeight:700,color:"#be185d"},children:N(C.dysAmt||0)})]})]}),r.jsxs("div",{style:{flex:1,overflow:"hidden"},children:[m==="TREND"&&r.jsxs("div",{style:{padding:12,height:"100%",display:"flex",flexDirection:"column"},children:[r.jsxs("h3",{style:{fontSize:14,marginBottom:12,fontWeight:600},children:[i==="MONTH"?"월별":"주별"," 매출 추이 (",i==="MONTH"?"올해 1월 ~ 현재":"전분기 ~ 현재",")"]}),r.jsx("div",{style:{flex:1,minHeight:0},children:r.jsx(Ro,{width:"100%",height:"100%",children:r.jsxs(Pk,{data:f,margin:{top:5,right:30,left:20,bottom:5},children:[r.jsx(Bo,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),r.jsx(qo,{dataKey:"displayDate",tick:{fontSize:11,fill:"#6b7280"},tickLine:!1,axisLine:!1}),r.jsx(Uo,{tick:{fontSize:11,fill:"#6b7280"},tickLine:!1,axisLine:!1,tickFormatter:_=>(_/1e6).toFixed(0)}),r.jsx(td,{contentStyle:{borderRadius:8,border:"none",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},formatter:_=>[new Intl.NumberFormat("ko-KR").format(_)+" 원","매출액"]}),r.jsx(hg,{type:"monotone",dataKey:"amount",stroke:"#3b82f6",strokeWidth:2,dot:!1,activeDot:{r:6},children:r.jsx(fa,{dataKey:"labelAmount",position:"top",style:{fontSize:11,fill:"#3b82f6",fontWeight:600},formatter:_=>_?_.toLocaleString():""})})]})})})]}),m==="ITEM"&&r.jsxs("div",{style:{padding:12,height:"100%",overflowY:"auto"},children:[r.jsxs("div",{style:{marginBottom:24},children:[r.jsx("h3",{style:{fontSize:14,marginBottom:12,fontWeight:600},children:"영업관리단위별 통계"}),d!=null&&d.bySalesMgmtUnit&&d.bySalesMgmtUnit.length>0?r.jsx(Hl,{data:d.bySalesMgmtUnit.map(_=>({name:(_.unitName||"미지정").trim(),value:Number(_.totalAmt||0)})),color:"#f59e0b",containerHeight:300}):r.jsx("div",{className:"muted",children:"데이터 없음"})]}),r.jsxs("div",{children:[r.jsx("h3",{style:{fontSize:14,marginBottom:12,fontWeight:600},children:"품목별 통계"}),d!=null&&d.byItem&&d.byItem.length>0?r.jsx(Hl,{data:d.byItem.map(_=>({name:(_.itemName||"미지정").trim(),value:Number(_.totalAmt||0)})),color:"#10b981"}):r.jsx("div",{className:"muted",children:"데이터 없음"})]})]}),m==="REGION"&&r.jsxs("div",{style:{padding:12,height:"100%",display:"flex",flexDirection:"column"},children:[r.jsx("h3",{style:{fontSize:14,marginBottom:12,fontWeight:600},children:"지역별 통계"}),r.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",gap:12},children:[r.jsx("div",{style:{flex:1,minWidth:0},children:r.jsx(yH,{salesData:((w=d==null?void 0:d.byRegion)==null?void 0:w.map(_=>({region:_.region||"미지정",totalAmt:Number(_.totalAmt||0)})))||[]})}),r.jsx("div",{style:{flex:1,minWidth:0},children:d!=null&&d.byRegion&&d.byRegion.length>0?r.jsx(Hl,{data:d.byRegion.map(_=>({name:(_.region||"미지정").trim(),value:Number(_.totalAmt||0)})),color:"#3b82f6",yAxisWidth:100,containerHeight:640}):r.jsx("div",{className:"muted",children:"데이터 없음"})})]})]}),m==="SALESPERSON"&&r.jsxs("div",{style:{padding:12},children:[r.jsx("h3",{style:{fontSize:14,marginBottom:12,fontWeight:600},children:"영업사원별 통계"}),d!=null&&d.bySalesperson&&d.bySalesperson.length>0?r.jsx(Hl,{data:d.bySalesperson.map(_=>({name:(_.salesperson||"미지정").trim(),value:Number(_.totalAmt||0)})),color:"#8b5cf6",yAxisWidth:100}):r.jsx("div",{className:"muted",children:"데이터 없음"})]})]})]})};return r.jsxs("div",{className:"card",style:{height:"100%",display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("h2",{style:{fontSize:16,fontWeight:600,margin:0},children:"매출현황분석"}),r.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex"},children:["ALL","TNT","DYS"].map(N=>r.jsx("button",{onClick:()=>n(N),style:{padding:"4px 10px",borderRadius:6,border:"none",fontSize:12,fontWeight:600,cursor:"pointer",background:e===N?"#fff":"transparent",color:e===N?"#2563eb":"#6b7280",boxShadow:e===N?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:N},N))})]}),r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",gap:0},children:[r.jsx("button",{className:`btn ${i==="MONTH"?"btn-primary":"btn-secondary"} `,onClick:()=>s("MONTH"),style:{borderRadius:"4px 0 0 4px",height:32,fontSize:13},children:"월별"}),r.jsx("button",{className:`btn ${i==="WEEK"?"btn-primary":"btn-secondary"} `,onClick:()=>s("WEEK"),style:{borderRadius:"0 4px 4px 0",borderLeft:"none",height:32,fontSize:13},children:"주별"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[r.jsx("button",{className:"btn btn-ghost",onClick:y,style:{padding:4,height:32,width:32,justifyContent:"center"},children:r.jsx(Dv,{size:16})}),r.jsx("span",{style:{fontSize:14,fontWeight:600,minWidth:100,textAlign:"center"},children:v()}),r.jsx("button",{className:"btn btn-ghost",onClick:x,style:{padding:4,height:32,width:32,justifyContent:"center"},children:r.jsx(Ii,{size:16})})]})]})]}),r.jsx("div",{style:{borderBottom:"1px solid var(--border)",padding:"0 20px"},children:r.jsx("div",{style:{display:"flex",gap:0},children:[{id:"TREND",label:"매출추이"},{id:"ITEM",label:"품목별"},{id:"REGION",label:"지역별"},{id:"SALESPERSON",label:"영업사원별"}].map(N=>r.jsx("button",{onClick:()=>g(N.id),style:{padding:"12px 20px",background:"none",border:"none",borderBottom:m===N.id?"2px solid var(--primary)":"2px solid transparent",color:m===N.id?"var(--primary)":"var(--text-secondary)",fontWeight:m===N.id?600:400,cursor:"pointer",fontSize:14},children:N.label},N.id))})}),r.jsx("div",{style:{flex:1,overflow:"hidden"},children:A()})]})}function Hl({data:e,color:n,yAxisWidth:i=100,containerHeight:s=400}){const a=Math.max(300,e.length*32),o=f=>{const h=f/1e6;return new Intl.NumberFormat("ko-KR",{maximumFractionDigits:0}).format(h)},l=f=>new Intl.NumberFormat("ko-KR").format(f),c=(f,h="11px sans-serif")=>{const g=document.createElement("canvas").getContext("2d");return g?(g.font=h,g.measureText(f).width):f.length*7},d=Math.max(...e.map(f=>c(f.name||""))),u=Math.min(350,Math.ceil(d)+8);return r.jsxs("div",{style:{width:"100%",height:s,overflowY:"auto",overflowX:"hidden",paddingRight:8},children:[r.jsx("div",{style:{textAlign:"right",fontSize:11,color:"#6b7280",marginBottom:4},children:"(단위: 백만원)"}),r.jsx("div",{style:{width:"100%",height:a},children:r.jsx(Ro,{width:"100%",height:"100%",children:r.jsxs(Ok,{layout:"vertical",data:e,margin:{top:5,right:50,left:0,bottom:5},children:[r.jsx(Bo,{strokeDasharray:"3 3",horizontal:!1,stroke:"#e5e7eb"}),r.jsx(qo,{type:"number",domain:[0,"dataMax"],tickCount:6,tick:!1,axisLine:!1}),r.jsx(Uo,{dataKey:"name",type:"category",width:u,tick:{fontSize:11,fill:"#374151"},tickLine:!1,axisLine:!1,interval:0,tickMargin:0}),r.jsx(td,{cursor:{fill:"#f3f4f6"},contentStyle:{borderRadius:8,border:"none",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},formatter:f=>[l(f)+" 원","매출액"]}),r.jsx(og,{dataKey:"value",fill:n,radius:[0,4,4,0],barSize:18,children:r.jsx(fa,{dataKey:"value",position:"right",formatter:f=>o(f),style:{fontSize:11,fill:"#374151"}})})]})})})]})}const hH=[[33,125.8],[38.6,130]],pH={서울특별시:[37.5665,126.978],서울:[37.5665,126.978],부산광역시:[35.1796,129.0756],부산:[35.1796,129.0756],대구광역시:[35.8714,128.6014],대구:[35.8714,128.6014],인천광역시:[37.4563,126.7052],인천:[37.4563,126.7052],광주광역시:[35.1595,126.8526],광주:[35.1595,126.8526],대전광역시:[36.3504,127.3845],대전:[36.3504,127.3845],울산광역시:[35.5384,129.3114],울산:[35.5384,129.3114],세종특별자치시:[36.48,127.289],세종:[36.48,127.289],경기도:[37.4138,127.5183],경기:[37.4138,127.5183],강원특별자치도:[37.8228,128.1555],강원도:[37.8228,128.1555],강원:[37.8228,128.1555],충청북도:[36.6357,127.4914],충북:[36.6357,127.4914],충청남도:[36.5184,126.8],충남:[36.5184,126.8],전북특별자치도:[35.7175,127.153],전라북도:[35.7175,127.153],전북:[35.7175,127.153],전라남도:[34.8679,126.991],전남:[34.8679,126.991],경상북도:[36.4919,128.8889],경북:[36.4919,128.8889],경상남도:[35.4606,128.2132],경남:[35.4606,128.2132],제주특별자치도:[33.489,126.4983],제주도:[33.489,126.4983],제주:[33.489,126.4983]};function mH(){const e=dN();return p.useEffect(()=>{e.fitBounds(hH,{padding:[10,10]}),e.setZoom(e.getZoom()+.2)},[e]),null}function Dk(e){const n=e/1e6;return new Intl.NumberFormat("ko-KR",{maximumFractionDigits:0}).format(n)+"M"}function gH(e,n,i){const s=i>0?n/i:0,a=Math.max(36,Math.min(70,36+s*34)),o=210,l=70,c=Math.max(35,55-s*20);return uN.divIcon({className:"sales-marker",html:`<div style="
background: hsl(${o}, ${l}%, ${c}%);
color: white;
border-radius: 50%;
width: ${a}px;
height: ${a}px;
display: flex;
flex-direction: column;
align-items: center;
justify-content: center;
font-size: ${Math.max(9,a/6)}px;
font-weight: bold;
border: 2px solid white;
box-shadow: 0 2px 6px rgba(0, 0, 0, 0.35);
line-height: 1.1;
">
  <div style="font-size: ${Math.max(7,a/7)}px; opacity: 0.85;">${e.replace(/특별시|광역시|특별자치시|특별자치도|도$/,"")}</div>
    <div>${Dk(n)}</div>
    </div>`,iconSize:[a,a],iconAnchor:[a/2,a/2]})}function yH({salesData:e}){const[n,i]=p.useState(null),[s,a]=p.useState(!0),[o,l]=p.useState(null),c=p.useRef(null),[d,u]=p.useState(null),f=y=>{if(!y)return null;const A=y.trim().split(/\s+/)[0];return{서울특별시:"서울특별시",서울:"서울특별시",부산광역시:"부산광역시",부산:"부산광역시",대구광역시:"대구광역시",대구:"대구광역시",인천광역시:"인천광역시",인천:"인천광역시",광주광역시:"광주광역시",광주:"광주광역시",대전광역시:"대전광역시",대전:"대전광역시",울산광역시:"울산광역시",울산:"울산광역시",세종특별자치시:"세종특별자치시",세종:"세종특별자치시",경기도:"경기도",경기:"경기도",강원특별자치도:"강원특별자치도",강원도:"강원특별자치도",강원:"강원특별자치도",충청북도:"충청북도",충북:"충청북도",충청남도:"충청남도",충남:"충청남도",전북특별자치도:"전북특별자치도",전라북도:"전북특별자치도",전북:"전북특별자치도",전라남도:"전라남도",전남:"전라남도",경상북도:"경상북도",경북:"경상북도",경상남도:"경상남도",경남:"경상남도",제주특별자치도:"제주특별자치도",제주도:"제주특별자치도",제주:"제주특별자치도"}[A]||null},h=p.useMemo(()=>{const y={};return e.forEach(x=>{const v=f(x.region);v&&(y[v]=(y[v]||0)+x.totalAmt)}),y},[e]),m=p.useMemo(()=>Object.entries(h).map(([y,x])=>({sido:y,totalAmt:x,center:pH[y]})).filter(y=>y.center&&y.totalAmt>0),[h]),g=p.useMemo(()=>Math.max(...Object.values(h),1),[h]);p.useEffect(()=>{fetch("/sales/data/sido_boundary_simplified.geojson").then(y=>{if(!y.ok)throw new Error("지도 데이터를 불러올 수 없습니다.");return y.json()}).then(y=>{i(y),a(!1)}).catch(y=>{l(y.message),a(!1)})},[]);const b=y=>{var w;if(!y)return{};const x=((w=y.properties)==null?void 0:w.CTP_KOR_NM)||"",v=d===x,A=h[x]||0,N=g>0?A/g:0,C=A>0?.2+N*.5:.05;return{fillColor:A>0?"#3b82f6":"#e5e7eb",weight:v?2:1,opacity:1,color:v?"#1e40af":"#6b7280",fillOpacity:C}},j=(y,x)=>{var N;const v=((N=y.properties)==null?void 0:N.CTP_KOR_NM)||"알 수 없음",A=h[v]||0;x.on({mouseover:()=>{u(v),c.current&&c.current.setStyle(C=>b(C))},mouseout:()=>{u(null),c.current&&c.current.setStyle(C=>b(C))}}),x.bindTooltip(`<strong>${v}</strong><br />매출: ${Dk(A)}`,{permanent:!1,direction:"center",className:"sales-map-tooltip"})};return s?r.jsx("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:"지도 로딩 중..."}):o?r.jsx("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"red"},children:o}):r.jsxs("div",{style:{height:"100%",position:"relative"},children:[r.jsxs(oN,{center:[36.5,127.5],zoom:7,zoomSnap:.1,style:{height:"100%",width:"100%",background:"#fff"},scrollWheelZoom:!0,children:[n&&r.jsxs(r.Fragment,{children:[r.jsx(lN,{ref:c,data:n,style:b,onEachFeature:j}),r.jsx(mH,{})]}),m.map(y=>{const x=gH(y.sido,y.totalAmt,g),v=new Intl.NumberFormat("ko-KR").format(y.totalAmt);return r.jsx(cN,{position:y.center,icon:x,children:r.jsx(fN,{direction:"top",offset:[0,-20],className:"sales-marker-tooltip-recharts",children:r.jsxs("div",{style:{padding:"4px 0"},children:[r.jsx("div",{style:{color:"#6b7280",fontSize:12,marginBottom:6},children:y.sido}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{style:{width:10,height:10,borderRadius:"50%",background:"#3b82f6",display:"inline-block"}}),r.jsx("span",{style:{color:"#374151",fontSize:13},children:"매출액: "}),r.jsxs("span",{style:{color:"#374151",fontWeight:600,fontSize:13},children:[v," 원"]})]})]})})},y.sido)})]}),r.jsxs("div",{style:{position:"absolute",bottom:10,right:10,background:"rgba(255,255,255,0.95)",padding:"8px 12px",borderRadius:8,fontSize:11,boxShadow:"0 2px 4px rgba(0,0,0,0.1)",zIndex:1e3},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"매출 (백만원)"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[r.jsx("div",{style:{width:16,height:16,background:"rgba(59, 130, 246, 0.2)",border:"1px solid #6b7280"}}),r.jsx("span",{children:"낮음"}),r.jsx("div",{style:{width:16,height:16,background:"rgba(59, 130, 246, 0.7)",border:"1px solid #6b7280",marginLeft:8}}),r.jsx("span",{children:"높음"})]})]}),r.jsx("style",{children:`
  .sales - map - tooltip {
  background: rgba(0, 0, 0, 0.85);
  border: none;
  border - radius: 6px;
  color: white;
  font - size: 12px;
  padding: 6px 10px;
}
        .sales - marker {
  background: transparent;
  border: none;
}
        .sales - marker - tooltip - recharts {
  background: #fff!important;
  border: none!important;
  border - radius: 8px!important;
  padding: 10px 14px!important;
  box - shadow: 0 4px 6px - 1px rgba(0, 0, 0, 0.1)!important;
  font - family: inherit!important;
}
        .sales - marker - tooltip - recharts::before {
  border - top - color: #fff!important;
}
        .leaflet - tooltip.sales - marker - tooltip - recharts {
  opacity: 1!important;
}
`})]})}function xH({activity:e}){return r.jsxs("section",{className:"card activity-edit-panel",style:{marginTop:12,minHeight:240},children:[r.jsx("div",{className:"tabs c360-tabs",children:r.jsx("button",{className:"tab active",children:"영업활동 변경"})}),r.jsx("div",{className:"activity-form-wrapper",children:r.jsx(Ps,{bare:!0,editId:e==null?void 0:e.id,initial:{id:e==null?void 0:e.id,subject:(e==null?void 0:e.subject)||"",description:(e==null?void 0:e.description)||"",channel:(e==null?void 0:e.channel)||"in_person",activityType:(e==null?void 0:e.activityType)||"site_visit",activityStatus:(e==null?void 0:e.activityStatus)||"scheduled",plannedStartAt:(e==null?void 0:e.plannedStartAt)||"",plannedEndAt:(e==null?void 0:e.plannedEndAt)||"",sfAccountId:(e==null?void 0:e.sfAccountId)||"",customerName:(e==null?void 0:e.customerName)||"",parentActivitySeq:e==null?void 0:e.parentSeq,parentSubject:e==null?void 0:e.parentSubject}},`edit-${(e==null?void 0:e.id)??"new"}`)})]})}function Xr(e){if(!e)return"";const n=e instanceof Date?e:new Date(e);if(isNaN(n.getTime()))return"";const i=String(n.getFullYear()%100).padStart(2,"0"),s=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0");return`${i}-${s}-${a} ${o}:${l}`}function vH(){const[e,n]=p.useState([]),[i,s]=p.useState(!1),[a,o]=p.useState(null),[l,c]=p.useState(()=>new Set),[d,u]=p.useState(null),[f,h]=p.useState(""),[m,g]=p.useState([]),[b,j]=p.useState(""),[y,x]=p.useState(void 0),[v,A]=p.useState({open:!1,x:0,y:0});function N(){try{const E=localStorage.getItem("tnt.sales.visitPlanActivities"),S=E?JSON.parse(E):[],k=new Set;return Array.isArray(S)&&S.forEach(D=>{(D==null?void 0:D.id)!=null&&k.add(Number(D.id))}),k}catch{return new Set}}async function C(){o(null),s(!0);try{const E=localStorage.getItem("tnt.sales.assigneeId");if(!E)throw new Error(zt.loginRequired);const S=new URL("/api/v1/sales-activities",window.location.origin);S.searchParams.set("mineOnly","true"),S.searchParams.set("assigneeId",String(E)),f&&f.trim()&&S.searchParams.set("customerName",f.trim()),b&&b.trim()&&S.searchParams.append("status",b.trim());const k=await fetch(S.toString());if(!k.ok){let Y=`HTTP ${k.status}`;try{const X=await k.json();X!=null&&X.error&&(Y=X.error)}catch{}throw new Error(Y)}const D=await k.json(),T=Array.isArray(D)?D:[],P=N(),R=T.filter(Y=>!P.has(Y.id));n(R),x(Y=>{if(!(!R||R.length===0))return Y&&R.some(X=>X.id===Y.id)?Y:R[0]})}catch(E){o(E.message||"조회 중 오류가 발생했습니다")}finally{s(!1)}}p.useEffect(()=>{C(),(async()=>{try{const k=await fetch("/api/v1/sales-activities/statuses");if(k.ok){const D=await k.json(),T=["scheduled","completed","canceled","postponed"];Array.isArray(D)&&D.length>0?g(D):g(T)}else g(["scheduled","completed","canceled","postponed"])}catch{}})();const E=()=>{try{const k=localStorage.getItem("tnt.sales.availableActivities");if(k){const D=JSON.parse(k);if(Array.isArray(D)){const T=D;n(T),x(P=>{if(!(!T||T.length===0))return P&&T.some(R=>R.id===P.id)?P:T[0]})}}}catch{}};window.addEventListener("tnt.sales.availableActivitiesUpdated",E);const S=()=>{C()};return window.addEventListener("tnt.sales.activity.updated",S),()=>window.removeEventListener("tnt.sales.availableActivitiesUpdated",E)},[]),p.useEffect(()=>{if(!v.open)return;const E=()=>A({open:!1,x:0,y:0}),S=k=>{k.key==="Escape"&&A({open:!1,x:0,y:0})};return window.addEventListener("click",E),window.addEventListener("keydown",S),()=>{window.removeEventListener("click",E),window.removeEventListener("keydown",S)}},[v.open]);function w(E,S){E.preventDefault(),E.stopPropagation();const k=(S.parentSubject||"").trim();if(!k){A({open:!1,x:0,y:0});return}const D=e.find(P=>(P.subject||"").trim()===k)||null,T=e.filter(P=>(P.parentSubject||"").trim()===k);A({open:!0,x:E.clientX,y:E.clientY,parent:D,siblings:T})}function _(){if(u(null),l.size===0){u("선택된 활동이 없습니다");return}const E=e.filter(k=>l.has(k.id)),S=e.filter(k=>!l.has(k.id));try{let k=[];try{const X=localStorage.getItem("tnt.sales.visitPlanActivities");if(X){const H=JSON.parse(X);Array.isArray(H)&&(k=H)}}catch{}const D=new Map;k.forEach(X=>D.set(X.id,X)),E.forEach(X=>D.set(X.id,X));const T=Array.from(D.values());localStorage.setItem("tnt.sales.visitPlanActivities",JSON.stringify(T));let P=[];try{const X=localStorage.getItem("tnt.sales.availableActivities");if(X){const H=JSON.parse(X);Array.isArray(H)&&(P=H)}}catch{}const R=new Map;P.forEach(X=>R.set(X.id,X)),S.forEach(X=>R.set(X.id,X)),E.forEach(X=>R.delete(X.id));const Y=Array.from(R.values());localStorage.setItem("tnt.sales.availableActivities",JSON.stringify(Y)),window.dispatchEvent(new CustomEvent("tnt.sales.visitPlanUpdated")),window.dispatchEvent(new CustomEvent("tnt.sales.availableActivitiesUpdated")),u(`방문 일정 대상 ${E.length}건을 우측 패널에 추가했습니다`),n(Y),c(new Set)}catch{u("저장 중 오류가 발생했습니다")}}const I=(E,S)=>E?S==="type"?{site_visit:"정기방문",opportunity:"영업기회",AR_mgmt:"채권관리",meeting:"미팅",call:"전화",email:"이메일",demo:"데모",task:"업무",other:"기타"}[E]||E:S==="status"?{scheduled:"계획",completed:"완료",canceled:"취소",postponed:"연기",no_show:"미방문"}[E]||E:S==="channel"&&{in_person:"방문",phone:"전화",email:"문자/메일/팩스",other:"기타",video:"영상",chat:"채팅",sms:"문자"}[E]||E:"",O=p.useMemo(()=>{const E=S=>[`제목: ${S.subject||""}`,`활동설명: ${S.description||""}`,`활동유형: ${I(S.activityType,"type")}`,`활동방법: ${I(S.channel,"channel")}`,`상태: ${I(S.activityStatus,"status")}`,`상위활동: ${S.parentSubject||""}`,`계획 일시: ${Xr(S.plannedStartAt)}`,`종료 일시: ${Xr(S.plannedEndAt)}`,`거래처명: ${S.customerName||""}`,`생성일시: ${Xr(S.createdAt)}`].join(`
`);return r.jsxs(r.Fragment,{children:[r.jsx("div",{className:"table-container",style:{maxHeight:"32vh"},children:e.length===0?r.jsx("div",{className:"empty-state",children:zt.empty}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:36,textAlign:"center"},children:r.jsx("input",{type:"checkbox",checked:e.length>0&&l.size===e.length,onChange:S=>{if(S.target.checked){const k=new Set;e.forEach(D=>k.add(D.id)),c(k)}else c(new Set)}})}),r.jsx("th",{style:{width:240},children:"제목"}),r.jsx("th",{style:{width:120},children:"활동방법"}),r.jsx("th",{style:{width:200},children:"거래처명"}),r.jsx("th",{style:{width:280},children:"활동설명"}),r.jsx("th",{style:{width:220},children:"상위활동"}),r.jsx("th",{style:{width:120},children:"활동유형"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:180},children:"계획 일시"}),r.jsx("th",{style:{width:180},children:"종료 일시"}),r.jsx("th",{style:{width:180},children:"생성일시"})]})}),r.jsx("tbody",{children:e.map((S,k)=>r.jsxs("tr",{title:E(S),onClick:()=>x(S),onContextMenu:D=>w(D,S),"aria-selected":(y==null?void 0:y.id)===S.id?!0:void 0,style:(y==null?void 0:y.id)===S.id?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:[r.jsx("td",{style:{textAlign:"center"},children:r.jsx("input",{type:"checkbox",checked:l.has(S.id),onChange:D=>{c(T=>{const P=new Set(T);return D.target.checked?P.add(S.id):P.delete(S.id),P})}})}),r.jsx("td",{children:S.subject||""}),r.jsx("td",{children:I(S.channel,"channel")}),r.jsx("td",{children:S.customerName||""}),r.jsx("td",{title:S.description||"",style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:S.description||""}),r.jsx("td",{children:S.parentSubject||""}),r.jsx("td",{children:I(S.activityType,"type")}),r.jsx("td",{children:I(S.activityStatus,"status")}),r.jsx("td",{children:Xr(S.plannedStartAt)}),r.jsx("td",{children:Xr(S.plannedEndAt)}),r.jsx("td",{children:Xr(S.createdAt)})]},k))})]})}),v.open&&r.jsxs("div",{className:"context-menu",style:{left:v.x+6,top:v.y+6,maxWidth:720,padding:10,fontSize:10},onClick:S=>S.stopPropagation(),children:[r.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"상위활동"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:8},children:[v.parent&&r.jsx("div",{className:"card",style:{padding:8},children:r.jsx("div",{style:{overflowX:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%",fontSize:10},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"제목"}),r.jsx("th",{children:"활동설명"}),r.jsx("th",{children:"활동유형"}),r.jsx("th",{children:"활동방법"}),r.jsx("th",{children:"상태"}),r.jsx("th",{children:"거래처명"}),r.jsx("th",{children:"계획 일시"}),r.jsx("th",{children:"종료 일시"})]})}),r.jsx("tbody",{children:r.jsxs("tr",{children:[r.jsx("td",{children:v.parent.subject||""}),r.jsx("td",{style:{whiteSpace:"pre-wrap",maxWidth:360},children:v.parent.description||""}),r.jsx("td",{children:I(v.parent.activityType,"type")}),r.jsx("td",{children:I(v.parent.channel,"channel")}),r.jsx("td",{children:I(v.parent.activityStatus,"status")}),r.jsx("td",{children:v.parent.customerName||""}),r.jsx("td",{children:Xr(v.parent.plannedStartAt)}),r.jsx("td",{children:Xr(v.parent.plannedEndAt)})]})})]})})}),r.jsxs("div",{className:"card",style:{padding:8},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"관련활동"}),v.siblings&&v.siblings.length>0?r.jsxs("table",{className:"table",style:{width:"100%",fontSize:10},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:240},children:"제목"}),r.jsx("th",{style:{width:120},children:"활동유형"}),r.jsx("th",{style:{width:120},children:"활동방법"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:180},children:"계획 일시"}),r.jsx("th",{style:{width:180},children:"종료 일시"})]})}),r.jsx("tbody",{children:v.siblings.map((S,k)=>r.jsxs("tr",{onClick:()=>{x(S),A({open:!1,x:0,y:0})},children:[r.jsx("td",{children:S.subject||""}),r.jsx("td",{children:I(S.activityType,"type")}),r.jsx("td",{children:I(S.channel,"channel")}),r.jsx("td",{children:I(S.activityStatus,"status")}),r.jsx("td",{children:Xr(S.plannedStartAt)}),r.jsx("td",{children:Xr(S.plannedEndAt)})]},k))})]}):r.jsx("div",{className:"muted",children:"하위 활동이 없습니다"})]})]})]})]})},[e,l,y,v]);return r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("input",{value:f,onChange:E=>h(E.target.value),onKeyDown:E=>{E.key==="Enter"&&!i&&C()},placeholder:"거래처명 입력",style:{width:220,height:28,padding:"6px 8px",borderRadius:6,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12}}),r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginLeft:8},children:[r.jsx("label",{className:"muted",style:{fontSize:12},children:"상태"}),r.jsxs("select",{value:b,onChange:E=>j(E.target.value),style:{minWidth:140,height:28,padding:"4px 8px",borderRadius:8,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12},children:[r.jsx("option",{value:"",children:"전체"}),m.map(E=>r.jsx("option",{value:E,children:I(E,"status")},E))]})]}),r.jsx("button",{className:"btn",onClick:C,disabled:i,children:i?"조회중…":"조회"}),r.jsx("button",{className:"btn",onClick:_,disabled:!0,title:"준비중 기능",style:{marginLeft:8,opacity:.6,cursor:"not-allowed"},children:zt.action.addToPlan}),a&&r.jsx("span",{className:"error",children:a||zt.errorGeneric}),d&&r.jsx("span",{className:"muted",children:d}),r.jsx("div",{style:{flex:1}}),r.jsxs("div",{className:"muted count-text",children:["총 ",e.length,"건",l.size?` · 선택 ${l.size}건`:""]})]}),r.jsx("div",{style:{marginTop:12},children:O}),r.jsx(xH,{activity:y})]})}function bH(){return r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",children:[r.jsx("h2",{children:"Complaint"}),r.jsx("div",{className:"meta",children:"준비 중"})]}),r.jsx("div",{className:"empty-state",children:"Complaint 기능은 추후 제공될 예정입니다."})]})}function jH({compact:e=!1,maxHeight:n}){const[i,s]=p.useState([]),[a,o]=p.useState(!1),[l,c]=p.useState(null),[d,u]=p.useState({open:!1,x:0,y:0}),[f,h]=p.useState(()=>{try{const j=localStorage.getItem("tnt.sales.selectedInquiry");if(j){const y=JSON.parse(j),x=Number(y==null?void 0:y.id);return Number.isFinite(x)?x:null}}catch{}return null});async function m(j){c(null),o(!0);try{let y=null;try{const v=await fetch("/api/v1/inquiries");v.ok&&(y=await v.json())}catch{}let x=[];if(Array.isArray(y)?x=y.map((v,A)=>({id:Number((v==null?void 0:v.id)??A+1),title:(v==null?void 0:v.title)!=null?String(v.title):"",customerSeq:(v==null?void 0:v.customerSeq)!=null?Number(v.customerSeq):(v==null?void 0:v.customer_seq)!=null?Number(v.customer_seq):null,customerName:(v==null?void 0:v.customerName)??(v==null?void 0:v.customer_name)??null,inquiryStatus:(v==null?void 0:v.inquiryStatus)??(v==null?void 0:v.inquiry_status)??(v==null?void 0:v.status)??"",assigneeSeq:(v==null?void 0:v.assigneeSeq)!=null?Number(v.assigneeSeq):(v==null?void 0:v.assignee_seq)!=null?Number(v.assignee_seq):null,assigneeName:(v==null?void 0:v.assigneeName)??(v==null?void 0:v.assignee_name)??null,assigneeId:(v==null?void 0:v.assigneeId)??(v==null?void 0:v.assignee_id)??null,openedAt:(v==null?void 0:v.openedAt)??(v==null?void 0:v.opened_at)??"",updatedAt:(v==null?void 0:v.updatedAt)??(v==null?void 0:v.updated_at)??"",inquiryCategory:(v==null?void 0:v.inquiryCategory)??(v==null?void 0:v.inquiry_category)??"",ownerSeq:(v==null?void 0:v.ownerSeq)!=null?Number(v.ownerSeq):(v==null?void 0:v.owner_seq)!=null?Number(v.owner_seq):null,ownerName:(v==null?void 0:v.ownerName)??(v==null?void 0:v.owner_name)??null,channel:(v==null?void 0:v.channel)??"",contactSeq:(v==null?void 0:v.contactSeq)!=null?Number(v.contactSeq):(v==null?void 0:v.contact_seq)!=null?Number(v.contact_seq):null,contactName:(v==null?void 0:v.contactName)??(v==null?void 0:v.contact_name)??null,leadId:(v==null?void 0:v.leadId)??"",severity:(v==null?void 0:v.severity)??"",closedAt:(v==null?void 0:v.closedAt)??(v==null?void 0:v.closed_at)??"",inquiryContent:(v==null?void 0:v.inquiryContent)??(v==null?void 0:v.inquiry_content)??"",answerContent:(v==null?void 0:v.answerContent)??(v==null?void 0:v.answer_content)??""})):x=[],x.sort((v,A)=>{const N=v.updatedAt?Date.parse(v.updatedAt):0,C=A.updatedAt?Date.parse(A.updatedAt):0;return C!==N?C-N:(v.title||"").localeCompare(A.title||"","ko",{sensitivity:"base"})}),s(x),j!=null){const v=x.find(A=>A.id===j);if(v){g(v);return}}x.length>0&&f==null&&g(x[0])}catch(y){c((y==null?void 0:y.message)||"조회 중 오류가 발생했습니다")}finally{o(!1)}}p.useEffect(()=>{m()},[]),p.useEffect(()=>{const j=y=>{var v;const x=((v=y==null?void 0:y.detail)==null?void 0:v.focusId)!=null?Number(y.detail.focusId):null;m(x)};return window.addEventListener("tnt.sales.inquiry.reload",j),()=>window.removeEventListener("tnt.sales.inquiry.reload",j)},[]);function g(j){h(j.id);try{localStorage.setItem("tnt.sales.selectedInquiry",JSON.stringify(j)),window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.selected",{detail:{inquiry:j}}))}catch{}}return p.useMemo(()=>r.jsxs("div",{className:"table-container",style:{height:n??(e?"32vh":void 0),maxHeight:n??(e?"32vh":void 0)},children:[i.length===0?r.jsx("div",{className:"empty-state",children:a?"불러오는 중…":l||"데이터가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"제목"}),r.jsx("th",{style:{width:200},children:"거래처명"}),r.jsx("th",{style:{width:120},children:"문의유형"}),r.jsx("th",{style:{width:120},children:"접수자"}),r.jsx("th",{style:{width:120},children:"당사담당자"}),r.jsx("th",{style:{width:160},children:"접수시간"})]})}),r.jsx("tbody",{children:i.map((j,y)=>{const x=(()=>{if(String(j.inquiryStatus||"").trim()==="완료")return!1;const A=j.openedAt?Date.parse(j.openedAt):NaN;return Number.isFinite(A)?A<=Date.now()-864e5:!1})();return r.jsxs("tr",{className:f===j.id?"selected":void 0,onClick:()=>g(j),onMouseEnter:v=>u({open:!0,x:v.clientX+8,y:v.clientY+8,row:j}),onMouseMove:v=>u(A=>({...A,x:v.clientX+8,y:v.clientY+8})),onMouseLeave:()=>u({open:!1,x:0,y:0}),style:x?{color:"#ef4444"}:void 0,children:[r.jsx("td",{children:j.title||""}),r.jsx("td",{children:j.customerName||(j.customerSeq!=null?String(j.customerSeq):"")}),r.jsx("td",{children:j.inquiryCategory||""}),r.jsx("td",{children:j.ownerName||(j.ownerSeq!=null?String(j.ownerSeq):"")}),r.jsx("td",{children:j.assigneeName||(j.assigneeSeq!=null?String(j.assigneeSeq):"")}),r.jsx("td",{children:j.openedAt?(()=>{const v=new Date(j.openedAt);if(isNaN(v.getTime()))return j.openedAt;const A=String(v.getFullYear()%100).padStart(2,"0"),N=String(v.getMonth()+1).padStart(2,"0"),C=String(v.getDate()).padStart(2,"0"),w=String(v.getHours()).padStart(2,"0"),_=String(v.getMinutes()).padStart(2,"0");return`${A}-${N}-${C} ${w}:${_}`})():""})]},y)})})]}),d.open&&d.row&&r.jsxs("div",{role:"dialog","aria-label":"문의 상세",style:{position:"fixed",left:Math.min(d.x,(typeof window<"u"?window.innerWidth:1200)-420),top:Math.min(d.y,(typeof window<"u"?window.innerHeight:800)-320),zIndex:9999,maxWidth:400,background:"var(--panel)",color:"var(--text)",border:"1px solid var(--border)",borderRadius:10,boxShadow:"0 12px 28px rgba(0,0,0,.25)",padding:10,fontSize:12,lineHeight:1.4,pointerEvents:"none"},children:[r.jsx("div",{style:{fontWeight:700,marginBottom:6},children:d.row.title||"(문의)"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr",columnGap:8,rowGap:4},children:[r.jsx("span",{className:"muted",children:"거래처"}),r.jsx("span",{children:d.row.customerName||(d.row.customerSeq!=null?String(d.row.customerSeq):"")}),r.jsx("span",{className:"muted",children:"문의유형"}),r.jsx("span",{children:d.row.inquiryCategory||""}),r.jsx("span",{className:"muted",children:"상태"}),r.jsx("span",{children:d.row.inquiryStatus||""}),r.jsx("span",{className:"muted",children:"난이도"}),r.jsx("span",{children:d.row.severity||""}),r.jsx("span",{className:"muted",children:"접수자"}),r.jsx("span",{children:d.row.ownerName||(d.row.ownerSeq!=null?String(d.row.ownerSeq):"")}),r.jsx("span",{className:"muted",children:"당사담당자"}),r.jsx("span",{children:d.row.assigneeName||(d.row.assigneeSeq!=null?String(d.row.assigneeSeq):"")}),r.jsx("span",{className:"muted",children:"리드ID"}),r.jsx("span",{children:d.row.leadId||""}),r.jsx("span",{className:"muted",children:"채널"}),r.jsx("span",{children:d.row.channel||""}),r.jsx("span",{className:"muted",children:"접수시각"}),r.jsx("span",{children:d.row.openedAt?(()=>{const j=new Date(d.row.openedAt);if(isNaN(j.getTime()))return String(d.row.openedAt);const y=String(j.getFullYear()%100).padStart(2,"0"),x=String(j.getMonth()+1).padStart(2,"0"),v=String(j.getDate()).padStart(2,"0"),A=String(j.getHours()).padStart(2,"0"),N=String(j.getMinutes()).padStart(2,"0");return`${y}-${x}-${v} ${A}:${N}`})():""}),r.jsx("span",{className:"muted",children:"종료시각"}),r.jsx("span",{children:d.row.closedAt?(()=>{const j=new Date(d.row.closedAt);if(isNaN(j.getTime()))return String(d.row.closedAt);const y=String(j.getFullYear()%100).padStart(2,"0"),x=String(j.getMonth()+1).padStart(2,"0"),v=String(j.getDate()).padStart(2,"0"),A=String(j.getHours()).padStart(2,"0"),N=String(j.getMinutes()).padStart(2,"0");return`${y}-${x}-${v} ${A}:${N}`})():""}),r.jsx("span",{className:"muted",children:"문의내용"}),r.jsx("span",{style:{whiteSpace:"pre-wrap"},children:d.row.inquiryContent||""}),r.jsx("span",{className:"muted",children:"답변내용"}),r.jsx("span",{style:{whiteSpace:"pre-wrap"},children:d.row.answerContent||""}),r.jsx("span",{className:"muted",children:"수정시각"}),r.jsx("span",{children:d.row.updatedAt?(()=>{const j=new Date(d.row.updatedAt);if(isNaN(j.getTime()))return String(d.row.updatedAt);const y=String(j.getFullYear()%100).padStart(2,"0"),x=String(j.getMonth()+1).padStart(2,"0"),v=String(j.getDate()).padStart(2,"0"),A=String(j.getHours()).padStart(2,"0"),N=String(j.getMinutes()).padStart(2,"0");return`${y}-${x}-${v} ${A}:${N}`})():""}),r.jsx("span",{className:"muted",children:"ID"}),r.jsx("span",{children:d.row.id})]})]})]}),[i,f,a,l,e,n,d])}const wo="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20width='16'%20height='16'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20aria-hidden='true'%3e%3ccircle%20cx='11'%20cy='11'%20r='7'%20/%3e%3cline%20x1='21'%20y1='21'%20x2='16.65'%20y2='16.65'%20/%3e%3c/svg%3e";function zk({open:e,onClose:n,title:i,children:s,footer:a,width:o=380}){return p.useEffect(()=>{if(!e)return;const l=c=>{c.key==="Escape"&&n()};return window.addEventListener("keydown",l,!0),()=>window.removeEventListener("keydown",l,!0)},[e,n]),e?Bh.createPortal(r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:2e3},children:[r.jsx("div",{onClick:n,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"22%",left:"50%",transform:"translateX(-50%)",width:o,maxWidth:"92vw",padding:12},children:[i?r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h3",{style:{margin:0,fontSize:14},children:i})}):null,r.jsx("div",{style:{padding:"4px 2px",fontSize:13},children:s}),r.jsx("div",{className:"controls",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:a})]})]}),document.body):null}function wH({open:e,onClose:n,onSubmit:i}){const[s,a]=p.useState(""),[o,l]=p.useState(""),[c,d]=p.useState(""),[u,f]=p.useState(""),[h,m]=p.useState(""),[g,b]=p.useState(""),[j,y]=p.useState(""),[x,v]=p.useState(!1),[A,N]=p.useState(""),[C,w]=p.useState(""),[_,I]=p.useState(""),[O,E]=p.useState(""),[S,k]=p.useState(""),[D,T]=p.useState(!1),[P,R]=p.useState(""),[Y,X]=p.useState(""),[H,q]=p.useState(!1),[M,L]=p.useState(""),[B,F]=p.useState(""),[te,$]=p.useState(""),[W,U]=p.useState(""),[Z,ee]=p.useState(null),K=p.useRef(null),[ne,pe]=p.useState(!1),[G,ae]=p.useState({left:0,top:0});p.useEffect(()=>{if(e){const re=new Date;re.setMinutes(re.getMinutes()-re.getTimezoneOffset()),L(re.toISOString().slice(0,16)),F(""),a(""),l(""),d(""),f(""),m(""),b(""),y(""),N("");try{const de=localStorage.getItem("tnt.sales.empName")||"",he=localStorage.getItem("tnt.sales.assigneeId")||"";w(de),I(he)}catch{w(""),I("")}E(""),k(""),R(""),X(""),$(""),U(""),pe(!1)}},[e]),p.useEffect(()=>{if(!e)return;const re=de=>{if(de.key==="Escape"){if(x||H||D)return;n()}};return window.addEventListener("keydown",re,!0),()=>window.removeEventListener("keydown",re,!0)},[e,n,x,H,D]),p.useEffect(()=>{if(!Z)return;const re=de=>{de.key==="Escape"&&ee(null)};return window.addEventListener("keydown",re,!0),()=>window.removeEventListener("keydown",re,!0)},[Z]);function ie(re){var ot;re.preventDefault();const de=(ot=K.current)==null?void 0:ot.getBoundingClientRect(),he=re.clientX,oe=re.clientY,V=de?de.left:G.left,Pe=de?de.top:G.top,Ve=ht=>{const vt=ht.clientX-he,Se=ht.clientY-oe;ae({left:V+vt,top:Pe+Se}),pe(!0)},tt=()=>{window.removeEventListener("mousemove",Ve),window.removeEventListener("mouseup",tt)};window.addEventListener("mousemove",Ve),window.addEventListener("mouseup",tt)}if(!e)return null;function J(){const re=(s||"").trim().length>0,de=(o||"").trim().length>0,he=!!(g&&Number(g)),oe=!!(P&&String(P).trim());if(!re){ee("제목을 입력해 주세요.");return}if(!de){ee("상태를 선택해 주세요.");return}if(!(he||oe)){ee("거래처 또는 잠재고객 중 하나를 선택해 주세요.");return}const V={title:s,inquiryStatus:o,severity:c,inquiryCategory:u,channel:h,customerSeq:g?Number(g):null,contactName:A||null,ownerId:_||null,assigneeId:S||null,createdBy:_||null,updatedBy:_||null,leadId:P,openedAt:M||null,closedAt:B||null,inquiryContent:te,answerContent:W};i==null||i(V)}return r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e3},children:[r.jsx("div",{onClick:n,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),r.jsxs("div",{ref:K,className:"card",style:{position:"absolute",zIndex:1001,width:"90%",maxWidth:900,maxHeight:"90%",overflow:"auto",padding:12,left:ne?G.left:"50%",top:ne?G.top:"50%",transform:ne?"none":"translate(-50%, -50%)"},children:[r.jsx("button",{"aria-label":"닫기",onClick:n,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsxs("div",{onMouseDown:ie,style:{display:"flex",alignItems:"center",gap:8,marginBottom:12,cursor:"move"},children:[r.jsx("span",{className:"muted",style:{fontWeight:700},children:"새 문의"}),r.jsx("div",{style:{flex:1,height:1,background:"var(--border)"}})]}),r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"inline-field",children:[r.jsxs("label",{children:["제목",r.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),r.jsx("input",{className:"subject-input",value:s,onChange:re=>a(re.target.value),placeholder:"제목"})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"문의유형"}),r.jsxs("select",{className:"subject-input",value:u,onChange:re=>f(re.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"제품문의",children:"제품문의"}),r.jsx("option",{value:"재고/배송문의",children:"재고/배송문의"}),r.jsx("option",{value:"가격문의",children:"가격문의"}),r.jsx("option",{value:"기타문의",children:"기타문의"})]})]}),r.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"문의내용"}),r.jsx("textarea",{className:"subject-input",value:te,onChange:re=>$(re.target.value),placeholder:"상세 설명",style:{minHeight:120}})]}),r.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"답변내용"}),r.jsx("textarea",{className:"subject-input",value:W,onChange:re=>U(re.target.value),placeholder:"답변/조치",style:{minHeight:120}})]}),r.jsxs("div",{className:"inline-field",children:[r.jsxs("label",{children:["상태",r.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),r.jsxs("select",{className:"subject-input",value:o,onChange:re=>l(re.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"신규접수",children:"신규접수"}),r.jsx("option",{value:"확인 중",children:"확인 중"}),r.jsx("option",{value:"완료",children:"완료"}),r.jsx("option",{value:"보류",children:"보류"})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"난이도"}),r.jsxs("select",{className:"subject-input",value:c,onChange:re=>d(re.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"상",children:"상"}),r.jsx("option",{value:"중",children:"중"}),r.jsx("option",{value:"하",children:"하"})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"접수경로"}),r.jsxs("select",{className:"subject-input",value:h,onChange:re=>m(re.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"전화",children:"전화"}),r.jsx("option",{value:"이메일",children:"이메일"}),r.jsx("option",{value:"고객채널",children:"고객채널"}),r.jsx("option",{value:"직접입력",children:"직접입력"})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"잠재고객"}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("input",{className:"subject-input",type:"text",value:Y,onChange:re=>{X(re.target.value),R("")},placeholder:"잠재고객명",style:{paddingRight:28}}),r.jsx("button",{type:"button","aria-label":"잠재고객 검색",title:"잠재고객 검색",onClick:()=>q(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:r.jsx("img",{src:wo,className:"icon",alt:"검색"})})]}),P&&r.jsxs("div",{className:"muted",style:{fontSize:11,marginTop:4},children:["선택됨: id ",P]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"거래처"}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("input",{className:"subject-input",type:"text",value:j,onChange:re=>{y(re.target.value),b("")},placeholder:"거래처명",style:{paddingRight:28}}),r.jsx("button",{type:"button","aria-label":"거래처 검색",title:"거래처 검색",onClick:()=>v(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:r.jsx("img",{src:wo,className:"icon",alt:"검색"})})]}),g&&r.jsxs("div",{className:"muted",style:{fontSize:11,marginTop:4},children:["선택됨: seq ",g]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"거래처 담당자"}),r.jsx("input",{className:"subject-input",type:"text",value:A,onChange:re=>N(re.target.value),placeholder:"이름"})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"접수자"}),r.jsx("input",{className:"subject-input",value:C,readOnly:!0,title:"로그인 사용자"})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"당사 담당자"}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("input",{className:"subject-input",type:"text",value:O,onChange:re=>{E(re.target.value),k("")},placeholder:"이름",style:{paddingRight:28}}),r.jsx("button",{type:"button","aria-label":"직원 검색",title:"직원 검색",onClick:()=>T(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:r.jsx("img",{src:wo,className:"icon",alt:"검색"})})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"접수시각"}),r.jsx("input",{className:"subject-input",type:"datetime-local",value:M,onChange:re=>L(re.target.value)})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"종료시각"}),r.jsx("input",{className:"subject-input",type:"datetime-local",value:B,onChange:re=>F(re.target.value)})]})]}),r.jsxs("div",{className:"controls",style:{gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{className:"btn",onClick:J,children:"저장"}),r.jsx("button",{className:"btn",onClick:n,children:"취소"})]})]}),x&&r.jsx(SH,{defaultQuery:j,onClose:()=>v(!1),onSelect:re=>{b(re.customerSeq?String(re.customerSeq):""),y(re.customerName||""),v(!1)}}),D&&r.jsx(NH,{defaultQuery:O,onClose:()=>T(!1),onSelect:re=>{k(re.assigneeId||""),E(re.empName||""),T(!1)}}),H&&r.jsx(kH,{defaultQuery:Y,onClose:()=>q(!1),onSelect:re=>{R(re.id!=null?String(re.id):""),X(re.companyName||""),q(!1)}}),r.jsx(zk,{open:!!Z,onClose:()=>ee(null),width:360,footer:r.jsx("button",{className:"btn",onClick:()=>ee(null),children:"확인"}),children:Z})]})}function SH({defaultQuery:e,onClose:n,onSelect:i}){const[s,a]=p.useState(e||""),[o,l]=p.useState([]),[c,d]=p.useState(!1),[u,f]=p.useState(null);async function h(m=!0){d(!0),f(null);try{const g=new URL("/api/v1/customers",window.location.origin);s.trim()&&g.searchParams.set("name",s.trim()),g.searchParams.set("mineOnly","false"),g.searchParams.set("limit","100");const b=await fetch(g.toString());if(!b.ok)throw new Error(`HTTP ${b.status}`);const j=await b.json();if(Array.isArray(j)){const y=j.map(x=>({customerSeq:(x==null?void 0:x.customerSeq)??(x==null?void 0:x.customer_seq)??null,customerId:(x==null?void 0:x.customerId)??(x==null?void 0:x.customer_id)??null,customerName:(x==null?void 0:x.customerName)??(x==null?void 0:x.customer_name)??null,telNo:(x==null?void 0:x.telNo)??(x==null?void 0:x.tel_no)??null,addrProvinceName:(x==null?void 0:x.addrProvinceName)??(x==null?void 0:x.addr_province_name)??null,addrCityName:(x==null?void 0:x.addrCityName)??(x==null?void 0:x.addr_city_name)??null,companyType:(x==null?void 0:x.companyType)??(x==null?void 0:x.company_type)??null,ownerName:(x==null?void 0:x.ownerName)??(x==null?void 0:x.owner_name)??null}));l(y)}else l([])}catch(g){f((g==null?void 0:g.message)||"조회 중 오류가 발생했습니다"),l([])}finally{d(!1)}}return p.useEffect(()=>{h(!0)},[]),p.useEffect(()=>{const m=g=>{g.key==="Escape"&&(g.preventDefault(),n())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[n]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[r.jsx("div",{onClick:n,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[r.jsx("button",{"aria-label":"닫기",onClick:n,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"거래처명",value:s,onChange:m=>a(m.target.value),onKeyDown:m=>{m.key==="Enter"&&h(!0)},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:()=>h(!0),children:"조회"})]}),r.jsx("div",{className:"table-container",style:{height:360},children:o.length===0?r.jsx("div",{className:"empty-state",children:c?"불러오는 중…":u||"결과가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:220},children:"거래처명"}),r.jsx("th",{style:{width:140},children:"회사구분"}),r.jsx("th",{style:{width:140},children:"대표자명"}),r.jsx("th",{style:{width:180},children:"지역"})]})}),r.jsx("tbody",{children:o.map((m,g)=>r.jsxs("tr",{onDoubleClick:()=>i(m),onClick:()=>i(m),children:[r.jsx("td",{children:m.customerName||""}),r.jsx("td",{children:m.companyType||""}),r.jsx("td",{children:m.ownerName||""}),r.jsx("td",{children:[m.addrProvinceName,m.addrCityName].filter(Boolean).join(" ")})]},g))})]})})]})]})}function kH({defaultQuery:e,onClose:n,onSelect:i}){const[s,a]=p.useState(e||""),[o,l]=p.useState([]),[c,d]=p.useState(!1),[u,f]=p.useState(null);async function h(m=!0){d(!0),f(null);try{const g=new URL("/api/v1/leads",window.location.origin);s.trim()&&g.searchParams.set("company_name",s.trim()),g.searchParams.set("limit","100");const b=await fetch(g.toString());if(!b.ok)throw new Error(`HTTP ${b.status}`);const j=await b.json();if(Array.isArray(j)){const y=j.map(x=>({id:(x==null?void 0:x.id)!=null?Number(x.id):null,companyName:(x==null?void 0:x.company_name)??null,leadStatus:(x==null?void 0:x.lead_status)??null,ownerName:(x==null?void 0:x.owner_name)??null,addrProvinceName:(x==null?void 0:x.addr_province_name)??null}));l(y)}else l([])}catch(g){f((g==null?void 0:g.message)||"조회 중 오류가 발생했습니다"),l([])}finally{d(!1)}}return p.useEffect(()=>{h(!0)},[]),p.useEffect(()=>{const m=g=>{g.key==="Escape"&&(g.preventDefault(),n())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[n]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[r.jsx("div",{onClick:n,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[r.jsx("button",{"aria-label":"닫기",onClick:n,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"잠재고객명",value:s,onChange:m=>a(m.target.value),onKeyDown:m=>{m.key==="Enter"&&h(!0)},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:()=>h(!0),children:"조회"})]}),r.jsx("div",{className:"table-container",style:{height:360},children:o.length===0?r.jsx("div",{className:"empty-state",children:c?"불러오는 중…":u||"결과가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:220},children:"잠재고객명"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:140},children:"소유자"}),r.jsx("th",{style:{width:160},children:"지역"})]})}),r.jsx("tbody",{children:o.map((m,g)=>r.jsxs("tr",{onDoubleClick:()=>i(m),onClick:()=>i(m),children:[r.jsx("td",{children:m.companyName||""}),r.jsx("td",{children:m.leadStatus||""}),r.jsx("td",{children:m.ownerName||""}),r.jsx("td",{children:m.addrProvinceName||""})]},g))})]})})]})]})}function NH({defaultQuery:e,onClose:n,onSelect:i}){const[s,a]=p.useState(e||""),[o,l]=p.useState([]),[c,d]=p.useState(!1),[u,f]=p.useState(null);async function h(){d(!0),f(null);try{const m=new URL("/api/v1/employees",window.location.origin);m.searchParams.set("depts","all");const g=await fetch(m.toString());if(!g.ok)throw new Error(`HTTP ${g.status}`);const b=await g.json(),j=Array.isArray(b)?b.map(v=>({empId:(v==null?void 0:v.emp_id)??null,empName:(v==null?void 0:v.emp_name)??null,deptName:(v==null?void 0:v.dept_name)??null,assigneeId:(v==null?void 0:v.assignee_id)??null})):[],y=s.trim().toLowerCase(),x=(y?j.filter(v=>(v.empName||"").toLowerCase().includes(y)||(v.empId||"").toLowerCase().includes(y)||(v.deptName||"").toLowerCase().includes(y)):j).sort((v,A)=>(v.empName||"").localeCompare(A.empName||"","ko",{sensitivity:"base"}));l(x)}catch(m){f((m==null?void 0:m.message)||"조회 실패"),l([])}finally{d(!1)}}return p.useEffect(()=>{h()},[]),p.useEffect(()=>{const m=g=>{g.key==="Escape"&&(g.preventDefault(),n())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[n]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[r.jsx("div",{onClick:n,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:700,maxHeight:"80%",overflow:"auto",padding:12},children:[r.jsx("button",{"aria-label":"닫기",onClick:n,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"이름/사번/부서",value:s,onChange:m=>a(m.target.value),onKeyDown:m=>{m.key==="Enter"&&h()},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:h,children:"조회"})]}),r.jsx("div",{className:"table-container",style:{height:320},children:o.length===0?r.jsx("div",{className:"empty-state",children:c?"불러오는 중…":u||"결과가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:160},children:"이름"}),r.jsx("th",{style:{width:160},children:"부서"}),r.jsx("th",{style:{width:140},children:"사번"}),r.jsx("th",{style:{width:140},children:"assignee_id"})]})}),r.jsx("tbody",{children:o.map((m,g)=>r.jsxs("tr",{onDoubleClick:()=>i(m),onClick:()=>i(m),children:[r.jsx("td",{children:m.empName||""}),r.jsx("td",{children:m.deptName||""}),r.jsx("td",{children:m.empId||""}),r.jsx("td",{children:m.assigneeId||""})]},g))})]})})]})]})}function _H(){const[e,n]=p.useState(()=>{try{const S=localStorage.getItem("tnt.sales.selectedInquiry");return S?JSON.parse(S):null}catch{return null}});p.useEffect(()=>{const S=()=>{try{const k=localStorage.getItem("tnt.sales.selectedInquiry");n(k?JSON.parse(k):null)}catch{n(null)}};return window.addEventListener("tnt.sales.inquiry.selected",S),()=>window.removeEventListener("tnt.sales.inquiry.selected",S)},[]);const[i,s]=p.useState(null),[a,o]=p.useState(null),[l,c]=p.useState(!1),[d,u]=p.useState(null);p.useEffect(()=>{if(!a)return;const S=k=>{k.key==="Escape"&&o(null)};return window.addEventListener("keydown",S,!0),()=>window.removeEventListener("keydown",S,!0)},[a]),p.useEffect(()=>{if(!l)return;const S=k=>{k.key==="Escape"&&c(!1)};return window.addEventListener("keydown",S,!0),()=>window.removeEventListener("keydown",S,!0)},[l]),p.useEffect(()=>{if(!d)return;const S=k=>{k.key==="Escape"&&u(null)};return window.addEventListener("keydown",S,!0),()=>window.removeEventListener("keydown",S,!0)},[d]);const f=S=>{if(!S)return"";try{const k=new Date(S);if(isNaN(k.getTime()))return"";const D=String(k.getFullYear()),T=String(k.getMonth()+1).padStart(2,"0"),P=String(k.getDate()).padStart(2,"0"),R=String(k.getHours()).padStart(2,"0"),Y=String(k.getMinutes()).padStart(2,"0");return`${D}-${T}-${P}T${R}:${Y}`}catch{return""}},[h,m]=p.useState({}),[g,b]=p.useState(!1),[j,y]=p.useState(!1),[x,v]=p.useState(!1);p.useEffect(()=>{if(!e){m({});return}const S=typeof window<"u"&&localStorage.getItem("tnt.sales.empName")||"",k=typeof window<"u"&&localStorage.getItem("tnt.sales.assigneeId")||"";m({title:e.title||"",inquiryCategory:e.inquiryCategory||"",inquiryContent:e.inquiryContent||"",answerContent:e.answerContent||"",inquiryStatus:e.inquiryStatus||"",severity:e.severity||"",channel:e.channel||"",leadId:e.leadId||"",leadName:"",customerSeq:e.customerSeq!=null?String(e.customerSeq):"",customerName:e.customerName||"",contactName:e.contactName||"",ownerName:S,ownerId:k,assigneeName:e.assigneeName||"",assigneeId:e.assigneeId||"",openedAt:f(e.openedAt),closedAt:f(e.closedAt)})},[e]),p.useEffect(()=>{const S=h.leadId;if(!S||h.leadName)return;let k=!1;return(async()=>{try{const D=await fetch(`/api/v1/leads/${encodeURIComponent(String(S))}`);if(!D.ok)return;const T=await D.json().catch(()=>null);!k&&T&&m(P=>({...P,leadName:T.company_name||P.leadName||""}))}catch{}})(),()=>{k=!0}},[h.leadId,h.leadName]);function A(S,k){m(D=>({...D,[S]:k}))}async function N(){if(!(e!=null&&e.id))return;const S=(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||""}catch{return""}})(),k=String(h.title||"").trim().length>0,D=String(h.inquiryStatus||"").trim().length>0,T=!!(h.customerSeq&&Number(h.customerSeq)),P=!!(h.leadId&&String(h.leadId).trim());if(!k){o("제목을 입력해 주세요.");return}if(!D){o("상태를 선택해 주세요.");return}if(!(T||P)){o("거래처 또는 잠재고객 중 하나를 선택해 주세요.");return}const R={title:h.title,inquiryCategory:h.inquiryCategory,inquiryContent:h.inquiryContent,answerContent:h.answerContent,inquiryStatus:h.inquiryStatus,severity:h.severity,channel:h.channel,leadId:h.leadId,customerSeq:h.customerSeq?Number(h.customerSeq):null,contactName:h.contactName||null,ownerId:h.ownerId||null,assigneeId:h.assigneeId||null,updatedBy:S||h.ownerId||null,openedAt:h.openedAt||null,closedAt:h.closedAt||null};try{const Y=await fetch(`/api/v1/inquiries/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!Y.ok){const X=await Y.text().catch(()=>"");o("수정 실패: "+(X||Y.status));return}try{s("수정 되었습니다."),window.setTimeout(()=>s(null),3e3)}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.reload",{detail:{focusId:e.id}}))}catch{}}catch{alert("수정 중 오류가 발생했습니다")}}const C=p.useMemo(()=>r.jsx("div",{className:"card",style:{padding:12},children:e?r.jsxs(r.Fragment,{children:[r.jsxs("div",{className:"form-grid",children:[r.jsxs("div",{className:"inline-field",children:[r.jsxs("label",{children:["제목",r.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),r.jsx("input",{className:"subject-input",value:h.title||"",onChange:S=>A("title",S.target.value)})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"문의유형"}),r.jsxs("select",{className:"subject-input",value:h.inquiryCategory||"",onChange:S=>A("inquiryCategory",S.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"제품문의",children:"제품문의"}),r.jsx("option",{value:"재고/배송문의",children:"재고/배송문의"}),r.jsx("option",{value:"가격문의",children:"가격문의"}),r.jsx("option",{value:"기타문의",children:"기타문의"})]})]}),r.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"문의내용"}),r.jsx("textarea",{className:"subject-input",value:h.inquiryContent||"",onChange:S=>A("inquiryContent",S.target.value),style:{minHeight:80}})]}),r.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"답변내용"}),r.jsx("textarea",{className:"subject-input",value:h.answerContent||"",onChange:S=>A("answerContent",S.target.value),style:{minHeight:80}})]}),r.jsxs("div",{className:"inline-field",children:[r.jsxs("label",{children:["상태",r.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),r.jsxs("select",{className:"subject-input",value:h.inquiryStatus||"",onChange:S=>A("inquiryStatus",S.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"신규접수",children:"신규접수"}),r.jsx("option",{value:"확인 중",children:"확인 중"}),r.jsx("option",{value:"완료",children:"완료"}),r.jsx("option",{value:"보류",children:"보류"})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"난이도"}),r.jsxs("select",{className:"subject-input",value:h.severity||"",onChange:S=>A("severity",S.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"상",children:"상"}),r.jsx("option",{value:"중",children:"중"}),r.jsx("option",{value:"하",children:"하"})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"접수경로"}),r.jsxs("select",{className:"subject-input",value:h.channel||"",onChange:S=>A("channel",S.target.value),children:[r.jsx("option",{value:"",children:"선택"}),r.jsx("option",{value:"전화",children:"전화"}),r.jsx("option",{value:"이메일",children:"이메일"}),r.jsx("option",{value:"고객채널",children:"고객채널"}),r.jsx("option",{value:"직접입력",children:"직접입력"})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"잠재고객"}),r.jsx("input",{className:"subject-input",value:h.leadName||"",readOnly:!0,placeholder:"-"})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"거래처"}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("input",{className:"subject-input",value:h.customerName||"",onChange:S=>{A("customerName",S.target.value),A("customerSeq","")},placeholder:"거래처명",style:{paddingRight:28}}),r.jsx("button",{type:"button","aria-label":"거래처 검색",title:"거래처 검색",onClick:()=>b(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:r.jsx("img",{src:wo,className:"icon",alt:"검색"})})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"거래처 담당자"}),r.jsx("input",{className:"subject-input",value:h.contactName||"",onChange:S=>A("contactName",S.target.value),placeholder:"이름"})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"접수자"}),r.jsx("input",{className:"subject-input",value:h.ownerName||"",readOnly:!0,title:"로그인 사용자"})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"당사 담당자"}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("input",{className:"subject-input",value:h.assigneeName||"",onChange:S=>{A("assigneeName",S.target.value),A("assigneeId","")},placeholder:"이름",style:{paddingRight:28}}),r.jsx("button",{type:"button","aria-label":"직원 검색",title:"직원 검색",onClick:()=>v(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:r.jsx("img",{src:wo,className:"icon",alt:"검색"})})]})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"접수시각"}),r.jsx("input",{className:"subject-input",type:"datetime-local",value:h.openedAt||"",onChange:S=>A("openedAt",S.target.value)})]}),r.jsxs("div",{className:"inline-field",children:[r.jsx("label",{children:"종료시각"}),r.jsx("input",{className:"subject-input",type:"datetime-local",value:h.closedAt||"",onChange:S=>A("closedAt",S.target.value)})]})]}),r.jsxs("div",{className:"controls",style:{gap:8,justifyContent:"flex-end",alignItems:"center"},children:[i&&r.jsx("span",{className:"success",children:i}),r.jsx("button",{className:"btn",onClick:N,children:"저장"}),r.jsx("button",{className:"btn",onClick:E,children:"삭제"})]})]}):r.jsx("div",{className:"empty-state",children:"선택된 케이스가 없습니다."})}),[e,h,i]),[w,_]=p.useState(!1);async function I(S){try{const k=await fetch("/api/v1/inquiries",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)});if(!k.ok){const P=await k.text().catch(()=>"");alert("저장 실패: "+(P||k.status));return}const D=await k.json().catch(()=>null),T=D&&D.id!=null?Number(D.id):null;_(!1);try{window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.reload",{detail:{focusId:T}}))}catch{}}catch{alert("저장 중 오류가 발생했습니다")}}async function O(){try{const S=await fetch(`/api/v1/inquiries/${e.id}`,{method:"DELETE"});if(!S.ok){const k=await S.text().catch(()=>"");o("삭제 실패: "+(k||S.status));return}try{localStorage.removeItem("tnt.sales.selectedInquiry")}catch{}n(null),u("삭제 되었습니다.");try{window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.reload",{detail:{}}))}catch{}}catch{o("삭제 중 오류가 발생했습니다")}}async function E(){e!=null&&e.id&&c(!0)}return r.jsxs(r.Fragment,{children:[r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,minWidth:0,flex:"1 1 auto"},children:[r.jsx("h2",{style:{margin:0},children:"문의"}),(()=>{const S=["신규접수","확인 중","완료"],k=String(h.inquiryStatus||"").trim(),D=k==="보류";let T=S.indexOf(k);D&&(T=1),T<0&&(T=0);const P=Math.max(0,Math.min(100,Math.round(T/Math.max(1,S.length-1)*100)));return r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,flex:"0 1 520px"},children:[r.jsx("div",{className:"progress",style:{width:"min(520px, 48vw)"},children:r.jsx("div",{className:"progress-bar",style:{width:`${P}%`,background:D?"#ef4444":"var(--accent)"}})}),r.jsx("div",{style:{display:"flex",justifyContent:"space-between",width:"min(520px, 48vw)",fontSize:11,color:"var(--muted)"},children:S.map(R=>r.jsx("span",{style:{fontWeight:k===R?700:400},children:R},R))})]})})()]}),r.jsx("div",{className:"controls",style:{gap:8},children:r.jsx("button",{className:"btn",onClick:()=>_(!0),children:"신규 등록"})})]}),g&&r.jsx(CH,{defaultQuery:h.customerName,onClose:()=>b(!1),onSelect:S=>{A("customerSeq",S.customerSeq?String(S.customerSeq):""),A("customerName",S.customerName||""),b(!1)}}),j&&r.jsx(AH,{defaultQuery:h.leadName,onClose:()=>y(!1),onSelect:S=>{A("leadId",S.id!=null?String(S.id):""),A("leadName",S.companyName||""),y(!1)}}),x&&r.jsx(IH,{defaultQuery:h.assigneeName,onClose:()=>v(!1),onSelect:S=>{A("assigneeId",S.assigneeId||""),A("assigneeName",S.empName||""),v(!1)}}),r.jsx(jH,{compact:!0,maxHeight:"21vh"}),r.jsx("section",{className:"card",style:{marginTop:12,minHeight:240},children:C})]}),r.jsx(wH,{open:w,onClose:()=>_(!1),onSubmit:I}),r.jsx(zk,{open:!!a,onClose:()=>o(null),width:380,footer:r.jsx("button",{className:"btn",onClick:()=>o(null),children:"확인"}),children:a}),l&&r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:90},children:[r.jsx("div",{onClick:()=>c(!1),style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"24%",left:"50%",transform:"translateX(-50%)",width:380,maxWidth:"92vw",padding:12},children:[r.jsx("div",{style:{padding:"4px 2px",fontSize:13},children:"선택한 문의를 삭제하시겠습니까?"}),r.jsxs("div",{className:"controls",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:[r.jsx("button",{className:"btn",onClick:()=>c(!1),children:"취소"}),r.jsx("button",{className:"btn",onClick:()=>{c(!1),O()},children:"삭제"})]})]})]}),d&&r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:90},children:[r.jsx("div",{onClick:()=>u(null),style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"20%",left:"50%",transform:"translateX(-50%)",width:360,maxWidth:"92vw",padding:12},children:[r.jsx("div",{className:"page-title",style:{marginBottom:8},children:r.jsx("h3",{style:{margin:0,fontSize:14},children:"알림"})}),r.jsx("div",{style:{padding:"4px 2px",fontSize:13},children:d}),r.jsx("div",{className:"controls",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:r.jsx("button",{className:"btn",onClick:()=>u(null),children:"확인"})})]})]})]})}function CH({defaultQuery:e,onClose:n,onSelect:i}){const[s,a]=p.useState(e||""),[o,l]=p.useState([]),[c,d]=p.useState(!1),[u,f]=p.useState(null);async function h(){d(!0),f(null);try{const m=new URL("/api/v1/customers",window.location.origin);s.trim()&&m.searchParams.set("name",s.trim()),m.searchParams.set("mineOnly","false"),m.searchParams.set("limit","100");const g=await fetch(m.toString());if(!g.ok)throw new Error(`HTTP ${g.status}`);const b=await g.json(),j=Array.isArray(b)?b.map(y=>({customerSeq:(y==null?void 0:y.customerSeq)??(y==null?void 0:y.customer_seq)??null,customerId:(y==null?void 0:y.customerId)??(y==null?void 0:y.customer_id)??null,customerName:(y==null?void 0:y.customerName)??(y==null?void 0:y.customer_name)??null,telNo:(y==null?void 0:y.telNo)??(y==null?void 0:y.tel_no)??null,addrProvinceName:(y==null?void 0:y.addrProvinceName)??(y==null?void 0:y.addr_province_name)??null,addrCityName:(y==null?void 0:y.addrCityName)??(y==null?void 0:y.addr_city_name)??null,companyType:(y==null?void 0:y.companyType)??(y==null?void 0:y.company_type)??null,ownerName:(y==null?void 0:y.ownerName)??(y==null?void 0:y.owner_name)??null})):[];l(j)}catch(m){f((m==null?void 0:m.message)||"조회 실패"),l([])}finally{d(!1)}}return p.useEffect(()=>{h()},[]),p.useEffect(()=>{const m=g=>{g.key==="Escape"&&(g.preventDefault(),n())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[n]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[r.jsx("div",{onClick:n,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[r.jsx("button",{"aria-label":"닫기",onClick:n,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"거래처명",value:s,onChange:m=>a(m.target.value),onKeyDown:m=>{m.key==="Enter"&&h()},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:h,children:"조회"})]}),r.jsx("div",{className:"table-container",style:{height:360},children:o.length===0?r.jsx("div",{className:"empty-state",children:c?"불러오는 중…":u||"결과가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:220},children:"거래처명"}),r.jsx("th",{style:{width:140},children:"회사구분"}),r.jsx("th",{style:{width:140},children:"대표자명"}),r.jsx("th",{style:{width:180},children:"지역"})]})}),r.jsx("tbody",{children:o.map((m,g)=>r.jsxs("tr",{onDoubleClick:()=>i(m),onClick:()=>i(m),children:[r.jsx("td",{children:m.customerName||""}),r.jsx("td",{children:m.companyType||""}),r.jsx("td",{children:m.ownerName||""}),r.jsx("td",{children:[m.addrProvinceName,m.addrCityName].filter(Boolean).join(" ")})]},g))})]})})]})]})}function AH({defaultQuery:e,onClose:n,onSelect:i}){const[s,a]=p.useState(e||""),[o,l]=p.useState([]),[c,d]=p.useState(!1),[u,f]=p.useState(null);async function h(){d(!0),f(null);try{const m=new URL("/api/v1/leads",window.location.origin);s.trim()&&m.searchParams.set("company_name",s.trim()),m.searchParams.set("limit","100");const g=await fetch(m.toString());if(!g.ok)throw new Error(`HTTP ${g.status}`);const b=await g.json(),j=Array.isArray(b)?b.map(y=>({id:(y==null?void 0:y.id)!=null?Number(y.id):null,companyName:(y==null?void 0:y.company_name)??null,leadStatus:(y==null?void 0:y.lead_status)??null,ownerName:(y==null?void 0:y.owner_name)??null,addrProvinceName:(y==null?void 0:y.addr_province_name)??null})):[];l(j)}catch(m){f((m==null?void 0:m.message)||"조회 실패"),l([])}finally{d(!1)}}return p.useEffect(()=>{h()},[]),p.useEffect(()=>{const m=g=>{g.key==="Escape"&&(g.preventDefault(),n())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[n]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[r.jsx("div",{onClick:n,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[r.jsx("button",{"aria-label":"닫기",onClick:n,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"잠재고객명",value:s,onChange:m=>a(m.target.value),onKeyDown:m=>{m.key==="Enter"&&h()},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:h,children:"조회"})]}),r.jsx("div",{className:"table-container",style:{height:360},children:o.length===0?r.jsx("div",{className:"empty-state",children:c?"불러오는 중…":u||"결과가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:220},children:"잠재고객명"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:140},children:"소유자"}),r.jsx("th",{style:{width:160},children:"지역"})]})}),r.jsx("tbody",{children:o.map((m,g)=>r.jsxs("tr",{onDoubleClick:()=>i(m),onClick:()=>i(m),children:[r.jsx("td",{children:m.companyName||""}),r.jsx("td",{children:m.leadStatus||""}),r.jsx("td",{children:m.ownerName||""}),r.jsx("td",{children:m.addrProvinceName||""})]},g))})]})})]})]})}function IH({defaultQuery:e,onClose:n,onSelect:i}){const[s,a]=p.useState(e||""),[o,l]=p.useState([]),[c,d]=p.useState(!1),[u,f]=p.useState(null);async function h(){d(!0),f(null);try{const m=new URL("/api/v1/employees",window.location.origin);m.searchParams.set("depts","all");const g=await fetch(m.toString());if(!g.ok)throw new Error(`HTTP ${g.status}`);const b=await g.json(),j=Array.isArray(b)?b.map(v=>({empId:(v==null?void 0:v.emp_id)??null,empName:(v==null?void 0:v.emp_name)??null,deptName:(v==null?void 0:v.dept_name)??null,assigneeId:(v==null?void 0:v.assignee_id)??null})):[],y=s.trim().toLowerCase(),x=(y?j.filter(v=>(v.empName||"").toLowerCase().includes(y)||(v.empId||"").toLowerCase().includes(y)||(v.deptName||"").toLowerCase().includes(y)):j).sort((v,A)=>(v.empName||"").localeCompare(A.empName||"","ko",{sensitivity:"base"}));l(x)}catch(m){f((m==null?void 0:m.message)||"조회 실패"),l([])}finally{d(!1)}}return p.useEffect(()=>{h()},[]),p.useEffect(()=>{const m=g=>{g.key==="Escape"&&(g.preventDefault(),n())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[n]),r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[r.jsx("div",{onClick:n,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:700,maxHeight:"80%",overflow:"auto",padding:12},children:[r.jsx("button",{"aria-label":"닫기",onClick:n,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[r.jsx("input",{className:"subject-input",placeholder:"이름/사번/부서",value:s,onChange:m=>a(m.target.value),onKeyDown:m=>{m.key==="Enter"&&h()},style:{flex:1}}),r.jsx("button",{className:"btn",onClick:h,children:"조회"})]}),r.jsx("div",{className:"table-container",style:{height:320},children:o.length===0?r.jsx("div",{className:"empty-state",children:c?"불러오는 중…":u||"결과가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:160},children:"이름"}),r.jsx("th",{style:{width:160},children:"부서"}),r.jsx("th",{style:{width:140},children:"사번"}),r.jsx("th",{style:{width:140},children:"assignee_id"})]})}),r.jsx("tbody",{children:o.map((m,g)=>r.jsxs("tr",{onDoubleClick:()=>i(m),onClick:()=>i(m),children:[r.jsx("td",{children:m.empName||""}),r.jsx("td",{children:m.deptName||""}),r.jsx("td",{children:m.empId||""}),r.jsx("td",{children:m.assigneeId||""})]},g))})]})})]})]})}function TH({compact:e=!1,maxHeight:n}){const[i,s]=p.useState([]),[a,o]=p.useState(!1),[l,c]=p.useState(null),[d,u]=p.useState(()=>{try{const g=localStorage.getItem("tnt.sales.selectedEstimate");if(g){const b=JSON.parse(g),j=Number(b==null?void 0:b.id);return Number.isFinite(j)?j:null}}catch{}return null});async function f(){c(null),o(!0);try{const g=["/api/v1/estimates","/api/v1/quotes"];let b=null;for(const y of g)try{const x=await fetch(y);if(x.ok){b=await x.json();break}}catch{}let j=[];Array.isArray(b)?j=b.map((y,x)=>({id:Number((y==null?void 0:y.id)??x+1),estimateNumber:String((y==null?void 0:y.estimateNumber)??(y==null?void 0:y.estimate_number)??""),title:String((y==null?void 0:y.title)??""),status:String((y==null?void 0:y.status)??""),owner:String((y==null?void 0:y.owner)??(y==null?void 0:y.ownerId)??(y==null?void 0:y.owner_id)??""),issuedAt:String((y==null?void 0:y.issuedAt)??(y==null?void 0:y.issued_at)??"")})):j=[{id:1,estimateNumber:"E-2025-0001",title:"제품 견적 A",status:"draft",owner:"kim",issuedAt:"2025-02-01T10:00:00Z"},{id:2,estimateNumber:"E-2025-0002",title:"서비스 견적 B",status:"sent",owner:"lee",issuedAt:"2025-02-03T11:00:00Z"}],j.sort((y,x)=>(y.title||"").localeCompare(x.title||"","ko",{sensitivity:"base"})),s(j),j.length>0&&d==null&&h(j[0])}catch(g){c((g==null?void 0:g.message)||"조회 중 오류가 발생했습니다")}finally{o(!1)}}p.useEffect(()=>{f()},[]);function h(g){u(g.id);try{localStorage.setItem("tnt.sales.selectedEstimate",JSON.stringify(g)),window.dispatchEvent(new CustomEvent("tnt.sales.estimate.selected",{detail:{estimate:g}}))}catch{}}return p.useMemo(()=>r.jsx("div",{className:"table-container",style:{maxHeight:n??(e?"32vh":void 0)},children:i.length===0?r.jsx("div",{className:"empty-state",children:a?"불러오는 중…":l||"데이터가 없습니다"}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:140},children:"견적번호"}),r.jsx("th",{children:"제목"}),r.jsx("th",{style:{width:120},children:"상태"}),r.jsx("th",{style:{width:140},children:"소유자"}),r.jsx("th",{style:{width:180},children:"발행시각"})]})}),r.jsx("tbody",{children:i.map((g,b)=>r.jsxs("tr",{className:d===g.id?"selected":void 0,onClick:()=>h(g),children:[r.jsx("td",{children:g.estimateNumber||""}),r.jsx("td",{children:g.title||""}),r.jsx("td",{children:g.status||""}),r.jsx("td",{children:g.owner||""}),r.jsx("td",{children:g.issuedAt?(()=>{const j=new Date(g.issuedAt);if(isNaN(j.getTime()))return g.issuedAt;const y=String(j.getFullYear()%100).padStart(2,"0"),x=String(j.getMonth()+1).padStart(2,"0"),v=String(j.getDate()).padStart(2,"0"),A=String(j.getHours()).padStart(2,"0"),N=String(j.getMinutes()).padStart(2,"0");return`${y}-${x}-${v} ${A}:${N}`})():""})]},b))})]})}),[i,d,a,l,e,n])}function EH(){const[e,n]=p.useState(()=>{try{const o=localStorage.getItem("tnt.sales.selectedEstimate");return o?JSON.parse(o):null}catch{return null}});p.useEffect(()=>{const o=()=>{try{const l=localStorage.getItem("tnt.sales.selectedEstimate");n(l?JSON.parse(l):null)}catch{n(null)}};return window.addEventListener("tnt.sales.estimate.selected",o),()=>window.removeEventListener("tnt.sales.estimate.selected",o)},[]);const i=p.useMemo(()=>r.jsx("div",{className:"card",style:{padding:12},children:e?r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"견적번호"}),r.jsx("div",{className:"subject-input",children:e.estimateNumber||""})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"상태"}),r.jsx("div",{className:"subject-input",children:e.status||""})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"제목"}),r.jsx("div",{className:"subject-input",children:e.title||""})]}),r.jsxs("div",{className:"field",children:[r.jsx("label",{children:"소유자"}),r.jsx("div",{className:"subject-input",children:e.owner||""})]})]}):r.jsx("div",{className:"empty-state",children:"선택된 견적이 없습니다."})}),[e]),[s,a]=p.useState("details");return r.jsxs("section",{children:[r.jsx("div",{className:"page-title",children:r.jsx("h2",{children:"견적"})}),r.jsx(TH,{compact:!0,maxHeight:"32vh"}),r.jsxs("section",{className:"card",style:{marginTop:12,minHeight:240},children:[r.jsxs("div",{className:"tabs c360-tabs",children:[r.jsx("button",{className:s==="details"?"tab active":"tab",onClick:()=>a("details"),children:"상세"}),r.jsx("button",{className:s==="items"?"tab active":"tab",onClick:()=>a("items"),children:"품목"}),r.jsx("button",{className:s==="attachments"?"tab active":"tab",onClick:()=>a("attachments"),children:"첨부"})]}),r.jsxs("div",{style:{marginTop:12},children:[s==="details"&&i,s==="items"&&r.jsx("div",{className:"empty-state",children:"견적 품목(추후)"}),s==="attachments"&&r.jsx("div",{className:"empty-state",children:"첨부 파일(추후)"})]})]})]})}function PH(){const[e,n]=p.useState(()=>kg()),[i,s]=p.useState(Iu());p.useEffect(()=>Jk(()=>s(Iu())),[]);function a(o){const l=!Tu(o);Zk(o,l),s(Iu())}return r.jsxs("section",{children:[r.jsx("h1",{children:"설정"}),r.jsx("p",{className:"muted",children:"좌측 메뉴(1, 2 레벨)를 표시/숨김으로 제어합니다. 모든 사용자에게 동일하게 적용됩니다(임시: 로컬 저장소 기반)."}),r.jsx("div",{style:{display:"flex",gap:24,alignItems:"flex-start",marginTop:12},children:r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsx("h3",{style:{margin:"12px 0"},children:"메뉴 표시 설정"}),r.jsx("button",{className:"btn",onClick:()=>n(kg()),children:"메뉴 다시 읽기"})]}),r.jsx("ul",{style:{listStyle:"none",padding:0,margin:0},children:e.map(o=>{var l;return r.jsxs("li",{style:{marginBottom:10},children:[r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{type:"checkbox",checked:Tu(o.key),onChange:()=>a(o.key)}),r.jsx("strong",{children:o.label}),r.jsxs("span",{className:"muted",style:{fontSize:12},children:["(",o.key,")"]})]}),(l=o.children)!=null&&l.length?r.jsx("ul",{style:{listStyle:"none",padding:"6px 0 0 22px",margin:0},children:o.children.map(c=>r.jsx("li",{style:{marginBottom:6},children:r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{type:"checkbox",checked:Tu(c.key),onChange:()=>a(c.key)}),r.jsx("span",{children:c.label}),r.jsxs("span",{className:"muted",style:{fontSize:12},children:["(",c.key,")"]})]})},c.key))}):null]},o.key)})})]})})]})}function OH(){const[e,n]=p.useState(null),[i,s]=p.useState({}),[a,o]=p.useState(null),[l,c]=p.useState({open:!1,text:""}),[d,u]=p.useState([]),f=p.useMemo(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||""}catch{return""}},[]),h=p.useMemo(()=>{try{return localStorage.getItem("tnt.sales.empId")||""}catch{return""}},[]);p.useEffect(()=>{const M=()=>{try{const L=localStorage.getItem("tnt.sales.selectedLead"),B=L?JSON.parse(L):null;n(B),s({...B||{}}),o(null)}catch{n(null),s({}),o(null)}};return window.addEventListener("tnt.sales.lead.selected",M),()=>window.removeEventListener("tnt.sales.lead.selected",M)},[]);function m(M,L){s(B=>({...B,[M]:L})),a&&o(null)}async function g(){if(!(!i||i.id==null))try{const M={...i};delete M.created_by_name,delete M.updated_by_name,delete M.created_at,delete M.updated_at;try{(!i.assignee_id||String(i.assignee_id).trim()==="")&&(delete M.assignee_id,delete M.owner_name,delete M.owner_id)}catch{}try{const F=localStorage.getItem("tnt.sales.assigneeId")||"";F&&(M.updated_by=F)}catch{}const L=await fetch(`/api/v1/leads/${i.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!L.ok)throw new Error(`HTTP ${L.status}`);const B=await L.json().catch(()=>({}));if(B!=null&&B.ok){const F=i.company_name||"";c({open:!0,text:`${F} 수정되었습니다.`});try{const te=await fetch(`/api/v1/leads/${i.id}`),$=te.ok?await te.json():i;s(W=>({...W,...$||{}})),n(W=>({...W||{},...$||{}})),localStorage.setItem("tnt.sales.selectedLead",JSON.stringify($||i)),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:$||i}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:$||i}}))}catch{try{localStorage.setItem("tnt.sales.selectedLead",JSON.stringify(i)),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:i}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:i}}))}catch{}}}else throw new Error("저장 실패")}catch(M){o((M==null?void 0:M.message)||"저장 중 오류가 발생했습니다")}}p.useEffect(()=>{(async()=>{try{const M=await fetch("/api/v1/employees");if(!M.ok)return;const L=await M.json();if(Array.isArray(L)){let B=[...L];if(!B.some(te=>String((te==null?void 0:te.emp_name)||"")==="윤이랑"))try{const te=await fetch("/api/v1/employees?depts=all");if(te.ok){const $=await te.json();if(Array.isArray($)){const W=$.find(U=>String((U==null?void 0:U.emp_name)||"")==="윤이랑");W&&(B=[...B,W])}}}catch{}u(B)}}catch{}})()},[]);const b=!i||i.id==null,[j,y]=p.useState(!1),[x,v]=p.useState(""),[A,N]=p.useState(""),[C,w]=p.useState(!1),[_,I]=p.useState({}),[O,E]=p.useState(!1),{ref:S,style:k,bindHeader:D,bindContainer:T}=tr("lead.tm",j,M=>{const L=document.querySelector(".pane.center"),B=L?L.getBoundingClientRect():null,F=M.getBoundingClientRect(),te=F.width,$=F.height,W=B?B.left+(B.width-te)/2:(window.innerWidth-te)/2,U=Math.max(0,window.innerHeight-$-16),Z=Math.min(Math.max(0,W),window.innerWidth-te),ee=Math.min(Math.max(0,U),window.innerHeight-$);return{x:Z,y:ee}},{persist:!1,resetOnOpen:!0}),{ref:P,style:R,bindHeader:Y,bindContainer:X}=tr("lead.new",C,M=>{const L=document.querySelector(".pane.center"),B=L?L.getBoundingClientRect():null,F=M.getBoundingClientRect(),te=F.width,$=F.height,W=B?B.left+(B.width-te)/2:(window.innerWidth-te)/2,U=Math.max(0,window.innerHeight*.1),Z=Math.min(Math.max(0,W),window.innerWidth-te),ee=Math.min(Math.max(0,U),window.innerHeight-$);return{x:Z,y:ee}},{persist:!1,resetOnOpen:!0});p.useEffect(()=>{if(!C)return;const M=L=>{L.key==="Escape"&&w(!1)};return window.addEventListener("keydown",M,!0),()=>window.removeEventListener("keydown",M,!0)},[C]),p.useEffect(()=>{if(!j)return;const M=L=>{L.key==="Escape"&&y(!1)};return window.addEventListener("keydown",M,!0),()=>window.removeEventListener("keydown",M,!0)},[j]);function H(M){if(!M)return"";const L=new Date(M);return isNaN(L.getTime())?String(M):new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).format(L)}const q=p.useMemo(()=>{const M=["신규등록","접촉 중","영업 접촉 중","전환성공"],L=((i==null?void 0:i.lead_status)||"").trim(),B=L==="자격미달"||L==="전환실패";let F=M.indexOf(L);L==="자격미달"&&(F=1),L==="전환실패"&&(F=M.length-1),F<0&&(F=0);const te=Math.max(0,Math.min(100,Math.round(F/Math.max(1,M.length-1)*100)));return r.jsxs("div",{className:"page-title",children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,minWidth:0,flex:"1 1 auto"},children:[r.jsx("h2",{style:{margin:0},children:"잠재고객"}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,flex:"0 1 520px"},children:[r.jsx("div",{className:"progress",style:{width:"min(520px, 48vw)"},children:r.jsx("div",{className:"progress-bar",style:{width:`${te}%`,background:B?"#ef4444":"var(--accent)"}})}),r.jsx("div",{style:{display:"flex",justifyContent:"space-between",width:"min(520px, 48vw)",fontSize:11,color:"var(--muted)"},children:M.map($=>r.jsx("span",{style:{fontWeight:L===$?700:400},children:$},$))})]})]}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsx("button",{className:"btn",onClick:()=>{I({}),w(!0)},children:"신규"}),r.jsx("button",{className:"btn",onClick:()=>E(!0),disabled:b,children:"영업활동 등록"}),r.jsx("button",{className:"btn",onClick:()=>{y(!0),o(null)},disabled:b,children:"TM활동 등록"})]})]})},[b,i.lead_status]);return r.jsxs("section",{children:[q,r.jsx("div",{className:"card",style:{padding:12},children:i&&i.id!=null?r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",columnGap:10,rowGap:6},children:[r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"상태"}),r.jsxs("select",{className:"search-input",value:i.lead_status||"",onChange:M=>m("lead_status",M.target.value),children:[r.jsx("option",{value:"",children:"(선택)"}),r.jsx("option",{value:"신규등록",children:"신규등록"}),r.jsx("option",{value:"자격미달",children:"자격미달"}),r.jsx("option",{value:"접촉 중",children:"접촉 중"}),r.jsx("option",{value:"영업 접촉 중",children:"영업 접촉 중"}),r.jsx("option",{value:"전환성공",children:"전환성공"}),r.jsx("option",{value:"전환실패",children:"전환실패"})]})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"소스"}),r.jsxs("select",{className:"search-input",value:i.lead_source||"",onChange:M=>m("lead_source",M.target.value),children:[r.jsx("option",{value:"",children:"(선택)"}),r.jsx("option",{value:"목록구매",children:"목록구매"}),r.jsx("option",{value:"내부추천",children:"내부추천"}),r.jsx("option",{value:"외부추천",children:"외부추천"}),r.jsx("option",{value:"전시회/행사",children:"전시회/행사"})]})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"회사"}),r.jsx("input",{className:"search-input",type:"text",value:i.company_name||"",onChange:M=>m("company_name",M.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"거래처 담당자"}),r.jsx("input",{className:"search-input",type:"text",value:i.contact_name||"",onChange:M=>m("contact_name",M.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"이메일"}),r.jsx("input",{className:"search-input",type:"text",value:i.email||"",onChange:M=>m("email",M.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"연락처"}),r.jsx("input",{className:"search-input",type:"text",value:i.contact_phone||"",onChange:M=>m("contact_phone",M.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"대표번호"}),r.jsx("input",{className:"search-input",type:"text",value:i.office_phone||"",onChange:M=>m("office_phone",M.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"업종"}),r.jsxs("select",{className:"search-input",value:i.biz_type||"",onChange:M=>m("biz_type",M.target.value),children:[r.jsx("option",{value:"",children:"(선택)"}),r.jsx("option",{value:"가공",children:"가공"}),r.jsx("option",{value:"시공",children:"시공"}),r.jsx("option",{value:"가시공",children:"가시공"}),r.jsx("option",{value:"유통",children:"유통"}),r.jsx("option",{value:"알수없음",children:"알수없음"})]})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"사업자번호"}),r.jsx("input",{className:"search-input",type:"text",value:i.biz_no||"",onChange:M=>m("biz_no",M.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"지역(도/광역)"}),r.jsx("input",{className:"search-input",type:"text",value:i.addr_province_name||"",onChange:M=>m("addr_province_name",M.target.value)})]}),r.jsxs("div",{className:"field inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"주소"}),r.jsx("input",{className:"search-input",type:"text",value:i.address||"",onChange:M=>m("address",M.target.value)})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"팩스"}),r.jsx("input",{className:"search-input",type:"text",value:i.fax_no||"",onChange:M=>m("fax_no",M.target.value)})]}),r.jsxs("div",{className:"field inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"비고"}),r.jsx("textarea",{className:"search-input",value:i.note||"",onChange:M=>m("note",M.target.value),style:{minHeight:80}})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"소유자"}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsxs("select",{className:"search-input",value:i.assignee_id||"",onChange:M=>m("assignee_id",M.target.value||null),style:{flex:1},children:[r.jsx("option",{value:"",children:"(선택)"}),d.map(M=>r.jsxs("option",{value:M.assignee_id,children:[M.dept_name," · ",M.emp_name]},M.assignee_id))]}),r.jsx("div",{style:{whiteSpace:"nowrap",fontSize:11,color:"var(--muted)"},children:(()=>{const M=i.owner_name&&String(i.owner_name).trim()?String(i.owner_name):"",L=i.assignee_id||"",B=d.find(te=>te.assignee_id===L);return`현재: ${M||(B?B.emp_name:"")||"-"}`})()})]})]}),r.jsxs("div",{className:"field inline-four",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"작성자"}),r.jsxs("div",{className:"subject-input",style:{padding:"6px 8px"},children:[i.created_by_name||(i.created_by??"")||f||h,i.created_at?`, ${H(i.created_at)}`:""]}),r.jsx("label",{children:"최종 수정자"}),r.jsxs("div",{className:"subject-input",style:{padding:"6px 8px"},children:[i.updated_by_name||(i.updated_by??"")||f||h,i.updated_at?`, ${H(i.updated_at)}`:""]})]})]}),r.jsxs("div",{className:"controls",style:{justifyContent:"space-between",marginTop:10,gap:8},children:[r.jsx("div",{"aria-live":"polite",style:{fontSize:12,color:"var(--accent)"},children:a||""}),r.jsx("div",{children:r.jsxs("div",{style:{display:"inline-flex",gap:8},children:[r.jsx("button",{className:"btn",onClick:g,disabled:b,children:"저장"}),b?null:r.jsx("button",{className:"btn btn-danger",onClick:async()=>{if(i!=null&&i.id){`${i.id}`;try{const M=await fetch(`/api/v1/leads/${i.id}`,{method:"DELETE"});if(!M.ok){const L=await M.json().catch(()=>null);throw new Error((L==null?void 0:L.message)||`HTTP ${M.status}`)}c({open:!0,text:"삭제되었습니다."}),s({}),n(null),localStorage.removeItem("tnt.sales.selectedLead"),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:null}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:null}}))}catch(M){o((M==null?void 0:M.message)||"삭제 중 오류가 발생했습니다")}}},children:"삭제"})]})})]})]}):r.jsx("div",{className:"empty-state",children:"우측에서 잠재고객을 선택하세요."})}),j&&r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e4,pointerEvents:"none"},children:[r.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)",pointerEvents:"none"}}),r.jsxs("div",{ref:S,className:"card",style:{...k,width:"min(720px, 92vw)",maxHeight:"80vh",overflow:"auto",padding:16,pointerEvents:"auto"},...T,children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10,cursor:"move"},...D,children:[r.jsx("h3",{style:{margin:0},children:"TM 활동 등록"}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:()=>y(!1),onKeyDown:M=>{(M.key==="Enter"||M.key===" ")&&(M.preventDefault(),y(!1))},children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"제목"}),r.jsx("input",{className:"search-input",type:"text",value:x,onChange:M=>v(M.target.value),placeholder:"제목"})]}),r.jsxs("div",{className:"field inline-field row-2",children:[r.jsx("label",{children:"활동 설명"}),r.jsx("textarea",{className:"search-input",value:A,onChange:M=>N(M.target.value),placeholder:"활동 설명",style:{minHeight:100}})]}),r.jsxs("div",{className:"field inline-field row-2",children:[r.jsx("label",{children:"잠재고객"}),r.jsxs("div",{className:"subject-input",style:{padding:"6px 8px"},children:[i.company_name||"",i.contact_name?` / ${i.contact_name}`:"",i.contact_phone?` / ${i.contact_phone}`:""]})]}),r.jsxs("div",{className:"controls",style:{justifyContent:"flex-end",marginTop:10,gap:8},children:[r.jsx("button",{className:"btn",onClick:()=>y(!1),children:"취소"}),r.jsx("button",{className:"btn",onClick:async()=>{try{const M=localStorage.getItem("tnt.sales.assigneeId")||localStorage.getItem("tnt.sales.empId")||"";if(!M){o("로그인이 필요합니다");return}const L={sfOwnerId:M,subject:x||"",description:A||"",activityType:"전화",activityStatus:"계획",channel:"전화",sfLeadId:(i==null?void 0:i.id)!=null?String(i.id):void 0,createdBy:localStorage.getItem("tnt.sales.empId")||void 0,updatedBy:localStorage.getItem("tnt.sales.empId")||void 0},B=await fetch("/api/v1/sales-activities",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(L)});if(!B.ok){let F=`HTTP ${B.status}`;try{const te=await B.json();te!=null&&te.error&&(F=te.error)}catch{}throw new Error(F)}y(!1),v(""),N("");try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated",{detail:{leadId:i==null?void 0:i.id}}))}catch{}c({open:!0,text:"TM 활동이 등록되었습니다."})}catch(M){o((M==null?void 0:M.message)||"TM 활동 등록 실패")}},children:"저장"})]})]})]}),C&&r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e4,pointerEvents:"none"},children:[r.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)",pointerEvents:"none"}}),r.jsxs("div",{ref:P,className:"card",style:{...R,width:"min(880px, 96vw)",maxHeight:"86vh",overflow:"auto",padding:16,pointerEvents:"auto"},...X,children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10,cursor:"move"},...Y,children:[r.jsx("h3",{style:{margin:0},children:"잠재고객 신규"}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:()=>w(!1),children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",columnGap:10,rowGap:6},children:[r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"상태"}),r.jsxs("select",{className:"search-input",value:_.lead_status||"",onChange:M=>I(L=>({...L,lead_status:M.target.value})),children:[r.jsx("option",{value:"",children:"(선택)"}),r.jsx("option",{value:"신규등록",children:"신규등록"}),r.jsx("option",{value:"자격미달",children:"자격미달"}),r.jsx("option",{value:"접촉 중",children:"접촉 중"}),r.jsx("option",{value:"영업 접촉 중",children:"영업 접촉 중"}),r.jsx("option",{value:"전환성공",children:"전환성공"}),r.jsx("option",{value:"전환실패",children:"전환실패"})]})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"소스"}),r.jsxs("select",{className:"search-input",value:_.lead_source||"",onChange:M=>I(L=>({...L,lead_source:M.target.value})),children:[r.jsx("option",{value:"",children:"(선택)"}),r.jsx("option",{value:"목록구매",children:"목록구매"}),r.jsx("option",{value:"내부추천",children:"내부추천"}),r.jsx("option",{value:"외부추천",children:"외부추천"}),r.jsx("option",{value:"전시회/행사",children:"전시회/행사"})]})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"회사"}),r.jsx("input",{className:"search-input",type:"text",value:_.company_name||"",onChange:M=>I(L=>({...L,company_name:M.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"거래처 담당자"}),r.jsx("input",{className:"search-input",type:"text",value:_.contact_name||"",onChange:M=>I(L=>({...L,contact_name:M.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"이메일"}),r.jsx("input",{className:"search-input",type:"text",value:_.email||"",onChange:M=>I(L=>({...L,email:M.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"연락처"}),r.jsx("input",{className:"search-input",type:"text",value:_.contact_phone||"",onChange:M=>I(L=>({...L,contact_phone:M.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"대표번호"}),r.jsx("input",{className:"search-input",type:"text",value:_.office_phone||"",onChange:M=>I(L=>({...L,office_phone:M.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"업종"}),r.jsxs("select",{className:"search-input",value:_.biz_type||"",onChange:M=>I(L=>({...L,biz_type:M.target.value})),children:[r.jsx("option",{value:"",children:"(선택)"}),r.jsx("option",{value:"가공",children:"가공"}),r.jsx("option",{value:"시공",children:"시공"}),r.jsx("option",{value:"가시공",children:"가시공"}),r.jsx("option",{value:"유통",children:"유통"}),r.jsx("option",{value:"알수없음",children:"알수없음"})]})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"사업자번호"}),r.jsx("input",{className:"search-input",type:"text",value:_.biz_no||"",onChange:M=>I(L=>({...L,biz_no:M.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"지역(도/광역)"}),r.jsx("input",{className:"search-input",type:"text",value:_.addr_province_name||"",onChange:M=>I(L=>({...L,addr_province_name:M.target.value}))})]}),r.jsxs("div",{className:"field inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"주소"}),r.jsx("input",{className:"search-input",type:"text",value:_.address||"",onChange:M=>I(L=>({...L,address:M.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"팩스"}),r.jsx("input",{className:"search-input",type:"text",value:_.fax_no||"",onChange:M=>I(L=>({...L,fax_no:M.target.value}))})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"소유자"}),r.jsxs("select",{className:"search-input",value:_.assignee_id||"",onChange:M=>I(L=>({...L,assignee_id:M.target.value||null})),children:[r.jsx("option",{value:"",children:"(선택)"}),d.map(M=>r.jsxs("option",{value:M.assignee_id,children:[M.dept_name," · ",M.emp_name]},M.assignee_id))]})]}),r.jsxs("div",{className:"field inline-field",style:{gridColumn:"1 / -1"},children:[r.jsx("label",{children:"비고"}),r.jsx("textarea",{className:"search-input",value:_.note||"",onChange:M=>I(L=>({...L,note:M.target.value})),style:{minHeight:80}})]})]}),r.jsxs("div",{className:"controls",style:{justifyContent:"space-between",marginTop:10,gap:8},children:[r.jsx("div",{"aria-live":"polite",style:{fontSize:12,color:"#ef4444"},children:a||""}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("button",{className:"btn",onClick:()=>{w(!1),o(null)},children:"취소"}),r.jsx("button",{className:"btn",onClick:async()=>{try{const M={..._},L=localStorage.getItem("tnt.sales.empId")||void 0;L&&(M.created_by=L,M.updated_by=L);const B=await fetch("/api/v1/leads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)}),F=await B.json().catch(()=>({}));if(!B.ok||F&&F.error)throw new Error((F==null?void 0:F.error)||`HTTP ${B.status}`);const te=F==null?void 0:F.id;if(!te||te===-1)throw new Error("저장 실패: ID를 받지 못했습니다");const $={..._||{},id:te};try{localStorage.setItem("tnt.sales.selectedLead",JSON.stringify($)),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:$}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:$}}))}catch{}w(!1),I({});const W=_.company_name||"";c({open:!0,text:`${W} 신규 생성되었습니다.`})}catch(M){o((M==null?void 0:M.message)||"저장 중 오류가 발생했습니다")}},children:"저장"})]})]})]})]}),r.jsx(U1,{open:O,onClose:()=>E(!1),leadId:(i==null?void 0:i.id)??null,leadName:(i==null?void 0:i.company_name)||""}),l.open?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:l.text}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>c({open:!1,text:""}),children:"확인"})})]})}):null]})}function mf(e){if(!e)return"";const n=e instanceof Date?e:new Date(e);if(isNaN(n.getTime()))return"";const i=String(n.getFullYear()%100).padStart(2,"0"),s=String(n.getMonth()+1).padStart(2,"0"),a=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),l=String(n.getMinutes()).padStart(2,"0");return`${i}-${s}-${a} ${o}:${l}`}function DH({leadId:e}){const[n,i]=p.useState([]),[s,a]=p.useState(!1),[o,l]=p.useState(null),[c,d]=p.useState(()=>({open:!1,x:0,y:0})),[u,f]=p.useState(!1),[h,m]=p.useState(""),[g,b]=p.useState(""),[j,y]=p.useState(null),[x,v]=p.useState({open:!1,text:""});async function A(){if(!e){i([]);return}a(!0),l(null);try{const _=new URL("/api/v1/sales-activities",window.location.origin);_.searchParams.set("mineOnly","false"),_.searchParams.set("sfLeadId",String(e));const I=await fetch(_.toString());if(!I.ok)throw new Error(`HTTP ${I.status}`);const O=await I.json(),E=Array.isArray(O)?O.map(S=>({id:Number(S==null?void 0:S.id),subject:(S==null?void 0:S.subject)??"",description:(S==null?void 0:S.description)??"",activityType:(S==null?void 0:S.activityType)??"",activityStatus:(S==null?void 0:S.activityStatus)??"",channel:(S==null?void 0:S.channel)??"",plannedStartAt:(S==null?void 0:S.plannedStartAt)??null,plannedEndAt:(S==null?void 0:S.plannedEndAt)??null,createdAt:(S==null?void 0:S.createdAt)??null,lastUpdateAt:(S==null?void 0:S.lastUpdateAt)??null,ownerName:(S==null?void 0:S.ownerName)??(S==null?void 0:S.owner_name)??""})):[];i(E)}catch(_){l((_==null?void 0:_.message)||"조회 중 오류가 발생했습니다"),i([])}finally{a(!1)}}p.useEffect(()=>{A()},[e]),p.useEffect(()=>{const _=()=>{A()};return window.addEventListener("tnt.sales.activity.updated",_),()=>window.removeEventListener("tnt.sales.activity.updated",_)},[e]),p.useEffect(()=>{if(!u)return;const _=I=>{I.key==="Escape"&&f(!1)};return window.addEventListener("keydown",_,!0),()=>window.removeEventListener("keydown",_,!0)},[u]),p.useEffect(()=>{u||(N.current=null)},[u]),p.useEffect(()=>{if(!c.open)return;const _=()=>d({open:!1,x:0,y:0}),I=O=>{O.key==="Escape"&&d({open:!1,x:0,y:0})};return window.addEventListener("click",_,!1),window.addEventListener("keydown",I,!0),()=>{window.removeEventListener("click",_,!1),window.removeEventListener("keydown",I,!0)}},[c.open]);const N=p.useRef(null);function C(_){y(_.id),N.current!==_.id&&(m(_.subject||""),b(_.description||""),N.current=_.id),f(!0)}const w=p.useMemo(()=>r.jsxs("div",{className:"table-container",style:{maxHeight:"calc(100vh - 260px)",overflow:"auto"},children:[n.length===0?r.jsx("div",{className:"empty-state",children:s?"불러오는 중…":o||"활동이 없습니다."}):r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:120},children:"담당자"}),r.jsx("th",{style:{width:260},children:"제목"}),r.jsx("th",{children:"활동내역"}),r.jsx("th",{style:{width:150},children:"계획일시"}),r.jsx("th",{style:{width:150},children:"종료 일시"}),r.jsx("th",{style:{width:120},children:"활동유형"}),r.jsx("th",{style:{width:120},children:"활동상태"}),r.jsx("th",{style:{width:180},children:"최종 수정일"})]})}),r.jsx("tbody",{children:n.map(_=>r.jsxs("tr",{onContextMenu:I=>{I.preventDefault(),I.stopPropagation(),d({open:!0,x:I.clientX,y:I.clientY,row:_})},children:[r.jsx("td",{title:_.ownerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:_.ownerName||""}),r.jsx("td",{title:_.subject||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:_.subject||""}),r.jsx("td",{title:_.description||"",style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:_.description||""}),r.jsx("td",{children:mf(_.plannedStartAt)}),r.jsx("td",{children:mf(_.plannedEndAt)}),r.jsx("td",{children:_.activityType||""}),r.jsx("td",{children:_.activityStatus||""}),r.jsx("td",{children:mf(_.lastUpdateAt)})]},_.id))})]}),c.open&&c.row&&r.jsx("div",{className:"context-menu",style:{left:c.x+4,top:c.y+4},onClick:_=>_.stopPropagation(),children:r.jsx("button",{className:"context-item",style:{width:96,padding:"4px 6px"},onClick:_=>{_.preventDefault(),_.stopPropagation(),C(c.row),d({open:!1,x:0,y:0})},children:"수정"})})]}),[n,s,o,c]);return r.jsxs("section",{children:[w,u&&r.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:2e4},children:[r.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)"}}),r.jsxs("div",{className:"card",style:{position:"absolute",left:"50%",top:"20%",transform:"translateX(-50%)",width:"min(720px, 92vw)",maxHeight:"80vh",overflow:"auto",padding:16},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[r.jsx("h3",{style:{margin:0},children:"TM 활동 수정"}),r.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:()=>f(!1),children:r.jsx("img",{src:sn,className:"icon",alt:"닫기"})})]}),r.jsxs("div",{className:"field inline-field",children:[r.jsx("label",{children:"제목"}),r.jsx("input",{className:"search-input",type:"text",value:h,onChange:_=>m(_.target.value),placeholder:"제목"})]}),r.jsxs("div",{className:"field inline-field row-2",children:[r.jsx("label",{children:"활동 설명"}),r.jsx("textarea",{className:"search-input",value:g,onChange:_=>b(_.target.value),placeholder:"활동 설명",style:{minHeight:100}})]}),r.jsxs("div",{className:"controls",style:{justifyContent:"flex-end",marginTop:10,gap:8},children:[r.jsx("button",{className:"btn",onClick:()=>f(!1),children:"취소"}),r.jsx("button",{className:"btn",onClick:async()=>{try{if(!j)return;const _={subject:h||"",description:g||""},I=await fetch(`/api/v1/sales-activities/${j}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(_)});if(!I.ok)throw new Error(`HTTP ${I.status}`);f(!1),v({open:!0,text:`${(h||"").trim()||"(제목없음)"} 변경되었습니다.`});try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated",{detail:{id:j}}))}catch{}}catch{}},children:"저장"})]})]})]}),x.open?r.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[r.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:x.text}),r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>v({open:!1,text:""}),children:"확인"})})]})}):null]})}function zH(){const[e,n]=p.useState(null);return p.useEffect(()=>{try{localStorage.removeItem("tnt.sales.selectedLead")}catch{}const i=()=>{try{const s=localStorage.getItem("tnt.sales.selectedLead");n(s?JSON.parse(s):null)}catch{n(null)}};return window.addEventListener("tnt.sales.lead.selected",i),()=>window.removeEventListener("tnt.sales.lead.selected",i)},[]),r.jsxs("section",{children:[r.jsx(OH,{}),r.jsxs("section",{className:"card",style:{marginTop:12,minHeight:240},children:[r.jsx("div",{className:"tabs c360-tabs",children:r.jsx("button",{className:"tab active",children:"활동"})}),r.jsx("div",{style:{marginTop:12},children:e!=null&&e.id?r.jsx(DH,{leadId:e.id}):r.jsx("div",{style:{minHeight:160}})})]})]})}function MH(e){if(!e)return"-";const n=new Date(e);if(Number.isNaN(n.getTime()))return"-";const i=d=>String(d).padStart(2,"0"),s=i(n.getFullYear()%100),a=i(n.getMonth()+1),o=i(n.getDate()),l=i(n.getHours()),c=i(n.getMinutes());return`${s}-${a}-${o} ${l}:${c}`}function RH(){const[e,n]=p.useState("weekly"),[i,s]=p.useState("owner"),[a,o]=p.useState(""),[l,c]=p.useState(()=>new Date().toISOString().split("T")[0]),[d,u]=p.useState([]),[f,h]=p.useState([]),[m,g]=p.useState(null),[b,j]=p.useState([]),[y,x]=p.useState(null),[v,A]=p.useState(!1),[N,C]=p.useState([]);p.useEffect(()=>{(async()=>{try{const S=await fetch("/api/v1/employees");if(!S.ok)return;const k=await S.json();if(Array.isArray(k)){let D=[...k];if(!D.some(P=>String((P==null?void 0:P.emp_name)||"")==="윤이랑"))try{const P=await fetch("/api/v1/employees?depts=all");if(P.ok){const R=await P.json();if(Array.isArray(R)){const Y=R.find(X=>String((X==null?void 0:X.emp_name)||"")==="윤이랑");Y&&(D=[...D,Y])}}}catch{}C(D)}}catch{}})()},[]);function w(){const S=new Date(l);if(e==="daily"){const k=new Date(S);k.setDate(k.getDate()-1);const D=new Date(S);return D.setDate(D.getDate()+1),[{label:"전일",startDate:k.toISOString().split("T")[0],endDate:k.toISOString().split("T")[0],count:0},{label:"금일",startDate:l,endDate:l,count:0},{label:"익일",startDate:D.toISOString().split("T")[0],endDate:D.toISOString().split("T")[0],count:0}]}else if(e==="weekly"){const k=new Date(S),D=k.getDay(),T=k.getDate()-D+(D===0?-6:1),P=new Date(k.setDate(T)),R=P.toISOString().split("T")[0],Y=new Date(P);Y.setDate(Y.getDate()+6);const X=new Date(P);X.setDate(X.getDate()-7);const H=new Date(X);H.setDate(H.getDate()+6);const q=new Date(P);q.setDate(q.getDate()+7);const M=new Date(q);return M.setDate(M.getDate()+6),[{label:"전주",startDate:X.toISOString().split("T")[0],endDate:H.toISOString().split("T")[0],count:0},{label:"금주",startDate:R,endDate:Y.toISOString().split("T")[0],count:0},{label:"차주",startDate:q.toISOString().split("T")[0],endDate:M.toISOString().split("T")[0],count:0}]}else{const k=new Date(S),D=new Date(k.getFullYear(),k.getMonth(),1),T=new Date(k.getFullYear(),k.getMonth()+1,0),P=new Date(k.getFullYear(),k.getMonth()-1,1),R=new Date(k.getFullYear(),k.getMonth(),0),Y=new Date(k.getFullYear(),k.getMonth()+1,1),X=new Date(k.getFullYear(),k.getMonth()+2,0);return[{label:"전월",startDate:P.toISOString().split("T")[0],endDate:R.toISOString().split("T")[0],count:0},{label:"금월",startDate:D.toISOString().split("T")[0],endDate:T.toISOString().split("T")[0],count:0},{label:"익월",startDate:Y.toISOString().split("T")[0],endDate:X.toISOString().split("T")[0],count:0}]}}async function _(){A(!0),g(null),j([]),x(null);const S=w();try{const k={period:e,filterType:i,baseDate:l};a&&(k.empId=a);const D=new URLSearchParams(k),[T,P]=await Promise.all([fetch(`/api/v1/lead-stats/registration?${D.toString()}`),fetch(`/api/v1/lead-stats/activity?${D.toString()}`)]);if(T.ok&&P.ok){const R=await T.json(),Y=await P.json(),X=(H,q)=>!Array.isArray(H)||H.length===0?q:H.map(M=>({label:M.label,count:Number(M.count)||0,startDate:M.startDate||l,endDate:M.endDate||l}));u(X(R,S)),h(X(Y,S))}else{if(console.error("Failed to fetch stats. Reg:",T.status,"Act:",P.status),!T.ok){const R=await T.text();console.error("Registration error:",R)}if(!P.ok){const R=await P.text();console.error("Activity error:",R)}u(S),h(S)}}catch(k){console.error("Failed to load stats",k),u(S),h(S)}finally{A(!1)}}async function I(S){try{const k=i==="owner"&&a?`AND CAST(l.assignee_id AS TEXT) = '${a}'`:"",D=i==="creator"&&a?`AND CAST(l.created_by AS TEXT) = '${a}'`:"",T={filterType:i,startDate:S.startDate,endDate:S.endDate};a&&(T.empId=a);const P=new URLSearchParams(T),R=await fetch(`/api/v1/lead-stats/registration/details?${P.toString()}`);if(R.ok){const Y=await R.json();j(Y),g(S),x(null)}}catch(k){console.error("Failed to load registration details",k)}}function O(S){const k=new Date(l);let D;e==="daily"?D=S==="prev"?new Date(k.setDate(k.getDate()-1)):new Date(k.setDate(k.getDate()+1)):e==="weekly"?D=S==="prev"?new Date(k.setDate(k.getDate()-7)):new Date(k.setDate(k.getDate()+7)):D=S==="prev"?new Date(k.setMonth(k.getMonth()-1)):new Date(k.setMonth(k.getMonth()+1));const T=D.toISOString().split("T")[0];c(T),setTimeout(()=>{E(T)},0)}async function E(S){A(!0),g(null),j([]),x(null);const D=(()=>{const T=new Date(S);if(e==="daily"){const P=new Date(T);P.setDate(P.getDate()-1);const R=new Date(T);return R.setDate(R.getDate()+1),[{label:"전일",startDate:P.toISOString().split("T")[0],endDate:P.toISOString().split("T")[0],count:0},{label:"금일",startDate:S,endDate:S,count:0},{label:"익일",startDate:R.toISOString().split("T")[0],endDate:R.toISOString().split("T")[0],count:0}]}else if(e==="weekly"){const P=new Date(T),R=P.getDay(),Y=P.getDate()-R+(R===0?-6:1),X=new Date(P.setDate(Y)),H=X.toISOString().split("T")[0],q=new Date(X);q.setDate(q.getDate()+6);const M=new Date(X);M.setDate(M.getDate()-7);const L=new Date(M);L.setDate(L.getDate()+6);const B=new Date(X);B.setDate(B.getDate()+7);const F=new Date(B);return F.setDate(F.getDate()+6),[{label:"전주",startDate:M.toISOString().split("T")[0],endDate:L.toISOString().split("T")[0],count:0},{label:"금주",startDate:H,endDate:q.toISOString().split("T")[0],count:0},{label:"차주",startDate:B.toISOString().split("T")[0],endDate:F.toISOString().split("T")[0],count:0}]}else{const P=new Date(T),R=new Date(P.getFullYear(),P.getMonth(),1),Y=new Date(P.getFullYear(),P.getMonth()+1,0),X=new Date(P.getFullYear(),P.getMonth()-1,1),H=new Date(P.getFullYear(),P.getMonth(),0),q=new Date(P.getFullYear(),P.getMonth()+1,1),M=new Date(P.getFullYear(),P.getMonth()+2,0);return[{label:"전월",startDate:X.toISOString().split("T")[0],endDate:H.toISOString().split("T")[0],count:0},{label:"금월",startDate:R.toISOString().split("T")[0],endDate:Y.toISOString().split("T")[0],count:0},{label:"익월",startDate:q.toISOString().split("T")[0],endDate:M.toISOString().split("T")[0],count:0}]}})();try{const T={period:e,filterType:i,baseDate:S};a&&(T.empId=a);const P=new URLSearchParams(T),[R,Y]=await Promise.all([fetch(`/api/v1/lead-stats/registration?${P.toString()}`),fetch(`/api/v1/lead-stats/activity?${P.toString()}`)]);if(R.ok&&Y.ok){const X=await R.json(),H=await Y.json(),q=(M,L)=>!Array.isArray(M)||M.length===0?L:M.map(B=>({label:B.label,count:Number(B.count)||0,startDate:B.startDate||S,endDate:B.endDate||S}));u(q(X,D)),h(q(H,D))}else u(D),h(D)}catch(T){console.error("Failed to load stats",T),u(D),h(D)}finally{A(!1)}}return r.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[r.jsx("div",{style:{padding:"16px 20px",borderBottom:"1px solid var(--border)",background:"var(--panel)"},children:r.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700,color:"var(--text)"},children:"TM현황"})}),r.jsxs("div",{style:{padding:"12px 20px",borderBottom:"1px solid var(--border)",background:"var(--panel)",display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:"조회기간:"}),r.jsxs("select",{value:e,onChange:S=>n(S.target.value),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13},children:[r.jsx("option",{value:"daily",children:"일별"}),r.jsx("option",{value:"weekly",children:"주간"}),r.jsx("option",{value:"monthly",children:"월간"})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:"구분:"}),r.jsxs("select",{value:i,onChange:S=>s(S.target.value),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13},children:[r.jsx("option",{value:"owner",children:"소유자"}),r.jsx("option",{value:"creator",children:"등록자"})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsxs("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:[i==="owner"?"소유자":"등록자",":"]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,alignItems:"center"},children:[r.jsxs("select",{className:"search-input",value:a||"",onChange:S=>o(S.target.value||""),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13,minWidth:160},children:[r.jsx("option",{value:"",children:"전체"}),N.map(S=>r.jsxs("option",{value:S.assignee_id,children:[S.dept_name," · ",S.emp_name]},S.assignee_id))]}),r.jsx("div",{style:{whiteSpace:"nowrap",alignSelf:"center",fontSize:12,color:"var(--muted)"},children:(()=>{const S=N.find(D=>D.assignee_id===a);return`현재선택 : ${S?S.emp_name:"전체"}`})()})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:"기준일자:"}),r.jsx("input",{type:"date",value:l,onChange:S=>c(S.target.value),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13}})]}),r.jsx("button",{onClick:_,disabled:v,className:"btn btn-card btn-3d",style:{height:32,fontSize:13,padding:"0 20px",fontWeight:600},children:v?"조회 중...":"조회"}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[r.jsx("button",{onClick:()=>O("prev"),className:"btn btn-card",style:{height:32,width:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center"},title:"이전",disabled:d.length===0&&f.length===0,children:r.jsx("img",{src:$v,alt:"이전",style:{width:16,height:16}})}),r.jsx("button",{onClick:()=>O("next"),className:"btn btn-card",style:{height:32,width:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center"},title:"다음",disabled:d.length===0&&f.length===0,children:r.jsx("img",{src:Lv,alt:"다음",style:{width:16,height:16}})})]})]}),r.jsx("div",{style:{flex:1,minHeight:0,overflow:"auto",padding:20},children:v?r.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--muted)"},children:"데이터를 불러오는 중..."}):r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20,height:"100%"},children:[r.jsxs("div",{style:{flex:"0 0 auto",display:"flex",gap:20,flexWrap:"wrap"},children:[r.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:12},children:[r.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"var(--text)"},children:"잠재고객 등록현황"}),d.length===0?r.jsxs("div",{style:{textAlign:"center",padding:40,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8},children:[r.jsx("div",{style:{fontSize:48,marginBottom:16,opacity:.3},children:"📊"}),r.jsx("div",{style:{fontSize:15,color:"var(--muted)",marginBottom:8},children:"조회 조건을 설정하고 조회 버튼을 클릭하세요"})]}):r.jsx(r.Fragment,{children:r.jsx("div",{style:{display:"flex",gap:12},children:d.map((S,k)=>r.jsxs("button",{onClick:()=>I(S),className:"btn btn-card btn-3d",style:{flex:1,minHeight:120,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:8,background:(m==null?void 0:m.label)===S.label?"var(--primary)":"var(--panel)",color:(m==null?void 0:m.label)===S.label?"#fff":"var(--text)",border:(m==null?void 0:m.label)===S.label?"2px solid var(--primary)":"1px solid var(--border)"},children:[r.jsx("div",{style:{fontSize:14,fontWeight:600},children:S.label}),r.jsx("div",{style:{fontSize:28,fontWeight:700},children:S.count}),r.jsx("div",{style:{fontSize:11,opacity:.7},children:S.startDate===S.endDate?S.startDate:`${S.startDate} ~ ${S.endDate}`})]},k))})})]}),r.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:12},children:[r.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"var(--text)"},children:"잠재고객 활동현황"}),f.length===0?r.jsxs("div",{style:{textAlign:"center",padding:40,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8},children:[r.jsx("div",{style:{fontSize:48,marginBottom:16,opacity:.3},children:"📊"}),r.jsx("div",{style:{fontSize:15,color:"var(--muted)",marginBottom:8},children:"조회 조건을 설정하고 조회 버튼을 클릭하세요"})]}):r.jsx("div",{style:{display:"flex",gap:12},children:f.map((S,k)=>r.jsxs("div",{className:"btn-card btn-3d",style:{flex:1,minHeight:120,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:8,background:"var(--panel)",color:"var(--text)",border:"1px solid var(--border)",cursor:"default",opacity:.8},children:[r.jsx("div",{style:{fontSize:14,fontWeight:600},children:S.label}),r.jsx("div",{style:{fontSize:28,fontWeight:700},children:S.count}),r.jsx("div",{style:{fontSize:11,opacity:.7},children:S.startDate===S.endDate?S.startDate:`${S.startDate} ~ ${S.endDate}`})]},k))})]})]}),m&&b.length>0&&r.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",gap:12},children:[r.jsxs("div",{style:{flex:1,minWidth:0,overflow:"auto",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,padding:12},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[r.jsxs("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"var(--text)"},children:[m.label," 등록 목록 (",b.length,"건)"]}),r.jsx("span",{style:{fontSize:12,color:"#e11d48",fontWeight:600},children:"잠재고객 클릭시 활동 조회"})]}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:b.map(S=>r.jsxs("button",{onClick:()=>x(S.id),style:{padding:10,background:y===S.id?"var(--primary-light)":"var(--background)",border:y===S.id?"2px solid var(--primary)":"1px solid var(--border)",borderRadius:6,fontSize:13,textAlign:"left",cursor:"pointer",transition:"all 0.2s"},children:[r.jsxs("div",{style:{fontWeight:600,color:y===S.id?"var(--primary)":"var(--text)",marginBottom:4},children:[S.company_name||"-",S.activities&&S.activities.length>0&&r.jsxs("span",{style:{marginLeft:8,fontSize:11,color:"var(--muted)"},children:["(활동 ",S.activities.length,"건)"]})]}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12},children:["담당자: ",S.contact_name||"-"]}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["상태: ",S.lead_status||"-"," | 업종: ",S.biz_type||"-"]}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["지역: ",S.addr_province_name||"-"]}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["최종수정: ",MH(S.updated_at)]})]},S.id))})]}),y&&(()=>{var k;const S=b.find(D=>D.id===y);return S?r.jsxs("div",{style:{flex:1,minWidth:0,overflow:"auto",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,padding:12},children:[r.jsxs("h4",{style:{margin:"0 0 12px",fontSize:14,fontWeight:600,color:"var(--text)"},children:[S.company_name||"-"," 활동 목록 (",((k=S.activities)==null?void 0:k.length)||0,"건)"]}),!S.activities||S.activities.length===0?r.jsx("div",{style:{textAlign:"center",padding:20,color:"var(--muted)",fontSize:13},children:"활동 데이터가 없습니다"}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:S.activities.map(D=>r.jsxs("div",{style:{padding:10,background:"var(--background)",border:"1px solid var(--border)",borderRadius:6,fontSize:13},children:[r.jsx("div",{style:{fontWeight:600,color:"var(--text)",marginBottom:4},children:D.subject||"-"}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12},children:["유형: ",D.activity_type||"-"," | 상태: ",D.activity_status||"-"]}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["계획: ",D.planned_start_at?new Date(D.planned_start_at).toLocaleString("ko-KR"):"-"]}),D.actual_start_at&&r.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["실제: ",new Date(D.actual_start_at).toLocaleString("ko-KR")]}),D.description&&r.jsx("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:D.description}),r.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["수정: ",D.updated_at?new Date(D.updated_at).toLocaleString("ko-KR"):"-"]})]},D.id))})]}):null})()]})]})})]})}function $H(){const[e,n]=p.useState(""),[i,s]=p.useState([]),[a,o]=p.useState(!1),[l,c]=p.useState(null),[d,u]=p.useState(null),[f,h]=p.useState(!0),[m,g]=p.useState(""),[b,j]=p.useState([]),[y,x]=p.useState(!1),[,v]=p.useState(!1),[A,N]=p.useState([]),[C,w]=p.useState({}),[_,I]=p.useState(!0),[O,E]=p.useState({open:!1,x:0,y:0}),S=p.useRef(null),[k,D]=p.useState(null),[T,P]=p.useState([]),[,R]=p.useState({}),[Y,X]=p.useState(""),[H,q]=p.useState(""),[M,L]=p.useState(()=>{const Se=new Date;return Se.setMinutes(Se.getMinutes()-Se.getTimezoneOffset()),Se.toISOString().slice(0,10)}),B=(()=>{try{return localStorage.getItem("tnt.sales.empName")||localStorage.getItem("tnt.sales.empId")||""}catch{return""}})(),F=(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||""}catch{return""}})(),[te,$]=p.useState(!1),[W,U]=p.useState(()=>({open:!1,text:""})),[Z,ee]=p.useState("");function K(Se){try{const Te=[JSON.parse(Se)];let Le=null;for(;Te.length;){const ke=Te.shift();if(Array.isArray(ke)){if(ke.length&&typeof ke[0]=="object"){Le=ke;break}}else if(ke&&typeof ke=="object")for(const Ue of Object.keys(ke))Te.push(ke[Ue])}return Le?Le.map(ke=>{const Ue=(ke==null?void 0:ke.WHName)??(ke==null?void 0:ke.whName)??(ke==null?void 0:ke.warehouseName)??(ke==null?void 0:ke.WH_NM)??(ke==null?void 0:ke.wh_nm)??"",st=Number((ke==null?void 0:ke.AvailStock)??(ke==null?void 0:ke.availStock)??(ke==null?void 0:ke.AVAIL_STOCK)??(ke==null?void 0:ke.qty)??0)||0,Ee=(ke==null?void 0:ke.UnitName)??(ke==null?void 0:ke.unitName)??(ke==null?void 0:ke.UNIT_NAME)??(ke==null?void 0:ke.salesMgmtUnit)??"";return{whName:String(Ue||""),avail:st,unitName:String(Ee||"")}}):[]}catch{return[]}}async function ne(Se){const je=F||"",Te=(()=>{try{return localStorage.getItem("tnt.sales.empId")||""}catch{return""}})();if(!je&&!Te)return(()=>{try{return localStorage.getItem("tnt.sales.empSeq")||""}catch{return""}})()||"4";try{const Le=new URLSearchParams;je&&Le.set("assigneeId",je),Te&&Le.set("empId",Te),Se&&Le.set("companyCode",Se);const ke=await fetch(`/api/v1/employee/by-assignee?${Le.toString()}`,{cache:"no-store"});if(!ke.ok)return(()=>{try{return localStorage.getItem("tnt.sales.empSeq")||""}catch{return""}})()||"4";const Ue=await ke.json().catch(()=>null),st=(Ue==null?void 0:Ue.resolvedSalesEmpSeq)??((Se==null?void 0:Se.toUpperCase())==="DYS"?Ue==null?void 0:Ue.dys_emp_seq:Ue==null?void 0:Ue.tnt_emp_seq),Ee=st!=null&&String(st)?String(st):"";return Ee||(()=>{try{return localStorage.getItem("tnt.sales.empSeq")||""}catch{return""}})()||"4"}catch{return(()=>{try{return localStorage.getItem("tnt.sales.empSeq")||""}catch{return""}})()||"4"}}async function pe(Se){try{x(!0);const je=Se??(d!=null?i[d]:null),Te=new URLSearchParams;Te.set("q",m.trim()||e.trim());const Le=(je==null?void 0:je.companyType)||(je==null?void 0:je.companyCode);Le&&Te.set("companyType",Le),(je==null?void 0:je.customerSeq)!=null&&Te.set("customerSeq",String(je.customerSeq));const ke=await fetch(`/api/v1/items/search?${Te.toString()}`),Ue=ke.ok?await ke.json():[],st=Array.isArray(Ue)?Ue.map(Ee=>({itemSeq:Ee==null?void 0:Ee.itemSeq,itemName:String((Ee==null?void 0:Ee.itemName)??""),recentInvoiceDate:(Ee==null?void 0:Ee.recentInvoiceDate)??(Ee==null?void 0:Ee.recent_invoice_date)??null,curAmt:(Ee==null?void 0:Ee.curAmt)??null,qty:(Ee==null?void 0:Ee.qty)??null,srcPri:(Ee==null?void 0:Ee.srcPri)!=null?Number(Ee.srcPri):void 0,itemStdUnit:(Ee==null?void 0:Ee.itemStdUnit)??(Ee==null?void 0:Ee.item_std_unit)??null,companyType:(Ee==null?void 0:Ee.companyType)||(Ee==null?void 0:Ee.company_type)||null})):[];j(st),st.length>0&&ae(st.map(Ee=>({itemSeq:Ee.itemSeq,itemName:Ee.itemName})))}catch{j([])}finally{x(!1)}}function G(Se){if(!(Se==null||Se.itemName==null)){v(!0);try{const je=Se.itemStdUnit??void 0,Te=localStorage.getItem("tnt.sales.ordersheet.cart"),Le=Te?JSON.parse(Te):[];if((Array.isArray(Le)?Le.findIndex(Ue=>String(Ue.itemName)===String(Se.itemName)):-1)>=0){alert("이미 주문에 포함되어 있습니다."),v(!1);return}else{const Ue={itemSeq:Se.itemSeq,itemName:Se.itemName,itemSpec:"",qty:"",itemStdUnit:je,companyType:Se.companyType||null};Le.push(Ue)}localStorage.setItem("tnt.sales.ordersheet.cart",JSON.stringify(Le)),P(Le),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.cart.changed",{detail:{cart:Le}}))}catch{}finally{v(!1)}}}async function ae(Se){const je={};await Promise.all(Se.map(async Te=>{const Le=Te.itemSeq!=null?String(Te.itemSeq):Te.itemName;try{const ke={bizUnit:"",stdDate:"",whSeq:"",itemName:String(Te.itemName||""),itemNo:"",itemSeq:String(Te.itemSeq||""),pageNo:"",pageSize:""},Ue=await fetch("/api/v1/items/avail-stock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ke)});if(Ue.ok){const st=await Ue.json().catch(()=>({})),Ee=st&&(st.receivedPayload||st),dt=JSON.stringify(Ee,null,2),Nt=K(dt).reduce((St,yn)=>St+(yn.avail||0),0);je[Le]=Nt>0}else je[Le]=!1}catch{je[Le]=!1}})),w(Te=>({...Te,...je}))}async function ie(Se,je){const Le=Se.currentTarget.getBoundingClientRect(),ke=Le.right,Ue=Le.bottom;E({open:!0,x:ke,y:Ue,loading:!0});try{const st={bizUnit:"",stdDate:"",whSeq:"",itemName:String(je.itemName||""),itemNo:"",itemSeq:String(je.itemSeq||""),pageNo:"",pageSize:""},Ee=await fetch("/api/v1/items/avail-stock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(st)});if(Ee.ok){const dt=await Ee.json().catch(()=>({})),gt=dt&&(dt.receivedPayload||dt),Nt=JSON.stringify(gt,null,2),St=K(Nt);E({open:!0,x:ke,y:Ue,loading:!1,error:null,rows:St})}else E({open:!0,x:ke,y:Ue,loading:!1,error:`HTTP ${Ee.status}`})}catch(st){E({open:!0,x:ke,y:Ue,loading:!1,error:(st==null?void 0:st.message)||"재고 조회 실패"})}}p.useEffect(()=>{if(!O.open)return;const Se=Te=>{const Le=S.current;Le&&Te.target instanceof Node&&!Le.contains(Te.target)&&E({open:!1,x:0,y:0})},je=Te=>{Te.key==="Escape"&&E({open:!1,x:0,y:0})};return document.addEventListener("mousedown",Se,!0),window.addEventListener("keydown",je,!0),()=>{document.removeEventListener("mousedown",Se,!0),window.removeEventListener("keydown",je,!0)}},[O.open]);async function J(){o(!0),c(null);try{const Se=new URLSearchParams;e.trim()&&Se.set("name",e.trim()),Se.set("mineOnly","false");const je=await fetch(`/api/v1/customers?${Se.toString()}`,{cache:"no-store"});if(!je.ok)throw new Error(`HTTP ${je.status}`);const Te=await je.json(),Le=Array.isArray(Te)?Te.map(ke=>({customerId:(ke==null?void 0:ke.customerId)??"",customerName:(ke==null?void 0:ke.customerName)??"",bizNo:(ke==null?void 0:ke.bizNo)??"",ownerName:(ke==null?void 0:ke.ownerName)??(ke==null?void 0:ke.empName)??"",telNo:(ke==null?void 0:ke.telNo)??"",customerSeq:(ke==null?void 0:ke.customerSeq)!=null?Number(ke.customerSeq):void 0,addrProvinceName:(ke==null?void 0:ke.addrProvinceName)??(ke==null?void 0:ke.addr_province_name)??"",addrCityName:(ke==null?void 0:ke.addrCityName)??(ke==null?void 0:ke.addr_city_name)??"",companyType:String((ke==null?void 0:ke.company_type)??(ke==null?void 0:ke.companyType)??(ke==null?void 0:ke.company)??"").toUpperCase(),companyCode:String((ke==null?void 0:ke.companyCode)??(ke==null?void 0:ke.company_code)??(ke==null?void 0:ke.company_type)??(ke==null?void 0:ke.companyType)??(ke==null?void 0:ke.company)??"").toUpperCase()})):[];Le.sort((ke,Ue)=>String(ke.customerName||"").localeCompare(String(Ue.customerName||""),"ko-KR")),s(Le),Le.length>0?(u(0),re(Le[0],0,!1),await pe(Le[0])):(u(null),j([]))}catch(Se){c((Se==null?void 0:Se.message)||"조회 중 오류가 발생했습니다"),s([])}finally{o(!1)}}p.useEffect(()=>{try{localStorage.removeItem("tnt.sales.ordersheet.selectedCustomer"),localStorage.removeItem("tnt.sales.ordersheet.cart"),localStorage.removeItem("tnt.sales.ordersheet.regionGroup"),localStorage.removeItem("tnt.sales.ordersheet.requests"),localStorage.removeItem("tnt.sales.ordersheet.deliveryDueDate")}catch{}},[]);function re(Se,je,Te=!0){u(je),D(Se),Te&&h(!1);try{localStorage.setItem("tnt.sales.ordersheet.selectedCustomer",JSON.stringify(Se)),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.customer.selected",{detail:{customer:Se}}))}catch{}const Le=Se.addrProvinceName??"",ke=Se.addrCityName??"",Ue=[Le,ke].filter(st=>!!st&&String(st).trim().length>0).join(" ");Ue&&X(String(Ue)),ee(""),q(""),P([]),R({});try{localStorage.setItem("tnt.sales.ordersheet.cart",JSON.stringify([]))}catch{}pe(Se),de(Se.customerSeq)}async function de(Se){try{N([]);const je=Se!=null?Number(Se):NaN;if(!Number.isFinite(je))return;const Te=await fetch(`/api/v1/customers/${je}/transactions`,{cache:"no-store"});if(!Te.ok)return;const Le=await Te.json().catch(()=>[]);if(!Array.isArray(Le)){N([]);return}const ke=Date.now()-365*24*60*60*1e3,Ue={};for(const Ee of Le){const dt=String((Ee==null?void 0:Ee.itemName)??(Ee==null?void 0:Ee.item_name)??"").trim();if(!dt)continue;const gt=(Ee==null?void 0:Ee.itemSeq)??(Ee==null?void 0:Ee.item_seq)??null,Nt=(Ee==null?void 0:Ee.companyType)??(Ee==null?void 0:Ee.company_type)??null,St=(Ee==null?void 0:Ee.itemStdUnit)??(Ee==null?void 0:Ee.item_std_unit)??null,yn=Number((Ee==null?void 0:Ee.curAmt)??(Ee==null?void 0:Ee.cur_amt)??0)||0,Kr=Number((Ee==null?void 0:Ee.qty)??0)||0,Ot=String((Ee==null?void 0:Ee.invoiceDate)??(Ee==null?void 0:Ee.invoice_date)??""),En=Date.parse(Ot)||Date.parse(Ot.replace(" ","T"))||NaN;if(!Number.isFinite(En)||En<ke)continue;const Gr=gt!=null?String(gt):dt,Yt=Ue[Gr]||{itemSeq:gt,itemName:dt,companyType:Nt||null,itemStdUnit:St||null,recent:0,totalAmt:0,totalQty:0};Yt.totalAmt+=yn,Yt.totalQty+=Kr,En>Yt.recent&&(Yt.recent=En),Yt.itemSeq==null&&gt!=null&&(Yt.itemSeq=gt),!Yt.companyType&&Nt&&(Yt.companyType=Nt),!Yt.itemStdUnit&&St&&(Yt.itemStdUnit=St),Ue[Gr]=Yt}const st=Object.values(Ue).sort((Ee,dt)=>dt.recent-Ee.recent||Ee.itemName.localeCompare(dt.itemName,"ko",{sensitivity:"base"})).map(Ee=>({itemSeq:Ee.itemSeq,itemName:Ee.itemName,companyType:Ee.companyType,itemStdUnit:Ee.itemStdUnit,recentDate:new Date(Ee.recent).toISOString().slice(0,10),totalAmt:Ee.totalAmt,totalQty:Ee.totalQty}));N(st),st.length>0&&ae(st.map(Ee=>({itemSeq:Ee.itemSeq,itemName:Ee.itemName})))}catch{N([])}}function he(){try{const Se=localStorage.getItem("tnt.sales.ordersheet.selectedCustomer");return Se?JSON.parse(Se):null}catch{return null}}async function oe(Se){const je=b.find(Te=>String(Te.itemName).trim()===String(Se).trim());if(je&&je.itemSeq!=null)return{itemSeq:je.itemSeq,itemName:je.itemName};try{const Te=new URLSearchParams;Te.set("q",Se);const Le=he(),ke=(Le==null?void 0:Le.companyType)||(Le==null?void 0:Le.companyCode);ke&&Te.set("companyType",ke),(Le==null?void 0:Le.customerSeq)!=null&&Te.set("customerSeq",String(Le.customerSeq));const Ue=await fetch(`/api/v1/items/search?${Te.toString()}`),st=Ue.ok?await Ue.json():[],Ee=Array.isArray(st)?st:[],dt=Ee.find(gt=>String((gt==null?void 0:gt.itemName)||"").trim()===String(Se).trim())||Ee[0];if(dt&&dt.itemSeq!=null)return{itemSeq:dt.itemSeq,itemName:String(dt.itemName||Se)}}catch{}return null}async function V(Se,je){if(je.itemSeq!=null)await ie(Se,je);else{const Te=await oe(je.itemName);Te&&await ie(Se,Te)}}async function Pe(Se){let je=Se;if(!je.itemSeq){const Te=await oe(Se.itemName);if(!Te)return;je={...je,...Te}}G({itemSeq:je.itemSeq,itemName:je.itemName,companyType:je.companyType||void 0,itemStdUnit:je.itemStdUnit||void 0})}function Ve(Se){const je=T.filter((Te,Le)=>Le!==Se);P(je);try{localStorage.setItem("tnt.sales.ordersheet.cart",JSON.stringify(je)),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.cart.changed",{detail:{cart:je}}))}catch{}}function tt(Se,je){const Te=T.slice();if(je==="")Te[Se]={...Te[Se],qty:""};else{const Le=Number(je);if(!isFinite(Le)||Le<0)Te[Se]={...Te[Se],qty:""};else{const ke=Math.floor(Le*100)/100;Te[Se]={...Te[Se],qty:ke}}}P(Te);try{localStorage.setItem("tnt.sales.ordersheet.cart",JSON.stringify(Te)),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.cart.changed",{detail:{cart:Te}}))}catch{}}async function ot(){var Se,je,Te,Le,ke,Ue;$(!0);try{const st=String((k==null?void 0:k.companyCode)||"TNT"),Ee=await ne(st),dt={"Content-Type":"application/json"};F&&(dt["X-ASSIGNEE-ID"]=String(F));const gt={companyCode:st,customerSeq:(k==null?void 0:k.customerSeq)!=null?String(k.customerSeq):"",customerName:String((k==null?void 0:k.customerName)||""),assigneeId:F||"",regionGroup:Y,requests:H,deliveryDueDate:M,createdBy:B||"",custEmpName:String((k==null?void 0:k.ownerName)||""),salesEmpSeq:Ee||void 0,items:(T||[]).map(yn=>({itemSeq:String(yn.itemSeq||""),itemName:yn.itemName,itemSpec:yn.itemSpec||"",qty:Number(yn.qty)||0,itemStdUnit:yn.itemStdUnit||void 0,companyType:yn.companyType||void 0}))},Nt=await fetch("/api/v1/orders",{method:"POST",headers:dt,body:JSON.stringify(gt)}),St=await Nt.json().catch(()=>({}));if(!Nt.ok)throw new Error((St==null?void 0:St.error)||`HTTP ${Nt.status}`);ee(String((St==null?void 0:St.orderTextNo)||((Ue=(ke=(Le=(Te=(je=(Se=St==null?void 0:St.sendPayload)==null?void 0:Se.ROOT)==null?void 0:je.data)==null?void 0:Te.ROOT)==null?void 0:Le.DataBlock1)==null?void 0:ke[0])==null?void 0:Ue.OrderTextNo)||"")),U({open:!0,text:"주문 전송 완료"}),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.order.created"))}catch(st){U({open:!0,text:(st==null?void 0:st.message)||"주문 전송 중 오류가 발생했습니다"})}finally{$(!1)}}const ht=({type:Se})=>{const je=(Se||"").toUpperCase(),Te=je==="TNT"?"T":je==="DYS"?"D":je==="ALL"?"A":"",Le=je==="TNT"?"var(--primary)":je==="DYS"?"var(--success)":je==="ALL"?"var(--warning)":"var(--text-secondary)";return Te?r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:"50%",background:Le,color:"var(--on-accent)",fontSize:11,fontWeight:800},children:Te}):null},vt=new Intl.NumberFormat("ko-KR");return r.jsxs("div",{style:{padding:24,height:"100%",overflow:"auto",background:"var(--panel)"},children:[r.jsx("div",{style:{marginBottom:24},children:r.jsx("h1",{style:{fontSize:24,fontWeight:600,marginBottom:8},children:"수주장 등록"})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 400px",gap:24},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[r.jsx("div",{style:{border:"1px solid var(--border)",borderRadius:8},children:k&&!f?r.jsxs("div",{style:{padding:"12px 16px",background:"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>h(!0),children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx(ht,{type:k.companyType||k.companyCode}),r.jsx("span",{style:{fontWeight:600},children:k.customerName}),r.jsx("span",{style:{fontSize:12,color:"var(--text-secondary)"},children:k.ownerName&&`| ${k.ownerName}`})]}),r.jsxs("button",{className:"btn btn-secondary",style:{padding:"4px 8px",fontSize:12,display:"flex",alignItems:"center",gap:4},onClick:Se=>{Se.stopPropagation(),h(!0)},children:[r.jsx(ko,{size:14}),"변경"]})]}):r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{padding:16,borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsxs("div",{style:{flex:1,position:"relative"},children:[r.jsx("input",{type:"text",className:"input",placeholder:"거래처명 검색",value:e,onChange:Se=>n(Se.target.value),onKeyDown:Se=>{Se.key==="Enter"&&J()},style:{width:"100%",paddingLeft:36}}),r.jsx(Fn,{size:16,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",opacity:.5}})]}),r.jsx("button",{className:"btn btn-primary",onClick:J,disabled:a,children:a?"검색 중...":"검색"}),k&&r.jsx("button",{className:"btn btn-secondary",style:{padding:"8px",display:"flex",alignItems:"center"},onClick:()=>h(!1),title:"목록 접기",children:r.jsx(wf,{size:16})})]})}),r.jsx("div",{style:{maxHeight:"30vh",overflow:"auto"},children:i.length===0?r.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-secondary)"},children:a?"불러오는 중…":l||"거래처를 검색해주세요"}):r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"var(--bg-secondary)"},children:[r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)"},children:"거래처명"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)",width:120},children:"대표자"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)",width:140},children:"사업자번호"})]})}),r.jsx("tbody",{children:i.map((Se,je)=>r.jsxs("tr",{onClick:()=>re(Se,je),style:{cursor:"pointer",background:d===je?"var(--bg-secondary)":"transparent"},onMouseEnter:Te=>{d!==je&&(Te.currentTarget.style.background="var(--bg-secondary)")},onMouseLeave:Te=>{d!==je&&(Te.currentTarget.style.background="transparent")},children:[r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx(ht,{type:Se.companyType||Se.companyCode}),r.jsx("span",{children:Se.customerName})]})}),r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)"},children:Se.ownerName}),r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)"},children:Se.bizNo})]},je))})]})})]})}),A.length>0&&r.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8},children:[r.jsxs("div",{style:{padding:"8px 12px",background:"var(--bg-secondary)",borderBottom:_?"1px solid var(--border)":"none",fontSize:12,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>I(!_),children:[r.jsxs("span",{children:["최근 거래내역 (",A.length,"건)"]}),_?r.jsx(wf,{size:16}):r.jsx(ko,{size:16})]}),_&&r.jsx("div",{style:{maxHeight:"20vh",overflow:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"var(--bg-secondary)"},children:[r.jsx("th",{style:{padding:"8px 12px",textAlign:"left",borderBottom:"1px solid var(--border)"},children:"품목"}),r.jsx("th",{style:{padding:"8px 12px",textAlign:"left",borderBottom:"1px solid var(--border)",width:100},children:"최근거래일"}),r.jsx("th",{style:{padding:"8px 12px",textAlign:"right",borderBottom:"1px solid var(--border)",width:100},children:"총금액"}),r.jsx("th",{style:{padding:"8px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:80}})]})}),r.jsx("tbody",{children:A.map((Se,je)=>r.jsxs("tr",{children:[r.jsx("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--border)",color:"var(--primary)",fontWeight:500},children:Se.itemName}),r.jsx("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--border)"},children:Se.recentDate}),r.jsx("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--border)",textAlign:"right"},children:vt.format(Se.totalAmt)}),r.jsx("td",{style:{padding:"8px 12px",borderBottom:"1px solid var(--border)",textAlign:"center"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[(()=>{const Te=Se.itemSeq!=null?String(Se.itemSeq):Se.itemName,ke=C[Te]===!1;return r.jsx("button",{className:"btn btn-secondary",style:{width:28,height:28,padding:0,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:ke?"var(--error)":void 0,borderColor:ke?"var(--error)":void 0},onClick:Ue=>V(Ue,{itemSeq:Se.itemSeq,itemName:Se.itemName}),title:ke?"재고 없음 - 클릭하여 상세 조회":"재고 조회",children:r.jsx(cc,{size:14,style:{color:ke?"var(--error)":void 0}})})})(),r.jsx("button",{className:"btn btn-primary",style:{width:28,height:28,padding:0,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>Pe(Se),title:"담기",children:r.jsx(mr,{size:14})})]})})]},je))})]})})]}),r.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8},children:[r.jsx("div",{style:{padding:16,borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsxs("div",{style:{flex:1,position:"relative"},children:[r.jsx("input",{type:"text",className:"input",placeholder:"품목명 검색",value:m,onChange:Se=>g(Se.target.value),onKeyDown:Se=>{Se.key==="Enter"&&pe()},style:{width:"100%",paddingLeft:36}}),r.jsx(Fn,{size:16,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",opacity:.5}})]}),r.jsx("button",{className:"btn btn-primary",onClick:()=>pe(),disabled:y,children:y?"검색 중...":"품목 조회"})]})}),r.jsx("div",{style:{maxHeight:"30vh",overflow:"auto"},children:b.length===0?r.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-secondary)"},children:y?"품목 불러오는 중…":"품목 데이터가 없습니다"}):r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"var(--bg-secondary)"},children:[r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)"},children:"품목명"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)",width:100},children:"최근거래일"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"right",borderBottom:"1px solid var(--border)",width:100},children:"총금액"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:80}})]})}),r.jsx("tbody",{children:b.map((Se,je)=>r.jsxs("tr",{onDoubleClick:()=>G(Se),title:"더블클릭하면 수주장에 담습니다",style:{cursor:"pointer"},onMouseEnter:Te=>Te.currentTarget.style.background="var(--bg-secondary)",onMouseLeave:Te=>Te.currentTarget.style.background="transparent",children:[r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx(ht,{type:Se.companyType}),r.jsx("span",{style:Se.srcPri===0?{color:"var(--primary)",fontWeight:500}:void 0,children:Se.itemName}),Se.itemStdUnit&&r.jsxs("span",{style:{fontSize:11,color:"var(--text-secondary)"},children:["(",Se.itemStdUnit,")"]})]})}),r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)"},children:Se.recentInvoiceDate||""}),r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)",textAlign:"right"},children:Se.curAmt!=null&&Se.curAmt!==""?vt.format(Number(Se.curAmt)):""}),r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)",textAlign:"center"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[(()=>{const Te=Se.itemSeq!=null?String(Se.itemSeq):Se.itemName,ke=C[Te]===!1;return r.jsx("button",{className:"btn btn-secondary",style:{width:28,height:28,padding:0,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:ke?"var(--error)":void 0,borderColor:ke?"var(--error)":void 0},onClick:Ue=>{Ue.stopPropagation(),ie(Ue,Se)},title:ke?"재고 없음 - 클릭하여 상세 조회":"재고 조회",children:r.jsx(cc,{size:14,style:{color:ke?"var(--error)":void 0}})})})(),r.jsx("button",{className:"btn btn-primary",style:{width:28,height:28,padding:0,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},onClick:Te=>{Te.stopPropagation(),G(Se)},title:"담기",children:r.jsx(mr,{size:14})})]})})]},je))})]})})]})]}),r.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8,display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)",display:"flex",alignItems:"center",gap:8},children:[r.jsx(nr,{size:18}),r.jsx("strong",{children:"수주장"})]}),r.jsx("div",{style:{padding:16,borderBottom:"1px solid var(--border)"},children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"80px 1fr",gap:8,fontSize:13},children:[r.jsx("span",{style:{color:"var(--text-secondary)"},children:"수주장번호"}),r.jsx("span",{style:{fontWeight:500},children:Z||"-"}),r.jsx("span",{style:{color:"var(--text-secondary)"},children:"회사코드"}),r.jsx("span",{style:{fontWeight:500},children:(k==null?void 0:k.companyCode)||"TNT"}),r.jsx("span",{style:{color:"var(--text-secondary)"},children:"거래처"}),r.jsxs("span",{style:{fontWeight:500},children:[(k==null?void 0:k.customerName)||"-",(k==null?void 0:k.ownerName)&&r.jsxs("span",{style:{color:"var(--text-secondary)",fontWeight:400,marginLeft:8},children:["(",k.ownerName,")"]})]}),r.jsx("span",{style:{color:"var(--text-secondary)"},children:"등록자"}),r.jsx("span",{style:{fontWeight:500},children:B||"-"})]})}),r.jsxs("div",{style:{padding:16,borderBottom:"1px solid var(--border)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[r.jsx("label",{style:{fontSize:12,color:"var(--text-secondary)",minWidth:70,flexShrink:0},children:"지역 그룹"}),r.jsx("input",{type:"text",className:"input",value:Y,onChange:Se=>X(Se.target.value),placeholder:"지역 그룹",style:{flex:1}})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[r.jsx("label",{style:{fontSize:12,color:"var(--text-secondary)",minWidth:70,flexShrink:0},children:"납품요청일"}),r.jsx("input",{type:"date",className:"input",value:M,onChange:Se=>L(Se.target.value),style:{flex:1}})]}),r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[r.jsx("label",{style:{fontSize:12,color:"var(--text-secondary)",minWidth:70,flexShrink:0,paddingTop:8},children:"요청 사항"}),r.jsx("textarea",{className:"input",value:H,onChange:Se=>q(Se.target.value),placeholder:"요청 사항",rows:6,style:{flex:1,resize:"vertical"}})]})]}),r.jsxs("div",{style:{flex:1,overflow:"auto",padding:16},children:[r.jsxs("div",{style:{fontSize:12,color:"var(--text-secondary)",marginBottom:8},children:["담긴 품목 (",T.length,"건)"]}),T.length===0?r.jsx("div",{style:{padding:32,textAlign:"center",color:"var(--text-secondary)",background:"var(--bg-secondary)",borderRadius:8},children:"담긴 품목이 없습니다"}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:T.map((Se,je)=>r.jsxs("div",{style:{padding:12,border:"1px solid var(--border)",borderRadius:8,background:"var(--panel)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[r.jsx(ht,{type:Se.companyType||(k==null?void 0:k.companyType)||(k==null?void 0:k.companyCode)}),r.jsx("span",{style:{flex:1,fontSize:13,fontWeight:500},children:Se.itemName}),Se.itemStdUnit&&r.jsxs("span",{style:{fontSize:11,color:"var(--text-secondary)"},children:["(",Se.itemStdUnit,")"]}),r.jsx("button",{onClick:()=>Ve(je),style:{background:"none",border:"none",cursor:"pointer",padding:4,color:"var(--error)"},title:"삭제",children:r.jsx(On,{size:16})})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{type:"number",className:"input",min:0,step:"0.01",value:Se.qty===""?"":String(Se.qty),placeholder:"수량",onChange:Te=>tt(je,Te.target.value),style:{width:100,textAlign:"right"}}),Se.itemStdUnit&&r.jsx("span",{style:{fontSize:12,color:"var(--text-secondary)"},children:Se.itemStdUnit})]})]},je))})]}),r.jsx("div",{style:{padding:16,borderTop:"1px solid var(--border)"},children:r.jsx("button",{className:"btn btn-primary",style:{width:"100%",padding:"12px 16px",fontSize:14,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center"},disabled:te||!T.length||!k,onClick:ot,children:te?"전송 중...":"주문"})})]})]}),O.open&&r.jsx("div",{ref:S,style:{position:"fixed",left:O.x+6,top:O.y+6,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",padding:12,maxWidth:400,zIndex:100},onClick:Se=>Se.stopPropagation(),children:O.loading?r.jsx("div",{style:{color:"var(--text-secondary)"},children:"재고 불러오는 중…"}):O.error?r.jsx("div",{style:{color:"var(--error)"},children:O.error}):!O.rows||O.rows.length===0?r.jsx("div",{style:{color:"var(--text-secondary)"},children:"재고 데이터가 없습니다"}):r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"var(--bg-secondary)"},children:[r.jsx("th",{style:{padding:"8px",textAlign:"left",borderBottom:"1px solid var(--border)"},children:"창고명"}),r.jsx("th",{style:{padding:"8px",textAlign:"right",borderBottom:"1px solid var(--border)",width:80},children:"가용재고"}),r.jsx("th",{style:{padding:"8px",textAlign:"left",borderBottom:"1px solid var(--border)",width:80},children:"단위"})]})}),r.jsx("tbody",{children:(O.rows||[]).map((Se,je)=>r.jsxs("tr",{children:[r.jsx("td",{style:{padding:"8px",borderBottom:"1px solid var(--border)"},children:Se.whName||"-"}),r.jsx("td",{style:{padding:"8px",textAlign:"right",borderBottom:"1px solid var(--border)"},children:vt.format(Se.avail)}),r.jsx("td",{style:{padding:"8px",borderBottom:"1px solid var(--border)"},children:Se.unitName||""})]},je))})]})}),W.open&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>U({open:!1,text:""}),children:r.jsxs("div",{style:{background:"var(--bg-primary)",borderRadius:8,padding:24,minWidth:300,boxShadow:"0 20px 60px rgba(0,0,0,0.3)",textAlign:"center"},onClick:Se=>Se.stopPropagation(),children:[r.jsx("div",{style:{marginBottom:16,fontSize:14},children:W.text}),r.jsx("button",{className:"btn btn-primary",onClick:()=>U({open:!1,text:""}),children:"확인"})]})})]})}function LH(){const e=[];for(let n=2030;n>=2026;n--)e.push(n);return e}function WH(){const[e,n]=p.useState(2026),[i,s]=p.useState(()=>{try{return localStorage.getItem("tnt.sales.assign.mode")==="Moderate"?"Moderate":"Best"}catch{return"Best"}}),[a,o]=p.useState([{company:"TNT",group:"TNT",name:"복층유리",amount:0,stage:""},{company:"TNT",group:"TNT",name:"건자재",amount:0,stage:""},{company:"DYS",group:"DYS",name:"실란트",amount:0,stage:""}]),[l,c]=p.useState(!1),[d,u]=p.useState(null),[f,h]=p.useState(null),m=new Intl.NumberFormat("ko-KR");async function g(){c(!0),u(null);try{const N=new URL("/api/v1/targets/year",window.location.origin);N.searchParams.set("year",String(e)),N.searchParams.set("versionNo",i==="Moderate"?"2":"1");const C=await fetch(N.toString()),w=C.ok?await C.json():[],_=new Map;if(Array.isArray(w))for(const I of w){const O=String((I==null?void 0:I.company_name)||"").toUpperCase()==="DYS"?"DYS":"TNT",E=String((I==null?void 0:I.biz_area_name)||""),S=Number((I==null?void 0:I.version_no)??0),k=Number((I==null?void 0:I.target_amount_max)??(I==null?void 0:I.target_amount_min)??0),D=String((I==null?void 0:I.target_stage)??""),T=`${O}||${E}`,P=_.get(T);(!P||S>P.ver)&&_.set(T,{ver:S,amt:Number.isFinite(k)?k:0,stage:D,company:O,name:E})}_.size===0?(o(I=>I.map(O=>({...O,amount:0,stage:""}))),h("영업목표가 수립되지 않았습니다.")):(o(I=>I.map(O=>{const E=`${O.company}||${O.name}`,S=_.get(E);return S?{...O,amount:S.amt,stage:S.stage}:O})),h(null))}catch(N){u((N==null?void 0:N.message)||"조회 오류")}finally{c(!1)}}p.useEffect(()=>{g()},[e,i]),p.useEffect(()=>{try{localStorage.setItem("tnt.sales.assign.mode",i)}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.assign.mode.changed",{detail:{mode:i}}))}catch{}},[i]),p.useEffect(()=>{try{localStorage.setItem("tnt.sales.assign.year",String(e)),window.dispatchEvent(new CustomEvent("tnt.sales.assign.year.changed"))}catch{}},[e]);const b=p.useMemo(()=>a.filter(N=>N.company==="TNT").reduce((N,C)=>N+(Number(C.amount)||0),0),[a]),j=p.useMemo(()=>a.filter(N=>N.company==="DYS").reduce((N,C)=>N+(Number(C.amount)||0),0),[a]);p.useEffect(()=>{try{const N={tnt:Number(b)||0,dys:Number(j)||0,year:e};localStorage.setItem("tnt.sales.assign.companyTotals",JSON.stringify(N)),window.dispatchEvent(new CustomEvent("tnt.sales.assign.companyTotals.changed"))}catch{}},[b,j,e]);function y(N,C){const w=Number((C||"").replace(/[\s,]/g,""));o(_=>_.map((I,O)=>O===N?{...I,amount:Number.isFinite(w)?w:0}:I))}async function x(N=!1){try{const C=a.map(O=>({targetYear:`${e}-01-01`,versionNo:1,companyName:O.company,bizAreaGroup:O.group,bizAreaName:O.name,targetAmountMin:O.amount,targetAmountMax:O.amount,targetStage:N?"확정":"기안중"})),w=localStorage.getItem("tnt.sales.empSeq")||"",_={"Content-Type":"application/json"};w&&(_["X-EMP-SEQ"]=String(w));const I=await fetch("/api/v1/targets/year/upsert",{method:"POST",headers:_,body:JSON.stringify(C)});if(!I.ok)throw new Error(`HTTP ${I.status}`);N&&await fetch(`/api/v1/targets/year/confirm?year=${e}`,{method:"POST",headers:_}),await g(),alert(N?"확정되었습니다.":"저장되었습니다.")}catch(C){alert((C==null?void 0:C.message)||"저장 중 오류")}}const v=p.useMemo(()=>{const N=a.filter(C=>C.company==="TNT").map(C=>(C.stage||"").trim());return N.includes("확정")?"확정":N.includes("기안중")?"기안중":""},[a]),A=p.useMemo(()=>{const N=a.filter(C=>C.company==="DYS").map(C=>(C.stage||"").trim());return N.includes("확정")?"확정":N.includes("기안중")?"기안중":""},[a]);return r.jsxs("section",{className:"card",style:{padding:12},children:[r.jsxs("div",{className:"page-title",style:{marginBottom:12},children:[r.jsx("h2",{style:{margin:0},children:"회사별 목표 입력"}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsxs("div",{role:"radiogroup","aria-label":"목표 산정 모드",className:"segmented",children:[r.jsxs("label",{className:`seg ${i==="Best"?"selected":""}`,children:[r.jsx("input",{type:"radio",name:"assign-mode",checked:i==="Best",onChange:()=>s("Best")}),r.jsx("span",{children:"Best"})]}),r.jsxs("label",{className:`seg ${i==="Moderate"?"selected":""}`,children:[r.jsx("input",{type:"radio",name:"assign-mode",checked:i==="Moderate",onChange:()=>s("Moderate")}),r.jsx("span",{children:"Moderate"})]})]}),r.jsx("select",{className:"search-input",value:e,onChange:N=>n(Number(N.target.value)),children:LH().map(N=>r.jsxs("option",{value:N,children:[N,"년"]},N))}),r.jsx("button",{className:"btn btn-3d btn-card",onClick:()=>x(!1),children:"저장"}),r.jsx("button",{className:"btn btn-3d btn-card",onClick:()=>x(!0),children:"확정"})]})]}),d&&r.jsx("div",{className:"error",children:d}),f&&!d&&r.jsx("div",{className:"empty-state",style:{marginBottom:12},children:f}),r.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"nowrap",width:"100%"},children:[r.jsxs("div",{className:"card",style:{padding:12,flex:"1 1 0",minWidth:0},children:[r.jsxs("div",{style:{fontWeight:700,marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{children:"TNT"}),v?r.jsx("span",{className:"badge",children:v}):null,l&&r.jsx("span",{className:"muted",style:{marginLeft:"auto",fontSize:12},children:"불러오는 중…"})]}),a.filter(N=>N.company==="TNT").map(N=>{const C=a.findIndex(w=>w.company===N.company&&w.name===N.name);return r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr 42px",alignItems:"center",gap:8,marginBottom:8},children:[r.jsx("div",{children:r.jsx("span",{className:"muted",children:N.name})}),r.jsx("input",{className:"assign-input",style:{textAlign:"right"},value:N.amount?m.format(N.amount):"",onChange:w=>y(C,w.target.value),placeholder:"0",disabled:i==="Moderate",title:i==="Moderate"?"Moderate 모드에서는 회사별 목표 수정이 비활성화됩니다":"값을 입력하세요"}),r.jsx("div",{className:"muted",style:{textAlign:"left"},children:"억원"})]},`TNT-${N.name}`)}),r.jsxs("div",{style:{textAlign:"right",fontWeight:700},children:["합계: ",m.format(b)," 억원"]})]}),r.jsxs("div",{className:"card",style:{padding:12,flex:"1 1 0",minWidth:0},children:[r.jsxs("div",{style:{fontWeight:700,marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{children:"DYS"}),A?r.jsx("span",{className:"badge",children:A}):null,l&&r.jsx("span",{className:"muted",style:{marginLeft:"auto",fontSize:12},children:"불러오는 중…"})]}),a.filter(N=>N.company==="DYS").map(N=>{const C=a.findIndex(w=>w.company===N.company&&w.name===N.name);return r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr 42px",alignItems:"center",gap:8,marginBottom:8},children:[r.jsx("div",{children:r.jsx("span",{className:"muted",children:N.name})}),r.jsx("input",{className:"assign-input",style:{textAlign:"right"},value:N.amount?m.format(N.amount):"",onChange:w=>y(C,w.target.value),placeholder:"0",disabled:i==="Moderate",title:i==="Moderate"?"Moderate 모드에서는 회사별 목표 수정이 비활성화됩니다":"값을 입력하세요"}),r.jsx("div",{className:"muted",style:{textAlign:"left"},children:"억원"})]},`DYS-${N.name}`)}),r.jsxs("div",{style:{textAlign:"right",fontWeight:700},children:["합계: ",m.format(j)," 억원"]})]})]})]})}const BH=["영업1본부","영업1팀","영업2본부","영업2팀"];function FH(){const[e,n]=p.useState([]),[i,s]=p.useState(!1),[a,o]=p.useState(null),[l,c]=p.useState(!1),[d,u]=p.useState(()=>{try{const T=localStorage.getItem("tnt.sales.assign.year");return T?Number(T):new Date().getFullYear()}catch{return new Date().getFullYear()}}),[f,h]=p.useState({}),[m,g]=p.useState(null),[b,j]=p.useState({}),[y,x]=p.useState(""),v=new Intl.NumberFormat("ko-KR"),[A,N]=p.useState(0);p.useEffect(()=>{const T=()=>N(P=>P+1);return window.addEventListener("tnt.sales.assign.mode.changed",T),()=>window.removeEventListener("tnt.sales.assign.mode.changed",T)},[]);const C=p.useMemo(()=>{try{return(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase()==="moderate"}catch{return!1}},[A]);async function w(){s(!0),o(null);try{const T=new URL("/api/v1/targets/assigned",window.location.origin);T.searchParams.set("year",String(d));try{const L=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),B=L==="moderate"?"2":L==="best"?"1":"";B&&T.searchParams.set("versionNo",B)}catch{}const P=await fetch(T.toString()),R=P.ok?await P.json():[],Y=Array.isArray(R)?R:[];if(Y.length>0){const L=Y.reduce((B,F)=>{const te=String(F.emp_id??F.empId??"").trim(),$=String(F.emp_name??F.empName??"").trim(),W=String(F.dept_name??F.deptName??""),U=te||($?`name:${$}`:"");return U&&(B.some(Z=>Z.key===U)||B.push({key:U,empId:te,empName:$,deptName:W})),B},[]);L.sort((B,F)=>(B.deptName||"").localeCompare(F.deptName||"")||(B.empName||"").localeCompare(F.empName||"")),n(L),s(!1);return}const X=new URL("/api/v1/employees",window.location.origin);X.searchParams.set("depts",BH.join(","));const H=await fetch(X.toString());if(!H.ok)throw new Error(`HTTP ${H.status}`);const q=await H.json(),M=Array.isArray(q)?q.map(L=>{const B=String(L.empId??L.emp_id??"").trim(),F=String(L.empName??L.emp_name??"").trim(),te=String(L.deptName??L.dept_name??""),$=String(L.assignee_id??L.assigneeId??"").trim()||void 0;return{key:B||$||(F?`name:${F}`:""),empId:B,empName:F,deptName:te,assigneeId:$}}).filter(L=>!!L.key):[];M.sort((L,B)=>(L.deptName||"").localeCompare(B.deptName||"")||(L.empName||"").localeCompare(B.empName||"")),n(M)}catch(T){o((T==null?void 0:T.message)||"조회 중 오류"),n([])}finally{s(!1)}}p.useEffect(()=>{w()},[]),p.useEffect(()=>{try{localStorage.setItem("tnt.sales.assign.empList",JSON.stringify(e)),window.dispatchEvent(new CustomEvent("tnt.sales.assign.emps.changed"))}catch{}},[e]),p.useEffect(()=>{const T=()=>{try{const P=localStorage.getItem("tnt.sales.assign.year");P&&u(Number(P)),j({}),x&&x("")}catch{}};return window.addEventListener("tnt.sales.assign.year.changed",T),()=>window.removeEventListener("tnt.sales.assign.year.changed",T)},[]),p.useEffect(()=>{async function T(){try{if(!e.length){j({});return}const P=new URL("/api/v1/targets/assigned",window.location.origin);P.searchParams.set("year",String(d));try{const M=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),L=M==="moderate"?"2":M==="best"?"1":"";L&&P.searchParams.set("versionNo",L)}catch{}const R=await fetch(P.toString()),Y=R.ok?await R.json():[],X={};let H="";Array.isArray(Y)&&Y.forEach(M=>{const L=String(M.emp_id??M.empId??"").trim(),B=String(M.emp_name??M.empName??"").trim(),F=L||(B?`name:${B}`:"");if(!F)return;const te=String(M.company_name??M.companyName??"").toUpperCase(),$=Number(M.assigned_amount??M.assignedAmount??0),W=String(M.target_stage??M.targetStage??"").trim(),U=X[F]||{tnt:0,dys:0};te==="TNT"?U.tnt=Math.round($):te==="DYS"&&(U.dys=Math.round($)),X[F]=U,W==="확정"?H="확정":!H&&W==="기안중"&&(H="기안중")});const q={};e.forEach(M=>{const L=X[M.key];L&&(q[M.key]={tnt:L.tnt||0,dys:L.dys||0})}),j(q),x(H)}catch{}}T()},[d,e,A]),p.useEffect(()=>{async function T(){try{const P=Array.from(new Set(e.map(M=>String(M.empName||"").trim()).filter(Boolean)));if(!P.length){h({});return}const R=new URL("/api/v1/sales/employee-yearly",window.location.origin);R.searchParams.set("year",String(d)),R.searchParams.set("empNames",P.join(",")),R.searchParams.set("joinKey","emp_name");const Y=await fetch(R.toString()),X=Y.ok?await Y.json():[],H=Array.isArray(X)?X:Array.isArray(X==null?void 0:X.employees)?X.employees:[],q={};H.forEach(M=>{const L=String(M.emp_name??M.empName??"").trim();if(!L)return;const B=Number(M.tnt_amount??0),F=Number(M.dys_amount??0),te=q[L]||{tnt:0,dys:0};q[L]={tnt:te.tnt+(Number.isFinite(B)?B:0),dys:te.dys+(Number.isFinite(F)?F:0)}}),h(q)}catch{h({})}}T()},[d,e]);function _(T,P){const R=Number(P);return!Number.isFinite(R)||R<=0?"-":`${(Math.max(0,Number(T||0))*1e8/R*100).toFixed(1)}%`}const I=e;function O(T){g(T);try{localStorage.setItem("tnt.sales.selectedEmployee",JSON.stringify(T))}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.employee.selected"))}catch{}}function E(T,P,R){const Y=Number((R||"").replace(/[,\s]/g,"")),X=Number.isFinite(Y)?Y:0;j(H=>{const M={...H[T]||{tnt:0,dys:0},[P]:X};return{...H,[T]:M}})}function S(T,P){const R=Math.max(0,Math.round(Number(T)||0)),Y=P.reduce((B,F)=>B+(Number(F.value)||0),0);if(!Number.isFinite(Y)||Y<=0||R<=0){const B={};return P.forEach(F=>{B[F.key]=0}),B}const H=P.map(B=>({key:B.key,exact:R*((Number(B.value)||0)/Y)})).map(B=>({key:B.key,floor:Math.floor(B.exact),frac:B.exact-Math.floor(B.exact)}));let q=H.reduce((B,F)=>B+F.floor,0),M=R-q;H.sort((B,F)=>F.frac-B.frac);for(let B=0;B<M&&H.length>0;B++){const F=B%H.length;H[F].floor+=1}const L={};return H.forEach(B=>{L[B.key]=B.floor}),L}async function k(){if(!l){c(!0);try{let T=null;try{const ee=localStorage.getItem("tnt.sales.assign.companyTotals");T=ee?JSON.parse(ee):null}catch{}const P=Math.round(Number((T==null?void 0:T.tnt)||0)),R=Math.round(Number((T==null?void 0:T.dys)||0));if(!Number.isFinite(P)||!Number.isFinite(R)){alert("회사별 목표 합계를 찾을 수 없습니다. 상단 패널을 확인하세요.");return}const Y=e.map(ee=>String(ee.empName||"").trim()).filter(ee=>!!ee);if(!Y.length){alert("대상 직원이 없습니다.");return}const X=new URL("/api/v1/sales/employee-yearly",window.location.origin);X.searchParams.set("year",String(d)),X.searchParams.set("empNames",Y.join(",")),X.searchParams.set("joinKey","emp_name");const H=await fetch(X.toString()),q=H.ok?await H.json():[],M=Array.isArray(q)?q:Array.isArray(q==null?void 0:q.employees)?q.employees:[],L={};Array.isArray(M)&&M.forEach(ee=>{const K=String(ee.emp_name??ee.empName??"").trim();if(!K)return;const ne=Number(ee.tnt_amount??0),pe=Number(ee.dys_amount??0),G=L[K]||{tnt:0,dys:0};L[K]={tnt:G.tnt+(Number.isFinite(ne)?ne:0),dys:G.dys+(Number.isFinite(pe)?pe:0)}});const B={};e.forEach(ee=>{const K=String(ee.empName||"").trim();B[K]=(B[K]||0)+1});const F=[],te=[];e.forEach(ee=>{const K=String(ee.empName||"").trim(),ne=L[K]||{tnt:0,dys:0},pe=Math.max(1,B[K]||1);F.push({key:ee.key,value:ne.tnt/pe}),te.push({key:ee.key,value:ne.dys/pe})});const $=S(P,F),W=S(R,te);j(ee=>{const K={...ee};return e.forEach(ne=>{K[ne.key]={tnt:$[ne.key]??0,dys:W[ne.key]??0}}),K});const U=ee=>Object.values(ee||{}).reduce((K,ne)=>K+(Number(ne)||0),0),Z=`TNT 합계 ${v.format(U($))} / 목표 ${v.format(P)}
DYS 합계 ${v.format(U(W))} / 목표 ${v.format(R)}`;U($)!==P||U(W)!==R?alert(`배정 완료(합계 보정 필요):
`+Z):alert(`배정이 완료되었습니다.
`+Z)}catch(T){alert((T==null?void 0:T.message)||"배정 중 오류가 발생했습니다.")}finally{c(!1)}}}return r.jsxs("section",{children:[r.jsx(WH,{}),r.jsxs("div",{className:"page-title",style:{alignItems:"center",marginTop:12},children:[r.jsxs("h2",{style:{margin:0,fontSize:18,display:"flex",alignItems:"center",gap:8},children:["목표배정",y?r.jsx("span",{className:"badge",title:"해당 연도 전체 단계",children:y}):null]}),r.jsxs("div",{style:{marginLeft:"auto",display:"inline-flex",alignItems:"center",gap:8},children:[r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>k(),disabled:l,title:"전년도 매출 비율로 자동 배정",children:"할당(매출 기반)"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>D(!1),title:"현재 배정값 저장",children:"저장"}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>D(!0),title:"현재 배정값 확정",children:"확정"})]})]}),a&&r.jsx("div",{className:"error",children:a}),r.jsx("div",{className:"table-container",style:{height:"calc(100vh - 140px)"},children:i?r.jsx("div",{className:"empty-state",children:"불러오는 중…"}):I.length===0?r.jsx("div",{className:"empty-state",children:"데이터가 없습니다"}):r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:140},children:"부서"}),r.jsx("th",{style:{width:140},children:"사번"}),r.jsx("th",{style:{width:180,textAlign:"left"},children:"이름"}),r.jsx("th",{style:{width:140,textAlign:"right"},children:"TNT"}),r.jsx("th",{style:{width:110,textAlign:"right"},children:"TNT 전년대비"}),r.jsx("th",{style:{width:140,textAlign:"right"},children:"DYS"}),r.jsx("th",{style:{width:110,textAlign:"right"},children:"DYS 전년대비"})]})}),r.jsx("tbody",{children:I.map((T,P)=>{var q,M;const R=b[T.key]||{tnt:0,dys:0},Y=String(T.empName||"").trim(),X=Number(((q=f[Y])==null?void 0:q.tnt)||0),H=Number(((M=f[Y])==null?void 0:M.dys)||0);return r.jsxs("tr",{onClick:()=>O(T),"aria-selected":(m==null?void 0:m.key)===T.key?!0:void 0,style:(m==null?void 0:m.key)===T.key?{background:"rgba(59,130,246,.12)"}:void 0,children:[r.jsx("td",{children:T.deptName}),r.jsx("td",{children:T.empId}),r.jsx("td",{style:{textAlign:"left"},children:T.empName}),r.jsx("td",{style:{textAlign:"right"},children:r.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9,]*",value:R.tnt?v.format(R.tnt):"",onChange:L=>E(T.key,"tnt",L.target.value),placeholder:"0",style:{width:"100%",textAlign:"right"},className:"assign-input","aria-label":`TNT 목표(${T.empName})`,title:C?"Moderate 모드에서는 목표 수정이 비활성화됩니다":"TNT 매출목표",disabled:C})}),r.jsx("td",{style:{textAlign:"right"},title:"해당 직원 전년도 TNT 매출 대비 올해 목표 비율",children:r.jsx("span",{className:"muted",children:_(R.tnt,X)})}),r.jsx("td",{style:{textAlign:"right"},children:r.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9,]*",value:R.dys?v.format(R.dys):"",onChange:L=>E(T.key,"dys",L.target.value),placeholder:"0",style:{width:"100%",textAlign:"right"},className:"assign-input","aria-label":`DYS 목표(${T.empName})`,title:C?"Moderate 모드에서는 목표 수정이 비활성화됩니다":"DYS 매출목표",disabled:C})}),r.jsx("td",{style:{textAlign:"right"},title:"해당 직원 전년도 DYS 매출 대비 올해 목표 비율",children:r.jsx("span",{className:"muted",children:_(R.dys,H)})})]},P)})})]})})]});async function D(T){try{const P=T?"확정":"기안중",Y=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase()==="moderate"?2:1,X=[],H=`${d}-01-01`;e.forEach(B=>{const F=b[B.key]||{tnt:0,dys:0};X.push({targetYear:H,empName:B.empName,companyName:"TNT",targetAmount:Math.round(F.tnt||0),targetStage:P,versionNo:Y}),X.push({targetYear:H,empName:B.empName,companyName:"DYS",targetAmount:Math.round(F.dys||0),targetStage:P,versionNo:Y})});const q=localStorage.getItem("tnt.sales.empSeq")||"",M={"Content-Type":"application/json"};q&&(M["X-EMP-SEQ"]=String(q));const L=await fetch("/api/v1/targets/assigned/upsert",{method:"POST",headers:M,body:JSON.stringify(X)});if(!L.ok)throw new Error(`HTTP ${L.status}`);T&&await fetch(`/api/v1/targets/assigned/confirm?year=${d}`,{method:"POST",headers:M}),alert(T?"배정이 확정되었습니다.":"배정이 저장되었습니다.")}catch(P){alert((P==null?void 0:P.message)||"배정 저장 중 오류가 발생했습니다.")}}}function qH(){const[e,n]=p.useState([]),[i,s]=p.useState(!1),[a,o]=p.useState(null),[l,c]=p.useState("ALL"),[d,u]=p.useState("mine");function f(){const L=new Date,B=String(L.getFullYear()%100).padStart(2,"0"),F=String(L.getMonth()+1).padStart(2,"0"),te=String(L.getDate()).padStart(2,"0");return`${B}-${F}-${te}`}const[h,m]=p.useState(f()),[g,b]=p.useState(f()),[j,y]=p.useState(null),[x,v]=p.useState(null),A=p.useRef(null),[N,C]=p.useState(null),[w,_]=p.useState(null),[I,O]=p.useState(null),[E,S]=p.useState("");async function k(L){if(L==="ALL")return"";try{const B=typeof window<"u"&&localStorage.getItem("tnt.sales.assigneeId")||"",F=typeof window<"u"&&localStorage.getItem("tnt.sales.empId")||"",te=new URLSearchParams;B&&te.set("assigneeId",B),F&&te.set("empId",F),te.set("companyCode",L);const $=await fetch(`/api/v1/employee/by-assignee?${te.toString()}`,{cache:"no-store"});if(!$.ok)return"";const W=await $.json().catch(()=>null),U=(W==null?void 0:W.resolvedSalesEmpSeq)??(L==="DYS"?W==null?void 0:W.dys_emp_seq:W==null?void 0:W.tnt_emp_seq);return U!=null&&String(U)?String(U):""}catch{return""}}async function D(){try{const L=typeof window<"u"&&localStorage.getItem("tnt.sales.assigneeId")||"",B=typeof window<"u"&&localStorage.getItem("tnt.sales.empId")||"",F=new URLSearchParams;L&&F.set("assigneeId",L),B&&F.set("empId",B);const te=await fetch(`/api/v1/employee/by-assignee?${F.toString()}`,{cache:"no-store"});if(!te.ok)return{tntEmpSeq:"",dysEmpSeq:""};const $=await te.json().catch(()=>null),W=$==null?void 0:$.tnt_emp_seq,U=$==null?void 0:$.dys_emp_seq;return{tntEmpSeq:W!=null&&String(W)?String(W):"",dysEmpSeq:U!=null&&String(U)?String(U):""}}catch{return{tntEmpSeq:"",dysEmpSeq:""}}}function T(L){if(!L)return"";let B=String(L).trim();const F=B.replace(/[^0-9]/g,"");if(F.length===6){const W=F.slice(0,2),U=F.slice(2,4),Z=F.slice(4,6);return P(W,U,Z)?`${W}-${U}-${Z}`:null}if(F.length===8){const W=F.slice(2,4),U=F.slice(4,6),Z=F.slice(6,8);return P(W,U,Z)?`${W}-${U}-${Z}`:null}const te=B.match(/^\s*(\d{2})[-/](\d{2})[-/](\d{2})\s*$/);if(te){const[,W,U,Z]=te;return P(W,U,Z)?`${W}-${U}-${Z}`:null}const $=B.match(/^\s*(\d{4})[-/](\d{2})[-/](\d{2})\s*$/);if($){const[,W,U,Z]=$,ee=W.slice(2);return P(ee,U,Z)?`${ee}-${U}-${Z}`:null}return null}function P(L,B,F){const te=Number(L),$=Number(B),W=Number(F);return!(!Number.isInteger(te)||!Number.isInteger($)||!Number.isInteger(W)||$<1||$>12||W<1||W>31||W>[31,28,31,30,31,30,31,31,30,31,30,31][$-1])}function R(L){const B=L.match(/^(\d{2})-(\d{2})-(\d{2})$/);return B?`20${B[1]}-${B[2]}-${B[3]}`:null}function Y(L){try{let B=String(L??"");return B=B.replace(/\r\n/g,`
`).replace(/\r/g,`
`).replace(/\\n/g,`
`),B}catch{return String(L??"")}}function X(L){const B=String(L??"").trim();if(!B)return"";const F=B.replace(/[^0-9]/g,"");return F.length===8?`${F.slice(0,4)}-${F.slice(4,6)}-${F.slice(6,8)}`:F.length===6?`20${F.slice(0,2)}-${F.slice(2,4)}-${F.slice(4,6)}`:B}async function H(L=!1){const B=h.trim(),F=g.trim();let te=B?T(B):"",$=F?T(F):"";if(_(null),O(null),B&&!te){_("형식: YY-MM-DD");return}if(F&&!$){O("형식: YY-MM-DD");return}if(typeof te=="string"&&m(te),typeof $=="string"&&b($),te&&$){const W=R(te),U=R($);if(W>U){O("종료일이 시작일보다 빠릅니다");return}}s(!0),o(null);try{const W=new URL("/api/v1/orders/external/tsl-order-text",window.location.origin);W.searchParams.set("company",l),te&&W.searchParams.set("fromDate",te),$&&W.searchParams.set("toDate",$);const U=E.trim().length>0;if(U&&W.searchParams.set("custName",E.trim()),d==="mine")if(l==="ALL"){if(!U){const{tntEmpSeq:ne,dysEmpSeq:pe}=await D();ne&&W.searchParams.set("tntSalesEmpSeq",ne),pe&&W.searchParams.set("dysSalesEmpSeq",pe)}}else{const ne=await k(l);ne&&W.searchParams.set("salesEmpSeq",ne)}const Z=await fetch(W.toString(),{cache:"no-store"});if(!Z.ok)throw new Error(`HTTP ${Z.status}`);const ee=await Z.json().catch(()=>[]),K=Array.isArray(ee)?ee:[];n(K)}catch(W){o((W==null?void 0:W.message)||"조회 실패"),n([])}finally{s(!1)}}p.useEffect(()=>{if(!(x!=null&&x.open))return;const L=F=>{const te=A.current;te&&F.target instanceof Node&&!te.contains(F.target)&&v(null)},B=F=>{F.key==="Escape"&&v(null)};return document.addEventListener("mousedown",L,!0),window.addEventListener("keydown",B,!0),()=>{document.removeEventListener("mousedown",L,!0),window.removeEventListener("keydown",B,!0)}},[x==null?void 0:x.open]);const q=p.useMemo(()=>{if(!e.length)return[];const L=e[0];return Object.keys(L)},[e]);function M(L){const B=(L||"").toString();return/^OrderTextNo$/i.test(B)?"수주장번호":/^OrderTextDate$/i.test(B)||/^OrderTextDat$/i.test(B)?"주문일자":/^CustSeq$/i.test(B)||/^CustName$/i.test(B)||/^CustomerName$/i.test(B)?"거래처명":/^RegionGroup$/i.test(B)||/^region_group$/i.test(B)?"지역그룹":/^SalesEmpSeq$/i.test(B)?"영업":/^OrderText$/i.test(B)?"수주내역":/^IsCancel$/i.test(B)?"중단여부":/^CancelText$/i.test(B)?"중단사유":/^Remark$/i.test(B)?"비고":/^LastDateTime$/i.test(B)?"최종수정일시":/^WHSeq$/i.test(B)?"창고번호":/^DelvDate$/i.test(B)?"납기예정일":/^CustEmpName$/i.test(B)?"거래처담당":/^IsClaim$/i.test(B)?"Claim":/^OrderRemark$/i.test(B)?"주문요청사항":/^Request(Date|Dt)$/i.test(B)||/^ReqDate$/i.test(B)?"요청일자":B}return r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"수주장 조회"}),r.jsxs("div",{style:{marginLeft:16,background:"#f3f4f6",padding:4,borderRadius:8,display:"flex",gap:0},children:[r.jsx("button",{onClick:()=>c("ALL"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:l==="ALL"?"#fff":"transparent",color:l==="ALL"?"#2563eb":"#6b7280",boxShadow:l==="ALL"?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:"ALL"}),r.jsx("button",{onClick:()=>c("TNT"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:l==="TNT"?"#fff":"transparent",color:l==="TNT"?"#2563eb":"#6b7280",boxShadow:l==="TNT"?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:"TNT"}),r.jsx("button",{onClick:()=>c("DYS"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:l==="DYS"?"#fff":"transparent",color:l==="DYS"?"#2563eb":"#6b7280",boxShadow:l==="DYS"?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:"DYS"})]}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",alignItems:"center",gap:12,fontSize:12},children:[r.jsxs("select",{className:"search-input",value:d,onChange:L=>u(L.target.value||"all"),title:"조회 범위",style:{minWidth:110},children:[r.jsx("option",{value:"mine",children:"내수주"}),r.jsx("option",{value:"all",children:"전체"})]}),r.jsx("label",{className:"muted",children:"수주일"}),r.jsx("input",{className:"search-input",placeholder:"YY-MM-DD",value:h,onChange:L=>{m(L.target.value),w&&_(null)},onBlur:L=>{const B=T(L.target.value);B===null&&L.target.value.trim()?_("형식: YY-MM-DD"):typeof B=="string"&&m(B)},style:{width:90}}),w?r.jsx("div",{className:"error",style:{fontSize:11},children:w}):null,r.jsx("span",{className:"muted",children:"~"}),r.jsx("input",{className:"search-input",placeholder:"YY-MM-DD",value:g,onChange:L=>{b(L.target.value),I&&O(null)},onBlur:L=>{const B=T(L.target.value);B===null&&L.target.value.trim()?O("형식: YY-MM-DD"):typeof B=="string"&&b(B)},style:{width:90}}),I?r.jsx("div",{className:"error",style:{fontSize:11},children:I}):null,r.jsx("label",{className:"muted",children:"거래처명"}),r.jsx("input",{className:"search-input",placeholder:"검색어(공백으로 AND)",value:E,onChange:L=>S(L.target.value),style:{width:200}}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>H(!0),disabled:!!w||!!I||i,children:"조회"})]})]}),a?r.jsx("div",{className:"error",children:a}):null,r.jsx("div",{className:"table-container",style:{height:"calc(100vh - 160px)"},children:i?r.jsx("div",{className:"empty-state",children:"불러오는 중…"}):e.length===0?r.jsx("div",{className:"empty-state",children:"데이터가 없습니다"}):r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsx("tr",{children:q.map(L=>r.jsx("th",{children:M(L)},L))})}),r.jsx("tbody",{children:e.map((L,B)=>{const F=Object.keys(L).find($=>$.toLowerCase()==="companytype"),te=F?String(L[F]||"").trim().toUpperCase():"";return r.jsx("tr",{onMouseEnter:$=>{const W=($.clientX||0)+12,U=($.clientY||0)+12;x!=null&&x.open||y({open:!0,x:W,y:U,rec:L})},onMouseMove:$=>{if(!(j!=null&&j.open))return;const W=($.clientX||0)+12,U=($.clientY||0)+12;x!=null&&x.open||y({open:!0,x:W,y:U,rec:L})},onMouseLeave:()=>y(null),onContextMenu:$=>{$.preventDefault();const W=$.clientX,U=$.clientY;v({open:!0,x:W,y:U,rec:L})},children:q.map($=>{const W=/^(CustSeq|CustName|CustomerName|customer_name)$/i.test($)||M($)==="거래처명",U=String((L==null?void 0:L[$])??"");if(W&&te){const Z=te.includes("TNT"),ee=te.includes("DYS"),K=Z?"T":ee?"D":"",ne=Z?"#1d4ed8":ee?"#059669":"#6b7280";return r.jsx("td",{children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[K&&r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:"50%",background:ne,color:"#fff",fontSize:11,fontWeight:700,flexShrink:0},title:te,children:K}),r.jsx("span",{children:U})]})},$)}return r.jsx("td",{children:U},$)})},B)})})]})}),j!=null&&j.open&&!(x!=null&&x.open)?r.jsx("div",{role:"dialog","aria-live":"polite",style:{position:"fixed",left:Math.min(Math.max(8,j.x),window.innerWidth-460),top:Math.min(Math.max(8,j.y),window.innerHeight-300),zIndex:80,pointerEvents:"none"},children:r.jsx("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:8,minWidth:320,maxWidth:600,maxHeight:"85vh",overflow:"auto",boxShadow:"0 8px 24px rgba(0,0,0,.18)"},children:r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:q.map(L=>{const B=(j.rec||{})[L],F=Y(B);return r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10,paddingBottom:6,borderBottom:"1px solid var(--border-light)"},children:[r.jsx("div",{style:{minWidth:120,fontWeight:600,fontSize:12,color:"var(--text-secondary)"},children:M(L)}),r.jsx("div",{style:{flex:1,whiteSpace:"pre-wrap",fontSize:12,wordBreak:"break-word"},children:F||r.jsx("span",{style:{color:"var(--text-muted)",fontStyle:"italic"},children:"-"})})]},L)})})})}):null,x!=null&&x.open?(()=>{const L=Math.min(Math.max(8,x.x),window.innerWidth-220),B=Math.min(Math.max(8,x.y),window.innerHeight-120);async function F(){try{const $=q.find(de=>/^OrderText$/i.test(de))||q.find(de=>M(de)==="수주내역"),W=q.find(de=>/^OrderRemark$/i.test(de))||q.find(de=>M(de)==="주문요청사항"),U=q.find(de=>M(de)==="거래처명")||q.find(de=>/^(CustName|CustomerName|customer_name|CustSeq)$/i.test(de)),Z=q.find(de=>/^(UserName|CreatedBy|created_by)$/i.test(de)),ee=q.find(de=>/^(RegionGroup|region_group)$/i.test(de)),K=l,ne=U?String((x.rec||{})[U]??""):"";let pe=Z?String((x.rec||{})[Z]??""):"",G=ee?String((x.rec||{})[ee]??""):"",ae=$?Y((x.rec||{})[$]):"";const ie=W?Y((x.rec||{})[W]):"";if(!pe){const de=q.find(he=>M(he)==="영업");de&&(pe=String((x.rec||{})[de]??""))}if(ae){const de=String(ae).split(/\n/),he=[];for(const oe of de){const V=oe.match(/^\s*지역\s*그룹\s*[:：]\s*(.*)\s*$/)||oe.match(/^\s*지역그룹\s*[:：]\s*(.*)\s*$/);if(V){const Pe=(V[1]||"").trim();!G&&Pe&&(G=Pe)}else he.push(oe)}ae=he.join(`
`)}let J=[];J.push(`회사코드: ${K}`),J.push(`거래처: ${ne}`),J.push(`등록자: ${pe}`),J.push(`지역 그룹: ${G}`),J.push("주문내용:"),J.push(ae),J.push("요청사항:"),J.push(ie);let re=J.join(`
`);if(!ae&&!ie&&(re=JSON.stringify(x.rec??{},null,2)),navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(re);else{const de=document.createElement("textarea");de.value=re,de.style.position="fixed",de.style.left="-9999px",document.body.appendChild(de),de.focus(),de.select(),document.execCommand("copy"),document.body.removeChild(de)}C({open:!0,x:L+8,y:B+8}),setTimeout(()=>C(null),1200)}catch{}v(null)}async function te(){try{const $=q.find(V=>/^OrderText$/i.test(V))||q.find(V=>M(V)==="수주내역"),W=q.find(V=>/^OrderRemark$/i.test(V))||q.find(V=>M(V)==="주문요청사항"),U=q.find(V=>M(V)==="거래처명")||q.find(V=>/^(CustName|CustomerName|customer_name|CustSeq)$/i.test(V)),Z=q.find(V=>M(V)==="수주장번호")||q.find(V=>/^OrderTextNo$/i.test(V)),ee=[q.find(V=>M(V)==="요청일자"),q.find(V=>/^Request(Date|Dt)$/i.test(V)),q.find(V=>/^DelvDate$/i.test(V)),q.find(V=>/^OrderTextDate$/i.test(V))].filter(Boolean);let K="";const ne=q.find(V=>/^(UserName|CreatedBy|created_by)$/i.test(V));if(ne&&(K=String((x.rec||{})[ne]??"")),!K){const V=q.find(Pe=>M(Pe)==="영업");V&&(K=String((x.rec||{})[V]??""))}let pe="";const G=q.find(V=>/^(RegionGroup|region_group)$/i.test(V));G&&(pe=String((x.rec||{})[G]??""));let ae=$?Y((x.rec||{})[$]):"";const ie=W?Y((x.rec||{})[W]):"";if(ae){const V=String(ae).split(/\n/),Pe=[];for(const Ve of V){const tt=Ve.match(/^\s*지역\s*그룹\s*[:：]\s*(.*)\s*$/)||Ve.match(/^\s*지역그룹\s*[:：]\s*(.*)\s*$/);if(tt){const ot=(tt[1]||"").trim();!pe&&ot&&(pe=ot)}else Pe.push(Ve)}ae=Pe.join(`
`)}const J=Z?String((x.rec||{})[Z]??"").trim():"";let re="";for(const V of ee){const Pe=V?String((x.rec||{})[V]??"").trim():"";if(Pe){re=X(Pe);break}}const de={orderNo:J,companyCode:l,customerName:U?String((x.rec||{})[U]??""):"",createdBy:K,regionGroup:pe,orderText:ae,orderRemark:ie,requestDate:re},he=await fetch("/api/v1/slack/send-order-copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(de)}),oe=await he.json().catch(()=>({}));he.ok&&oe.success?(C({open:!0,x:L+8,y:B+8,message:"Slack 전송 완료"}),setTimeout(()=>C(null),1500)):alert(oe.message||`Slack 전송 실패 (HTTP ${he.status})`)}catch($){console.error("Slack 전송 실패:",$),alert("Slack 전송 중 오류가 발생했습니다.")}v(null)}return r.jsx("div",{ref:A,role:"menu",style:{position:"fixed",left:L,top:B,zIndex:90,minWidth:180},children:r.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:4,border:"1px solid var(--border)",borderRadius:8,boxShadow:"0 8px 24px rgba(0,0,0,.18)",display:"flex",flexDirection:"column",gap:2,fontSize:13},children:[r.jsx("button",{className:"btn-plain",style:{width:"100%",textAlign:"left",padding:"4px 6px",fontSize:13},onClick:te,children:"Slack전송"}),r.jsx("button",{className:"btn-plain",style:{width:"100%",textAlign:"left",padding:"4px 6px",fontSize:13},onClick:F,children:"복사"})]})})})():null,N!=null&&N.open?r.jsx("div",{style:{position:"fixed",left:N.x,top:N.y,zIndex:95},children:r.jsx("div",{className:"card",style:{background:"var(--panel)",padding:"2px 6px",border:"1px solid var(--border)",borderRadius:6,fontSize:11},children:N.message||"복사했습니다"})}):null]})}function UH({customer:e,onOrderCreated:n}){const[i,s]=p.useState(""),[a,o]=p.useState([]),[l,c]=p.useState(!1),[,d]=p.useState(!1),[u,f]=p.useState([]),[h,m]=p.useState({}),[g,b]=p.useState(!0),[j,y]=p.useState({open:!1,x:0,y:0}),x=p.useRef(null),[v,A]=p.useState([]),[,N]=p.useState({}),[C,w]=p.useState(""),[_,I]=p.useState(""),[O,E]=p.useState(()=>{const G=new Date;return G.setMinutes(G.getMinutes()-G.getTimezoneOffset()),G.toISOString().slice(0,10)}),S=(()=>{try{return localStorage.getItem("tnt.sales.empName")||localStorage.getItem("tnt.sales.empId")||""}catch{return""}})(),k=(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||""}catch{return""}})(),[D,T]=p.useState(!1),[P,R]=p.useState(()=>({open:!1,text:""})),[Y,X]=p.useState("");function H(G){try{const ie=[JSON.parse(G)];let J=null;for(;ie.length;){const re=ie.shift();if(Array.isArray(re)){if(re.length&&typeof re[0]=="object"){J=re;break}}else if(re&&typeof re=="object")for(const de of Object.keys(re))ie.push(re[de])}return J?J.map(re=>{const de=(re==null?void 0:re.WHName)??(re==null?void 0:re.whName)??(re==null?void 0:re.warehouseName)??(re==null?void 0:re.WH_NM)??(re==null?void 0:re.wh_nm)??"",he=Number((re==null?void 0:re.AvailStock)??(re==null?void 0:re.availStock)??(re==null?void 0:re.AVAIL_STOCK)??(re==null?void 0:re.qty)??0)||0,oe=(re==null?void 0:re.UnitName)??(re==null?void 0:re.unitName)??(re==null?void 0:re.UNIT_NAME)??(re==null?void 0:re.salesMgmtUnit)??"";return{whName:String(de||""),avail:he,unitName:String(oe||"")}}):[]}catch{return[]}}async function q(G){const ae=k||"",ie=(()=>{try{return localStorage.getItem("tnt.sales.empId")||""}catch{return""}})();if(!ae&&!ie)return(()=>{try{return localStorage.getItem("tnt.sales.empSeq")||""}catch{return""}})()||"4";try{const J=new URLSearchParams;ae&&J.set("assigneeId",ae),ie&&J.set("empId",ie),G&&J.set("companyCode",G);const re=await fetch(`/api/v1/employee/by-assignee?${J.toString()}`,{cache:"no-store"});if(!re.ok)return(()=>{try{return localStorage.getItem("tnt.sales.empSeq")||""}catch{return""}})()||"4";const de=await re.json().catch(()=>null),he=(de==null?void 0:de.resolvedSalesEmpSeq)??((G==null?void 0:G.toUpperCase())==="DYS"?de==null?void 0:de.dys_emp_seq:de==null?void 0:de.tnt_emp_seq),oe=he!=null&&String(he)?String(he):"";return oe||(()=>{try{return localStorage.getItem("tnt.sales.empSeq")||""}catch{return""}})()||"4"}catch{return(()=>{try{return localStorage.getItem("tnt.sales.empSeq")||""}catch{return""}})()||"4"}}async function M(){try{c(!0);const G=new URLSearchParams;G.set("q",i.trim());const ae=(e==null?void 0:e.companyType)||(e==null?void 0:e.companyCode);ae&&G.set("companyType",ae),(e==null?void 0:e.customerSeq)!=null&&G.set("customerSeq",String(e.customerSeq));const ie=await fetch(`/api/v1/items/search?${G.toString()}`),J=ie.ok?await ie.json():[],re=Array.isArray(J)?J.map(de=>({itemSeq:de==null?void 0:de.itemSeq,itemName:String((de==null?void 0:de.itemName)??""),recentInvoiceDate:(de==null?void 0:de.recentInvoiceDate)??(de==null?void 0:de.recent_invoice_date)??null,curAmt:(de==null?void 0:de.curAmt)??null,qty:(de==null?void 0:de.qty)??null,srcPri:(de==null?void 0:de.srcPri)!=null?Number(de.srcPri):void 0,itemStdUnit:(de==null?void 0:de.itemStdUnit)??(de==null?void 0:de.item_std_unit)??null,companyType:(de==null?void 0:de.companyType)||(de==null?void 0:de.company_type)||null})):[];o(re),re.length>0&&B(re.map(de=>({itemSeq:de.itemSeq,itemName:de.itemName})))}catch{o([])}finally{c(!1)}}function L(G){if(!(G==null||G.itemName==null)){d(!0);try{const ae=G.itemStdUnit??void 0;if(v.findIndex(J=>String(J.itemName)===String(G.itemName))>=0){alert("이미 주문에 포함되어 있습니다."),d(!1);return}else{const J={itemSeq:G.itemSeq,itemName:G.itemName,itemSpec:"",qty:"",itemStdUnit:ae,companyType:G.companyType||null};A(re=>[...re,J])}}catch{}finally{d(!1)}}}async function B(G){const ae={};await Promise.all(G.map(async ie=>{const J=ie.itemSeq!=null?String(ie.itemSeq):ie.itemName;try{const re={bizUnit:"",stdDate:"",whSeq:"",itemName:String(ie.itemName||""),itemNo:"",itemSeq:String(ie.itemSeq||""),pageNo:"",pageSize:""},de=await fetch("/api/v1/items/avail-stock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(re)});if(de.ok){const he=await de.json().catch(()=>({})),oe=he&&(he.receivedPayload||he),V=JSON.stringify(oe,null,2),Ve=H(V).reduce((tt,ot)=>tt+(ot.avail||0),0);ae[J]=Ve>0}else ae[J]=!1}catch{ae[J]=!1}})),m(ie=>({...ie,...ae}))}async function F(G,ae){const J=G.currentTarget.getBoundingClientRect(),re=J.right,de=J.bottom;y({open:!0,x:re,y:de,loading:!0});try{const he={bizUnit:"",stdDate:"",whSeq:"",itemName:String(ae.itemName||""),itemNo:"",itemSeq:String(ae.itemSeq||""),pageNo:"",pageSize:""},oe=await fetch("/api/v1/items/avail-stock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(he)});if(oe.ok){const V=await oe.json().catch(()=>({})),Pe=V&&(V.receivedPayload||V),Ve=JSON.stringify(Pe,null,2),tt=H(Ve);y({open:!0,x:re,y:de,loading:!1,error:null,rows:tt})}else y({open:!0,x:re,y:de,loading:!1,error:`HTTP ${oe.status}`})}catch(he){y({open:!0,x:re,y:de,loading:!1,error:(he==null?void 0:he.message)||"재고 조회 실패"})}}p.useEffect(()=>{if(!j.open)return;const G=ie=>{const J=x.current;J&&ie.target instanceof Node&&!J.contains(ie.target)&&y({open:!1,x:0,y:0})},ae=ie=>{ie.key==="Escape"&&y({open:!1,x:0,y:0})};return document.addEventListener("mousedown",G,!0),window.addEventListener("keydown",ae,!0),()=>{document.removeEventListener("mousedown",G,!0),window.removeEventListener("keydown",ae,!0)}},[j.open]),p.useEffect(()=>{if(!e)return;const G=e.addrProvinceName??"",ae=e.addrCityName??"",ie=[G,ae].filter(J=>!!J&&String(J).trim().length>0).join(" ");ie&&w(String(ie)),X(""),I(""),A([]),N({}),s(""),o([]),te(e.customerSeq)},[e==null?void 0:e.customerSeq]);async function te(G){try{f([]);const ae=G!=null?Number(G):NaN;if(!Number.isFinite(ae))return;const ie=await fetch(`/api/v1/customers/${ae}/transactions`,{cache:"no-store"});if(!ie.ok)return;const J=await ie.json().catch(()=>[]);if(!Array.isArray(J)){f([]);return}const re=Date.now()-365*24*60*60*1e3,de={};for(const oe of J){const V=String((oe==null?void 0:oe.itemName)??(oe==null?void 0:oe.item_name)??"").trim();if(!V)continue;const Pe=(oe==null?void 0:oe.itemSeq)??(oe==null?void 0:oe.item_seq)??null,Ve=(oe==null?void 0:oe.companyType)??(oe==null?void 0:oe.company_type)??null,tt=(oe==null?void 0:oe.itemStdUnit)??(oe==null?void 0:oe.item_std_unit)??null,ot=Number((oe==null?void 0:oe.curAmt)??(oe==null?void 0:oe.cur_amt)??0)||0,ht=Number((oe==null?void 0:oe.qty)??0)||0,vt=String((oe==null?void 0:oe.invoiceDate)??(oe==null?void 0:oe.invoice_date)??""),Se=Date.parse(vt)||Date.parse(vt.replace(" ","T"))||NaN;if(!Number.isFinite(Se)||Se<re)continue;const je=Pe!=null?String(Pe):V,Te=de[je]||{itemSeq:Pe,itemName:V,companyType:Ve||null,itemStdUnit:tt||null,recent:0,totalAmt:0,totalQty:0};Te.totalAmt+=ot,Te.totalQty+=ht,Se>Te.recent&&(Te.recent=Se),Te.itemSeq==null&&Pe!=null&&(Te.itemSeq=Pe),!Te.companyType&&Ve&&(Te.companyType=Ve),!Te.itemStdUnit&&tt&&(Te.itemStdUnit=tt),de[je]=Te}const he=Object.values(de).sort((oe,V)=>V.recent-oe.recent||oe.itemName.localeCompare(V.itemName,"ko",{sensitivity:"base"})).map(oe=>({itemSeq:oe.itemSeq,itemName:oe.itemName,companyType:oe.companyType,itemStdUnit:oe.itemStdUnit,recentDate:new Date(oe.recent).toISOString().slice(0,10),totalAmt:oe.totalAmt,totalQty:oe.totalQty}));f(he),he.length>0&&B(he.map(oe=>({itemSeq:oe.itemSeq,itemName:oe.itemName})))}catch{f([])}}async function $(G){const ae=a.find(ie=>String(ie.itemName).trim()===String(G).trim());if(ae&&ae.itemSeq!=null)return{itemSeq:ae.itemSeq,itemName:ae.itemName};try{const ie=new URLSearchParams;ie.set("q",G);const J=(e==null?void 0:e.companyType)||(e==null?void 0:e.companyCode);J&&ie.set("companyType",J),(e==null?void 0:e.customerSeq)!=null&&ie.set("customerSeq",String(e.customerSeq));const re=await fetch(`/api/v1/items/search?${ie.toString()}`),de=re.ok?await re.json():[],he=Array.isArray(de)?de:[],oe=he.find(V=>String((V==null?void 0:V.itemName)||"").trim()===String(G).trim())||he[0];if(oe&&oe.itemSeq!=null)return{itemSeq:oe.itemSeq,itemName:String(oe.itemName||G)}}catch{}return null}async function W(G,ae){if(ae.itemSeq!=null)await F(G,ae);else{const ie=await $(ae.itemName);ie&&await F(G,ie)}}async function U(G){let ae=G;if(!ae.itemSeq){const ie=await $(G.itemName);if(!ie)return;ae={...ae,...ie}}L({itemSeq:ae.itemSeq,itemName:ae.itemName,companyType:ae.companyType||void 0,itemStdUnit:ae.itemStdUnit||void 0})}function Z(G){A(ae=>ae.filter((ie,J)=>J!==G))}function ee(G,ae){A(ie=>{const J=ie.slice();if(ae==="")J[G]={...J[G],qty:""};else{const re=Number(ae);if(!isFinite(re)||re<0)J[G]={...J[G],qty:""};else{const de=Math.floor(re*100)/100;J[G]={...J[G],qty:de}}}return J})}async function K(){var G,ae,ie,J,re,de;T(!0);try{const he=String((e==null?void 0:e.companyCode)||(e==null?void 0:e.companyType)||"TNT"),oe=await q(he),V={"Content-Type":"application/json"};k&&(V["X-ASSIGNEE-ID"]=String(k));const Pe={companyCode:he,customerSeq:(e==null?void 0:e.customerSeq)!=null?String(e.customerSeq):"",customerName:String((e==null?void 0:e.customerName)||""),assigneeId:k||"",regionGroup:C,requests:_,deliveryDueDate:O,createdBy:S||"",custEmpName:String((e==null?void 0:e.ownerName)||""),salesEmpSeq:oe||void 0,items:(v||[]).map(ht=>({itemSeq:String(ht.itemSeq||""),itemName:ht.itemName,itemSpec:ht.itemSpec||"",qty:Number(ht.qty)||0,itemStdUnit:ht.itemStdUnit||void 0,companyType:ht.companyType||void 0}))},Ve=await fetch("/api/v1/orders",{method:"POST",headers:V,body:JSON.stringify(Pe)}),tt=await Ve.json().catch(()=>({}));if(!Ve.ok)throw new Error((tt==null?void 0:tt.error)||`HTTP ${Ve.status}`);const ot=String((tt==null?void 0:tt.orderTextNo)||((de=(re=(J=(ie=(ae=(G=tt==null?void 0:tt.sendPayload)==null?void 0:G.ROOT)==null?void 0:ae.data)==null?void 0:ie.ROOT)==null?void 0:J.DataBlock1)==null?void 0:re[0])==null?void 0:de.OrderTextNo)||"");X(ot),R({open:!0,text:"주문 전송 완료"}),n&&ot&&n(ot),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.order.created"))}catch(he){R({open:!0,text:(he==null?void 0:he.message)||"주문 전송 중 오류가 발생했습니다"})}finally{T(!1)}}const ne=({type:G})=>{const ae=(G||"").toUpperCase(),ie=ae==="TNT"?"T":ae==="DYS"?"D":ae==="ALL"?"A":"",J=ae==="TNT"?"var(--primary)":ae==="DYS"?"var(--success)":ae==="ALL"?"var(--warning)":"var(--text-secondary)";return ie?r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:"50%",background:J,color:"var(--on-accent)",fontSize:11,fontWeight:800},children:ie}):null},pe=new Intl.NumberFormat("ko-KR");return r.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",gap:16},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,flex:1,minHeight:0},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12,minHeight:0,overflow:"hidden"},children:[u.length>0&&r.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8,flexShrink:0},children:[r.jsxs("div",{style:{padding:"8px 12px",background:"var(--bg-secondary)",borderBottom:g?"1px solid var(--border)":"none",fontSize:12,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"space-between",cursor:"pointer"},onClick:()=>b(!g),children:[r.jsxs("span",{children:["최근 거래내역 (",u.length,"건)"]}),g?r.jsx(wf,{size:16}):r.jsx(ko,{size:16})]}),g&&r.jsx("div",{style:{maxHeight:"20vh",overflow:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"var(--bg-secondary)"},children:[r.jsx("th",{style:{padding:"6px 10px",textAlign:"left",borderBottom:"1px solid var(--border)"},children:"품목"}),r.jsx("th",{style:{padding:"6px 10px",textAlign:"left",borderBottom:"1px solid var(--border)",width:80},children:"최근거래일"}),r.jsx("th",{style:{padding:"6px 10px",textAlign:"right",borderBottom:"1px solid var(--border)",width:80},children:"총금액"}),r.jsx("th",{style:{padding:"6px 10px",textAlign:"center",borderBottom:"1px solid var(--border)",width:70}})]})}),r.jsx("tbody",{children:u.map((G,ae)=>r.jsxs("tr",{children:[r.jsx("td",{style:{padding:"6px 10px",borderBottom:"1px solid var(--border)",color:"var(--primary)",fontWeight:500},children:G.itemName}),r.jsx("td",{style:{padding:"6px 10px",borderBottom:"1px solid var(--border)"},children:G.recentDate}),r.jsx("td",{style:{padding:"6px 10px",borderBottom:"1px solid var(--border)",textAlign:"right"},children:pe.format(G.totalAmt)}),r.jsx("td",{style:{padding:"6px 10px",borderBottom:"1px solid var(--border)",textAlign:"center"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:4},children:[(()=>{const ie=G.itemSeq!=null?String(G.itemSeq):G.itemName,re=h[ie]===!1;return r.jsx("button",{className:"btn btn-secondary",style:{width:24,height:24,padding:0,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:re?"var(--error)":void 0,borderColor:re?"var(--error)":void 0},onClick:de=>W(de,{itemSeq:G.itemSeq,itemName:G.itemName}),title:re?"재고 없음 - 클릭하여 상세 조회":"재고 조회",children:r.jsx(cc,{size:12,style:{color:re?"var(--error)":void 0}})})})(),r.jsx("button",{className:"btn btn-primary",style:{width:24,height:24,padding:0,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},onClick:()=>U(G),title:"담기",children:r.jsx(mr,{size:12})})]})})]},ae))})]})})]}),r.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8,flex:1,display:"flex",flexDirection:"column",minHeight:0},children:[r.jsx("div",{style:{padding:12,borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsxs("div",{style:{flex:1,position:"relative"},children:[r.jsx("input",{type:"text",className:"input",placeholder:"품목명 검색",value:i,onChange:G=>s(G.target.value),onKeyDown:G=>{G.key==="Enter"&&M()},style:{width:"100%",paddingLeft:32,fontSize:13}}),r.jsx(Fn,{size:14,style:{position:"absolute",left:10,top:"50%",transform:"translateY(-50%)",opacity:.5}})]}),r.jsx("button",{className:"btn btn-primary",onClick:()=>M(),disabled:l,style:{fontSize:12,padding:"6px 12px"},children:l?"검색 중...":"품목 조회"})]})}),r.jsx("div",{style:{flex:1,overflow:"auto"},children:a.length===0?r.jsx("div",{style:{padding:32,textAlign:"center",color:"var(--text-secondary)",fontSize:13},children:l?"품목 불러오는 중…":"품목을 검색해주세요"}):r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"var(--bg-secondary)"},children:[r.jsx("th",{style:{padding:"6px 10px",textAlign:"left",borderBottom:"1px solid var(--border)"},children:"품목명"}),r.jsx("th",{style:{padding:"6px 10px",textAlign:"left",borderBottom:"1px solid var(--border)",width:80},children:"최근거래일"}),r.jsx("th",{style:{padding:"6px 10px",textAlign:"right",borderBottom:"1px solid var(--border)",width:80},children:"총금액"}),r.jsx("th",{style:{padding:"6px 10px",textAlign:"center",borderBottom:"1px solid var(--border)",width:70}})]})}),r.jsx("tbody",{children:a.map((G,ae)=>r.jsxs("tr",{onDoubleClick:()=>L(G),title:"더블클릭하면 수주장에 담습니다",style:{cursor:"pointer"},onMouseEnter:ie=>ie.currentTarget.style.background="var(--bg-secondary)",onMouseLeave:ie=>ie.currentTarget.style.background="transparent",children:[r.jsx("td",{style:{padding:"6px 10px",borderBottom:"1px solid var(--border)"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[r.jsx(ne,{type:G.companyType}),r.jsx("span",{style:G.srcPri===0?{color:"var(--primary)",fontWeight:500}:void 0,children:G.itemName}),G.itemStdUnit&&r.jsxs("span",{style:{fontSize:10,color:"var(--text-secondary)"},children:["(",G.itemStdUnit,")"]})]})}),r.jsx("td",{style:{padding:"6px 10px",borderBottom:"1px solid var(--border)"},children:G.recentInvoiceDate||""}),r.jsx("td",{style:{padding:"6px 10px",borderBottom:"1px solid var(--border)",textAlign:"right"},children:G.curAmt!=null&&G.curAmt!==""?pe.format(Number(G.curAmt)):""}),r.jsx("td",{style:{padding:"6px 10px",borderBottom:"1px solid var(--border)",textAlign:"center"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:4},children:[(()=>{const ie=G.itemSeq!=null?String(G.itemSeq):G.itemName,re=h[ie]===!1;return r.jsx("button",{className:"btn btn-secondary",style:{width:24,height:24,padding:0,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",color:re?"var(--error)":void 0,borderColor:re?"var(--error)":void 0},onClick:de=>{de.stopPropagation(),F(de,G)},title:re?"재고 없음 - 클릭하여 상세 조회":"재고 조회",children:r.jsx(cc,{size:12,style:{color:re?"var(--error)":void 0}})})})(),r.jsx("button",{className:"btn btn-primary",style:{width:24,height:24,padding:0,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center"},onClick:ie=>{ie.stopPropagation(),L(G)},title:"담기",children:r.jsx(mr,{size:12})})]})})]},ae))})]})})]})]}),r.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8,display:"flex",flexDirection:"column",minHeight:0},children:[r.jsxs("div",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)",display:"flex",alignItems:"center",gap:6},children:[r.jsx(nr,{size:16}),r.jsx("strong",{style:{fontSize:13},children:"수주장"})]}),r.jsx("div",{style:{padding:12,borderBottom:"1px solid var(--border)"},children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"70px 1fr",gap:6,fontSize:12},children:[r.jsx("span",{style:{color:"var(--text-secondary)"},children:"수주장번호"}),r.jsx("span",{style:{fontWeight:500},children:Y||"-"}),r.jsx("span",{style:{color:"var(--text-secondary)"},children:"회사코드"}),r.jsx("span",{style:{fontWeight:500},children:(e==null?void 0:e.companyCode)||(e==null?void 0:e.companyType)||"TNT"}),r.jsx("span",{style:{color:"var(--text-secondary)"},children:"거래처"}),r.jsxs("span",{style:{fontWeight:500},children:[(e==null?void 0:e.customerName)||"-",(e==null?void 0:e.ownerName)&&r.jsxs("span",{style:{color:"var(--text-secondary)",fontWeight:400,marginLeft:6},children:["(",e.ownerName,")"]})]}),r.jsx("span",{style:{color:"var(--text-secondary)"},children:"등록자"}),r.jsx("span",{style:{fontWeight:500},children:S||"-"})]})}),r.jsxs("div",{style:{padding:12,borderBottom:"1px solid var(--border)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:8},children:[r.jsx("label",{style:{fontSize:11,color:"var(--text-secondary)",minWidth:60,flexShrink:0},children:"지역 그룹"}),r.jsx("input",{type:"text",className:"input",value:C,onChange:G=>w(G.target.value),placeholder:"지역 그룹",style:{flex:1,fontSize:12,padding:"6px 8px"}})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:8},children:[r.jsx("label",{style:{fontSize:11,color:"var(--text-secondary)",minWidth:60,flexShrink:0},children:"납품요청일"}),r.jsx("input",{type:"date",className:"input",value:O,onChange:G=>E(G.target.value),style:{flex:1,fontSize:12,padding:"6px 8px"}})]}),r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:6},children:[r.jsx("label",{style:{fontSize:11,color:"var(--text-secondary)",minWidth:60,flexShrink:0,paddingTop:6},children:"요청 사항"}),r.jsx("textarea",{className:"input",value:_,onChange:G=>I(G.target.value),placeholder:"요청 사항",rows:3,style:{flex:1,resize:"vertical",fontSize:12,padding:"6px 8px"}})]})]}),r.jsxs("div",{style:{flex:1,overflow:"auto",padding:12},children:[r.jsxs("div",{style:{fontSize:11,color:"var(--text-secondary)",marginBottom:6},children:["담긴 품목 (",v.length,"건)"]}),v.length===0?r.jsx("div",{style:{padding:24,textAlign:"center",color:"var(--text-secondary)",background:"var(--bg-secondary)",borderRadius:8,fontSize:12},children:"담긴 품목이 없습니다"}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:v.map((G,ae)=>r.jsxs("div",{style:{padding:10,border:"1px solid var(--border)",borderRadius:8,background:"var(--panel)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,marginBottom:6},children:[r.jsx(ne,{type:G.companyType||(e==null?void 0:e.companyType)||(e==null?void 0:e.companyCode)}),r.jsx("span",{style:{flex:1,fontSize:12,fontWeight:500},children:G.itemName}),G.itemStdUnit&&r.jsxs("span",{style:{fontSize:10,color:"var(--text-secondary)"},children:["(",G.itemStdUnit,")"]}),r.jsx("button",{onClick:()=>Z(ae),style:{background:"none",border:"none",cursor:"pointer",padding:2,color:"var(--error)"},title:"삭제",children:r.jsx(On,{size:14})})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("input",{type:"number",className:"input",min:0,step:"0.01",value:G.qty===""?"":String(G.qty),placeholder:"수량",onChange:ie=>ee(ae,ie.target.value),style:{width:80,textAlign:"right",fontSize:12,padding:"4px 6px"}}),G.itemStdUnit&&r.jsx("span",{style:{fontSize:11,color:"var(--text-secondary)"},children:G.itemStdUnit})]})]},ae))})]}),r.jsx("div",{style:{padding:12,borderTop:"1px solid var(--border)"},children:r.jsx("button",{className:"btn btn-primary",style:{width:"100%",padding:"10px 12px",fontSize:13,fontWeight:600,display:"flex",alignItems:"center",justifyContent:"center"},disabled:D||!v.length||!e,onClick:K,children:D?"전송 중...":"주문"})})]})]}),j.open&&r.jsx("div",{ref:x,style:{position:"fixed",left:j.x+6,top:j.y+6,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",padding:10,maxWidth:350,zIndex:100},onClick:G=>G.stopPropagation(),children:j.loading?r.jsx("div",{style:{color:"var(--text-secondary)",fontSize:12},children:"재고 불러오는 중…"}):j.error?r.jsx("div",{style:{color:"var(--error)",fontSize:12},children:j.error}):!j.rows||j.rows.length===0?r.jsx("div",{style:{color:"var(--text-secondary)",fontSize:12},children:"재고 데이터가 없습니다"}):r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:11},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"var(--bg-secondary)"},children:[r.jsx("th",{style:{padding:"6px",textAlign:"left",borderBottom:"1px solid var(--border)"},children:"창고명"}),r.jsx("th",{style:{padding:"6px",textAlign:"right",borderBottom:"1px solid var(--border)",width:70},children:"가용재고"}),r.jsx("th",{style:{padding:"6px",textAlign:"left",borderBottom:"1px solid var(--border)",width:60},children:"단위"})]})}),r.jsx("tbody",{children:(j.rows||[]).map((G,ae)=>r.jsxs("tr",{children:[r.jsx("td",{style:{padding:"6px",borderBottom:"1px solid var(--border)"},children:G.whName||"-"}),r.jsx("td",{style:{padding:"6px",textAlign:"right",borderBottom:"1px solid var(--border)"},children:pe.format(G.avail)}),r.jsx("td",{style:{padding:"6px",borderBottom:"1px solid var(--border)"},children:G.unitName||""})]},ae))})]})}),P.open&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onClick:()=>R({open:!1,text:""}),children:r.jsxs("div",{style:{background:"var(--bg-primary)",borderRadius:8,padding:20,minWidth:280,boxShadow:"0 20px 60px rgba(0,0,0,0.3)",textAlign:"center"},onClick:G=>G.stopPropagation(),children:[r.jsx("div",{style:{marginBottom:14,fontSize:13},children:P.text}),r.jsx("button",{className:"btn btn-primary",onClick:()=>R({open:!1,text:""}),style:{fontSize:12,padding:"6px 16px"},children:"확인"})]})})]})}const js=[{id:"order-sheet",label:"수주장 등록",subLabel:"Order Sheet",icon:nr,color:"#3b82f6",bgColor:"#eff6ff",borderColor:"#93c5fd"},{id:"unblock",label:"매출통제해제",subLabel:"Unblock",icon:oo,color:"#ec4899",bgColor:"#fdf2f8",borderColor:"#f9a8d4"},{id:"order",label:"수주",subLabel:"Order",icon:_s,color:"#8b5cf6",bgColor:"#f5f3ff",borderColor:"#c4b5fd"},{id:"shipment-request",label:"출하의뢰",subLabel:"Shipment Request",icon:n_,color:"#f59e0b",bgColor:"#fffbeb",borderColor:"#fcd34d"},{id:"invoice",label:"거래명세서",subLabel:"Invoice",icon:PN,color:"#10b981",bgColor:"#ecfdf5",borderColor:"#6ee7b7"},{id:"delivery",label:"출고",subLabel:"Delivery",icon:fr,color:"#06b6d4",bgColor:"#ecfeff",borderColor:"#67e8f9"}];function HH(){const[e,n]=p.useState("ALL"),[i,s]=p.useState(""),[a,o]=p.useState([]),[l,c]=p.useState(null),[d,u]=p.useState(null),[f,h]=p.useState(!1),[m,g]=p.useState("list"),[b,j]=p.useState(null),[y,x]=p.useState({orderSheet:null,unblock:null,order:null,shipmentRequest:null,invoice:null,delivery:null}),[v,A]=p.useState({loading:!1,checked:!1,isSalesControlled:!1,isUnblocked:!1,unblockUntilDate:null,statusMessage:"",salesControlReason:null,error:null}),N=async k=>{A(D=>({...D,loading:!0,error:null}));try{const D=new URLSearchParams({customerSeq:String(k.customerSeq),companyType:k.companyType||"TNT"}),T=await fetch(`/api/v1/orders/sales-control/check?${D}`);if(!T.ok)throw new Error(`HTTP ${T.status}`);const P=await T.json();if(P.success)A({loading:!1,checked:!0,isSalesControlled:P.isSalesControlled||!1,isUnblocked:P.isUnblocked||!1,unblockUntilDate:P.unblockUntilDate||null,statusMessage:P.statusMessage||"",salesControlReason:P.salesControlReason||null,error:null});else throw new Error(P.error||"매출통제 확인 실패")}catch(D){console.error("매출통제 확인 실패:",D),A(T=>({...T,loading:!1,checked:!0,error:D.message||"매출통제 확인 중 오류 발생"}))}};p.useEffect(()=>{if(!l||d!=="order-sheet"){A({loading:!1,checked:!1,isSalesControlled:!1,isUnblocked:!1,unblockUntilDate:null,statusMessage:"",salesControlReason:null,error:null});return}N(l)},[d,l]);const C=async()=>{if(i.trim()){h(!0);try{const k=localStorage.getItem("tnt.sales.empId")||"",D=localStorage.getItem("tnt.sales.assigneeId")||"",T=new URLSearchParams;T.set("name",i.trim()),T.set("mineOnly","false"),T.set("limit","50"),k&&T.set("empId",k),D&&T.set("assigneeId",D),e!=="ALL"&&T.set("companyType",e);const P=await fetch(`/api/v1/customers?${T.toString()}`);if(!P.ok)throw new Error(`HTTP ${P.status}`);const R=await P.json(),Y=(Array.isArray(R)?R:[]).map(X=>({customerSeq:X.customerSeq,customerName:X.customerName,companyType:X.companyType||"TNT",customerId:X.customerId,addrProvinceName:X.addrProvinceName,addrCityName:X.addrCityName}));o(Y)}catch(k){console.error("거래처 검색 실패:",k),o([])}finally{h(!1)}}},w=async k=>{c(k),u(null),j(null),g("list"),x({orderSheet:null,unblock:null,order:null,shipmentRequest:null,invoice:null,delivery:null})},_=k=>{c(k),j(null),g("workflow"),u("order-sheet"),x({orderSheet:null,unblock:null,order:null,shipmentRequest:null,invoice:null,delivery:null})},I=k=>{j(k),g("workflow"),u("order-sheet"),console.log("수주장 선택:",k)},O=k=>{switch(k){case"order-sheet":return!!y.orderSheet;case"unblock":return!!y.unblock;case"order":return!!y.order;case"shipment-request":return!!y.shipmentRequest;case"invoice":return!!y.invoice;case"delivery":return!!y.delivery;default:return!1}},E=()=>{for(const k of js)if(!O(k.id))return k.id;return"delivery"},S=()=>js.filter(k=>O(k.id)).length;return r.jsxs("section",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[r.jsx("div",{style:{background:"linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #1e3a8a 100%)",padding:"20px 24px",borderRadius:12,marginBottom:16,flexShrink:0},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{children:[r.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"#fff"},children:"수주~배송"}),r.jsx("p",{style:{margin:"4px 0 0 0",fontSize:13,color:"rgba(255,255,255,0.8)"},children:l?`${l.customerName} - 주문에서 배송까지의 진행 상황을 확인합니다`:"주문에서 배송까지의 진행 상황을 확인합니다"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("div",{style:{background:"rgba(255,255,255,0.15)",padding:4,borderRadius:8,display:"flex",gap:0},children:["ALL","TNT","DYS"].map(k=>r.jsx("button",{onClick:()=>n(k),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:e===k?"#fff":"transparent",color:e===k?"#1e40af":"rgba(255,255,255,0.9)",transition:"all 0.2s"},children:k},k))}),l&&r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,background:"rgba(255,255,255,0.15)",padding:"8px 16px",borderRadius:8},children:[r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:28,height:28,borderRadius:6,background:l.companyType==="TNT"?"#fff":"#10b981",color:l.companyType==="TNT"?"#1e40af":"#fff",fontSize:12,fontWeight:700},children:l.companyType==="TNT"?"T":"D"}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#fff"},children:l.customerName}),r.jsxs("div",{style:{fontSize:11,color:"rgba(255,255,255,0.7)"},children:[l.addrProvinceName," ",l.addrCityName]})]}),r.jsxs("div",{style:{padding:"4px 10px",background:"rgba(255,255,255,0.2)",borderRadius:6,fontSize:12,color:"#fff",marginLeft:4},children:[r.jsx("strong",{children:S()})," / ",js.length]}),r.jsx("button",{onClick:()=>w(l),style:{padding:"6px 10px",background:"rgba(255,255,255,0.2)",border:"none",borderRadius:6,fontSize:11,color:"#fff",cursor:"pointer",display:"flex",alignItems:"center",gap:4},children:r.jsx(ln,{size:12})})]})]})]})}),r.jsxs("div",{style:{flex:1,display:"flex",gap:16,padding:"16px 0",minHeight:0,overflow:"hidden"},children:[r.jsxs("div",{style:{width:280,flexShrink:0,display:"flex",flexDirection:"column",background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden"},children:[r.jsxs("div",{style:{padding:16,borderBottom:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{fontWeight:600,fontSize:14,marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[r.jsx(mo,{size:18,color:"#374151"}),"거래처 선택"]}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("input",{type:"text",placeholder:"거래처명 검색",value:i,onChange:k=>s(k.target.value),onKeyDown:k=>k.key==="Enter"&&C(),style:{flex:1,padding:"8px 12px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,outline:"none"}}),r.jsx("button",{onClick:C,disabled:f,style:{padding:"8px 12px",background:"#3b82f6",color:"white",border:"none",borderRadius:6,cursor:f?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(Fn,{size:16})})]})]}),r.jsx("div",{style:{flex:1,overflow:"auto"},children:f?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(ln,{size:24,style:{animation:"spin 1s linear infinite"}}),r.jsx("p",{style:{marginTop:8,fontSize:13},children:"검색 중..."})]}):a.length===0?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(mo,{size:32,strokeWidth:1}),r.jsx("p",{style:{marginTop:8,fontSize:13},children:"거래처를 검색하세요"})]}):r.jsx("div",{style:{padding:8},children:a.map(k=>r.jsx("div",{onClick:()=>w(k),style:{padding:"12px",borderRadius:8,cursor:"pointer",marginBottom:4,background:(l==null?void 0:l.customerSeq)===k.customerSeq?"#eff6ff":"transparent",border:(l==null?void 0:l.customerSeq)===k.customerSeq?"1px solid #3b82f6":"1px solid transparent",transition:"all 0.15s"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:24,height:24,borderRadius:4,background:k.companyType==="TNT"?"#3b82f6":"#10b981",color:"#fff",fontSize:11,fontWeight:700},children:k.companyType==="TNT"?"T":"D"}),r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{fontSize:13,fontWeight:500,color:"#111827"},children:k.customerName}),k.addrProvinceName&&r.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:[k.addrProvinceName," ",k.addrCityName]})]}),r.jsx("button",{onClick:D=>{D.stopPropagation(),_(k)},title:"수주장 등록",style:{width:26,height:26,borderRadius:"50%",border:"2px solid #3b82f6",background:"#fff",color:"#3b82f6",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transition:"all 0.2s"},onMouseEnter:D=>{D.currentTarget.style.background="#3b82f6",D.currentTarget.style.color="#fff"},onMouseLeave:D=>{D.currentTarget.style.background="#fff",D.currentTarget.style.color="#3b82f6"},children:r.jsx(mr,{size:14,strokeWidth:3})})]})},`${k.companyType}-${k.customerSeq}`))})})]}),r.jsx("div",{style:{flex:1,display:"flex",flexDirection:"column",gap:16,minWidth:0},children:l?m==="list"?r.jsx("div",{style:{flex:1,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden",display:"flex",flexDirection:"column",minHeight:0},children:r.jsx(GH,{customer:l,onSelectOrder:I,onNewOrderSheet:()=>_(l)})}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",padding:20},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:16,paddingBottom:12,borderBottom:"1px solid #e5e7eb"},children:[r.jsxs("button",{onClick:()=>g("list"),style:{padding:"6px 12px",background:"#f3f4f6",border:"none",borderRadius:6,fontSize:12,color:"#374151",cursor:"pointer",display:"flex",alignItems:"center",gap:4},children:[r.jsx(Fh,{size:14}),"목록으로"]}),r.jsxs("div",{style:{flex:1},children:[r.jsx("span",{style:{fontSize:14,fontWeight:600,color:"#111827"},children:b?`수주장 #${b}`:"신규 수주장 등록"}),r.jsx("span",{style:{fontSize:12,color:"#6b7280",marginLeft:8},children:l.customerName})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},children:[r.jsx("div",{style:{position:"absolute",top:24,left:60,right:60,height:4,background:"#e5e7eb",zIndex:0}}),l&&r.jsx("div",{style:{position:"absolute",top:24,left:60,width:`calc(${S()/js.length*100}% - ${60*2/js.length}px)`,height:4,background:"#22c55e",zIndex:0,transition:"width 0.3s"}}),js.map(k=>{const D=l?O(k.id):!1,T=l?E()===k.id:!1,P=d===k.id,R=k.icon;return r.jsxs("div",{onClick:()=>u(k.id),style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"pointer",zIndex:1,flex:1},children:[r.jsx("div",{style:{width:48,height:48,borderRadius:"50%",background:D?"#22c55e":P?k.color:"#fff",border:`3px solid ${D?"#22c55e":P||T?k.color:"#e5e7eb"}`,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s",boxShadow:P||T?`0 0 0 4px ${k.bgColor}`:"none"},children:D?r.jsx(rs,{size:22,color:"#fff",strokeWidth:3}):r.jsx(R,{size:22,color:P?"#fff":T?k.color:"#9ca3af"})}),r.jsxs("div",{style:{marginTop:10,textAlign:"center",color:D?"#16a34a":P||T?"#111827":"#9ca3af",fontWeight:P||T?700:500},children:[r.jsx("div",{style:{fontSize:13},children:k.label}),r.jsx("div",{style:{fontSize:10,color:D?"#22c55e":"#9ca3af",marginTop:2},children:D?"완료":k.subLabel})]})]},k.id)})]})]}),r.jsx("div",{style:{flex:1,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden",display:"flex",flexDirection:"column",minHeight:0},children:d?r.jsx(VH,{step:d,customer:l,data:y,salesControlStatus:v,onRefreshSalesControl:()=>l&&N(l)}):r.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center",color:"#9ca3af"},children:r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx(Tr,{size:40,strokeWidth:1}),r.jsx("p",{style:{marginTop:12,fontSize:14},children:"워크플로우 단계를 클릭하여 상세 정보를 확인하세요"})]})})})]}):r.jsx("div",{style:{flex:1,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"center",color:"#9ca3af"},children:r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx(mo,{size:48,strokeWidth:1}),r.jsx("p",{style:{marginTop:12,fontSize:14},children:"거래처를 선택하세요"}),r.jsx("p",{style:{fontSize:12,color:"#d1d5db"},children:"거래처를 선택하면 수주진행목록이 표시됩니다"})]})})})]})]})}function YH(){const e=new Date,n=String(e.getFullYear()%100).padStart(2,"0"),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${n}-${i}-${s}`}function KH(){const e=new Date;e.setMonth(e.getMonth()-1);const n=String(e.getFullYear()%100).padStart(2,"0"),i=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${n}-${i}-${s}`}function ra({status:e}){return e==="none"?r.jsx("span",{style:{color:"#d1d5db",fontSize:11},children:"-"}):e==="completed"?r.jsx("div",{style:{width:24,height:24,borderRadius:"50%",background:"#dcfce7",border:"2px solid #22c55e",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(rs,{size:14,color:"#16a34a",strokeWidth:3})}):r.jsx("div",{style:{width:24,height:24,borderRadius:"50%",background:"#fef3c7",border:"2px solid #f59e0b",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(Bv,{size:12,color:"#d97706"})})}function GH({customer:e,onSelectOrder:n,onNewOrderSheet:i}){const[s,a]=p.useState([]),[o,l]=p.useState(!1),[c,d]=p.useState(null),[u,f]=p.useState(KH()),[h,m]=p.useState(YH()),g=async()=>{l(!0),d(null);try{const x=new URLSearchParams({custSeq:String(e.customerSeq),companyType:e.companyType||"TNT"});u&&x.set("fromDate",u),h&&x.set("toDate",h);const v=await fetch(`/api/v1/orders/external/order-progress-list?${x.toString()}`);if(!v.ok)throw new Error(`HTTP ${v.status}`);const A=await v.json(),N=(Array.isArray(A)?A:[]).map(C=>({orderSheetNo:C.OrderTextNo||"",orderSheetStatus:C.OrderTextNo?"completed":"none",unblockStatus:"none",orderNo:"",orderStatus:"none",shipmentRequestNo:"",shipmentRequestStatus:"none",invoiceNo:"",invoiceStatus:"none",deliveryStatus:"none"}));a(N)}catch(x){d(x.message||"조회 실패"),a([])}finally{l(!1)}};p.useEffect(()=>{g()},[e.customerSeq]);const b={padding:"12px 8px",textAlign:"center",fontWeight:700,fontSize:13,color:"#fff",background:"#3b82f6",borderRight:"1px solid #60a5fa"},j={padding:"8px 6px",textAlign:"center",fontSize:11,color:"#6b7280",background:"#f9fafb",borderBottom:"1px solid #e5e7eb",borderRight:"1px solid #e5e7eb"},y={padding:"10px 6px",textAlign:"center",fontSize:12,borderBottom:"1px solid #f3f4f6",borderRight:"1px solid #f3f4f6",verticalAlign:"middle"};return r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#3b82f6",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(Fh,{size:20,color:"#fff"})}),r.jsxs("div",{children:[r.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700,color:"#111827"},children:"수주진행목록"}),r.jsxs("p",{style:{margin:"2px 0 0 0",fontSize:12,color:"#6b7280"},children:[e.customerName," - 수주장 번호 기준 진행 현황"]})]})]}),r.jsxs("button",{onClick:i,style:{padding:"8px 16px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:8,fontSize:13,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:6},children:[r.jsx(DN,{size:16}),"신규 수주장 등록"]})]}),r.jsxs("div",{style:{padding:"12px 20px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",gap:12,background:"#f9fafb"},children:[r.jsx(qr,{size:16,color:"#6b7280"}),r.jsx("span",{style:{fontSize:13,color:"#6b7280"},children:"수주일"}),r.jsx("input",{type:"text",placeholder:"YY-MM-DD",value:u,onChange:x=>f(x.target.value),style:{padding:"6px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,width:100}}),r.jsx("span",{style:{color:"#9ca3af"},children:"~"}),r.jsx("input",{type:"text",placeholder:"YY-MM-DD",value:h,onChange:x=>m(x.target.value),style:{padding:"6px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,width:100}}),r.jsxs("button",{onClick:g,disabled:o,style:{padding:"6px 14px",background:"#374151",color:"#fff",border:"none",borderRadius:6,fontSize:13,fontWeight:500,cursor:o?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:6,opacity:o?.7:1},children:[o?r.jsx(Ei,{size:14,className:"animate-spin"}):r.jsx(Fn,{size:14}),"조회"]}),r.jsxs("span",{style:{marginLeft:"auto",fontSize:12,color:"#9ca3af"},children:[s.length,"건"]})]}),r.jsx("div",{style:{flex:1,overflow:"auto",padding:"0"},children:c?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:[r.jsx(pN,{size:40,strokeWidth:1}),r.jsx("p",{style:{marginTop:12,fontSize:14},children:c})]}):o?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(Ei,{size:40,strokeWidth:1,className:"animate-spin"}),r.jsx("p",{style:{marginTop:12,fontSize:14},children:"조회 중..."})]}):s.length===0?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(Tr,{size:48,strokeWidth:1}),r.jsx("p",{style:{marginTop:12,fontSize:14},children:"조회된 수주장이 없습니다"}),r.jsx("p",{style:{fontSize:12,color:"#d1d5db"},children:"기간을 변경하거나 신규 수주장을 등록하세요"})]}):r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",tableLayout:"fixed"},children:[r.jsxs("thead",{children:[r.jsxs("tr",{children:[r.jsx("th",{colSpan:2,style:{...b,width:"16.66%"},children:"수주장"}),r.jsx("th",{style:{...b,width:"10%"},children:"매출통제해제"}),r.jsx("th",{colSpan:2,style:{...b,width:"16.66%"},children:"수주"}),r.jsx("th",{colSpan:2,style:{...b,width:"16.66%"},children:"출하의뢰"}),r.jsx("th",{colSpan:2,style:{...b,width:"16.66%"},children:"거래명세서"}),r.jsx("th",{style:{...b,width:"10%",borderRight:"none"},children:"출고"})]}),r.jsxs("tr",{children:[r.jsx("th",{style:j,children:"상태"}),r.jsx("th",{style:j,children:"수주장번호"}),r.jsx("th",{style:j,children:"상태"}),r.jsx("th",{style:j,children:"상태"}),r.jsx("th",{style:j,children:"수주번호"}),r.jsx("th",{style:j,children:"상태"}),r.jsx("th",{style:j,children:"출하의뢰번호"}),r.jsx("th",{style:j,children:"상태"}),r.jsx("th",{style:j,children:"거래명세서 번호"}),r.jsx("th",{style:{...j,borderRight:"none"},children:"상태"})]})]}),r.jsx("tbody",{children:s.map((x,v)=>r.jsxs("tr",{onClick:()=>n(x.orderSheetNo),style:{cursor:"pointer",transition:"background 0.15s"},onMouseEnter:A=>{A.currentTarget.style.background="#f3f4f6"},onMouseLeave:A=>{A.currentTarget.style.background="transparent"},children:[r.jsx("td",{style:y,children:r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx(ra,{status:x.orderSheetStatus})})}),r.jsx("td",{style:{...y,fontWeight:600,color:"#111827"},children:x.orderSheetNo||"-"}),r.jsx("td",{style:y,children:r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx(ra,{status:x.unblockStatus})})}),r.jsx("td",{style:y,children:r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx(ra,{status:x.orderStatus})})}),r.jsx("td",{style:{...y,color:"#374151"},children:x.orderNo||"-"}),r.jsx("td",{style:y,children:r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx(ra,{status:x.shipmentRequestStatus})})}),r.jsx("td",{style:{...y,color:"#374151"},children:x.shipmentRequestNo||"-"}),r.jsx("td",{style:y,children:r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx(ra,{status:x.invoiceStatus})})}),r.jsx("td",{style:{...y,color:"#374151"},children:x.invoiceNo||"-"}),r.jsx("td",{style:{...y,borderRight:"none"},children:r.jsx("div",{style:{display:"flex",justifyContent:"center"},children:r.jsx(ra,{status:x.deliveryStatus})})})]},x.orderSheetNo||v))})]})})]})}function VH({step:e,customer:n,data:i,salesControlStatus:s,onRefreshSalesControl:a}){const o=js.find(u=>u.id===e);if(!o)return null;const l=n?(()=>{switch(e){case"order-sheet":return i.orderSheet;case"unblock":return i.unblock;case"order":return i.order;case"shipment-request":return i.shipmentRequest;case"invoice":return i.invoice;case"delivery":return i.delivery;default:return null}})():null,c=o.icon,d=()=>e!=="order-sheet"||!n?null:s.loading?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"#f3f4f6",borderRadius:8,fontSize:12,color:"#6b7280"},children:[r.jsx(Ei,{size:14,style:{animation:"spin 1s linear infinite"}}),"매출통제 확인 중..."]}):s.error?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"#fef3c7",borderRadius:8,fontSize:12,color:"#b45309",cursor:"pointer"},onClick:a,title:"다시 확인",children:[r.jsx(ha,{size:14}),"확인 실패 (클릭하여 재시도)"]}):s.checked?s.isSalesControlled&&!s.isUnblocked?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"#fee2e2",border:"1px solid #fecaca",borderRadius:8,fontSize:12,color:"#dc2626",fontWeight:600},children:[r.jsx(Pu,{size:14}),"매출통제 중"]}):s.isSalesControlled&&s.isUnblocked?r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"#fef3c7",border:"1px solid #fde68a",borderRadius:8,fontSize:12,color:"#b45309",fontWeight:600},children:[r.jsx(oo,{size:14}),"해제됨 (",s.unblockUntilDate,"까지)"]}):r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,padding:"6px 12px",background:"#dcfce7",border:"1px solid #bbf7d0",borderRadius:8,fontSize:12,color:"#16a34a",fontWeight:600},children:[r.jsx(Ou,{size:14}),"정상"]}):null;return r.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,padding:16,background:o.bgColor,borderBottom:`1px solid ${o.borderColor}`},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:o.color,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(c,{size:20,color:"#fff"})}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700,color:"#111827"},children:o.label}),r.jsxs("p",{style:{margin:"2px 0 0 0",fontSize:12,color:o.color},children:[o.subLabel,n?` - ${n.customerName}`:""]})]}),d()]}),r.jsx("div",{style:{flex:1,overflow:"auto",padding:20},children:n?l?r.jsxs("div",{children:[e==="order-sheet"&&n&&s.checked&&r.jsxs("div",{style:{marginBottom:16},children:[s.isSalesControlled&&!s.isUnblocked&&r.jsx("div",{style:{padding:16,background:"linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%)",border:"1px solid #fecaca",borderRadius:12},children:r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#dc2626",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:r.jsx(Pu,{size:20,color:"#fff"})}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:700,color:"#dc2626"},children:"매출통제 중인 거래처입니다"}),r.jsxs("p",{style:{margin:"6px 0 0 0",fontSize:13,color:"#991b1b",lineHeight:1.5},children:["해당 거래처는 현재 매출통제 상태입니다.",s.salesControlReason&&r.jsxs("span",{style:{display:"block",marginTop:4,fontWeight:600},children:["사유: ",s.salesControlReason]})]})]})]})}),s.isSalesControlled&&s.isUnblocked&&r.jsx("div",{style:{padding:16,background:"linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%)",border:"1px solid #fde68a",borderRadius:12},children:r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#f59e0b",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:r.jsx(oo,{size:20,color:"#fff"})}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:700,color:"#b45309"},children:"매출통제 임시 해제 중"}),r.jsxs("p",{style:{margin:"6px 0 0 0",fontSize:13,color:"#92400e",lineHeight:1.5},children:["해당 거래처는 ",r.jsx("strong",{children:s.unblockUntilDate}),"까지 매출통제가 해제되어 있습니다."]})]})]})}),!s.isSalesControlled&&r.jsx("div",{style:{padding:16,background:"linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)",border:"1px solid #bbf7d0",borderRadius:12},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#16a34a",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:r.jsx(Ou,{size:20,color:"#fff"})}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:700,color:"#16a34a"},children:"정상 거래처"}),r.jsx("p",{style:{margin:"4px 0 0 0",fontSize:13,color:"#15803d"},children:"매출통제 대상이 아닙니다."})]})]})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:12,marginBottom:20},children:[r.jsxs("div",{style:{padding:16,background:"#f0fdf4",borderRadius:10,textAlign:"center"},children:[r.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#16a34a"},children:"완료"}),r.jsx("div",{style:{fontSize:12,color:"#22c55e"},children:"상태"})]}),r.jsxs("div",{style:{padding:16,background:"#f9fafb",borderRadius:10,textAlign:"center"},children:[r.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#374151"},children:l.date||"-"}),r.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"처리일"})]}),r.jsxs("div",{style:{padding:16,background:"#f9fafb",borderRadius:10,textAlign:"center"},children:[r.jsxs("div",{style:{fontSize:20,fontWeight:700,color:"#374151"},children:["#",l.id||"-"]}),r.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"문서번호"})]})]}),r.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e5e7eb",overflow:"hidden"},children:[r.jsxs("div",{style:{padding:"12px 16px",background:"#f9fafb",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",gap:8},children:[r.jsx(Tr,{size:16,color:"#374151"}),r.jsx("span",{style:{fontSize:14,fontWeight:600,color:"#111827"},children:"상세 내역"})]}),r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(nr,{size:32,strokeWidth:1}),r.jsx("p",{style:{marginTop:8,fontSize:13},children:"데이터 테이블 정의 후 구현 예정"})]})]})]}):r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[e==="order-sheet"&&n&&s.checked&&r.jsxs("div",{style:{marginBottom:20},children:[s.isSalesControlled&&!s.isUnblocked&&r.jsx("div",{style:{padding:16,background:"linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%)",border:"1px solid #fecaca",borderRadius:12,marginBottom:16},children:r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#dc2626",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:r.jsx(Pu,{size:20,color:"#fff"})}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:700,color:"#dc2626"},children:"매출통제 중인 거래처입니다"}),r.jsxs("p",{style:{margin:"6px 0 0 0",fontSize:13,color:"#991b1b",lineHeight:1.5},children:["해당 거래처는 현재 매출통제 상태입니다. 수주장 등록 전 매출통제 해제 품의를 진행해 주세요.",s.salesControlReason&&r.jsxs("span",{style:{display:"block",marginTop:4,fontWeight:600},children:["사유: ",s.salesControlReason]})]}),r.jsxs("button",{style:{marginTop:12,padding:"8px 16px",background:"#dc2626",color:"white",border:"none",borderRadius:8,fontSize:13,fontWeight:600,cursor:"pointer",display:"inline-flex",alignItems:"center",gap:6},children:[r.jsx(oo,{size:14}),"매출통제 해제 품의"]})]})]})}),s.isSalesControlled&&s.isUnblocked&&r.jsx("div",{style:{padding:16,background:"linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%)",border:"1px solid #fde68a",borderRadius:12,marginBottom:16},children:r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#f59e0b",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:r.jsx(oo,{size:20,color:"#fff"})}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:700,color:"#b45309"},children:"매출통제 임시 해제 중"}),r.jsxs("p",{style:{margin:"6px 0 0 0",fontSize:13,color:"#92400e",lineHeight:1.5},children:["해당 거래처는 ",r.jsx("strong",{children:s.unblockUntilDate}),"까지 매출통제가 해제되어 있습니다. 해제 기간 내에 수주장을 등록해 주세요."]})]})]})}),!s.isSalesControlled&&r.jsx("div",{style:{padding:16,background:"linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%)",border:"1px solid #bbf7d0",borderRadius:12,marginBottom:16},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#16a34a",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:r.jsx(Ou,{size:20,color:"#fff"})}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h4",{style:{margin:0,fontSize:15,fontWeight:700,color:"#16a34a"},children:"정상 거래처"}),r.jsx("p",{style:{margin:"4px 0 0 0",fontSize:13,color:"#15803d"},children:"매출통제 대상이 아닙니다. 수주장을 등록할 수 있습니다."})]})]})})]}),e==="order-sheet"&&n?r.jsx("div",{style:{flex:1,minHeight:0},children:r.jsx(UH,{customer:{customerSeq:n.customerSeq,customerName:n.customerName,companyType:n.companyType,companyCode:n.companyType,addrProvinceName:n.addrProvinceName,addrCityName:n.addrCityName},onOrderCreated:u=>{console.log("주문 생성됨:",u)}})}):r.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{textAlign:"center",color:"#9ca3af"},children:[r.jsx(c,{size:48,strokeWidth:1}),r.jsx("p",{style:{marginTop:12,fontSize:14},children:"아직 진행되지 않은 단계입니다"}),r.jsx("p",{style:{fontSize:12,color:"#d1d5db"},children:"이전 단계가 완료되면 진행됩니다"})]})})]}):r.jsx("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{textAlign:"center",color:"#9ca3af"},children:[r.jsx(mo,{size:48,strokeWidth:1}),r.jsx("p",{style:{marginTop:12,fontSize:14},children:"거래처를 선택하면 상세 정보가 표시됩니다"})]})})})]})}const XH=["매출","가격","재고","경쟁사","Complaint","품질관리","공급사"];function QH(){const[e,n]=p.useState(""),[i,s]=p.useState([]),[a,o]=p.useState(!1),[l,c]=p.useState(null),[d,u]=p.useState("매출"),f=new Intl.NumberFormat("ko-KR");async function h(){o(!0),c(null);try{const m=new URL("/api/v1/items/search",window.location.origin);m.searchParams.set("q",e||""),m.searchParams.set("limit","100");const g=await fetch(m.toString());if(!g.ok)throw new Error(`HTTP ${g.status}`);const b=await g.json(),j=Array.isArray(b)?b.map(y=>({itemSeq:Number(y.itemSeq??y.item_seq??0),itemName:String(y.itemName??y.item_name??""),recentInvoiceDate:String(y.recentInvoiceDate??y.recent_invoice_date??""),curAmt:Number(y.curAmt??y.cur_amt??0),qty:Number(y.qty??0)})):[];s(j)}catch(m){c((m==null?void 0:m.message)||"조회 오류"),s([])}finally{o(!1)}}return p.useEffect(()=>{h()},[]),r.jsxs("section",{children:[r.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"Item360"}),r.jsxs("div",{className:"controls",style:{gap:8},children:[r.jsx("input",{className:"search-input",value:e,onChange:m=>n(m.target.value),placeholder:"품목명 검색",onKeyDown:m=>{m.key==="Enter"&&h()}}),r.jsx("button",{className:"btn btn-card btn-3d",onClick:h,disabled:a,children:"검색"})]})]}),l&&r.jsx("div",{className:"error",children:l}),r.jsx("div",{className:"table-container",style:{height:300},children:a?r.jsx("div",{className:"empty-state",children:"불러오는 중…"}):i.length===0?r.jsx("div",{className:"empty-state",children:"데이터가 없습니다"}):r.jsxs("table",{className:"table",style:{width:"100%"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:120},children:"품목코드"}),r.jsx("th",{style:{textAlign:"left"},children:"품목명"}),r.jsx("th",{style:{width:140},children:"최근 매출일"}),r.jsx("th",{style:{width:140,textAlign:"right"},children:"매출금액"}),r.jsx("th",{style:{width:120,textAlign:"right"},children:"수량"})]})}),r.jsx("tbody",{children:i.map((m,g)=>r.jsxs("tr",{children:[r.jsx("td",{children:m.itemSeq||""}),r.jsx("td",{style:{textAlign:"left"},children:m.itemName||""}),r.jsx("td",{children:m.recentInvoiceDate||""}),r.jsxs("td",{style:{textAlign:"right"},children:[f.format(Math.round(Number(m.curAmt||0)))," 원"]}),r.jsx("td",{style:{textAlign:"right"},children:f.format(Math.round(Number(m.qty||0)))})]},g))})]})}),r.jsxs("div",{style:{marginTop:12},children:[r.jsx("div",{style:{display:"flex",gap:6,borderBottom:"1px solid var(--border)"},children:XH.map(m=>r.jsx("button",{className:"btn btn-card",style:{borderBottom:d===m?"2px solid var(--accent)":"2px solid transparent"},onClick:()=>u(m),children:m},m))}),r.jsx("div",{style:{padding:12},children:r.jsxs("div",{className:"empty-state",children:[d," 탭은 준비중입니다."]})})]})]})}function JH({isOpen:e,onClose:n}){const[i,s]=p.useState(!1),[a,o]=p.useState(null),[l,c]=p.useState(""),[d,u]=p.useState("");p.useEffect(()=>{e&&(u(""),c(""),o(null))},[e]);const f=async()=>{if(!d.trim()){o("질문을 입력해주세요.");return}s(!0),o(null),c("");try{const m=await fetch("/api/v1/sales-analysis-ai/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:d.trim(),assigneeId:So(),empName:Rv()})});if(!m.ok)throw new Error(`HTTP ${m.status}`);const g=await m.json();g.error?o(g.error):g.analysis?c(g.analysis):o("분석 결과를 받지 못했습니다.")}catch(m){o(m.message||"분석 중 오류가 발생했습니다.")}finally{s(!1)}},h=m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),f())};return e?r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onMouseDown:m=>{m.button===0&&m.target===m.currentTarget&&n()},onContextMenu:m=>{m.target===m.currentTarget&&m.preventDefault()},children:r.jsxs("div",{style:{background:"var(--panel)",borderRadius:16,boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",width:"90%",maxWidth:1e3,maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",borderRadius:"16px 16px 0 0"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"rgba(255, 255, 255, 0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("span",{style:{fontSize:24},children:"💰"})}),r.jsxs("div",{children:[r.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"white"},children:"매출분석 AI Agent (Beta)"}),r.jsx("p",{style:{margin:"4px 0 0 0",fontSize:13,color:"rgba(255, 255, 255, 0.8)"},children:"AI가 매출 데이터를 분석하여 인사이트를 제공합니다"})]})]}),r.jsx("button",{onClick:n,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:8,width:36,height:36,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"white",fontSize:20,fontWeight:"bold"},children:"×"})]}),r.jsx("div",{style:{padding:"20px 24px",borderBottom:"1px solid var(--border)",background:"var(--background)"},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13,color:"var(--text)",display:"block",marginBottom:8,fontWeight:600},children:"무엇을 분석해드릴까요?"}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("textarea",{value:d,onChange:m=>u(m.target.value),onKeyPress:h,placeholder:`예: 이번 달 매출 현황을 알려줘
예: 최근 3개월간 품목별 매출 분석해줘
예: 고객별 매출 Top 10을 보여줘`,disabled:i,style:{flex:1,padding:"12px 16px",border:"1px solid var(--border)",borderRadius:10,fontSize:14,background:"var(--panel)",color:"var(--text)",resize:"vertical",minHeight:80,fontFamily:"inherit",lineHeight:1.5}}),r.jsx("button",{onClick:f,disabled:i||!d.trim(),style:{padding:"12px 24px",background:i||!d.trim()?"#ccc":"linear-gradient(135deg, #10b981 0%, #059669 100%)",border:"none",borderRadius:10,color:"white",fontSize:14,fontWeight:600,cursor:i||!d.trim()?"not-allowed":"pointer",whiteSpace:"nowrap",boxShadow:i||!d.trim()?"none":"0 2px 8px rgba(16, 185, 129, 0.3)",transition:"all 0.2s ease"},children:i?"분석 중...":"분석하기"})]})]}),r.jsxs("div",{style:{fontSize:12,color:"var(--muted)",display:"flex",gap:8,flexWrap:"wrap"},children:[r.jsx("span",{children:"💡 예시:"}),r.jsx("button",{onClick:()=>u("이번 달 매출 현황을 알려줘"),disabled:i,style:{background:"none",border:"1px solid var(--border)",borderRadius:6,padding:"4px 10px",fontSize:11,color:"var(--text)",cursor:"pointer"},children:"이번 달 매출 현황"}),r.jsx("button",{onClick:()=>u("품목별 매출을 분석해줘"),disabled:i,style:{background:"none",border:"1px solid var(--border)",borderRadius:6,padding:"4px 10px",fontSize:11,color:"var(--text)",cursor:"pointer"},children:"품목별 매출 분석"}),r.jsx("button",{onClick:()=>u("고객별 매출 Top 10을 보여줘"),disabled:i,style:{background:"none",border:"1px solid var(--border)",borderRadius:6,padding:"4px 10px",fontSize:11,color:"var(--text)",cursor:"pointer"},children:"고객별 매출 Top 10"})]})]})}),r.jsxs("div",{style:{flex:1,overflow:"auto",padding:24},children:[i&&r.jsxs("div",{style:{textAlign:"center",padding:40},children:[r.jsx("div",{style:{width:40,height:40,border:"4px solid var(--border)",borderTop:"4px solid #10b981",borderRadius:"50%",margin:"0 auto 16px",animation:"spin 1s linear infinite"}}),r.jsx("p",{style:{color:"var(--muted)",fontSize:14},children:"AI가 매출 데이터를 분석하고 있습니다..."}),r.jsx("style",{children:`
                @keyframes spin {
                  0% { transform: rotate(0deg); }
                  100% { transform: rotate(360deg); }
                }
              `})]}),a&&r.jsxs("div",{style:{padding:16,background:"#fee",border:"1px solid #fcc",borderRadius:8,color:"#c33",fontSize:14},children:[r.jsx("strong",{children:"오류:"})," ",a]}),!i&&!a&&l&&r.jsx("div",{style:{fontSize:14,lineHeight:1.7,color:"var(--text)"},className:"markdown-content",children:r.jsx(Mv,{children:l})}),!i&&!a&&!l&&r.jsxs("div",{style:{textAlign:"center",padding:40,color:"var(--muted)"},children:[r.jsx("div",{style:{fontSize:48,marginBottom:16},children:"📊"}),r.jsx("p",{style:{fontSize:15,marginBottom:8},children:"매출 분석에 대해 무엇이든 물어보세요!"}),r.jsx("p",{style:{fontSize:13},children:"자연어로 질문하시면 AI가 매출 데이터를 분석하여 답변해드립니다."})]})]})]})}):null}const ZH=["영업1본부","영업1팀","영업2본부","영업2팀"];function eY(){const[e,n]=p.useState(()=>{try{const F=localStorage.getItem("tnt.sales.assign.year");return F?Number(F):new Date().getFullYear()}catch{return new Date().getFullYear()}}),[i,s]=p.useState([]),[a,o]=p.useState(!1),[l,c]=p.useState(null),[d,u]=p.useState([]),[f,h]=p.useState(!1),m=p.useRef(null),[g,b]=p.useState([]),[j,y]=p.useState(!1),[x,v]=p.useState(null),[A,N]=p.useState({tnt:0,dys:0}),[C,w]=p.useState([]),[_,I]=p.useState(!1),[O,E]=p.useState(null),[S,k]=p.useState(!1),D=p.useMemo(()=>{try{let F=0,te=0;for(const $ of g){const W=String(($==null?void 0:$.company_name)??($==null?void 0:$.companyName)??"").toUpperCase(),U=Number(($==null?void 0:$.target_amount_max)??0);Number.isFinite(U)&&(W==="TNT"?F+=U:W==="DYS"&&(te+=U))}return{tnt:F,dys:te}}catch{return{tnt:0,dys:0}}},[g]),T=p.useMemo(()=>({tnt:A.tnt/1e8,dys:A.dys/1e8}),[A]),P=p.useMemo(()=>({tnt:D.tnt-T.tnt,dys:D.dys-T.dys}),[D,T]),R=p.useMemo(()=>{try{const F=Z=>g.reduce((ee,K)=>{const ne=String((K==null?void 0:K.biz_area_name)??(K==null?void 0:K.bizAreaName)??""),pe=Number((K==null?void 0:K.target_amount_max)??0);return ee+(ne===Z&&Number.isFinite(pe)?pe:0)},0),te=F("복층유리"),$=F("건자재"),W=F("실란트");return(Number.isFinite(te)?te:0)+(Number.isFinite($)?$:0)+(Number.isFinite(W)?W:0)}catch{return 0}},[g]),Y=p.useMemo(()=>{const F=[];for(let te=2030;te>=2026;te--)F.push(te);return F},[]);async function X(F){o(!0),c(null);try{const te=new URL("/api/v1/targets/assigned",window.location.origin);te.searchParams.set("year",String(F));const $=await fetch(te.toString()),W=$.ok?await $.json():[],U=Array.isArray(W)?W:[];if(U.length>0){const pe=U.reduce((G,ae)=>{const ie=String(ae.emp_id??ae.empId??"").trim(),J=String(ae.emp_name??ae.empName??"").trim(),re=String(ae.dept_name??ae.deptName??""),de=ie||(J?`name:${J}`:"");return de&&(G.some(he=>he.key===de)||G.push({key:de,empId:ie,empName:J,deptName:re})),G},[]);pe.sort((G,ae)=>(G.deptName||"").localeCompare(ae.deptName||"")||(G.empName||"").localeCompare(ae.empName||"")),s(pe),o(!1);return}const Z=new URL("/api/v1/employees",window.location.origin);Z.searchParams.set("depts",ZH.join(","));const ee=await fetch(Z.toString());if(!ee.ok)throw new Error(`HTTP ${ee.status}`);const K=await ee.json(),ne=Array.isArray(K)?K.map(pe=>{const G=String(pe.empId??pe.emp_id??"").trim(),ae=String(pe.empName??pe.emp_name??"").trim(),ie=String(pe.deptName??pe.dept_name??""),J=String(pe.assignee_id??pe.assigneeId??"").trim()||void 0;return{key:G||J||(ae?`name:${ae}`:""),empId:G,empName:ae,deptName:ie,assigneeId:J}}).filter(pe=>!!pe.key):[];ne.sort((pe,G)=>(pe.deptName||"").localeCompare(G.deptName||"")||(pe.empName||"").localeCompare(G.empName||"")),s(ne)}catch(te){c((te==null?void 0:te.message)||"조회 중 오류"),s([])}finally{o(!1)}}p.useEffect(()=>{X(e)},[e]),p.useEffect(()=>{async function F(){y(!0),v(null);try{const te=new URL("/api/v1/targets/year",window.location.origin);te.searchParams.set("year",String(e));const $=await fetch(te.toString());if(!$.ok)throw new Error(`HTTP ${$.status}`);const W=await $.json();b(Array.isArray(W)?W:[])}catch(te){b([]),v((te==null?void 0:te.message)||"조회 오류")}finally{y(!1)}}F()},[e]),p.useEffect(()=>{async function F(){const te=d.length?i.filter(U=>d.includes(U.key)):i,$=te.map(U=>String(U.empId||"").trim()).filter(Boolean),W=te.map(U=>String(U.assigneeId||"").trim()).filter(Boolean);if(!e||$.length===0&&W.length===0){w([]),E(null);return}I(!0),E(null);try{const U=new URL("/api/v1/sales/plan/customer-counts",window.location.origin);U.searchParams.set("year",String(e)),$.length>0&&U.searchParams.set("empIds",$.join(",")),W.length>0&&U.searchParams.set("assigneeIds",W.join(","));const Z=await fetch(U.toString());if(!Z.ok)throw new Error(`HTTP ${Z.status}`);const ee=await Z.json();w(Array.isArray(ee)?ee:[])}catch(U){w([]),E((U==null?void 0:U.message)||"고객수 요약 조회 오류")}finally{I(!1)}}F()},[e,d,i]),p.useEffect(()=>{async function F(){try{const te=new URL("/api/v1/sales/plan/totals",window.location.origin);te.searchParams.set("year",String(e));const $=await fetch(te.toString());if(!$.ok)throw new Error(`HTTP ${$.status}`);const W=await $.json().catch(()=>[]);let U=0,Z=0;Array.isArray(W)&&W.forEach(ee=>{const K=String((ee==null?void 0:ee.company)||(ee==null?void 0:ee.company_type)||(ee==null?void 0:ee.companyName)||"").toUpperCase(),ne=Number((ee==null?void 0:ee.total)||(ee==null?void 0:ee.total_amount)||0);K==="TNT"?U+=Number.isFinite(ne)?ne:0:K==="DYS"&&(Z+=Number.isFinite(ne)?ne:0)}),N({tnt:U,dys:Z})}catch{N({tnt:0,dys:0})}}F()},[e]);function H(F){const te=Number(F.target.value);if(!(!Number.isFinite(te)||te<=0)){n(te);try{localStorage.setItem("tnt.sales.assign.year",String(te))}catch{}}}function q(F){u(F);const te=i.filter(W=>F.includes(W.key));try{localStorage.setItem("tnt.sales.selectedEmployees",JSON.stringify(te))}catch{}const $=te[0]||null;try{$?localStorage.setItem("tnt.sales.selectedEmployee",JSON.stringify($)):localStorage.removeItem("tnt.sales.selectedEmployee")}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.employees.selected",{detail:{items:te}}))}catch{}try{$&&window.dispatchEvent(new CustomEvent("tnt.sales.employee.selected"))}catch{}}function M(F){q(F?i.map(te=>te.key):[])}function L(F,te){const $=new Set(d);te?$.add(F):$.delete(F),q(Array.from($))}p.useEffect(()=>{if(!f)return;const F=$=>{m.current&&(m.current.contains($.target)||h(!1))},te=$=>{$.key==="Escape"&&h(!1)};return window.addEventListener("click",F,!0),window.addEventListener("keydown",te,!0),()=>{window.removeEventListener("click",F,!0),window.removeEventListener("keydown",te,!0)}},[f]);const B=p.useMemo(()=>{if(!d.length)return"전체";const F=i.filter(te=>d.includes(te.key)).map(te=>te.empName||te.empId||te.key);return F.length<=2?F.join(", "):`${F.slice(0,2).join(", ")} 외 ${F.length-2}명`},[d,i]);return r.jsxs("section",{children:[r.jsxs("div",{className:"card",style:{padding:8,marginBottom:12,display:"flex",alignItems:"center",gap:16,flexWrap:"wrap"},children:[r.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[r.jsx("div",{className:"muted",children:"목표년도"}),r.jsx("select",{className:"search-input",value:e,onChange:H,"aria-label":"목표년도",style:{height:28},children:Y.map(F=>r.jsxs("option",{value:String(F),children:[F,"년"]},F))})]}),r.jsxs("div",{ref:m,style:{position:"relative",display:"inline-flex",alignItems:"center",gap:8},children:[r.jsx("div",{className:"muted",children:"영업사원"}),r.jsxs("button",{type:"button",className:"search-input","aria-haspopup":"listbox","aria-expanded":f,onClick:()=>h(F=>!F),style:{height:28,minWidth:260,display:"inline-flex",alignItems:"center",justifyContent:"space-between",gap:8},children:[r.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:B}),r.jsx("span",{"aria-hidden":!0,children:"▾"})]}),f&&r.jsxs("div",{role:"listbox",className:"card",style:{position:"absolute",zIndex:60,top:"100%",left:0,width:380,maxHeight:260,overflow:"auto",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,padding:8,marginTop:6,fontSize:11},children:[r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 6px"},children:[r.jsx("input",{type:"checkbox",checked:d.length===i.length&&i.length>0,onChange:F=>M(F.target.checked)}),r.jsx("span",{children:"전체"})]}),a?r.jsx("div",{className:"muted",style:{padding:"6px 6px"},children:"불러오는 중…"}):i.length===0?r.jsx("div",{className:"muted",style:{padding:"6px 6px"},children:"목록이 없습니다"}):i.map(F=>{const te=d.includes(F.key),$=`${F.deptName||"-"} / ${F.empName||""}${F.empId?` (${F.empId})`:""}`;return r.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 6px",cursor:"pointer"},children:[r.jsx("input",{type:"checkbox",checked:te,onChange:W=>L(F.key,W.target.checked)}),r.jsx("span",{children:$})]},F.key)}),l?r.jsx("div",{className:"error",style:{padding:"6px 6px"},children:l}):null]})]})]}),r.jsxs("div",{className:"card",style:{padding:8},children:[x?r.jsx("div",{className:"error",style:{marginBottom:8},children:x}):null,j?r.jsx("div",{className:"muted",style:{padding:"8px 6px"},children:"불러오는 중…"}):r.jsxs("div",{style:{display:"flex",alignItems:"stretch",gap:12},children:[r.jsxs("div",{style:{flex:"1 1 auto",display:"flex",flexDirection:"column",gap:6},children:[r.jsxs("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-between",margin:"0 2px"},children:[r.jsx("div",{className:"muted",style:{fontWeight:800},children:"회사 목표"}),r.jsx("div",{style:{fontWeight:800},children:Number.isFinite(R)?`${Number(R).toLocaleString(void 0,{maximumFractionDigits:1})} 억원`:"-"})]}),(()=>{let F=0,te=0,$,W=0,U;g.forEach(K=>{const ne=String((K==null?void 0:K.company_name)??(K==null?void 0:K.companyName)??"").toUpperCase(),pe=String((K==null?void 0:K.biz_area_name)??(K==null?void 0:K.bizAreaName)??""),G=Number((K==null?void 0:K.target_amount_max)??0),ae=String((K==null?void 0:K.target_stage)??(K==null?void 0:K.targetStage)??"")||void 0;ne==="TNT"?(pe==="복층유리"&&Number.isFinite(G)?F+=G:pe==="건자재"&&Number.isFinite(G)&&(te+=G),ae&&($=ae)):ne==="DYS"&&pe==="실란트"&&(Number.isFinite(G)&&(W+=G),ae&&(U=ae))});const Z=[{company:"TNT",biz:"복층유리+건자재",max:F+te,stage:$},{company:"DYS",biz:"실란트",max:W,stage:U}];return r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:8},children:Z.map((K,ne)=>{const pe=K.company,G=K.biz,ae=K.max,ie=K.stage||"";return r.jsx("div",{className:"card",style:{padding:8,border:"1px solid var(--border)",borderRadius:10,display:"flex",alignItems:"center",minHeight:92,position:"relative"},children:r.jsxs("div",{style:{flex:1},children:[ie?r.jsx("div",{style:{position:"absolute",top:6,left:6},children:r.jsx("span",{className:"badge",style:{fontSize:8,padding:"0 4px",lineHeight:1.1,border:"1px solid var(--border)",borderRadius:6},children:ie})}):null,pe==="TNT"&&G==="복층유리+건자재"?(()=>{try{let J=0,re=0;for(const he of g){const oe=String((he==null?void 0:he.company_name)??(he==null?void 0:he.companyName)??"").toUpperCase(),V=String((he==null?void 0:he.biz_area_name)??(he==null?void 0:he.bizAreaName)??""),Pe=Number((he==null?void 0:he.target_amount_max)??0);oe==="TNT"&&Number.isFinite(Pe)&&(V==="복층유리"?J+=Pe:V==="건자재"&&(re+=Pe))}const de=Number.isFinite(ae)?Number(ae):J+re;return r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,textAlign:"center"},children:[r.jsxs("div",{style:{fontWeight:800,fontSize:18,lineHeight:1.1},children:["TNT ",de.toLocaleString(void 0,{maximumFractionDigits:1}),"억원"]}),r.jsxs("div",{className:"muted",style:{fontSize:10,lineHeight:1.1},children:["(",`복층${J.toLocaleString(void 0,{maximumFractionDigits:1})}억원+건자재${re.toLocaleString(void 0,{maximumFractionDigits:1})}억원`,")"]})]})}catch{return r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,textAlign:"center"},children:[r.jsx("div",{style:{fontWeight:700,fontSize:11},children:"TNT"}),r.jsx("div",{className:"muted",style:{fontSize:11,lineHeight:1.1},children:"데이터 없음"})]})}})():r.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,textAlign:"center"},children:String(pe||"").toUpperCase()==="DYS"&&G==="실란트"?r.jsx(r.Fragment,{children:r.jsxs("div",{style:{fontWeight:800,fontSize:18,lineHeight:1.1},children:["DYS ",Number(ae).toLocaleString(void 0,{maximumFractionDigits:1}),"억원"]})}):r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{fontWeight:700,fontSize:11},children:G||"-"}),r.jsx("div",{style:{fontSize:11,fontWeight:800,lineHeight:1.1},children:Number.isFinite(ae)?`${Number(ae).toLocaleString(void 0,{maximumFractionDigits:1})} 억원`:"-"})]})})]})},ne)})})})()]}),r.jsx("div",{style:{flex:"0 0 auto",width:1,background:"var(--border)"}}),r.jsxs("aside",{style:{flex:"0 0 260px",maxWidth:320,paddingLeft:8,display:"flex",flexDirection:"column",justifyContent:"center"},children:[r.jsx("div",{style:{fontWeight:800,marginBottom:8},children:"목표수립 현황"}),r.jsx("div",{className:"card",style:{padding:10,border:"1px solid var(--border)",borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",minHeight:92},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,width:"100%"},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:r.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`TNT ${T.tnt.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})}),r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:r.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`DYS ${T.dys.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})})]})})]}),r.jsx("div",{style:{flex:"0 0 auto",width:1,background:"var(--border)"}}),r.jsxs("aside",{style:{flex:"0 0 260px",maxWidth:320,paddingLeft:8,display:"flex",flexDirection:"column",justifyContent:"center"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[r.jsx("div",{style:{fontWeight:800},children:"차액"}),r.jsxs("button",{onClick:()=>k(!0),style:{padding:"4px 10px",background:"linear-gradient(135deg, #10b981 0%, #059669 100%)",border:"none",borderRadius:6,color:"white",fontSize:11,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:4},children:[r.jsx("span",{children:"💰"}),r.jsx("span",{children:"매출 AI Agent (Beta)"})]})]}),r.jsx("div",{className:"card",style:{padding:10,border:"1px solid var(--border)",borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",minHeight:92},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,width:"100%"},children:[r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:r.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`TNT ${P.tnt.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})}),r.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:r.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`DYS ${P.dys.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})})]})})]})]})]}),r.jsxs("div",{className:"card",style:{padding:8,marginTop:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[r.jsx("div",{style:{fontWeight:800},children:"고객수 요약"}),_?r.jsx("div",{className:"muted",style:{fontSize:12},children:"불러오는 중…"}):null]}),O?r.jsx("div",{className:"error",style:{marginBottom:8},children:O}):null,(()=>{const F=d.length?i.filter($=>d.includes($.key)):i,te=new Map;for(const $ of C){const W=String(($==null?void 0:$.assignee_id)||($==null?void 0:$.emp_id)||"").trim();if(!W)continue;const U=te.get(W)||[];U.push($),te.set(W,U)}return r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:10},children:F.map($=>{const W=String($.assigneeId||$.empId||$.key||""),U=te.get(W)||[],Z=["TNT","DYS"],ee=[...U].sort((K,ne)=>Z.indexOf(String(K.company||"").toUpperCase())-Z.indexOf(String(ne.company||"").toUpperCase()));return r.jsxs("div",{className:"card",style:{padding:10,border:"1px solid var(--border)",borderRadius:10},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[r.jsxs("div",{style:{fontWeight:700},children:[$.deptName||"-"," / ",$.empName||$.empId||$.key]}),r.jsxs("div",{className:"muted",style:{fontSize:11},children:[e,"년"]})]}),ee.length===0?r.jsx("div",{className:"muted",style:{fontSize:12},children:"데이터가 없습니다"}):r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:8},children:ee.map((K,ne)=>r.jsxs("div",{className:"card",style:{padding:8,border:"1px solid var(--border)",borderRadius:8,minHeight:92,display:"flex",flexDirection:"column",justifyContent:"center"},children:[r.jsx("div",{style:{fontWeight:700,marginBottom:6},children:String(K.company||"").toUpperCase()}),r.jsxs("div",{style:{display:"flex",gap:16,fontSize:12,justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[r.jsx("span",{className:"muted",children:"수립대상"}),r.jsx("strong",{children:Number(K.total_customers||0).toLocaleString()})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[r.jsx("span",{className:"muted",children:"확정"}),r.jsx("strong",{children:Number(K.confirmed_customers||0).toLocaleString()})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[r.jsx("span",{className:"muted",children:"진행 중"}),r.jsx("strong",{children:Number(K.planning_customers||0).toLocaleString()})]})]})]},ne))})]},W)})})})()]}),r.jsx(JH,{isOpen:S,onClose:()=>k(!1)})]})}function tY(){return r.jsxs("section",{children:[r.jsx("h1",{children:"매출관리"}),r.jsx("div",{className:"empty-state",children:"초기 스켈레톤: 매출관리 화면"})]})}const kv="http://220.73.213.73/Angkor.Ylw.Common.HttpExecute/RestOutsideService.svc/OpenApi/IsStoredProcedure/tnt_SWAPISLCustCreditListInfo",nY={certId:"TNT_CRM",certKey:"9836164F-3601-4DBB-9D6D-54685CD89B95",dsn:"tnt_bis",dsnOper:"tnt_oper",securityType:0,CompanySeq:1},gf=[20,50,100],yi=e=>new Intl.NumberFormat("ko-KR",{maximumFractionDigits:0}).format(Math.round(e||0)),rY=e=>{const n=i=>{const s=Number(i);return Number.isFinite(s)?s:0};return{CustName:String(e.CustName??""),CustNo:String(e.CustNo??""),CustSeq:String(e.CustSeq??""),IsCreditCheck:e.IsCreditCheck==="Y"?"Y":e.IsCreditCheck==="N"?"N":"",CurrName:String(e.CurrName??""),PrevCreditAmt:n(e.PrevCreditAmt),SalesAmt:n(e.SalesAmt),SalesVat:n(e.SalesVat),TotSalesAmt:n(e.TotSalesAmt),ReceiptAmt:n(e.ReceiptAmt),NoReceiptAmt:n(e.NoReceiptAmt)}},iY=({stdDate:e,custSeq:n,empSeq:i,pageNo:s,pageSize:a})=>({ROOT:{...nY,data:{ROOT:{DataBlock1:{StdDate:e.replace(/-/g,""),CustSeq:n.trim()?Number(n):"",EmpSeq:i.trim()?Number(i):"",SMQryType:1078004,IncludeMiNote:1,PAGE_NO:s,PAGE_SIZE:a}}}}});function sY(){const e=new Date().toISOString().slice(0,10),[n,i]=p.useState({stdDate:e,custSeq:"",empSeq:""}),[s,a]=p.useState(n),[o,l]=p.useState(1),[c,d]=p.useState(gf[0]),[u,f]=p.useState([]),[h,m]=p.useState({PAGE_NO:1,PAGE_SIZE:gf[0],TotalData:0,TotalPage:0}),[g,b]=p.useState(!1),[j,y]=p.useState(null),[x,v]=p.useState(null),[A,N]=p.useState(null),[C,w]=p.useState(!1),[_,I]=p.useState(null),O=(P,R)=>{i(Y=>({...Y,[P]:R}))},E=()=>{a(n),l(1)},S=P=>{d(P),l(1)},k=P=>{l(R=>P==="next"?h.TotalPage&&R>=h.TotalPage?R:R+1:Math.max(1,R-1))},D=p.useMemo(()=>u.reduce((P,R)=>(P.sales+=R.SalesAmt,P.receipt+=R.ReceiptAmt,P.noReceipt+=R.NoReceiptAmt,P),{sales:0,receipt:0,noReceipt:0}),[u]),T=p.useCallback(async()=>{b(!0),y(null);try{const P=iY({stdDate:s.stdDate,custSeq:s.custSeq,empSeq:s.empSeq,pageNo:o,pageSize:c}),R=JSON.stringify(P,null,2);N(R),w(!0);const Y=await fetch(kv,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(P)});if(!Y.ok)throw new Error(`서버 응답이 존재하지 않거나 상태값 ${Y.status}`);const X=await Y.json(),H=X==null?void 0:X.ROOT,q=H==null?void 0:H.ReturnCode;if(q!=="0000"){const B=`ReturnCode: ${q??"N/A"}${H!=null&&H.ReturnMessage?` • ${H.ReturnMessage}`:""}`;throw I(B),new Error((H==null?void 0:H.ReturnMessage)??"데이터를 불러오는 데 실패했습니다.")}I(`ReturnCode: ${q??"N/A"}${H!=null&&H.ReturnMessage?` • ${H.ReturnMessage}`:""}`);const M=Array.isArray(H==null?void 0:H.DataBlock1)?H.DataBlock1:[];f(M.map(rY));const L=Array.isArray(H==null?void 0:H.DataBlock2)?H.DataBlock2[0]:null;m(L?{PAGE_NO:Number(L.PAGE_NO??o),PAGE_SIZE:Number(L.PAGE_SIZE??c),TotalData:Number(L.TotalData??M.length),TotalPage:Number(L.TotalPage??0)}:B=>({...B,PAGE_NO:o,PAGE_SIZE:c,TotalData:M.length,TotalPage:Math.max(1,Math.ceil(M.length/c))})),v(new Date().toLocaleString())}catch(P){y(P.message??"데이터를 불러오는 중 알 수 없는 오류가 발생했습니다."),f([])}finally{b(!1)}},[s,o,c]);return p.useEffect(()=>{T()},[T]),r.jsxs("section",{className:"receivables-page",children:[r.jsxs("div",{className:"page-title",children:[r.jsx("h1",{children:"미수현황"}),r.jsx("p",{children:"기준일/필터를 설정하고 서버에서 고객 미수/판매/수금 데이터를 조회하세요."})]}),r.jsxs("div",{className:"filters-grid",children:[r.jsxs("label",{className:"field",children:[r.jsx("span",{children:"기준일"}),r.jsx("input",{type:"date",value:n.stdDate,onChange:P=>O("stdDate",P.target.value),className:"search-input"})]}),r.jsxs("label",{className:"field",children:[r.jsx("span",{children:"거래처 코드(CustSeq)"}),r.jsx("input",{type:"number",placeholder:"전체",value:n.custSeq,min:0,onChange:P=>O("custSeq",P.target.value),className:"search-input"})]}),r.jsxs("label",{className:"field",children:[r.jsx("span",{children:"사원 코드(EmpSeq)"}),r.jsx("input",{type:"number",placeholder:"전체",value:n.empSeq,min:0,onChange:P=>O("empSeq",P.target.value),className:"search-input"})]}),r.jsxs("label",{className:"field",children:[r.jsx("span",{children:"페이지 크기"}),r.jsx("select",{value:c,onChange:P=>S(Number(P.target.value)),className:"search-input",children:gf.map(P=>r.jsxs("option",{value:P,children:[P,"개"]},P))})]}),r.jsxs("div",{className:"field actions",children:[r.jsx("button",{type:"button",className:"btn",onClick:E,disabled:g,children:"조회하기"}),r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>l(1),disabled:o===1,children:"첫 페이지"}),r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>A&&w(!0),disabled:!A,children:"최근 전문 보기"})]})]}),r.jsxs("div",{className:"summary-cards",children:[r.jsxs("article",{className:"summary-card",children:[r.jsxs("div",{children:[r.jsx("p",{className:"muted",children:"총 데이터"}),r.jsxs("strong",{children:[h.TotalData.toLocaleString(),"건"]})]}),r.jsxs("span",{className:"muted",children:[h.PAGE_NO," / ",Math.max(1,h.TotalPage)," 페이지"]})]}),r.jsxs("article",{className:"summary-card",children:[r.jsxs("div",{children:[r.jsx("p",{className:"muted",children:"금월 판매"}),r.jsxs("strong",{children:[yi(D.sales)," 원"]})]}),r.jsx("span",{className:"muted",children:"합계"})]}),r.jsxs("article",{className:"summary-card",children:[r.jsxs("div",{children:[r.jsx("p",{className:"muted",children:"금월 수금"}),r.jsxs("strong",{children:[yi(D.receipt)," 원"]})]}),r.jsx("span",{className:"muted",children:"합계"})]}),r.jsxs("article",{className:"summary-card highlight",children:[r.jsxs("div",{children:[r.jsx("p",{className:"muted",children:"현미수액"}),r.jsxs("strong",{children:[yi(D.noReceipt)," 원"]})]}),r.jsx("span",{className:"muted",children:"수금과 대비"})]})]}),r.jsxs("div",{className:"table-panel",children:[r.jsxs("div",{className:"table-panel-header",children:[r.jsx("div",{children:r.jsxs("p",{className:"muted",children:["마지막 업데이트: ",x??"—"]})}),r.jsxs("div",{className:"pagination-controls",children:[r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>k("prev"),disabled:o===1,children:"이전"}),r.jsxs("span",{children:[o," page / ",Math.max(1,h.TotalPage)," page"]}),r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>k("next"),disabled:h.TotalPage>0?o>=h.TotalPage:u.length<c,children:"다음"})]})]}),j&&r.jsx("div",{className:"empty-state",children:j}),r.jsx("div",{className:"table-container receivables-table",children:r.jsxs("table",{className:"table",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"거래처 코드"}),r.jsx("th",{children:"거래처명"}),r.jsx("th",{children:"통화"}),r.jsx("th",{children:"전월이월"}),r.jsx("th",{children:"금월판매"}),r.jsx("th",{children:"부가세"}),r.jsx("th",{children:"금월판매계"}),r.jsx("th",{children:"금월수금"}),r.jsx("th",{children:"현미수액"}),r.jsx("th",{children:"미수 여부"})]})}),r.jsx("tbody",{children:g?r.jsx("tr",{children:r.jsx("td",{colSpan:10,children:r.jsx("div",{className:"empty-state",children:"데이터를 불러오는 중입니다…"})})}):u.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:10,children:r.jsx("div",{className:"empty-state",children:"조회 결과가 없습니다."})})}):u.map(P=>r.jsxs("tr",{children:[r.jsx("td",{children:P.CustSeq}),r.jsx("td",{children:P.CustName}),r.jsx("td",{children:P.CurrName}),r.jsxs("td",{children:[yi(P.PrevCreditAmt)," 원"]}),r.jsxs("td",{children:[yi(P.SalesAmt)," 원"]}),r.jsxs("td",{children:[yi(P.SalesVat)," 원"]}),r.jsxs("td",{children:[yi(P.TotSalesAmt)," 원"]}),r.jsxs("td",{children:[yi(P.ReceiptAmt)," 원"]}),r.jsxs("td",{className:"highlight-cell",children:[yi(P.NoReceiptAmt)," 원"]}),r.jsx("td",{children:P.IsCreditCheck||"N"})]},`${P.CustSeq}-${P.CustNo}`))})]})})]}),C&&A?r.jsx("div",{className:"json-modal-backdrop",role:"dialog","aria-modal":"true",children:r.jsxs("div",{className:"json-modal",children:[r.jsx("div",{className:"json-modal-header",children:r.jsx("strong",{children:"직전 요청 전문"})}),r.jsxs("p",{className:"muted",style:{fontSize:12},children:["요청 URL: ",kv]}),r.jsx("pre",{children:A}),_?r.jsx("p",{className:"muted",style:{wordBreak:"break-all"},children:_}):null,r.jsx("div",{className:"json-modal-actions",children:r.jsx("button",{type:"button",className:"btn secondary",onClick:()=>w(!1),children:"닫기"})})]})}):null]})}const aY="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3ccircle%20cx='12'%20cy='12'%20r='10'/%3e%3ccircle%20cx='12'%20cy='12'%20r='6'/%3e%3ccircle%20cx='12'%20cy='12'%20r='2'/%3e%3c/svg%3e",oY="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='20'%20height='20'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M12%203L14%208L19%2010L14%2012L12%2017L10%2012L5%2010L10%208L12%203Z'/%3e%3cpath%20d='M19%204L19.5%205.5L21%206L19.5%206.5L19%208L18.5%206.5L17%206L18.5%205.5L19%204Z'/%3e%3cpath%20d='M19%2016L19.5%2017.5L21%2018L19.5%2018.5L19%2020L18.5%2018.5L17%2018L18.5%2017.5L19%2016Z'/%3e%3c/svg%3e";function lY({isOpen:e,onClose:n}){const[i,s]=p.useState(!1),[a,o]=p.useState(null),[l,c]=p.useState(""),[d,u]=p.useState("");p.useEffect(()=>{e&&(u(""),c(""),o(null))},[e]);const f=async()=>{if(!d.trim()){o("질문을 입력해주세요.");return}s(!0),o(null),c("");try{const m=await fetch("/api/v1/activity-analysis-ai/analyze",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:d.trim(),assigneeId:So(),empName:Rv()})});if(!m.ok)throw new Error(`HTTP ${m.status}`);const g=await m.json();g.error?o(g.error):g.analysis?c(g.analysis):o("분석 결과를 받지 못했습니다.")}catch(m){o(m.message||"분석 중 오류가 발생했습니다.")}finally{s(!1)}},h=m=>{m.key==="Enter"&&!m.shiftKey&&(m.preventDefault(),f())};return e?r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},onMouseDown:m=>{m.button===0&&m.target===m.currentTarget&&n()},onContextMenu:m=>{m.target===m.currentTarget&&m.preventDefault()},children:r.jsxs("div",{style:{background:"var(--panel)",borderRadius:16,boxShadow:"0 20px 60px rgba(0, 0, 0, 0.3)",width:"90%",maxWidth:1e3,maxHeight:"90vh",display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",justifyContent:"space-between",background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",borderRadius:"16px 16px 0 0"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"rgba(255, 255, 255, 0.2)",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx("span",{style:{fontSize:24},children:"🤖"})}),r.jsxs("div",{children:[r.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700,color:"white"},children:"활동분석 AI Agent"}),r.jsx("p",{style:{margin:"4px 0 0 0",fontSize:13,color:"rgba(255, 255, 255, 0.8)"},children:"AI가 활동 데이터를 분석하여 인사이트를 제공합니다"})]})]}),r.jsx("button",{onClick:n,style:{background:"rgba(255, 255, 255, 0.2)",border:"none",borderRadius:8,width:36,height:36,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"white",fontSize:20,fontWeight:"bold"},children:"×"})]}),r.jsx("div",{style:{padding:"20px 24px",borderBottom:"1px solid var(--border)",background:"var(--background)"},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{fontSize:13,color:"var(--text)",display:"block",marginBottom:8,fontWeight:600},children:"무엇을 분석해드릴까요?"}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("textarea",{value:d,onChange:m=>u(m.target.value),onKeyPress:h,placeholder:`예: 이번 주 김철수 사원의 활동을 분석해줘
예: 지난달 우리 팀의 주요 활동은 무엇이었나요?
예: 최근 2주간 미완료된 활동들을 요약해줘`,disabled:i,style:{flex:1,padding:"12px 16px",border:"1px solid var(--border)",borderRadius:10,fontSize:14,background:"var(--panel)",color:"var(--text)",resize:"vertical",minHeight:80,fontFamily:"inherit",lineHeight:1.5}}),r.jsx("button",{onClick:f,disabled:i||!d.trim(),style:{padding:"12px 24px",background:i||!d.trim()?"#ccc":"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",border:"none",borderRadius:10,color:"white",fontSize:14,fontWeight:600,cursor:i||!d.trim()?"not-allowed":"pointer",whiteSpace:"nowrap",boxShadow:i||!d.trim()?"none":"0 2px 8px rgba(102, 126, 234, 0.3)",transition:"all 0.2s ease"},children:i?"분석 중...":"분석하기"})]})]}),r.jsxs("div",{style:{fontSize:12,color:"var(--muted)",display:"flex",gap:8,flexWrap:"wrap"},children:[r.jsx("span",{children:"💡 예시:"}),r.jsx("button",{onClick:()=>u("이번 주 활동을 요약해줘"),disabled:i,style:{background:"none",border:"1px solid var(--border)",borderRadius:6,padding:"4px 10px",fontSize:11,color:"var(--text)",cursor:"pointer"},children:"이번 주 활동 요약"}),r.jsx("button",{onClick:()=>u("지난주 달성률은 어떻게 되나요?"),disabled:i,style:{background:"none",border:"1px solid var(--border)",borderRadius:6,padding:"4px 10px",fontSize:11,color:"var(--text)",cursor:"pointer"},children:"지난주 달성률"}),r.jsx("button",{onClick:()=>u("최근 한 달간 주요 고객 방문 내역을 알려줘"),disabled:i,style:{background:"none",border:"1px solid var(--border)",borderRadius:6,padding:"4px 10px",fontSize:11,color:"var(--text)",cursor:"pointer"},children:"최근 고객 방문"})]})]})}),r.jsxs("div",{style:{flex:1,overflow:"auto",padding:24},children:[i&&r.jsxs("div",{style:{textAlign:"center",padding:40},children:[r.jsx("div",{style:{width:40,height:40,border:"4px solid var(--border)",borderTop:"4px solid #667eea",borderRadius:"50%",margin:"0 auto 16px",animation:"spin 1s linear infinite"}}),r.jsx("p",{style:{color:"var(--muted)",fontSize:14},children:"AI가 활동 데이터를 분석하고 있습니다..."}),r.jsx("style",{children:`
                @keyframes spin {
                  0% { transform: rotate(0deg); }
                  100% { transform: rotate(360deg); }
                }
              `})]}),a&&r.jsxs("div",{style:{padding:16,background:"#fee",border:"1px solid #fcc",borderRadius:8,color:"#c33",fontSize:14},children:[r.jsx("strong",{children:"오류:"})," ",a]}),!i&&!a&&l&&r.jsxs("div",{style:{fontSize:14,lineHeight:1.7,color:"var(--text)"},className:"markdown-content",children:[r.jsx("style",{children:`
                .markdown-content table {
                  width: 100%;
                  border-collapse: collapse;
                  margin: 16px 0;
                  font-size: 13px;
                }
                .markdown-content th {
                  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                  color: white;
                  padding: 12px 16px;
                  text-align: left;
                  font-weight: 600;
                  border: none;
                }
                .markdown-content th:first-child {
                  border-radius: 8px 0 0 0;
                }
                .markdown-content th:last-child {
                  border-radius: 0 8px 0 0;
                }
                .markdown-content td {
                  padding: 12px 16px;
                  border-bottom: 1px solid var(--border);
                  vertical-align: top;
                }
                .markdown-content tr:hover td {
                  background: rgba(102, 126, 234, 0.05);
                }
                .markdown-content tr:last-child td:first-child {
                  border-radius: 0 0 0 8px;
                }
                .markdown-content tr:last-child td:last-child {
                  border-radius: 0 0 8px 0;
                }
                .markdown-content h1, .markdown-content h2, .markdown-content h3 {
                  margin-top: 24px;
                  margin-bottom: 12px;
                  color: var(--text);
                }
                .markdown-content h2 {
                  font-size: 18px;
                  border-bottom: 2px solid #667eea;
                  padding-bottom: 8px;
                }
                .markdown-content h3 {
                  font-size: 16px;
                  color: #667eea;
                }
                .markdown-content ul, .markdown-content ol {
                  margin: 12px 0;
                  padding-left: 24px;
                }
                .markdown-content li {
                  margin: 6px 0;
                }
                .markdown-content strong {
                  color: #667eea;
                }
              `}),r.jsx(Mv,{remarkPlugins:[hN],children:l})]}),!i&&!a&&!l&&r.jsxs("div",{style:{textAlign:"center",padding:40,color:"var(--muted)"},children:[r.jsx("div",{style:{fontSize:48,marginBottom:16},children:"💬"}),r.jsx("p",{style:{fontSize:15,marginBottom:8},children:"활동 분석에 대해 무엇이든 물어보세요!"}),r.jsx("p",{style:{fontSize:13},children:"자연어로 질문하시면 AI가 활동 데이터를 분석하여 답변해드립니다."})]})]})]})}):null}function Yl({value:e,max:n,color:i,label:s}){const a=Math.max(0,Math.min(100,n>0?e/n*100:0));return r.jsxs("div",{"aria-label":s,style:{position:"relative",width:"100%",height:11,background:"rgba(0,0,0,.04)",borderRadius:999,overflow:"hidden"},children:[r.jsx("div",{style:{width:`${a}%`,height:"100%",background:i,borderRadius:999,transition:"width .2s ease"}}),r.jsx("div",{style:{position:"absolute",right:6,top:0,bottom:0,display:"flex",alignItems:"center",fontSize:10,color:"var(--text)"},children:e})]})}function cY(){const[e,n]=p.useState(!0),[i,s]=p.useState(null),[a,o]=p.useState([]),[l,c]=p.useState(0),[d,u]=p.useState("default"),[f,h]=p.useState(!1),[m,g]=p.useState([]),[b,j]=p.useState(!0),[y,x]=p.useState(null);p.useEffect(()=>{let D=!1;async function T(){n(!0),s(null);try{const P=await fetch("/api/v1/employees");if(!P.ok)throw new Error(`EMP HTTP ${P.status}`);const R=await P.json();if(D)return;const Y=(Array.isArray(R)?R:[]).map((X,H)=>({id:String(X.assignee_id??X.emp_id??H),name:String(X.emp_name??""),prevWeek:{plan:0,actual:0},thisWeek:{plan:0,actual:0},nextWeek:{plan:0,actual:0}}));o(Y);try{const[X,H]=await Promise.all([Kl(l),Kl(l-1)]);if(D)return;const q=_v(X),M=yf(H);o(Y.map(L=>{const B=q.get(L.id),F=M.get(L.id);return{...L,prevWeek:{plan:(F==null?void 0:F.plan)??0,actual:(F==null?void 0:F.actual)??0},thisWeek:{plan:(B==null?void 0:B.thisPlan)??0,actual:(B==null?void 0:B.thisActual)??0},nextWeek:{plan:(B==null?void 0:B.nextPlan)??0,actual:(B==null?void 0:B.nextActual)??0}}}))}catch{s("주간 활동 요약을 불러오지 못했습니다")}}catch{if(D)return;s("직원 목록을 불러오지 못했습니다");try{const R=await Kl(l),Y=await Kl(l-1).catch(()=>[]);if(D)return;const X=yf(Y),H=(Array.isArray(R)?R:[]).map((q,M)=>{var F,te,$,W;const L=String(q.assignee_id??q.emp_id??M),B=X.get(L);return{id:L,name:String(q.emp_name??""),prevWeek:{plan:(B==null?void 0:B.plan)??0,actual:(B==null?void 0:B.actual)??0},thisWeek:{plan:Number(((F=q.thisWeek)==null?void 0:F.plan)??0),actual:Number(((te=q.thisWeek)==null?void 0:te.actual)??0)},nextWeek:{plan:Number((($=q.nextWeek)==null?void 0:$.plan)??0),actual:Number(((W=q.nextWeek)==null?void 0:W.actual)??0)}}});o(H)}catch{o([{id:"e01",name:"김영업",prevWeek:{plan:0,actual:0},thisWeek:{plan:0,actual:0},nextWeek:{plan:0,actual:0}},{id:"e02",name:"박세일",prevWeek:{plan:0,actual:0},thisWeek:{plan:0,actual:0},nextWeek:{plan:0,actual:0}}])}}finally{D||n(!1)}}return T(),()=>{D=!0}},[l]),p.useEffect(()=>{let D=!1;async function T(){j(!0),x(null);try{const[P,R]=await Promise.all([Nv(l),Nv(l-1)]);if(D)return;const Y=_v(P),X=yf(R),H=new Set;for(const M of[...P,...R]){const L=String(M.assignee_id??M.emp_id??"");L&&H.add(L)}const q=Array.from(H).map(M=>{const L=Y.get(M),B=X.get(M),F=P.find($=>String($.assignee_id??$.emp_id)===M)||R.find($=>String($.assignee_id??$.emp_id)===M),te=F?String(F.emp_name??M):M;return{id:M,name:te,prevWeek:{plan:(B==null?void 0:B.plan)??0,actual:(B==null?void 0:B.actual)??0},thisWeek:{plan:(L==null?void 0:L.thisPlan)??0,actual:(L==null?void 0:L.thisActual)??0},nextWeek:{plan:(L==null?void 0:L.nextPlan)??0,actual:(L==null?void 0:L.nextActual)??0}}});q.sort((M,L)=>M.name.localeCompare(L.name)),g(q)}catch{if(D)return;x("지역 활동 계획을 불러오지 못했습니다"),g([])}finally{D||j(!1)}}return T(),()=>{D=!0}},[l]);const v=p.useMemo(()=>{let D=1;for(const T of a)D=Math.max(D,T.prevWeek.plan,T.prevWeek.actual,T.thisWeek.plan,T.thisWeek.actual,T.nextWeek.plan,T.nextWeek.actual);return D},[a]),A=p.useMemo(()=>{let D=1;for(const T of m)D=Math.max(D,T.prevWeek.plan,T.prevWeek.actual,T.thisWeek.plan,T.thisWeek.actual,T.nextWeek.plan,T.nextWeek.actual);return D},[m]),N=p.useMemo(()=>a.map(D=>{const T=D.prevWeek.plan,P=D.prevWeek.actual,R=T>0?P/T*100:0;return{...D,achievementRate:R,prevTotal:T}}),[a]),C=p.useMemo(()=>m.map(D=>{const T=D.prevWeek.plan,P=D.prevWeek.actual,R=T>0?P/T*100:0;return{...D,achievementRate:R,prevTotal:T}}),[m]),w=p.useMemo(()=>{const D=[...N];return d==="rate-high"?D.sort((T,P)=>P.achievementRate-T.achievementRate):d==="rate-low"?D.sort((T,P)=>T.achievementRate-P.achievementRate):D},[N,d]),_=p.useMemo(()=>{const D=[...C];return d==="rate-high"?D.sort((T,P)=>P.achievementRate-T.achievementRate):d==="rate-low"?D.sort((T,P)=>T.achievementRate-P.achievementRate):D},[C,d]),I="#3b82f6",O="#10b981",E=Be.useCallback((D,T,P,R)=>{const Y=Ng(l+T);try{window.dispatchEvent(new CustomEvent(R?"tnt.sales.region-plans.select":"tnt.sales.activities.select",{detail:{assigneeId:D.id,empName:D.name,startIso:Y.start.toISOString(),endIso:Y.end.toISOString(),label:`${D.name} · ${P} 계획/실적`,isRegion:R||!1}}))}catch{}},[l]),S=p.useMemo(()=>aN(Ng(l)),[l]);function k(D,T){const P=D>=90?"#10b981":D>=70?"#f59e0b":"#ef4444";return{display:T?`${Math.round(D)}%`:"-",color:P}}return r.jsxs("section",{className:"sales-activities-panel",style:{display:"flex",flexDirection:"column",gap:20},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:16,paddingBottom:12,borderBottom:"2px solid var(--border)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:12},children:[r.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700},children:"활동관리"}),r.jsx("div",{className:"muted",style:{fontSize:13,fontWeight:500},children:"주간 계획·실적"})]}),r.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[r.jsxs("div",{className:"card",style:{display:"inline-flex",alignItems:"center",gap:8,padding:"0 12px",border:"1px solid var(--border)",borderRadius:10,background:"var(--panel)",boxShadow:"0 1px 3px rgba(0,0,0,.05)",height:44},children:[r.jsx("button",{className:"icon-button",title:"전주","aria-label":"전주",onClick:()=>c(D=>D-1),onKeyDown:D=>{(D.key==="Enter"||D.key===" ")&&(D.preventDefault(),c(T=>T-1))},style:{width:30,height:30,borderRadius:6},children:r.jsx("img",{src:$v,className:"icon",alt:"전주"})}),r.jsx("button",{className:"icon-button",title:"이번주로","aria-label":"이번주로",onClick:()=>c(0),onKeyDown:D=>{(D.key==="Enter"||D.key===" ")&&(D.preventDefault(),c(0))},style:{width:30,height:30,borderRadius:6},children:r.jsx("img",{src:aY,className:"icon",alt:"이번주로"})}),r.jsx("button",{className:"icon-button",title:"다음주","aria-label":"다음주",onClick:()=>c(D=>D+1),onKeyDown:D=>{(D.key==="Enter"||D.key===" ")&&(D.preventDefault(),c(T=>T+1))},style:{width:30,height:30,borderRadius:6},children:r.jsx("img",{src:Lv,className:"icon",alt:"다음주"})}),r.jsx("span",{className:"muted",style:{fontSize:12,marginLeft:4,whiteSpace:"nowrap",fontWeight:600,minWidth:140,textAlign:"center"},children:S})]}),r.jsxs("div",{className:"card",style:{padding:"0 12px",border:"1px solid var(--border)",borderRadius:10,display:"inline-flex",alignItems:"center",gap:8,background:"var(--panel)",boxShadow:"0 1px 3px rgba(0,0,0,.05)",height:44},children:[r.jsx("label",{htmlFor:"sort-select",style:{fontSize:12,color:"var(--text-muted)",fontWeight:500,display:"flex",alignItems:"center"},children:"정렬"}),r.jsxs("select",{id:"sort-select",value:d,onChange:D=>u(D.target.value),style:{fontSize:12,padding:"4px 8px",border:"1px solid var(--border)",borderRadius:6,background:"var(--panel)",color:"var(--text)",cursor:"pointer",fontWeight:500},children:[r.jsx("option",{value:"default",children:"기본"}),r.jsx("option",{value:"rate-high",children:"달성률 높은순"}),r.jsx("option",{value:"rate-low",children:"달성률 낮은순"})]})]}),r.jsxs("div",{className:"card",style:{padding:"0 14px",border:"1px solid var(--border)",borderRadius:10,display:"inline-flex",alignItems:"center",gap:12,fontSize:11,background:"var(--panel)",boxShadow:"0 1px 3px rgba(0,0,0,.05)",height:44},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{width:10,height:10,background:I,borderRadius:2}}),r.jsx("span",{style:{fontWeight:500},children:"계획"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{width:10,height:10,background:O,borderRadius:2}}),r.jsx("span",{style:{fontWeight:500},children:"실적"})]})]}),r.jsxs("button",{className:"btn",onClick:()=>h(!0),style:{display:"inline-flex",alignItems:"center",gap:8,padding:"0 16px",height:44,border:"1px solid var(--accent)",borderRadius:10,background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",color:"white",fontSize:13,fontWeight:600,cursor:"pointer",boxShadow:"0 2px 8px rgba(102, 126, 234, 0.3)",transition:"all 0.2s ease"},onMouseEnter:D=>{D.currentTarget.style.transform="translateY(-1px)",D.currentTarget.style.boxShadow="0 4px 12px rgba(102, 126, 234, 0.4)"},onMouseLeave:D=>{D.currentTarget.style.transform="translateY(0)",D.currentTarget.style.boxShadow="0 2px 8px rgba(102, 126, 234, 0.3)"},children:[r.jsx("img",{src:oY,className:"icon",alt:"AI",style:{filter:"brightness(0) invert(1)",width:18,height:18}}),r.jsx("span",{children:"AI Agent(Beta)"})]})]})]}),e?r.jsx("div",{className:"muted",style:{padding:12,textAlign:"center",fontSize:13},children:"직원 목록을 불러오는 중…"}):null,i?r.jsx("div",{className:"error",style:{padding:12,borderRadius:8,background:"rgba(239,68,68,.1)",fontSize:13},children:i}):null,r.jsxs("div",{style:{background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,padding:20,boxShadow:"0 2px 8px rgba(0,0,0,.04)"},children:[r.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"var(--text)",marginBottom:16,paddingBottom:12,borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{style:{width:4,height:18,background:"#3b82f6",borderRadius:2}}),"영업 활동"]}),w.length===0?r.jsx("div",{className:"empty-state",style:{padding:16},children:"조회된 활동 데이터가 없습니다."}):r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 90px repeat(3, minmax(0, 1fr))",gap:"6px 12px",alignItems:"center"},children:[r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"영업사원"}),r.jsx("div",{className:"muted",style:{fontSize:12,textAlign:"center",fontWeight:700},children:"전주 달성률"}),r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"전주"}),r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"이번주"}),r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"차주"}),w.map(D=>{const T=k(D.achievementRate,D.prevTotal>0),P=[{key:"prev",label:"전주",data:D.prevWeek,offset:-1},{key:"this",label:"이번주",data:D.thisWeek,offset:0},{key:"next",label:"차주",data:D.nextWeek,offset:1}];return r.jsxs(Be.Fragment,{children:[r.jsx("div",{style:{padding:"3px 0",fontWeight:600,fontSize:12},children:D.name}),r.jsx("div",{style:{padding:"3px 0",textAlign:"center",fontWeight:700,color:T.color},children:T.display}),P.map(R=>r.jsx("div",{role:"button",tabIndex:0,title:`${R.label} 계획/실적 (클릭하여 상세보기)`,style:{cursor:"pointer",padding:"3px 0"},onClick:()=>E(D,R.offset,R.label),onKeyDown:Y=>{(Y.key==="Enter"||Y.key===" ")&&(Y.preventDefault(),E(D,R.offset,R.label))},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3,pointerEvents:"none"},children:[r.jsx(Yl,{value:R.data.plan,max:v,color:I,label:`${D.name} ${R.label} 계획`}),r.jsx(Yl,{value:R.data.actual,max:v,color:O,label:`${D.name} ${R.label} 실적`})]})},`${D.id}-${R.key}`))]},D.id)})]})]}),r.jsxs("div",{style:{background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,padding:20,boxShadow:"0 2px 8px rgba(0,0,0,.04)"},children:[r.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"var(--text)",marginBottom:16,paddingBottom:12,borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{style:{width:4,height:18,background:"#10b981",borderRadius:2}}),"지역 활동 계획"]}),b?r.jsx("div",{className:"muted",style:{padding:12,textAlign:"center",fontSize:13},children:"지역 활동 계획을 불러오는 중…"}):y?r.jsx("div",{className:"error",style:{padding:12,borderRadius:8,background:"rgba(239,68,68,.1)",fontSize:13},children:y}):_.length===0?r.jsx("div",{className:"muted",style:{padding:12,textAlign:"center",fontSize:13},children:"지역 활동 계획 데이터가 없습니다."}):r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 90px repeat(3, minmax(0, 1fr))",gap:"6px 12px",alignItems:"center"},children:[r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"영업사원"}),r.jsx("div",{className:"muted",style:{fontSize:12,textAlign:"center",fontWeight:700},children:"전주 달성률"}),r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"전주"}),r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"이번주"}),r.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"차주"}),_.map(D=>{const T=k(D.achievementRate,D.prevTotal>0),P=[{key:"prev",label:"전주",data:D.prevWeek,offset:-1},{key:"this",label:"이번주",data:D.thisWeek,offset:0},{key:"next",label:"차주",data:D.nextWeek,offset:1}];return r.jsxs(Be.Fragment,{children:[r.jsx("div",{style:{padding:"3px 0",fontWeight:600,fontSize:12},children:D.name}),r.jsx("div",{style:{padding:"3px 0",textAlign:"center",fontWeight:700,color:T.color},children:T.display}),P.map(R=>r.jsx("div",{role:"button",tabIndex:0,title:`${R.label} 계획/실적 (클릭하여 상세보기)`,style:{cursor:"pointer",padding:"3px 0"},onClick:()=>E(D,R.offset,R.label,!0),onKeyDown:Y=>{(Y.key==="Enter"||Y.key===" ")&&(Y.preventDefault(),E(D,R.offset,R.label,!0))},children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3,pointerEvents:"none"},children:[r.jsx(Yl,{value:R.data.plan,max:A,color:I,label:`${D.name} ${R.label} 계획`}),r.jsx(Yl,{value:R.data.actual,max:A,color:O,label:`${D.name} ${R.label} 실적`})]})},`${D.id}-${R.key}`))]},D.id)})]})]}),r.jsx(lY,{isOpen:f,onClose:()=>h(!1)})]})}async function Kl(e){const n=await fetch(`/api/v1/sales-activities/summary/weekly?offsetWeeks=${encodeURIComponent(e)}&depts=all`);if(!n.ok)throw new Error(`SUM HTTP ${n.status}`);const i=await n.json();return Array.isArray(i)?i:[]}async function Nv(e){const n=await fetch(`/api/v1/region-activity-plans/summary/weekly?offsetWeeks=${encodeURIComponent(e)}&depts=all`);if(!n.ok)throw new Error(`REGION HTTP ${n.status}`);const i=await n.json();return Array.isArray(i)?i:[]}function _v(e){const n=new Map;for(const i of e){const s=String(i.assignee_id??i.emp_id??"");if(!s)continue;const a=i.thisWeek||{},o=i.nextWeek||{};n.set(s,{thisPlan:Number(a.plan??0),thisActual:Number(a.actual??0),nextPlan:Number(o.plan??0),nextActual:Number(o.actual??0)})}return n}function yf(e){const n=new Map;for(const i of e){const s=String(i.assignee_id??i.emp_id??"");if(!s)continue;const a=i.thisWeek||{};n.set(s,{plan:Number(a.plan??0),actual:Number(a.actual??0)})}return n}const dY=({isOpen:e,onClose:n,onSelect:i})=>{const[s,a]=p.useState(""),[o,l]=p.useState(""),[c,d]=p.useState([]),[u,f]=p.useState(!1),[h,m]=p.useState([]);if(Be.useEffect(()=>{e&&(a(""),l(""),d([]),fetch("/api/v1/inventory/subcategories-ag").then(b=>b.ok?b.json():[]).then(b=>m(b)).catch(b=>console.error("Failed to fetch subcategories",b)))},[e]),!e)return null;const g=async()=>{f(!0);try{const b=new URLSearchParams;s&&b.append("keyword",s),o&&b.append("subcategory",o);const j=await fetch(`/api/v1/inventory/items-popup?${b.toString()}`);if(j.ok){const y=await j.json();d(y)}}catch(b){console.error("Failed to search items",b)}finally{f(!1)}};return r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:50,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:8,boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",width:700,maxHeight:"80vh",display:"flex",flexDirection:"column",overflow:"hidden"},children:[r.jsxs("div",{style:{padding:"16px 24px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h2",{style:{fontSize:18,fontWeight:600,color:"#111827",margin:0},children:"품목 검색"}),r.jsx("button",{onClick:n,style:{background:"none",border:"none",cursor:"pointer",color:"#6b7280",padding:4},children:r.jsx(On,{size:20})})]}),r.jsxs("div",{style:{padding:16,borderBottom:"1px solid #e5e7eb",background:"#f9fafb",display:"flex",gap:8},children:[r.jsxs("select",{style:{border:"1px solid #d1d5db",borderRadius:6,padding:"8px 12px",fontSize:14,flex:1,outline:"none",background:"#fff"},value:o,onChange:b=>l(b.target.value),children:[r.jsx("option",{value:"",children:"전체 중분류"}),h.map(b=>r.jsx("option",{value:b,children:b},b))]}),r.jsx("input",{style:{border:"1px solid #d1d5db",borderRadius:6,padding:"8px 12px",fontSize:14,flex:1,outline:"none"},placeholder:"품목명/품목코드",value:s,onChange:b=>a(b.target.value),onKeyDown:b=>b.key==="Enter"&&g()}),r.jsxs("button",{onClick:g,style:{background:"#2563eb",color:"#fff",padding:"8px 16px",borderRadius:6,fontSize:14,fontWeight:500,border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:6},children:[r.jsx(Fn,{size:16}),"검색"]})]}),r.jsx("div",{style:{flex:1,overflow:"auto"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f9fafb",position:"sticky",top:0,zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",fontWeight:600,borderBottom:"1px solid #e5e7eb"},children:"중분류"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",fontWeight:600,borderBottom:"1px solid #e5e7eb"},children:"품목코드"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",fontWeight:600,borderBottom:"1px solid #e5e7eb"},children:"품목명"})]})}),r.jsx("tbody",{children:u?r.jsx("tr",{children:r.jsx("td",{colSpan:3,style:{padding:"32px",textAlign:"center",color:"#6b7280",fontSize:14},children:"검색 중..."})}):c.length===0?r.jsx("tr",{children:r.jsx("td",{colSpan:3,style:{padding:"32px",textAlign:"center",color:"#6b7280",fontSize:14},children:"검색 결과가 없습니다."})}):c.map((b,j)=>r.jsxs("tr",{onClick:()=>{i(b.itemName),n()},style:{cursor:"pointer",borderBottom:"1px solid #f3f4f6"},onMouseEnter:y=>y.currentTarget.style.background="#f9fafb",onMouseLeave:y=>y.currentTarget.style.background="transparent",children:[r.jsx("td",{style:{padding:"12px 16px",fontSize:14,color:"#6b7280"},children:b.itemSubcategory}),r.jsx("td",{style:{padding:"12px 16px",fontSize:14,color:"#6b7280"},children:b.itemNo}),r.jsx("td",{style:{padding:"12px 16px",fontSize:14,color:"#111827",fontWeight:500},children:b.itemName})]},j))})]})})]})})};function uY(){const[e,n]=p.useState([]),[i,s]=p.useState(!1),[a,o]=p.useState(null),[l,c]=p.useState("all"),[d,u]=p.useState("item"),[f,h]=p.useState(""),[m,g]=p.useState(""),[b,j]=p.useState(""),[y,x]=p.useState("ALL"),[v,A]=p.useState(""),[N,C]=p.useState(0),[w,_]=p.useState([]),[I,O]=p.useState(!1),E=async()=>{s(!0),o(null);try{const W=new URLSearchParams;f&&W.append("whName",f),m&&W.append("itemName",m),b&&W.append("category",b),v&&W.append("remainDayMax",v),N>0&&W.append("daysOffset",N.toString()),y!=="ALL"&&W.append("bizUnit",y);const U=await fetch(`/api/v1/inventory/expiry-stock-ag?${W.toString()}`);if(!U.ok)throw new Error(`API 호출 실패: ${U.status}`);const Z=await U.json();Array.isArray(Z)?n(Z):Z.error?(o(Z.error),n([])):n([])}catch(W){console.error("유통기한재고(AG) 조회 실패:",W),o(W.message||"데이터 조회 중 오류가 발생했습니다.")}finally{s(!1)}},S=async()=>{try{console.log("Fetching warehouse options...");const W=await fetch("/api/v1/inventory/warehouses-ag");if(console.log("Warehouse response status:",W.status),W.ok){const U=await W.json();console.log("Warehouse data:",U),_(U)}else console.error("Warehouse fetch failed:",W.statusText)}catch(W){console.error("Failed to fetch warehouse options",W)}};p.useEffect(()=>{S()},[]),p.useEffect(()=>{E()},[]);const[k,D]=p.useState(new Set),[T,P]=p.useState(new Set),R=W=>{const U=new Set(k);U.has(W)?U.delete(W):U.add(W),D(U)},Y=W=>{const U=new Set(T);U.has(W)?U.delete(W):U.add(W),P(U)},[X,H]=p.useState(new Set);p.useEffect(()=>{try{window.dispatchEvent(new CustomEvent("tnt.inventory.expiry.selection",{detail:{count:X.size,items:Array.from(X)}}))}catch{}},[X]),p.useEffect(()=>{const W=U=>{var K;const Z=(K=U.detail)==null?void 0:K.promotionId;if(!Z)return;const ee=Array.from(X);if(ee.length===0){alert("적용할 품목을 선택하세요.");return}alert(`프로모션 ${Z}을(를) ${ee.length}개 품목에 적용합니다.`)};return window.addEventListener("tnt.inventory.apply-promotion",W),()=>window.removeEventListener("tnt.inventory.apply-promotion",W)},[X]);const q=p.useMemo(()=>e.map(W=>{const U=W.remainDay||0;let Z="good",ee="Normal",K=100;return U<=0?(Z="expired",ee="즉시 폐기",K=0):U<=60?(Z="critical",ee="긴급 처분 (Clearance)",K=20):U<=120?(Z="warning",ee="집중 모니터링",K=50):ee="정상 판매",{...W,_status:Z,_action:ee,_score:K}}),[e]),M=p.useMemo(()=>q.filter(W=>l==="disposal"?W._status==="expired":l==="clearance"?W._status==="critical":l==="watch"?W._status==="warning":!0),[q,l]),L=p.useMemo(()=>{const W={};return M.forEach(U=>{const Z=U.itemName||"Unknown";W[Z]||(W[Z]=[]),W[Z].push(U)}),Object.keys(W).forEach(U=>{W[U].sort((Z,ee)=>{const K=Z.expDate||"",ne=ee.expDate||"";return K.localeCompare(ne)})}),W},[M]),B=p.useMemo(()=>{const W={};return q.forEach(U=>{const Z=U.itemSubcategory||"미분류";W[Z]||(W[Z]={name:Z,totalQty:0,expiredQty:0,criticalQty:0,warningQty:0,itemCount:0,totalScore:0,items:[]}),W[Z].totalQty+=U.stockQty||0,W[Z].itemCount+=1,W[Z].totalScore+=U._score,W[Z].items.push(U),U._status==="expired"&&(W[Z].expiredQty+=U.stockQty||0),U._status==="critical"&&(W[Z].criticalQty+=U.stockQty||0),U._status==="warning"&&(W[Z].warningQty+=U.stockQty||0)}),Object.values(W).map(U=>({...U,avgScore:U.itemCount>0?Math.round(U.totalScore/U.itemCount):0,riskRatio:U.totalQty>0?Math.round((U.expiredQty+U.criticalQty)/U.totalQty*100):0,items:U.items.sort((Z,ee)=>(Z.itemName||"").localeCompare(ee.itemName||""))})).sort((U,Z)=>Z.riskRatio-U.riskRatio)},[q]),F=p.useMemo(()=>{const W=q.reduce((K,ne)=>K+(ne.stockQty||0),0),U=q.filter(K=>K._status==="expired").reduce((K,ne)=>K+(ne.stockQty||0),0),Z=q.filter(K=>K._status==="critical").reduce((K,ne)=>K+(ne.stockQty||0),0),ee=q.filter(K=>K._status==="warning").reduce((K,ne)=>K+(ne.stockQty||0),0);return{totalQty:W,expiredQty:U,criticalQty:Z,warningQty:ee}},[q]),te=W=>W?Number(W).toLocaleString("ko-KR"):"-",$=W=>{if(!W)return"-";const U=String(W);return U.length===8?`${U.substring(0,4)}-${U.substring(4,6)}-${U.substring(6,8)}`:U};return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{marginBottom:24,display:"flex",alignItems:"baseline",gap:12},children:[r.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"재고 건전성 분석"}),r.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"유통기한 기반 재고 리스크 분석 및 처분 제안"})]}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",marginBottom:20},children:[r.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex",marginRight:12},children:["ALL","TNT","DYS"].map(W=>r.jsx("button",{onClick:()=>x(W),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:y===W?"#fff":"transparent",color:y===W?"#2563eb":"#6b7280",boxShadow:y===W?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:W},W))}),r.jsxs("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex",marginRight:12},children:[r.jsxs("button",{onClick:()=>u("item"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:d==="item"?"#fff":"transparent",color:d==="item"?"#111827":"#6b7280",boxShadow:d==="item"?"0 1px 2px rgba(0,0,0,0.1)":"none",display:"flex",alignItems:"center",gap:6,whiteSpace:"nowrap"},children:[r.jsx(qN,{size:16}),"품목별 보기"]}),r.jsxs("button",{onClick:()=>u("category"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:d==="category"?"#fff":"transparent",color:d==="category"?"#111827":"#6b7280",boxShadow:d==="category"?"0 1px 2px rgba(0,0,0,0.1)":"none",display:"flex",alignItems:"center",gap:6,whiteSpace:"nowrap"},children:[r.jsx(mN,{size:16}),"중분류 분석"]})]}),r.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[r.jsx("input",{className:"search-input",placeholder:"품목명 검색 (클릭)",value:m,readOnly:!0,onClick:()=>O(!0),style:{width:180,paddingLeft:12,paddingRight:32,cursor:"pointer"}}),r.jsx(Fn,{size:14,style:{position:"absolute",right:10,color:"#9ca3af",pointerEvents:"none"}})]}),r.jsx("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:r.jsxs("select",{className:"search-input",value:f,onChange:W=>h(W.target.value),style:{width:150},children:[r.jsx("option",{value:"",children:"전체 창고"}),w.map(W=>r.jsx("option",{value:W,children:W},W))]})}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,paddingLeft:12,borderLeft:"1px solid #e5e7eb"},children:[r.jsxs("select",{className:"search-input",value:N,onChange:W=>C(Number(W.target.value)),style:{width:130,color:N>0?"#ef4444":"inherit",fontWeight:N>0?600:400},children:[r.jsx("option",{value:0,children:"현재 기준"}),r.jsx("option",{value:7,children:"1주 후 예측"}),r.jsx("option",{value:14,children:"2주 후 예측"}),r.jsx("option",{value:21,children:"3주 후 예측"}),r.jsx("option",{value:28,children:"4주 후 예측"}),r.jsx("option",{value:60,children:"2개월 후 예측"}),r.jsx("option",{value:90,children:"3개월 후 예측"}),r.jsx("option",{value:180,children:"6개월 후 예측"})]}),r.jsx("input",{className:"search-input",type:"number",placeholder:"잔여일수(이하)",value:v,onChange:W=>A(W.target.value),style:{width:110}})]}),r.jsxs("div",{style:{display:"flex",gap:8,marginLeft:"auto"},children:[r.jsx("button",{className:"btn",onClick:E,disabled:i,style:{height:30,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",whiteSpace:"nowrap"},children:i?"분석 중...":"분석 실행"}),r.jsx("button",{className:"btn secondary",onClick:()=>{g(""),h(""),A(""),C(0),x("ALL"),E()},style:{height:30,padding:"0 12px",fontSize:13,whiteSpace:"nowrap"},children:"초기화"})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[r.jsx(Gl,{title:"전체 재고",value:te(F.totalQty),icon:r.jsx(_s,{size:24}),color:"#3b82f6"}),r.jsx(Gl,{title:"폐기 대상 (만료)",value:te(F.expiredQty),subtext:"즉시 조치 필요",icon:r.jsx(Ti,{size:24}),color:"#ef4444",active:l==="disposal"&&d==="item",onClick:()=>{c("disposal"),u("item")}}),r.jsx(Gl,{title:"긴급 처분 (<60일)",value:te(F.criticalQty),subtext:"프로모션 권장",icon:r.jsx($N,{size:24}),color:"#f97316",active:l==="clearance"&&d==="item",onClick:()=>{c("clearance"),u("item")}}),r.jsx(Gl,{title:"관심 품목 (<120일)",value:te(F.warningQty),subtext:"모니터링 필요",icon:r.jsx(Sf,{size:24}),color:"#eab308",active:l==="watch"&&d==="item",onClick:()=>{c("watch"),u("item")}})]})]}),d==="item"&&r.jsx("div",{style:{padding:"0 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:r.jsxs("div",{style:{display:"flex",gap:24},children:[r.jsx(Vl,{label:"전체 목록",active:l==="all",onClick:()=>c("all")}),r.jsx(Vl,{label:"폐기 대상",count:F.expiredQty,active:l==="disposal",onClick:()=>c("disposal"),color:"#ef4444"}),r.jsx(Vl,{label:"긴급 처분",count:F.criticalQty,active:l==="clearance",onClick:()=>c("clearance"),color:"#f97316"}),r.jsx(Vl,{label:"관심 품목",count:F.warningQty,active:l==="watch",onClick:()=>c("watch"),color:"#eab308"})]})}),r.jsx("div",{style:{flex:1,padding:24,overflow:"hidden",display:"flex",gap:24},children:r.jsx("div",{className:"card",style:{flex:1,height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:a?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:a}):e.length===0&&!i?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"데이터가 없습니다."}):r.jsx("div",{style:{overflow:"auto",flex:1},children:d==="item"?r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"품목명 / 코드"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"중분류"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"전체 재고"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"LOT 수"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"최단 유통기한"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"위험 상태"}),r.jsx("th",{style:{width:40}})]})}),r.jsx("tbody",{children:Object.entries(L).map(([W,U])=>{const Z=U.reduce((pe,G)=>pe+(G.stockQty||0),0),ee=U.some(pe=>pe._status==="expired")?"expired":U.some(pe=>pe._status==="critical")?"critical":U.some(pe=>pe._status==="warning")?"warning":"safe",K=U[0],ne=T.has(W);return r.jsxs(Be.Fragment,{children:[r.jsxs("tr",{style:{borderBottom:"1px solid #e5e7eb",background:ne?"#f9fafb":"#fff",cursor:"pointer"},onClick:()=>Y(W),children:[r.jsxs("td",{style:{padding:"12px 16px"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[K.srcBizunit==="TNT"&&r.jsx("span",{style:{background:"#e0f2fe",color:"#0369a1",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"T"}),K.srcBizunit==="DYS"&&r.jsx("span",{style:{background:"#fce7f3",color:"#be185d",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"D"}),r.jsx("div",{style:{fontWeight:600,color:"#111827"},children:W})]}),r.jsxs("div",{style:{fontSize:11,color:"#9ca3af",marginTop:2},children:[K.itemNo," | ",K.spec]})]}),r.jsx("td",{style:{padding:"12px 16px",color:"#4b5563",fontSize:12},children:K.itemSubcategory}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600},children:te(Z)}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:"#6b7280"},children:U.length}),r.jsx("td",{style:{padding:"12px 16px",color:"#4b5563"},children:$(K.expDate)}),r.jsx("td",{style:{padding:"12px 16px"},children:r.jsx(Cv,{status:ee})}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"center"},children:ne?r.jsx(ko,{size:16}):r.jsx(Ii,{size:16})})]}),ne&&r.jsx("tr",{children:r.jsx("td",{colSpan:7,style:{padding:0,background:"#f9fafb"},children:r.jsx("div",{style:{padding:"12px 24px",borderBottom:"1px solid #e5e7eb"},children:r.jsxs("table",{style:{width:"100%",fontSize:13},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"LOT No."}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"창고명"}),r.jsx("th",{style:{textAlign:"right",padding:"8px 12px",color:"#6b7280"},children:"재고"}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"유통기한"}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"잔여일수"}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"상태"}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"건전성"})]})}),r.jsx("tbody",{children:U.map((pe,G)=>r.jsxs("tr",{style:{borderTop:"1px solid #e5e7eb"},children:[r.jsx("td",{style:{padding:"8px 12px",color:"#6b7280",fontFamily:"monospace"},children:pe.lotNo||"-"}),r.jsx("td",{style:{padding:"8px 12px",color:"#6b7280"},children:pe.whName||"-"}),r.jsx("td",{style:{padding:"8px 12px",textAlign:"right",fontWeight:600},children:te(pe.stockQty)}),r.jsx("td",{style:{padding:"8px 12px",color:"#4b5563"},children:$(pe.expDate)}),r.jsx("td",{style:{padding:"8px 12px"},children:r.jsxs("span",{style:{fontWeight:600,color:pe.remainDay&&pe.remainDay<=60?"#ef4444":"#111827"},children:[pe.remainDay,"일"]})}),r.jsx("td",{style:{padding:"8px 12px"},children:r.jsx(Cv,{status:pe._status})}),r.jsx("td",{style:{padding:"8px 12px"},children:r.jsx(Av,{score:pe._score})})]},G))})]})})})})]},W)})})]}):r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"순위"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"중분류명"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"전체 재고"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"폐기 대상"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"긴급 처분"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"관심 품목"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"리스크 비율"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"평균 건전성"}),r.jsx("th",{style:{width:40}})]})}),r.jsx("tbody",{children:B.map((W,U)=>r.jsxs(Be.Fragment,{children:[r.jsxs("tr",{onClick:()=>R(W.name),style:{borderBottom:"1px solid #f3f4f6",cursor:"pointer",background:k.has(W.name)?"#f9fafb":"#fff"},children:[r.jsx("td",{style:{padding:"12px 16px",color:"#9ca3af",fontWeight:500},children:U+1}),r.jsx("td",{style:{padding:"12px 16px",fontWeight:600,color:"#111827"},children:W.name}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600},children:te(W.totalQty)}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:W.expiredQty>0?"#ef4444":"#d1d5db",fontWeight:W.expiredQty>0?700:400},children:te(W.expiredQty)}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:W.criticalQty>0?"#f97316":"#d1d5db",fontWeight:W.criticalQty>0?700:400},children:te(W.criticalQty)}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:W.warningQty>0?"#eab308":"#d1d5db",fontWeight:W.warningQty>0?700:400},children:te(W.warningQty)}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right"},children:r.jsxs("span",{style:{color:W.riskRatio>50?"#ef4444":W.riskRatio>20?"#f97316":"#10b981",fontWeight:700},children:[W.riskRatio,"%"]})}),r.jsx("td",{style:{padding:"12px 16px"},children:r.jsx(Av,{score:W.avgScore})}),r.jsx("td",{style:{padding:"12px 16px",color:"#9ca3af"},children:k.has(W.name)?r.jsx(ko,{size:16}):r.jsx(Ii,{size:16})})]}),k.has(W.name)&&r.jsx("tr",{children:r.jsx("td",{colSpan:9,style:{padding:0,background:"#f9fafb"},children:r.jsx("div",{style:{padding:"12px 24px",borderBottom:"1px solid #e5e7eb"},children:r.jsxs("table",{style:{width:"100%",fontSize:13},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"품목명"}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"LOT No."}),r.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"창고명"}),r.jsx("th",{style:{textAlign:"right",padding:"8px 12px",color:"#6b7280"},children:"재고"}),r.jsx("th",{style:{textAlign:"center",padding:"8px 12px",color:"#6b7280"},children:"폐기대상"}),r.jsx("th",{style:{textAlign:"center",padding:"8px 12px",color:"#6b7280"},children:"긴급처분"}),r.jsx("th",{style:{textAlign:"center",padding:"8px 12px",color:"#6b7280"},children:"관심품목"}),r.jsx("th",{style:{textAlign:"center",padding:"8px 12px",color:"#6b7280"},children:"정상재고"})]})}),r.jsx("tbody",{children:W.items.map((Z,ee)=>r.jsxs("tr",{style:{borderTop:"1px solid #e5e7eb"},children:[r.jsx("td",{style:{padding:"8px 12px",color:"#111827",fontWeight:500},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[Z.srcBizunit==="TNT"&&r.jsx("span",{style:{background:"#e0f2fe",color:"#0369a1",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"T"}),Z.srcBizunit==="DYS"&&r.jsx("span",{style:{background:"#fce7f3",color:"#be185d",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"D"}),Z.itemName]})}),r.jsx("td",{style:{padding:"8px 12px",color:"#6b7280",fontFamily:"monospace"},children:Z.lotNo||"-"}),r.jsx("td",{style:{padding:"8px 12px",color:"#6b7280"},children:Z.whName||"-"}),r.jsx("td",{style:{padding:"8px 12px",textAlign:"right",fontWeight:600},children:te(Z.stockQty)}),r.jsx("td",{style:{padding:"8px 12px",textAlign:"center"},children:Z._status==="expired"?r.jsx("span",{style:{color:"#dc2626",fontWeight:600},children:"●"}):r.jsx("span",{style:{color:"#d1d5db"},children:"○"})}),r.jsx("td",{style:{padding:"8px 12px",textAlign:"center"},children:Z._status==="critical"?r.jsx("span",{style:{color:"#ea580c",fontWeight:600},children:"●"}):r.jsx("span",{style:{color:"#d1d5db"},children:"○"})}),r.jsx("td",{style:{padding:"8px 12px",textAlign:"center"},children:Z._status==="warning"?r.jsx("span",{style:{color:"#eab308",fontWeight:600},children:"●"}):r.jsx("span",{style:{color:"#d1d5db"},children:"○"})}),r.jsx("td",{style:{padding:"8px 12px",textAlign:"center"},children:Z._status==="safe"||Z._status==="normal"||!Z._status||Z._status!=="expired"&&Z._status!=="critical"&&Z._status!=="warning"?r.jsx("span",{style:{color:"#10b981",fontWeight:600},children:"●"}):r.jsx("span",{style:{color:"#d1d5db"},children:"○"})})]},ee))})]})})})})]},W.name))})]})})})}),r.jsx(dY,{isOpen:I,onClose:()=>O(!1),onSelect:W=>{g(W)}})]})}function Gl({title:e,value:n,subtext:i,icon:s,color:a,active:o,onClick:l}){return r.jsxs("div",{onClick:l,style:{background:o?`${a}10`:"#fff",border:`1px solid ${o?a:"#e5e7eb"}`,borderRadius:12,padding:20,cursor:l?"pointer":"default",transition:"all 0.2s",boxShadow:o?`0 4px 12px ${a}20`:"none"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:8},children:[r.jsx("span",{style:{fontSize:14,color:"#6b7280",fontWeight:500},children:e}),r.jsx("span",{style:{color:a},children:s})]}),r.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:n}),i&&r.jsx("div",{style:{fontSize:12,color:a,marginTop:4,fontWeight:500},children:i})]})}function Vl({label:e,count:n,active:i,onClick:s,color:a="#3b82f6"}){return r.jsxs("button",{onClick:s,style:{padding:"16px 0",background:"none",border:"none",borderBottom:`2px solid ${i?a:"transparent"}`,color:i?a:"#6b7280",fontWeight:i?600:500,cursor:"pointer",fontSize:14,display:"flex",alignItems:"center",gap:6},children:[e,n!==void 0&&r.jsx("span",{style:{background:i?a:"#f3f4f6",color:i?"#fff":"#6b7280",padding:"2px 8px",borderRadius:99,fontSize:11,fontWeight:600},children:n>999?"999+":n})]})}function Cv({status:e}){const n={expired:{bg:"#fef2f2",text:"#ef4444",label:"만료"},critical:{bg:"#fff7ed",text:"#f97316",label:"위험"},warning:{bg:"#fefce8",text:"#eab308",label:"주의"},good:{bg:"#ecfdf5",text:"#10b981",label:"정상"}},i=n[e]||n.good;return r.jsx("span",{style:{background:i.bg,color:i.text,padding:"4px 8px",borderRadius:6,fontSize:11,fontWeight:600,border:`1px solid ${i.text}20`},children:i.label})}function Av({score:e}){let n="#10b981";return e<=20?n="#ef4444":e<=50&&(n="#eab308"),r.jsx("div",{style:{width:80,height:6,background:"#e5e7eb",borderRadius:3,overflow:"hidden"},children:r.jsx("div",{style:{width:`${e}%`,height:"100%",background:n,borderRadius:3}})})}const Xl=[{id:"select",step:1,title:"대상 선정",subtitle:"Target Selection",icon:eN,color:"#3b82f6",bgColor:"#eff6ff",borderColor:"#93c5fd",description:"유통기한 임박 재고에서 프로모션 대상 품목을 선정합니다"},{id:"price",step:2,title:"가격 설정",subtitle:"Price Configuration",icon:Ni,color:"#8b5cf6",bgColor:"#f5f3ff",borderColor:"#c4b5fd",description:"대상 품목의 프로모션 가격과 할인율을 설정합니다"},{id:"simulate",step:3,title:"시뮬레이션",subtitle:"Sales Simulation",icon:oa,color:"#10b981",bgColor:"#ecfdf5",borderColor:"#6ee7b7",description:"예상 매출과 손익을 분석하고 프로모션을 확정합니다"}];function fY(){const[e,n]=p.useState("TNT"),[i,s]=p.useState(60),[a,o]=p.useState(""),[l,c]=p.useState(""),[d,u]=p.useState([]),[f,h]=p.useState([]),[m,g]=p.useState([]),[b,j]=p.useState(""),[y,x]=p.useState(""),[v,A]=p.useState(""),[N,C]=p.useState(""),[w,_]=p.useState(null),[I,O]=p.useState(""),[E,S]=p.useState("DRAFT"),[k,D]=p.useState(!1),[T,P]=p.useState(30),[R,Y]=p.useState(!0),[X,H]=p.useState("select");p.useEffect(()=>{q(),M()},[e]);const q=async()=>{try{const re=await(await fetch(`/api/v1/promotion/warehouses?companyType=${e}`)).json();re.success&&u(re.warehouses||[])}catch(J){console.error("창고 목록 조회 실패:",J)}},M=async()=>{try{const re=await(await fetch(`/api/v1/promotion/sales-mgmt-units?companyType=${e}`)).json();re.success&&h(re.units||[])}catch(J){console.error("영업관리단위 목록 조회 실패:",J)}},L=async()=>{D(!0);try{const J=new URLSearchParams({companyType:e,remainDays:i.toString()});a&&J.append("whSeq",a),l&&J.append("salesMgmtUnit",l);const de=await(await fetch(`/api/v1/promotion/expiry-stocks?${J}`)).json();if(de.success){const he=(de.stocks||[]).map(oe=>({...oe,selected:!0,promoPrice:null,discountRate:null,originalAmt:oe.stockQty*(oe.unitPrice||0),promoAmt:0}));g(he),Y(!0)}}catch(J){console.error("대상 품목 검색 실패:",J)}finally{D(!1)}},B=()=>{s(60),o(""),c("")},F=J=>{Y(J),g(m.map(re=>({...re,selected:J})))},te=(J,re)=>{const de=[...m];de[J]={...de[J],selected:re},g(de)},$=()=>{g(m.map(J=>{const re=J.unitPrice*(1-T/100);return{...J,discountRate:T,promoPrice:re,promoAmt:J.stockQty*re}}))},W=(J,re)=>{const de=[...m],he=de[J],oe=he.unitPrice>0?(he.unitPrice-re)/he.unitPrice*100:0;de[J]={...he,promoPrice:re,discountRate:oe,promoAmt:he.stockQty*re},g(de)},U=()=>{const J=m.filter(re=>re.selected);return{totalStockQty:J.reduce((re,de)=>re+de.stockQty,0),totalOriginalAmt:J.reduce((re,de)=>re+de.originalAmt,0),totalPromoAmt:J.reduce((re,de)=>re+de.promoAmt,0),expectedLoss:J.reduce((re,de)=>re+de.promoAmt,0)-J.reduce((re,de)=>re+de.originalAmt,0),selectedCount:J.length}},Z=async()=>{if(!b){alert("프로모션명을 입력해주세요.");return}D(!0);try{const J=U(),re={id:w,promoCode:I,promoName:b,companyType:e,discountRate:T,startDate:v,endDate:N,status:"DRAFT",description:y,items:m,totalStockQty:J.totalStockQty,totalOriginalAmt:J.totalOriginalAmt,totalPromoAmt:J.totalPromoAmt,expectedLoss:J.expectedLoss,searchRemainDays:i,searchWhSeq:a?parseInt(a):null,searchSalesMgmtUnit:l||null},he=await(await fetch("/api/v1/promotion/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(re)})).json();he.success?(alert("프로모션이 저장되었습니다."),_(he.promotionId),O(he.promoCode)):alert("저장 실패: "+he.error)}catch(J){console.error("저장 실패:",J),alert("저장 중 오류가 발생했습니다.")}finally{D(!1)}},ee=async()=>{if(!b){alert("프로모션명을 입력해주세요.");return}if(!v||!N){alert("프로모션 기간을 설정해주세요.");return}if(confirm("프로모션을 확정하시겠습니까?")){D(!0);try{const J=U(),re={id:w,promoCode:I,promoName:b,companyType:e,discountRate:T,startDate:v,endDate:N,status:"CONFIRMED",description:y,items:m,totalStockQty:J.totalStockQty,totalOriginalAmt:J.totalOriginalAmt,totalPromoAmt:J.totalPromoAmt,expectedLoss:J.expectedLoss,searchRemainDays:i,searchWhSeq:a?parseInt(a):null,searchSalesMgmtUnit:l||null},he=await(await fetch("/api/v1/promotion/confirm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(re)})).json();he.success?(alert("프로모션이 확정되었습니다."),S("CONFIRMED")):alert("확정 실패: "+he.error)}catch(J){console.error("확정 실패:",J),alert("확정 중 오류가 발생했습니다.")}finally{D(!1)}}},K=U(),ne=J=>J<=30?{background:"#fef2f2",color:"#dc2626",border:"#fecaca"}:J<=60?{background:"#fffbeb",color:"#d97706",border:"#fcd34d"}:{background:"#f3f4f6",color:"#6b7280",border:"#e5e7eb"},pe=Xl.find(J=>J.id===X),G=Xl.findIndex(J=>J.id===X),ae=K.selectedCount>0,ie=K.totalPromoAmt>0;return r.jsxs("div",{style:{padding:24,height:"100%",overflow:"auto",background:"var(--bg)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[r.jsx("div",{children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("div",{style:{width:44,height:44,borderRadius:12,background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(Eg,{size:22,color:"white"})}),r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:22,fontWeight:700,margin:0,color:"var(--text)"},children:"프로모션 기획"}),r.jsx("p",{style:{fontSize:13,color:"var(--text-secondary)",margin:"2px 0 0"},children:"유통기한 임박 재고 기반 프로모션 대상 선정 및 시뮬레이션"})]})]})}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("span",{style:{fontSize:12,color:"var(--text-secondary)",marginRight:4},children:"회사"}),r.jsxs("div",{style:{display:"flex",background:"var(--bg-secondary)",borderRadius:8,padding:4},children:[r.jsx("button",{onClick:()=>n("TNT"),style:{padding:"6px 16px",borderRadius:6,border:"none",cursor:"pointer",fontSize:13,fontWeight:500,background:e==="TNT"?"var(--primary)":"transparent",color:e==="TNT"?"white":"var(--text-secondary)",transition:"all 0.2s"},children:"TNT"}),r.jsx("button",{onClick:()=>n("DYS"),style:{padding:"6px 16px",borderRadius:6,border:"none",cursor:"pointer",fontSize:13,fontWeight:500,background:e==="DYS"?"var(--primary)":"transparent",color:e==="DYS"?"white":"var(--text-secondary)",transition:"all 0.2s"},children:"DYS"})]})]})]}),r.jsx("div",{style:{display:"flex",gap:0,marginBottom:24,background:"var(--bg-secondary)",borderRadius:12,padding:4,border:"1px solid var(--border)"},children:Xl.map((J,re)=>{const de=J.id===X,he=re<G,oe=J.icon;return r.jsxs("div",{style:{flex:1,display:"flex",alignItems:"center"},children:[r.jsxs("button",{onClick:()=>{J.id==="select"?H("select"):J.id==="price"&&ae?H("price"):J.id==="simulate"&&ie&&H("simulate")},disabled:J.id==="price"&&!ae||J.id==="simulate"&&!ie,style:{flex:1,display:"flex",alignItems:"center",gap:12,padding:"12px 16px",border:"none",borderRadius:8,cursor:J.id==="price"&&!ae||J.id==="simulate"&&!ie?"not-allowed":"pointer",background:de?J.bgColor:"transparent",transition:"all 0.2s",opacity:J.id==="price"&&!ae||J.id==="simulate"&&!ie?.5:1},children:[r.jsx("div",{style:{width:36,height:36,borderRadius:10,background:de?J.color:he?"#10b981":"var(--bg)",border:de?"none":`2px solid ${he?"#10b981":"var(--border)"}`,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s"},children:he?r.jsx(dc,{size:18,color:"white"}):r.jsx(oe,{size:18,color:de?"white":"var(--text-secondary)"})}),r.jsxs("div",{style:{textAlign:"left"},children:[r.jsxs("div",{style:{fontSize:13,fontWeight:600,color:de?J.color:he?"#10b981":"var(--text)"},children:["Step ",J.step,": ",J.title]}),r.jsx("div",{style:{fontSize:11,color:"var(--text-secondary)"},children:J.subtitle})]}),J.id==="select"&&m.length>0&&r.jsxs("span",{style:{marginLeft:"auto",fontSize:11,fontWeight:600,background:J.color,color:"white",padding:"2px 8px",borderRadius:10},children:[K.selectedCount,"/",m.length]})]}),re<Xl.length-1&&r.jsx(Ii,{size:20,style:{color:"var(--border)",margin:"0 4px",flexShrink:0}})]},J.id)})}),r.jsxs("div",{style:{background:"var(--bg)",borderRadius:12,border:`2px solid ${pe.borderColor}`,overflow:"hidden"},children:[r.jsxs("div",{style:{padding:"16px 20px",background:pe.bgColor,borderBottom:`1px solid ${pe.borderColor}`,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:pe.color,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(pe.icon,{size:20,color:"white"})}),r.jsxs("div",{children:[r.jsxs("div",{style:{fontSize:16,fontWeight:600,color:pe.color},children:["Step ",pe.step,": ",pe.title]}),r.jsx("div",{style:{fontSize:12,color:"var(--text-secondary)"},children:pe.description})]})]}),X==="select"&&r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsxs("button",{className:"btn btn-secondary",onClick:B,style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx(ln,{size:14}),"초기화"]}),r.jsxs("button",{className:"btn btn-primary",onClick:L,disabled:k,style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx(Fn,{size:14}),k?"검색 중...":"대상 조회"]})]}),X==="price"&&r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx(zv,{size:16,style:{color:"var(--text-secondary)"}}),r.jsx("span",{style:{fontSize:13,color:"var(--text-secondary)"},children:"일괄 할인율"}),r.jsx("select",{className:"input",value:T,onChange:J=>P(parseInt(J.target.value)),style:{width:80},children:[10,20,30,40,50,60,70].map(J=>r.jsxs("option",{value:J,children:[J,"%"]},J))}),r.jsxs("button",{className:"btn btn-primary",onClick:$,style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx(Fv,{size:14}),"전체 적용"]})]})]}),X==="select"&&r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{padding:16,borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:16},children:[r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:500,marginBottom:6,color:"var(--text-secondary)"},children:[r.jsx(qr,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"잔여일수"]}),r.jsxs("select",{className:"input",value:i,onChange:J=>s(parseInt(J.target.value)),style:{width:"100%"},children:[r.jsx("option",{value:30,children:"30일 이하"}),r.jsx("option",{value:60,children:"60일 이하"}),r.jsx("option",{value:90,children:"90일 이하"}),r.jsx("option",{value:120,children:"120일 이하"}),r.jsx("option",{value:180,children:"180일 이하"}),r.jsx("option",{value:99999,children:"전체"})]})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:500,marginBottom:6,color:"var(--text-secondary)"},children:[r.jsx(_s,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"창고"]}),r.jsxs("select",{className:"input",value:a,onChange:J=>o(J.target.value),style:{width:"100%"},children:[r.jsx("option",{value:"",children:"전체"}),d.map(J=>r.jsx("option",{value:J.whSeq,children:J.whName},J.whSeq))]})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:500,marginBottom:6,color:"var(--text-secondary)"},children:[r.jsx(tN,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"영업관리단위"]}),r.jsxs("select",{className:"input",value:l,onChange:J=>c(J.target.value),style:{width:"100%"},children:[r.jsx("option",{value:"",children:"전체"}),f.map(J=>r.jsx("option",{value:J.salesMgmtUnit,children:J.salesMgmtUnit},J.salesMgmtUnit))]})]})]})}),r.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[r.jsxs("span",{style:{fontSize:13},children:["총 ",r.jsx("strong",{style:{color:"var(--text)",fontSize:15},children:m.length}),"건"]}),r.jsx("span",{style:{color:"var(--border)"},children:"|"}),r.jsxs("span",{style:{fontSize:13},children:["선택 ",r.jsx("strong",{style:{color:pe.color,fontSize:15},children:K.selectedCount}),"건"]})]}),r.jsxs("button",{className:"btn btn-primary",onClick:()=>H("price"),disabled:!ae,style:{display:"flex",alignItems:"center",gap:6},children:["다음: 가격 설정",r.jsx(pa,{size:14})]})]}),r.jsx("div",{style:{overflow:"auto",maxHeight:"calc(100vh - 500px)"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"var(--bg-secondary)"},children:[r.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:40},children:r.jsx("input",{type:"checkbox",checked:R,onChange:J=>F(J.target.checked)})}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)"},children:"품목명"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)",width:100},children:"LOT"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)",width:120},children:"창고"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"right",borderBottom:"1px solid var(--border)",width:80},children:"재고"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:100},children:"유통기한"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:80},children:"잔여일수"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"right",borderBottom:"1px solid var(--border)",width:100},children:"단가"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)",width:120},children:"영업관리단위"})]})}),r.jsxs("tbody",{children:[m.map((J,re)=>{var he,oe;const de=ne(J.remainDay);return r.jsxs("tr",{style:{opacity:J.selected?1:.5},onMouseEnter:V=>V.currentTarget.style.background="var(--bg-secondary)",onMouseLeave:V=>V.currentTarget.style.background="transparent",children:[r.jsx("td",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)"},children:r.jsx("input",{type:"checkbox",checked:J.selected,onChange:V=>te(re,V.target.checked)})}),r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)",fontWeight:500},children:J.itemName}),r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)",color:"var(--text-secondary)",fontSize:12},children:J.lotNo}),r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)"},children:J.whName}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"right",borderBottom:"1px solid var(--border)",fontWeight:500},children:(he=J.stockQty)==null?void 0:he.toLocaleString()}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",fontSize:12},children:J.expDate}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)"},children:r.jsxs("span",{style:{padding:"3px 10px",borderRadius:6,fontSize:11,fontWeight:600,background:de.background,color:de.color,border:`1px solid ${de.border}`},children:[J.remainDay,"일"]})}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"right",borderBottom:"1px solid var(--border)"},children:(oe=J.unitPrice)==null?void 0:oe.toLocaleString()}),r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)",fontSize:12},children:J.salesMgmtUnit})]},`${J.id}-${re}`)}),m.length===0&&!k&&r.jsx("tr",{children:r.jsxs("td",{colSpan:9,style:{padding:"60px 12px",textAlign:"center"},children:[r.jsx(_s,{size:48,style:{color:"var(--border)",marginBottom:12}}),r.jsx("div",{style:{color:"var(--text-secondary)",fontSize:14},children:'검색 조건을 설정하고 "대상 조회" 버튼을 클릭하세요.'})]})})]})]})})]}),X==="price"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[r.jsxs("span",{style:{fontSize:13},children:["선택 품목 ",r.jsx("strong",{style:{color:pe.color,fontSize:15},children:K.selectedCount}),"건"]}),r.jsx("span",{style:{color:"var(--border)"},children:"|"}),r.jsx("span",{style:{fontSize:12,color:"var(--text-secondary)"},children:"개별 품목의 프로모션 가격을 직접 수정할 수 있습니다"})]}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsx("button",{className:"btn btn-secondary",onClick:()=>H("select"),style:{display:"flex",alignItems:"center",gap:6},children:"← 이전"}),r.jsxs("button",{className:"btn btn-primary",onClick:()=>H("simulate"),disabled:!ie,style:{display:"flex",alignItems:"center",gap:6},children:["다음: 시뮬레이션",r.jsx(pa,{size:14})]})]})]}),r.jsx("div",{style:{overflow:"auto",maxHeight:"calc(100vh - 450px)"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"var(--bg-secondary)"},children:[r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)"},children:"품목명"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"right",borderBottom:"1px solid var(--border)",width:80},children:"재고"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"right",borderBottom:"1px solid var(--border)",width:100},children:"원가(단가)"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"right",borderBottom:"1px solid var(--border)",width:120},children:"원가금액"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:130},children:"프로모션가"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:80},children:"할인율"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"right",borderBottom:"1px solid var(--border)",width:130},children:"프로모션금액"})]})}),r.jsx("tbody",{children:m.filter(J=>J.selected).map((J,re)=>{var he,oe,V;const de=m.findIndex(Pe=>Pe.id===J.id&&Pe.lotNo===J.lotNo);return r.jsxs("tr",{onMouseEnter:Pe=>Pe.currentTarget.style.background="var(--bg-secondary)",onMouseLeave:Pe=>Pe.currentTarget.style.background="transparent",children:[r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)",fontWeight:500},children:J.itemName}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"right",borderBottom:"1px solid var(--border)"},children:(he=J.stockQty)==null?void 0:he.toLocaleString()}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"right",borderBottom:"1px solid var(--border)"},children:(oe=J.unitPrice)==null?void 0:oe.toLocaleString()}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"right",borderBottom:"1px solid var(--border)",color:"var(--text-secondary)"},children:(V=J.originalAmt)==null?void 0:V.toLocaleString()}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)"},children:r.jsx("input",{type:"number",className:"input",style:{width:100,textAlign:"right"},value:J.promoPrice||"",onChange:Pe=>W(de,parseFloat(Pe.target.value)||0),placeholder:"가격 입력"})}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)"},children:J.discountRate?r.jsxs("span",{style:{padding:"3px 8px",borderRadius:6,fontSize:12,fontWeight:600,background:pe.bgColor,color:pe.color},children:[J.discountRate.toFixed(0),"%"]}):"-"}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"right",borderBottom:"1px solid var(--border)",fontWeight:600,color:pe.color},children:J.promoAmt?J.promoAmt.toLocaleString():"-"})]},`price-${J.id}-${J.lotNo}`)})})]})})]}),X==="simulate"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{padding:20,borderBottom:"1px solid var(--border)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:16},children:[r.jsx(Eg,{size:16,style:{color:pe.color}}),r.jsx("h3",{style:{fontSize:14,fontWeight:600,margin:0},children:"프로모션 정보"})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:500,marginBottom:6,color:"var(--text-secondary)"},children:["프로모션명 ",r.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),r.jsx("input",{type:"text",className:"input",style:{width:"100%"},value:b,onChange:J=>j(J.target.value),placeholder:"예: 12월 유통기한 임박 재고 할인전"})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,fontWeight:500,marginBottom:6,color:"var(--text-secondary)"},children:"설명"}),r.jsx("input",{type:"text",className:"input",style:{width:"100%"},value:y,onChange:J=>x(J.target.value),placeholder:"프로모션 상세 설명"})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:500,marginBottom:6,color:"var(--text-secondary)"},children:[r.jsx(qr,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"시작일 ",r.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),r.jsx("input",{type:"date",className:"input",style:{width:"100%"},value:v,onChange:J=>A(J.target.value)})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:500,marginBottom:6,color:"var(--text-secondary)"},children:[r.jsx(qr,{size:12,style:{marginRight:4,verticalAlign:"middle"}}),"종료일 ",r.jsx("span",{style:{color:"#dc2626"},children:"*"})]}),r.jsx("input",{type:"date",className:"input",style:{width:"100%"},value:N,onChange:J=>C(J.target.value)})]})]})]}),r.jsxs("div",{style:{padding:20,borderBottom:"1px solid var(--border)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:16},children:[r.jsx(oa,{size:16,style:{color:pe.color}}),r.jsx("h3",{style:{fontSize:14,fontWeight:600,margin:0},children:"시뮬레이션 결과"})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[r.jsxs("div",{style:{padding:20,borderRadius:12,background:"#eff6ff",border:"1px solid #93c5fd"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[r.jsx(_s,{size:16,style:{color:"#3b82f6"}}),r.jsx("span",{style:{fontSize:12,color:"#3b82f6",fontWeight:500},children:"선택 품목 / 총 수량"})]}),r.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#1e40af"},children:[K.selectedCount,"개"]}),r.jsxs("div",{style:{fontSize:13,color:"#3b82f6",marginTop:4},children:[K.totalStockQty.toLocaleString()," EA"]})]}),r.jsxs("div",{style:{padding:20,borderRadius:12,background:"#f3f4f6",border:"1px solid #d1d5db"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[r.jsx(Ni,{size:16,style:{color:"#6b7280"}}),r.jsx("span",{style:{fontSize:12,color:"#6b7280",fontWeight:500},children:"원가 기준 총액"})]}),r.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#374151"},children:[(K.totalOriginalAmt/1e4).toFixed(0),"만원"]}),r.jsxs("div",{style:{fontSize:13,color:"#6b7280",marginTop:4},children:[K.totalOriginalAmt.toLocaleString(),"원"]})]}),r.jsxs("div",{style:{padding:20,borderRadius:12,background:"#ecfdf5",border:"1px solid #6ee7b7"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[r.jsx(gN,{size:16,style:{color:"#10b981"}}),r.jsx("span",{style:{fontSize:12,color:"#10b981",fontWeight:500},children:"프로모션 예상 매출"})]}),r.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#047857"},children:[(K.totalPromoAmt/1e4).toFixed(0),"만원"]}),r.jsxs("div",{style:{fontSize:13,color:"#10b981",marginTop:4},children:[K.totalPromoAmt.toLocaleString(),"원"]})]}),r.jsxs("div",{style:{padding:20,borderRadius:12,background:K.expectedLoss<0?"#fef2f2":"#ecfdf5",border:`1px solid ${K.expectedLoss<0?"#fecaca":"#6ee7b7"}`},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[r.jsx(Ti,{size:16,style:{color:K.expectedLoss<0?"#dc2626":"#10b981"}}),r.jsx("span",{style:{fontSize:12,color:K.expectedLoss<0?"#dc2626":"#10b981",fontWeight:500},children:"예상 손익"})]}),r.jsxs("div",{style:{fontSize:24,fontWeight:700,color:K.expectedLoss<0?"#b91c1c":"#047857"},children:[(K.expectedLoss/1e4).toFixed(0),"만원"]}),r.jsxs("div",{style:{fontSize:13,color:K.expectedLoss<0?"#dc2626":"#10b981",marginTop:4},children:[K.expectedLoss.toLocaleString(),"원"]})]})]})]}),r.jsxs("div",{style:{padding:"16px 20px",display:"flex",justifyContent:"space-between",alignItems:"center",background:"var(--bg-secondary)"},children:[r.jsx("button",{className:"btn btn-secondary",onClick:()=>H("price"),style:{display:"flex",alignItems:"center",gap:6},children:"← 이전"}),r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("button",{className:"btn btn-secondary",onClick:Z,disabled:k,style:{display:"flex",alignItems:"center",gap:6},children:[r.jsx(yN,{size:14}),"임시저장"]}),r.jsxs("button",{className:"btn btn-primary",onClick:ee,disabled:k||E==="CONFIRMED",style:{display:"flex",alignItems:"center",gap:6,background:E==="CONFIRMED"?"#10b981":void 0,padding:"10px 24px"},children:[r.jsx(dc,{size:16}),E==="CONFIRMED"?"확정 완료":"프로모션 확정"]})]})]})]})]})]})}function hY(){const[e,n]=p.useState("TNT"),[i,s]=p.useState({from:"",to:""}),[a,o]=p.useState("");return r.jsxs("div",{style:{padding:24,height:"100%",overflow:"auto",background:"#f8fafc"},children:[r.jsx("div",{style:{marginBottom:24},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:8},children:[r.jsx("div",{style:{width:48,height:48,borderRadius:12,background:"linear-gradient(135deg, #8b5cf6 0%, #6366f1 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white"},children:r.jsx(oa,{size:24})}),r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"프로모션 평가"}),r.jsx("p",{style:{fontSize:14,color:"#6b7280",margin:0},children:"완료된 프로모션의 성과를 분석하고 평가합니다"})]})]})}),r.jsx("div",{style:{background:"white",borderRadius:12,padding:20,marginBottom:20,border:"1px solid #e5e7eb"},children:r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"flex-end",flexWrap:"wrap"},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"회사"}),r.jsxs("div",{style:{display:"flex",borderRadius:8,overflow:"hidden",border:"1px solid #e5e7eb"},children:[r.jsx("button",{onClick:()=>n("TNT"),style:{padding:"8px 16px",border:"none",background:e==="TNT"?"#3b82f6":"white",color:e==="TNT"?"white":"#374151",fontWeight:600,cursor:"pointer",fontSize:13},children:"TNT"}),r.jsx("button",{onClick:()=>n("DYS"),style:{padding:"8px 16px",border:"none",borderLeft:"1px solid #e5e7eb",background:e==="DYS"?"#10b981":"white",color:e==="DYS"?"white":"#374151",fontWeight:600,cursor:"pointer",fontSize:13},children:"DYS"})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"기간"}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[r.jsx("input",{type:"date",value:i.from,onChange:l=>s({...i,from:l.target.value}),style:{padding:"8px 12px",border:"1px solid #e5e7eb",borderRadius:6,fontSize:13}}),r.jsx("span",{style:{color:"#9ca3af"},children:"~"}),r.jsx("input",{type:"date",value:i.to,onChange:l=>s({...i,to:l.target.value}),style:{padding:"8px 12px",border:"1px solid #e5e7eb",borderRadius:6,fontSize:13}})]})]}),r.jsxs("div",{style:{flex:1,minWidth:200},children:[r.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"프로모션명"}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx(Fn,{size:16,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}}),r.jsx("input",{type:"text",placeholder:"프로모션명 검색...",value:a,onChange:l=>o(l.target.value),style:{width:"100%",padding:"8px 12px 8px 36px",border:"1px solid #e5e7eb",borderRadius:6,fontSize:13}})]})]}),r.jsx("button",{style:{padding:"8px 20px",background:"#3b82f6",color:"white",border:"none",borderRadius:6,fontWeight:600,cursor:"pointer",fontSize:13},children:"조회"})]})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16,marginBottom:20},children:[r.jsxs("div",{style:{background:"white",borderRadius:12,padding:20,border:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#eff6ff",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(qr,{size:20,color:"#3b82f6"})}),r.jsx("span",{style:{fontSize:13,color:"#6b7280"},children:"완료 프로모션"})]}),r.jsx("div",{style:{fontSize:28,fontWeight:700,color:"#111827"},children:"0건"})]}),r.jsxs("div",{style:{background:"white",borderRadius:12,padding:20,border:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#ecfdf5",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(pd,{size:20,color:"#10b981"})}),r.jsx("span",{style:{fontSize:13,color:"#6b7280"},children:"총 판매금액"})]}),r.jsx("div",{style:{fontSize:28,fontWeight:700,color:"#111827"},children:"0원"})]}),r.jsxs("div",{style:{background:"white",borderRadius:12,padding:20,border:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#fef3c7",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(_s,{size:20,color:"#f59e0b"})}),r.jsx("span",{style:{fontSize:13,color:"#6b7280"},children:"판매 수량"})]}),r.jsx("div",{style:{fontSize:28,fontWeight:700,color:"#111827"},children:"0개"})]}),r.jsxs("div",{style:{background:"white",borderRadius:12,padding:20,border:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#fef2f2",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(oa,{size:20,color:"#ef4444"})}),r.jsx("span",{style:{fontSize:13,color:"#6b7280"},children:"평균 달성률"})]}),r.jsx("div",{style:{fontSize:28,fontWeight:700,color:"#111827"},children:"0%"})]})]}),r.jsxs("div",{style:{background:"white",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden"},children:[r.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{fontSize:16,fontWeight:600,color:"#111827",margin:0},children:"프로모션 평가 목록"}),r.jsxs("button",{style:{padding:"6px 12px",background:"#f3f4f6",color:"#374151",border:"1px solid #e5e7eb",borderRadius:6,fontSize:12,cursor:"pointer",display:"flex",alignItems:"center",gap:6},children:[r.jsx(qh,{size:14}),"Excel 다운로드"]})]}),r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(oa,{size:48,strokeWidth:1}),r.jsxs("p",{style:{marginTop:12,fontSize:14},children:["평가할 프로모션이 없습니다.",r.jsx("br",{}),r.jsx("span",{style:{fontSize:13},children:"프로모션 기획에서 완료된 프로모션을 확인하세요."})]})]})]})]})}function pY(){const[e,n]=p.useState([]),[i,s]=p.useState(!1),[a,o]=p.useState(null),[l,c]=p.useState(null),[d,u]=p.useState(!1),[f,h]=p.useState([]),[m,g]=p.useState(new Map),[b,j]=p.useState(!1);p.useEffect(()=>{let C=!0;return s(!0),o(null),fetch("/api/v1/items/unit-usage").then(async w=>{if(!w.ok)throw new Error(`HTTP ${w.status}`);return w.json()}).then(w=>{if(!C)return;const _=Array.isArray(w)?w.map(I=>({salesMgmtUnitSeq:Number(I.salesMgmtUnitSeq??0),salesMgmtUnit:String(I.salesMgmtUnit??"미지정"),itemStdUnit:String(I.itemStdUnit??"미지정"),itemUnit:String(I.itemUnit??"미지정"),itemCount:Number(I.itemCount??0),missingCount:Number(I.missingCount??0)})):[];n(_)}).catch(w=>{C&&o(w.message||"조회 중 오류가 발생했습니다")}).finally(()=>{C&&s(!1)}),()=>{C=!1}},[]);const y=p.useMemo(()=>{const C={};for(const w of e){const _=w.salesMgmtUnit;C[_]||(C[_]=[]),C[_].push(w)}return Object.values(C).forEach(w=>w.sort((_,I)=>I.itemCount-_.itemCount)),Object.entries(C).sort((w,_)=>{const I=w[0],O=_[0],E=I==="미지정",S=O==="미지정";return E&&!S?1:!E&&S?-1:I.localeCompare(O)})},[e]);async function x(C,w,_){u(!0),o(null);try{const I=new URLSearchParams;I.set("salesMgmtUnit",C),w&&I.set("itemUnit",w),_&&I.set("itemStdUnit",_);const O=await fetch(`/api/v1/items/unit-usage/items?${I.toString()}`);if(!O.ok)throw new Error(`HTTP ${O.status}`);const E=await O.json(),S=Array.isArray(E)?E.map(k=>({itemSeq:k.itemSeq??null,itemName:String(k.itemName??""),itemStdUnit:String(k.itemStdUnit??"미지정"),itemUnit:String(k.itemUnit??"미지정"),salesMgmtUnitSeq:k.salesMgmtUnitSeq??null,newStdUnit:k.newStdUnit??void 0})):[];h(S),g(new Map)}catch(I){o((I==null?void 0:I.message)||"상세 조회 중 오류가 발생했습니다")}finally{u(!1)}}async function v(){if(m.size===0){alert("변경된 항목이 없습니다.");return}j(!0),o(null);try{const C=Array.from(m.entries()).map(([I,O])=>{const E=f.find(S=>S.itemName===I);return{itemName:I,salesUnit:(E==null?void 0:E.itemUnit)??"",stdUnit:(E==null?void 0:E.itemStdUnit)??"",newStdUnit:O}}),w=await fetch("/api/v1/items/unit-modify/upsert",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)});if(!w.ok)throw new Error(`HTTP ${w.status}`);const _=await w.json();if(_.success)alert(`${_.updated}개 항목이 저장되었습니다.`),h(I=>I.map(O=>{const E=m.get(O.itemName);return E!==void 0?{...O,newStdUnit:E}:O})),g(new Map);else throw new Error(_.error||"저장 실패")}catch(C){o((C==null?void 0:C.message)||"저장 중 오류가 발생했습니다")}finally{j(!1)}}function A(C,w){g(_=>{const I=new Map(_);return I.set(C,w),I})}function N(C){const w=m.get(C.itemName);return w!==void 0?w:C.newStdUnit??""}return r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsxs("div",{children:[r.jsx("h2",{style:{margin:0},children:"품목단위분석"}),r.jsx("p",{style:{margin:"4px 0 0",color:"var(--muted)"},children:"item 테이블 기준으로 영업관리단위별 사용 단위(표준단위/판매단위) 분포를 확인합니다."})]}),i?r.jsx("span",{style:{color:"var(--muted)"},children:"불러오는 중…"}):null,a?r.jsx("span",{style:{color:"crimson"},children:a}):null]}),f.length>0&&r.jsx("button",{onClick:v,disabled:b||m.size===0,style:{padding:"8px 16px",background:m.size>0?"#4CAF50":"#ccc",color:"white",border:"none",borderRadius:6,cursor:m.size>0?"pointer":"not-allowed",fontWeight:600},children:b?"저장 중...":`저장 (${m.size})`})]}),y.length===0&&!i?r.jsx("div",{className:"empty-state",children:"데이터가 없습니다."}):r.jsx("div",{className:"card",style:{padding:12,height:"calc(100vh - 200px)",display:"flex",flexDirection:"column"},children:r.jsx("div",{style:{flex:1,minHeight:0,overflow:"auto"},children:r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{textAlign:"right",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"No."}),r.jsx("th",{style:{textAlign:"left",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"영업관리단위"}),r.jsx("th",{style:{textAlign:"left",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"판매단위(item_unit)"}),r.jsx("th",{style:{textAlign:"left",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"표준단위(item_std_unit)"}),r.jsx("th",{style:{textAlign:"right",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"품목수"})]})}),r.jsx("tbody",{children:y.map(([C,w],_)=>r.jsxs(Be.Fragment,{children:[w.map((I,O)=>{const E=`${C}|${I.itemUnit}|${I.itemStdUnit}`,S=`${C}`,k=l===E,D=l===S,T=w.some(R=>R.missingCount>0),P=I.missingCount>0;return r.jsxs("tr",{style:{borderTop:"1px solid var(--border)"},children:[O===0?r.jsxs(r.Fragment,{children:[r.jsx("td",{rowSpan:w.length,style:{padding:"6px 8px",textAlign:"right",color:"var(--muted)",fontVariantNumeric:"tabular-nums"},children:_+1}),r.jsxs("td",{rowSpan:w.length,style:{padding:"6px 8px",fontWeight:600,cursor:"pointer",textDecoration:D?"underline":"none",color:T?"crimson":void 0},onClick:()=>{const R=D?null:S;c(R),R&&x(C)},children:[C,r.jsx("span",{style:{marginLeft:8,fontSize:12,color:T?"crimson":"var(--muted)"},children:D?"닫기":"전체 품목"})]})]}):null,r.jsxs("td",{style:{padding:"6px 8px",cursor:"pointer",textDecoration:k?"underline":"none",color:P?"crimson":void 0},onClick:()=>{const R=k?null:E;c(R),R&&x(C,I.itemUnit,I.itemStdUnit)},children:[I.itemUnit,r.jsx("span",{style:{marginLeft:8,fontSize:12,color:P?"crimson":"var(--muted)"},children:k?"닫기":"품목 보기"})]}),r.jsxs("td",{style:{padding:"6px 8px",cursor:"pointer",textDecoration:k?"underline":"none",color:P?"crimson":void 0},onClick:()=>{const R=k?null:E;c(R),R&&x(C,I.itemUnit,I.itemStdUnit)},children:[I.itemStdUnit,r.jsx("span",{style:{marginLeft:8,fontSize:12,color:P?"crimson":"var(--muted)"},children:k?"닫기":"품목 보기"})]}),r.jsx("td",{style:{padding:"6px 8px",textAlign:"right"},children:I.itemCount.toLocaleString()})]},C+O)}),l===C||w.some(I=>l===`${C}|${I.itemUnit}|${I.itemStdUnit}`)?r.jsx("tr",{style:{background:"var(--muted-bg, #fafafa)"},children:r.jsx("td",{colSpan:5,style:{padding:"8px 8px 12px"},children:d?r.jsx("div",{style:{color:"var(--muted)"},children:"품목 불러오는 중…"}):f.length===0?r.jsx("div",{style:{color:"var(--muted)"},children:"해당 영업관리단위에 품목이 없습니다."}):r.jsx("div",{style:{maxHeight:"50vh",minHeight:200,overflow:"auto",border:"1px solid var(--border)",borderRadius:6},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{position:"sticky",top:0,background:"var(--bg)"},children:[r.jsx("th",{style:{textAlign:"left",padding:"6px 8px"},children:"품목명"}),r.jsx("th",{style:{textAlign:"left",padding:"6px 8px"},children:"판매단위"}),r.jsx("th",{style:{textAlign:"left",padding:"6px 8px"},children:"표준단위"}),r.jsx("th",{style:{textAlign:"left",padding:"6px 8px",width:150},children:"새표준단위"}),r.jsx("th",{style:{textAlign:"right",padding:"6px 8px"},children:"품목SEQ"})]})}),r.jsx("tbody",{children:f.map((I,O)=>{const E=N(I),S=!E||E.trim()==="";return r.jsxs("tr",{style:{borderTop:"1px solid var(--border)"},children:[r.jsx("td",{style:{padding:"6px 8px",color:S?"crimson":void 0,fontWeight:S?600:void 0},children:I.itemName||"(이름 없음)"}),r.jsx("td",{style:{padding:"6px 8px",color:S?"crimson":void 0},children:I.itemUnit||"미지정"}),r.jsx("td",{style:{padding:"6px 8px"},children:I.itemStdUnit||"미지정"}),r.jsx("td",{style:{padding:"6px 8px"},children:r.jsx("input",{type:"text",value:N(I),onChange:k=>A(I.itemName,k.target.value),placeholder:"입력",style:{width:"100%",padding:"4px 8px",border:"1px solid var(--border)",borderRadius:4,fontSize:13}})}),r.jsx("td",{style:{padding:"6px 8px",textAlign:"right",color:"var(--muted)"},children:I.itemSeq??""})]},(I.itemSeq??"na")+"-"+O)})})]})})})}):null]},C))})]})})})]})}const mY=["TNT","DYS"];function gY(){const[e,n]=p.useState("TNT"),[i,s]=p.useState("2022"),[a,o]=p.useState([]),[l,c]=p.useState("all"),[d,u]=p.useState([]),[f,h]=p.useState([]),[m,g]=p.useState(!1),[b,j]=p.useState(null);p.useEffect(()=>{y()},[e,i]);const y=async()=>{const O=Number(i)||2022;try{const E=new URLSearchParams;E.append("companyType",e),E.append("fromYear",String(O));const S=await fetch(`/api/v1/analysis/price-sim/employees?${E.toString()}`);if(!S.ok)throw new Error(`HTTP ${S.status}`);const k=await S.json();o(k),c(k.length?"all":"")}catch(E){o([]),c(""),j((E==null?void 0:E.message)||"영업사원 목록 조회 실패")}},x=async()=>{g(!0),j(null);const O=Number(i)||2022;try{const E=new URLSearchParams;e!=="ALL"&&E.append("companyType",e),E.append("fromYear",String(O)),l&&l!=="all"&&E.append("empName",l);const S=await fetch(`/api/v1/analysis/price-sim?${E.toString()}`);if(!S.ok)throw new Error(`HTTP ${S.status}`);const k=await S.json();if(k.error)throw new Error(k.error);const D=Array.isArray(k.data)?k.data.map(P=>({salesYear:Number(P.salesYear??P.salesyear??0),salesUnit:String(P.salesUnit??P.salesunit??"미지정"),empName:String(P.empName??P.empname??"미지정"),salesCount:P.salesCount??P.salescount,totalQty:P.totalQty??P.totalqty,totalAmt:P.totalAmt??P.totalamt,avgPrice:(()=>{const R=Number(P.totalQty??P.totalqty??0),Y=P.avgPrice??P.avgprice??null;if(!Number.isFinite(R)||R<=0)return null;const X=Number(Y);return Number.isFinite(X)?X:null})()})):[];u(D);const T=Array.isArray(k.companyAvg)?k.companyAvg.map(P=>({salesUnit:String(P.salesUnit??P.salesunit??"미지정"),avgPrice:P.avgPrice??P.avgprice??null})):[];h(T)}catch(E){u([]),h([]),j((E==null?void 0:E.message)||"조회 실패")}finally{g(!1)}},v=p.useMemo(()=>{const O=[...d];return O.sort((E,S)=>{if(S.salesYear!==E.salesYear)return S.salesYear-E.salesYear;const k=E.salesUnit||"미지정",D=S.salesUnit||"미지정",T=k==="미지정",P=D==="미지정";return T&&!P?1:!T&&P?-1:k.localeCompare(D)}),O},[d]),A=p.useMemo(()=>Array.from(new Set(v.map(O=>O.salesYear))).sort((O,E)=>E-O),[v]),N=p.useMemo(()=>{const O=new Map;for(const E of f)O.set(E.salesUnit||"미지정",E.avgPrice??null);return O},[f]),C=p.useMemo(()=>{const O=new Map;for(const E of v){const S=`${E.empName}__${E.salesUnit}`;if(!O.has(S)){const D={};A.forEach(T=>{D[T]=null}),O.set(S,{empName:E.empName||"미지정",salesUnit:E.salesUnit||"미지정",yearly:D})}const k=O.get(S);k.yearly[E.salesYear]=E.avgPrice}return Array.from(O.values()).sort((E,S)=>{const k=E.salesUnit==="미지정",D=S.salesUnit==="미지정";if(k&&!D)return 1;if(!k&&D)return-1;const T=E.salesUnit.localeCompare(S.salesUnit);return T!==0?T:E.empName.localeCompare(S.empName)})},[v,A]),w=p.useMemo(()=>{const O=v.reduce((D,T)=>D+(T.salesCount||0),0),E=v.reduce((D,T)=>D+(T.totalQty||0),0),S=v.reduce((D,T)=>D+(T.totalAmt||0),0),k=E>0?S/E:0;return{totalSalesCount:O,totalQty:E,totalAmt:S,avgPrice:k}},[v]),_=O=>{if(O==null||O==="")return"-";const E=Number(O);return Number.isFinite(E)?E.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(O)},I=O=>{if(O==null||O==="")return"-";const E=Number(O);return Number.isFinite(E)?E.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(O)};return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:"판매단가 시뮬레이션"}),r.jsxs("div",{style:{marginTop:16,display:"flex",gap:12,alignItems:"flex-end"},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"회사 구분"}),r.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"inline-flex",gap:2},children:mY.map(O=>r.jsx("button",{onClick:()=>n(O),style:{background:e===O?"#fff":"transparent",border:"none",padding:"8px 16px",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer",color:e===O?"#111827":"#6b7280",boxShadow:e===O?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:O},O))})]}),r.jsxs("div",{style:{flex:1,maxWidth:240},children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"영업사원"}),r.jsxs("select",{className:"input",value:l,onChange:O=>c(O.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13,color:"#111827",background:"#fff"},children:[r.jsx("option",{value:"all",children:"전체"}),a.map(O=>r.jsx("option",{value:O,children:O},O))]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"시작 연도"}),r.jsx("input",{className:"input",type:"number",min:2e3,max:new Date().getFullYear(),value:i,onChange:O=>s(O.target.value),style:{width:100,padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13,textAlign:"center",color:"#111827",background:"#fff"}})]}),r.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:r.jsxs("button",{onClick:x,disabled:m,style:{background:m?"#93c5fd":"#3b82f6",border:"none",padding:"8px 20px",borderRadius:6,fontSize:13,fontWeight:600,cursor:m?"not-allowed":"pointer",color:"#fff",display:"flex",alignItems:"center",gap:6},children:[r.jsx(Ni,{size:14}),m?"조회 중...":"분석 실행"]})})]}),d.length>0&&r.jsxs("div",{style:{marginTop:20,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[r.jsx(Ql,{title:"총 거래 건수",value:_(w.totalSalesCount),subtext:"Invoice 기준",icon:r.jsx(nr,{size:24}),color:"#3b82f6"}),r.jsx(Ql,{title:"총 판매 수량",value:_(w.totalQty),subtext:"전체 기간 합계",icon:r.jsx(_s,{size:24}),color:"#10b981"}),r.jsx(Ql,{title:"총 판매 금액",value:_(w.totalAmt),subtext:"원화 기준",icon:r.jsx(Ni,{size:24}),color:"#f59e0b"}),r.jsx(Ql,{title:"평균 판매 단가",value:I(w.avgPrice),subtext:"금액 ÷ 수량",icon:r.jsx(Ni,{size:24}),color:"#8b5cf6"})]})]}),r.jsx("div",{style:{flex:1,padding:24,overflow:"hidden"},children:r.jsx("div",{className:"card",style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:b?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:b}):v.length===0?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"조건을 선택하고 분석을 실행하세요"}):r.jsx("div",{style:{overflow:"auto",flex:1,padding:16},children:r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",width:160},children:"영업사원"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",width:160},children:"영업관리단위"}),r.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280",width:120},children:"회사 평균단가"}),A.map(O=>r.jsxs("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:[O,"년 평균단가"]},O))]})}),r.jsx("tbody",{children:C.map((O,E)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[r.jsx("td",{style:{padding:"12px 16px",fontWeight:500,color:"#111827"},children:O.empName||"-"}),r.jsx("td",{style:{padding:"12px 16px",color:"#4b5563"},children:O.salesUnit||"미지정"}),r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600,color:"#6b7280"},children:I(N.get(O.salesUnit||"미지정"))}),A.map(S=>r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600,color:"#111827"},children:I(O.yearly[S])},S))]},O.empName+O.salesUnit+E))})]})})})})]})}function Ql({title:e,value:n,subtext:i,icon:s,color:a}){return r.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:8,padding:12,transition:"all 0.2s"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:4},children:[r.jsx("span",{style:{fontSize:11,color:"#6b7280",fontWeight:500},children:e}),r.jsx("span",{style:{color:a},children:Be.cloneElement(s,{size:16})})]}),r.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#111827"},children:n}),i&&r.jsx("div",{style:{fontSize:10,color:"#6b7280",marginTop:2},children:i})]})}const yY=["TNT","DYS"];function xY(){const[e,n]=p.useState("TNT"),[i,s]=p.useState("2022"),[a,o]=p.useState([]),[l,c]=p.useState(!1),[d,u]=p.useState(null);p.useEffect(()=>{f()},[]);async function f(){c(!0),u(null);try{const y=new URLSearchParams;y.append("companyType",e),y.append("fromYear",i||"2022");const x=await fetch(`/api/v1/analysis/price-sim?${y.toString()}`);if(!x.ok)throw new Error(`HTTP ${x.status}`);const v=await x.json();if(v.error)throw new Error(v.error);const A=Array.isArray(v.data)?v.data.map(N=>({salesYear:Number(N.salesYear??N.salesyear??0),salesUnit:String(N.salesUnit??N.salesunit??"미지정"),empName:String(N.empName??N.empname??"미지정"),totalQty:N.totalQty??N.totalqty,totalAmt:N.totalAmt??N.totalamt,avgPrice:N.avgPrice??N.avgprice??null})):[];o(A)}catch(y){u((y==null?void 0:y.message)||"조회 실패"),o([])}finally{c(!1)}}const h=p.useMemo(()=>Array.from(new Set(a.map(y=>y.salesYear))).sort((y,x)=>x-y),[a]),m=p.useMemo(()=>{const y=new Map;for(const v of a){const A=v.salesUnit||"미지정",N=A,C=v.salesYear;y.has(N)||y.set(N,{salesUnit:A,yearAmt:{},yearQty:{}});const w=y.get(N);w.yearAmt[C]=(w.yearAmt[C]||0)+(Number(v.totalAmt)||0),w.yearQty[C]=(w.yearQty[C]||0)+(Number(v.totalQty)||0)}const x=[];for(const{salesUnit:v,yearAmt:A,yearQty:N}of y.values()){const C={};h.forEach(w=>{const _=A[w]||0,I=N[w]||0;C[w]=I>0?_/I:null}),x.push({salesUnit:v,yearly:C})}return x.sort((v,A)=>{const N=v.salesUnit==="미지정",C=A.salesUnit==="미지정";return N&&!C?1:!N&&C?-1:v.salesUnit.localeCompare(A.salesUnit)})},[a,h]),g=p.useMemo(()=>{const y=a.reduce((A,N)=>A+(Number(N.totalAmt)||0),0),x=a.reduce((A,N)=>A+(Number(N.totalQty)||0),0),v=x>0?y/x:0;return{totalAmt:y,totalQty:x,avgPrice:v}},[a]),b=y=>{if(y==null||y==="")return"-";const x=Number(y);return Number.isFinite(x)?x.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(y)},j=y=>{if(y==null||y==="")return"-";const x=Number(y);return Number.isFinite(x)?x.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(y)};return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:"판매단가 Sim (영업관리단위)"}),r.jsx("p",{style:{margin:"4px 0 0 0",color:"#6b7280",fontSize:14},children:"영업관리단위별 연도별 평균단가 (직원 합산)"}),r.jsxs("div",{style:{marginTop:20,display:"flex",gap:12,alignItems:"flex-end"},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"회사 구분"}),r.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"inline-flex",gap:2},children:yY.map(y=>r.jsx("button",{onClick:()=>n(y),style:{background:e===y?"#fff":"transparent",border:"none",padding:"8px 16px",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer",color:e===y?"#111827":"#6b7280",boxShadow:e===y?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:y},y))})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"시작 연도"}),r.jsx("input",{className:"input",type:"number",min:2e3,max:new Date().getFullYear(),value:i,onChange:y=>s(y.target.value),style:{width:100,padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13,textAlign:"center",color:"#111827",background:"#fff"}})]}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[r.jsxs("button",{onClick:()=>{n("TNT"),s("2022"),o([]),u(null)},style:{background:"#f3f4f6",border:"none",padding:"8px 16px",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",gap:6},children:[r.jsx(ln,{size:14}),"초기화"]}),r.jsxs("button",{onClick:f,disabled:l,style:{background:l?"#93c5fd":"#3b82f6",border:"none",padding:"8px 20px",borderRadius:6,fontSize:13,fontWeight:600,cursor:l?"not-allowed":"pointer",color:"#fff",display:"flex",alignItems:"center",gap:6},children:[r.jsx(Ni,{size:14}),l?"조회 중...":"분석 실행"]})]})]}),a.length>0&&r.jsxs("div",{style:{marginTop:20,display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:16},children:[r.jsx(xf,{title:"총 판매 수량",value:b(g.totalQty),subtext:"전체 기간 합계",color:"#10b981"}),r.jsx(xf,{title:"총 판매 금액",value:b(g.totalAmt),subtext:"원화 기준",color:"#f59e0b"}),r.jsx(xf,{title:"평균 판매 단가",value:j(g.avgPrice),subtext:"금액 ÷ 수량",color:"#8b5cf6"})]})]}),r.jsx("div",{style:{flex:1,padding:24,overflow:"hidden"},children:r.jsx("div",{className:"card",style:{height:"100%",display:"flex",flexDirection:"column",overflow:"auto",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:d?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:d}):m.length===0?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"조건을 선택하고 분석을 실행하세요"}):r.jsx("div",{style:{overflow:"auto",flex:1,padding:16},children:r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",width:200},children:"영업관리단위"}),h.map(y=>r.jsxs("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:[y,"년 평균단가"]},y))]})}),r.jsx("tbody",{children:m.map((y,x)=>r.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[r.jsx("td",{style:{padding:"12px 16px",fontWeight:600,color:"#111827"},children:y.salesUnit}),h.map(v=>r.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600,color:"#111827"},children:j(y.yearly[v])},v))]},y.salesUnit+x))})]})})})})]})}function xf({title:e,value:n,subtext:i,color:s}){return r.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,padding:20,transition:"all 0.2s"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:8},children:[r.jsx("span",{style:{fontSize:14,color:"#6b7280",fontWeight:500},children:e}),r.jsx("span",{style:{color:s},children:r.jsx(Ni,{size:20})})]}),r.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#111827"},children:n}),i&&r.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:i})]})}function vY({onClose:e,onSelect:n}){return r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:12,width:"90%",maxWidth:1e3,height:"80vh",display:"flex",flexDirection:"column",boxShadow:"0 10px 25px rgba(0,0,0,0.2)"},children:[r.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #eee",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h2",{style:{margin:0,fontSize:18},children:"거래처 검색"}),r.jsx("button",{onClick:e,style:{background:"none",border:"none",cursor:"pointer"},children:r.jsx(On,{size:24})})]}),r.jsx("div",{style:{flex:1,overflow:"hidden",padding:20},children:r.jsx(Ep,{compact:!0,maxHeight:"calc(80vh - 140px)",autoSelectFirst:!1,onSelect:i=>n({customerSeq:Number(i.customerSeq),customerName:i.customerName})})})]})})}function bY(){var v,A,N,C,w,_,I,O;const[e,n]=p.useState(null),[i,s]=p.useState(new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0]),[a,o]=p.useState(new Date().toISOString().split("T")[0]),[l,c]=p.useState(null),[d,u]=p.useState(!1),[f,h]=p.useState(!1),[m,g]=p.useState(50),[b,j]=p.useState(""),y=async()=>{if(e){u(!0);try{const E=await fetch(`/api/v1/lab/price-simulation/data?customerSeq=${e.seq}&startDate=${i}&endDate=${a}`);if(E.ok){const S=await E.json();c(S),g(S.assessmentScore),j(S.assessmentComment||"")}}catch(E){console.error(E)}finally{u(!1)}}},x=async()=>{if(e)try{await fetch("/api/v1/lab/price-simulation/assessment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerSeq:e.seq,assessorId:"current-user",score:m,comment:b})}),y()}catch(E){console.error(E)}};return r.jsxs("div",{className:"price-simulation",style:{padding:20,height:"100%",overflow:"auto",display:"flex",flexDirection:"column",gap:20},children:[r.jsxs("header",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h1",{style:{fontSize:24,fontWeight:"bold"},children:"Price Simulation"}),r.jsxs("div",{style:{display:"flex",gap:10,alignItems:"center"},children:[r.jsxs("div",{className:"input-group",style:{display:"flex",alignItems:"center",gap:8,background:"#f5f5f5",padding:"4px 12px",borderRadius:8},children:[r.jsx(qr,{size:16}),r.jsx("input",{type:"date",value:i,onChange:E=>s(E.target.value),style:{border:"none",background:"transparent"}}),r.jsx("span",{children:"~"}),r.jsx("input",{type:"date",value:a,onChange:E=>o(E.target.value),style:{border:"none",background:"transparent"}})]}),r.jsxs("button",{onClick:()=>h(!0),style:{display:"flex",alignItems:"center",gap:8,padding:"8px 16px",background:"#333",color:"#fff",borderRadius:8,border:"none",cursor:"pointer"},children:[r.jsx(uc,{size:16}),e?e.name:"거래처 선택"]}),r.jsx("button",{onClick:y,disabled:!e||d,style:{display:"flex",alignItems:"center",gap:8,padding:"8px 16px",background:!e||d?"#ccc":"#2563eb",color:"#fff",borderRadius:8,border:"none",cursor:!e||d?"not-allowed":"pointer",fontWeight:"bold"},children:"SIMULATION"})]})]}),e&&l?r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[r.jsx(Jl,{title:"거래규모 (성장성)",icon:r.jsx(pd,{color:"#4CAF50"}),score:l.volumeScore,children:r.jsxs("div",{style:{fontSize:12,color:"#666"},children:[r.jsxs("div",{children:["금년: ",(v=l.volumeCurrent)==null?void 0:v.toLocaleString()]}),r.jsxs("div",{children:["전년: ",(A=l.volumeYear1)==null?void 0:A.toLocaleString()]}),r.jsxs("div",{style:{fontWeight:"bold",color:l.volumeGrowthRate>=0?"#4CAF50":"#F44336"},children:["YoY: ",(N=l.volumeGrowthRate)==null?void 0:N.toFixed(1),"%"]})]})}),r.jsx(Jl,{title:"채권 건전성",icon:r.jsx(Ti,{color:"#FF9800"}),score:l.agingScore,children:r.jsxs("div",{style:{fontSize:12,color:"#666"},children:[r.jsxs("div",{children:["총채권: ",(C=l.totalAr)==null?void 0:C.toLocaleString()]}),r.jsxs("div",{children:["연체: ",(w=l.overdueAr)==null?void 0:w.toLocaleString()]}),r.jsxs("div",{style:{fontWeight:"bold",color:l.overdueRatio>0?"#F44336":"#4CAF50"},children:["연체율: ",(_=l.overdueRatio)==null?void 0:_.toFixed(1),"%"]})]})}),r.jsx(Jl,{title:"대외 신용도",icon:r.jsx(SN,{color:"#2196F3"}),score:l.ratingScore,children:r.jsxs("div",{style:{fontSize:12,color:"#666"},children:[r.jsxs("div",{children:["기관: ",l.ratingAgency||"-"]}),r.jsx("div",{style:{fontSize:24,fontWeight:"bold",margin:"4px 0"},children:l.ratingGrade||"-"})]})}),r.jsx(Jl,{title:"영업 정성평가",icon:r.jsx(e_,{color:"#9C27B0"}),score:l.assessmentScore,children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[r.jsx("input",{type:"range",min:"0",max:"100",step:"20",value:m,onChange:E=>g(Number(E.target.value)),style:{width:"100%"}}),r.jsxs("div",{style:{display:"flex",gap:4},children:[r.jsx("input",{type:"text",value:b,onChange:E=>j(E.target.value),placeholder:"평가 코멘트",style:{flex:1,padding:4,borderRadius:4,border:"1px solid #ddd",fontSize:12}}),r.jsx("button",{onClick:x,style:{fontSize:10,padding:"4px 8px",background:"#333",color:"#fff",border:"none",borderRadius:4,cursor:"pointer"},children:"저장"})]})]})})]}),r.jsxs("div",{style:{background:"linear-gradient(90deg, #1a237e 0%, #283593 100%)",padding:20,borderRadius:12,color:"#fff",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("h2",{style:{margin:0,fontSize:18,opacity:.9},children:"Price Simulation Result"}),r.jsxs("p",{style:{margin:"4px 0 0 0",fontSize:14,opacity:.7},children:["종합 점수 ",l.totalScore,"점을 기반으로 산출된 권장 인상률입니다."]})]}),r.jsxs("div",{style:{textAlign:"right"},children:[r.jsx("div",{style:{fontSize:14,opacity:.8},children:"권장 인상률"}),r.jsxs("div",{style:{fontSize:32,fontWeight:"bold",color:"#4CAF50"},children:["+",(I=l.suggestedIncreaseRate)==null?void 0:I.toFixed(2),"%"]})]})]}),r.jsx("div",{style:{background:"#fff",borderRadius:12,border:"1px solid #eee",overflow:"hidden"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{style:{background:"#f9f9f9",borderBottom:"1px solid #eee"},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:12,textAlign:"left",fontSize:12,color:"#666"},children:"품목명"}),r.jsx("th",{style:{padding:12,textAlign:"center",fontSize:12,color:"#666"},children:"단위"}),r.jsx("th",{style:{padding:12,textAlign:"right",fontSize:12,color:"#666"},children:"최근 판매량"}),r.jsx("th",{style:{padding:12,textAlign:"right",fontSize:12,color:"#666"},children:"최근 평균단가"}),r.jsx("th",{style:{padding:12,textAlign:"right",fontSize:12,color:"#666",background:"#e8f5e9"},children:"시뮬레이션 단가"}),r.jsx("th",{style:{padding:12,textAlign:"right",fontSize:12,color:"#666"},children:"예상 증분"})]})}),r.jsxs("tbody",{children:[(O=l.items)==null?void 0:O.map(E=>{var S,k,D;return r.jsxs("tr",{style:{borderBottom:"1px solid #f5f5f5"},children:[r.jsx("td",{style:{padding:12,fontSize:14},children:E.itemName}),r.jsx("td",{style:{padding:12,textAlign:"center",fontSize:12,color:"#888"},children:E.itemUnit}),r.jsx("td",{style:{padding:12,textAlign:"right",fontSize:14},children:(S=E.recentQty)==null?void 0:S.toLocaleString()}),r.jsx("td",{style:{padding:12,textAlign:"right",fontSize:14},children:(k=E.recentUnitPrice)==null?void 0:k.toLocaleString()}),r.jsx("td",{style:{padding:12,textAlign:"right",fontSize:14,fontWeight:"bold",color:"#2E7D32",background:"#f1f8e9"},children:(D=E.simulatedUnitPrice)==null?void 0:D.toLocaleString(void 0,{maximumFractionDigits:0})}),r.jsxs("td",{style:{padding:12,textAlign:"right",fontSize:12,color:"#4CAF50"},children:["+",(E.simulatedUnitPrice-E.recentUnitPrice).toLocaleString(void 0,{maximumFractionDigits:0})]})]},E.itemSeq)}),(!l.items||l.items.length===0)&&r.jsx("tr",{children:r.jsx("td",{colSpan:6,style:{padding:40,textAlign:"center",color:"#999"},children:"해당 기간에 판매 이력이 없습니다."})})]})]})})]}):r.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#999",gap:16},children:[r.jsx("div",{style:{width:64,height:64,borderRadius:32,background:"#f5f5f5",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(uc,{size:32,color:"#ccc"})}),r.jsx("p",{children:"상단에서 거래처를 선택하여 시뮬레이션을 시작하세요."})]}),f&&r.jsx(vY,{onClose:()=>h(!1),onSelect:E=>{n({seq:E.customerSeq,name:E.customerName}),h(!1)}})]})}function Jl({title:e,icon:n,score:i,children:s}){return r.jsxs("div",{style:{background:"#fff",borderRadius:12,padding:16,border:"1px solid #eee",display:"flex",flexDirection:"column",gap:12},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontWeight:"bold",fontSize:14},children:[n,e]}),r.jsxs("div",{style:{padding:"4px 8px",borderRadius:12,fontSize:12,fontWeight:"bold",background:i>=80?"#E8F5E9":i>=50?"#FFF3E0":"#FFEBEE",color:i>=80?"#2E7D32":i>=50?"#EF6C00":"#C62828"},children:[i,"점"]})]}),r.jsx("div",{style:{height:1,background:"#f0f0f0"}}),s]})}function jY(){const[e,n]=p.useState(""),[i,s]=p.useState(!1),[a,o]=p.useState(null),[l,c]=p.useState([]),[d,u]=p.useState(!1),[f,h]=p.useState(!1),[m,g]=p.useState(null);p.useEffect(()=>{b()},[]);const b=async()=>{u(!0);try{const x=await fetch("/api/v1/nl2sql/schema");if(!x.ok)throw new Error(`HTTP ${x.status}`);const v=await x.json();v.error?g(v.error):c(v.tables||[])}catch(x){g(x.message||"스키마 조회 실패")}finally{u(!1)}},j=async x=>{if(x.preventDefault(),!!e.trim()){s(!0),g(null),o(null);try{const v=await fetch("/api/v1/nl2sql/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e.trim()})});if(!v.ok)throw new Error(`HTTP ${v.status}`);const A=await v.json();A.error?(g(A.error),A.sql&&o({...A,results:[],rowCount:0})):o(A)}catch(v){g(v.message||"쿼리 실행 실패")}finally{s(!1)}}},y=["2024년 총 매출액은?","영업사원별 매출 TOP 10","최근 3개월 신규 고객 수","제품별 판매 수량 합계"];return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{children:[r.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:"VIBE Workspace"}),r.jsx("p",{style:{margin:"6px 0 0",color:"#6b7280",fontSize:14},children:"자연어로 데이터베이스에 질문하세요"})]}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsxs("button",{onClick:()=>window.open("https://aistudio.google.com/usage?project=gen-lang-client-0711471737&timeRange=last-28-days","_blank"),style:{display:"flex",alignItems:"center",gap:6,padding:"8px 16px",background:"#fff",color:"#374151",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer"},children:[r.jsx(TN,{size:16}),"토큰"]}),r.jsxs("button",{onClick:()=>window.open("https://docs.n8n.io/","_blank"),style:{display:"flex",alignItems:"center",gap:6,padding:"8px 16px",background:"#fff",color:"#374151",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer"},children:[r.jsx(NN,{size:16}),"n8n 매뉴얼"]}),r.jsxs("button",{onClick:()=>window.open("https://tntintl1-my.sharepoint.com/","_blank"),style:{display:"flex",alignItems:"center",gap:6,padding:"8px 16px",background:"#fff",color:"#374151",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer"},children:[r.jsx(Uv,{size:16}),"OneDrive"]}),r.jsxs("button",{onClick:()=>window.open("https://portal.azure.com/#view/Microsoft_AAD_RegisteredApps/ApplicationsListBlade","_blank"),style:{display:"flex",alignItems:"center",gap:6,padding:"8px 16px",background:"#fff",color:"#374151",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer"},children:[r.jsx(zv,{size:16}),"MS 앱"]}),r.jsxs("button",{onClick:()=>window.open("https://api.slack.com/apps","_blank"),style:{display:"flex",alignItems:"center",gap:6,padding:"8px 16px",background:"#fff",color:"#374151",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer"},children:[r.jsx(No,{size:16}),"Slack 앱"]}),r.jsxs("button",{onClick:()=>h(!f),style:{display:"flex",alignItems:"center",gap:6,padding:"8px 16px",background:f?"#3b82f6":"#fff",color:f?"#fff":"#374151",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer"},children:[r.jsx(ei,{size:16}),f?"스키마 숨기기":"스키마 보기"]})]})]}),r.jsx("form",{onSubmit:j,style:{marginTop:16},children:r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("div",{style:{flex:1,position:"relative"},children:[r.jsx(Fn,{size:18,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}}),r.jsx("input",{type:"text",value:e,onChange:x=>n(x.target.value),placeholder:"예: 2024년 총 매출액은 얼마인가요?",disabled:i,style:{width:"100%",padding:"12px 12px 12px 40px",border:"1px solid #d1d5db",borderRadius:8,fontSize:14,color:"#111827",background:"#fff"}})]}),r.jsx("button",{type:"submit",disabled:i||!e.trim(),style:{padding:"12px 24px",background:i||!e.trim()?"#93c5fd":"#3b82f6",color:"#fff",border:"none",borderRadius:8,fontSize:14,fontWeight:600,cursor:i||!e.trim()?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:8},children:i?r.jsxs(r.Fragment,{children:[r.jsx(Ei,{size:16,style:{animation:"spin 1s linear infinite"}}),"분석 중..."]}):"질문하기"})]})}),r.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[r.jsx("span",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:"예시:"}),y.map((x,v)=>r.jsx("button",{onClick:()=>n(x),disabled:i,style:{padding:"4px 12px",background:"#f3f4f6",color:"#374151",border:"1px solid #e5e7eb",borderRadius:6,fontSize:12,cursor:"pointer"},children:x},v))]})]}),r.jsxs("div",{style:{flex:1,padding:24,overflow:"auto",display:"flex",gap:16},children:[f&&r.jsxs("div",{className:"card",style:{width:320,flexShrink:0,overflow:"auto",padding:16,background:"#fff"},children:[r.jsx("h3",{style:{margin:"0 0 12px",fontSize:16,fontWeight:600,color:"#111827"},children:"데이터베이스 스키마"}),d?r.jsx("div",{style:{textAlign:"center",padding:20,color:"#6b7280"},children:r.jsx(Ei,{size:24,style:{animation:"spin 1s linear infinite"}})}):l.length===0?r.jsx("div",{style:{textAlign:"center",padding:20,color:"#6b7280",fontSize:13},children:"스키마 정보 없음"}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:l.map((x,v)=>r.jsxs("details",{style:{background:"#f9fafb",padding:8,borderRadius:6},children:[r.jsxs("summary",{style:{cursor:"pointer",fontWeight:500,fontSize:13,color:"#374151",marginBottom:8},children:[x.schema,".",x.name]}),r.jsx("div",{style:{paddingLeft:12,fontSize:12,color:"#6b7280"},children:x.columns.map((A,N)=>r.jsxs("div",{style:{marginBottom:6,display:"flex",flexDirection:"column",gap:2},children:[r.jsxs("div",{children:[r.jsx("span",{style:{color:"#111827",fontWeight:500},children:A.name}),r.jsxs("span",{style:{color:"#9ca3af"},children:[" (",A.type,")"]})]}),A.description&&r.jsx("div",{style:{fontSize:11,color:"#3b82f6",fontWeight:500},children:A.description})]},N))})]},v))})]}),r.jsx("div",{className:"card",style:{flex:1,display:"flex",flexDirection:"column",background:"#fff"},children:m?r.jsxs("div",{style:{padding:40,textAlign:"center"},children:[r.jsx(Ti,{size:48,style:{color:"#ef4444",marginBottom:12}}),r.jsx("div",{style:{color:"#ef4444",fontSize:16,fontWeight:600},children:m})]}):a?r.jsxs("div",{style:{padding:16,display:"flex",flexDirection:"column",gap:16,flex:1,overflow:"hidden"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:12,background:"#f0fdf4",borderRadius:8},children:[r.jsx(dc,{size:20,style:{color:"#22c55e"}}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#166534"},children:"쿼리 실행 완료"}),r.jsxs("div",{style:{fontSize:12,color:"#15803d",marginTop:2},children:[a.rowCount,"개의 결과를 찾았습니다"]})]})]}),r.jsxs("div",{children:[r.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6},children:"생성된 SQL:"}),r.jsx("pre",{style:{background:"#1f2937",color:"#f3f4f6",padding:12,borderRadius:6,fontSize:12,overflow:"auto",margin:0},children:a.sql})]}),a.results.length>0&&r.jsxs("div",{style:{flex:1,overflow:"auto"},children:[r.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8},children:"결과:"}),r.jsx("div",{style:{overflow:"auto",border:"1px solid #e5e7eb",borderRadius:6},children:r.jsxs("table",{className:"table",style:{width:"100%",fontSize:13},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:1},children:r.jsx("tr",{children:Object.keys(a.results[0]).map(x=>r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:600,color:"#374151"},children:x},x))})}),r.jsx("tbody",{children:a.results.map((x,v)=>r.jsx("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:Object.values(x).map((A,N)=>r.jsx("td",{style:{padding:"10px 12px",color:"#6b7280"},children:A==null?r.jsx("span",{style:{color:"#d1d5db",fontStyle:"italic"},children:"null"}):typeof A=="object"?JSON.stringify(A):String(A)},N))},v))})]})})]})]}):r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(QN,{size:64,style:{margin:"0 auto 16px",color:"#d1d5db"}}),r.jsx("div",{style:{fontSize:16,fontWeight:500,marginBottom:8},children:"질문을 입력하세요"}),r.jsx("div",{style:{fontSize:14},children:"자연어로 데이터베이스에 질문하면 자동으로 SQL을 생성하여 실행합니다"})]})})]}),r.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})}function wY(){var Zn;const[e,n]=p.useState(null),[i,s]=p.useState([]),[a,o]=p.useState(""),[l,c]=p.useState(!1),[d,u]=p.useState(""),[f,h]=p.useState(null),[m,g]=p.useState(null),[b,j]=p.useState([]),[y,x]=p.useState(!1),[v,A]=p.useState(!1),{instance:N,accounts:C,inProgress:w}=xN(),_=p.useRef(null),I=p.useRef(null),O=p.useRef(null),E=p.useRef(null),[S,k]=p.useState(null),[D,T]=p.useState(!1),[P,R]=p.useState([]),[Y,X]=p.useState(""),[H,q]=p.useState(!1),[M,L]=p.useState(!1),[B,F]=p.useState(!1),[te,$]=p.useState([]),[W,U]=p.useState(!1),[Z,ee]=p.useState(""),[K,ne]=p.useState(!1),[pe,G]=p.useState([]),[ae,ie]=p.useState([]),[J,re]=p.useState(!1),[de,he]=p.useState(null);p.useEffect(()=>{var ue;(ue=E.current)==null||ue.scrollIntoView({behavior:"smooth"})},[i,d]),p.useEffect(()=>{oe(),V()},[]);const oe=async()=>{try{const De=await(await fetch("/api/v1/rag/documents")).json();De.documents&&j(De.documents)}catch(ue){console.error("Failed to fetch documents:",ue)}},V=async()=>{try{const De=await(await fetch("/api/v1/rag/stores")).json();De.stores&&(R(De.stores),X(De.currentStore||""))}catch(ue){console.error("Failed to fetch stores:",ue)}},Pe=async()=>{if(!Z.trim()){k("❌ 스토어 이름을 입력하세요");return}L(!0);try{const ue=Z.trim(),Ke=await(await fetch("/api/v1/rag/store",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({displayName:ue})})).json();Ke.success?(k(`✅ FileSearchStore "${ue}" 생성 완료!`),ee(""),V()):k(`❌ Store 생성 실패: ${Ke.error}`)}catch(ue){k(`❌ Store 생성 실패: ${ue.message}`)}finally{L(!1)}},Ve=async ue=>{try{(await(await fetch("/api/v1/rag/store/select",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({storeName:ue})})).json()).success&&(X(ue),k(`✅ Store 선택됨: ${ue.split("/").pop()}`))}catch(De){k(`❌ Store 선택 실패: ${De.message}`)}},tt=async(ue,De)=>{if(window.confirm(`"${De}" 스토어를 삭제하시겠습니까?

⚠️ 스토어 내 모든 파일이 함께 삭제됩니다.`)){L(!0);try{const Ke=ue.split("/").pop(),pt=await(await fetch(`/api/v1/rag/store/${Ke}`,{method:"DELETE"})).json();pt.success?(k(`✅ "${De}" 스토어가 삭제되었습니다.`),ue===Y&&(X(""),$([]),U(!1)),V()):k(`❌ 스토어 삭제 실패: ${pt.error||pt.message}`)}catch(Ke){k(`❌ 스토어 삭제 실패: ${Ke.message}`)}finally{L(!1)}}},ot=async ue=>{if(!Y){k("❌ 먼저 FileSearchStore를 선택하세요");return}F(!0),k(`📤 "${ue.name}" 업로드 중... (${(ue.size/1024/1024).toFixed(2)} MB)`);try{const De=new FormData;De.append("file",ue);const Ke=await fetch("/api/v1/rag/store/upload",{method:"POST",body:De});if(!Ke.ok){const pt=await Ke.text();let jt=`HTTP ${Ke.status}`;try{const Dt=JSON.parse(pt);jt=Dt.error||Dt.message||jt}catch{jt=pt||jt}k(`❌ 업로드 실패: ${jt}`);return}const lt=await Ke.json();lt.success?(k(`✅ "${ue.name}" FileSearchStore에 업로드 완료!`),W&&vt()):k(`❌ 업로드 실패: ${lt.error||lt.details||lt.message}`)}catch(De){console.error("Upload error:",De),De.message==="Failed to fetch"?k("❌ 업로드 실패: 서버 연결 오류. 파일 크기가 너무 크거나 서버가 응답하지 않습니다."):k(`❌ 업로드 실패: ${De.message}`)}finally{F(!1)}},ht=ue=>{var Ke;const De=(Ke=ue.target.files)==null?void 0:Ke[0];De&&ot(De),ue.target.value=""},vt=async()=>{if(!Y){k("❌ 먼저 FileSearchStore를 선택하세요");return}try{const De=await(await fetch("/api/v1/rag/store/documents")).json();De.documents?($(De.documents),U(!0)):De.error&&k(`❌ ${De.error}`)}catch(ue){k(`❌ 문서 목록 조회 실패: ${ue.message}`)}},Se=async(ue,De)=>{if(window.confirm(`"${De}" 문서를 삭제하시겠습니까?

벡터 임베딩도 함께 삭제됩니다.`))try{const Ke=ue.split("/").pop(),pt=await(await fetch(`/api/v1/rag/store/document/${Ke}`,{method:"DELETE"})).json();pt.success?(k(`✅ "${De}" 문서가 삭제되었습니다.`),vt()):k(`❌ 문서 삭제 실패: ${pt.error||pt.message}`)}catch(Ke){k(`❌ 문서 삭제 실패: ${Ke.message}`)}},je=async()=>{try{const De=await(await fetch("/api/v1/rag/chat/session",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({})})).json();De.sessionId&&(n(De.sessionId),s([]),h(null),k(De.message))}catch(ue){h("세션 생성 실패: "+ue.message)}},Te=async()=>{if(!a.trim()||l)return;const ue=a.trim();o(""),c(!0),h(null),u(""),s(De=>[...De,{role:"user",content:ue,timestamp:new Date}]);try{const De=e?`/api/v1/rag/chat/${e}/stream?message=${encodeURIComponent(ue)}`:`/api/v1/rag/query/stream?question=${encodeURIComponent(ue)}`,Ke=new EventSource(De);let lt="",pt=[];Ke.addEventListener("content",jt=>{lt+=jt.data,u(lt)}),Ke.addEventListener("citations",jt=>{try{pt=JSON.parse(jt.data)}catch(Dt){console.error("Failed to parse citations:",Dt)}}),Ke.addEventListener("done",()=>{Ke.close(),s(jt=>[...jt,{role:"assistant",content:lt,timestamp:new Date,citations:pt.length>0?pt:void 0}]),u(""),c(!1)}),Ke.addEventListener("error",jt=>{Ke.close(),h(jt.data||"스트리밍 오류"),c(!1),u("")}),Ke.onerror=()=>{Ke.close(),lt&&s(jt=>[...jt,{role:"assistant",content:lt,timestamp:new Date}]),u(""),c(!1)}}catch(De){h(De.message||"메시지 전송 실패"),c(!1)}},Le=async ue=>{A(!0);try{const De=new FormData;De.append("file",ue);const lt=await(await fetch("/api/v1/rag/upload",{method:"POST",body:De})).json();lt.success?(oe(),k(`✅ "${ue.name}" RAG에 업로드 완료!`)):k(`❌ 업로드 실패: ${lt.error}`)}catch(De){k(`❌ 업로드 실패: ${De.message}`)}finally{A(!1)}},ke=async ue=>{try{await fetch(`/api/v1/rag/documents/${ue}`,{method:"DELETE"}),oe()}catch(De){console.error("Failed to delete document:",De)}},Ue=(ue,De)=>{navigator.clipboard.writeText(ue),g(De),setTimeout(()=>g(null),2e3)},st=async()=>{try{await N.loginPopup({scopes:Eu.oneDrive})}catch(ue){console.error("MS Login failed:",ue),k(`로그인 실패: ${ue.message}`)}},Ee=async()=>{try{await N.logoutPopup(),k(null)}catch(ue){console.error("MS Logout failed:",ue)}},dt=async()=>{if(C.length===0)return null;try{return(await N.acquireTokenSilent({scopes:Eu.oneDrive,account:C[0]})).accessToken}catch{try{return(await N.acquireTokenPopup({scopes:Eu.oneDrive})).accessToken}catch(De){return console.error("Token acquisition failed:",De),null}}},gt=async ue=>{re(!0);try{const De=await dt();if(!De){k("❌ OneDrive 인증이 필요합니다. 다시 로그인해주세요."),re(!1);return}const Ke=ue?`${ui.graphDriveEndpoint}/items/${ue}/children`:`${ui.graphDriveEndpoint}/root/children`,lt=await fetch(Ke,{headers:{Authorization:`Bearer ${De}`}});if(!lt.ok)throw new Error(`HTTP ${lt.status}`);const pt=await lt.json();G(pt.value||[])}catch(De){console.error("Failed to fetch OneDrive items:",De),k(`❌ OneDrive 폴더 조회 실패: ${De.message}`)}finally{re(!1)}},Nt=async ue=>{ue.folder&&(ie(De=>[...De,{id:ue.id,name:ue.name}]),await gt(ue.id))},St=async ue=>{if(ue===-1)ie([]),await gt();else{const De=ae.slice(0,ue+1);ie(De),await gt(De[De.length-1].id)}},yn=async ue=>{var De;try{const Ke=await dt();if(!Ke)return!1;const lt=await fetch(`${ui.graphDriveEndpoint}/items/${ue.id}/content`,{headers:{Authorization:`Bearer ${Ke}`}});if(!lt.ok)return console.error(`Failed to download ${ue.name}: HTTP ${lt.status}`),!1;const pt=await lt.blob(),jt=new File([pt],ue.name,{type:((De=ue.file)==null?void 0:De.mimeType)||"application/octet-stream"}),Dt=new FormData;Dt.append("file",jt);const cn=await fetch("/api/v1/rag/store/upload",{method:"POST",body:Dt});if(!cn.ok){const Un=await cn.text();return console.error(`Failed to upload ${ue.name} to RAG Store: ${Un}`),!1}return!0}catch(Ke){return console.error(`Failed to download/upload ${ue.name}:`,Ke),!1}},Kr=async(ue,De)=>{var Ke,lt;try{const pt=await dt();if(!pt)return!1;const jt="Archive",Dt=await fetch(`${ui.graphDriveEndpoint}/items/${De}/children`,{headers:{Authorization:`Bearer ${pt}`}});if(!Dt.ok)return!1;let Un=(Ke=(await Dt.json()).value)==null?void 0:Ke.find(Mt=>Mt.name===jt&&Mt.folder);if(!Un){const Mt=await fetch(`${ui.graphDriveEndpoint}/items/${De}/children`,{method:"POST",headers:{Authorization:`Bearer ${pt}`,"Content-Type":"application/json"},body:JSON.stringify({name:jt,folder:{},"@microsoft.graph.conflictBehavior":"fail"})});if(Mt.ok)Un=await Mt.json();else{const me=await fetch(`${ui.graphDriveEndpoint}/items/${De}/children`,{headers:{Authorization:`Bearer ${pt}`}});if(me.ok&&(Un=(lt=(await me.json()).value)==null?void 0:lt.find(Oe=>Oe.name===jt&&Oe.folder)),!Un)return!1}}return(await fetch(`${ui.graphDriveEndpoint}/items/${ue.id}`,{method:"PATCH",headers:{Authorization:`Bearer ${pt}`,"Content-Type":"application/json"},body:JSON.stringify({parentReference:{id:Un.id}})})).ok}catch(pt){return console.error(`Failed to move ${ue.name} to Archive:`,pt),!1}},Ot=async()=>{if(!Y){k("❌ 먼저 Google RAG Store를 선택하세요");return}const ue=pe.filter(lt=>lt.file&&!lt.folder);if(ue.length===0){k("❌ 현재 폴더에 파일이 없습니다");return}const De=ae.length>0?ae[ae.length-1].id:"root";he({total:ue.length,current:0,currentFile:"",completed:[],failed:[]});for(let lt=0;lt<ue.length;lt++){const pt=ue[lt];if(he(Dt=>Dt?{...Dt,current:lt+1,currentFile:pt.name}:null),await yn(pt)){const Dt=await Kr(pt,De);he(cn=>cn?{...cn,completed:Dt?[...cn.completed,pt.name]:cn.completed,failed:Dt?cn.failed:[...cn.failed,`${pt.name} (Archive 이동 실패)`]}:null)}else he(Dt=>Dt?{...Dt,failed:[...Dt.failed,`${pt.name} (업로드 실패)`]}:null)}await gt(De==="root"?void 0:De),W&&vt();const Ke=de;Ke&&k(`✅ 완료: ${Ke.completed.length}개 성공, ${Ke.failed.length}개 실패`)},En=async()=>{ne(!0),re(!0);try{const ue=await dt();if(!ue){k("❌ OneDrive 인증이 필요합니다. 다시 로그인해주세요."),re(!1);return}const De=`${ui.graphDriveEndpoint}/root:/Google RAG`,Ke=await fetch(De,{headers:{Authorization:`Bearer ${ue}`}});if(Ke.ok){const lt=await Ke.json();ie([{id:lt.id,name:"Google RAG"}]),await gt(lt.id)}else ie([]),await gt(),k('💡 "Google RAG" 폴더가 없습니다. Root에서 시작합니다.')}catch(ue){console.error("Failed to open OneDrive panel:",ue),ie([]),await gt()}},Gr=async ue=>{var De;T(!0),k("업로드 준비 중...");try{const Ke=await dt();if(!Ke){k("인증 토큰을 가져올 수 없습니다. 다시 로그인해주세요."),T(!1);return}k(`"${ue.name}" OneDrive 업로드 중...`);const lt=`${ui.graphDriveEndpoint}/root:/Google RAG/${encodeURIComponent(ue.name)}:/content`,pt=await fetch(lt,{method:"PUT",headers:{Authorization:`Bearer ${Ke}`,"Content-Type":ue.type||"application/octet-stream"},body:ue});if(!pt.ok){const jt=await pt.json().catch(()=>({}));throw new Error(((De=jt.error)==null?void 0:De.message)||`HTTP ${pt.status}`)}k(`✅ "${ue.name}" OneDrive 업로드 완료!`)}catch(Ke){console.error("Upload failed:",Ke),k(`❌ 업로드 실패: ${Ke.message}`)}finally{T(!1)}},Yt=ue=>{var Ke;const De=(Ke=ue.target.files)==null?void 0:Ke[0];De&&Gr(De),ue.target.value=""},vr=ue=>{var Ke;const De=(Ke=ue.target.files)==null?void 0:Ke[0];De&&Le(De),ue.target.value=""},zn=ue=>{ue.key==="Enter"&&!ue.shiftKey&&(ue.preventDefault(),Te())};return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"12px 20px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx(No,{size:24,style:{color:"#3b82f6"}}),r.jsxs("div",{children:[r.jsx("h1",{style:{margin:0,fontSize:18,fontWeight:700,color:"#111827"},children:"Google RAG Chat"}),r.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:12},children:"Gemini 기반 문서 RAG 채팅"})]})]}),r.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e&&r.jsx("span",{style:{fontSize:11,color:"#22c55e",background:"#f0fdf4",padding:"4px 8px",borderRadius:4},children:"세션 활성화"}),r.jsxs("button",{onClick:je,style:{display:"flex",alignItems:"center",gap:4,padding:"6px 12px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:6,fontSize:12,fontWeight:500,cursor:"pointer"},children:[r.jsx(mr,{size:14}),"새 대화"]}),r.jsxs("button",{onClick:()=>x(!y),style:{display:"flex",alignItems:"center",gap:4,padding:"6px 12px",background:y?"#dbeafe":"#fff",color:"#374151",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,fontWeight:500,cursor:"pointer"},children:[r.jsx(Fh,{size:14}),"문서 (",b.length,")"]}),r.jsxs("button",{onClick:()=>q(!H),style:{display:"flex",alignItems:"center",gap:4,padding:"6px 12px",background:H?"#fef3c7":"#fff",color:"#374151",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,fontWeight:500,cursor:"pointer"},children:[r.jsx(ei,{size:14}),"Store (",P.length,")"]}),Y&&r.jsxs(r.Fragment,{children:[r.jsxs("button",{onClick:()=>{var ue;return(ue=O.current)==null?void 0:ue.click()},disabled:B,style:{display:"flex",alignItems:"center",gap:4,padding:"6px 12px",background:"#f59e0b",color:"#fff",border:"none",borderRadius:6,fontSize:12,fontWeight:500,cursor:"pointer"},children:[r.jsx(Tg,{size:14}),B?"업로드 중...":"Store 업로드"]}),r.jsx("input",{ref:O,type:"file",onChange:ht,style:{display:"none"}})]}),r.jsxs("button",{onClick:()=>{var ue;return(ue=I.current)==null?void 0:ue.click()},disabled:v,style:{display:"flex",alignItems:"center",gap:4,padding:"6px 12px",background:"#10b981",color:"#fff",border:"none",borderRadius:6,fontSize:12,fontWeight:500,cursor:"pointer"},children:[r.jsx(Tg,{size:14}),v?"업로드 중...":"RAG 문서"]}),r.jsx("input",{ref:I,type:"file",onChange:vr,style:{display:"none"}}),C.length>0?r.jsxs(r.Fragment,{children:[r.jsxs("span",{style:{fontSize:11,color:"#6b7280",display:"flex",alignItems:"center",gap:2},children:[r.jsx(uc,{size:12}),(Zn=C[0].username)==null?void 0:Zn.split("@")[0]]}),r.jsxs("button",{onClick:En,disabled:J||!!de,style:{display:"flex",alignItems:"center",gap:4,padding:"6px 12px",background:K?"#e0f2fe":"#0ea5e9",color:K?"#0284c7":"#fff",border:K?"1px solid #0ea5e9":"none",borderRadius:6,fontSize:12,fontWeight:500,cursor:"pointer"},children:[r.jsx(WN,{size:14}),de?`${de.current}/${de.total}`:"OneDrive 폴더"]}),r.jsxs("button",{onClick:()=>{var ue;return(ue=_.current)==null?void 0:ue.click()},disabled:D,style:{display:"flex",alignItems:"center",gap:4,padding:"6px 12px",background:"#0078d4",color:"#fff",border:"none",borderRadius:6,fontSize:12,fontWeight:500,cursor:"pointer"},children:[r.jsx(Hv,{size:14}),"OneDrive"]}),r.jsx("input",{ref:_,type:"file",onChange:Yt,style:{display:"none"}}),r.jsx("button",{onClick:Ee,style:{padding:"6px 8px",background:"#fff",border:"1px solid #d1d5db",borderRadius:6,cursor:"pointer"},children:r.jsx(vN,{size:14})})]}):r.jsxs("button",{onClick:st,disabled:w!==rN.None,style:{display:"flex",alignItems:"center",gap:4,padding:"6px 12px",background:"#0078d4",color:"#fff",border:"none",borderRadius:6,fontSize:12,fontWeight:500,cursor:"pointer"},children:[r.jsx(nN,{size:14}),"MS 로그인"]}),r.jsx("button",{onClick:()=>window.open("https://tntintl1-my.sharepoint.com/","_blank"),style:{padding:"6px 8px",background:"#fff",border:"1px solid #d1d5db",borderRadius:6,cursor:"pointer"},children:r.jsx(Uv,{size:14})})]})]}),S&&r.jsxs("div",{style:{marginTop:8,padding:"8px 12px",borderRadius:6,fontSize:12,background:S.includes("✅")?"#f0fdf4":S.includes("❌")?"#fef2f2":"#eff6ff",color:S.includes("✅")?"#166534":S.includes("❌")?"#991b1b":"#1e40af",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[S,r.jsx("button",{onClick:()=>k(null),style:{background:"none",border:"none",cursor:"pointer",padding:2},children:r.jsx(On,{size:14})})]})]}),r.jsxs("div",{style:{flex:1,display:"flex",overflow:"hidden"},children:[y&&r.jsxs("div",{style:{width:280,borderRight:"1px solid #e5e7eb",background:"#fff",overflow:"auto",padding:12},children:[r.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#374151",marginBottom:12},children:"업로드된 문서"}),b.length===0?r.jsxs("div",{style:{color:"#9ca3af",fontSize:12,textAlign:"center",padding:20},children:[r.jsx(nr,{size:32,style:{margin:"0 auto 8px",color:"#d1d5db"}}),"문서가 없습니다"]}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:b.map(ue=>r.jsxs("div",{style:{padding:10,background:"#f9fafb",borderRadius:6,border:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,flex:1,minWidth:0},children:[r.jsx(nr,{size:14,style:{color:"#6b7280",flexShrink:0}}),r.jsx("span",{style:{fontSize:12,fontWeight:500,color:"#374151",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:ue.fileName})]}),r.jsx("button",{onClick:()=>ke(ue.id),style:{background:"none",border:"none",cursor:"pointer",padding:4,color:"#ef4444"},children:r.jsx(la,{size:12})})]}),r.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:[(ue.contentLength/1024).toFixed(1)," KB"]})]},ue.id))})]}),H&&r.jsxs("div",{style:{width:320,borderRight:"1px solid #e5e7eb",background:"#fffbeb",overflow:"auto",padding:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[r.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#374151"},children:"Google FileSearchStore"}),r.jsx("button",{onClick:V,style:{padding:4,background:"#fff",border:"1px solid #d1d5db",borderRadius:4,cursor:"pointer"},title:"새로고침",children:r.jsx(ln,{size:12})})]}),r.jsxs("div",{style:{display:"flex",gap:4,marginBottom:12},children:[r.jsx("input",{type:"text",value:Z,onChange:ue=>ee(ue.target.value),placeholder:"새 스토어 이름 입력",style:{flex:1,padding:"6px 10px",border:"1px solid #d1d5db",borderRadius:4,fontSize:12,background:"#fff"},onKeyDown:ue=>ue.key==="Enter"&&Pe()}),r.jsxs("button",{onClick:Pe,disabled:M||!Z.trim(),style:{padding:"6px 10px",background:M||!Z.trim()?"#d1d5db":"#f59e0b",color:"#fff",border:"none",borderRadius:4,fontSize:11,cursor:"pointer",display:"flex",alignItems:"center",gap:4,whiteSpace:"nowrap"},children:[r.jsx(mr,{size:12}),M?"생성 중...":"생성"]})]}),Y&&r.jsxs("div",{style:{padding:8,background:"#fef3c7",borderRadius:6,border:"1px solid #fcd34d",marginBottom:12,fontSize:11},children:[r.jsx("div",{style:{fontWeight:600,color:"#92400e",marginBottom:2},children:"현재 선택된 Store:"}),r.jsx("div",{style:{color:"#78350f",wordBreak:"break-all"},children:Y.split("/").pop()})]}),P.length===0?r.jsxs("div",{style:{color:"#9ca3af",fontSize:12,textAlign:"center",padding:20},children:[r.jsx(ei,{size:32,style:{margin:"0 auto 8px",color:"#d1d5db"}}),"Store가 없습니다.",r.jsx("br",{}),r.jsx("span",{style:{fontSize:11},children:"Store 생성 버튼을 클릭하세요."})]}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:P.map(ue=>r.jsxs("div",{style:{padding:10,background:ue.name===Y?"#fef3c7":"#fff",borderRadius:6,border:ue.name===Y?"2px solid #f59e0b":"1px solid #e5e7eb",cursor:"pointer"},onClick:()=>Ve(ue.name),children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,flex:1,minWidth:0},children:[r.jsx(ei,{size:14,style:{color:ue.name===Y?"#f59e0b":"#6b7280",flexShrink:0}}),r.jsx("span",{style:{fontSize:12,fontWeight:500,color:"#374151",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:ue.displayName})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[ue.name===Y&&r.jsx(dc,{size:14,style:{color:"#f59e0b",flexShrink:0}}),r.jsx("button",{onClick:De=>{De.stopPropagation(),tt(ue.name,ue.displayName)},disabled:M,style:{padding:4,background:"none",border:"none",cursor:"pointer",color:"#ef4444",opacity:M?.5:1},title:"스토어 삭제",children:r.jsx(la,{size:14})})]})]}),r.jsx("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:new Date(ue.createTime).toLocaleDateString("ko-KR")})]},ue.name))}),Y&&r.jsxs("button",{onClick:vt,style:{marginTop:12,width:"100%",padding:"8px 12px",background:"#3b82f6",color:"#fff",border:"none",borderRadius:6,fontSize:12,fontWeight:500,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[r.jsx(nr,{size:14}),"Store 문서 조회"]}),W&&te.length>0&&r.jsxs("div",{style:{marginTop:12,padding:10,background:"#fff",borderRadius:6,border:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsxs("span",{style:{fontSize:12,fontWeight:600,color:"#374151"},children:["문서 목록 (",te.length,")"]}),r.jsx("button",{onClick:()=>U(!1),style:{background:"none",border:"none",cursor:"pointer",padding:2},children:r.jsx(On,{size:12})})]}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:te.map((ue,De)=>r.jsxs("div",{style:{padding:8,background:"#f9fafb",borderRadius:4,fontSize:11},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[r.jsx("div",{style:{fontWeight:500,color:"#374151",wordBreak:"break-all",flex:1},children:ue.displayName}),r.jsx("button",{onClick:()=>Se(ue.name,ue.displayName),style:{padding:4,background:"none",border:"none",cursor:"pointer",color:"#ef4444",flexShrink:0,marginLeft:4},title:"문서 삭제 (벡터 임베딩 포함)",children:r.jsx(la,{size:12})})]}),r.jsxs("div",{style:{color:"#6b7280",marginTop:2},children:[ue.mimeType," | ",(parseInt(ue.sizeBytes)/1024).toFixed(1)," KB"]}),r.jsx("div",{style:{display:"flex",alignItems:"center",gap:4,marginTop:2},children:r.jsx("span",{style:{padding:"1px 6px",borderRadius:3,fontSize:10,background:ue.state==="STATE_ACTIVE"?"#dcfce7":"#fef3c7",color:ue.state==="STATE_ACTIVE"?"#166534":"#92400e"},children:ue.state==="STATE_ACTIVE"?"활성":ue.state})})]},De))})]}),r.jsxs("div",{style:{marginTop:16,padding:10,background:"#fff",borderRadius:6,border:"1px solid #e5e7eb",fontSize:11,color:"#6b7280"},children:[r.jsx("strong",{children:"사용법:"}),r.jsx("br",{}),"1. Store 생성 버튼 클릭",r.jsx("br",{}),"2. Store 선택 (클릭)",r.jsx("br",{}),'3. 상단 "Store 업로드" 버튼으로 파일 업로드',r.jsx("br",{}),'4. "Store 문서 조회"로 업로드된 파일 확인']})]}),K&&r.jsxs("div",{style:{width:360,borderRight:"1px solid #e5e7eb",background:"#f0f9ff",overflow:"auto",padding:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[r.jsx("div",{style:{fontSize:13,fontWeight:600,color:"#0369a1"},children:"OneDrive 폴더"}),r.jsx("button",{onClick:()=>ne(!1),style:{padding:4,background:"#fff",border:"1px solid #d1d5db",borderRadius:4,cursor:"pointer"},children:r.jsx(On,{size:12})})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,marginBottom:12,padding:8,background:"#fff",borderRadius:6,border:"1px solid #e0f2fe",fontSize:11,flexWrap:"wrap"},children:[r.jsx("button",{onClick:()=>St(-1),style:{padding:"2px 8px",background:ae.length===0?"#0ea5e9":"#e0f2fe",color:ae.length===0?"#fff":"#0369a1",border:"none",borderRadius:4,cursor:"pointer",fontWeight:500},children:"Root"}),ae.map((ue,De)=>r.jsxs(Be.Fragment,{children:[r.jsx(Ii,{size:12,style:{color:"#94a3b8"}}),r.jsx("button",{onClick:()=>St(De),style:{padding:"2px 8px",background:De===ae.length-1?"#0ea5e9":"#e0f2fe",color:De===ae.length-1?"#fff":"#0369a1",border:"none",borderRadius:4,cursor:"pointer",fontWeight:500},children:ue.name})]},ue.id))]}),!Y&&r.jsx("div",{style:{padding:8,background:"#fef2f2",borderRadius:6,border:"1px solid #fecaca",marginBottom:12,fontSize:11,color:"#991b1b"},children:"RAG Store를 먼저 선택해주세요"}),de&&r.jsxs("div",{style:{padding:10,background:"#fff",borderRadius:6,border:"1px solid #0ea5e9",marginBottom:12},children:[r.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#0369a1",marginBottom:6},children:["업로드 진행 중... (",de.current,"/",de.total,")"]}),r.jsx("div",{style:{height:6,background:"#e0f2fe",borderRadius:3,overflow:"hidden",marginBottom:6},children:r.jsx("div",{style:{width:`${de.current/de.total*100}%`,height:"100%",background:"#0ea5e9",transition:"width 0.3s"}})}),de.currentFile&&r.jsxs("div",{style:{fontSize:10,color:"#6b7280",wordBreak:"break-all"},children:["현재: ",de.currentFile]}),de.completed.length>0&&r.jsxs("div",{style:{fontSize:10,color:"#16a34a",marginTop:4},children:["완료: ",de.completed.length,"개"]}),de.failed.length>0&&r.jsxs("div",{style:{fontSize:10,color:"#dc2626",marginTop:2},children:["실패: ",de.failed.join(", ")]})]}),Y&&pe.filter(ue=>ue.file).length>0&&!de&&r.jsxs("button",{onClick:Ot,style:{width:"100%",padding:"10px 12px",marginBottom:12,background:"#0ea5e9",color:"#fff",border:"none",borderRadius:6,fontSize:12,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8},children:[r.jsx(pa,{size:14}),"모든 파일을 RAG Store로 업로드 (",pe.filter(ue=>ue.file).length,"개)"]}),J?r.jsxs("div",{style:{textAlign:"center",padding:20,color:"#6b7280"},children:[r.jsx(Ei,{size:24,style:{animation:"spin 1s linear infinite",margin:"0 auto 8px"}}),r.jsx("div",{style:{fontSize:12},children:"로딩 중..."})]}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:pe.length===0?r.jsxs("div",{style:{color:"#9ca3af",fontSize:12,textAlign:"center",padding:20},children:[r.jsx(_g,{size:32,style:{margin:"0 auto 8px",color:"#d1d5db"}}),"이 폴더는 비어 있습니다"]}):r.jsxs(r.Fragment,{children:[pe.filter(ue=>ue.folder).map(ue=>{var De;return r.jsxs("div",{onClick:()=>Nt(ue),style:{padding:10,background:"#fff",borderRadius:6,border:"1px solid #e0f2fe",cursor:"pointer",display:"flex",alignItems:"center",gap:8},children:[r.jsx(_g,{size:18,style:{color:"#0ea5e9",flexShrink:0}}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsx("div",{style:{fontSize:12,fontWeight:500,color:"#374151",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:ue.name}),r.jsxs("div",{style:{fontSize:10,color:"#9ca3af"},children:[((De=ue.folder)==null?void 0:De.childCount)||0,"개 항목"]})]}),r.jsx(Ii,{size:14,style:{color:"#94a3b8",flexShrink:0}})]},ue.id)}),pe.filter(ue=>ue.file).map(ue=>r.jsxs("div",{style:{padding:10,background:"#fff",borderRadius:6,border:"1px solid #e5e7eb",display:"flex",alignItems:"center",gap:8},children:[r.jsx(nr,{size:18,style:{color:"#6b7280",flexShrink:0}}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsx("div",{style:{fontSize:12,fontWeight:500,color:"#374151",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:ue.name}),r.jsx("div",{style:{fontSize:10,color:"#9ca3af"},children:ue.size?`${(ue.size/1024).toFixed(1)} KB`:""})]})]},ue.id))]})}),r.jsxs("div",{style:{marginTop:16,padding:10,background:"#fff",borderRadius:6,border:"1px solid #e5e7eb",fontSize:11,color:"#6b7280"},children:[r.jsx("strong",{children:"사용법:"}),r.jsx("br",{}),"1. 원하는 폴더로 이동",r.jsx("br",{}),'2. "모든 파일을 RAG Store로 업로드" 클릭',r.jsx("br",{}),"3. 업로드 완료된 파일은 자동으로 Archive 폴더로 이동됩니다"]})]}),r.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden"},children:[r.jsx("div",{style:{flex:1,overflow:"auto",padding:20},children:i.length===0&&!d?r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#9ca3af"},children:[r.jsx(go,{size:64,style:{marginBottom:16,color:"#d1d5db"}}),r.jsx("div",{style:{fontSize:16,fontWeight:500,marginBottom:8},children:"Google RAG Chat"}),r.jsxs("div",{style:{fontSize:13,textAlign:"center",maxWidth:400},children:["문서를 업로드하고 질문하세요.",r.jsx("br",{}),"Gemini AI가 문서 내용을 기반으로 답변합니다."]}),r.jsx("div",{style:{marginTop:24,display:"flex",gap:8,flexWrap:"wrap",justifyContent:"center"},children:["영업 전략은?","고객 분석 방법","매출 향상 방안"].map((ue,De)=>r.jsx("button",{onClick:()=>o(ue),style:{padding:"8px 16px",background:"#fff",border:"1px solid #e5e7eb",borderRadius:20,fontSize:13,color:"#374151",cursor:"pointer"},children:ue},De))})]}):r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[i.map((ue,De)=>r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[r.jsx("div",{style:{width:32,height:32,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:ue.role==="user"?"#3b82f6":"#10b981",color:"#fff",flexShrink:0},children:ue.role==="user"?r.jsx(CN,{size:18}):r.jsx(go,{size:18})}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:4},children:ue.role==="user"?"나":"Gemini"}),r.jsx("div",{style:{padding:12,borderRadius:12,fontSize:14,lineHeight:1.6,background:ue.role==="user"?"#eff6ff":"#f9fafb",color:"#1f2937",whiteSpace:"pre-wrap",wordBreak:"break-word"},children:ue.content}),ue.role==="assistant"&&r.jsxs(r.Fragment,{children:[ue.citations&&ue.citations.length>0&&r.jsxs("div",{style:{marginTop:8,padding:10,background:"#f0f9ff",borderRadius:8,border:"1px solid #bae6fd"},children:[r.jsxs("div",{style:{fontSize:11,fontWeight:600,color:"#0369a1",marginBottom:6,display:"flex",alignItems:"center",gap:4},children:[r.jsx(nr,{size:12}),"출처 (",ue.citations.length,")"]}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4},children:ue.citations.map((Ke,lt)=>r.jsxs("div",{style:{fontSize:11,color:"#0c4a6e",padding:"4px 8px",background:"#e0f2fe",borderRadius:4,display:"flex",alignItems:"center",gap:6},children:[r.jsxs("span",{style:{fontWeight:500},children:["[",lt+1,"]"]}),r.jsx("span",{style:{wordBreak:"break-all"},children:Ke.title})]},lt))})]}),r.jsxs("button",{onClick:()=>Ue(ue.content,De),style:{marginTop:4,padding:"4px 8px",background:"none",border:"none",color:"#9ca3af",fontSize:11,cursor:"pointer",display:"flex",alignItems:"center",gap:4},children:[m===De?r.jsx(rs,{size:12}):r.jsx(Uh,{size:12}),m===De?"복사됨":"복사"]})]})]})]},De)),d&&r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-start"},children:[r.jsx("div",{style:{width:32,height:32,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"#10b981",color:"#fff",flexShrink:0},children:r.jsx(go,{size:18})}),r.jsxs("div",{style:{flex:1},children:[r.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:4},children:"Gemini"}),r.jsxs("div",{style:{padding:12,borderRadius:12,fontSize:14,lineHeight:1.6,background:"#f9fafb",color:"#1f2937",whiteSpace:"pre-wrap"},children:[d,r.jsx("span",{style:{animation:"blink 1s infinite"},children:"|"})]})]})]}),r.jsx("div",{ref:E})]})}),f&&r.jsxs("div",{style:{margin:"0 20px",padding:12,background:"#fef2f2",borderRadius:8,display:"flex",alignItems:"center",gap:8},children:[r.jsx(Ti,{size:16,style:{color:"#ef4444"}}),r.jsx("span",{style:{color:"#991b1b",fontSize:13},children:f}),r.jsx("button",{onClick:()=>h(null),style:{marginLeft:"auto",background:"none",border:"none",cursor:"pointer"},children:r.jsx(On,{size:14})})]}),r.jsxs("div",{style:{padding:16,borderTop:"1px solid #e5e7eb",background:"#fff"},children:[r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-end"},children:[r.jsx("textarea",{value:a,onChange:ue=>o(ue.target.value),onKeyDown:zn,placeholder:"메시지를 입력하세요... (Enter로 전송, Shift+Enter로 줄바꿈)",disabled:l,rows:1,style:{flex:1,padding:"12px 16px",border:"1px solid #d1d5db",borderRadius:12,fontSize:14,resize:"none",minHeight:44,maxHeight:120,background:l?"#f9fafb":"#fff",color:"#1f2937"}}),r.jsx("button",{onClick:Te,disabled:l||!a.trim(),style:{width:44,height:44,borderRadius:"50%",border:"none",background:l||!a.trim()?"#d1d5db":"#3b82f6",color:"#fff",cursor:l||!a.trim()?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:l?r.jsx(Ei,{size:20,style:{animation:"spin 1s linear infinite"}}):r.jsx(qv,{size:20})})]}),r.jsx("div",{style:{marginTop:8,fontSize:11,color:"#9ca3af",textAlign:"center"},children:e?"멀티턴 대화 모드 (이전 대화 맥락 유지)":"일반 RAG 모드 (새 대화 버튼으로 멀티턴 시작)"})]})]})]}),r.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        @keyframes blink {
          0%, 50% { opacity: 1; }
          51%, 100% { opacity: 0; }
        }
      `})]})}function SY(){const[e,n]=p.useState(""),[i,s]=p.useState([]),[a,o]=p.useState(""),[l,c]=p.useState([]),[d,u]=p.useState(""),[f,h]=p.useState(!1),[m,g]=p.useState(""),[b,j]=p.useState(null),y=p.useRef(null);p.useEffect(()=>{x()},[]),p.useEffect(()=>{const w=_=>{_.detail.storeName&&(n(_.detail.storeName),s(_.detail.documents||[]),o(_.detail.displayName||_.detail.storeName.split("/").pop()||""))};return window.addEventListener("tnt.chat.store.changed",w),()=>window.removeEventListener("tnt.chat.store.changed",w)},[]),p.useEffect(()=>{var w;(w=y.current)==null||w.scrollIntoView({behavior:"smooth"})},[l,m]);const x=async()=>{var w;try{const I=await(await fetch("/api/v1/rag/stores")).json();if(I.currentStore){n(I.currentStore);const O=(w=I.stores)==null?void 0:w.find(k=>k.name===I.currentStore);o((O==null?void 0:O.displayName)||I.currentStore.split("/").pop()||"");const S=await(await fetch("/api/v1/rag/store/documents")).json();S.documents&&s(S.documents)}}catch(_){console.error("Failed to fetch store info:",_)}},v=async()=>{if(!d.trim()||f||!e)return;const w=d.trim();u(""),h(!0),g(""),c(_=>[..._,{role:"user",content:w,timestamp:new Date}]);try{const _=`/api/v1/rag/query/stream?question=${encodeURIComponent(w)}`,I=new EventSource(_);let O="",E=[];I.addEventListener("content",S=>{O+=S.data,g(O)}),I.addEventListener("citations",S=>{try{E=JSON.parse(S.data)}catch{}}),I.addEventListener("done",()=>{I.close(),c(S=>[...S,{role:"assistant",content:O,timestamp:new Date,citations:E.length>0?E:void 0}]),g(""),h(!1)}),I.addEventListener("error",S=>{I.close(),h(!1)}),I.onerror=()=>{I.close(),O&&c(S=>[...S,{role:"assistant",content:O,timestamp:new Date}]),g(""),h(!1)}}catch{h(!1)}},A=(w,_)=>{navigator.clipboard.writeText(w),j(_),setTimeout(()=>j(null),2e3)},N=w=>{w.key==="Enter"&&!w.shiftKey&&(w.preventDefault(),v())},C=()=>{c([]),g("")};return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%)"},children:[r.jsxs("div",{style:{padding:"16px 24px",background:"linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%)",color:"#fff",display:"flex",alignItems:"center",gap:16,boxShadow:"0 4px 20px rgba(0,0,0,0.15)",position:"relative",overflow:"hidden"},children:[r.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"radial-gradient(circle at 20% 50%, rgba(59,130,246,0.15) 0%, transparent 50%), radial-gradient(circle at 80% 50%, rgba(168,85,247,0.1) 0%, transparent 50%)",pointerEvents:"none"}}),r.jsx("div",{style:{width:48,height:48,borderRadius:14,background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(59,130,246,0.4)",position:"relative"},children:r.jsx(Nf,{size:24,strokeWidth:2.5})}),r.jsxs("div",{style:{flex:1,position:"relative"},children:[r.jsx("h1",{style:{margin:0,fontSize:20,fontWeight:700,letterSpacing:"-0.02em"},children:"대화해~~TNT"}),r.jsx("p",{style:{margin:"2px 0 0",fontSize:12,opacity:.7,fontWeight:400},children:"AI-Powered RAG Assistant"})]}),e&&r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"10px 16px",background:"rgba(255,255,255,0.1)",backdropFilter:"blur(10px)",borderRadius:10,border:"1px solid rgba(255,255,255,0.1)",fontSize:13,fontWeight:500,position:"relative"},children:[r.jsx(ei,{size:16,style:{opacity:.8}}),r.jsx("span",{style:{maxWidth:150,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:a})]})]}),r.jsx("div",{style:{flex:1,overflow:"auto",padding:"24px 20px",background:"linear-gradient(180deg, #ffffff 0%, #f8fafc 100%)"},children:e?l.length===0&&!m?r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[r.jsx("div",{style:{width:100,height:100,borderRadius:28,background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:28,boxShadow:"0 12px 32px rgba(59,130,246,0.3)",animation:"float 3s ease-in-out infinite"},children:r.jsx(bN,{size:48,style:{color:"#fff"}})}),r.jsx("div",{style:{fontSize:22,fontWeight:700,marginBottom:10,color:"#1e293b",letterSpacing:"-0.02em"},children:"무엇이든 물어보세요"}),r.jsxs("div",{style:{fontSize:14,textAlign:"center",maxWidth:380,marginBottom:32,lineHeight:1.7,color:"#64748b"},children:[r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:6,padding:"4px 12px",background:"#eff6ff",borderRadius:6,color:"#3b82f6",fontWeight:600},children:[r.jsx(ei,{size:14})," ",a]}),r.jsx("span",{style:{marginLeft:6},children:"스토어의"}),r.jsx("br",{}),r.jsxs("span",{style:{color:"#475569",fontWeight:500},children:[i.length,"개 문서"]}),"를 기반으로 AI가 답변합니다."]}),r.jsx("div",{style:{display:"flex",gap:10,flexWrap:"wrap",justifyContent:"center",maxWidth:500},children:["문서 내용을 요약해줘","핵심 정보가 뭐야?","주요 인사이트 알려줘"].map((w,_)=>r.jsx("button",{onClick:()=>u(w),style:{padding:"12px 20px",background:"#fff",border:"1px solid #e2e8f0",borderRadius:12,fontSize:13,color:"#475569",cursor:"pointer",transition:"all 0.2s",boxShadow:"0 2px 8px rgba(0,0,0,0.04)",fontWeight:500},onMouseEnter:I=>{I.currentTarget.style.borderColor="#3b82f6",I.currentTarget.style.background="#eff6ff",I.currentTarget.style.color="#3b82f6"},onMouseLeave:I=>{I.currentTarget.style.borderColor="#e2e8f0",I.currentTarget.style.background="#fff",I.currentTarget.style.color="#475569"},children:w},_))})]}):r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[l.map((w,_)=>r.jsxs("div",{style:{display:"flex",gap:14,alignItems:"flex-start",animation:"fadeIn 0.3s ease-out"},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center",background:w.role==="user"?"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)":"linear-gradient(135deg, #0ea5e9 0%, #3b82f6 100%)",boxShadow:w.role==="user"?"0 4px 12px rgba(99,102,241,0.3)":"0 4px 12px rgba(59,130,246,0.3)",flexShrink:0},children:w.role==="user"?r.jsx(uc,{size:20,style:{color:"#fff"}}):r.jsx(go,{size:20,style:{color:"#fff"}})}),r.jsxs("div",{style:{flex:1,minWidth:0},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[r.jsx("span",{style:{fontSize:13,fontWeight:600,color:w.role==="user"?"#6366f1":"#0ea5e9"},children:w.role==="user"?"나":"TNT AI"}),r.jsx("span",{style:{fontSize:11,color:"#94a3b8"},children:w.timestamp.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"})})]}),r.jsx("div",{style:{padding:"16px 20px",borderRadius:w.role==="user"?"18px 18px 4px 18px":"18px 18px 18px 4px",fontSize:14,lineHeight:1.8,background:w.role==="user"?"linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%)":"#fff",color:"#1e293b",boxShadow:w.role==="user"?"inset 0 0 0 1px #e2e8f0":"0 2px 12px rgba(0,0,0,0.06), inset 0 0 0 1px rgba(59,130,246,0.1)",position:"relative"},className:w.role==="assistant"?"assistant-message":"",dangerouslySetInnerHTML:w.role==="assistant"?{__html:w.content}:void 0,children:w.role==="user"?w.content:null}),w.role==="assistant"&&w.citations&&w.citations.length>0&&r.jsxs("div",{style:{marginTop:12,padding:"12px 16px",background:"linear-gradient(135deg, #f0f9ff 0%, #eff6ff 100%)",borderRadius:12,border:"1px solid rgba(59,130,246,0.15)"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12,fontWeight:600,color:"#3b82f6",marginBottom:10},children:[r.jsx(nr,{size:14})," 참조 문서"]}),r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:w.citations.map((I,O)=>r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:12,color:"#475569",padding:"6px 10px",background:"#fff",borderRadius:6,border:"1px solid #e2e8f0"},children:[r.jsx("span",{style:{width:20,height:20,borderRadius:5,background:"#3b82f6",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontSize:10,fontWeight:700,flexShrink:0},children:O+1}),r.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:I.title})]},O))})]}),w.role==="assistant"&&r.jsx("div",{style:{marginTop:10,display:"flex",gap:6},children:r.jsxs("button",{onClick:()=>A(w.content,_),style:{padding:"6px 12px",background:b===_?"#dcfce7":"#f8fafc",border:b===_?"1px solid #86efac":"1px solid #e2e8f0",borderRadius:8,color:b===_?"#16a34a":"#64748b",fontSize:12,cursor:"pointer",display:"inline-flex",alignItems:"center",gap:5,transition:"all 0.2s",fontWeight:500},children:[b===_?r.jsx(rs,{size:13}):r.jsx(Uh,{size:13}),b===_?"복사됨":"복사"]})})]})]},_)),m&&r.jsxs("div",{style:{display:"flex",gap:14,alignItems:"flex-start",animation:"fadeIn 0.3s ease-out"},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:12,display:"flex",alignItems:"center",justifyContent:"center",background:"linear-gradient(135deg, #0ea5e9 0%, #3b82f6 100%)",boxShadow:"0 4px 12px rgba(59,130,246,0.3)",flexShrink:0,animation:"pulse 2s ease-in-out infinite"},children:r.jsx(go,{size:20,style:{color:"#fff"}})}),r.jsxs("div",{style:{flex:1},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[r.jsx("span",{style:{fontSize:13,fontWeight:600,color:"#0ea5e9"},children:"TNT AI"}),r.jsxs("span",{style:{fontSize:11,color:"#3b82f6",display:"flex",alignItems:"center",gap:4},children:[r.jsx(Ei,{size:12,style:{animation:"spin 1s linear infinite"}}),"응답 중..."]})]}),r.jsx("div",{style:{padding:"16px 20px",borderRadius:"18px 18px 18px 4px",fontSize:14,lineHeight:1.8,background:"#fff",color:"#1e293b",boxShadow:"0 2px 12px rgba(0,0,0,0.06), inset 0 0 0 1px rgba(59,130,246,0.1)"},className:"assistant-message",dangerouslySetInnerHTML:{__html:m+'<span class="typing-cursor"></span>'}})]})]}),r.jsx("div",{ref:y})]}):r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",color:"#9ca3af"},children:[r.jsx("div",{style:{width:100,height:100,borderRadius:24,background:"linear-gradient(135deg, #e2e8f0 0%, #f1f5f9 100%)",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:24,boxShadow:"0 8px 24px rgba(0,0,0,0.06)"},children:r.jsx(ei,{size:48,style:{color:"#94a3b8"}})}),r.jsx("div",{style:{fontSize:18,fontWeight:600,marginBottom:8,color:"#475569"},children:"스토어를 선택하세요"}),r.jsxs("div",{style:{fontSize:14,textAlign:"center",color:"#94a3b8",lineHeight:1.6},children:["우측 패널에서 RAG 스토어를",r.jsx("br",{}),"선택하거나 생성하세요."]})]})}),r.jsxs("div",{style:{padding:"16px 20px 20px",background:"linear-gradient(180deg, rgba(248,250,252,0) 0%, #f8fafc 20%)",borderTop:"none"},children:[r.jsxs("div",{style:{display:"flex",gap:12,alignItems:"flex-end",padding:8,background:"#fff",borderRadius:20,boxShadow:"0 4px 24px rgba(0,0,0,0.08), 0 0 0 1px rgba(0,0,0,0.04)",transition:"box-shadow 0.3s ease"},children:[r.jsx("textarea",{value:d,onChange:w=>u(w.target.value),onKeyDown:N,placeholder:e?"메시지를 입력하세요...":"먼저 스토어를 선택하세요",disabled:f||!e,rows:1,style:{flex:1,padding:"12px 16px",border:"none",borderRadius:14,fontSize:14,resize:"none",minHeight:44,maxHeight:120,background:"transparent",outline:"none",lineHeight:1.5,color:"#1e293b"}}),r.jsx("button",{onClick:v,disabled:f||!d.trim()||!e,style:{width:48,height:48,borderRadius:14,border:"none",background:f||!d.trim()||!e?"#e2e8f0":"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",color:"#fff",cursor:f||!d.trim()||!e?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.2s",boxShadow:f||!d.trim()||!e?"none":"0 4px 12px rgba(59,130,246,0.3)",flexShrink:0},children:f?r.jsx(Ei,{size:20,style:{animation:"spin 1s linear infinite"}}):r.jsx(qv,{size:18})})]}),e&&r.jsxs("div",{style:{marginTop:12,paddingX:8,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,fontSize:12,color:"#64748b"},children:[r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:5,padding:"4px 10px",background:"#f1f5f9",borderRadius:6},children:[r.jsx(ei,{size:12,style:{color:"#3b82f6"}}),a]}),r.jsx("span",{style:{color:"#94a3b8"},children:"|"}),r.jsxs("span",{children:[i.length,"개 문서"]})]}),l.length>0&&r.jsx("button",{onClick:C,style:{fontSize:12,color:"#94a3b8",background:"none",border:"none",cursor:"pointer",padding:"4px 8px",borderRadius:4,transition:"all 0.2s"},onMouseEnter:w=>{w.currentTarget.style.background="#fee2e2",w.currentTarget.style.color="#ef4444"},onMouseLeave:w=>{w.currentTarget.style.background="none",w.currentTarget.style.color="#94a3b8"},children:"대화 초기화"})]})]}),r.jsx("style",{children:`
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes blink { 0%, 50% { opacity: 1; } 51%, 100% { opacity: 0; } }
        @keyframes float {
          0%, 100% { transform: translateY(0px); }
          50% { transform: translateY(-8px); }
        }
        @keyframes fadeIn {
          from { opacity: 0; transform: translateY(10px); }
          to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse {
          0%, 100% { opacity: 1; }
          50% { opacity: 0.7; }
        }
        textarea::placeholder { color: #94a3b8; }
        textarea:focus { outline: none; }

        /* Assistant message HTML styles */
        .assistant-message table {
          width: 100%;
          border-collapse: collapse;
          margin: 12px 0;
          font-size: 13px;
          border-radius: 8px;
          overflow: hidden;
          box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .assistant-message th {
          background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
          color: white;
          font-weight: 600;
          padding: 10px 12px;
          text-align: left;
          border: none;
        }
        .assistant-message td {
          padding: 10px 12px;
          border-bottom: 1px solid #e2e8f0;
          background: #fff;
        }
        .assistant-message tr:last-child td {
          border-bottom: none;
        }
        .assistant-message tr:hover td {
          background: #f8fafc;
        }
        .assistant-message ul, .assistant-message ol {
          margin: 8px 0;
          padding-left: 20px;
        }
        .assistant-message li {
          margin: 6px 0;
          line-height: 1.6;
        }
        .assistant-message strong, .assistant-message b {
          color: #1e40af;
          font-weight: 600;
        }
        .assistant-message h3, .assistant-message h4 {
          margin: 16px 0 8px;
          color: #1e293b;
          font-weight: 700;
        }
        .assistant-message h3 { font-size: 16px; }
        .assistant-message h4 { font-size: 14px; }
        .assistant-message code {
          background: #f1f5f9;
          padding: 2px 6px;
          border-radius: 4px;
          font-family: 'Monaco', 'Menlo', monospace;
          font-size: 12px;
          color: #e11d48;
        }
        .assistant-message pre {
          background: #1e293b;
          color: #e2e8f0;
          padding: 12px 16px;
          border-radius: 8px;
          overflow-x: auto;
          margin: 12px 0;
        }
        .assistant-message pre code {
          background: none;
          color: inherit;
          padding: 0;
        }
        .assistant-message blockquote {
          border-left: 4px solid #3b82f6;
          margin: 12px 0;
          padding: 8px 16px;
          background: #eff6ff;
          border-radius: 0 8px 8px 0;
          color: #1e40af;
        }
        .assistant-message p {
          margin: 8px 0;
          line-height: 1.7;
        }
        .assistant-message a {
          color: #3b82f6;
          text-decoration: none;
        }
        .assistant-message a:hover {
          text-decoration: underline;
        }
        .typing-cursor {
          display: inline-block;
          width: 8px;
          height: 18px;
          background: linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%);
          border-radius: 2px;
          margin-left: 2px;
          animation: blink 1s infinite;
          vertical-align: text-bottom;
        }
      `})]})}function kY(){const[e,n]=p.useState("TNT"),[i,s]=p.useState(""),[a,o]=p.useState([]),[l,c]=p.useState(null),[d,u]=p.useState(""),[f,h]=p.useState(!1),[m,g]=p.useState(!1),[b,j]=p.useState(!1),y=async()=>{if(!i.trim()){alert("검색어를 입력하세요.");return}h(!0),o([]),c(null),u("");try{const A=await fetch(`/api/v1/erp/sp/list?company=${e}&keyword=${encodeURIComponent(i)}`);if(!A.ok)throw new Error("API 호출 실패");const N=await A.json();o(N.items||[])}catch(A){console.error("SP 목록 조회 실패:",A),alert("SP 목록 조회에 실패했습니다.")}finally{h(!1)}},x=async()=>{if(!l){alert("SP를 선택하세요.");return}g(!0),u("");try{const A=await fetch(`/api/v1/erp/sp/content?company=${e}&spName=${encodeURIComponent(l.name)}`);if(!A.ok)throw new Error("API 호출 실패");const N=await A.json();u(N.content||"")}catch(A){console.error("SP 내용 조회 실패:",A),alert("SP 내용 조회에 실패했습니다.")}finally{g(!1)}},v=async()=>{if(d)try{await navigator.clipboard.writeText(d),j(!0),setTimeout(()=>j(!1),2e3)}catch(A){console.error("복사 실패:",A),alert("복사에 실패했습니다.")}};return r.jsxs("div",{style:{padding:24,height:"100%",overflow:"auto",background:"#f8fafc"},children:[r.jsx("div",{style:{marginBottom:24},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:8},children:[r.jsx("div",{style:{width:48,height:48,borderRadius:12,background:"linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"white"},children:r.jsx(ei,{size:24})}),r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"ERP SP분석"}),r.jsx("p",{style:{fontSize:14,color:"#6b7280",margin:0},children:"ERP Stored Procedure를 검색하고 내용을 확인합니다"})]})]})}),r.jsx("div",{style:{background:"white",borderRadius:12,padding:20,marginBottom:20,border:"1px solid #e5e7eb"},children:r.jsxs("div",{style:{display:"flex",gap:16,alignItems:"flex-end",flexWrap:"wrap"},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"회사"}),r.jsxs("div",{style:{display:"flex",borderRadius:8,overflow:"hidden",border:"1px solid #e5e7eb"},children:[r.jsx("button",{onClick:()=>n("TNT"),style:{padding:"8px 16px",border:"none",background:e==="TNT"?"#3b82f6":"white",color:e==="TNT"?"white":"#374151",fontWeight:600,cursor:"pointer",fontSize:13},children:"TNT"}),r.jsx("button",{onClick:()=>n("DYS"),style:{padding:"8px 16px",border:"none",borderLeft:"1px solid #e5e7eb",background:e==="DYS"?"#10b981":"white",color:e==="DYS"?"white":"#374151",fontWeight:600,cursor:"pointer",fontSize:13},children:"DYS"})]})]}),r.jsxs("div",{style:{flex:1,minWidth:300},children:[r.jsx("label",{style:{display:"block",fontSize:12,color:"#6b7280",marginBottom:6},children:"SP명 검색"}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx(Fn,{size:16,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}}),r.jsx("input",{type:"text",placeholder:"검색할 SP명을 입력하세요...",value:i,onChange:A=>s(A.target.value),onKeyDown:A=>A.key==="Enter"&&y(),style:{width:"100%",padding:"8px 12px 8px 36px",border:"1px solid #e5e7eb",borderRadius:6,fontSize:13}})]})]}),r.jsxs("button",{onClick:y,disabled:f,style:{padding:"8px 20px",background:"#3b82f6",color:"white",border:"none",borderRadius:6,fontWeight:600,cursor:f?"not-allowed":"pointer",fontSize:13,display:"flex",alignItems:"center",gap:6,opacity:f?.7:1},children:[f&&r.jsx(ln,{size:14,className:"animate-spin"}),"SP 목록 조회"]})]})}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"350px 1fr",gap:20,height:"calc(100vh - 300px)"},children:[r.jsxs("div",{style:{background:"white",borderRadius:12,border:"1px solid #e5e7eb",display:"flex",flexDirection:"column",overflow:"hidden"},children:[r.jsx("div",{style:{padding:"16px 20px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:r.jsxs("h3",{style:{fontSize:14,fontWeight:600,color:"#111827",margin:0},children:["SP 목록 ",a.length>0&&r.jsxs("span",{style:{color:"#6b7280",fontWeight:400},children:["(",a.length,"건)"]})]})}),r.jsx("div",{style:{flex:1,overflow:"auto"},children:f?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(ln,{size:24,className:"animate-spin",style:{margin:"0 auto 12px"}}),r.jsx("p",{children:"조회 중..."})]}):a.length===0?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(ei,{size:40,strokeWidth:1}),r.jsxs("p",{style:{marginTop:12,fontSize:13},children:["검색어를 입력하고",r.jsx("br",{}),"SP 목록 조회 버튼을 클릭하세요."]})]}):r.jsx("div",{children:a.map((A,N)=>r.jsxs("div",{onClick:()=>c(A),style:{padding:"12px 16px",borderBottom:"1px solid #f3f4f6",cursor:"pointer",background:(l==null?void 0:l.name)===A.name?"#eff6ff":"transparent",transition:"background 0.15s"},onMouseEnter:C=>{(l==null?void 0:l.name)!==A.name&&(C.currentTarget.style.background="#f9fafb")},onMouseLeave:C=>{(l==null?void 0:l.name)!==A.name&&(C.currentTarget.style.background="transparent")},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx(Cg,{size:16,color:(l==null?void 0:l.name)===A.name?"#3b82f6":"#9ca3af"}),r.jsx("span",{style:{fontSize:13,fontWeight:(l==null?void 0:l.name)===A.name?600:400,color:(l==null?void 0:l.name)===A.name?"#3b82f6":"#111827",wordBreak:"break-all"},children:A.name})]}),A.modifyDate&&r.jsxs("div",{style:{fontSize:11,color:"#9ca3af",marginTop:4,marginLeft:24},children:["수정: ",A.modifyDate]})]},N))})}),r.jsx("div",{style:{padding:16,borderTop:"1px solid #e5e7eb"},children:r.jsxs("button",{onClick:x,disabled:!l||m,style:{width:"100%",padding:"10px 16px",background:l?"#3b82f6":"#e5e7eb",color:l?"white":"#9ca3af",border:"none",borderRadius:6,fontWeight:600,cursor:l&&!m?"pointer":"not-allowed",fontSize:13,display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[m&&r.jsx(ln,{size:14,className:"animate-spin"}),"내용 조회"]})})]}),r.jsxs("div",{style:{background:"white",borderRadius:12,border:"1px solid #e5e7eb",display:"flex",flexDirection:"column",overflow:"hidden"},children:[r.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{fontSize:14,fontWeight:600,color:"#111827",margin:0},children:["SP 내용 ",l&&r.jsxs("span",{style:{color:"#3b82f6"},children:["- ",l.name]})]}),d&&r.jsxs("button",{onClick:v,style:{padding:"6px 12px",background:b?"#10b981":"#f3f4f6",color:b?"white":"#374151",border:"1px solid",borderColor:b?"#10b981":"#e5e7eb",borderRadius:6,fontSize:12,cursor:"pointer",display:"flex",alignItems:"center",gap:6,transition:"all 0.2s"},children:[b?r.jsx(rs,{size:14}):r.jsx(Uh,{size:14}),b?"복사됨!":"복사"]})]}),r.jsx("div",{style:{flex:1,overflow:"auto",padding:0},children:m?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(ln,{size:24,className:"animate-spin",style:{margin:"0 auto 12px"}}),r.jsx("p",{children:"내용 조회 중..."})]}):d?r.jsx("pre",{style:{margin:0,padding:20,fontSize:12,fontFamily:'Consolas, Monaco, "Courier New", monospace',lineHeight:1.6,whiteSpace:"pre-wrap",wordBreak:"break-word",background:"#1e293b",color:"#e2e8f0",minHeight:"100%"},children:d}):r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(Cg,{size:48,strokeWidth:1}),r.jsxs("p",{style:{marginTop:12,fontSize:13},children:["SP를 선택하고",r.jsx("br",{}),"내용 조회 버튼을 클릭하세요."]})]})})]})]})]})}function NY(){const[e,n]=p.useState([]),[i,s]=p.useState(!1),[a,o]=p.useState(null),[l,c]=p.useState([]),[d,u]=p.useState([]),[f,h]=p.useState("all"),[m,g]=p.useState("all"),[b,j]=p.useState(""),[y,x]=p.useState("all"),[v,A]=p.useState("all"),[N,C]=p.useState("latest"),[w,_]=p.useState({totalAr:0,overdueAr:0,overdueCount:0,aging30Ar:0,aging30Count:0,normalAr:0}),I=async()=>{try{const T=await fetch("/api/v1/credit/sales-reps");if(!T.ok)throw new Error(`API 호출 실패: ${T.status}`);const P=await T.json();c(P.salesReps||[])}catch(T){console.error("영업사원 목록 조회 실패:",T)}},O=async()=>{try{const T=await fetch("/api/v1/credit/snapshot-options");if(!T.ok)throw new Error(`API 호출 실패: ${T.status}`);const P=await T.json();u(P.options||[])}catch(T){console.error("채권검토일 목록 조회 실패:",T)}},E=async()=>{s(!0),o(null);try{const T=new URLSearchParams;if(f!=="all"&&T.append("company",f),m!=="all"&&T.append("salesRep",m),b&&T.append("customerName",b),y!=="all"&&T.append("riskLevel",y),v!=="all"&&T.append("agingBucket",v),N!=="latest"){const[M,L]=N.split(":");M&&M!=="null"&&M!=="undefined"&&T.append("meetingId",M),L&&T.append("snapshotDate",L)}else T.append("snapshotDate","latest");console.log("AR Aging 조회 요청:",T.toString());const P=await fetch(`/api/v1/credit/ar-aging?${T.toString()}`);if(!P.ok)throw new Error(`API 호출 실패: ${P.status}`);const R=await P.json();console.log("AR Aging 조회 응답:",R);const Y=(R.items||[]).map(M=>({customerSeq:M.customer_seq,customerCode:M.customer_no,customerName:M.customer_name,companyType:M.company_type,salesRep:M.emp_name,department:M.dept_name,totalAr:M.total_ar,overdue:M.overdue,aging030:M.aging_0_30,aging3160:M.aging_31_60,aging6190:M.aging_61_90,aging91120:M.aging_91_120,aging121150:M.aging_121_150,aging151180:M.aging_151_180,aging181210:M.aging_181_210,aging211240:M.aging_211_240,aging241270:M.aging_241_270,aging271300:M.aging_271_300,aging301330:M.aging_301_330,aging331365:M.aging_331_365,agingOver365:M.aging_over_365,riskLevel:M.riskLevel,lastCollectionDate:M.last_collection_date}));n(Y);const X=Y.filter(M=>M.riskLevel==="high"),H=Y.filter(M=>M.riskLevel==="medium"),q=Y.filter(M=>M.riskLevel==="low");_({totalAr:Y.reduce((M,L)=>M+(L.totalAr||0),0),overdueAr:Y.reduce((M,L)=>M+(L.overdue||0),0),overdueCount:X.length,aging30Ar:Y.reduce((M,L)=>M+(L.aging030||0),0),aging30Count:q.length,normalAr:Y.reduce((M,L)=>M+(L.aging030||0),0)})}catch(T){console.error("AR Aging 조회 실패:",T),o(T.message||"데이터 조회 중 오류가 발생했습니다.")}finally{s(!1)}};p.useEffect(()=>{I(),O(),E()},[]);const S=T=>{if(T==null||T==="")return"-";const P=Number(T);return Number.isFinite(P)?`₩${P.toLocaleString("ko-KR")}`:String(T)},k=T=>T==="TNT"?r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,background:"#3b82f6",color:"white",borderRadius:4,fontSize:11,fontWeight:700,marginRight:6},children:"T"}):T==="DYS"?r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,background:"#10b981",color:"white",borderRadius:4,fontSize:11,fontWeight:700,marginRight:6},children:"D"}):null,D=T=>T==="high"?r.jsx("span",{style:{padding:"2px 8px",background:"#ef4444",color:"white",borderRadius:4,fontSize:11},children:"고위험"}):T==="medium"?r.jsx("span",{style:{padding:"2px 8px",background:"#f59e0b",color:"white",borderRadius:4,fontSize:11},children:"중위험"}):T==="low"?r.jsx("span",{style:{padding:"2px 8px",background:"#10b981",color:"white",borderRadius:4,fontSize:11},children:"저위험"}):r.jsx("span",{style:{padding:"2px 8px",background:"#6b7280",color:"white",borderRadius:4,fontSize:11},children:"-"});return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{marginBottom:24,display:"flex",alignItems:"baseline",gap:12,justifyContent:"space-between"},children:[r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"연체채권 현황"}),r.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"거래처별 채권 연령 분석 및 리스크 관리"})]}),r.jsxs("div",{style:{padding:"8px 12px",background:"#f3f4f6",borderRadius:6,fontSize:12,color:"#4b5563"},children:[r.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"위험도 분류 기준 (연체비율)"}),r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("span",{children:[r.jsx("span",{style:{color:"#ef4444",fontWeight:600},children:"고위험"}),": 30% 초과"]}),r.jsxs("span",{children:[r.jsx("span",{style:{color:"#f59e0b",fontWeight:600},children:"중위험"}),": 10~30%"]}),r.jsxs("span",{children:[r.jsx("span",{style:{color:"#10b981",fontWeight:600},children:"저위험"}),": 10% 이하"]})]}),r.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:2},children:"※ 연체비율 = 30일 초과 연체액 / 총채권액"})]})]}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",marginBottom:20},children:[r.jsxs("select",{className:"search-input",value:N,onChange:T=>C(T.target.value),style:{width:220},children:[r.jsx("option",{value:"latest",children:"최신 채권검토일"}),d.map((T,P)=>r.jsxs("option",{value:`${T.meeting_id}:${T.snapshot_date}`,children:[T.meeting_name," (",T.snapshot_date,")"]},P))]}),r.jsxs("select",{className:"search-input",value:f,onChange:T=>h(T.target.value),style:{width:120},children:[r.jsx("option",{value:"all",children:"전체 회사"}),r.jsx("option",{value:"TNT",children:"TNT"}),r.jsx("option",{value:"DYS",children:"DYS"})]}),r.jsxs("select",{className:"search-input",value:m,onChange:T=>g(T.target.value),style:{width:150},children:[r.jsx("option",{value:"all",children:"전체 영업사원"}),l.map(T=>r.jsx("option",{value:T,children:T},T))]}),r.jsx("input",{type:"text",className:"search-input",value:b,onChange:T=>j(T.target.value),placeholder:"거래처명 검색",style:{width:150}}),r.jsxs("select",{className:"search-input",value:y,onChange:T=>x(T.target.value),style:{width:120},children:[r.jsx("option",{value:"all",children:"전체 위험도"}),r.jsx("option",{value:"high",children:"고위험"}),r.jsx("option",{value:"medium",children:"중위험"}),r.jsx("option",{value:"low",children:"저위험"})]}),r.jsxs("select",{className:"search-input",value:v,onChange:T=>A(T.target.value),style:{width:120},children:[r.jsx("option",{value:"all",children:"전체 구간"}),r.jsx("option",{value:"0-30",children:"0-30일 이내"}),r.jsx("option",{value:"31-60",children:"1개월 이내"}),r.jsx("option",{value:"61-90",children:"2개월 이내"}),r.jsx("option",{value:"91-120",children:"3개월 이내"}),r.jsx("option",{value:"121-150",children:"4개월 이내"}),r.jsx("option",{value:"151-180",children:"5개월 이내"}),r.jsx("option",{value:"181-210",children:"6개월 이내"}),r.jsx("option",{value:"211-240",children:"7개월 이내"}),r.jsx("option",{value:"241-270",children:"8개월 이내"}),r.jsx("option",{value:"271-300",children:"9개월 이내"}),r.jsx("option",{value:"301-330",children:"10개월 이내"}),r.jsx("option",{value:"331-365",children:"11개월 이내"}),r.jsx("option",{value:"over-365",children:"12개월 초과"})]}),r.jsx("div",{style:{display:"flex",gap:8,marginLeft:"auto"},children:r.jsx("button",{className:"btn",onClick:E,disabled:i,style:{height:30,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",whiteSpace:"nowrap"},children:i?"조회 중...":"조회"})})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[r.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #3b82f6"},children:[r.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"총채권액"}),r.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:S(w.totalAr)})]}),r.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #ef4444"},children:[r.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:["만기도과 (",w.overdueCount,"건)"]}),r.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#ef4444"},children:S(w.overdueAr)})]}),r.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #f59e0b"},children:[r.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:["30일 이내 (",w.aging30Count,"건)"]}),r.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#f59e0b"},children:S(w.aging30Ar)})]}),r.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #10b981"},children:[r.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"정상채권"}),r.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#10b981"},children:S(w.normalAr)})]})]})]}),r.jsx("div",{style:{flex:1,overflow:"auto",padding:24},children:a?r.jsx("div",{style:{padding:16,color:"#ef4444"},children:a}):e.length===0?r.jsx("div",{className:"empty-state",children:"조회된 데이터가 없습니다"}):r.jsx("div",{className:"card",style:{overflow:"auto",height:"100%"},children:r.jsxs("table",{className:"table",style:{fontSize:12},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:{width:40,textAlign:"center",position:"sticky",top:0,background:"#fff",zIndex:10},children:"#"}),r.jsx("th",{style:{width:80,position:"sticky",top:0,background:"#fff",zIndex:10},children:"위험도"}),r.jsx("th",{style:{minWidth:250,position:"sticky",top:0,background:"#fff",zIndex:10},children:"거래처 정보"}),r.jsx("th",{style:{minWidth:120,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"총채권액"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"0-30일"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"1개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"2개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"3개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"4개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"5개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"6개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"7개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"8개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"9개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"10개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"11개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"12개월"}),r.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"12개월+"}),r.jsx("th",{style:{minWidth:100,textAlign:"center",position:"sticky",top:0,background:"#fff",zIndex:10},children:"액션"})]})}),r.jsx("tbody",{children:e.map((T,P)=>r.jsxs("tr",{style:{cursor:"pointer"},children:[r.jsx("td",{style:{textAlign:"center",color:"var(--muted)"},children:P+1}),r.jsx("td",{children:D(T.riskLevel||"")}),r.jsx("td",{children:r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[k(T.companyType||""),r.jsx("span",{style:{fontWeight:600,fontSize:13},children:T.customerName||"-"})]}),r.jsxs("div",{style:{fontSize:11,color:"#6b7280",display:"flex",gap:8,flexWrap:"wrap"},children:[r.jsxs("span",{children:["코드: ",T.customerCode||"-"]}),r.jsxs("span",{children:["영업: ",T.salesRep||"-"]}),r.jsxs("span",{children:["부서: ",T.department||"-"]})]})]})}),r.jsx("td",{style:{textAlign:"right",fontWeight:600},children:S(T.totalAr)}),r.jsx("td",{style:{textAlign:"right"},children:S(T.aging030)}),r.jsx("td",{style:{textAlign:"right"},children:S(T.aging3160)}),r.jsx("td",{style:{textAlign:"right"},children:S(T.aging6190)}),r.jsx("td",{style:{textAlign:"right"},children:S(T.aging91120)}),r.jsx("td",{style:{textAlign:"right"},children:S(T.aging121150)}),r.jsx("td",{style:{textAlign:"right"},children:S(T.aging151180)}),r.jsx("td",{style:{textAlign:"right"},children:S(T.aging181210)}),r.jsx("td",{style:{textAlign:"right"},children:S(T.aging211240)}),r.jsx("td",{style:{textAlign:"right"},children:S(T.aging241270)}),r.jsx("td",{style:{textAlign:"right"},children:S(T.aging271300)}),r.jsx("td",{style:{textAlign:"right"},children:S(T.aging301330)}),r.jsx("td",{style:{textAlign:"right"},children:S(T.aging331365)}),r.jsx("td",{style:{textAlign:"right"},children:S(T.agingOver365)}),r.jsx("td",{style:{textAlign:"center"},children:r.jsx("button",{className:"btn btn-sm",onClick:R=>{R.stopPropagation(),alert("거래처 상세 패널 구현 예정")},children:"상세"})})]},P))})]})})})]})}const Zl={high:"#ef4444",medium:"#f59e0b",low:"#10b981",default:"#e5e7eb"},Iv={PLANNED:{label:"회의 예정",bg:"#e0f2fe",color:"#0369a1"},DATA_GENERATED:{label:"자료 생성",bg:"#ede9fe",color:"#6d28d9"},ON_GOING:{label:"진행중",bg:"#fef3c7",color:"#b45309"},FINISHED:{label:"완료",bg:"#dcfce7",color:"#15803d"},POSTPONED:{label:"연기",bg:"#fee2e2",color:"#b91c1c"}};function _Y(){const[e,n]=p.useState([]),[i,s]=p.useState(!1),[a,o]=p.useState(null),[l,c]=p.useState("all"),[d,u]=p.useState(""),[f,h]=p.useState(""),[m,g]=p.useState(""),[b,j]=p.useState(!1),[y,x]=p.useState(""),[v,A]=p.useState(new Date().toISOString().split("T")[0]),[N,C]=p.useState(""),[w,_]=p.useState(!1),I=async()=>{s(!0),o(null);try{const k=new URLSearchParams;l!=="all"&&k.append("status",l),d&&k.append("fromDate",d),f&&k.append("toDate",f),m.trim()&&k.append("keyword",m.trim());const D=await fetch(`/api/v1/credit/meetings?${k.toString()}`);if(!D.ok)throw new Error(`API 호출 실패: ${D.status}`);const P=((await D.json()).meetings||[]).map(R=>({id:R.id,title:R.meeting_name,meetingDate:R.meeting_date,status:String(R.meeting_status||"").toUpperCase()||"PLANNED",customerCount:R.customer_count||0,highRiskCount:Number(R.high_risk_count)||0,mediumRiskCount:Number(R.medium_risk_count)||0,lowRiskCount:Number(R.low_risk_count)||0,createdAt:R.created_at}));n(P)}catch(k){console.error("채권회의 목록 조회 실패:",k),o(k.message||"데이터 조회 중 오류가 발생했습니다.")}finally{s(!1)}};p.useEffect(()=>{I()},[]);const O=k=>{if(!k)return"-";const D=new Date(k);return new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}).format(D)},E=async()=>{if(!y||!v){alert("회의명과 일자를 입력해주세요.");return}_(!0);try{const k=await fetch("/api/v1/credit/meetings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({meetingCode:`MTG-${v.replace(/-/g,"")}`,meetingName:y,meetingDate:v,remark:N})});if(!k.ok)throw new Error("회의 생성 실패");const D=await k.json();if(D.success)j(!1),x(""),C(""),I();else throw new Error(D.error||"회의 생성 실패")}catch(k){alert(k.message)}finally{_(!1)}},S=k=>{const D=`credit:meeting:${k}`;window.location.hash=D,window.dispatchEvent(new CustomEvent("tnt.sales.navigate",{detail:{key:D}}))};return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsx("div",{style:{marginBottom:24,display:"flex",alignItems:"baseline",gap:12,justifyContent:"space-between"},children:r.jsx("div",{children:r.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"채권회의"})})}),r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",marginBottom:0},children:[r.jsxs("select",{className:"search-input",value:l,onChange:k=>c(k.target.value),style:{width:160,height:40,fontSize:14},children:[r.jsx("option",{value:"all",children:"전체 상태"}),r.jsx("option",{value:"PLANNED",children:"회의 예정"}),r.jsx("option",{value:"DATA_GENERATED",children:"자료 생성"}),r.jsx("option",{value:"ON_GOING",children:"진행중"}),r.jsx("option",{value:"FINISHED",children:"완료"}),r.jsx("option",{value:"POSTPONED",children:"연기"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("input",{type:"date",className:"search-input",value:d,onChange:k=>u(k.target.value),style:{width:170,height:40,fontSize:14}}),r.jsx("span",{style:{color:"#9ca3af"},children:"~"}),r.jsx("input",{type:"date",className:"search-input",value:f,onChange:k=>h(k.target.value),style:{width:170,height:40,fontSize:14}})]}),r.jsx("div",{style:{position:"relative",flex:"1 1 260px",minWidth:240,maxWidth:360},children:r.jsx("input",{type:"text",className:"search-input",value:m,onChange:k=>g(k.target.value),placeholder:"회의명 검색",style:{width:"100%",height:40,fontSize:14,paddingLeft:14}})}),r.jsx("div",{style:{display:"flex",gap:8,marginLeft:"auto"},children:r.jsx("button",{className:"btn",onClick:I,disabled:i,style:{height:30,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",whiteSpace:"nowrap"},children:i?"조회 중...":"조회"})})]})]}),r.jsx("div",{style:{flex:1,overflow:"auto",padding:24},children:a?r.jsx("div",{style:{padding:16,color:"#ef4444",background:"#fef2f2",border:"1px solid #fee2e2",borderRadius:8},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx(ha,{size:16}),a]})}):e.length===0?r.jsxs("div",{className:"empty-state",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:300,gap:16},children:[r.jsx(qr,{size:48,style:{opacity:.2}}),r.jsxs("div",{style:{textAlign:"center"},children:[r.jsx("p",{style:{fontSize:18,fontWeight:500,color:"#6b7280",margin:0},children:"등록된 채권회의가 없습니다."}),r.jsx("p",{style:{fontSize:14,color:"#9ca3af",marginTop:4},children:"새로운 회의를 생성하여 관리를 시작해보세요."})]})]}):r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:24},children:e.map(k=>{var T;const D=[{name:"High",value:k.highRiskCount,color:Zl.high},{name:"Medium",value:k.mediumRiskCount,color:Zl.medium},{name:"Low",value:k.lowRiskCount,color:Zl.low}].filter(P=>P.value>0);return D.length===0&&D.push({name:"None",value:1,color:Zl.default}),r.jsxs("div",{onClick:()=>S(k.id),className:"card",style:{background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden",cursor:"pointer",transition:"all 0.2s",display:"flex",flexDirection:"column"},onMouseEnter:P=>{P.currentTarget.style.transform="translateY(-2px)",P.currentTarget.style.boxShadow="0 10px 15px -3px rgba(0, 0, 0, 0.1)",P.currentTarget.style.borderColor="#93c5fd"},onMouseLeave:P=>{P.currentTarget.style.transform="none",P.currentTarget.style.boxShadow="none",P.currentTarget.style.borderColor="#e5e7eb"},children:[r.jsxs("div",{style:{padding:20,borderBottom:"1px solid #f3f4f6",background:"linear-gradient(to right, #fff, #f9fafb)"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(()=>{const P=Iv[k.status]||Iv.PLANNED,R=k.status==="FINISHED"?fr:k.status==="ON_GOING"?Bv:qr;return r.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,padding:"2px 8px",borderRadius:999,fontSize:11,fontWeight:600,background:P.bg,color:P.color},children:[r.jsx(R,{size:12})," ",P.label]})})(),r.jsxs("span",{style:{fontSize:11,color:"#9ca3af"},children:[((T=k.createdAt)==null?void 0:T.substring(0,10))||"-"," 생성"]})]}),r.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(Ii,{size:16,color:"#9ca3af"})})]}),r.jsx("h3",{style:{fontSize:18,fontWeight:700,color:"#111827",margin:"0 0 8px 0",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:k.title}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:13,color:"#6b7280"},children:[r.jsx(qr,{size:14}),O(k.meetingDate)]})]}),r.jsxs("div",{style:{padding:20,display:"flex",alignItems:"center",gap:24,flex:1},children:[r.jsxs("div",{style:{position:"relative",width:80,height:80,flexShrink:0},children:[r.jsx(Ro,{width:"100%",height:"100%",children:r.jsx(nH,{children:r.jsx(Z2,{data:D,innerRadius:25,outerRadius:40,paddingAngle:2,dataKey:"value",stroke:"none",children:D.map((P,R)=>r.jsx(za,{fill:P.color},`cell-${R}`))})})}),r.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:[r.jsx("span",{style:{fontSize:10,fontWeight:600,color:"#9ca3af"},children:"Total"}),r.jsx("span",{style:{fontSize:16,fontWeight:700,color:"#111827",lineHeight:1},children:k.customerCount})]})]}),r.jsxs("div",{style:{flex:1,display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 8px"},children:[r.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[r.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"고위험"}),r.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#ef4444"},children:k.highRiskCount})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[r.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"중위험"}),r.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#f59e0b"},children:k.mediumRiskCount})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[r.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"저위험"}),r.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#10b981"},children:k.lowRiskCount})]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[r.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"심사대상"}),r.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#374151"},children:k.customerCount})]})]})]}),r.jsxs("div",{style:{padding:"12px 20px",background:"#f9fafb",borderTop:"1px solid #f3f4f6",fontSize:12,color:"#6b7280",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("span",{children:"관리자: 홍길동"}),r.jsxs("span",{style:{color:"#3b82f6",fontWeight:600,display:"flex",alignItems:"center",gap:4},children:["상세보기 ",r.jsx(Ii,{size:12})]})]})]},k.id)})})}),b&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",backdropFilter:"blur(4px)",zIndex:50,display:"flex",alignItems:"center",justifyContent:"center",padding:16},children:r.jsxs("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",width:"100%",maxWidth:480,overflow:"hidden"},onClick:k=>k.stopPropagation(),children:[r.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #f3f4f6",display:"flex",justifyContent:"space-between",alignItems:"center",background:"#f9fafb"},children:[r.jsx("h3",{style:{fontSize:18,fontWeight:700,color:"#111827",margin:0},children:"새 채권회의 생성"}),r.jsx("button",{onClick:()=>j(!1),style:{background:"none",border:"none",color:"#9ca3af",cursor:"pointer",padding:4},children:r.jsx("span",{style:{fontSize:24,lineHeight:1},children:"×"})})]}),r.jsxs("div",{style:{padding:24,display:"flex",flexDirection:"column",gap:20},children:[r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:6},children:["회의명 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("input",{type:"text",value:y,onChange:k=>x(k.target.value),placeholder:"예: 2025년 1월 정기 채권회의",className:"search-input",style:{width:"100%",height:42},autoFocus:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:6},children:["회의 일자 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("input",{type:"date",value:v,onChange:k=>A(k.target.value),className:"search-input",style:{width:"100%",height:42}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:6},children:"비고"}),r.jsx("textarea",{value:N,onChange:k=>C(k.target.value),rows:3,placeholder:"회의 관련 메모를 입력하세요",className:"search-input",style:{width:"100%",height:"auto",padding:"12px",resize:"none"}})]})]}),r.jsxs("div",{style:{padding:"16px 24px",background:"#f9fafb",borderTop:"1px solid #f3f4f6",display:"flex",justifyContent:"flex-end",gap:12},children:[r.jsx("button",{onClick:()=>j(!1),className:"btn",style:{background:"#f3f4f6",borderColor:"#e5e7eb",color:"#4b5563"},children:"취소"}),r.jsx("button",{onClick:E,disabled:w,className:"btn",style:{background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:w?.7:1},children:w?"생성 중...":"회의 생성"})]})]})})]})}const vf={PLANNED:{label:"회의 예정",bg:"#e0f2fe",color:"#0369a1"},DATA_GENERATED:{label:"자료 생성",bg:"#ede9fe",color:"#6d28d9"},ON_GOING:{label:"진행중",bg:"#fef3c7",color:"#b45309"},FINISHED:{label:"완료",bg:"#dcfce7",color:"#15803d"},POSTPONED:{label:"연기",bg:"#fee2e2",color:"#b91c1c"}},so=e=>{if(!e)return"-";const n=new Date(e);return Number.isNaN(n.getTime())?e:n.toISOString().slice(0,10)},CY=e=>{if(!e)return"-";const n=e.toUpperCase();return{REQUESTED:"요청",SUBMITTED:"제출",HOLD:"보류",APPROVED:"승인",REJECTED:"반려",CANCELLED:"취소",CANCELED:"취소",PENDING:"대기"}[n]||e},AY=e=>{if(!e)return"-";const n=e.toUpperCase();return{APPROVE:"승인",APPROVED:"승인",REJECT:"반려",REJECTED:"반려",HOLD:"보류",PENDING:"대기"}[n]||e};function IY(){const n=window.location.hash.replace("#","").split(":")[2]||"0",[i,s]=p.useState(null),[a,o]=p.useState([]),[l,c]=p.useState([]),[d,u]=p.useState([]),[f,h]=p.useState([]),[m,g]=p.useState([]),[b,j]=p.useState(!1),y=async()=>{j(!0);try{const A=await(await fetch(`/api/v1/credit/meetings/${n}`)).json();A.meeting&&s(A.meeting),u(A.customers||[]),o((A.activities||[]).map(w=>({...w,owner_name:w.owner_name??w.ownerName,sf_owner_id:w.sf_owner_id??w.sfOwnerId}))),c(A.unblockRequests||[]),h(A.remarks||[]);const C=await(await fetch(`/api/v1/credit/meetings/${n}/opinions`)).json();g(C.opinions||[])}catch(v){console.error("회의 상세 조회 실패",v)}finally{j(!1)}};p.useEffect(()=>{y()},[n]);const x=p.useMemo(()=>({activityCount:a.length,unblockCount:l.length,customerCount:m.length}),[a.length,l.length,m.length]);return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:12},children:[r.jsx("button",{onClick:()=>{window.location.hash="credit:meetings",window.dispatchEvent(new CustomEvent("tnt.sales.navigate",{detail:{key:"credit:meetings"}}))},style:{padding:8,borderRadius:"50%",border:"none",background:"transparent",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:v=>v.currentTarget.style.background="#f3f4f6",onMouseLeave:v=>v.currentTarget.style.background="transparent",children:r.jsx(Yv,{size:20,color:"#4b5563"})}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsx("h1",{style:{margin:0,fontSize:22,fontWeight:700,color:"#111827"},children:(i==null?void 0:i.meeting_name)||"채권회의"}),(i==null?void 0:i.meeting_status)&&r.jsx("span",{style:{padding:"4px 10px",borderRadius:999,fontSize:12,fontWeight:600,background:vf[i.meeting_status].bg,color:vf[i.meeting_status].color},children:vf[i.meeting_status].label})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,color:"#6b7280",fontSize:13},children:[r.jsx(qr,{size:14})," ",i!=null&&i.meeting_date?so(i.meeting_date):"-"]}),(i==null?void 0:i.remark)&&r.jsx("div",{style:{marginTop:6,color:"#4b5563",fontSize:13,lineHeight:1.5},children:i.remark})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:12},children:[r.jsx(jf,{label:"거래처별 회의 결과",value:`${x.customerCount}건`,icon:r.jsx(Gv,{size:16,color:"#2563eb"})}),r.jsx(jf,{label:"회의 활동",value:`${x.activityCount}건`,icon:r.jsx(Tr,{size:16,color:"#16a34a"})}),r.jsx(jf,{label:"매출통제 해제 요청",value:`${x.unblockCount}건`,icon:r.jsx(nr,{size:16,color:"#b45309"})})]})]}),r.jsxs("div",{style:{flex:1,overflowY:"auto",padding:24,display:"flex",flexDirection:"column",gap:20},children:[r.jsx(ec,{title:"회의 결과",children:f.length===0?r.jsx(tc,{text:"등록된 회의 내용이 없습니다."}):r.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10},children:f.map(v=>r.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:10,padding:12},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[r.jsx("div",{style:{fontSize:13,fontWeight:700,color:"#111827"},children:v.author_name||v.author_id||"작성자 없음"}),r.jsx("div",{style:{fontSize:12,color:"#9ca3af"},children:so(v.created_at)})]}),r.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:v.remark_type||""}),r.jsx("div",{style:{fontSize:13,color:"#374151",whiteSpace:"pre-wrap",lineHeight:1.5},children:v.remark_text||"-"})]},v.id))})}),r.jsx(ec,{title:"채권회의 활동",children:a.length===0?r.jsx(tc,{text:"등록된 활동이 없습니다."}):r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:Yn,children:"제목"}),r.jsx("th",{style:Yn,children:"유형"}),r.jsx("th",{style:Yn,children:"상태"}),r.jsx("th",{style:Yn,children:"채널"}),r.jsx("th",{style:Yn,children:"계획일시"}),r.jsx("th",{style:Yn,children:"담당자"})]})}),r.jsx("tbody",{children:a.map(v=>r.jsxs("tr",{style:bf,children:[r.jsx("td",{style:Kn,children:v.subject||"-"}),r.jsx("td",{style:Kn,children:v.activity_type||"-"}),r.jsx("td",{style:Kn,children:v.activity_status||"-"}),r.jsx("td",{style:Kn,children:v.channel||"-"}),r.jsx("td",{style:Kn,children:so(v.planned_start_at)||"-"}),r.jsx("td",{style:Kn,children:v.owner_name||v.sf_owner_id||"-"})]},v.id))})]})}),r.jsx(ec,{title:"매출통제 해제 품의 진행현황",children:l.length===0?r.jsx(tc,{text:"해제 요청이 없습니다."}):r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:Yn,children:"거래처"}),r.jsx("th",{style:Yn,children:"상태"}),r.jsx("th",{style:Yn,children:"요청일"}),r.jsx("th",{style:Yn,children:"목표 해제일"}),r.jsx("th",{style:Yn,children:"최근 결정"}),r.jsx("th",{style:Yn,children:"사유"})]})}),r.jsx("tbody",{children:l.map(v=>r.jsxs("tr",{style:bf,children:[r.jsxs("td",{style:Kn,children:[r.jsx("div",{style:{fontWeight:600,color:"#111827"},children:v.customer_name||"-"}),r.jsx("div",{style:{fontSize:12,color:"#9ca3af"},children:v.customer_seq})]}),r.jsx("td",{style:Kn,children:CY(v.request_status)}),r.jsx("td",{style:Kn,children:so(v.request_date)}),r.jsx("td",{style:Kn,children:so(v.target_unblock_date)}),r.jsx("td",{style:Kn,children:AY(v.latest_decision)}),r.jsx("td",{style:Kn,children:v.reason_text||"-"})]},v.id))})]})}),r.jsx(ec,{title:"거래처별 회의 결과",children:m.length===0?r.jsx(tc,{text:"등록된 연체 의견이 없습니다."}):r.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{style:Yn,children:"거래처"}),r.jsx("th",{style:Yn,children:"담당자"}),r.jsx("th",{style:Yn,children:"연체 의견"})]})}),r.jsx("tbody",{children:m.map((v,A)=>r.jsxs("tr",{style:bf,children:[r.jsxs("td",{style:Kn,children:[r.jsx("div",{style:{fontWeight:600,color:"#111827"},children:v.customer_name}),r.jsx("div",{style:{fontSize:12,color:"#9ca3af"},children:v.customer_seq})]}),r.jsx("td",{style:Kn,children:v.emp_name||"-"}),r.jsx("td",{style:{...Kn,whiteSpace:"pre-wrap"},children:v.opinion_text||"-"})]},v.id||A))})]})})]}),b&&r.jsx("div",{style:{position:"absolute",top:12,right:12,fontSize:12,color:"#6b7280"},children:"불러오는 중..."})]})}const Yn={padding:"10px 12px",textAlign:"left",fontWeight:600,color:"#6b7280",borderBottom:"1px solid #e5e7eb",fontSize:13},Kn={padding:"10px 12px",borderBottom:"1px solid #f3f4f6",fontSize:13,color:"#374151",verticalAlign:"top"},bf={transition:"background 0.1s"};function jf({label:e,value:n,icon:i}){return r.jsxs("div",{style:{background:"#f9fafb",border:"1px solid #e5e7eb",borderRadius:12,padding:12,display:"flex",alignItems:"center",gap:10},children:[r.jsx("div",{style:{width:34,height:34,borderRadius:10,background:"#eef2ff",display:"flex",alignItems:"center",justifyContent:"center"},children:i}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[r.jsx("span",{style:{fontSize:12,color:"#6b7280"},children:e}),r.jsx("span",{style:{fontSize:16,fontWeight:700,color:"#111827"},children:n})]})]})}function ec({title:e,children:n}){return r.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,padding:16},children:[r.jsx("h2",{style:{margin:"0 0 12px 0",fontSize:16,fontWeight:700,color:"#111827",display:"flex",alignItems:"center",gap:8},children:r.jsx("span",{children:e})}),n]})}function tc({text:e}){return r.jsx("div",{style:{padding:16,color:"#6b7280",fontSize:13},children:e})}const TY=e=>({PLANNED:"회의 예정",DATA_GENERATED:"자료 생성됨",ON_GOING:"진행중",FINISHED:"완료",POSTPONED:"연기"})[e]||e,Tv=e=>({PLANNED:{bg:"#e0e7ff",text:"#4338ca"},DATA_GENERATED:{bg:"#dbeafe",text:"#1d4ed8"},ON_GOING:{bg:"#fef3c7",text:"#b45309"},FINISHED:{bg:"#dcfce7",text:"#15803d"},POSTPONED:{bg:"#fee2e2",text:"#b91c1c"}})[e]||{bg:"#f3f4f6",text:"#6b7280"},Ev=[{id:"create",title:"회의 생성",subtitle:"Meeting Setup",icon:mr,color:"#3b82f6",bgColor:"#eff6ff",borderColor:"#93c5fd",actions:[{id:"new-meeting",label:"새 회의 생성",description:"월별 채권회의를 생성합니다",icon:mr,primary:!0},{id:"select-meeting",label:"기존 회의 선택",description:"진행 중인 회의를 선택합니다",icon:Tr}]},{id:"review",title:"지난 회의 Review",subtitle:"Previous Meeting Review",icon:Kv,color:"#06b6d4",bgColor:"#ecfeff",borderColor:"#67e8f9",actions:[{id:"view-previous",label:"지난 회의 조회",description:"이전 채권회의 결과를 확인합니다",icon:Sf,primary:!0},{id:"check-decisions",label:"결정사항 확인",description:"차단/해제/관찰 결정 이행을 확인합니다",icon:Tr},{id:"compare-status",label:"채권 변동 비교",description:"전월 대비 채권 현황을 비교합니다",icon:pd}]},{id:"prepare",title:"자료 생성",subtitle:"Data Preparation",icon:kf,color:"#8b5cf6",bgColor:"#f5f3ff",borderColor:"#c4b5fd",actions:[{id:"generate-ar",label:"AR Aging 데이터 생성",description:"ERP에서 채권 데이터를 가져옵니다",icon:qh,primary:!0},{id:"select-customers",label:"심사 대상 선정",description:"연체 기준으로 대상을 선정합니다",icon:Gv},{id:"import-data",label:"추가 자료 업로드",description:"보충 자료를 업로드합니다",icon:Hv},{id:"preview-report",label:"회의 자료 미리보기",description:"생성된 보고서를 확인합니다",icon:Sf}]},{id:"progress",title:"회의 진행",subtitle:"Meeting in Progress",icon:ao,color:"#f59e0b",bgColor:"#fffbeb",borderColor:"#fcd34d",actions:[{id:"start-meeting",label:"회의 시작",description:"채권회의를 시작합니다",icon:Fv,primary:!0},{id:"review-customer",label:"거래처별 심사",description:"거래처별 채권 상태를 심사합니다",icon:Tr},{id:"decision-input",label:"심사 결정 입력",description:"차단/해제/관찰 결정을 입력합니다",icon:Wv},{id:"realtime-status",label:"실시간 현황",description:"심사 진행 현황을 확인합니다",icon:oa}]},{id:"close",title:"회의 종료",subtitle:"Meeting Closure",icon:fr,color:"#10b981",bgColor:"#ecfdf5",borderColor:"#6ee7b7",actions:[]}];function EY({activeMeeting:e}){const[n,i]=p.useState([]),[s,a]=p.useState(null),[o,l]=p.useState([]),[c,d]=p.useState([]),[u,f]=p.useState(!1),[h,m]=p.useState(!1),[g,b]=p.useState(!1);p.useEffect(()=>{(async()=>{f(!0);try{const v=await fetch("/api/v1/credit/meetings?status=FINISHED");if(v.ok){const N=(await v.json()).meetings||[];i(N),N.length>0&&a(N[0])}}catch(v){console.error("Failed to fetch previous meetings:",v)}finally{f(!1)}})()},[]),p.useEffect(()=>{if(!s)return;(async()=>{m(!0);try{const v=await fetch(`/api/v1/credit/meetings/${s.id}/remarks`);if(v.ok){const A=await v.json();l(A.remarks||A||[])}}catch(v){console.error("Failed to fetch remarks:",v)}finally{m(!1)}})()},[s]),p.useEffect(()=>{if(!s)return;(async()=>{b(!0);try{const v=await fetch(`/api/v1/credit/meetings/${s.id}/opinions`);if(v.ok){const A=await v.json();d(A.opinions||[])}}catch(v){console.error("Failed to fetch sales opinions:",v)}finally{b(!1)}})()},[s]);const j=x=>{switch(x){case"지시":return{label:"지시",color:"#dc2626",bgColor:"#fef2f2"};case"의견":return{label:"의견",color:"#2563eb",bgColor:"#eff6ff"};case"결정":return{label:"결정",color:"#059669",bgColor:"#ecfdf5"};default:return{label:x||"기타",color:"#6b7280",bgColor:"#f3f4f6"}}},y=x=>x?new Date(x).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-";return r.jsxs("div",{style:{maxWidth:1200},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24,padding:16,background:"#ecfeff",borderRadius:12,border:"1px solid #67e8f9"},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#06b6d4",display:"flex",alignItems:"center",justifyContent:"center",color:"white"},children:r.jsx(Kv,{size:20})}),r.jsxs("div",{children:[r.jsx("h3",{style:{margin:0,fontSize:18,color:"#0e7490"},children:"지난 회의 Review"}),r.jsx("p",{style:{margin:0,fontSize:13,color:"#0891b2"},children:"이전 채권회의 결과를 확인합니다"})]})]}),r.jsxs("div",{style:{marginBottom:20},children:[r.jsx("label",{style:{display:"block",marginBottom:8,fontSize:14,fontWeight:500,color:"#374151"},children:"이전 회의 선택"}),r.jsx("select",{value:(s==null?void 0:s.id)||"",onChange:x=>{const v=n.find(A=>A.id===Number(x.target.value));a(v||null)},style:{width:"100%",maxWidth:400,padding:"10px 12px",fontSize:14,border:"1px solid #d1d5db",borderRadius:8,background:"white",cursor:"pointer"},children:u?r.jsx("option",{children:"로딩 중..."}):n.length===0?r.jsx("option",{children:"종료된 이전 회의가 없습니다"}):n.map(x=>r.jsxs("option",{value:x.id,children:[x.meeting_name," (",x.meeting_date,")"]},x.id))})]}),s&&r.jsx("div",{style:{marginBottom:24},children:r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:16},children:[{type:"지시",label:"지시",color:"#dc2626",bgColor:"#fef2f2"},{type:"의견",label:"의견",color:"#2563eb",bgColor:"#eff6ff"},{type:"결정",label:"결정",color:"#059669",bgColor:"#ecfdf5"}].map(x=>r.jsxs("div",{style:{padding:16,background:x.bgColor,borderRadius:12,textAlign:"center"},children:[r.jsx("div",{style:{fontSize:24,fontWeight:700,color:x.color},children:o.filter(v=>v.remark_type===x.type).length}),r.jsx("div",{style:{fontSize:13,color:x.color},children:x.label})]},x.type))})}),r.jsxs("div",{style:{background:"white",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden"},children:[r.jsx("div",{style:{padding:"12px 16px",background:"#f9fafb",borderBottom:"1px solid #e5e7eb",fontWeight:600,fontSize:14,color:"#374151"},children:"회의 결과 목록"}),h?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(ln,{size:24,style:{animation:"spin 1s linear infinite"}}),r.jsx("p",{style:{marginTop:8},children:"로딩 중..."})]}):o.length===0?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(Tr,{size:40,strokeWidth:1}),r.jsx("p",{style:{marginTop:8},children:"회의 결과가 없습니다"})]}):r.jsx("div",{style:{padding:16},children:o.map((x,v)=>{const A=j(x.remark_type);return r.jsxs("div",{style:{padding:16,background:v%2===0?"white":"#f9fafb",borderRadius:8,marginBottom:12,border:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{style:{display:"inline-block",padding:"4px 10px",fontSize:12,fontWeight:600,borderRadius:12,color:A.color,background:A.bgColor},children:A.label}),r.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#374151"},children:x.author_name})]}),r.jsx("span",{style:{fontSize:11,color:"#9ca3af"},children:y(x.created_at)})]}),r.jsx("div",{style:{fontSize:13,color:"#4b5563",lineHeight:1.6,whiteSpace:"pre-wrap"},children:x.remark_text})]},x.id)})})]}),r.jsxs("div",{style:{background:"white",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden",marginTop:24},children:[r.jsxs("div",{style:{padding:"12px 16px",background:"#fef3c7",borderBottom:"1px solid #fcd34d",fontWeight:600,fontSize:14,color:"#92400e",display:"flex",alignItems:"center",gap:8},children:[r.jsx(No,{size:16}),"연체 의견 목록 (",c.length,"건)"]}),g?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(ln,{size:24,style:{animation:"spin 1s linear infinite"}}),r.jsx("p",{style:{marginTop:8},children:"로딩 중..."})]}):c.length===0?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(No,{size:40,strokeWidth:1}),r.jsx("p",{style:{marginTop:8},children:"등록된 연체 의견이 없습니다"})]}):r.jsx("div",{style:{padding:16},children:c.map((x,v)=>r.jsxs("div",{style:{padding:16,background:v%2===0?"white":"#fffbeb",borderRadius:8,marginBottom:12,border:"1px solid #fcd34d"},children:[r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{style:{display:"inline-block",padding:"4px 10px",fontSize:12,fontWeight:600,borderRadius:12,color:"#92400e",background:"#fef3c7"},children:x.opinion_type||"연체의견"}),r.jsx("span",{style:{fontSize:13,fontWeight:500,color:"#374151"},children:x.customer_name||`고객 #${x.customer_seq}`}),x.emp_name&&r.jsxs("span",{style:{fontSize:12,color:"#6b7280"},children:["(담당: ",x.emp_name,")"]})]}),r.jsx("span",{style:{fontSize:11,color:"#9ca3af"},children:y(x.created_at)})]}),r.jsx("div",{style:{fontSize:13,color:"#4b5563",lineHeight:1.6,whiteSpace:"pre-wrap",marginBottom:8},children:x.opinion_text}),x.promise_date&&r.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["약속일자: ",x.promise_date,x.promise_amount&&` | 약속금액: ${x.promise_amount.toLocaleString()}원`]})]},x.id))})]})]})}function PY({activeMeeting:e}){var re,de,he,oe;const{selectedCustomer:n,setSelectedCustomer:i,setMeetingDate:s,setMeetingId:a,setMeetingStatus:o,triggerOpinionRefresh:l}=iN(),[c,d]=p.useState([]),[u,f]=p.useState(!1),[h,m]=p.useState([]),[g,b]=p.useState("all"),[j,y]=p.useState("all"),[x,v]=p.useState(""),[A,N]=p.useState("all"),[C,w]=p.useState(null),[_,I]=p.useState({totalAr:0,aging30Ar:0,aging60Ar:0,aging90Ar:0,over90Ar:0}),[O,E]=p.useState({visible:!1,x:0,y:0,customer:null}),[S,k]=p.useState({show:!1,customer:null}),[D,T]=p.useState({decisionCode:"",decisionComment:"",reviewFlag:!0}),[P,R]=p.useState(!1),[Y,X]=p.useState({show:!1,message:"",type:"success"}),[H,q]=p.useState({show:!1,loading:!1,opinions:[]}),[M,L]=p.useState({show:!1,loading:!1,activities:[]}),[B,F]=p.useState({show:!1,loading:!1,requests:[]});p.useEffect(()=>{if(Y.show){const V=setTimeout(()=>{X({show:!1,message:"",type:"success"})},3e3);return()=>clearTimeout(V)}},[Y.show]);const te=async()=>{q({show:!0,loading:!0,opinions:[]});try{const V=await fetch(`/api/v1/credit/meetings/${e.id}/opinions`);if(!V.ok)throw new Error("API 호출 실패");const Pe=await V.json();q({show:!0,loading:!1,opinions:Pe.opinions||[]})}catch(V){console.error("연체의견 조회 실패:",V),q({show:!0,loading:!1,opinions:[]})}},$=async()=>{L({show:!0,loading:!0,activities:[]});try{const V=await fetch(`/api/v1/credit/meetings/${e.id}/activities`);if(!V.ok)throw new Error("API 호출 실패");const Pe=await V.json();L({show:!0,loading:!1,activities:Pe.activities||[]})}catch(V){console.error("채권활동 조회 실패:",V),L({show:!0,loading:!1,activities:[]})}},W=async()=>{F({show:!0,loading:!0,requests:[]});try{const V=await fetch(`/api/v1/credit/meetings/${e.id}/unblock-requests`);if(!V.ok)throw new Error("API 호출 실패");const tt=((await V.json()).items||[]).map(ot=>({...ot,emp_name:ot.requester_name||ot.emp_name||ot.assignee_id}));F({show:!0,loading:!1,requests:tt})}catch(V){console.error("통제해제 조회 실패:",V),F({show:!0,loading:!1,requests:[]})}},U=(V,Pe)=>{V.preventDefault(),E({visible:!0,x:V.clientX,y:V.clientY,customer:Pe})},Z=()=>{E({visible:!1,x:0,y:0,customer:null})},ee=()=>{O.customer&&(k({show:!0,customer:O.customer}),T({decisionCode:"",decisionComment:"",reviewFlag:!0})),Z()},K=async()=>{if(S.customer){R(!0);try{const V=await fetch(`/api/v1/credit/meetings/${e.id}/customers`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_seq:S.customer.customerSeq,customer_name:S.customer.customerName,assignee_id:So()||"",emp_name:S.customer.salesRep||"",decision_comment:D.decisionComment,review_flag:D.reviewFlag,created_by:So()||""})});if(!V.ok){const Pe=await V.json().catch(()=>({}));throw new Error(Pe.message||"API 호출 실패")}X({show:!0,message:"거래처가 회의에 등록되었습니다.",type:"success"}),k({show:!1,customer:null}),l()}catch(V){console.error("거래처 등록 실패:",V),X({show:!0,message:V.message||"거래처 등록에 실패했습니다.",type:"error"})}finally{R(!1)}}};p.useEffect(()=>{const V=()=>Z();return document.addEventListener("click",V),()=>document.removeEventListener("click",V)},[]),p.useEffect(()=>{e!=null&&e.meetingDate&&s(e.meetingDate),e!=null&&e.id&&a(e.id),e!=null&&e.meeting_status&&o(e.meeting_status)},[e==null?void 0:e.meetingDate,e==null?void 0:e.id,e==null?void 0:e.meeting_status,s,a,o]);const ne=async()=>{try{const V=await fetch("/api/v1/credit/sales-reps");if(!V.ok)return;const Pe=await V.json();m(Pe.salesReps||[])}catch(V){console.error("영업사원 목록 조회 실패:",V)}},pe=async()=>{f(!0);try{const V=new URLSearchParams;g!=="all"&&V.append("company",g),j!=="all"&&V.append("salesRep",j),x&&V.append("customerName",x),A!=="all"&&V.append("riskLevel",A),V.append("meetingId",String(e.id));const Pe=await fetch(`/api/v1/credit/ar-aging?${V.toString()}`);if(!Pe.ok)throw new Error(`API 호출 실패: ${Pe.status}`);const tt=((await Pe.json()).items||[]).map(je=>({customerSeq:je.customer_seq,customerCode:je.customer_no,customerName:je.customer_name,channelName:je.channel_name,companyType:je.company_type,salesRep:je.emp_name,department:je.dept_name,totalAr:je.total_ar,overdue:je.overdue,aging030:je.aging_0_30,aging3160:je.aging_31_60,aging6190:je.aging_61_90,aging91120:je.aging_91_120,aging121150:je.aging_121_150,aging151180:je.aging_151_180,aging181210:je.aging_181_210,aging211240:je.aging_211_240,aging241270:je.aging_241_270,aging271300:je.aging_271_300,aging301330:je.aging_301_330,aging331365:je.aging_331_365,agingOver365:je.aging_over_365,riskLevel:je.riskLevel}));d(tt);const ot=tt.reduce((je,Te)=>je+(Te.aging030||0),0),ht=tt.reduce((je,Te)=>je+(Te.aging3160||0),0),vt=tt.reduce((je,Te)=>je+(Te.aging6190||0),0),Se=tt.reduce((je,Te)=>je+(Te.aging91120||0)+(Te.aging121150||0)+(Te.aging151180||0)+(Te.aging181210||0)+(Te.aging211240||0)+(Te.aging241270||0)+(Te.aging271300||0)+(Te.aging301330||0)+(Te.aging331365||0)+(Te.agingOver365||0),0);I({totalAr:tt.reduce((je,Te)=>je+(Te.totalAr||0),0),aging30Ar:ot,aging60Ar:ht,aging90Ar:vt,over90Ar:Se})}catch(V){console.error("AR Aging 조회 실패:",V)}finally{f(!1)}};p.useEffect(()=>{ne(),pe()},[e]);const G=V=>{if(V==null||V==="")return"-";const Pe=Number(V);return Number.isFinite(Pe)?`₩${Pe.toLocaleString("ko-KR")}`:String(V)},ae=V=>V==="TNT"?r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,background:"#3b82f6",color:"white",borderRadius:3,fontSize:10,fontWeight:700,marginRight:4},children:"T"}):V==="DYS"?r.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,background:"#10b981",color:"white",borderRadius:3,fontSize:10,fontWeight:700,marginRight:4},children:"D"}):null,ie=V=>{const Pe={display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:"50%",color:"white",fontSize:10,fontWeight:700};return V==="high"?r.jsx("span",{style:{...Pe,background:"#ef4444"},children:"고"}):V==="medium"?r.jsx("span",{style:{...Pe,background:"#f59e0b"},children:"중"}):V==="low"?r.jsx("span",{style:{...Pe,background:"#10b981"},children:"저"}):r.jsx("span",{style:{...Pe,background:"#6b7280"},children:"-"})},J=V=>{const Ve={A등급:{bg:"#dcfce7",text:"#16a34a"},B등급:{bg:"#dbeafe",text:"#2563eb"},C등급:{bg:"#fef9c3",text:"#ca8a04"},D등급:{bg:"#fed7aa",text:"#ea580c"},E등급:{bg:"#fecaca",text:"#dc2626"},F등급:{bg:"#f3e8ff",text:"#9333ea"}}[V||""]||{bg:"#f3f4f6",text:"#6b7280"};return r.jsx("span",{style:{display:"inline-block",padding:"2px 6px",borderRadius:4,fontSize:10,fontWeight:700,background:Ve.bg,color:Ve.text},children:V||"-"})};return r.jsxs(r.Fragment,{children:[r.jsx("div",{style:{display:"flex",gap:16,height:"100%"},children:r.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",minWidth:0},children:[r.jsxs("div",{style:{background:"#fff",borderRadius:10,border:"1px solid #e5e7eb",padding:12,marginBottom:12},children:[r.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,marginBottom:12},children:[r.jsxs("select",{value:g,onChange:V=>b(V.target.value),style:{padding:"6px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12},children:[r.jsx("option",{value:"all",children:"전체 회사"}),r.jsx("option",{value:"TNT",children:"TNT"}),r.jsx("option",{value:"DYS",children:"DYS"})]}),r.jsxs("select",{value:j,onChange:V=>y(V.target.value),style:{padding:"6px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12},children:[r.jsx("option",{value:"all",children:"전체 영업사원"}),h.map(V=>r.jsx("option",{value:V,children:V},V))]}),r.jsx("input",{type:"text",value:x,onChange:V=>v(V.target.value),placeholder:"거래처명 검색",style:{padding:"6px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,width:120}}),r.jsxs("select",{value:A,onChange:V=>N(V.target.value),style:{padding:"6px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:12},children:[r.jsx("option",{value:"all",children:"전체 위험도"}),r.jsx("option",{value:"high",children:"고위험"}),r.jsx("option",{value:"medium",children:"중위험"}),r.jsx("option",{value:"low",children:"저위험"})]}),r.jsx("button",{onClick:pe,disabled:u,style:{padding:"6px 12px",background:"#f59e0b",color:"white",border:"none",borderRadius:6,fontSize:12,fontWeight:600,cursor:"pointer"},children:u?"조회중...":"조회"}),r.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:6},children:[r.jsx("button",{onClick:te,style:{padding:"6px 12px",background:"#ef4444",color:"white",border:"none",borderRadius:6,fontSize:12,fontWeight:600,cursor:"pointer"},children:"연체의견 요약"}),r.jsx("button",{onClick:$,style:{padding:"6px 12px",background:"#3b82f6",color:"white",border:"none",borderRadius:6,fontSize:12,fontWeight:600,cursor:"pointer"},children:"채권활동 요약"}),r.jsx("button",{onClick:W,style:{padding:"6px 12px",background:"#10b981",color:"white",border:"none",borderRadius:6,fontSize:12,fontWeight:600,cursor:"pointer"},children:"통제해제 요약"})]})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(5, 1fr)",gap:8},children:[r.jsxs("div",{style:{padding:10,background:"#f8fafc",borderRadius:6,borderLeft:"3px solid #3b82f6"},children:[r.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"총채권액"}),r.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#111827"},children:G(_.totalAr)})]}),r.jsxs("div",{style:{padding:10,background:"#ecfdf5",borderRadius:6,borderLeft:"3px solid #10b981"},children:[r.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"30일 이내 (0~30일)"}),r.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#10b981"},children:G(_.aging30Ar)})]}),r.jsxs("div",{style:{padding:10,background:"#eff6ff",borderRadius:6,borderLeft:"3px solid #3b82f6"},children:[r.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"60일 이내 (31~60일)"}),r.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#3b82f6"},children:G(_.aging60Ar)})]}),r.jsxs("div",{style:{padding:10,background:"#fffbeb",borderRadius:6,borderLeft:"3px solid #f59e0b"},children:[r.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"90일 이내 (61~90일)"}),r.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#f59e0b"},children:G(_.aging90Ar)})]}),r.jsxs("div",{style:{padding:10,background:"#fef2f2",borderRadius:6,borderLeft:"3px solid #ef4444"},children:[r.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:"90일 초과"}),r.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#ef4444"},children:G(_.over90Ar)})]})]})]}),r.jsx("div",{style:{flex:1,background:"#fff",borderRadius:10,border:"1px solid #e5e7eb",overflow:"auto"},children:u?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(ln,{size:24,style:{animation:"spin 1s linear infinite"}}),r.jsx("p",{children:"데이터 로딩 중..."})]}):c.length===0?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"조회된 데이터가 없습니다"}):r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:11},children:[r.jsxs("thead",{children:[r.jsxs("tr",{style:{background:"#f9fafb"},children:[r.jsx("th",{rowSpan:2,style:{padding:"8px 6px",textAlign:"center",borderBottom:"1px solid #e5e7eb",fontWeight:600,color:"#374151",position:"sticky",top:0,background:"#f9fafb",zIndex:10,width:30},children:"#"}),r.jsx("th",{rowSpan:2,style:{padding:"8px 6px",textAlign:"center",borderBottom:"1px solid #e5e7eb",fontWeight:600,color:"#374151",position:"sticky",top:0,background:"#f9fafb",zIndex:10,width:50},children:"위험"}),r.jsx("th",{rowSpan:2,style:{padding:"8px 6px",textAlign:"left",borderBottom:"1px solid #e5e7eb",fontWeight:600,color:"#374151",position:"sticky",top:0,background:"#f9fafb",zIndex:10,minWidth:180},children:"거래처"}),r.jsx("th",{rowSpan:2,style:{padding:"8px 6px",textAlign:"center",borderBottom:"1px solid #e5e7eb",fontWeight:600,color:"#374151",position:"sticky",top:0,background:"#f9fafb",zIndex:10,width:60},children:"등급"}),r.jsx("th",{rowSpan:2,style:{padding:"8px 6px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:600,color:"#374151",position:"sticky",top:0,background:"#f9fafb",zIndex:10,width:90},children:"총채권"}),r.jsx("th",{rowSpan:2,style:{padding:"8px 6px",textAlign:"center",borderBottom:"1px solid #e5e7eb",fontWeight:600,color:"#ef4444",position:"sticky",top:0,background:"#f9fafb",zIndex:10,width:70},children:"최고령"}),r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#6b7280",fontSize:10,position:"sticky",top:0,background:"#f9fafb",zIndex:10,borderLeft:"1px solid #e5e7eb"},children:"1개월미만"}),r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#6b7280",fontSize:10,position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:"2개월미만"}),r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#6b7280",fontSize:10,position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:"3개월미만"}),r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#6b7280",fontSize:10,position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:"4개월미만"}),r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#6b7280",fontSize:10,position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:"5개월미만"}),r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#6b7280",fontSize:10,position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:"6개월미만"}),r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#6b7280",fontSize:10,position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:"7개월미만"})]}),r.jsxs("tr",{style:{background:"#f9fafb"},children:[r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#6b7280",fontSize:10,position:"sticky",top:24,background:"#f9fafb",zIndex:10,borderLeft:"1px solid #e5e7eb"},children:"8개월미만"}),r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#6b7280",fontSize:10,position:"sticky",top:24,background:"#f9fafb",zIndex:10},children:"9개월미만"}),r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#6b7280",fontSize:10,position:"sticky",top:24,background:"#f9fafb",zIndex:10},children:"10개월미만"}),r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#6b7280",fontSize:10,position:"sticky",top:24,background:"#f9fafb",zIndex:10},children:"11개월미만"}),r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#6b7280",fontSize:10,position:"sticky",top:24,background:"#f9fafb",zIndex:10},children:"12개월미만"}),r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#ef4444",fontSize:10,position:"sticky",top:24,background:"#f9fafb",zIndex:10},children:"12개월+"}),r.jsx("th",{style:{padding:"4px 4px",textAlign:"right",borderBottom:"1px solid #e5e7eb",fontWeight:500,color:"#6b7280",fontSize:10,position:"sticky",top:24,background:"#f9fafb",zIndex:10}})]})]}),r.jsx("tbody",{children:c.flatMap((V,Pe)=>{const Ve=(V.aging6190||0)>0||(V.aging91120||0)>0||(V.aging121150||0)>0||(V.aging151180||0)>0||(V.aging181210||0)>0||(V.aging211240||0)>0||(V.aging241270||0)>0||(V.aging271300||0)>0||(V.aging301330||0)>0||(V.aging331365||0)>0||(V.agingOver365||0)>0,tt=()=>(V.agingOver365||0)>0?"12개월+":(V.aging331365||0)>0?"12개월미만":(V.aging301330||0)>0?"11개월미만":(V.aging271300||0)>0?"10개월미만":(V.aging241270||0)>0?"9개월미만":(V.aging211240||0)>0?"8개월미만":(V.aging181210||0)>0?"7개월미만":(V.aging151180||0)>0?"6개월미만":(V.aging121150||0)>0?"5개월미만":(V.aging91120||0)>0?"4개월미만":(V.aging6190||0)>0?"3개월미만":(V.aging3160||0)>0?"2개월미만":(V.aging030||0)>0?"1개월미만":"-",ot=()=>(n==null?void 0:n.customerSeq)===V.customerSeq?"#dbeafe":C===Pe?Ve?"#fecaca":"#f3f4f6":Ve?"#fee2e2":"transparent",ht=tt(),vt=ht!=="-"&&ht!=="1개월미만"&&ht!=="2개월미만";return[r.jsxs("tr",{style:{background:ot(),cursor:"pointer",transition:"background 0.15s ease"},onMouseEnter:()=>w(Pe),onMouseLeave:()=>w(null),onClick:()=>i(V),onContextMenu:Se=>U(Se,V),children:[r.jsx("td",{rowSpan:2,style:{padding:"6px",textAlign:"center",color:"#9ca3af",borderBottom:"1px solid #f3f4f6"},children:Pe+1}),r.jsx("td",{rowSpan:2,style:{padding:"6px",textAlign:"center",borderBottom:"1px solid #f3f4f6"},children:ie(V.riskLevel||"")}),r.jsxs("td",{rowSpan:2,style:{padding:"6px",borderBottom:"1px solid #f3f4f6"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[ae(V.companyType||""),r.jsx("span",{style:{fontWeight:600,fontSize:11},children:V.customerName||"-"})]}),r.jsxs("div",{style:{fontSize:10,color:"#6b7280"},children:[V.salesRep||"-"," · ",V.department||"-"]})]}),r.jsx("td",{rowSpan:2,style:{padding:"6px",textAlign:"center",borderBottom:"1px solid #f3f4f6"},children:J(V.channelName)}),r.jsx("td",{rowSpan:2,style:{padding:"6px",textAlign:"right",fontWeight:600,borderBottom:"1px solid #f3f4f6"},children:G(V.totalAr)}),r.jsx("td",{rowSpan:2,style:{padding:"6px",textAlign:"center",fontWeight:600,fontSize:10,color:vt?"#ef4444":"#6b7280",borderBottom:"1px solid #f3f4f6"},children:ht}),r.jsx("td",{style:{padding:"4px 6px",textAlign:"right",borderLeft:"1px solid #f3f4f6",fontSize:10},children:G(V.aging030)}),r.jsx("td",{style:{padding:"4px 6px",textAlign:"right",fontSize:10},children:G(V.aging3160)}),r.jsx("td",{style:{padding:"4px 6px",textAlign:"right",fontSize:10},children:G(V.aging6190)}),r.jsx("td",{style:{padding:"4px 6px",textAlign:"right",fontSize:10},children:G(V.aging91120)}),r.jsx("td",{style:{padding:"4px 6px",textAlign:"right",fontSize:10},children:G(V.aging121150)}),r.jsx("td",{style:{padding:"4px 6px",textAlign:"right",fontSize:10},children:G(V.aging151180)}),r.jsx("td",{style:{padding:"4px 6px",textAlign:"right",fontSize:10},children:G(V.aging181210)})]},`${Pe}-1`),r.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6",background:ot(),cursor:"pointer",transition:"background 0.15s ease"},onMouseEnter:()=>w(Pe),onMouseLeave:()=>w(null),onClick:()=>i(V),onContextMenu:Se=>U(Se,V),children:[r.jsx("td",{style:{padding:"4px 6px",textAlign:"right",borderLeft:"1px solid #f3f4f6",fontSize:10},children:G(V.aging211240)}),r.jsx("td",{style:{padding:"4px 6px",textAlign:"right",fontSize:10},children:G(V.aging241270)}),r.jsx("td",{style:{padding:"4px 6px",textAlign:"right",fontSize:10},children:G(V.aging271300)}),r.jsx("td",{style:{padding:"4px 6px",textAlign:"right",fontSize:10},children:G(V.aging301330)}),r.jsx("td",{style:{padding:"4px 6px",textAlign:"right",fontSize:10},children:G(V.aging331365)}),r.jsx("td",{style:{padding:"4px 6px",textAlign:"right",color:"#ef4444",fontWeight:600,fontSize:10},children:G(V.agingOver365)}),r.jsx("td",{style:{padding:"4px 6px"}})]},`${Pe}-2`)]})})]})})]})}),O.visible&&r.jsxs("div",{style:{position:"fixed",top:O.y,left:O.x,background:"white",border:"1px solid #e5e7eb",borderRadius:8,boxShadow:"0 4px 12px rgba(0,0,0,0.15)",zIndex:1e3,minWidth:160,overflow:"hidden"},onClick:V=>V.stopPropagation(),children:[r.jsx("div",{style:{padding:"8px 12px",borderBottom:"1px solid #f3f4f6",fontSize:12,color:"#6b7280"},children:(re=O.customer)==null?void 0:re.customerName}),r.jsxs("button",{onClick:ee,style:{width:"100%",padding:"10px 12px",border:"none",background:"transparent",textAlign:"left",cursor:"pointer",fontSize:13,display:"flex",alignItems:"center",gap:8},onMouseEnter:V=>V.currentTarget.style.background="#f3f4f6",onMouseLeave:V=>V.currentTarget.style.background="transparent",children:[r.jsx(Tr,{size:14}),"연체 의견 등록"]})]}),S.show&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:r.jsxs("div",{style:{background:"white",borderRadius:12,width:560,maxHeight:"85vh",overflow:"auto"},children:[r.jsx("div",{style:{padding:20,borderBottom:"1px solid #e5e7eb"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:600},children:"연체 의견 등록"}),r.jsx("button",{onClick:()=>k({show:!1,customer:null}),style:{background:"none",border:"none",cursor:"pointer",padding:4},children:r.jsx(On,{size:20,color:"#6b7280"})})]})}),r.jsxs("div",{style:{padding:20},children:[r.jsxs("div",{style:{marginBottom:20,padding:16,background:"#f9fafb",borderRadius:8},children:[r.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:8},children:(de=S.customer)==null?void 0:de.customerName}),r.jsxs("div",{style:{fontSize:12,color:"#6b7280"},children:["담당: ",((he=S.customer)==null?void 0:he.salesRep)||"-"," | 코드: ",((oe=S.customer)==null?void 0:oe.customerCode)||"-"]})]}),r.jsxs("div",{style:{marginBottom:20},children:[r.jsx("label",{style:{display:"block",fontSize:13,fontWeight:500,marginBottom:8},children:"연체 의견"}),r.jsx("textarea",{value:D.decisionComment,onChange:V=>T(Pe=>({...Pe,decisionComment:V.target.value})),placeholder:"연체 의견을 입력하세요...",style:{width:"100%",height:120,padding:12,border:"1px solid #d1d5db",borderRadius:6,fontSize:13,resize:"none"}})]}),r.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"flex-end"},children:[r.jsx("button",{onClick:()=>k({show:!1,customer:null}),style:{padding:"10px 16px",border:"1px solid #d1d5db",background:"white",borderRadius:6,fontSize:13,cursor:"pointer"},children:"취소"}),r.jsx("button",{onClick:K,disabled:P,style:{padding:"10px 16px",border:"none",background:"#3b82f6",color:"white",borderRadius:6,fontSize:13,fontWeight:500,cursor:P?"not-allowed":"pointer"},children:P?"저장중...":"등록"})]})]})]})}),Y.show&&r.jsxs("div",{style:{position:"fixed",top:20,left:"50%",transform:"translateX(-50%)",padding:"12px 20px",background:Y.type==="success"?"#dcfce7":Y.type==="error"?"#fee2e2":"#fef3c7",border:`1px solid ${Y.type==="success"?"#86efac":Y.type==="error"?"#fecaca":"#fde68a"}`,borderRadius:8,boxShadow:"0 4px 12px rgba(0,0,0,0.1)",zIndex:1002,display:"flex",alignItems:"center",gap:8},children:[Y.type==="success"?r.jsx(rs,{size:16,color:"#16a34a"}):Y.type==="error"?r.jsx(Ti,{size:16,color:"#dc2626"}):r.jsx(ha,{size:16,color:"#d97706"}),r.jsx("span",{style:{fontSize:13,color:Y.type==="success"?"#166534":Y.type==="error"?"#991b1b":"#92400e"},children:Y.message}),r.jsx("button",{onClick:()=>X({show:!1,message:"",type:"success"}),style:{background:"none",border:"none",cursor:"pointer",marginLeft:8},children:r.jsx(On,{size:14})})]}),H.show&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:r.jsxs("div",{style:{background:"white",borderRadius:12,width:1e3,height:"90vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[r.jsx("div",{style:{padding:20,borderBottom:"1px solid #e5e7eb"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{margin:0,fontSize:16,fontWeight:600,display:"flex",alignItems:"center",gap:8},children:[r.jsx(No,{size:20,color:"#ef4444"}),"연체의견 요약"]}),r.jsx("button",{onClick:()=>q({show:!1,loading:!1,opinions:[]}),style:{background:"none",border:"none",cursor:"pointer",padding:4},children:r.jsx(On,{size:20,color:"#6b7280"})})]})}),r.jsx("div",{style:{flex:1,overflow:"hidden",padding:20,display:"flex",flexDirection:"column"},children:H.loading?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(ln,{size:24,style:{animation:"spin 1s linear infinite"}}),r.jsx("p",{children:"데이터 로딩 중..."})]}):H.opinions.length===0?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"등록된 연체의견이 없습니다."}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{marginBottom:20},children:[r.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:10,color:"#374151"},children:"담당자별 요약"}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:Object.entries(H.opinions.reduce((V,Pe)=>{const Ve=Pe.emp_name||"미지정";return V[Ve]=(V[Ve]||0)+1,V},{})).map(([V,Pe])=>r.jsxs("div",{style:{padding:"6px 12px",background:"#f3f4f6",borderRadius:6,fontSize:12,display:"flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{fontWeight:500},children:V}),r.jsxs("span",{style:{background:"#ef4444",color:"white",padding:"2px 6px",borderRadius:10,fontSize:11,fontWeight:600},children:[Pe,"건"]})]},V))})]}),r.jsxs("div",{style:{fontSize:13,fontWeight:600,marginBottom:10,color:"#374151"},children:["의견 목록 (",H.opinions.length,"건)"]}),r.jsx("div",{style:{flex:1,overflow:"auto",border:"1px solid #e5e7eb",borderRadius:8},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:1},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid #e5e7eb",width:120},children:"작성자"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid #e5e7eb",width:180},children:"거래처명"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"의견 내용"})]})}),r.jsx("tbody",{children:H.opinions.map(V=>r.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[r.jsx("td",{style:{padding:"10px 12px",fontWeight:500},children:V.emp_name||"-"}),r.jsx("td",{style:{padding:"10px 12px"},children:V.customer_name||"-"}),r.jsx("td",{style:{padding:"10px 12px",color:"#4b5563"},children:V.opinion_text||"-"})]},V.id))})]})})]})}),r.jsx("div",{style:{padding:16,borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end"},children:r.jsx("button",{onClick:()=>q({show:!1,loading:!1,opinions:[]}),style:{padding:"8px 16px",background:"#f3f4f6",color:"#374151",border:"none",borderRadius:6,fontSize:13,cursor:"pointer"},children:"닫기"})})]})}),M.show&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:r.jsxs("div",{style:{background:"white",borderRadius:12,width:1e3,height:"90vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[r.jsx("div",{style:{padding:20,borderBottom:"1px solid #e5e7eb"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{margin:0,fontSize:16,fontWeight:600,display:"flex",alignItems:"center",gap:8},children:[r.jsx(Tr,{size:20,color:"#3b82f6"}),"채권활동 요약"]}),r.jsx("button",{onClick:()=>L({show:!1,loading:!1,activities:[]}),style:{background:"none",border:"none",cursor:"pointer",padding:4},children:r.jsx(On,{size:20,color:"#6b7280"})})]})}),r.jsx("div",{style:{flex:1,overflow:"hidden",padding:20,display:"flex",flexDirection:"column"},children:M.loading?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(ln,{size:24,style:{animation:"spin 1s linear infinite"}}),r.jsx("p",{children:"데이터 로딩 중..."})]}):M.activities.length===0?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"등록된 채권활동이 없습니다."}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{marginBottom:20},children:[r.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:10,color:"#374151"},children:"담당자별 요약"}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:Object.entries(M.activities.reduce((V,Pe)=>{const Ve=Pe.emp_name||"미지정";return V[Ve]=(V[Ve]||0)+1,V},{})).map(([V,Pe])=>r.jsxs("div",{style:{padding:"6px 12px",background:"#f3f4f6",borderRadius:6,fontSize:12,display:"flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{fontWeight:500},children:V}),r.jsxs("span",{style:{background:"#3b82f6",color:"white",padding:"2px 6px",borderRadius:10,fontSize:11,fontWeight:600},children:[Pe,"건"]})]},V))})]}),r.jsxs("div",{style:{fontSize:13,fontWeight:600,marginBottom:10,color:"#374151"},children:["활동 목록 (",M.activities.length,"건)"]}),r.jsx("div",{style:{flex:1,overflow:"auto",border:"1px solid #e5e7eb",borderRadius:8},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:1},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid #e5e7eb",width:100},children:"담당자"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid #e5e7eb",width:140},children:"거래처명"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid #e5e7eb",width:160},children:"활동제목"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"내용"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid #e5e7eb",width:100},children:"활동일자"})]})}),r.jsx("tbody",{children:M.activities.map(V=>r.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[r.jsx("td",{style:{padding:"10px 12px",fontWeight:500},children:V.emp_name||"-"}),r.jsx("td",{style:{padding:"10px 12px"},children:V.customer_name||"-"}),r.jsx("td",{style:{padding:"10px 12px"},children:V.subject||"-"}),r.jsx("td",{style:{padding:"10px 12px",color:"#4b5563"},children:V.description||"-"}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"center",color:"#6b7280"},children:V.activity_date?new Date(V.activity_date).toLocaleDateString("ko-KR"):"-"})]},V.id))})]})})]})}),r.jsx("div",{style:{padding:16,borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end"},children:r.jsx("button",{onClick:()=>L({show:!1,loading:!1,activities:[]}),style:{padding:"8px 16px",background:"#f3f4f6",color:"#374151",border:"none",borderRadius:6,fontSize:13,cursor:"pointer"},children:"닫기"})})]})}),B.show&&r.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1001},children:r.jsxs("div",{style:{background:"white",borderRadius:12,width:1e3,height:"90vh",overflow:"hidden",display:"flex",flexDirection:"column"},children:[r.jsx("div",{style:{padding:20,borderBottom:"1px solid #e5e7eb"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("h3",{style:{margin:0,fontSize:16,fontWeight:600,display:"flex",alignItems:"center",gap:8},children:[r.jsx(YN,{size:20,color:"#10b981"}),"통제해제 요약"]}),r.jsx("button",{onClick:()=>F({show:!1,loading:!1,requests:[]}),style:{background:"none",border:"none",cursor:"pointer",padding:4},children:r.jsx(On,{size:20,color:"#6b7280"})})]})}),r.jsx("div",{style:{flex:1,overflow:"hidden",padding:20,display:"flex",flexDirection:"column"},children:B.loading?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(ln,{size:24,style:{animation:"spin 1s linear infinite"}}),r.jsx("p",{children:"데이터 로딩 중..."})]}):B.requests.length===0?r.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"등록된 통제해제 요청이 없습니다."}):r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{marginBottom:20},children:[r.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:10,color:"#374151"},children:"담당자별 요약"}),r.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:Object.entries(B.requests.reduce((V,Pe)=>{const Ve=Pe.emp_name||"미지정";return V[Ve]=(V[Ve]||0)+1,V},{})).map(([V,Pe])=>r.jsxs("div",{style:{padding:"6px 12px",background:"#f3f4f6",borderRadius:6,fontSize:12,display:"flex",alignItems:"center",gap:6},children:[r.jsx("span",{style:{fontWeight:500},children:V}),r.jsxs("span",{style:{background:"#10b981",color:"white",padding:"2px 6px",borderRadius:10,fontSize:11,fontWeight:600},children:[Pe,"건"]})]},V))})]}),r.jsxs("div",{style:{fontSize:13,fontWeight:600,marginBottom:10,color:"#374151"},children:["요청 목록 (",B.requests.length,"건)"]}),r.jsx("div",{style:{flex:1,overflow:"auto",border:"1px solid #e5e7eb",borderRadius:8},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[r.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:1},children:r.jsxs("tr",{children:[r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid #e5e7eb",width:100},children:"등록자"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid #e5e7eb",width:140},children:"거래처명"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"해제 사유"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid #e5e7eb"},children:"수금 계획"})]})}),r.jsx("tbody",{children:B.requests.map(V=>r.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[r.jsx("td",{style:{padding:"10px 12px",fontWeight:500},children:V.emp_name||"-"}),r.jsx("td",{style:{padding:"10px 12px"},children:V.customer_name||"-"}),r.jsx("td",{style:{padding:"10px 12px",color:"#4b5563"},children:V.reason_text||"-"}),r.jsx("td",{style:{padding:"10px 12px",color:"#4b5563"},children:V.collection_plan||"-"})]},V.id))})]})})]})}),r.jsx("div",{style:{padding:16,borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end"},children:r.jsx("button",{onClick:()=>F({show:!1,loading:!1,requests:[]}),style:{padding:"8px 16px",background:"#f3f4f6",color:"#374151",border:"none",borderRadius:6,fontSize:13,cursor:"pointer"},children:"닫기"})})]})})]})}function OY({activeMeeting:e,onFinishMeeting:n}){const[i,s]=p.useState([]),[a,o]=p.useState(!1),[l,c]=p.useState(!1),[d,u]=p.useState("의견"),[f,h]=p.useState(""),[m,g]=p.useState(""),[b,j]=p.useState(""),[y,x]=p.useState([]),[v,A]=p.useState(""),[N,C]=p.useState(!1),[w,_]=p.useState(null),[I,O]=p.useState("의견"),[E,S]=p.useState(""),[k,D]=p.useState({show:!1,remarkId:null}),[T,P]=p.useState({show:!1,message:"",type:"error"}),R=async()=>{try{const $=await fetch("/api/v1/employees?depts=all");if($.ok){const W=await $.json();x(W)}}catch($){console.error("Failed to load employees",$)}};p.useEffect(()=>{R()},[]);const Y=y.filter($=>{var W;return $.emp_name.toLowerCase().includes(v.toLowerCase())||((W=$.dept_name)==null?void 0:W.toLowerCase().includes(v.toLowerCase()))}).slice(0,10),X=$=>{j($.emp_id),g($.emp_name),A($.emp_name),C(!1)},H=async()=>{if(e!=null&&e.id){o(!0);try{const $=await fetch(`/api/v1/credit/meetings/${e.id}/remarks`);if(!$.ok)throw new Error("API 호출 실패");const U=((await $.json()).remarks||[]).map(Z=>({id:Z.id,meetingId:Z.meeting_id,remarkType:Z.remark_type,authorId:Z.author_id,authorName:Z.author_name,remarkText:Z.remark_text,createdAt:Z.created_at}));s(U)}catch($){console.error("회의 의견 조회 실패:",$)}finally{o(!1)}}};p.useEffect(()=>{H()},[e==null?void 0:e.id]);const q=async()=>{if(!f.trim()||!m.trim()||!b){P({show:!0,message:"의견 제기자를 선택하고 내용을 입력해주세요.",type:"warning"});return}c(!0);try{const $=await fetch(`/api/v1/credit/meetings/${e.id}/remarks`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({remarkType:d,authorId:b,authorName:m.trim(),remarkText:f.trim()})});if(!$.ok)throw new Error("등록 실패");const W=await $.json();W.success?(h(""),g(""),j(""),A(""),H()):P({show:!0,message:W.error||"등록에 실패했습니다.",type:"error"})}catch($){console.error("회의 의견 등록 실패:",$),P({show:!0,message:"등록 중 오류가 발생했습니다.",type:"error"})}finally{c(!1)}},M=$=>{_($),O($.remarkType),S($.remarkText)},L=async()=>{if(w){if(!E.trim()){P({show:!0,message:"내용을 입력해주세요.",type:"warning"});return}try{const $=await fetch(`/api/v1/credit/meetings/${e.id}/remarks/${w.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({remarkType:I,remarkText:E})});if(!$.ok)throw new Error("수정 실패");const W=await $.json();W.success?(_(null),H(),P({show:!0,message:"의견이 수정되었습니다.",type:"success"})):P({show:!0,message:W.error||"수정에 실패했습니다.",type:"error"})}catch($){console.error("회의 의견 수정 실패:",$),P({show:!0,message:"수정 중 오류가 발생했습니다.",type:"error"})}}},B=$=>{D({show:!0,remarkId:$})},F=async()=>{if(k.remarkId)try{const $=await fetch(`/api/v1/credit/meetings/${e.id}/remarks/${k.remarkId}`,{method:"DELETE"});if(!$.ok)throw new Error("삭제 실패");const W=await $.json();W.success?(D({show:!1,remarkId:null}),H(),P({show:!0,message:"의견이 삭제되었습니다.",type:"success"})):P({show:!0,message:W.error||"삭제에 실패했습니다.",type:"error"})}catch($){console.error("회의 의견 삭제 실패:",$),P({show:!0,message:"삭제 중 오류가 발생했습니다.",type:"error"})}},te=$=>$?new Date($).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-";return r.jsxs("div",{style:{maxWidth:900},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24,padding:16,background:"#ecfdf5",borderRadius:12,border:"1px solid #6ee7b7"},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#10b981",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(fr,{size:20,color:"#fff"})}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h2",{style:{fontSize:18,fontWeight:700,color:"#111827",margin:0},children:"회의 종료"}),r.jsx("p",{style:{margin:"2px 0 0 0",color:"#6b7280",fontSize:13},children:"Meeting Closure"})]}),r.jsx("div",{style:{padding:"6px 12px",background:"rgba(255,255,255,0.8)",borderRadius:6,fontSize:12,color:"#374151"},children:r.jsx("strong",{children:e.meetingName})})]}),r.jsxs("div",{style:{background:"#fff",borderRadius:12,border:"2px solid #10b981",padding:20,marginBottom:24},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsx(Nf,{size:20,color:"#10b981"}),r.jsx("h3",{style:{fontSize:16,fontWeight:700,color:"#111827",margin:0},children:"회의 의견 작성"})]}),r.jsx("button",{onClick:q,disabled:l||!f.trim()||!b||e.meeting_status==="FINISHED",title:e.meeting_status==="FINISHED"?"종료된 회의입니다":"",style:{padding:"8px 16px",background:l||!f.trim()||!b||e.meeting_status==="FINISHED"?"#9ca3af":"#10b981",color:"white",border:"none",borderRadius:8,fontSize:13,fontWeight:600,cursor:l||!f.trim()||!b||e.meeting_status==="FINISHED"?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:6,opacity:e.meeting_status==="FINISHED"?.7:1},children:l?r.jsxs(r.Fragment,{children:[r.jsx(ln,{size:14,style:{animation:"spin 1s linear infinite"}}),"등록 중..."]}):r.jsxs(r.Fragment,{children:[r.jsx(mr,{size:14}),"의견 등록"]})})]}),r.jsxs("div",{style:{display:"flex",gap:12,marginBottom:12},children:[r.jsxs("div",{style:{width:120},children:[r.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:"유형"}),r.jsxs("select",{value:d,onChange:$=>u($.target.value),style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,outline:"none"},children:[r.jsx("option",{value:"의견",children:"의견"}),r.jsx("option",{value:"지시",children:"지시"})]})]}),r.jsxs("div",{style:{width:200,position:"relative"},children:[r.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:["의견 제기자 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("input",{type:"text",value:v,onChange:$=>{A($.target.value),C(!0),$.target.value||(j(""),g(""))},onFocus:()=>C(!0),onBlur:()=>setTimeout(()=>C(!1),200),placeholder:"이름 또는 부서 검색",style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,outline:"none"}}),N&&v.length>0&&Y.length>0&&r.jsx("div",{style:{position:"absolute",top:"100%",left:0,right:0,background:"white",border:"1px solid #d1d5db",borderRadius:6,boxShadow:"0 4px 6px rgba(0,0,0,0.1)",maxHeight:200,overflowY:"auto",zIndex:100},children:Y.map($=>r.jsxs("div",{onClick:()=>X($),style:{padding:"8px 12px",cursor:"pointer",borderBottom:"1px solid #f3f4f6",fontSize:13},onMouseEnter:W=>W.currentTarget.style.background="#f3f4f6",onMouseLeave:W=>W.currentTarget.style.background="white",children:[r.jsx("div",{style:{fontWeight:500},children:$.emp_name}),r.jsx("div",{style:{fontSize:11,color:"#6b7280"},children:$.dept_name})]},$.emp_id))})]})]}),r.jsxs("div",{style:{marginBottom:12},children:[r.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:4},children:["내용 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("textarea",{value:f,onChange:$=>h($.target.value),placeholder:"의견 또는 지시 내용을 입력하세요",rows:3,style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,outline:"none",resize:"none",lineHeight:1.5}})]})]}),r.jsxs("div",{style:{background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden"},children:[r.jsxs("div",{style:{padding:"14px 20px",background:"#f9fafb",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx(Tr,{size:18,color:"#374151"}),r.jsx("span",{style:{fontSize:14,fontWeight:700,color:"#111827"},children:"회의 의견 목록"}),r.jsxs("span",{style:{padding:"2px 8px",background:"#e5e7eb",borderRadius:10,fontSize:12,fontWeight:600,color:"#374151"},children:[i.length,"건"]})]}),r.jsxs("button",{onClick:H,disabled:a,style:{padding:"6px 12px",background:"transparent",border:"1px solid #d1d5db",borderRadius:6,fontSize:12,color:"#6b7280",cursor:"pointer",display:"flex",alignItems:"center",gap:4},children:[r.jsx(ln,{size:12,style:{animation:a?"spin 1s linear infinite":"none"}}),"새로고침"]})]}),r.jsx("div",{style:{maxHeight:400,overflow:"auto"},children:a?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(ln,{size:24,style:{animation:"spin 1s linear infinite"}}),r.jsx("p",{style:{marginTop:8},children:"로딩 중..."})]}):i.length===0?r.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(Nf,{size:32,strokeWidth:1}),r.jsx("p",{style:{marginTop:8,fontSize:14},children:"등록된 회의 의견이 없습니다"})]}):i.map(($,W)=>r.jsxs("div",{style:{padding:"16px 20px",borderBottom:W<i.length-1?"1px solid #f3f4f6":"none",background:W%2===0?"#fff":"#fafafa"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:8},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[r.jsx("span",{style:{padding:"3px 8px",borderRadius:4,fontSize:11,fontWeight:700,background:$.remarkType==="지시"?"#fee2e2":"#dbeafe",color:$.remarkType==="지시"?"#dc2626":"#2563eb"},children:$.remarkType}),r.jsx("span",{style:{fontSize:13,fontWeight:600,color:"#111827"},children:$.authorName}),r.jsx("span",{style:{fontSize:11,color:"#9ca3af"},children:te($.createdAt)})]}),r.jsxs("div",{style:{display:"flex",gap:4},children:[r.jsx("button",{onClick:()=>{e.meeting_status!=="FINISHED"&&M($)},disabled:e.meeting_status==="FINISHED",style:{padding:"4px 8px",background:"transparent",border:"none",borderRadius:4,color:e.meeting_status==="FINISHED"?"#d1d5db":"#9ca3af",cursor:e.meeting_status==="FINISHED"?"not-allowed":"pointer",opacity:e.meeting_status==="FINISHED"?.5:1},onMouseEnter:U=>{e.meeting_status!=="FINISHED"&&(U.currentTarget.style.color="#3b82f6")},onMouseLeave:U=>{e.meeting_status!=="FINISHED"&&(U.currentTarget.style.color="#9ca3af")},title:e.meeting_status==="FINISHED"?"종료된 회의입니다":"수정",children:r.jsx(Wv,{size:14})}),r.jsx("button",{onClick:()=>{e.meeting_status!=="FINISHED"&&B($.id)},disabled:e.meeting_status==="FINISHED",style:{padding:"4px 8px",background:"transparent",border:"none",borderRadius:4,color:e.meeting_status==="FINISHED"?"#d1d5db":"#9ca3af",cursor:e.meeting_status==="FINISHED"?"not-allowed":"pointer",opacity:e.meeting_status==="FINISHED"?.5:1},onMouseEnter:U=>{e.meeting_status!=="FINISHED"&&(U.currentTarget.style.color="#ef4444")},onMouseLeave:U=>{e.meeting_status!=="FINISHED"&&(U.currentTarget.style.color="#9ca3af")},title:e.meeting_status==="FINISHED"?"종료된 회의입니다":"삭제",children:r.jsx(la,{size:14})})]})]}),r.jsx("p",{style:{margin:0,fontSize:13,color:"#374151",lineHeight:1.6,whiteSpace:"pre-wrap"},children:$.remarkText})]},$.id))})]}),e.meeting_status!=="FINISHED"&&n&&r.jsxs("div",{style:{marginTop:24,padding:20,background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",borderRadius:12,border:"2px solid #f59e0b",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#f59e0b",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(fr,{size:20,color:"#fff"})}),r.jsxs("div",{children:[r.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:700,color:"#92400e"},children:"회의 종료 준비가 완료되었나요?"}),r.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#a16207"},children:"모든 의견 작성이 완료되면 아래 버튼을 클릭하여 회의를 종료하세요."})]})]}),r.jsxs("button",{onClick:n,style:{padding:"10px 24px",background:"#f59e0b",color:"white",border:"none",borderRadius:8,fontSize:14,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",gap:8,boxShadow:"0 2px 8px rgba(245, 158, 11, 0.3)"},children:[r.jsx(fr,{size:16}),"회의 종료"]})]}),e.meeting_status==="FINISHED"&&r.jsxs("div",{style:{marginTop:24,padding:16,background:"#dcfce7",borderRadius:12,border:"1px solid #86efac",display:"flex",alignItems:"center",gap:12},children:[r.jsx(fr,{size:24,color:"#16a34a"}),r.jsxs("div",{children:[r.jsx("h4",{style:{margin:0,fontSize:14,fontWeight:700,color:"#166534"},children:"회의가 종료되었습니다"}),r.jsx("p",{style:{margin:"4px 0 0",fontSize:12,color:"#15803d"},children:"이 회의의 모든 절차가 완료되었습니다."})]})]}),w&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:12,width:500,maxWidth:"90%",boxShadow:"0 20px 40px rgba(0,0,0,0.2)"},children:[r.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"의견 수정"}),r.jsx("button",{onClick:()=>_(null),style:{background:"none",border:"none",cursor:"pointer",padding:4},children:r.jsx(On,{size:18,color:"#6b7280"})})]}),r.jsxs("div",{style:{padding:20},children:[r.jsxs("div",{style:{marginBottom:16},children:[r.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:6},children:"유형"}),r.jsxs("select",{value:I,onChange:$=>O($.target.value),style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13},children:[r.jsx("option",{value:"의견",children:"의견"}),r.jsx("option",{value:"지시",children:"지시"})]})]}),r.jsxs("div",{style:{marginBottom:16},children:[r.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:6},children:"작성자"}),r.jsx("input",{type:"text",value:w.authorName,disabled:!0,style:{width:"100%",padding:"8px 10px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,background:"#f9fafb",color:"#6b7280"}})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#374151",marginBottom:6},children:["내용 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("textarea",{value:E,onChange:$=>S($.target.value),rows:4,style:{width:"100%",padding:"10px 12px",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,resize:"none",lineHeight:1.5}})]})]}),r.jsxs("div",{style:{padding:"12px 20px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end",gap:8},children:[r.jsx("button",{onClick:()=>_(null),style:{padding:"8px 16px",background:"#f3f4f6",border:"none",borderRadius:6,fontSize:13,color:"#374151",cursor:"pointer"},children:"취소"}),r.jsx("button",{onClick:L,disabled:!E.trim(),style:{padding:"8px 16px",background:E.trim()?"#3b82f6":"#9ca3af",border:"none",borderRadius:6,fontSize:13,color:"white",cursor:E.trim()?"pointer":"not-allowed"},children:"저장"})]})]})}),k.show&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:12,width:400,maxWidth:"90%",boxShadow:"0 20px 40px rgba(0,0,0,0.2)"},children:[r.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[r.jsx("div",{style:{width:48,height:48,borderRadius:"50%",background:"#fee2e2",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:16},children:r.jsx(ha,{size:24,color:"#dc2626"})}),r.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:16,fontWeight:700,color:"#111827"},children:"의견 삭제"}),r.jsxs("p",{style:{margin:0,fontSize:14,color:"#6b7280"},children:["이 의견을 삭제하시겠습니까?",r.jsx("br",{}),"삭제 후에는 복구할 수 없습니다."]})]}),r.jsxs("div",{style:{padding:"12px 20px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"center",gap:8},children:[r.jsx("button",{onClick:()=>D({show:!1,remarkId:null}),style:{padding:"8px 24px",background:"#f3f4f6",border:"none",borderRadius:6,fontSize:13,color:"#374151",cursor:"pointer"},children:"취소"}),r.jsx("button",{onClick:F,style:{padding:"8px 24px",background:"#ef4444",border:"none",borderRadius:6,fontSize:13,color:"white",cursor:"pointer"},children:"삭제"})]})]})}),T.show&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:r.jsxs("div",{style:{background:"white",borderRadius:12,width:400,maxWidth:"90%",boxShadow:"0 20px 40px rgba(0,0,0,0.2)"},children:[r.jsxs("div",{style:{padding:"20px",display:"flex",flexDirection:"column",alignItems:"center",textAlign:"center"},children:[r.jsxs("div",{style:{width:48,height:48,borderRadius:"50%",background:T.type==="error"?"#fee2e2":T.type==="success"?"#dcfce7":"#fef3c7",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:16},children:[T.type==="error"&&r.jsx(Ti,{size:24,color:"#dc2626"}),T.type==="success"&&r.jsx(fr,{size:24,color:"#16a34a"}),T.type==="warning"&&r.jsx(ha,{size:24,color:"#d97706"})]}),r.jsx("h3",{style:{margin:"0 0 8px 0",fontSize:16,fontWeight:700,color:"#111827"},children:T.type==="error"?"오류":T.type==="success"?"완료":"알림"}),r.jsx("p",{style:{margin:0,fontSize:14,color:"#6b7280"},children:T.message})]}),r.jsx("div",{style:{padding:"12px 20px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"center"},children:r.jsx("button",{onClick:()=>P({show:!1,message:"",type:"error"}),style:{padding:"8px 32px",background:T.type==="error"?"#ef4444":T.type==="success"?"#22c55e":"#f59e0b",border:"none",borderRadius:6,fontSize:13,color:"white",cursor:"pointer"},children:"확인"})})]})})]})}function DY(){const[e,n]=p.useState(null),[i,s]=p.useState([]),[a,o]=p.useState(!1),[l,c]=p.useState("create"),[d,u]=p.useState(!1),[f,h]=p.useState(""),[m,g]=p.useState(new Date().toISOString().split("T")[0]),[b,j]=p.useState(""),[y,x]=p.useState(""),[v,A]=p.useState(null),[N,C]=p.useState(!1),[w,_]=p.useState(!1),[I,O]=p.useState({show:!1,type:"info",title:"",message:""}),E=($,W,U,Z,ee)=>{O({show:!0,type:$,title:W,message:U,onConfirm:Z,onCancel:ee})},S=()=>{O($=>({...$,show:!1}))},k=async()=>{if(e){_(!0);try{const W=await(await fetch(`/api/v1/credit/ar-aging/summary?meetingId=${e.id}`)).json();W.success&&W.summary?A(W.summary):A(null)}catch($){console.error($),A(null)}finally{_(!1)}}},D=async $=>{if(e){C(!0);try{const U=await(await fetch(`/api/v1/credit/meetings/${e.id}/generate-data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({meetingDate:e.meetingDate,overwrite:$})})).json();U.success?(E("success","자료 생성 완료",`AR Aging 데이터가 성공적으로 생성되었습니다.

TNT: ${U.tntCount}건
DYS: ${U.dysCount}건
총: ${U.totalCount}건`),k(),P()):U.existsForMeeting?E("confirm","기존 데이터 존재",`해당 회의에 AR Aging 데이터가 이미 존재합니다.

기존 데이터를 삭제하고 새로 생성하시겠습니까?`,()=>{S(),D(!0)},S):E("error","자료 생성 실패",U.error||"자료 생성에 실패했습니다.")}catch(W){console.error(W),E("error","오류 발생","자료 생성 중 오류가 발생했습니다.")}finally{C(!1)}}},T=()=>{if(!e){E("warning","회의 미선택","회의를 먼저 선택해주세요.");return}if(v){E("confirm","기존 데이터 존재",`해당 회의 일자(${e.meetingDate})로 이미 자료가 존재합니다.

기존 데이터를 삭제하고 새로 생성하시겠습니까?`,()=>{S(),D(!0)},S);return}E("confirm","AR Aging 데이터 생성",`${e.meetingDate} 일자로 AR Aging 데이터를 생성하시겠습니까?

ERP에서 데이터를 가져오며, 다소 시간이 소요될 수 있습니다.`,()=>{S(),D(!1)},S)},P=async()=>{o(!0);try{const W=await(await fetch("/api/v1/credit/meetings")).json(),U={PLANNED:"PLANNED",DATA_GENERATED:"PLANNED",ON_GOING:"IN_PROGRESS",FINISHED:"CLOSED",POSTPONED:"PLANNED"},Z={PLANNED:"create",DATA_GENERATED:"prepare",ON_GOING:"progress",FINISHED:"close",POSTPONED:"create"},ee=(W.meetings||[]).map(K=>({id:K.id,meetingCode:K.meeting_code,meetingName:K.meeting_name,meetingDate:K.meeting_date,status:U[K.meeting_status]||"PLANNED",meeting_status:K.meeting_status||"PLANNED",currentStep:Z[K.meeting_status]||"create",customerCount:K.customer_count||0,preparedCount:K.prepared_count||0,reviewedCount:K.reviewed_count||0,closedCount:K.closed_count||0,remark:K.remark||""}));s(ee)}catch($){console.error($)}finally{o(!1)}};p.useEffect(()=>{P()},[]),p.useEffect(()=>{l==="prepare"&&e&&k()},[l,e]);const R=async($,W)=>{try{const U=So(),ee=await(await fetch(`/api/v1/credit/meetings/${$}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:W,updatedBy:U})})).json();return ee.success?(n(K=>K?{...K,meeting_status:W}:null),P(),!0):(console.error("Failed to update meeting status:",ee.error),!1)}catch(U){return console.error("Error updating meeting status:",U),!1}},Y=async()=>{if(!e)return;await R(e.id,"ON_GOING")&&c("progress")},X=async()=>{if(!e)return;await R(e.id,"FINISHED")&&E("success","회의 종료","회의가 성공적으로 종료되었습니다.")},H=async($,W)=>{if(W.stopPropagation(),$.meeting_status!=="PLANNED"){E("error","삭제 불가","PLANNED 상태의 회의만 삭제할 수 있습니다.");return}E("confirm","회의 삭제",`"${$.meetingName}" 회의를 삭제하시겠습니까?

삭제된 회의는 복구할 수 없습니다.`,async()=>{S();try{const Z=await(await fetch(`/api/v1/credit/meetings/${$.id}`,{method:"DELETE"})).json();Z.success?(E("success","삭제 완료","회의가 삭제되었습니다."),(e==null?void 0:e.id)===$.id&&n(null),P()):E("error","삭제 실패",Z.error||"회의 삭제에 실패했습니다.")}catch(U){console.error("Error deleting meeting:",U),E("error","삭제 실패","회의 삭제 중 오류가 발생했습니다.")}},S)},q=$=>{n($),c("prepare")},M=($,W)=>{switch(W){case"new-meeting":u(!0);break;case"select-meeting":window.location.hash="credit:meetings",window.dispatchEvent(new CustomEvent("tnt.sales.navigate",{detail:{key:"credit:meetings"}}));break;case"start-meeting":case"review-customer":e&&(window.location.hash=`credit:meeting:${e.id}`,window.dispatchEvent(new CustomEvent("tnt.sales.navigate",{detail:{key:`credit:meeting:${e.id}`}})));break;default:alert(`${W} 기능은 준비 중입니다.`)}},L=async()=>{if(!f||!m){alert("회의명과 일자를 입력해주세요.");return}try{const W=await(await fetch("/api/v1/credit/meetings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({meetingCode:`MTG-${m.replace(/-/g,"")}`,meetingName:f,meetingDate:m,remark:b})})).json();if(W.success){const U={id:W.id,meetingCode:W.meetingCode||`MTG-${m.replace(/-/g,"")}`,meetingName:f,meetingDate:m,status:"PLANNED",meeting_status:"PLANNED",currentStep:"prepare",customerCount:0,preparedCount:0,reviewedCount:0,closedCount:0};u(!1),h(""),j(""),P(),n(U),c("review")}else alert(W.error||"회의 생성에 실패했습니다.")}catch($){console.error($),alert("회의 생성 중 오류가 발생했습니다.")}},B=$=>{if(!e)return $==="create";switch(e.meeting_status){case"PLANNED":return $==="create"||$==="review"||$==="prepare";case"DATA_GENERATED":return $==="create"||$==="review"||$==="prepare"||$==="progress";case"ON_GOING":return $==="create"||$==="review"||$==="prepare"||$==="progress"||$==="close";case"FINISHED":return!0;case"POSTPONED":return $==="create"||$==="review"||$==="prepare";default:return $==="create"}},F=$=>{if(!e){const ae=["create","review","prepare","progress","close"],ie=ae.indexOf(l),J=ae.indexOf($);return J<ie?"completed":J===ie?"current":"upcoming"}const W=e.meeting_status,U=["create","review","prepare","progress","close"],Z=U.indexOf($),K={PLANNED:0,DATA_GENERATED:2,ON_GOING:2,FINISHED:4,POSTPONED:0}[W]??0,pe={PLANNED:"review",DATA_GENERATED:"progress",ON_GOING:"progress",FINISHED:"close",POSTPONED:"review"}[W]??"create",G=U.indexOf(pe);return Z<K?"completed":$===pe||Z===G?"current":Z<=K?"completed":"upcoming"},te=i.filter($=>$.meetingName.toLowerCase().includes(y.toLowerCase()));return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8fafc"},children:[r.jsx("div",{style:{padding:"20px 32px",background:"linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%)",color:"white"},children:r.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{children:[r.jsx("h1",{style:{fontSize:24,fontWeight:800,margin:0,letterSpacing:"-0.5px"},children:"채권회의 Workflow"}),r.jsx("p",{style:{margin:"4px 0 0 0",fontSize:14,opacity:.9},children:"체계적인 채권 심사 프로세스를 진행하세요"})]}),e&&r.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",backdropFilter:"blur(10px)",padding:"10px 16px",borderRadius:10,border:"1px solid rgba(255,255,255,0.3)"},children:[r.jsx("div",{style:{fontSize:10,opacity:.8,marginBottom:2},children:"선택된 회의"}),r.jsx("div",{style:{fontSize:15,fontWeight:700},children:e.meetingName})]})]})}),r.jsx("div",{style:{padding:"20px 32px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",position:"relative"},children:[r.jsx("div",{style:{position:"absolute",top:"50%",left:60,right:60,height:4,background:"#e5e7eb",transform:"translateY(-50%)",zIndex:0}}),Ev.map($=>{const W=F($.id),U=$.icon,Z=B($.id),ee=Z&&$.id!=="create";return r.jsxs("div",{onClick:()=>ee&&c($.id),style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:ee?"pointer":"default",opacity:Z?1:.4,zIndex:1,flex:1},children:[r.jsx("div",{style:{width:48,height:48,borderRadius:"50%",background:W==="completed"?"#10b981":W==="current"?$.color:Z?"#fff":"#f3f4f6",border:`3px solid ${W==="completed"?"#10b981":W==="current"?$.color:Z?"#d1d5db":"#e5e7eb"}`,display:"flex",alignItems:"center",justifyContent:"center",transition:"all 0.3s",boxShadow:W==="current"?`0 0 0 4px ${$.bgColor}`:"none"},children:W==="completed"?r.jsx(rs,{size:20,color:"#fff",strokeWidth:3}):r.jsx(U,{size:20,color:W==="current"?"#fff":Z?"#9ca3af":"#d1d5db"})}),r.jsx("div",{style:{marginTop:8,textAlign:"center",color:Z?W==="upcoming"?"#9ca3af":"#111827":"#d1d5db",fontWeight:W==="current"?700:500},children:r.jsx("div",{style:{fontSize:13},children:$.title})})]},$.id)})]})}),r.jsxs("div",{style:{flex:1,overflow:"hidden",display:"flex"},children:[l!=="progress"&&r.jsxs("div",{style:{width:320,background:"#fff",borderRight:"1px solid #e5e7eb",display:"flex",flexDirection:"column"},children:[r.jsxs("div",{style:{padding:16,borderBottom:"1px solid #e5e7eb"},children:[r.jsxs("div",{style:{position:"relative",marginBottom:12},children:[r.jsx(Fn,{size:14,style:{position:"absolute",left:10,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}}),r.jsx("input",{type:"text",value:y,onChange:$=>x($.target.value),placeholder:"회의명 검색...",style:{width:"100%",padding:"8px 12px 8px 32px",border:"1px solid #e5e7eb",borderRadius:8,fontSize:13,outline:"none"}})]}),r.jsxs("button",{onClick:()=>u(!0),style:{width:"100%",padding:"10px 16px",background:"#3b82f6",color:"white",border:"none",borderRadius:8,fontSize:13,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:[r.jsx(mr,{size:16})," 새 회의 생성"]})]}),r.jsx("div",{style:{flex:1,overflow:"auto",padding:"8px 0"},children:a?r.jsx("div",{style:{padding:20,color:"#9ca3af",fontSize:13,textAlign:"center"},children:"로딩 중..."}):te.length===0?r.jsx("div",{style:{padding:20,color:"#9ca3af",fontSize:13,textAlign:"center"},children:y?"검색 결과가 없습니다":"등록된 회의가 없습니다"}):te.map($=>r.jsxs("div",{onClick:()=>q($),style:{padding:"12px 16px",margin:"0 8px 4px 8px",background:(e==null?void 0:e.id)===$.id?"#eff6ff":"transparent",borderRadius:8,border:(e==null?void 0:e.id)===$.id?"1px solid #93c5fd":"1px solid transparent",cursor:"pointer",transition:"all 0.15s"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:4},children:[r.jsx("span",{style:{padding:"2px 6px",borderRadius:4,fontSize:10,fontWeight:600,background:Tv($.meeting_status).bg,color:Tv($.meeting_status).text},children:TY($.meeting_status)}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[$.meeting_status==="PLANNED"&&r.jsx("button",{onClick:W=>H($,W),title:"회의 삭제",style:{padding:4,background:"transparent",border:"none",borderRadius:4,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",color:"#9ca3af",transition:"color 0.15s"},onMouseEnter:W=>W.currentTarget.style.color="#ef4444",onMouseLeave:W=>W.currentTarget.style.color="#9ca3af",children:r.jsx(la,{size:14})}),(e==null?void 0:e.id)===$.id&&r.jsx(rs,{size:14,color:"#3b82f6",strokeWidth:3})]})]}),r.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#111827",marginBottom:2},children:$.meetingName}),$.remark&&r.jsx("div",{style:{fontSize:11,color:"#9ca3af",marginBottom:4,lineHeight:1.3},children:$.remark}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:12,color:"#6b7280"},children:[r.jsxs("span",{style:{display:"flex",alignItems:"center",gap:3},children:[r.jsx(qr,{size:11}),$.meetingDate]}),r.jsx("span",{children:"·"}),r.jsxs("span",{children:[$.customerCount,"개 업체"]})]})]},$.id))})]}),r.jsx("div",{style:{flex:1,overflow:"auto",padding:24},children:e?l==="review"?r.jsx(EY,{activeMeeting:e}):l==="progress"?r.jsx(PY,{activeMeeting:e}):l==="close"?r.jsx(OY,{activeMeeting:e,onFinishMeeting:X}):l==="prepare"?r.jsxs("div",{style:{maxWidth:1e3},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:24,padding:16,background:"#f5f3ff",borderRadius:12,border:"1px solid #c4b5fd"},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"#8b5cf6",display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(kf,{size:20,color:"#fff"})}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h2",{style:{fontSize:18,fontWeight:700,color:"#111827",margin:0},children:"자료 생성"}),r.jsx("p",{style:{margin:"2px 0 0 0",color:"#6b7280",fontSize:13},children:"Data Preparation"})]}),r.jsx("div",{style:{padding:"6px 12px",background:"rgba(255,255,255,0.8)",borderRadius:6,fontSize:12,color:"#374151"},children:r.jsx("strong",{children:e.meetingName})})]}),r.jsx("div",{style:{background:"#fff",borderRadius:12,border:"2px solid #8b5cf6",padding:24,marginBottom:24},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:[r.jsxs("div",{children:[r.jsx("h3",{style:{fontSize:16,fontWeight:700,color:"#111827",margin:0},children:"AR Aging 데이터 생성"}),r.jsxs("p",{style:{margin:"4px 0 0 0",color:"#6b7280",fontSize:13},children:["ERP에서 채권 데이터를 가져와 생성합니다 (기준일: ",e.meetingDate,")"]})]}),r.jsx("button",{onClick:()=>T(),disabled:N,style:{padding:"12px 24px",background:N?"#a78bfa":"#8b5cf6",color:"white",border:"none",borderRadius:8,fontSize:14,fontWeight:600,cursor:N?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:8},children:N?r.jsxs(r.Fragment,{children:[r.jsx(ln,{size:16,style:{animation:"spin 1s linear infinite"}}),"생성 중..."]}):r.jsxs(r.Fragment,{children:[r.jsx(qh,{size:16}),"자료 생성"]})})]})}),w?r.jsxs("div",{style:{background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(ln,{size:24,style:{animation:"spin 1s linear infinite"}}),r.jsx("p",{style:{marginTop:12},children:"자료 요약 로딩 중..."})]}):v?r.jsxs("div",{style:{background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden"},children:[r.jsxs("div",{style:{padding:"16px 20px",background:"linear-gradient(135deg, #8b5cf6 0%, #a78bfa 100%)",color:"white",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[r.jsx(fr,{size:20}),r.jsx("span",{style:{fontWeight:700},children:"생성된 자료 요약"})]}),r.jsxs("div",{style:{fontSize:13,opacity:.9},children:["스냅샷 일자: ",v.snapshotDate]})]}),r.jsxs("div",{style:{padding:20},children:[r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16,marginBottom:24},children:[r.jsxs("div",{style:{padding:16,background:"#f8fafc",borderRadius:10,textAlign:"center"},children:[r.jsx(mo,{size:24,color:"#8b5cf6",style:{marginBottom:8}}),r.jsx("div",{style:{fontSize:24,fontWeight:800,color:"#111827"},children:v.totalCustomers.toLocaleString()}),r.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"총 거래처 수"})]}),r.jsxs("div",{style:{padding:16,background:"#f8fafc",borderRadius:10,textAlign:"center"},children:[r.jsx(pd,{size:24,color:"#3b82f6",style:{marginBottom:8}}),r.jsxs("div",{style:{fontSize:24,fontWeight:800,color:"#111827"},children:[(v.totalAr/1e8).toFixed(1),"억"]}),r.jsx("div",{style:{fontSize:12,color:"#6b7280"},children:"총 채권액"})]}),r.jsxs("div",{style:{padding:16,background:"#fef3c7",borderRadius:10,textAlign:"center"},children:[r.jsx(Ti,{size:24,color:"#f59e0b",style:{marginBottom:8}}),r.jsxs("div",{style:{fontSize:24,fontWeight:800,color:"#b45309"},children:[(v.overdue60/1e8).toFixed(1),"억"]}),r.jsx("div",{style:{fontSize:12,color:"#92400e"},children:"60일 초과 연체"})]}),r.jsxs("div",{style:{padding:16,background:"#fee2e2",borderRadius:10,textAlign:"center"},children:[r.jsx(Ti,{size:24,color:"#ef4444",style:{marginBottom:8}}),r.jsxs("div",{style:{fontSize:24,fontWeight:800,color:"#dc2626"},children:[(v.overdueOver90/1e8).toFixed(1),"억"]}),r.jsx("div",{style:{fontSize:12,color:"#991b1b"},children:"90일 초과 연체"})]})]}),v.byChannel&&v.byChannel.length>0&&r.jsxs("div",{children:[r.jsx("h4",{style:{fontSize:14,fontWeight:700,color:"#374151",marginBottom:12},children:"등급별 현황"}),r.jsx("div",{style:{border:"1px solid #e5e7eb",borderRadius:8,overflow:"hidden"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"#f9fafb"},children:[r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:600,color:"#374151"},children:"등급"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:600,color:"#374151"},children:"거래처 수"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"right",fontWeight:600,color:"#374151"},children:"채권액"})]})}),r.jsx("tbody",{children:[...v.byChannel].sort(($,W)=>{const U=!$.channelName||$.channelName==="기타",Z=!W.channelName||W.channelName==="기타";return U&&!Z?1:!U&&Z?-1:($.channelName||"").localeCompare(W.channelName||"")}).map(($,W)=>r.jsxs("tr",{style:{borderTop:"1px solid #e5e7eb"},children:[r.jsx("td",{style:{padding:"10px 12px",color:"#111827"},children:$.channelName||"-"}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"right",color:"#6b7280"},children:$.count.toLocaleString()}),r.jsxs("td",{style:{padding:"10px 12px",textAlign:"right",color:"#111827",fontWeight:500},children:[$.amount.toLocaleString(),"원"]})]},W))})]})})]})]})]}):r.jsxs("div",{style:{background:"#fff",borderRadius:12,border:"1px dashed #d1d5db",padding:40,textAlign:"center",color:"#9ca3af"},children:[r.jsx(kf,{size:40,strokeWidth:1}),r.jsxs("p",{style:{marginTop:12,fontSize:14},children:["회의 일자(",e.meetingDate,")로 생성된 자료가 없습니다.",r.jsx("br",{}),r.jsx("span",{style:{fontSize:13},children:"'자료 생성' 버튼을 클릭하여 AR Aging 데이터를 생성하세요."})]})]}),v&&r.jsxs("div",{style:{marginTop:20,padding:16,background:"#ecfdf5",borderRadius:10,border:"1px solid #6ee7b7",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,color:"#065f46"},children:[r.jsx(fr,{size:20}),r.jsx("span",{style:{fontWeight:600},children:"자료 생성이 완료되었습니다. 다음 단계로 진행하세요."})]}),r.jsxs("button",{onClick:Y,disabled:e.meeting_status==="FINISHED",style:{padding:"8px 16px",background:e.meeting_status==="FINISHED"?"#9ca3af":"#10b981",color:"white",border:"none",borderRadius:6,fontSize:13,fontWeight:600,cursor:e.meeting_status==="FINISHED"?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:4,opacity:e.meeting_status==="FINISHED"?.6:1},title:e.meeting_status==="FINISHED"?"종료된 회의입니다":"",children:["회의 진행 ",r.jsx(pa,{size:14})]})]})]}):r.jsx("div",{style:{maxWidth:900},children:Ev.filter($=>$.id===l).map($=>{const W=$.icon;return r.jsxs("div",{children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:20,padding:16,background:$.bgColor,borderRadius:12,border:`1px solid ${$.borderColor}`},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:10,background:$.color,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsx(W,{size:20,color:"#fff"})}),r.jsxs("div",{style:{flex:1},children:[r.jsx("h2",{style:{fontSize:18,fontWeight:700,color:"#111827",margin:0},children:$.title}),r.jsx("p",{style:{margin:"2px 0 0 0",color:"#6b7280",fontSize:13},children:$.subtitle})]}),r.jsx("div",{style:{padding:"6px 12px",background:"rgba(255,255,255,0.8)",borderRadius:6,fontSize:12,color:"#374151"},children:r.jsx("strong",{children:e.meetingName})})]}),r.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:12},children:$.actions.map(U=>{const Z=U.icon;return r.jsxs("div",{onClick:()=>!U.disabled&&M($.id,U.id),style:{background:"#fff",padding:20,borderRadius:12,border:U.primary?`2px solid ${$.color}`:"1px solid #e5e7eb",cursor:U.disabled?"not-allowed":"pointer",opacity:U.disabled?.5:1,transition:"all 0.2s",position:"relative"},onMouseEnter:ee=>{U.disabled||(ee.currentTarget.style.transform="translateY(-2px)",ee.currentTarget.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.08)")},onMouseLeave:ee=>{ee.currentTarget.style.transform="none",ee.currentTarget.style.boxShadow="none"},children:[U.primary&&r.jsx("div",{style:{position:"absolute",top:10,right:10,padding:"2px 6px",background:$.color,color:"#fff",fontSize:9,fontWeight:700,borderRadius:4},children:"추천"}),r.jsx("div",{style:{width:36,height:36,borderRadius:8,background:U.primary?$.bgColor:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:12},children:r.jsx(Z,{size:18,color:U.primary?$.color:"#6b7280"})}),r.jsx("h3",{style:{fontSize:14,fontWeight:700,color:"#111827",margin:"0 0 4px 0"},children:U.label}),r.jsx("p",{style:{fontSize:12,color:"#6b7280",margin:0,lineHeight:1.4},children:U.description}),r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4,marginTop:12,fontSize:12,fontWeight:600,color:$.color},children:["실행 ",r.jsx(pa,{size:12})]})]},U.id)})})]},$.id)})}):r.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:"#9ca3af"},children:[r.jsx(Tr,{size:56,strokeWidth:1}),r.jsx("p",{style:{fontSize:16,marginTop:12},children:"왼쪽에서 회의를 선택하거나 새로 생성해주세요"})]})})]}),d&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)",zIndex:50,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",width:"100%",maxWidth:440,overflow:"hidden"},children:[r.jsxs("div",{style:{padding:"16px 20px",background:"linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%)",color:"white"},children:[r.jsx("h3",{style:{fontSize:18,fontWeight:700,margin:0},children:"새 채권회의 생성"}),r.jsx("p",{style:{margin:"2px 0 0 0",fontSize:13,opacity:.9},children:"월별 채권 심사 회의를 생성합니다"})]}),r.jsxs("div",{style:{padding:20,display:"flex",flexDirection:"column",gap:16},children:[r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:13,fontWeight:600,color:"#374151",marginBottom:6},children:["회의명 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("input",{type:"text",value:f,onChange:$=>h($.target.value),placeholder:"예: 2025년 1월 정기 채권회의",style:{width:"100%",padding:"10px 14px",border:"1px solid #d1d5db",borderRadius:8,fontSize:14,outline:"none"},autoFocus:!0})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:13,fontWeight:600,color:"#374151",marginBottom:6},children:["회의 일자 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("input",{type:"date",value:m,onChange:$=>g($.target.value),style:{width:"100%",padding:"10px 14px",border:"1px solid #d1d5db",borderRadius:8,fontSize:14,outline:"none"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:13,fontWeight:600,color:"#374151",marginBottom:6},children:"회의 내용"}),r.jsx("textarea",{value:b,onChange:$=>j($.target.value),placeholder:"회의 안건, 주요 논의 사항 등을 입력하세요",rows:3,style:{width:"100%",padding:"10px 14px",border:"1px solid #d1d5db",borderRadius:8,fontSize:14,outline:"none",resize:"none",lineHeight:1.5}})]})]}),r.jsxs("div",{style:{padding:"12px 20px",background:"#f9fafb",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end",gap:10},children:[r.jsx("button",{onClick:()=>u(!1),style:{padding:"8px 16px",background:"#fff",border:"1px solid #d1d5db",borderRadius:8,fontSize:13,fontWeight:600,color:"#374151",cursor:"pointer"},children:"취소"}),r.jsxs("button",{onClick:L,style:{padding:"8px 20px",background:"#3b82f6",border:"none",borderRadius:8,fontSize:13,fontWeight:600,color:"white",cursor:"pointer",display:"flex",alignItems:"center",gap:4},children:[r.jsx(mr,{size:14})," 생성하기"]})]})]})}),I.show&&r.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",backdropFilter:"blur(4px)",zIndex:100,display:"flex",alignItems:"center",justifyContent:"center"},children:r.jsxs("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",width:"100%",maxWidth:400,overflow:"hidden",animation:"popupIn 0.2s ease-out"},children:[r.jsxs("div",{style:{padding:"16px 20px",background:I.type==="success"?"linear-gradient(135deg, #059669 0%, #10b981 100%)":I.type==="error"?"linear-gradient(135deg, #dc2626 0%, #ef4444 100%)":I.type==="warning"?"linear-gradient(135deg, #d97706 0%, #f59e0b 100%)":I.type==="confirm"?"linear-gradient(135deg, #7c3aed 0%, #8b5cf6 100%)":"linear-gradient(135deg, #2563eb 0%, #3b82f6 100%)",color:"white",display:"flex",alignItems:"center",gap:10},children:[I.type==="success"&&r.jsx(fr,{size:22}),I.type==="error"&&r.jsx(On,{size:22}),I.type==="warning"&&r.jsx(ha,{size:22}),I.type==="confirm"&&r.jsx(Ag,{size:22}),I.type==="info"&&r.jsx(Ag,{size:22}),r.jsx("h3",{style:{fontSize:16,fontWeight:700,margin:0},children:I.title})]}),r.jsx("div",{style:{padding:20},children:r.jsx("p",{style:{fontSize:14,color:"#374151",margin:0,lineHeight:1.6,whiteSpace:"pre-line"},children:I.message})}),r.jsx("div",{style:{padding:"12px 20px",background:"#f9fafb",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end",gap:10},children:I.type==="confirm"?r.jsxs(r.Fragment,{children:[r.jsx("button",{onClick:()=>{var $;return($=I.onCancel)==null?void 0:$.call(I)},style:{padding:"8px 16px",background:"#fff",border:"1px solid #d1d5db",borderRadius:8,fontSize:13,fontWeight:600,color:"#374151",cursor:"pointer"},children:"취소"}),r.jsx("button",{onClick:()=>{var $;return($=I.onConfirm)==null?void 0:$.call(I)},style:{padding:"8px 20px",background:"#8b5cf6",border:"none",borderRadius:8,fontSize:13,fontWeight:600,color:"white",cursor:"pointer"},children:"확인"})]}):r.jsx("button",{onClick:S,style:{padding:"8px 20px",background:I.type==="success"?"#10b981":I.type==="error"?"#ef4444":I.type==="warning"?"#f59e0b":"#3b82f6",border:"none",borderRadius:8,fontSize:13,fontWeight:600,color:"white",cursor:"pointer"},children:"확인"})})]})}),r.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
        @keyframes popupIn {
          from {
            opacity: 0;
            transform: scale(0.9);
          }
          to {
            opacity: 1;
            transform: scale(1);
          }
        }
      `})]})}const Pv=[{id:1,title:"거래처 선택 및 현황 분석",icon:Fn},{id:2,title:"해제 사유 및 계획 작성",icon:nr},{id:3,title:"요청 완료",icon:fr}];function zY(){const[e,n]=p.useState(1),[i,s]=p.useState(""),[a,o]=p.useState(null),[l,c]=p.useState(!1),[d,u]=p.useState(""),[f,h]=p.useState(""),[m,g]=p.useState(""),[b,j]=p.useState(""),[y,x]=p.useState(!1),v=async I=>{if(I){c(!0),o(null);try{const O=await fetch(`/api/v1/credit/customers/${I}`);if(!O.ok)throw new Error("거래처 정보를 찾을 수 없습니다");const E=await O.json();if(E.customer){const S=E.customer;o({customerSeq:S.customer_seq,customerName:S.customer_name,totalAr:S.total_ar||0,weightedAgingDays:45,overdue:S.overdue||0,aging0_30:S.aging_0_30||0,aging31_60:S.aging_31_60||0,aging61_90:S.aging_61_90||0,recentCollections:[{date:"2024-12-15",amount:5e6},{date:"2024-11-20",amount:3e6},{date:"2024-10-18",amount:4e6}],avgMonthlySales:25e6,lastMeetingOpinion:"고객사 자금 사정 어려움. 1월 중순 입금 약속."})}}catch(O){console.error("거래처 조회 실패:",O),alert(O.message)}finally{c(!1)}}},A=async()=>{if(!i||!d||!f||!m||!b){alert("모든 필수 항목을 입력해주세요");return}x(!0);try{const I=await fetch("/api/v1/credit/unblock-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerSeq:Number(i),requestCode:`REQ-${Date.now()}`,requestDate:new Date().toISOString().split("T")[0],requestReason:d,expectedCollectionDate:f,expectedAmount:Number(m),collectionPlan:b,assigneeId:"user1"})});if(!I.ok)throw new Error("요청 제출 실패");const O=await I.json();if(O.success)n(3);else throw new Error(O.error||"요청 제출 실패")}catch(I){alert("요청 제출 중 오류가 발생했습니다: "+I.message)}finally{x(!1)}},N=I=>`₩${I.toLocaleString("ko-KR")}`,C=()=>r.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[r.jsxs("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb"},children:[r.jsxs("h2",{style:{fontSize:18,fontWeight:700,color:"#111827",marginBottom:20,display:"flex",alignItems:"center",gap:8},children:[r.jsx(Fn,{size:20,color:"#3b82f6"})," 거래처 조회"]}),r.jsxs("div",{style:{display:"flex",gap:12},children:[r.jsxs("div",{style:{position:"relative",flex:1,maxWidth:400},children:[r.jsx("input",{type:"number",value:i,onChange:I=>s(I.target.value),onKeyDown:I=>I.key==="Enter"&&v(i),placeholder:"거래처 코드 (SEQ) 입력",className:"search-input",style:{width:"100%",height:42,paddingLeft:40,fontSize:14},autoFocus:!0}),r.jsx(Fn,{size:16,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}})]}),r.jsx("button",{onClick:()=>v(i),disabled:l||!i,className:"btn",style:{height:42,padding:"0 24px",fontSize:14,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:l||!i?.7:1},children:l?"조회 중...":"조회"})]})]}),a&&r.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:24},children:[r.jsx("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",gridColumn:"span 2"},children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:24},children:[r.jsxs("div",{style:{padding:16,background:"#eff6ff",borderRadius:12,border:"1px solid #dbeafe"},children:[r.jsx("div",{style:{fontSize:13,color:"#2563eb",fontWeight:600,marginBottom:4},children:"총 채권액"}),r.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:N(a.totalAr)})]}),r.jsxs("div",{style:{padding:16,background:"#fef2f2",borderRadius:12,border:"1px solid #fee2e2"},children:[r.jsx("div",{style:{fontSize:13,color:"#dc2626",fontWeight:600,marginBottom:4},children:"연체 금액"}),r.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:N(a.overdue)})]}),r.jsxs("div",{style:{padding:16,background:"#fffbeb",borderRadius:12,border:"1px solid #fef3c7"},children:[r.jsx("div",{style:{fontSize:13,color:"#d97706",fontWeight:600,marginBottom:4},children:"평균 결제일"}),r.jsxs("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:[a.weightedAgingDays,"일"]})]}),r.jsxs("div",{style:{padding:16,background:"#f9fafb",borderRadius:12,border:"1px solid #f3f4f6"},children:[r.jsx("div",{style:{fontSize:13,color:"#4b5563",fontWeight:600,marginBottom:4},children:"월 평균 매출"}),r.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:N(a.avgMonthlySales||0)})]})]})}),r.jsxs("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",height:320},children:[r.jsx("h3",{style:{fontSize:16,fontWeight:700,color:"#111827",marginBottom:16},children:"채권 연령 분석"}),r.jsx(Ro,{width:"100%",height:"100%",children:r.jsxs(Ok,{data:[{name:"정상",value:a.totalAr-a.overdue},{name:"1개월",value:a.aging0_30},{name:"2개월",value:a.aging31_60},{name:"3개월+",value:a.aging61_90}],margin:{top:20,right:30,left:20,bottom:5},children:[r.jsx(Bo,{strokeDasharray:"3 3",vertical:!1}),r.jsx(qo,{dataKey:"name",tick:{fontSize:12}}),r.jsx(Uo,{tick:{fontSize:12}}),r.jsx(td,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:12},formatter:I=>N(I)}),r.jsx(og,{dataKey:"value",radius:[4,4,0,0],children:[0,1,2,3].map((I,O)=>r.jsx(za,{fill:O===0?"#10b981":O===3?"#ef4444":"#3b82f6"},`cell-${O}`))})]})})]}),r.jsxs("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",height:320},children:[r.jsx("h3",{style:{fontSize:16,fontWeight:700,color:"#111827",marginBottom:16},children:"최근 수금 추이"}),r.jsx(Ro,{width:"100%",height:"100%",children:r.jsxs(Pk,{data:a.recentCollections,margin:{top:20,right:30,left:20,bottom:5},children:[r.jsx(Bo,{strokeDasharray:"3 3",vertical:!1}),r.jsx(qo,{dataKey:"date",tick:{fontSize:12}}),r.jsx(Uo,{tick:{fontSize:12}}),r.jsx(td,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:12},formatter:I=>N(I)}),r.jsx(hg,{type:"monotone",dataKey:"amount",stroke:"#8b5cf6",strokeWidth:3,dot:{r:4},activeDot:{r:6}})]})})]})]})]}),w=()=>r.jsx("div",{className:"animate-in fade-in slide-in-from-right-4 duration-300",style:{maxWidth:800,margin:"0 auto"},children:r.jsxs("div",{className:"card",style:{padding:32,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb"},children:[r.jsxs("h2",{style:{fontSize:18,fontWeight:700,color:"#111827",marginBottom:24,display:"flex",alignItems:"center",gap:8},children:[r.jsx(nr,{size:20,color:"#3b82f6"})," 해제 요청 사유 작성"]}),r.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["요청 사유 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("textarea",{value:d,onChange:I=>u(I.target.value),rows:5,className:"search-input",style:{width:"100%",height:"auto",padding:12,resize:"none",fontSize:14},placeholder:"매출통제 해제가 필요한 구체적인 사유를 입력해주세요."})]}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:24},children:[r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["예상 수금일 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("input",{type:"date",value:f,onChange:I=>h(I.target.value),className:"search-input",style:{width:"100%",height:42}})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["예상 수금액 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("span",{style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#6b7280",fontSize:14},children:"₩"}),r.jsx("input",{type:"number",value:m,onChange:I=>g(I.target.value),className:"search-input",style:{width:"100%",height:42,paddingLeft:30},placeholder:"0"})]})]})]}),r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["수금 계획 근거 ",r.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),r.jsx("textarea",{value:b,onChange:I=>j(I.target.value),rows:3,className:"search-input",style:{width:"100%",height:"auto",padding:12,resize:"none",fontSize:14},placeholder:"수금 계획의 신뢰성을 뒷받침할 근거를 입력해주세요 (예: 고객사 담당자 통화 내용, 지불각서 등)"})]})]})]})}),_=()=>r.jsxs("div",{className:"animate-in zoom-in-95 duration-500",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"60vh"},children:[r.jsx("div",{style:{width:80,height:80,background:"#dcfce7",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:24},children:r.jsx(fr,{size:40,color:"#16a34a"})}),r.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#111827",marginBottom:8},children:"요청이 완료되었습니다!"}),r.jsx("p",{style:{fontSize:16,color:"#6b7280",marginBottom:32},children:"담당자 검토 후 승인 여부가 결정됩니다."}),r.jsx("button",{onClick:()=>{n(1),s(""),o(null),u(""),h(""),g(""),j("")},className:"btn",style:{height:48,padding:"0 32px",fontSize:15,fontWeight:700,background:"#111827",borderColor:"#111827",color:"white",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:"새로운 요청 작성하기"})]});return r.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[r.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb",zIndex:10},children:[r.jsxs("div",{style:{marginBottom:24},children:[r.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"매출통제 해제 요청"}),r.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"연체 거래처의 일시적 매출 허용을 위한 승인 요청"})]}),r.jsxs("div",{style:{display:"flex",alignItems:"center",maxWidth:600,margin:"0 auto",position:"relative"},children:[r.jsx("div",{style:{position:"absolute",top:20,left:0,width:"100%",height:2,background:"#f3f4f6",zIndex:0}}),r.jsx("div",{style:{position:"absolute",top:20,left:0,height:2,background:"#3b82f6",zIndex:0,width:`${(e-1)/(Pv.length-1)*100}%`,transition:"width 0.3s ease"}}),Pv.map(I=>{const O=e>=I.id,E=e===I.id;return r.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",position:"relative",zIndex:1},children:[r.jsx("div",{style:{width:40,height:40,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:O?"#3b82f6":"#fff",border:O?"none":"2px solid #e5e7eb",color:O?"#fff":"#9ca3af",boxShadow:O?"0 4px 6px -1px rgba(59, 130, 246, 0.3)":"none",transition:"all 0.3s ease"},children:r.jsx(I.icon,{size:20})}),r.jsx("span",{style:{marginTop:8,fontSize:13,fontWeight:E?700:500,color:E?"#3b82f6":"#9ca3af",transition:"color 0.3s ease"},children:I.title})]},I.id)})]})]}),r.jsxs("div",{style:{flex:1,overflow:"auto",padding:32},children:[e===1&&C(),e===2&&w(),e===3&&_()]}),e<3&&r.jsxs("div",{style:{padding:"16px 32px",background:"#fff",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsx("button",{onClick:()=>n(I=>Math.max(1,I-1)),disabled:e===1,className:"btn",style:{background:"transparent",borderColor:"transparent",color:"#4b5563",opacity:e===1?.3:1,cursor:e===1?"not-allowed":"pointer",paddingLeft:0},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[r.jsx(Dv,{size:18})," 이전"]})}),e===1?r.jsx("button",{onClick:()=>n(2),disabled:!a,className:"btn",style:{height:42,padding:"0 24px",fontSize:14,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:a?1:.5,cursor:a?"pointer":"not-allowed"},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:["다음 단계 ",r.jsx(Ii,{size:18})]})}):r.jsx("button",{onClick:A,disabled:y,className:"btn",style:{height:42,padding:"0 24px",fontSize:14,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:y?.7:1},children:r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[y?"제출 중...":"요청 제출하기"," ",r.jsx(pa,{size:18})]})})]})]})}function MY({onSelect:e,onCreate:n,selectedId:i}){const[s,a]=p.useState([]),[o,l]=p.useState(!1),[c,d]=p.useState(""),[u,f]=p.useState(""),[h,m]=p.useState("");p.useEffect(()=>{g();const v=()=>g();return window.addEventListener("tnt.sales.competitor.reload",v),()=>window.removeEventListener("tnt.sales.competitor.reload",v)},[]);async function g(){l(!0);try{const v=new URLSearchParams;c&&v.append("name",c),u&&v.append("marketPosition",u),h&&v.append("distributionModel",h);const A=await fetch(`/api/v1/competitors?${v.toString()}`);if(A.ok){const N=await A.json();Array.isArray(N)&&a(N)}}catch(v){console.error(v)}finally{l(!1)}}const b=s.filter(v=>{const A=c===""||(v.competitorName||"").toLowerCase().includes(c.toLowerCase())||(v.country||"").toLowerCase().includes(c.toLowerCase()),N=u===""||v.marketPositionCd===u,C=h===""||v.distributionModel===h;return A&&N&&C}),j=v=>{switch(v){case"기술 리더":return{background:"#ede9fe",color:"#7c3aed"};case"품질 강자":return{background:"#d1fae5",color:"#059669"};case"가성비 중심":return{background:"#fef3c7",color:"#d97706"};case"초저가 진입자":return{background:"#fee2e2",color:"#dc2626"};default:return{background:"var(--bg-secondary)",color:"var(--text-secondary)"}}},y=()=>{d(""),f(""),m("")},x=()=>{g()};return r.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8},children:[r.jsx("div",{style:{padding:16,borderBottom:"1px solid var(--border)",background:"var(--bg-secondary)"},children:r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:12,marginBottom:12},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"경쟁사명"}),r.jsxs("div",{style:{position:"relative"},children:[r.jsx("input",{type:"text",className:"input",placeholder:"검색...",value:c,onChange:v=>d(v.target.value),onKeyDown:v=>v.key==="Enter"&&x(),style:{width:"100%",paddingLeft:36}}),r.jsx(Fn,{size:16,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",opacity:.5}})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"시장 지위"}),r.jsxs("select",{className:"input",value:u,onChange:v=>f(v.target.value),style:{width:"100%"},children:[r.jsx("option",{value:"",children:"전체"}),r.jsx("option",{value:"기술 리더",children:"기술 리더"}),r.jsx("option",{value:"품질 강자",children:"품질 강자"}),r.jsx("option",{value:"가성비 중심",children:"가성비 중심"}),r.jsx("option",{value:"초저가 진입자",children:"초저가 진입자"})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"유통 모델"}),r.jsxs("select",{className:"input",value:h,onChange:v=>m(v.target.value),style:{width:"100%"},children:[r.jsx("option",{value:"",children:"전체"}),r.jsx("option",{value:"직판",children:"직판"}),r.jsx("option",{value:"총판",children:"총판"}),r.jsx("option",{value:"대리점",children:"대리점"}),r.jsx("option",{value:"온라인",children:"온라인"})]})]}),r.jsxs("div",{style:{display:"flex",alignItems:"flex-end",gap:8},children:[r.jsx("button",{className:"btn btn-secondary",onClick:y,children:"초기화"}),r.jsx("button",{className:"btn btn-primary",onClick:x,disabled:o,children:o?"검색 중...":"검색"})]})]})}),r.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{style:{fontSize:13,color:"var(--text-secondary)"},children:["총 ",r.jsx("strong",{style:{color:"var(--text-primary)"},children:b.length}),"건"]}),r.jsxs("div",{style:{display:"flex",gap:8},children:[r.jsxs("button",{className:"btn btn-secondary",onClick:()=>g(),disabled:o,style:{display:"flex",alignItems:"center",gap:4},children:[r.jsx(ln,{size:14,className:o?"animate-spin":""}),"새로고침"]}),r.jsxs("button",{className:"btn btn-primary",onClick:n,style:{display:"flex",alignItems:"center",gap:4},children:[r.jsx(mr,{size:14}),"신규 등록"]})]})]}),r.jsx("div",{style:{overflow:"auto",maxHeight:"calc(100vh - 400px)"},children:r.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:13},children:[r.jsx("thead",{children:r.jsxs("tr",{style:{background:"var(--bg-secondary)"},children:[r.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:40},children:r.jsx("input",{type:"checkbox"})}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)",width:60},children:"No"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)"},children:"경쟁사명"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"left",borderBottom:"1px solid var(--border)",width:100},children:"국가"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:100},children:"설립연도"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:120},children:"시장 지위"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:100},children:"유통 모델"}),r.jsx("th",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)",width:100},children:"홈페이지"})]})}),r.jsxs("tbody",{children:[b.map((v,A)=>r.jsxs("tr",{onClick:()=>e(v),style:{cursor:"pointer",background:i===v.competitorId?"var(--bg-secondary)":"transparent"},onMouseEnter:N=>{i!==v.competitorId&&(N.currentTarget.style.background="var(--bg-secondary)")},onMouseLeave:N=>{i!==v.competitorId&&(N.currentTarget.style.background="transparent")},children:[r.jsx("td",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)"},children:r.jsx("input",{type:"checkbox",onClick:N=>N.stopPropagation()})}),r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)"},children:A+1}),r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)",fontWeight:500,color:"var(--primary)"},children:v.competitorName||"-"}),r.jsx("td",{style:{padding:"10px 12px",borderBottom:"1px solid var(--border)"},children:v.country||"-"}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)"},children:v.foundedYear||"-"}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)"},children:r.jsx("span",{style:{padding:"2px 8px",borderRadius:4,fontSize:11,fontWeight:500,...j(v.marketPositionCd)},children:v.marketPositionCd||"-"})}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)"},children:v.distributionModel||"-"}),r.jsx("td",{style:{padding:"10px 12px",textAlign:"center",borderBottom:"1px solid var(--border)"},children:v.homepage?r.jsx("a",{href:v.homepage,target:"_blank",rel:"noreferrer",onClick:N=>N.stopPropagation(),style:{color:"var(--primary)",textDecoration:"none"},children:"Link"}):"-"})]},v.competitorId)),b.length===0&&!o&&r.jsx("tr",{children:r.jsx("td",{colSpan:8,style:{padding:"40px 12px",textAlign:"center",color:"var(--text-secondary)"},children:"조회된 데이터가 없습니다."})})]})]})}),b.length>0&&r.jsxs("div",{style:{padding:"12px 16px",display:"flex",justifyContent:"center",alignItems:"center",gap:4,borderTop:"1px solid var(--border)"},children:[r.jsx("button",{className:"btn btn-ghost",style:{padding:"4px 8px",minWidth:32},children:"«"}),r.jsx("button",{className:"btn btn-ghost",style:{padding:"4px 8px",minWidth:32},children:"‹"}),r.jsx("button",{className:"btn btn-primary",style:{padding:"4px 8px",minWidth:32},children:"1"}),r.jsx("button",{className:"btn btn-ghost",style:{padding:"4px 8px",minWidth:32},children:"›"}),r.jsx("button",{className:"btn btn-ghost",style:{padding:"4px 8px",minWidth:32},children:"»"})]})]})}function RY({competitor:e,onCancel:n,onSave:i}){const[s,a]=p.useState({competitorName:"",country:"",homepage:"",foundedYear:"",description:"",marketPositionCd:"기술 리더",distributionModel:"직판"}),[o,l]=p.useState(!1),[c,d]=p.useState(!1),[u,f]=p.useState("basic"),[h,m]=p.useState(null);p.useEffect(()=>{a(e?{competitorName:e.competitorName||"",country:e.country||"",homepage:e.homepage||"",foundedYear:e.foundedYear?String(e.foundedYear):"",description:e.description||"",marketPositionCd:e.marketPositionCd||"기술 리더",distributionModel:e.distributionModel||"직판"}:{competitorName:"",country:"",homepage:"",foundedYear:"",description:"",marketPositionCd:"기술 리더",distributionModel:"직판"})},[e]);const g=(y,x)=>{a(v=>({...v,[y]:x}))},b=async()=>{if(!s.competitorName.trim()){m({type:"error",text:"경쟁사명을 입력해주세요."});return}l(!0),m(null);try{const y={...s,foundedYear:s.foundedYear?parseInt(s.foundedYear):null};let x;e?x=await fetch(`/api/v1/competitors/${e.competitorId}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)}):x=await fetch("/api/v1/competitors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(y)}),x.ok?(m({type:"success",text:e?"수정되었습니다.":"등록되었습니다."}),setTimeout(()=>i(),1e3)):m({type:"error",text:"저장에 실패했습니다."})}catch{m({type:"error",text:"오류가 발생했습니다."})}finally{l(!1)}},j=async()=>{if(e&&confirm("정말 삭제하시겠습니까?")){d(!0);try{(await fetch(`/api/v1/competitors/${e.competitorId}`,{method:"DELETE"})).ok?(m({type:"success",text:"삭제되었습니다."}),setTimeout(()=>i(),1e3)):m({type:"error",text:"삭제에 실패했습니다."})}catch{m({type:"error",text:"오류가 발생했습니다."})}finally{d(!1)}}};return r.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8},children:[r.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid var(--border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[r.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[r.jsx("button",{onClick:n,style:{background:"none",border:"none",cursor:"pointer",padding:4,display:"flex",alignItems:"center"},children:r.jsx(Yv,{size:20})}),r.jsx("h3",{style:{fontSize:18,fontWeight:600,margin:0},children:e?"경쟁사 상세":"경쟁사 등록"})]}),r.jsxs("div",{style:{display:"flex",gap:8},children:[e&&r.jsxs("button",{className:"btn btn-secondary",onClick:j,disabled:c,style:{display:"flex",alignItems:"center",gap:4,color:"var(--error)"},children:[r.jsx(la,{size:14}),c?"삭제 중...":"삭제"]}),r.jsx("button",{className:"btn btn-secondary",onClick:n,disabled:o,children:"목록"}),r.jsx("button",{className:"btn btn-primary",onClick:b,disabled:o,children:o?"저장 중...":"저장"})]})]}),h&&r.jsx("div",{style:{padding:"12px 20px",background:h.type==="success"?"#ecfdf5":"#fef2f2",color:h.type==="success"?"#047857":"#b91c1c",borderBottom:"1px solid var(--border)"},children:h.text}),r.jsx("div",{style:{borderBottom:"1px solid var(--border)",padding:"0 20px"},children:r.jsx("div",{style:{display:"flex",gap:0},children:[{key:"basic",label:"기본정보"},{key:"products",label:"제품정보"},{key:"analysis",label:"경쟁분석"}].map(y=>r.jsx("button",{onClick:()=>f(y.key),style:{padding:"12px 20px",background:"none",border:"none",borderBottom:u===y.key?"2px solid var(--primary)":"2px solid transparent",color:u===y.key?"var(--primary)":"var(--text-secondary)",fontWeight:u===y.key?600:400,cursor:"pointer",fontSize:14},children:y.label},y.key))})}),r.jsxs("div",{style:{padding:20},children:[u==="basic"&&r.jsxs(r.Fragment,{children:[r.jsxs("div",{style:{marginBottom:24},children:[r.jsx("h4",{style:{fontSize:14,fontWeight:600,marginBottom:12,paddingBottom:8,borderBottom:"1px solid var(--border)"},children:"기본 정보"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[r.jsxs("div",{children:[r.jsxs("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:["경쟁사명 ",r.jsx("span",{style:{color:"var(--error)"},children:"*"})]}),r.jsx("input",{type:"text",className:"input",value:s.competitorName,onChange:y=>g("competitorName",y.target.value),placeholder:"경쟁사명을 입력하세요",style:{width:"100%"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"국가"}),r.jsx("input",{type:"text",className:"input",value:s.country,onChange:y=>g("country",y.target.value),placeholder:"국가를 입력하세요",style:{width:"100%"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"홈페이지"}),r.jsx("input",{type:"text",className:"input",value:s.homepage,onChange:y=>g("homepage",y.target.value),placeholder:"https://",style:{width:"100%"}})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"설립연도"}),r.jsxs("select",{className:"input",value:s.foundedYear,onChange:y=>g("foundedYear",y.target.value),style:{width:"100%"},children:[r.jsx("option",{value:"",children:"선택"}),Array.from({length:new Date().getFullYear()-1950+1},(y,x)=>new Date().getFullYear()-x).map(y=>r.jsxs("option",{value:y,children:[y,"년"]},y))]})]})]})]}),r.jsxs("div",{style:{marginBottom:24},children:[r.jsx("h4",{style:{fontSize:14,fontWeight:600,marginBottom:12,paddingBottom:8,borderBottom:"1px solid var(--border)"},children:"분류 정보"}),r.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16},children:[r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"시장 지위"}),r.jsxs("select",{className:"input",value:s.marketPositionCd,onChange:y=>g("marketPositionCd",y.target.value),style:{width:"100%"},children:[r.jsx("option",{value:"기술 리더",children:"기술 리더"}),r.jsx("option",{value:"품질 강자",children:"품질 강자"}),r.jsx("option",{value:"가성비 중심",children:"가성비 중심"}),r.jsx("option",{value:"초저가 진입자",children:"초저가 진입자"})]})]}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"유통 모델"}),r.jsxs("select",{className:"input",value:s.distributionModel,onChange:y=>g("distributionModel",y.target.value),style:{width:"100%"},children:[r.jsx("option",{value:"직판",children:"직판"}),r.jsx("option",{value:"총판",children:"총판"}),r.jsx("option",{value:"대리점",children:"대리점"}),r.jsx("option",{value:"온라인",children:"온라인"})]})]})]})]}),r.jsxs("div",{children:[r.jsx("h4",{style:{fontSize:14,fontWeight:600,marginBottom:12,paddingBottom:8,borderBottom:"1px solid var(--border)"},children:"상세 설명"}),r.jsxs("div",{children:[r.jsx("label",{style:{display:"block",fontSize:12,marginBottom:4,color:"var(--text-secondary)"},children:"설명"}),r.jsx("textarea",{className:"input",value:s.description,onChange:y=>g("description",y.target.value),placeholder:"경쟁사에 대한 설명을 입력하세요",rows:6,style:{width:"100%",resize:"vertical"}})]})]})]}),u==="products"&&r.jsx("div",{children:r.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-secondary)"},children:e?r.jsx("p",{children:"경쟁사 제품 정보는 별도 메뉴에서 관리됩니다."}):r.jsx("p",{children:"경쟁사를 먼저 등록한 후 제품 정보를 추가할 수 있습니다."})})}),u==="analysis"&&r.jsx("div",{children:r.jsx("div",{style:{padding:40,textAlign:"center",color:"var(--text-secondary)"},children:e?r.jsx("p",{children:"경쟁 분석 정보는 별도 메뉴에서 관리됩니다."}):r.jsx("p",{children:"경쟁사를 먼저 등록한 후 분석 정보를 추가할 수 있습니다."})})})]})]})}function Ov(){const[e,n]=p.useState(null),[i,s]=p.useState(!1),a=d=>{n(d),s(!1)},o=()=>{n(null),s(!0)},l=()=>{n(null),s(!1)},c=()=>{s(!1),n(null),window.dispatchEvent(new CustomEvent("tnt.sales.competitor.reload"))};return e||i?r.jsx("div",{style:{padding:24,height:"100%",overflow:"auto",background:"var(--panel)"},children:r.jsx(RY,{competitor:e,onCancel:l,onSave:c})}):r.jsxs("div",{style:{padding:24,height:"100%",overflow:"auto",background:"var(--panel)"},children:[r.jsxs("div",{style:{marginBottom:24},children:[r.jsx("h1",{style:{fontSize:24,fontWeight:600,marginBottom:8},children:"경쟁사 관리"}),r.jsx("p",{style:{color:"var(--text-secondary)",fontSize:14},children:"경쟁사 정보를 등록하고 관리합니다."})]}),r.jsx(MY,{onSelect:a,onCreate:o,selectedId:e==null?void 0:e.competitorId})]})}function HK({selectedKey:e}){return r.jsx("div",{className:"main-view",children:e==="dashboard"?r.jsx(cH,{}):e==="calendar"?r.jsx($3,{}):e==="demand"&&Rn.demandManagement?r.jsxs("section",{children:[r.jsx("h1",{children:"수요관리"}),r.jsx("p",{children:"여기에서 수요 데이터를 조회/분석/관리하는 기능이 표시됩니다."}),r.jsx("div",{className:"empty-state",children:"초기 버전: 메인 화면 스켈레톤"})]}):e==="customer"&&Rn.customerManagement?r.jsxs("section",{children:[r.jsx("h1",{children:"고객관리"}),r.jsx("p",{children:"고객관리 요구사항은 별도로 정의/입력됩니다. 현재는 플레이스홀더입니다."}),r.jsx("div",{className:"empty-state",children:"초기 버전: 고객관리 화면 스켈레톤"})]}):e==="customer"&&Rn.customerManagement?r.jsxs("section",{children:[r.jsx("h1",{children:"고객관리"}),r.jsx("p",{children:"고객관리 요구사항은 별도로 정의/입력됩니다. 현재는 플레이스홀더입니다."}),r.jsx("div",{className:"empty-state",children:"초기 버전: 고객관리 화면 스켈레톤"})]}):e==="customer:list"&&Rn.customerManagement?r.jsx(Ep,{}):e==="customer:sales-activity-new"&&Rn.customerManagement?r.jsx(w3,{}):e==="customer:c360"&&Rn.customerManagement?r.jsx(I3,{}):e==="sales-mgmt:activity-plan"?r.jsx(M3,{}):e==="customer:c360-old"&&Rn.customerManagement?r.jsx(R3,{}):e==="customer:my-activities"&&Rn.customerManagement?r.jsx(vH,{}):e==="competitor:register"?r.jsx(Ov,{}):e==="competitor:register"?r.jsx(Ov,{}):e==="lead:register"||e==="lead"?r.jsx(zH,{}):e==="lead:tm-status"?r.jsx(RH,{}):e==="order-sheet"?r.jsx($H,{}):e==="order-list"?r.jsx(qH,{}):e==="order-to-delivery"?r.jsx(HH,{}):e==="inquiry"?r.jsx(_H,{}):e==="estimate"?r.jsx(EH,{}):e==="item360"?r.jsx(QH,{}):e==="inventory:expiry-ag"?r.jsx(uY,{}):e==="inventory:promotion"?r.jsx(fY,{}):e==="inventory:promotion-eval"?r.jsx(hY,{}):e==="complaint"?r.jsx(bH,{}):e==="credit:ar-aging"?r.jsx(NY,{}):e==="credit:workflow"?r.jsx(DY,{}):e==="credit:meetings"?r.jsx(_Y,{}):e.startsWith("credit:meeting:")?r.jsx(IY,{}):e==="credit:unblocking"?r.jsx(zY,{}):e==="sales-receivables"?r.jsxs("section",{children:[r.jsx("h1",{children:"매출/채권"}),r.jsx("div",{className:"empty-state",children:"매출·채권 관리 화면이 준비중입니다."})]}):e==="settings"?r.jsx(PH,{}):e==="sales-mgmt:sales"?r.jsx(tY,{}):e==="sales-mgmt:receivables"?r.jsx(sY,{}):e==="sales-mgmt:activities"?r.jsx(cY,{}):e==="lab:vibe-workspace"?r.jsx(jY,{}):e==="lab:google-rag"?r.jsx(wY,{}):e==="lab:tnt-chat"?r.jsx(SY,{}):e==="lab:unit-analysis"?r.jsx(pY,{}):e==="lab:price-sim"?r.jsx(gY,{}):e==="lab:price-sim-unit"?r.jsx(xY,{}):e==="lab:price-simulation"?r.jsx(bY,{}):e==="lab:erp-sp"?r.jsx(kY,{}):e==="demand:list"&&Rn.demandManagement?r.jsx(sN,{}):e==="sales-targets"&&Rn.demandManagement?r.jsx(Og,{}):e==="sales-dashboard"&&Rn.demandManagement?r.jsx(eY,{}):e==="sales-assign"&&Rn.demandManagement?r.jsx(FH,{}):e==="sales-plan"&&Rn.demandManagement?r.jsx(g_,{}):e==="sales-plan-new"&&Rn.demandManagement?r.jsx(Og,{}):e==="sales-plan-s"&&Rn.demandManagement?r.jsx(p_,{}):e==="demand:excel-upload"&&Rn.demandManagement?r.jsx(l_,{}):r.jsxs("section",{children:[r.jsx("h1",{children:e}),r.jsx("div",{className:"empty-state",children:"콘텐츠가 준비중입니다."})]})})}export{HK as MainView};
