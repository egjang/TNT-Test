import{c as _e,u as We,r,j as e,F as ue,m as ye,h as Ee,l as Me,k as Ae}from"./index-BB_3LKiY.js";import{M as be}from"./message-square-DaNp9p04.js";import{X as U}from"./x-Ci4NTfDo.js";import{R as Ne}from"./refresh-cw-BZiQWki6.js";import{T as ne}from"./trash-2-YQlpFIkM.js";import{C as ie}from"./chevron-down-DD_Bc6LT.js";import{C as se}from"./chevron-up-DTPmQPJn.js";import{P as me}from"./plus-NPOo4Ump.js";import{D as Pe}from"./dollar-sign-CDimaGAB.js";import{C as Oe}from"./circle-check-big-56oz7VR7.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],je=_e("pencil",He);function K({message:s,type:x,onClose:l}){return r.useEffect(()=>{const g=setTimeout(l,3e3);return()=>clearTimeout(g)},[l]),e.jsxs("div",{style:{position:"fixed",top:20,left:"50%",transform:"translateX(-50%)",zIndex:2e3,animation:"slideDown 0.3s ease-out"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,padding:"14px 20px",background:x==="success"?"#10b981":"#ef4444",color:"white",borderRadius:10,boxShadow:"0 10px 25px rgba(0,0,0,0.2)",fontSize:14,fontWeight:600},children:[x==="success"?e.jsx(Oe,{size:20}):e.jsx(Ae,{size:20}),e.jsx("span",{children:s}),e.jsx("button",{onClick:l,style:{marginLeft:8,background:"rgba(255,255,255,0.2)",border:"none",borderRadius:"50%",width:22,height:22,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"white"},children:e.jsx(U,{size:12})})]}),e.jsx("style",{children:`
        @keyframes slideDown {
          from { opacity: 0; transform: translateX(-50%) translateY(-20px); }
          to { opacity: 1; transform: translateX(-50%) translateY(0); }
        }
      `})]})}function Ue({isOpen:s,onClose:x,customerSeq:l,customerName:g,companyType:u,meetingId:T,avgSales3Month:R,onSubmit:S}){const[m,z]=r.useState(""),[k,j]=r.useState(""),[v,I]=r.useState(""),[y,B]=r.useState(!1),[b,a]=r.useState(null),w=async()=>{if(!m.trim()){a({message:"해제 사유를 입력해주세요.",type:"error"});return}B(!0);try{const c=localStorage.getItem("tnt.sales.empId")||"",A=localStorage.getItem("tnt.sales.empName")||"",p=await fetch("/api/v1/credit/unblock-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyType:u,meetingId:T||null,customerSeq:l,customerName:g,assigneeId:c,reasonText:m,collectionPlan:k||null,targetUnblockDate:v||null,summaryLast3mSalesAvg:R,createdBy:A||c})});if(!p.ok)throw new Error("등록 실패");const N=await p.json();if(N.success)a({message:"해제 품의가 등록되었습니다.",type:"success"}),S(),setTimeout(()=>{x()},1500);else throw new Error(N.error||"등록 실패")}catch(c){console.error("해제 품의 등록 실패:",c),a({message:"등록에 실패했습니다.",type:"error"})}finally{B(!1)}};return s?e.jsxs(e.Fragment,{children:[b&&e.jsx(K,{message:b.message,type:b.type,onClose:()=>a(null)}),e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"white",borderRadius:12,width:600,maxHeight:"80vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"매출통제 해제 품의 등록"}),e.jsx("button",{onClick:x,style:{width:28,height:28,borderRadius:"50%",border:"none",background:"#f3f4f6",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(U,{size:14,color:"#6b7280"})})]}),e.jsxs("div",{style:{padding:20},children:[e.jsxs("div",{style:{background:"#f9fafb",borderRadius:8,padding:12,marginBottom:16},children:[e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"거래처"}),e.jsx("div",{style:{fontSize:14,fontWeight:600},children:g})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,marginBottom:6,color:"#374151"},children:["해제 사유 ",e.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),e.jsx("textarea",{value:m,onChange:c=>z(c.target.value),placeholder:"매출통제 해제가 필요한 사유를 입력하세요",style:{width:"100%",minHeight:80,padding:10,border:"1px solid #d1d5db",borderRadius:6,fontSize:13,resize:"vertical",boxSizing:"border-box"}})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,marginBottom:6,color:"#374151"},children:"수금 계획"}),e.jsx("textarea",{value:k,onChange:c=>j(c.target.value),placeholder:"예상 수금 계획을 입력하세요",style:{width:"100%",minHeight:60,padding:10,border:"1px solid #d1d5db",borderRadius:6,fontSize:13,resize:"vertical",boxSizing:"border-box"}})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,marginBottom:6,color:"#374151"},children:"희망 해제일"}),e.jsx("input",{type:"date",value:v,onChange:c=>I(c.target.value),style:{width:"100%",padding:10,border:"1px solid #d1d5db",borderRadius:6,fontSize:13,boxSizing:"border-box"}})]}),e.jsxs("div",{style:{background:"#eff6ff",borderRadius:8,padding:12,marginBottom:16},children:[e.jsx("div",{style:{fontSize:11,color:"#1d4ed8",fontWeight:600,marginBottom:4},children:"참고 정보"}),e.jsxs("div",{style:{fontSize:12,color:"#374151"},children:["3개월 평균매출: ₩",R.toLocaleString()]})]})]}),e.jsxs("div",{style:{padding:"12px 20px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{onClick:x,style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:6,background:"white",fontSize:13,cursor:"pointer"},children:"취소"}),e.jsx("button",{onClick:w,disabled:y,style:{padding:"8px 16px",border:"none",borderRadius:6,background:"#f59e0b",color:"white",fontSize:13,fontWeight:600,cursor:y?"not-allowed":"pointer",opacity:y?.6:1},children:y?"등록 중...":"등록"})]})]})})]}):null}function Fe({isOpen:s,onClose:x,unblockRequest:l,avgSales3Month:g,onSubmit:u}){var b;const[T,R]=r.useState((l==null?void 0:l.reason_text)||""),[S,m]=r.useState((l==null?void 0:l.collection_plan)||""),[z,k]=r.useState(((b=l==null?void 0:l.target_unblock_date)==null?void 0:b.slice(0,10))||""),[j,v]=r.useState(!1),[I,y]=r.useState(null);r.useEffect(()=>{var a;l&&(R(l.reason_text||""),m(l.collection_plan||""),k(((a=l.target_unblock_date)==null?void 0:a.slice(0,10))||""))},[l]);const B=async()=>{if(!T.trim()){y({message:"해제 사유를 입력해주세요.",type:"error"});return}v(!0);try{const a=localStorage.getItem("tnt.sales.empName")||localStorage.getItem("tnt.sales.empId")||"",w=await fetch(`/api/v1/credit/unblock-requests/${l.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({reasonText:T,collectionPlan:S||null,targetUnblockDate:z||null,updatedBy:a})});if(!w.ok)throw new Error("수정 실패");const c=await w.json();if(c.success)y({message:"해제 품의가 수정되었습니다.",type:"success"}),u(),setTimeout(()=>{x()},1500);else throw new Error(c.error||"수정 실패")}catch(a){console.error("해제 품의 수정 실패:",a),y({message:"수정에 실패했습니다.",type:"error"})}finally{v(!1)}};return!s||!l?null:e.jsxs(e.Fragment,{children:[I&&e.jsx(K,{message:I.message,type:I.type,onClose:()=>y(null)}),e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"white",borderRadius:12,width:600,maxHeight:"80vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"매출통제 해제 품의 수정"}),e.jsx("button",{onClick:x,style:{width:28,height:28,borderRadius:"50%",border:"none",background:"#f3f4f6",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(U,{size:14,color:"#6b7280"})})]}),e.jsxs("div",{style:{padding:20},children:[e.jsxs("div",{style:{background:"#f9fafb",borderRadius:8,padding:12,marginBottom:16},children:[e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"거래처"}),e.jsx("div",{style:{fontSize:14,fontWeight:600},children:l.customer_name})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,marginBottom:6,color:"#374151"},children:["해제 사유 ",e.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),e.jsx("textarea",{value:T,onChange:a=>R(a.target.value),placeholder:"매출통제 해제가 필요한 사유를 입력하세요",style:{width:"100%",minHeight:80,padding:10,border:"1px solid #d1d5db",borderRadius:6,fontSize:13,resize:"vertical",boxSizing:"border-box"}})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,marginBottom:6,color:"#374151"},children:"수금 계획"}),e.jsx("textarea",{value:S,onChange:a=>m(a.target.value),placeholder:"예상 수금 계획을 입력하세요",style:{width:"100%",minHeight:60,padding:10,border:"1px solid #d1d5db",borderRadius:6,fontSize:13,resize:"vertical",boxSizing:"border-box"}})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,marginBottom:6,color:"#374151"},children:"희망 해제일"}),e.jsx("input",{type:"date",value:z,onChange:a=>k(a.target.value),style:{width:"100%",padding:10,border:"1px solid #d1d5db",borderRadius:6,fontSize:13,boxSizing:"border-box"}})]}),e.jsxs("div",{style:{background:"#eff6ff",borderRadius:8,padding:12,marginBottom:16},children:[e.jsx("div",{style:{fontSize:11,color:"#1d4ed8",fontWeight:600,marginBottom:4},children:"참고 정보"}),e.jsxs("div",{style:{fontSize:12,color:"#374151"},children:["3개월 평균매출: ₩",g.toLocaleString()]})]})]}),e.jsxs("div",{style:{padding:"12px 20px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{onClick:x,style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:6,background:"white",fontSize:13,cursor:"pointer"},children:"취소"}),e.jsx("button",{onClick:B,disabled:j,style:{padding:"8px 16px",border:"none",borderRadius:6,background:"#3b82f6",color:"white",fontSize:13,fontWeight:600,cursor:j?"not-allowed":"pointer",opacity:j?.6:1},children:j?"수정 중...":"수정"})]})]})})]})}function Le({isOpen:s,onClose:x,customerSeq:l,customerName:g,companyType:u,meetingId:T,onSubmit:R}){const[S,m]=r.useState(""),[z,k]=r.useState(""),[j]=r.useState("채권관리"),[v,I]=r.useState(()=>new Date().toISOString().split("T")[0]),[y,B]=r.useState("방문"),[b,a]=r.useState(!1),[w,c]=r.useState(null),A=async()=>{if(!S.trim()){c({message:"제목을 입력해주세요.",type:"error"});return}a(!0);try{const p=localStorage.getItem("tnt.sales.empId")||"",N=localStorage.getItem("tnt.sales.empName")||"",H=await fetch("/api/v1/credit/activities",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerSeq:l,companyType:u,subject:S,description:z,activityType:j,activityDate:v,activityMethod:y,assigneeId:p,meetingId:T||null,createdBy:N||p})});if(!H.ok)throw new Error("등록 실패");const F=await H.json();if(F.success)c({message:"활동 이력이 등록되었습니다.",type:"success"}),R(),setTimeout(()=>{m(""),k(""),x()},1500);else throw new Error(F.error||"등록 실패")}catch(p){console.error("활동 이력 등록 실패:",p),c({message:"등록에 실패했습니다.",type:"error"})}finally{a(!1)}};return s?e.jsxs(e.Fragment,{children:[w&&e.jsx(K,{message:w.message,type:w.type,onClose:()=>c(null)}),e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"white",borderRadius:12,width:600,maxHeight:"80vh",overflow:"auto",boxShadow:"0 20px 25px -5px rgba(0,0,0,0.1)"},children:[e.jsxs("div",{style:{padding:"16px 20px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"채권회의 활동 이력 등록"}),e.jsx("button",{onClick:x,style:{width:28,height:28,borderRadius:"50%",border:"none",background:"#f3f4f6",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(U,{size:14,color:"#6b7280"})})]}),e.jsxs("div",{style:{padding:20},children:[e.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[e.jsxs("div",{style:{flex:1,background:"#f9fafb",borderRadius:8,padding:12},children:[e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"거래처"}),e.jsx("div",{style:{fontSize:14,fontWeight:600},children:g})]}),e.jsxs("div",{style:{flex:1,background:"#f9fafb",borderRadius:8,padding:12},children:[e.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"활동유형"}),e.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#f59e0b"},children:j})]})]}),e.jsxs("div",{style:{display:"flex",gap:12,marginBottom:16},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,marginBottom:6,color:"#374151"},children:"수행일자"}),e.jsx("input",{type:"date",value:v,onChange:p=>I(p.target.value),style:{width:"100%",padding:10,border:"1px solid #d1d5db",borderRadius:6,fontSize:13,boxSizing:"border-box"}})]}),e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,marginBottom:6,color:"#374151"},children:"활동방법"}),e.jsxs("select",{value:y,onChange:p=>B(p.target.value),style:{width:"100%",padding:10,border:"1px solid #d1d5db",borderRadius:6,fontSize:13,boxSizing:"border-box"},children:[e.jsx("option",{value:"방문",children:"방문"}),e.jsx("option",{value:"전화",children:"전화"}),e.jsx("option",{value:"문자/메일/팩스",children:"문자/메일/팩스"}),e.jsx("option",{value:"기타",children:"기타"})]})]})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("label",{style:{display:"block",fontSize:12,fontWeight:600,marginBottom:6,color:"#374151"},children:["제목 ",e.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),e.jsx("input",{type:"text",value:S,onChange:p=>m(p.target.value),placeholder:"활동 제목을 입력하세요",style:{width:"100%",padding:10,border:"1px solid #d1d5db",borderRadius:6,fontSize:13,boxSizing:"border-box"}})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,marginBottom:6,color:"#374151"},children:"내용"}),e.jsx("textarea",{value:z,onChange:p=>k(p.target.value),placeholder:"활동 내용을 입력하세요",style:{width:"100%",minHeight:100,padding:10,border:"1px solid #d1d5db",borderRadius:6,fontSize:13,resize:"vertical",boxSizing:"border-box"}})]})]}),e.jsxs("div",{style:{padding:"12px 20px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{onClick:x,style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:6,background:"white",fontSize:13,cursor:"pointer"},children:"취소"}),e.jsx("button",{onClick:A,disabled:b,style:{padding:"8px 16px",border:"none",borderRadius:6,background:"#f59e0b",color:"white",fontSize:13,fontWeight:600,cursor:b?"not-allowed":"pointer",opacity:b?.6:1},children:b?"등록 중...":"등록"})]})]})})]}):null}function et(){const{selectedCustomer:s,setSelectedCustomer:x,meetingDate:l,meetingId:g,meetingStatus:u,opinionRefreshTrigger:T}=We(),[R,S]=r.useState([]),[m,z]=r.useState([]),[k,j]=r.useState([]),[v,I]=r.useState([]),[y,B]=r.useState([]),[b,a]=r.useState(0),[w,c]=r.useState([]),[A,p]=r.useState([]),[N,H]=r.useState(!1),[F,re]=r.useState(!1),[Se,le]=r.useState(!1),[Y,J]=r.useState({show:!1,activityId:null}),[V,X]=r.useState({show:!1,requestId:null}),[G,D]=r.useState(null),[ve,ae]=r.useState(null),[we,de]=r.useState(null),[ze,ce]=r.useState(!1),[ke,pe]=r.useState(null),[E,Q]=r.useState({show:!1,opinion:null}),[Z,q]=r.useState({show:!1,opinionId:null}),[ge,fe]=r.useState(""),[C,ee]=r.useState(null),[f,Ie]=r.useState({opinions:!0,activities:!0,unblock:!0,receivableMetrics:!0,collections:!0,monthlyCollections:!0,avgSales:!0,transactions:!0}),W=t=>{Ie(o=>({...o,[t]:!o[t]}))},Ce=t=>t==="TNT"?e.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,background:"#3b82f6",color:"white",borderRadius:3,fontSize:10,fontWeight:700,marginRight:4},children:"T"}):t==="DYS"?e.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,background:"#10b981",color:"white",borderRadius:3,fontSize:10,fontWeight:700,marginRight:4},children:"D"}):null,Te=t=>{const o={display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,borderRadius:"50%",color:"white",fontSize:10,fontWeight:700};return t==="high"?e.jsx("span",{style:{...o,background:"#ef4444"},children:"고"}):t==="medium"?e.jsx("span",{style:{...o,background:"#f59e0b"},children:"중"}):t==="low"?e.jsx("span",{style:{...o,background:"#10b981"},children:"저"}):e.jsx("span",{style:{...o,background:"#6b7280"},children:"-"})},L=async()=>{if(s!=null&&s.customerSeq)try{const t=await fetch(`/api/v1/credit/customers/${s.customerSeq}/opinions`);if(!t.ok)throw new Error("API 호출 실패");const o=await t.json();p((o.opinions||[]).map(n=>({id:n.id,meetingId:n.meeting_id,meetingCode:n.meeting_code,meetingName:n.meeting_name,meetingDate:n.meeting_date,decisionComment:n.decision_comment,reviewFlag:n.review_flag,createdAt:n.created_at,createdBy:n.created_by})))}catch(t){console.error("연체 의견 조회 실패:",t),p([])}},te=async()=>{if(s!=null&&s.customerSeq){H(!0);try{const t=new URLSearchParams;t.append("customerSeq",String(s.customerSeq)),t.append("companyType",s.companyType||""),t.append("externalId","ar_meeting");const o=await fetch(`/api/v1/credit/activities?${t.toString()}`);if(!o.ok)throw new Error("API 호출 실패");const n=await o.json();S((n.items||[]).map(i=>({id:i.id,subject:i.subject,description:i.description,activityType:i.activity_type,activityStatus:i.activity_status,plannedStartAt:i.planned_start_at,createdAt:i.created_at,createdBy:i.created_by,ownerId:i.sf_owner_id,ownerName:i.owner_name,meetingId:i.meeting_id})))}catch(t){console.error("활동 이력 조회 실패:",t),S([])}finally{H(!1)}}},$=async()=>{if(s!=null&&s.customerSeq)try{const t=new URLSearchParams;t.append("customerSeq",String(s.customerSeq)),t.append("companyType",s.companyType||""),l&&t.append("meetingDate",l),g&&t.append("meetingId",String(g));const o=await fetch(`/api/v1/credit/customer-details?${t.toString()}`);if(!o.ok)throw new Error("API 호출 실패");const n=await o.json();z(n.collections||[]),j(n.monthlyCollections||[]),I((n.recentTransactions||[]).map(i=>({salesMgmtUnit:i.sales_mgmt_unit,itemName:i.item_name,quantity:i.quantity,amount:i.amount}))),B(n.monthlySales3Month||[]),a(n.avgSales3Month||0),c(n.unblockRequests||[])}catch(t){console.error("거래처 상세 조회 실패:",t),z([]),j([]),I([]),B([]),a(0),c([])}},Re=async()=>{if(s!=null&&s.customerSeq)try{const t=new URLSearchParams;t.append("customerSeq",String(s.customerSeq)),t.append("companyType",s.companyType||"TNT"),s.totalAr&&t.append("totalAr",String(s.totalAr));const o=await fetch(`/api/v1/credit/receivable-metrics?${t.toString()}`);if(!o.ok)throw new Error("API 호출 실패");const n=await o.json();n.success&&ee({sales12Month:n.sales12Month||0,arToSalesRatio:n.arToSalesRatio||0,totalAr:n.totalAr||0,collection90Days:n.collection90Days||0,sales90Days:n.sales90Days||0,collectionToSalesRatio:n.collectionToSalesRatio||0})}catch(t){console.error("미수 지표 조회 실패:",t),ee(null)}},Be=t=>{J({show:!0,activityId:t})},De=async()=>{if(Y.activityId)try{const t=await fetch(`/api/v1/credit/activities/${Y.activityId}`,{method:"DELETE"});if(!t.ok)throw new Error("삭제 실패");const o=await t.json();if(o.success)D({message:"활동 이력이 삭제되었습니다.",type:"success"}),te();else throw new Error(o.error||"삭제 실패")}catch(t){console.error("활동 이력 삭제 실패:",t),D({message:"삭제에 실패했습니다.",type:"error"})}finally{J({show:!1,activityId:null})}};r.useEffect(()=>{s!=null&&s.customerSeq?(te(),$(),L(),Re()):(S([]),z([]),j([]),I([]),B([]),a(0),c([]),p([]),ee(null))},[s==null?void 0:s.customerSeq,s==null?void 0:s.companyType,l,g]),r.useEffect(()=>{s!=null&&s.customerSeq&&T>0&&L()},[T]);const M=t=>{if(!t)return"-";if(/^\d{8}$/.test(t)){const n=t.slice(0,4),i=t.slice(4,6),h=t.slice(6,8);return`${n}. ${i}. ${h}.`}const o=new Date(t);return isNaN(o.getTime())?"-":o.toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})},_=t=>t==null?"-":`₩${t.toLocaleString("ko-KR")}`,he=t=>{if(!t)return"-";const o=t.split("-");if(o.length>=2){const n=o[0].slice(2),i=o[1];return`${n}년 ${i}월`}return t},oe=r.useMemo(()=>!m||m.length===0?[]:m.map(t=>({date:t.collection_date||"",totalAmount:t.amount||0,count:t.count||1,methods:t.method?t.method.split(", ").filter(o=>o.trim()!==""):[]})),[m]);if(!s)return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",color:"#9ca3af",padding:24,textAlign:"center"},children:[e.jsx(be,{size:40,strokeWidth:1}),e.jsx("div",{style:{fontSize:14,marginTop:12,marginBottom:8},children:"거래처 상세 정보"}),e.jsx("div",{style:{fontSize:12},children:"왼쪽 목록에서 거래처를 선택하세요"})]});const P=({icon:t,title:o,sectionKey:n,isCollapsed:i,onToggle:h})=>e.jsxs("div",{onClick:()=>h(n),style:{display:"flex",alignItems:"center",gap:6,padding:"8px 10px",background:"#1e3a5f",borderRadius:6,marginBottom:i?0:8,cursor:"pointer",userSelect:"none"},children:[e.jsx(t,{size:16,color:"white"}),e.jsx("span",{style:{fontSize:13,fontWeight:700,color:"white",flex:1},children:o}),i?e.jsx(ie,{size:16,color:"white"}):e.jsx(se,{size:16,color:"white"})]});return e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between",background:"#fff"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[Ce(s.companyType||""),e.jsx("span",{style:{fontWeight:700,fontSize:14},children:s.customerName||"-"}),Te(s.riskLevel||"")]}),e.jsx("button",{onClick:()=>x(null),style:{width:28,height:28,borderRadius:"50%",border:"none",background:"#f3f4f6",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(U,{size:14,color:"#6b7280"})})]}),e.jsx("div",{style:{flex:1,overflow:"auto",padding:12},children:N?e.jsxs("div",{style:{textAlign:"center",color:"#9ca3af",padding:24},children:[e.jsx(Ne,{size:20,style:{animation:"spin 1s linear infinite"}}),e.jsx("p",{style:{fontSize:12,marginTop:8},children:"로딩 중..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(P,{icon:ue,title:"연체 의견",sectionKey:"opinions",isCollapsed:f.opinions,onToggle:W}),!f.opinions&&(A.length===0?e.jsx("div",{style:{fontSize:12,color:"#9ca3af",padding:12,textAlign:"center",background:"#f9fafb",borderRadius:6},children:"등록된 연체 의견이 없습니다"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:A.map(t=>{const o=t.meetingId!==g,n=u==="FINISHED",i=o||n,h=()=>n?"종료된 회의입니다":o?"다른 회의에서 생성된 데이터입니다":"";return e.jsxs("div",{style:{background:"#f9fafb",borderRadius:6,padding:10},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:4},children:[e.jsxs("div",{style:{fontSize:11,color:"#6b7280"},children:[M(t.meetingDate)," · ",t.meetingName||t.meetingCode||"-"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[e.jsx("button",{onClick:()=>{i||(Q({show:!0,opinion:t}),fe(t.decisionComment||""))},disabled:i,style:{background:"none",border:"none",padding:2,cursor:i?"not-allowed":"pointer",display:"flex",alignItems:"center",color:i?"#d1d5db":"#9ca3af",opacity:i?.5:1},onMouseOver:d=>{i||(d.currentTarget.style.color="#3b82f6")},onMouseOut:d=>{i||(d.currentTarget.style.color="#9ca3af")},title:i?h():"수정",children:e.jsx(je,{size:12})}),e.jsx("button",{onClick:()=>{i||q({show:!0,opinionId:t.id})},disabled:i,style:{background:"none",border:"none",padding:2,cursor:i?"not-allowed":"pointer",display:"flex",alignItems:"center",color:i?"#d1d5db":"#9ca3af",opacity:i?.5:1},onMouseOver:d=>{i||(d.currentTarget.style.color="#ef4444")},onMouseOut:d=>{i||(d.currentTarget.style.color="#9ca3af")},title:i?h():"삭제",children:e.jsx(ne,{size:12})})]})]}),t.decisionComment&&e.jsx("div",{style:{fontSize:12,color:"#374151",lineHeight:1.5},children:t.decisionComment}),e.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:4},children:["작성: ",t.createdBy||"-"]})]},t.id)})}))]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 10px",background:"#1e3a5f",borderRadius:6,marginBottom:f.activities?0:8,cursor:"pointer",userSelect:"none"},onClick:()=>W("activities"),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,flex:1},children:[e.jsx(be,{size:16,color:"white"}),e.jsx("span",{style:{fontSize:14,fontWeight:700,color:"white"},children:"채권회의 활동 이력"}),f.activities?e.jsx(ie,{size:16,color:"white"}):e.jsx(se,{size:16,color:"white"})]}),e.jsxs("button",{onClick:t=>{t.stopPropagation(),le(!0)},disabled:u==="FINISHED",title:u==="FINISHED"?"종료된 회의입니다":"",style:{padding:"3px 8px",background:u==="FINISHED"?"#9ca3af":"#f59e0b",color:"white",border:"none",borderRadius:4,fontSize:10,fontWeight:600,cursor:u==="FINISHED"?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:3,opacity:u==="FINISHED"?.7:1},children:[e.jsx(me,{size:10}),"등록"]})]}),!f.activities&&(R.length===0?e.jsx("div",{style:{fontSize:12,color:"#9ca3af",padding:12,textAlign:"center",background:"#f9fafb",borderRadius:6},children:"등록된 활동 이력이 없습니다"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:R.slice(0,5).map(t=>{const o=t.meetingId!==g,n=u==="FINISHED",i=o||n,h=()=>n?"종료된 회의입니다":o?"다른 회의에서 생성된 데이터입니다":"삭제";return e.jsxs("div",{style:{background:"#f9fafb",borderRadius:6,padding:10,position:"relative",cursor:"pointer"},onMouseEnter:()=>ae(t.id),onMouseLeave:()=>ae(null),children:[e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",justifyContent:"space-between",marginBottom:4},children:[e.jsx("div",{style:{fontWeight:600,fontSize:12,color:"#111827",flex:1},children:t.subject||"(제목 없음)"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{style:{padding:"2px 5px",background:t.activityStatus==="completed"?"#dcfce7":"#fef3c7",color:t.activityStatus==="completed"?"#166534":"#92400e",borderRadius:3,fontSize:9,fontWeight:600},children:t.activityStatus==="completed"?"완료":t.activityStatus==="계획"?"계획":"진행중"}),e.jsx("button",{onClick:d=>{d.stopPropagation(),i||Be(t.id)},disabled:i,style:{background:"none",border:"none",padding:2,cursor:i?"not-allowed":"pointer",display:"flex",alignItems:"center",color:i?"#d1d5db":"#9ca3af",opacity:i?.5:1},onMouseOver:d=>{i||(d.currentTarget.style.color="#ef4444")},onMouseOut:d=>{i||(d.currentTarget.style.color="#9ca3af")},title:h(),children:e.jsx(ne,{size:12})})]})]}),t.description&&e.jsx("div",{style:{fontSize:11,color:"#6b7280",marginBottom:4,lineHeight:1.4},children:t.description.length>50?t.description.substring(0,50)+"...":t.description}),e.jsxs("div",{style:{fontSize:10,color:"#9ca3af"},children:[M(t.plannedStartAt)," · ",t.ownerName||t.createdBy||t.ownerId||"-"]}),ve===t.id&&t.description&&e.jsxs("div",{style:{position:"absolute",left:0,right:0,top:"100%",marginTop:4,background:"#1f2937",color:"white",borderRadius:8,padding:12,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.2)",zIndex:100},children:[e.jsx("div",{style:{position:"absolute",left:20,top:-6,width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"6px solid #1f2937"}}),e.jsx("div",{style:{fontWeight:600,fontSize:12,marginBottom:8},children:t.subject||"(제목 없음)"}),e.jsx("div",{style:{fontSize:11,lineHeight:1.5,whiteSpace:"pre-wrap"},children:t.description}),e.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginTop:8,borderTop:"1px solid #374151",paddingTop:8},children:[M(t.plannedStartAt)," · ",t.createdBy||"-"]})]})]},t.id)})}))]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 10px",background:"#1e3a5f",borderRadius:6,marginBottom:f.unblock?0:8,cursor:"pointer",userSelect:"none"},onClick:()=>W("unblock"),children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,flex:1},children:[e.jsx(ue,{size:16,color:"white"}),e.jsx("span",{style:{fontSize:13,fontWeight:700,color:"white"},children:"매출통제 해제 품의 이력"}),f.unblock?e.jsx(ie,{size:16,color:"white"}):e.jsx(se,{size:16,color:"white"})]}),(()=>{const t=w.some(h=>h.meeting_id===g),o=u==="FINISHED",n=t||o,i=()=>o?"종료된 회의입니다":t?"이 미팅에서 이미 품의가 등록되었습니다":"";return e.jsxs("button",{onClick:h=>{h.stopPropagation(),re(!0)},disabled:n,title:i(),style:{padding:"3px 8px",background:n?"#9ca3af":"#f59e0b",color:"white",border:"none",borderRadius:4,fontSize:10,fontWeight:600,cursor:n?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:3,opacity:n?.7:1},children:[e.jsx(me,{size:10}),"생성"]})})()]}),!f.unblock&&e.jsx("div",{children:w.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:w.map((t,o)=>{const n=t.meeting_id!==g,i=u==="FINISHED",h=t.request_status!=="SUBMITTED",d=n||i||h,xe=O=>i?"종료된 회의입니다":n?"다른 회의에서 생성된 데이터입니다":h?"제출 상태만 "+O+" 가능":O;return e.jsxs("div",{style:{padding:8,background:o===0?"#fef3c7":"white",borderRadius:4,border:"1px solid #fcd34d",position:"relative",cursor:"pointer"},onMouseEnter:()=>de(t.id||o),onMouseLeave:()=>de(null),children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:4},children:[e.jsxs("span",{style:{fontSize:10,color:"#6b7280"},children:[M(t.created_at)," | ",t.created_by||"-"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{style:{fontSize:9,padding:"1px 4px",background:t.request_status==="SUBMITTED"?"#3b82f6":t.request_status==="APPROVED_1ST"?"#f59e0b":t.request_status==="APPROVED_FINAL"?"#10b981":t.request_status==="REJECTED"?"#ef4444":t.request_status==="WITHDRAWN"?"#6b7280":"#3b82f6",color:"white",borderRadius:3},children:t.request_status==="SUBMITTED"?"제출":t.request_status==="APPROVED_1ST"?"1차승인":t.request_status==="APPROVED_FINAL"?"최종승인":t.request_status==="REJECTED"?"반려":t.request_status==="WITHDRAWN"?"철회":"제출"}),e.jsx("button",{onClick:O=>{O.stopPropagation(),!d&&(pe(t),ce(!0))},disabled:d,style:{padding:2,background:"transparent",border:"none",cursor:d?"not-allowed":"pointer",display:"flex",alignItems:"center",opacity:d?.5:1},title:xe("수정"),children:e.jsx(je,{size:12,color:d?"#d1d5db":"#3b82f6"})}),e.jsx("button",{onClick:O=>{O.stopPropagation(),!d&&X({show:!0,requestId:t.id})},disabled:d,style:{padding:2,background:"transparent",border:"none",cursor:d?"not-allowed":"pointer",display:"flex",alignItems:"center",opacity:d?.5:1},title:xe("삭제"),children:e.jsx(ne,{size:12,color:d?"#d1d5db":"#ef4444"})})]})]}),e.jsx("p",{style:{fontSize:12,color:"#92400e",margin:0,lineHeight:1.5},children:t.reason_text&&t.reason_text.length>50?t.reason_text.substring(0,50)+"...":t.reason_text}),t.collection_plan&&e.jsxs("p",{style:{fontSize:11,color:"#78716c",margin:"4px 0 0",lineHeight:1.4},children:["수금계획: ",t.collection_plan&&t.collection_plan.length>30?t.collection_plan.substring(0,30)+"...":t.collection_plan]}),we===(t.id||o)&&(t.reason_text||t.collection_plan)&&e.jsxs("div",{style:{position:"absolute",left:0,right:0,top:"100%",marginTop:4,background:"#1f2937",color:"white",borderRadius:8,padding:12,boxShadow:"0 4px 12px rgba(0, 0, 0, 0.2)",zIndex:100},children:[e.jsx("div",{style:{position:"absolute",left:20,top:-6,width:0,height:0,borderLeft:"6px solid transparent",borderRight:"6px solid transparent",borderBottom:"6px solid #1f2937"}}),e.jsxs("div",{style:{fontSize:10,color:"#9ca3af",marginBottom:6},children:[M(t.created_at)," | ",t.created_by||"-"]}),t.reason_text&&e.jsxs("div",{style:{fontSize:11,lineHeight:1.5,whiteSpace:"pre-wrap",marginBottom:8},children:[e.jsx("span",{style:{fontWeight:600},children:"사유: "}),t.reason_text]}),t.collection_plan&&e.jsxs("div",{style:{fontSize:11,lineHeight:1.5,whiteSpace:"pre-wrap",borderTop:"1px solid #374151",paddingTop:8},children:[e.jsx("span",{style:{fontWeight:600},children:"수금계획: "}),t.collection_plan]})]})]},t.id||o)})}):e.jsx("p",{style:{fontSize:12,color:"#9ca3af",margin:0,fontStyle:"italic"},children:"등록된 의견이 없습니다"})})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(P,{icon:ye,title:"미수 지표",sectionKey:"receivableMetrics",isCollapsed:f.receivableMetrics,onToggle:W}),!f.receivableMetrics&&(C?(()=>{const t=new Date,o=new Date(t.getFullYear(),t.getMonth(),0),n=new Date(o.getFullYear(),o.getMonth()-11,1),i=`${String(n.getFullYear()).slice(2)}년${n.getMonth()+1}월`,h=`${String(o.getFullYear()).slice(2)}년${o.getMonth()+1}월`;return e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8,padding:"8px 0"},children:[e.jsxs("div",{style:{background:"#f8fafc",borderRadius:8,padding:10,border:"1px solid #e2e8f0"},children:[e.jsxs("div",{style:{fontSize:9,color:"#64748b",marginBottom:4},children:["총미수액/12개월 매출(",i,"~",h,")"]}),e.jsxs("div",{style:{fontSize:18,fontWeight:700,color:C.arToSalesRatio>100?"#ef4444":C.arToSalesRatio>50?"#f59e0b":"#10b981"},children:[C.arToSalesRatio.toFixed(1),"%"]}),e.jsxs("div",{style:{fontSize:9,color:"#94a3b8",marginTop:2},children:[_(C.totalAr),"/",_(C.sales12Month)]})]}),e.jsxs("div",{style:{background:"#f8fafc",borderRadius:8,padding:10,border:"1px solid #e2e8f0"},children:[e.jsx("div",{style:{fontSize:10,color:"#64748b",marginBottom:4},children:"최근 90일 수금/매출"}),e.jsxs("div",{style:{fontSize:18,fontWeight:700,color:C.collectionToSalesRatio>=80?"#10b981":C.collectionToSalesRatio>=50?"#f59e0b":"#ef4444"},children:[C.collectionToSalesRatio.toFixed(1),"%"]}),e.jsxs("div",{style:{fontSize:9,color:"#94a3b8",marginTop:2},children:[_(C.collection90Days),"/",_(C.sales90Days)]})]})]})})():e.jsx("div",{style:{fontSize:12,color:"#9ca3af",padding:8,textAlign:"center"},children:"지표 데이터 없음"}))]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(P,{icon:Pe,title:"수금 현황",sectionKey:"collections",isCollapsed:f.collections,onToggle:W}),!f.collections&&(oe.length===0?e.jsx("div",{style:{fontSize:12,color:"#9ca3af",padding:8,textAlign:"center"},children:"수금 내역이 없습니다"}):e.jsx("div",{style:{fontSize:11},children:oe.map((t,o)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"90px 1fr 90px",gap:8,padding:"6px 0",borderBottom:o<oe.length-1?"1px solid #f3f4f6":"none"},children:[e.jsxs("span",{style:{color:"#6b7280"},children:[M(t.date),t.count>1&&e.jsxs("span",{style:{color:"#9ca3af",fontSize:10,marginLeft:2},children:["(",t.count,"회)"]})]}),e.jsx("span",{style:{color:"#374151",textAlign:"left"},children:t.methods.length>0?t.methods.join(", "):"-"}),e.jsx("span",{style:{fontWeight:600,color:"#10b981",textAlign:"right"},children:_(t.totalAmount)})]},o))}))]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(P,{icon:Ee,title:"월별 수금내역 (12개월)",sectionKey:"monthlyCollections",isCollapsed:f.monthlyCollections,onToggle:W}),!f.monthlyCollections&&(k.length===0?e.jsx("div",{style:{fontSize:12,color:"#9ca3af",padding:8,textAlign:"center"},children:"월별 수금 내역이 없습니다"}):e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:6},children:k.slice(0,12).map((t,o)=>e.jsxs("div",{style:{background:o<3?"#ecfdf5":"#f9fafb",borderRadius:6,padding:6,textAlign:"center",border:o<3?"1px solid #10b981":"1px solid #e5e7eb"},children:[e.jsx("div",{style:{fontSize:9,color:"#6b7280"},children:he(t.month)}),e.jsx("div",{style:{fontSize:11,fontWeight:600,color:o<3?"#059669":"#111827"},children:_(t.amount)})]},o))}))]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(P,{icon:ye,title:"3개월 평균매출",sectionKey:"avgSales",isCollapsed:f.avgSales,onToggle:W}),!f.avgSales&&e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"stretch"},children:[e.jsxs("div",{style:{background:"#eff6ff",borderRadius:6,padding:10,textAlign:"center",minWidth:90,display:"flex",flexDirection:"column",justifyContent:"center"},children:[e.jsx("div",{style:{fontSize:10,color:"#6b7280",marginBottom:2},children:"평균"}),e.jsx("div",{style:{fontSize:14,fontWeight:700,color:"#1d4ed8"},children:_(b)})]}),y.length>0&&y.map((t,o)=>e.jsxs("div",{style:{flex:1,background:"#f9fafb",borderRadius:6,padding:8,textAlign:"center",display:"flex",flexDirection:"column",justifyContent:"center"},children:[e.jsx("div",{style:{fontSize:10,color:"#6b7280"},children:he(t.month)}),e.jsx("div",{style:{fontSize:11,fontWeight:600,color:"#111827"},children:_(t.amount)})]},o))]})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(P,{icon:Me,title:"최근90일 거래내역",sectionKey:"transactions",isCollapsed:f.transactions,onToggle:W}),!f.transactions&&(v.length===0?e.jsx("div",{style:{fontSize:12,color:"#9ca3af",padding:8,textAlign:"center"},children:"최근 90일 거래 내역이 없습니다"}):e.jsxs("div",{style:{fontSize:10},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"55px 1fr 45px 75px",gap:4,padding:"6px 0",borderBottom:"1px solid #e5e7eb",fontWeight:600,color:"#6b7280"},children:[e.jsx("span",{children:"관리단위"}),e.jsx("span",{children:"품목"}),e.jsx("span",{style:{textAlign:"right"},children:"수량"}),e.jsx("span",{style:{textAlign:"right"},children:"금액"})]}),e.jsx("div",{style:{maxHeight:300,overflowY:"auto"},children:v.map((t,o)=>{var n;return e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"55px 1fr 45px 75px",gap:4,padding:"6px 0",borderBottom:o<v.length-1?"1px solid #f3f4f6":"none",color:"#374151"},children:[e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:"#6b7280"},title:t.salesMgmtUnit||"-",children:t.salesMgmtUnit||"-"}),e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},title:t.itemName||"-",children:t.itemName||"-"}),e.jsx("span",{style:{textAlign:"right"},children:((n=t.quantity)==null?void 0:n.toLocaleString())||"-"}),e.jsx("span",{style:{textAlign:"right",fontWeight:600,color:"#111827"},children:_(t.amount)})]},o)})})]}))]})]})}),e.jsx("div",{style:{padding:10,borderTop:"1px solid #e5e7eb",background:"#f9fafb",fontSize:10,color:"#6b7280"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs("span",{children:["담당: ",s.salesRep||"-"]}),e.jsxs("span",{children:["부서: ",s.department||"-"]})]})}),e.jsx(Ue,{isOpen:F,onClose:()=>re(!1),customerSeq:s.customerSeq||0,customerName:s.customerName||"",companyType:s.companyType||"",meetingId:g,avgSales3Month:b,onSubmit:()=>{$()}}),e.jsx(Le,{isOpen:Se,onClose:()=>le(!1),customerSeq:s.customerSeq||0,customerName:s.customerName||"",companyType:s.companyType||"",meetingId:g,onSubmit:()=>{te()}}),e.jsx(Fe,{isOpen:ze,onClose:()=>{ce(!1),pe(null)},unblockRequest:ke,avgSales3Month:b,onSubmit:()=>{$()}}),Y.show&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1500},children:e.jsxs("div",{style:{background:"white",borderRadius:8,padding:20,width:300,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:12,color:"#111827"},children:"삭제 확인"}),e.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:20},children:"이 활동 이력을 삭제하시겠습니까?"}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{onClick:()=>J({show:!1,activityId:null}),style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:6,background:"white",fontSize:13,cursor:"pointer"},children:"취소"}),e.jsx("button",{onClick:De,style:{padding:"8px 16px",border:"none",borderRadius:6,background:"#ef4444",color:"white",fontSize:13,fontWeight:600,cursor:"pointer"},children:"삭제"})]})]})}),V.show&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1500},children:e.jsxs("div",{style:{background:"white",borderRadius:8,padding:20,width:300,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:12,color:"#111827"},children:"삭제 확인"}),e.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:20},children:"이 해제 품의를 삭제하시겠습니까?"}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{onClick:()=>X({show:!1,requestId:null}),style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:6,background:"white",fontSize:13,cursor:"pointer"},children:"취소"}),e.jsx("button",{onClick:async()=>{if(V.requestId)try{const o=await(await fetch(`/api/v1/credit/unblock-requests/${V.requestId}`,{method:"DELETE"})).json();o.success?(D({message:"삭제되었습니다.",type:"success"}),$()):D({message:o.error||"삭제에 실패했습니다.",type:"error"})}catch(t){console.error("삭제 실패:",t),D({message:"삭제에 실패했습니다.",type:"error"})}finally{X({show:!1,requestId:null})}},style:{padding:"8px 16px",border:"none",borderRadius:6,background:"#ef4444",color:"white",fontSize:13,fontWeight:600,cursor:"pointer"},children:"삭제"})]})]})}),E.show&&E.opinion&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1500},children:e.jsxs("div",{style:{background:"white",borderRadius:12,padding:20,width:600,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},children:[e.jsx("div",{style:{fontSize:16,fontWeight:700,marginBottom:16,color:"#111827"},children:"연체 의견 수정"}),e.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:8},children:[M(E.opinion.meetingDate)," · ",E.opinion.meetingName||E.opinion.meetingCode||"-"]}),e.jsx("textarea",{value:ge,onChange:t=>fe(t.target.value),placeholder:"연체 의견을 입력하세요",style:{width:"100%",minHeight:120,padding:12,border:"1px solid #d1d5db",borderRadius:8,fontSize:13,resize:"vertical",boxSizing:"border-box",marginBottom:16}}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{onClick:()=>Q({show:!1,opinion:null}),style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:6,background:"white",fontSize:13,cursor:"pointer"},children:"취소"}),e.jsx("button",{onClick:async()=>{if(E.opinion)try{const t=localStorage.getItem("tnt.sales.empName")||localStorage.getItem("tnt.sales.empId")||"",n=await(await fetch(`/api/v1/credit/meeting-customers/${E.opinion.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({decisionComment:ge,updatedBy:t})})).json();if(n.success)D({message:"연체 의견이 수정되었습니다.",type:"success"}),L(),Q({show:!1,opinion:null});else throw new Error(n.error||"수정 실패")}catch(t){console.error("연체 의견 수정 실패:",t),D({message:"수정에 실패했습니다.",type:"error"})}},style:{padding:"8px 16px",border:"none",borderRadius:6,background:"#3b82f6",color:"white",fontSize:13,fontWeight:600,cursor:"pointer"},children:"저장"})]})]})}),Z.show&&e.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1500},children:e.jsxs("div",{style:{background:"white",borderRadius:8,padding:20,width:300,boxShadow:"0 4px 20px rgba(0, 0, 0, 0.15)"},children:[e.jsx("div",{style:{fontSize:14,fontWeight:600,marginBottom:12,color:"#111827"},children:"삭제 확인"}),e.jsx("div",{style:{fontSize:13,color:"#6b7280",marginBottom:20},children:"이 연체 의견을 삭제하시겠습니까?"}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{onClick:()=>q({show:!1,opinionId:null}),style:{padding:"8px 16px",border:"1px solid #d1d5db",borderRadius:6,background:"white",fontSize:13,cursor:"pointer"},children:"취소"}),e.jsx("button",{onClick:async()=>{if(Z.opinionId)try{const o=await(await fetch(`/api/v1/credit/meeting-customers/${Z.opinionId}`,{method:"DELETE"})).json();if(o.success)D({message:"연체 의견이 삭제되었습니다.",type:"success"}),L();else throw new Error(o.error||"삭제 실패")}catch(t){console.error("연체 의견 삭제 실패:",t),D({message:"삭제에 실패했습니다.",type:"error"})}finally{q({show:!1,opinionId:null})}},style:{padding:"8px 16px",border:"none",borderRadius:6,background:"#ef4444",color:"white",fontSize:13,fontWeight:600,cursor:"pointer"},children:"삭제"})]})]})}),G&&e.jsx(K,{message:G.message,type:G.type,onClose:()=>D(null)})]})}export{et as CreditWorkflowRightPanel};
