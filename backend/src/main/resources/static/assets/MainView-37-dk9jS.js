var Ub=Object.defineProperty;var Hb=(e,t,r)=>t in e?Ub(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ul=(e,t,r)=>Hb(e,typeof t!="symbol"?t+"":t,r);import{c as _t,r as c,j as n,_ as Mf,R as ke,a as yd,g as Df,b as Hl,o as Kb,i as Kl,s as Yb,d as Gp,e as Vp,P as Xp,C as vd,f as qs,F as xd,h as Gr,k as Gb,l as $f,T as Vb}from"./index-BNMu8Wi9.js";import{DemandList as Xb}from"./DemandList-Dp6dX7Ls.js";import{c as Pt}from"./close-CV7tuFPj.js";import{t as ot}from"./tone-B1QjB-CC.js";import{u as jn}from"./useDraggableModal-JA419AsD.js";import{S as Rt,a as Fi,g as Lf,f as Qb}from"./week-BqXU0uPp.js";import{w as Rf}from"./warehouse-Du5HBj7c.js";import{C as Jb,P as Zb}from"./plus-BAyM3taz.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ej=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],tj=_t("arrow-left",ej);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nj=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],rj=_t("arrow-right",nj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aj=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],ij=_t("chart-no-axes-column",aj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sj=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],oj=_t("chevron-left",sj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lj=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],cj=_t("circle-check-big",lj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dj=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],Ro=_t("circle-check",dj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uj=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],fj=_t("clock",uj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hj=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],mj=_t("database",hj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pj=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ai=_t("dollar-sign",pj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gj=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]],yj=_t("ellipsis",gj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vj=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],xj=_t("eye",vj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bj=[["path",{d:"M12 3q1 4 4 6.5t3 5.5a1 1 0 0 1-14 0 5 5 0 0 1 1-3 1 1 0 0 0 5 0c0-2-1.5-3-1.5-5q0-2 2.5-4",key:"1slcih"}]],jj=_t("flame",bj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wj=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]],Sj=_t("layout-list",wj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nj=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Qp=_t("layout-grid",Nj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kj=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],Aj=_t("list",kj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cj=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],zf=_t("loader-circle",Cj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pj=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Ej=_t("refresh-cw",Pj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ij=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ya=_t("search",Ij);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tj=[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]],Oj=_t("table-2",Tj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _j=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Mj=_t("triangle-alert",_j);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dj=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],$j=_t("user",Dj);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lj=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Jp=_t("x",Lj),ln={demandManagement:!0,customerManagement:!0};function Rj(){const e=c.useRef(null),[t,r]=c.useState(null),[a,i]=c.useState([]),[s,o]=c.useState(null),[l,d]=c.useState([]),[f,u]=c.useState([]),[h,m]=c.useState(null),[p,x]=c.useState(!1),[v,g]=c.useState(null),[b,y]=c.useState(0),[A,C]=c.useState(""),N=()=>{var W;return(W=e.current)==null?void 0:W.click()},w=async W=>{var S;m(null);const j=(S=W.target.files)==null?void 0:S[0];if(r(j?j.name:null),d([]),i([]),o(null),!!j)try{const R=await Mf(()=>import("./xlsx-D_0l8YDs.js"),[]),I=await j.arrayBuffer(),$=R.read(I,{type:"array"}),J=$.SheetNames||[];i(J);const q=J[0];if(o(q||null),q){const K=$.Sheets[q],L=R.utils.sheet_to_json(K,{header:1});u(L),d(L)}}catch(R){m("엑셀 파일을 읽는 중 오류가 발생했습니다. 파일 형식을 확인해 주세요."),console.error(R)}},M=l&&l.length>0,O=c.useMemo(()=>{if(!M)return null;const W=l.reduce((j,S)=>Math.max(j,Array.isArray(S)?S.length:0),0);return n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsx("tr",{children:Array.from({length:W}).map((j,S)=>n.jsxs("th",{children:["C",S+1]},S))})}),n.jsx("tbody",{children:l.map((j,S)=>n.jsx("tr",{children:Array.from({length:W}).map((R,I)=>n.jsx("td",{children:Array.isArray(j)&&j[I]!=null?String(j[I]):""},I))},S))})]})})},[l,M]),D=async W=>{var R,I;const j=W.target.value;o(j);const S=(I=(R=e.current)==null?void 0:R.files)==null?void 0:I[0];if(S)try{const $=await Mf(()=>import("./xlsx-D_0l8YDs.js"),[]),J=await S.arrayBuffer(),K=$.read(J,{type:"array"}).Sheets[j],L=$.utils.sheet_to_json(K,{header:1});u(L),d(L)}catch($){m("시트를 전환하는 중 오류가 발생했습니다."),console.error($)}};return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:18},children:"Excel Upload"}),n.jsx("div",{className:"muted count-text"})]}),n.jsx("p",{children:"로컬 PC에서 엑셀 파일(.xlsx, .xls)만 선택할 수 있습니다."}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[n.jsx("input",{ref:e,type:"file",accept:".xlsx,.xls,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel",onChange:w,style:{display:"none"}}),n.jsx("button",{className:"btn",onClick:N,children:"엑셀 파일 선택"}),t&&n.jsxs("span",{className:"muted",children:["선택됨: ",t]})]}),a.length>1&&n.jsx("div",{style:{marginTop:10},children:n.jsxs("label",{children:["시트 선택: ",n.jsx("select",{value:s??"",onChange:D,children:a.map(W=>n.jsx("option",{value:W,children:W},W))})]})}),h&&n.jsx("div",{className:"error",children:h}),O,M&&n.jsxs("div",{style:{marginTop:12,display:"flex",alignItems:"center",gap:10},children:[n.jsx("button",{type:"button",className:"btn",disabled:p,onClick:async W=>{W.preventDefault(),W.stopPropagation(),g(null),m(null);try{x(!0),y(0),C("데이터 준비 중...");const j=zj(f);if(!j.length)throw new Error("업로드할 데이터가 없습니다. 엑셀 내용을 확인해 주세요.");const R=Bj(j,250);let I=0,$=0,J=0;for(let q=0;q<R.length;q++){const K=R[q];C(`업로드 중... (${q+1}/${R.length})`);const L=await fetch("/api/v1/demand/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:K})});if(!L.ok){const E=await L.text();try{const T=JSON.parse(E),B=(T==null?void 0:T.error)||E||`Upload failed: ${L.status}`;throw new Error(B)}catch{throw new Error(`Upload failed: ${L.status} ${E}`)}}const ee=await L.json();$+=Number(ee.updated||0),J+=Number(ee.inserted||0),I+=K.length,y(Math.min(100,Math.round(I/j.length*100)))}C("완료"),g(`성공: 총 ${$+J}건 (업데이트 ${$}, 신규 ${J})`)}catch(j){m(j.message||"업로드 중 오류가 발생했습니다")}finally{x(!1),setTimeout(()=>{y(0),C("")},1200)}},children:"업로드"}),v&&n.jsx("span",{className:"muted",children:v})]}),p&&n.jsxs("div",{style:{marginTop:10,width:"100%"},children:[n.jsx("div",{className:"progress",children:n.jsx("div",{className:"progress-bar",style:{width:`${b}%`}})}),n.jsxs("div",{className:"muted",style:{marginTop:6},children:[A," ",b>0?`${b}%`:""]})]})]})}function zj(e){if(!e||e.length===0)return[];const t=e[0].map(v=>String(v||"").trim()),r=e.slice(1);function a(v){return t.map((g,b)=>v.some(y=>ps(g,y))?b:-1).filter(g=>g>=0)}const i=t.findIndex(v=>["영업담당자","영업사원","sales_owner","sales_rep","sales_rep_name"].some(g=>ps(v,g))),s=t.findIndex(v=>["거래처","고객","customer"].some(g=>ps(v,g))),o=t.findIndex(v=>["중분류","품목중분류","종분류","category_mid","item_subcategory"].some(g=>ps(v,g))),l=a(["공급사(tnt)","공급사 tnt","tnt","공급사","공급자","supplier"]),d=a(["영업관리단위","관리단위","mgmt_unit","sales_mgmt_unit"]),f=a(["점유율(%)","점유율","share","share_rate"]),u=Math.max(l.length,d.length,f.length),h=[];let m=null,p=null,x=null;for(const v of r){let g=Ma(v,i).trim(),b=Ma(v,s).trim(),y=Ma(v,o).trim();if(g||(g=m||""),b||(b=p||""),y||(y=x||""),!g||!b||!y){g&&(m=g),b&&(p=b),y&&(x=y);continue}m=g,p=b,x=y;for(let A=0;A<u;A++){const C=Ma(v,l[A]).trim(),N=Ma(v,d[A]).trim(),w=Wj(Ma(v,f[A])),M=w!=null&&w!==0;if(!(C||N||M))continue;const O=M?w:null;h.push({salesRepName:g,customerName:b,itemSubcategory:y,supplierName:C,salesMgmtUnit:N,shareRate:O,priority:A+1})}}return h}function Ma(e,t){return t>=0?e[t]??"":""}function Wf(e){return String(e||"").replace(/[\s\-_%()\[\]{}]/g,"").replace(/tnt/gi,"").toLowerCase()}function ps(e,t){return Wf(e)===Wf(t)}function Wj(e){if(e==null)return null;const t=Number(String(e).replace(/[,\s%]/g,""));return Number.isFinite(t)?t:null}function Bj(e,t){const r=[];for(let a=0;a<e.length;a+=t)r.push(e.slice(a,a+t));return r}const Zp="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='20'%20height='20'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20aria-hidden='true'%3e%3cpath%20d='M20.59%2013.41%2011%203H4v7l9.59%209.59a2%202%200%200%200%202.82%200l4.18-4.18a2%202%200%200%200%200-2.82Z'/%3e%3ccircle%20cx='7.5'%20cy='7.5'%20r='1.5'/%3e%3c/svg%3e";function Fj(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function Bf(){const[e,t]=c.useState(""),[r,a]=c.useState(""),[i,s]=c.useState(""),[o,l]=c.useState(!1),[d,f]=c.useState(null),[u,h]=c.useState([]),[m,p]=c.useState(""),[x,v]=c.useState(!1),[g,b]=c.useState({open:!1,x:0,y:0}),[y,A]=c.useState(()=>new Set),[C,N]=c.useState({open:!1,x:0,y:0}),[w,M]=c.useState(void 0),[O,D]=c.useState("init"),[W,j]=c.useState({}),[S,R]=c.useState("TNT"),I=100,[$,J]=c.useState(0),[q,K]=c.useState(!0),[L,ee]=c.useState(!1),E=ke.useRef(null),[T,B]=c.useState(0),P=["init","sim","apply","confirm"],_=[{key:"init",label:"초기설정"},{key:"sim",label:"Simulation"},{key:"apply",label:"목표반영"},{key:"confirm",label:"확정"}],U=P.indexOf(O),fe=()=>{const G=Math.max(0,U-1);D(P[G])},ae=()=>{const G=Math.min(P.length-1,U+1);D(P[G])};function F(){const G=[];for(let le=2030;le>=2026;le--)G.push(le);return G}const[pe,H]=c.useState(""),[Q,ge]=c.useState(!1),[je,Ne]=c.useState(null),[Y,ve]=c.useState({tnt:0,dys:0}),[se,Le]=c.useState({tnt:0,dys:0}),[Fe,Ie]=c.useState({tnt:0,dys:0}),Ve=new Intl.NumberFormat("ko-KR");function yt(G,le){return Number.isFinite(G)?G:0}function It(G,le){const be=Number.isFinite(G)&&G>0,Pe=be?yt(G):0;return n.jsxs("div",{style:{textAlign:"right",lineHeight:1.15},children:[n.jsx("div",{children:be?G%1===0?Math.round(G).toLocaleString():G.toFixed(2):"-"}),n.jsx("div",{className:"muted",style:{fontSize:11},children:be?`${Ve.format(Math.round(Pe))} 원`:""})]})}async function nn(){ge(!0),Ne(null);try{const G=(localStorage.getItem("tnt.sales.empName")||"").trim();if(!G){ve({tnt:0,dys:0}),Ne("로그인이 필요합니다");return}if(!pe||isNaN(Number(pe))){ve({tnt:0,dys:0});return}const le=new URL("/api/v1/targets/assigned",window.location.origin);le.searchParams.set("year",String(pe)),le.searchParams.set("empNames",G);try{const Ee=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),We=Ee==="moderate"?"2":Ee==="best"?"1":"";We&&le.searchParams.set("versionNo",We)}catch{}const be=await fetch(le.toString());if(!be.ok)throw new Error(`HTTP ${be.status}`);const Pe=await be.json().catch(()=>[]),Re=Array.isArray(Pe)?Pe.find(Ee=>String(Ee.company_name||"").toUpperCase()==="TNT"):null,Ae=Array.isArray(Pe)?Pe.find(Ee=>String(Ee.company_name||"").toUpperCase()==="DYS"):null;ve({tnt:Math.round(Number((Re==null?void 0:Re.assigned_amount)||0)),dys:Math.round(Number((Ae==null?void 0:Ae.assigned_amount)||0)),tntStage:String((Re==null?void 0:Re.target_stage)||"").trim()||void 0,dysStage:String((Ae==null?void 0:Ae.target_stage)||"").trim()||void 0})}catch(G){Ne((G==null?void 0:G.message)||"조회 오류"),ve({tnt:0,dys:0})}finally{ge(!1)}}const[He,lt]=c.useState(0);c.useEffect(()=>{const G=()=>lt(le=>le+1);return window.addEventListener("tnt.sales.assign.mode.changed",G),()=>window.removeEventListener("tnt.sales.assign.mode.changed",G)},[]),c.useEffect(()=>{nn()},[pe,He]);const[ht,rn]=c.useState(!1),[ct,Tt]=c.useState(null);new Date().getFullYear();const[rt,_n]=c.useState("prev1"),[Lt,ea]=c.useState(()=>new Array(12).fill(0)),[ta,vn]=c.useState({loading:!1});async function hn(){if(!(w!=null&&w.customerSeq)){ea(new Array(12).fill(0));return}rn(!0),Tt(null);try{const G=new Date().getFullYear(),le=rt==="prev1"?[G-1]:rt==="last2"?[G-1,G-2]:[G-1,G-2,G-3],be=[];await Promise.all(le.map(async Ee=>{try{const We=await fetch(`/api/v1/customers/${w.customerSeq}/invoice-monthly-by-dim?year=${Ee}`);if(!We.ok)return;const dt=await We.json().catch(()=>[]),qt=Ge=>{const vt=String(Ge??"").trim();return vt.toLowerCase()==="na"?"":vt},on=(Array.isArray(dt)?dt:[]).map(Ge=>({itemSubcategorySeq:Number(Ge.itemSubcategorySeq??Ge.item_subcategory_seq??0),salesMgmtUnitSeq:Number(Ge.salesMgmtUnitSeq??Ge.sales_mgmt_unit_seq??0),itemSubcategory:qt(Ge.itemSubcategory??Ge.item_subcategory),salesMgmtUnit:qt(Ge.salesMgmtUnit??Ge.sales_mgmt_unit),month:Number(Ge.month??0),amount:Number(Ge.amount??0)}));be.push(...on)}catch{}}));const Pe=new Map,Re=(Ee,We)=>`${(Ee||"").trim().toLowerCase()}||${(We||"").trim().toLowerCase()}`;for(const Ee of be){const We=Re(Ee.itemSubcategory,Ee.salesMgmtUnit);let dt=Pe.get(We);dt||(dt={sub:Ee.itemSubcategory||"",unit:Ee.salesMgmtUnit||"",months:new Array(12).fill(0)},Pe.set(We,dt));const qt=Math.min(12,Math.max(1,Number(Ee.month)||0))-1;dt.months[qt]+=Number.isFinite(Ee.amount)?Number(Ee.amount):0}const Ae=Array.from(Pe.values()).sort((Ee,We)=>(Ee.sub||"").localeCompare(We.sub||"")||(Ee.unit||"").localeCompare(We.unit||""));Ia(Ae)}catch(G){Tt(G.message||"조회 중 오류가 발생했습니다"),Ia([])}finally{rn(!1)}}c.useEffect(()=>{O==="init"&&hn()},[O,w==null?void 0:w.customerSeq,rt]);async function an(){if(!(w!=null&&w.customerSeq)){vn({loading:!1,hasRecent:void 0,error:null});return}vn({loading:!0,hasRecent:void 0,error:null});try{const G=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);G.searchParams.set("custSeq",String(w.customerSeq)),G.searchParams.set("years","2");const le=await fetch(G.toString());if(!le.ok){let Re=`HTTP ${le.status}`;try{const Ae=await le.json();Ae!=null&&Ae.error&&(Re=Ae.error)}catch{}throw new Error(Re)}const be=await le.json(),Pe=Array.isArray(be)&&be.some(Re=>Number((Re==null?void 0:Re.customerSeq)||(Re==null?void 0:Re.customerSeqText)||0)===Number(w.customerSeq)&&!!(Re!=null&&Re.hasRecent));vn({loading:!1,hasRecent:Pe,error:null})}catch(G){vn({loading:!1,hasRecent:void 0,error:G.message||"오류"})}}c.useEffect(()=>{O==="init"&&an()},[O,w==null?void 0:w.customerSeq]);const[Hn,Ia]=c.useState([]),Ta=c.useMemo(()=>n.jsx("div",{className:"table-container",style:{border:"1px solid var(--border)",borderRadius:8,marginTop:8},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:220,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:120,textAlign:"center"},children:"목표입력"}),Array.from({length:12},(G,le)=>n.jsxs("th",{style:{width:90,textAlign:"right"},children:[String(le+1).padStart(2,"0"),"월"]},le))]})}),n.jsx("tbody",{children:Hn.length===0?n.jsx("tr",{children:n.jsx("td",{className:"muted",colSpan:15,style:{padding:"12px 10px"},children:ht?"불러오는 중…":"데이터가 없습니다"})}):Hn.map((G,le)=>n.jsxs("tr",{children:[n.jsx("td",{children:G.sub}),n.jsx("td",{children:G.unit}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>li(G.sub,G.unit),children:"목표입력"})}),G.months.map((be,Pe)=>n.jsx("td",{style:{textAlign:"right"},children:Math.round(be).toLocaleString()},Pe))]},le))})]})}),[Hn,ht]),[kt,Zn]=c.useState({open:!1,dist:new Array(12).fill(0)});function li(G,le){Zn({open:!0,sub:G,unit:le,month:"",qty:"",dist:new Array(12).fill(0)})}function er(){Zn({open:!1,dist:new Array(12).fill(0)})}function tr(G,le){const be=Number(G),Pe=Number(le),Re=new Array(12).fill(0);if(Number.isFinite(be)&&be>=1&&be<=12&&Number.isFinite(Pe)&&Pe>0){const Ae=12-be+1,Ee=Pe/Ae;for(let We=be-1;We<12;We++)Re[We]=Ee}Zn(Ae=>({...Ae,month:G,qty:le,dist:Re}))}const[xn,Kn]=c.useState({open:!1,rows:[]});function Qe(){const G=(Hn||[]).map((le,be)=>({key:`${le.sub}||${le.unit}||${be}`,sub:le.sub,unit:le.unit,month:"",qty:"",dist:new Array(12).fill(0)}));Kn({open:!0,rows:G})}function Mn(){Kn({open:!1,rows:[]})}function na(G,le,be){Kn(Pe=>{const Re=Pe.rows.slice(),Ae={...Re[G]},Ee=Number(le??Ae.month),We=Number(be??Ae.qty),dt=new Array(12).fill(0);if(Number.isFinite(Ee)&&Ee>=1&&Ee<=12&&Number.isFinite(We)&&We>0){const qt=12-Ee+1,on=We/qt;for(let Ge=Ee-1;Ge<12;Ge++)dt[Ge]=on}return Ae.month=le??Ae.month,Ae.qty=be??Ae.qty,Ae.dist=dt,Re[G]=Ae,{...Pe,rows:Re}})}function ur(G){try{const le=G.getBoundingClientRect(),be=(le==null?void 0:le.width)||G.offsetWidth||600,Pe=(le==null?void 0:le.height)||G.offsetHeight||400,Re=Math.max(0,Math.round((window.innerWidth-be)/2)),Ee=Math.max(0,Math.round(window.innerHeight-Pe-40));return{x:Re,y:Ee}}catch{const le=Math.max(0,Math.round((window.innerWidth-600)/2)),Pe=Math.max(0,Math.round(window.innerHeight-400-40));return{x:le,y:Pe}}}function ci(G){try{const le=G.getBoundingClientRect(),be=(le==null?void 0:le.width)||G.offsetWidth||460,Pe=Math.max(0,Math.round(window.innerWidth-be)),Re=Math.max(0,Math.round(window.innerHeight*.17));return{x:Pe,y:Re}}catch{const be=Math.max(0,Math.round(window.innerWidth-460)),Pe=Math.max(0,Math.round(window.innerHeight*.17));return{x:be,y:Pe}}}const fr=jn("sales-plan-target-input",!!kt.open,ur,{persist:!1,resetOnOpen:!0}),ra=jn("sales-plan-bulk-input",!!xn.open,ur,{persist:!1,resetOnOpen:!0}),[nr,aa]=c.useState({open:!1,rows:[]}),[at,Mt]=c.useState("");function re(){const G=(Hn||[]).map((le,be)=>({key:`${le.sub}||${le.unit}||${be}`,sub:le.sub,unit:le.unit,month:"",qty:"",dist:new Array(12).fill(0)}));aa({open:!0,rows:G})}function xe(){aa({open:!1,rows:[]})}function ye(G,le,be){aa(Pe=>{const Re=Pe.rows.slice(),Ae={...Re[G]},Ee=Number(le??Ae.month),We=Number(be??Ae.qty),dt=new Array(12).fill(0);if(Number.isFinite(Ee)&&Ee>=1&&Ee<=12&&Number.isFinite(We)&&We>0){const qt=12-Ee+1,on=We/qt;for(let Ge=Ee-1;Ge<12;Ge++)dt[Ge]=on}return Ae.month=le??Ae.month,Ae.qty=be??Ae.qty,Ae.dist=dt,Re[G]=Ae,{...Pe,rows:Re}})}const De=jn("sales-plan-bulk-ratio",!!nr.open,ur,{persist:!1,resetOnOpen:!0}),[ce,Oe]=c.useState({open:!1,loading:!1,error:null,opts:[],dist:new Array(12).fill(0),rows:[]}),Se=jn("sales-plan-new-item",!!ce.open,ur,{persist:!1,resetOnOpen:!0});async function Be(){Oe(G=>({...G,open:!0,loading:!0,error:null,unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0),rows:[]}));try{const G=await fetch("/api/v1/items/dim"),le=G.ok?await G.json():[],be=Array.isArray(le)?le.map(Ae=>({itemSubcategory:String(Ae.itemSubcategory||Ae.item_subcategory||""),salesMgmtUnit:String(Ae.salesMgmtUnit||Ae.sales_mgmt_unit||"")})):[],Pe={};be.forEach(Ae=>{const Ee=Ae.salesMgmtUnit.trim();Ee&&!Pe[Ee]&&(Pe[Ee]=Ae)});const Re=Object.values(Pe).sort((Ae,Ee)=>Ae.salesMgmtUnit.localeCompare(Ee.salesMgmtUnit));Oe(Ae=>({...Ae,loading:!1,opts:Re}))}catch(G){Oe(le=>({...le,loading:!1,error:(G==null?void 0:G.message)||"조회 오류",opts:[]}))}}function qe(){Oe({open:!1,loading:!1,error:null,opts:[],dist:new Array(12).fill(0),rows:[]})}function Ye(G){const le=ce.opts.find(be=>be.salesMgmtUnit===G);Oe(be=>({...be,unit:G,sub:(le==null?void 0:le.itemSubcategory)||be.sub}))}function Ue(G,le){const be=Number(G??ce.month),Pe=Number(le??ce.qty),Re=new Array(12).fill(0);if(Number.isFinite(be)&&be>=1&&be<=12&&Number.isFinite(Pe)&&Pe>0){const Ae=12-be+1,Ee=Pe/Ae;for(let We=be-1;We<12;We++)Re[We]=Ee}Oe(Ae=>({...Ae,month:G??Ae.month,qty:le??Ae.qty,dist:Re}))}function At(){const G=(ce.unit||"").trim(),le=(ce.sub||"").trim(),be=ce.month,Pe=ce.qty;if(!G||!be||!Pe){alert("영업관리단위, 매출월, 매출 수량을 입력하세요.");return}const Re={sub:le||"(신규)",unit:G,months:ce.dist.slice()};Oe(Ae=>({...Ae,rows:[...Ae.rows,Re],unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0)}))}c.useEffect(()=>{if(!kt.open&&!xn.open&&!ce.open)return;const G=le=>{le.key==="Escape"&&(kt.open&&er(),xn.open&&Mn(),ce.open&&qe())};return window.addEventListener("keydown",G,!0),()=>window.removeEventListener("keydown",G,!0)},[kt.open,xn.open,ce.open]);async function it(G=!0){f(null),G?(l(!0),J(0),K(!0)):ee(!0);try{const le=localStorage.getItem("tnt.sales.assigneeId");if(!le){h([]),f(ot.loginRequired);return}const be=new URL("/api/v1/customers",window.location.origin);be.searchParams.set("mineOnly","true"),be.searchParams.set("assigneeId",le),be.searchParams.set("companyType",S),m.trim()&&be.searchParams.set("name",m.trim()),be.searchParams.set("limit",String(I)),be.searchParams.set("offset",String(G?0:$));const Pe=await fetch(be.toString());if(!Pe.ok){let Ee=`HTTP ${Pe.status}`;try{const We=await Pe.json();We!=null&&We.error&&(Ee=We.error)}catch{const We=await Pe.text();We&&(Ee=We)}throw new Error(Ee)}const Re=await Pe.json(),Ae=Array.isArray(Re)?Re:[];h(G?Ae:Ee=>[...Ee,...Ae]),K(Ae.length>=I),J(Ee=>G?I:Ee+I);try{if(le){const Ee=new URL("/api/v1/customers/count",window.location.origin);Ee.searchParams.set("mineOnly","true"),Ee.searchParams.set("assigneeId",le);const We=await fetch(Ee.toString());if(We.ok){const dt=await We.json().catch(()=>({})),qt=Number((dt==null?void 0:dt.total)??0);B(Number.isFinite(qt)?qt:0)}else B(0)}else B(0)}catch{B(0)}try{const Ee=Ae.map(We=>Number(We.customerSeq||0)).filter(We=>Number.isFinite(We)&&We>0);if(Ee.length>0){const We=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);We.searchParams.set("custSeq",Array.from(new Set(Ee)).join(",")),We.searchParams.set("years","2");const dt=await fetch(We.toString());if(dt.ok){const qt=await dt.json(),on={};Array.isArray(qt)&&qt.forEach(Ge=>{const vt=Number((Ge==null?void 0:Ge.customerSeq)||(Ge==null?void 0:Ge.customerSeqText)||0);Number.isFinite(vt)&&(on[vt]=!!(Ge!=null&&Ge.hasRecent))}),j(Ge=>G?on:{...Ge,...on})}else G&&j({})}else G&&j({})}catch{j({})}}catch(le){f(le.message||"조회 중 오류가 발생했습니다")}finally{G?l(!1):ee(!1)}}c.useEffect(()=>{it(!0)},[]),c.useEffect(()=>{it(!0)},[S]),c.useEffect(()=>{if(!g.open)return;const G=()=>b({open:!1,x:0,y:0});return window.addEventListener("click",G),()=>window.removeEventListener("click",G)},[g.open]),c.useEffect(()=>{if(!g.open)return;const G=le=>{le.key==="Escape"&&b({open:!1,x:0,y:0})};return window.addEventListener("keydown",G),()=>window.removeEventListener("keydown",G)},[g.open]),c.useEffect(()=>{const G=le=>{((le==null?void 0:le.key)==="Escape"||(le==null?void 0:le.key)==="Esc"||(le==null?void 0:le.keyCode)===27)&&(b({open:!1,x:0,y:0}),N({open:!1,x:0,y:0}))};return document.addEventListener("keydown",G,!0),()=>document.removeEventListener("keydown",G,!0)},[]);async function tt(G,le){G.preventDefault(),G.stopPropagation(),b({open:!1,x:0,y:0});const be=G.clientX,Pe=G.clientY;N({open:!0,x:be,y:Pe,row:le,loading:!1,error:null,data:[]})}const hr=c.useMemo(()=>{var le,be,Pe,Re,Ae,Ee,We,dt,qt,on,Ge,vt,ia,di,us;const G=[...u].sort((mn,Rr)=>{const rr=Number(mn.customerSeq||0),ui=Number(Rr.customerSeq||0),Rl=!!W[rr],Xe=!!W[ui];if(Rl!==Xe)return Xe?1:-1;const kn=(mn.customerName||"").toString(),fi=(Rr.customerName||"").toString();return kn.localeCompare(fi,"ko",{sensitivity:"base"})});return n.jsxs(n.Fragment,{children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:8},children:[n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,cursor:"pointer"},children:[n.jsx("input",{type:"radio",name:"companyType",checked:S==="TNT",onChange:()=>R("TNT")}),n.jsx("span",{children:"TNT"})]}),n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,cursor:"pointer"},children:[n.jsx("input",{type:"radio",name:"companyType",checked:S==="DYS",onChange:()=>R("DYS")}),n.jsx("span",{children:"DYS"})]})]}),n.jsxs("div",{ref:E,className:"table-container",onClick:()=>b({open:!1,x:0,y:0}),style:{height:"100%",overflow:"auto"},children:[G.length===0?n.jsx("div",{className:"empty-state",children:ot.empty}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsx("tr",{children:n.jsx("th",{style:{width:"auto"},children:"거래처명"})})}),n.jsx("tbody",{children:G.map((mn,Rr)=>n.jsx("tr",{onClick:rr=>{rr.preventDefault(),rr.stopPropagation(),M(mn),N({open:!1,x:0,y:0})},onContextMenu:rr=>tt(rr,mn),"aria-selected":(w==null?void 0:w.customerId)===mn.customerId?!0:void 0,style:(w==null?void 0:w.customerId)===mn.customerId?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:n.jsx("td",{children:(()=>{const rr=Number(mn.customerSeq||0);return W[rr]?n.jsxs("span",{children:[mn.customerName," "," ","$"]}):mn.customerName})()})},Rr))})]}),L&&n.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:ot.loading}),!o&&!L&&!q&&u.length>0&&n.jsx("div",{className:"muted",style:{padding:"8px 10px",textAlign:"center"},children:"마지막 데이터입니다."}),C.open&&n.jsxs("div",{className:"context-menu",style:{left:C.x+6,top:C.y+6,maxWidth:420,padding:8},onClick:mn=>mn.stopPropagation(),children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 상세"}),C.error?n.jsx("div",{className:"error",style:{maxWidth:380},children:C.error}):n.jsx("table",{className:"table",style:{width:"100%"},children:n.jsxs("tbody",{children:[n.jsxs("tr",{children:[n.jsx("th",{style:{width:110,textAlign:"left"},children:"거래처번호"}),n.jsx("td",{children:((le=C.row)==null?void 0:le.customerId)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"사업자번호"}),n.jsx("td",{children:((be=C.row)==null?void 0:be.bizNo)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"대표자명"}),n.jsx("td",{children:((Pe=C.row)==null?void 0:Pe.ownerName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"업태"}),n.jsx("td",{children:((Re=C.row)==null?void 0:Re.bizKind)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"종목"}),n.jsx("td",{children:((Ae=C.row)==null?void 0:Ae.bizType)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"전화번호"}),n.jsx("td",{children:((Ee=C.row)==null?void 0:Ee.telNo)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"담당자명"}),n.jsx("td",{children:((We=C.row)==null?void 0:We.empName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"부서명"}),n.jsx("td",{children:((dt=C.row)==null?void 0:dt.deptName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"시/도"}),n.jsx("td",{children:((qt=C.row)==null?void 0:qt.addrProvinceName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"시/군/구"}),n.jsx("td",{children:((on=C.row)==null?void 0:on.addrCityName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"고객유형"}),n.jsx("td",{children:((Ge=C.row)==null?void 0:Ge.customerTypeName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"비고"}),n.jsx("td",{children:((vt=C.row)==null?void 0:vt.customerRemark)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"생성자"}),n.jsx("td",{children:((ia=C.row)==null?void 0:ia.createdBy)??""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"수정자"}),n.jsx("td",{children:((di=C.row)==null?void 0:di.updatedBy)??""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"생성일시"}),n.jsx("td",{children:Fj((us=C.row)==null?void 0:us.createdAt)})]})]})})]})]})]})},[u,g,y,C,w,W,o,L,q]);c.useEffect(()=>{const G=E.current;if(!G)return;function le(){G.scrollTop+G.clientHeight>=G.scrollHeight-48&&q&&!L&&!o&&it(!1)}return G.addEventListener("scroll",le),()=>G.removeEventListener("scroll",le)},[q,L,o,$]);const[Xt,$r]=c.useState({open:!1,loading:!1,error:null,rows:[]}),Lr=jn("unit-amounts-by-emp",Xt.open,ci,{persist:!1,resetOnOpen:!0});function cs(){$r({open:!0,loading:!0,error:null,rows:[]});const G=(localStorage.getItem("tnt.sales.empName")||"").trim();if(!G){$r({open:!0,loading:!1,error:"로그인이 필요합니다",rows:[]});return}const le=new URL("/api/v1/dashboard/unit-amounts-by-emp",window.location.origin);le.searchParams.set("empName",G),fetch(le.toString()).then(async be=>{if(!be.ok){let Ae=`HTTP ${be.status}`;try{const Ee=await be.json();Ee!=null&&Ee.error&&(Ae=Ee.error)}catch{const Ee=await be.text();Ee&&(Ae=Ee)}throw new Error(Ae)}const Pe=await be.json(),Re=(Array.isArray(Pe)?Pe:[]).map(Ae=>({unit:String((Ae==null?void 0:Ae.sales_mgmt_unit)??(Ae==null?void 0:Ae.salesMgmtUnit)??""),amount:Number((Ae==null?void 0:Ae.amount)??0)}));$r({open:!0,loading:!1,error:null,rows:Re})}).catch(be=>$r({open:!0,loading:!1,error:(be==null?void 0:be.message)||"조회 오류",rows:[]}))}function ds(){$r(G=>({...G,open:!1}))}return c.useEffect(()=>{if(!Xt.open)return;const G=le=>{le.key==="Escape"&&ds()};return window.addEventListener("keydown",G,!0),()=>window.removeEventListener("keydown",G,!0)},[Xt.open]),c.useEffect(()=>{if(!kt.open)return;const G=le=>{le.key==="Escape"&&er()};return window.addEventListener("keydown",G,!0),()=>window.removeEventListener("keydown",G,!0)},[kt.open]),c.useEffect(()=>{if(!xn.open)return;const G=le=>{le.key==="Escape"&&Mn()};return window.addEventListener("keydown",G,!0),()=>window.removeEventListener("keydown",G,!0)},[xn.open]),c.useEffect(()=>{if(!nr.open)return;const G=le=>{le.key==="Escape"&&xe()};return window.addEventListener("keydown",G,!0),()=>window.removeEventListener("keydown",G,!0)},[nr.open]),c.useEffect(()=>{if(!ce.open)return;const G=le=>{le.key==="Escape"&&qe()};return window.addEventListener("keydown",G,!0),()=>window.removeEventListener("keydown",G,!0)},[ce.open]),n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsxs("h2",{style:{margin:0,fontSize:18,display:"flex",alignItems:"center",gap:8,flexWrap:"wrap"},children:["목표 Simulation",n.jsxs("select",{className:"search-input",value:pe,onChange:G=>H(G.target.value),"aria-label":"목표년도",children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),F().map(G=>n.jsxs("option",{value:String(G),children:[G,"년"]},G))]}),n.jsxs("span",{className:"badge",title:"내 목표 배정(TNT)",children:["TNT(배정): ",Ve.format(Y.tnt)," 억"]}),n.jsxs("span",{className:"badge",title:"내 목표 배정(DYS)",children:["DYS(배정): ",Ve.format(Y.dys)," 억"]}),n.jsx("span",{"aria-hidden":"true",style:{opacity:.4},children:"|"}),n.jsxs("span",{className:"badge",title:"내 목표 계획(TNT)",children:["TNT(계획): ",Ve.format(se.tnt)," 억"]}),n.jsxs("span",{className:"badge",title:"내 목표 계획(DYS)",children:["DYS(계획): ",Ve.format(se.dys)," 억"]}),n.jsx("span",{"aria-hidden":"true",style:{opacity:.4},children:"|"}),n.jsxs("span",{className:"badge",title:"내 목표 차액(TNT)",children:["TNT(차액): ",Ve.format(Fe.tnt)," 억"]}),n.jsxs("span",{className:"badge",title:"내 목표 차액(DYS)",children:["DYS(차액): ",Ve.format(Fe.dys)," 억"]})]}),n.jsxs("div",{className:"muted count-text",style:{display:"flex",alignItems:"center",gap:12},children:[n.jsx("button",{className:"btn-plain",title:"내 평균거래 단가",onClick:cs,"aria-label":"평균거래 단가 팝업 열기",children:n.jsx("img",{src:Zp,className:"icon",alt:"단가"})}),T.toLocaleString(),"개 거래처"]})]}),d&&n.jsx("div",{className:"error",children:d||ot.errorGeneric}),n.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[n.jsxs("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:[n.jsx("div",{className:"card",style:{padding:8,marginBottom:8},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{className:"search-input",placeholder:"거래처명",value:m,onChange:G=>p(G.target.value),onKeyDown:G=>{G.key==="Enter"&&it(!0)},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:()=>it(!0),disabled:o,style:{flex:"0 0 auto"},children:"조회"})]})}),hr]}),n.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[n.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:_.map((G,le)=>{const be=le<U,Pe=le===U;return n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:le===_.length-1?"0 0 auto":"1 1 0"},children:[n.jsx("div",{title:G.label,onClick:()=>D(G.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:be||Pe?"var(--accent)":"transparent",border:`2px solid ${be||Pe?"var(--accent)":"var(--border)"}`,color:be||Pe?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":Pe?"step":void 0,children:be?"✓":le+1}),n.jsx("div",{style:{fontSize:12,color:Pe||be?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:G.label}),le<_.length-1&&n.jsx("div",{style:{height:2,background:le<U?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},G.key)})}),n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[n.jsx("button",{className:"btn btn-icon",onClick:fe,disabled:U===0,"aria-label":"이전 단계",title:"이전 단계",children:n.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:n.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),n.jsx("button",{className:"btn btn-icon",onClick:ae,disabled:U===_.length-1,"aria-label":"다음 단계",title:"다음 단계",children:n.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:n.jsx("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),O==="init"&&n.jsxs("section",{style:{marginTop:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:10},children:[n.jsx("b",{children:"기준매출"}),n.jsxs("select",{value:rt,onChange:G=>_n(G.target.value),style:{height:28,padding:"4px 8px",borderRadius:8,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12},"aria-label":"기준 기간 선택",children:[n.jsx("option",{value:"prev1",children:"전년"}),n.jsx("option",{value:"last2",children:"최근2년"}),n.jsx("option",{value:"last3",children:"최근3년"})]})]}),n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[ct&&n.jsx("span",{className:"error",children:ct}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:re,children:"일괄비율"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:Qe,children:"일괄입력"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:Be,children:"신규품목"})]})]}),Ta]})]})]}),kt.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:fr.ref,className:"card",style:{...fr.style,width:720,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[n.jsx("div",{...fr.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:er,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 120px 1fr",gap:8,alignItems:"center"},children:[n.jsx("div",{className:"muted",children:"중분류"}),n.jsx("div",{children:kt.sub||""}),n.jsx("div",{className:"muted",children:"영업관리단위"}),n.jsx("div",{children:kt.unit||""}),n.jsx("div",{className:"muted",children:"매출월"}),n.jsx("div",{children:n.jsxs("select",{className:"search-input",value:kt.month||"",onChange:G=>tr(G.target.value,kt.qty),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(G,le)=>le+1).map(G=>n.jsxs("option",{value:String(G),children:[G,"월"]},G))]})}),n.jsx("div",{className:"muted",children:"매출 수량"}),n.jsx("div",{children:n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:kt.qty||"",onChange:G=>tr(kt.month,G.target.value)})})]}),n.jsx("div",{style:{marginTop:12},children:n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsx("tr",{children:Array.from({length:12},(G,le)=>le+1).map(G=>n.jsxs("th",{style:{textAlign:"right"},children:[String(G).padStart(2,"0"),"월"]},G))})}),n.jsx("tbody",{children:n.jsx("tr",{children:kt.dist.map((G,le)=>n.jsx("td",{children:It(G)},le))})})]})})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(단건) — 추후 구현 예정"),children:"목표등록"})})]})}),xn.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:ra.ref,className:"card",style:{...ra.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[n.jsx("div",{...ra.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:Mn,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h2",{style:{margin:0},children:"목표 일괄입력"})}),n.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:120,textAlign:"left"},children:"매출월"}),n.jsx("th",{style:{width:120,textAlign:"left"},children:"매출 수량"}),Array.from({length:12},(G,le)=>le+1).map(G=>n.jsxs("th",{style:{textAlign:"right"},children:[String(G).padStart(2,"0"),"월"]},G))]})}),n.jsx("tbody",{children:xn.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:16,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):xn.rows.map((G,le)=>n.jsxs("tr",{children:[n.jsx("td",{children:G.sub}),n.jsx("td",{children:G.unit}),n.jsx("td",{children:n.jsxs("select",{className:"search-input",value:G.month||"",onChange:be=>na(le,be.target.value,void 0),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(be,Pe)=>Pe+1).map(be=>n.jsxs("option",{value:String(be),children:[be,"월"]},be))]})}),n.jsx("td",{children:n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:G.qty||"",onChange:be=>na(le,void 0,be.target.value)})}),G.dist.map((be,Pe)=>n.jsx("td",{children:It(be)},Pe))]},G.key))})]})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(일괄) — 추후 구현 예정"),children:"목표등록"})})]})}),nr.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:De.ref,className:"card",style:{...De.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[n.jsx("div",{...De.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:xe,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{className:"page-title",style:{marginBottom:8,alignItems:"center"},children:[n.jsx("h2",{style:{margin:0},children:"목표 일괄비율"}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsx("span",{className:"muted",children:"적용 비율(%)"}),n.jsx("input",{className:"assign-input",type:"number",min:0,max:100,step:1,placeholder:"0",value:at,onChange:G=>Mt(G.target.value),style:{width:100},"aria-label":"일괄 비율 입력"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("일괄비율 적용 — 추후 개발 예정"),children:"적용"})]})]}),n.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:120,textAlign:"left"},children:"매출월"}),n.jsx("th",{style:{width:120,textAlign:"left"},children:"매출 수량"}),Array.from({length:12},(G,le)=>le+1).map(G=>n.jsxs("th",{style:{textAlign:"right"},children:[String(G).padStart(2,"0"),"월"]},G))]})}),n.jsx("tbody",{children:nr.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:16,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):nr.rows.map((G,le)=>n.jsxs("tr",{children:[n.jsx("td",{children:G.sub}),n.jsx("td",{children:G.unit}),n.jsx("td",{children:n.jsxs("select",{className:"search-input",value:G.month||"",onChange:be=>ye(le,be.target.value,void 0),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(be,Pe)=>Pe+1).map(be=>n.jsxs("option",{value:String(be),children:[be,"월"]},be))]})}),n.jsx("td",{children:n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:G.qty||"",onChange:be=>ye(le,void 0,be.target.value)})}),G.dist.map((be,Pe)=>n.jsx("td",{children:It(be)},Pe))]},G.key))})]})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(일괄비율) — 추후 구현 예정"),children:"목표등록"})})]})}),ce.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:Se.ref,className:"card",style:{...Se.style,width:820,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[n.jsx("div",{...Se.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:qe,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h2",{style:{margin:0},children:"신규품목"})}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 120px 1fr",gap:8,alignItems:"center"},children:[n.jsx("div",{className:"muted",children:"영업관리단위"}),n.jsx("div",{children:n.jsxs("select",{className:"search-input",value:ce.unit||"",onChange:G=>Ye(G.target.value),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),ce.opts.map((G,le)=>n.jsx("option",{value:G.salesMgmtUnit,children:G.salesMgmtUnit},le))]})}),n.jsx("div",{className:"muted",children:"중분류"}),n.jsx("div",{children:n.jsx("input",{className:"assign-input",value:ce.sub||"",readOnly:!0,placeholder:"자동"})}),n.jsx("div",{className:"muted",children:"매출월"}),n.jsx("div",{children:n.jsxs("select",{className:"search-input",value:ce.month||"",onChange:G=>Ue(G.target.value,void 0),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(G,le)=>le+1).map(G=>n.jsxs("option",{value:String(G),children:[G,"월"]},G))]})}),n.jsx("div",{className:"muted",children:"매출 수량"}),n.jsx("div",{children:n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:ce.qty||"",onChange:G=>Ue(void 0,G.target.value)})})]}),n.jsx("div",{style:{marginTop:12},children:n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsx("tr",{children:Array.from({length:12},(G,le)=>le+1).map(G=>n.jsxs("th",{style:{textAlign:"right"},children:[String(G).padStart(2,"0"),"월"]},G))})}),n.jsx("tbody",{children:n.jsx("tr",{children:ce.dist.map((G,le)=>n.jsx("td",{children:It(G)},le))})})]})})}),n.jsxs("div",{style:{marginTop:12},children:[n.jsx("div",{className:"pane-header",style:{margin:0},children:"추가된 항목"}),n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),Array.from({length:12},(G,le)=>le+1).map(G=>n.jsxs("th",{style:{textAlign:"right"},children:[String(G).padStart(2,"0"),"월"]},G))]})}),n.jsx("tbody",{children:ce.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:14,className:"muted",style:{padding:"12px 10px"},children:"추가된 항목이 없습니다"})}):ce.rows.map((G,le)=>n.jsxs("tr",{children:[n.jsx("td",{children:G.sub}),n.jsx("td",{children:G.unit}),G.months.map((be,Pe)=>n.jsx("td",{children:It(be)},Pe))]},le))})]})})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:[n.jsx("button",{className:"btn btn-card btn-3d",onClick:At,children:"추가"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>alert("목표등록(신규품목) — 추후 구현 예정"),children:"목표등록"})]})]})}),Xt.open&&n.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:60},children:n.jsxs("div",{ref:Lr.ref,className:"card",style:{...Lr.style,height:"66vh",width:460,maxWidth:"92vw",background:"var(--panel)",padding:12,borderLeft:"1px solid var(--border)",boxShadow:"-8px 0 24px rgba(0,0,0,0.18)",overflow:"auto"},children:[n.jsx("div",{...Lr.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:ds,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h2",{style:{margin:0},children:"내 평균거래 단가"})}),Xt.error?n.jsx("div",{className:"error",style:{maxWidth:420},children:Xt.error}):n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:280,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:180,textAlign:"right"},children:"합계(원)"})]})}),n.jsx("tbody",{children:Xt.loading?n.jsx("tr",{children:n.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"불러오는 중…"})}):Xt.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):Xt.rows.map((G,le)=>n.jsxs("tr",{children:[n.jsx("td",{children:G.unit||"na"}),n.jsxs("td",{style:{textAlign:"right"},children:[Ve.format(Math.round(G.amount))," 원"]})]},le))})]})})]})})]})}function qj(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function Uj(){const[e,t]=c.useState(""),[r,a]=c.useState(""),[i,s]=c.useState(""),[o,l]=c.useState(!1),[d,f]=c.useState(null),[u,h]=c.useState([]),[m,p]=c.useState(""),[x,v]=c.useState(!1),[g,b]=c.useState({open:!1,x:0,y:0}),[y,A]=c.useState(()=>new Set),[C,N]=c.useState({open:!1,x:0,y:0}),[w,M]=c.useState(void 0),[O,D]=c.useState("init"),[W,j]=c.useState({}),[S,R]=c.useState("TNT"),[I,$]=c.useState({}),J=100,[q,K]=c.useState(0),[L,ee]=c.useState(!0),[E,T]=c.useState(!1),B=ke.useRef(null),[P,_]=c.useState(0),[U,fe]=c.useState({show:!1,name:"",tnt:0,dys:0,year:0}),[ae,F]=c.useState(!1),[pe,H]=c.useState({tnt:0,dys:0}),Q=["init","sim","confirm"],ge=[{key:"init",label:"초기설정"},{key:"sim",label:"계획 수립 중"},{key:"confirm",label:"확정"}],je=Q.indexOf(O);function Ne(){const k=[];for(let z=2030;z>=2026;z--)k.push(z);return k}const[Y,ve]=c.useState(""),[se,Le]=c.useState(!1),[Fe,Ie]=c.useState(null),[Ve,yt]=c.useState({tnt:0,dys:0}),[It,nn]=c.useState({tnt:0,dys:0}),[He,lt]=c.useState({tnt:0,dys:0}),[ht,rn]=c.useState({tnt:0,dys:0}),[ct,Tt]=c.useState({open:!1,company:"TNT",group:"customer",loading:!1,error:null,rows:[]}),[rt,_n]=c.useState({x:0,y:0}),Lt=new Intl.NumberFormat("ko-KR"),ea=new Intl.NumberFormat("ko-KR",{minimumFractionDigits:2,maximumFractionDigits:2}),[ta,vn]=c.useState(null),[hn,an]=c.useState({val:"",loading:!1,saving:!1,error:null,success:null});async function Hn(){try{const k=Number(Y),z=Number((w==null?void 0:w.customerSeq)||0),X=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!X||!Number.isFinite(k)||k<=0||!z){an(ie=>({...ie,val:"",loading:!1,error:null}));return}an(ie=>({...ie,loading:!0,error:null}));const te=new URL("/api/v1/sales/plan/plan-remark",window.location.origin);te.searchParams.set("year",String(k)),te.searchParams.set("customerSeq",String(z));const Z=await fetch(te.toString(),{headers:{"X-ASSIGNEE-ID":X}});if(!Z.ok)throw new Error(`HTTP ${Z.status}`);const V=await Z.json().catch(()=>({})),oe=String((V==null?void 0:V.remark)??"");an({val:oe,loading:!1,saving:!1,error:null,success:null})}catch(k){an(z=>({...z,loading:!1,error:(k==null?void 0:k.message)||"조회 오류"}))}}async function Ia(){try{const k=Number(Y),z=Number((w==null?void 0:w.customerSeq)||0),X=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!X){alert("로그인이 필요합니다.");return}if(!Number.isFinite(k)||k<=0){alert("연도를 선택하세요.");return}if(!z){alert("거래처를 선택하세요.");return}an(oe=>({...oe,saving:!0,error:null,success:null}));const te={"Content-Type":"application/json","X-ASSIGNEE-ID":X},Z=JSON.stringify({year:k,customerSeq:z,remark:hn.val}),V=await fetch("/api/v1/sales/plan/plan-remark",{method:"POST",headers:te,body:Z});if(!V.ok){let oe=await V.text().catch(()=>"");throw new Error(oe||"HTTP "+V.status)}an(oe=>({...oe,saving:!1,success:"저장되었습니다."})),setTimeout(()=>an(oe=>({...oe,success:null})),1200)}catch(k){an(z=>({...z,saving:!1,error:(k==null?void 0:k.message)||"저장 오류"}))}}c.useEffect(()=>{w!=null&&w.customerSeq&&Y&&Hn()},[w==null?void 0:w.customerSeq,Y]);async function Ta(){try{const k=Number(Y),z=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),X=Number((w==null?void 0:w.customerSeq)||0);if(!z){alert("로그인이 필요합니다.");return}if(!Number.isFinite(k)||k<=0){alert("연도를 선택하세요.");return}if(!X){alert("거래처를 선택하세요.");return}const te={year:k,companyType:S,assigneeId:z,customerSeq:X},Z={"Content-Type":"application/json","X-ASSIGNEE-ID":z},V=(localStorage.getItem("tnt.sales.empId")||"").trim();V&&(Z["X-EMP-ID"]=V);const oe=await fetch("/api/v1/sales/plan/confirm-customer",{method:"POST",headers:Z,body:JSON.stringify(te)});if(!oe.ok){let ie=await oe.text().catch(()=>"");throw new Error(ie||"HTTP "+oe.status)}await oe.json().catch(()=>({})),D("confirm"),aa(ie=>ie+1);try{const ie=String((w==null?void 0:w.customerName)||""),ne=String(Y||"");vn(ie&&ne?`${ie} ${ne}년 목표 수립이 완료되었습니다.`:"목표 수립이 완료되었습니다.")}catch{vn("목표 수립이 완료되었습니다.")}}catch(k){alert((k==null?void 0:k.message)||"확정 처리 중 오류가 발생했습니다")}}const[kt,Zn]=c.useState(!1),[li,er]=c.useState(""),[tr,xn]=c.useState("TNT");function Kn(k,z){return Number.isFinite(k)?k:0}function Qe(k,z,X,te,Z){const V=Number.isFinite(k)&&k>0,oe=V&&Number.isFinite(X),ie=oe?Number(X):V?Kn(k):0,ne=V?ea.format(Number(k)):"-",de=V?oe?`${ea.format(Number(ie))} 원`:"-":"";return n.jsxs("div",{style:{textAlign:"right",lineHeight:1.15,color:te||void 0},children:[n.jsx("div",{style:{fontWeight:Z?700:void 0},children:ne}),n.jsx("div",{className:Z?void 0:"muted",style:{fontSize:11,color:te||void 0,fontWeight:Z?700:void 0},children:de})]})}async function Mn(k,z){try{const X=Number(Y),te=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!te||!Number.isFinite(X)||X<=0){Tt(ne=>({...ne,rows:[],error:null,loading:!1}));return}Tt(ne=>({...ne,loading:!0,error:null}));const Z=new URL("/api/v1/sales/plan/totals-breakdown",window.location.origin);Z.searchParams.set("year",String(X)),Z.searchParams.set("assigneeId",te),Z.searchParams.set("companyType",k),Z.searchParams.set("groupBy",z);const V=await fetch(Z.toString());if(!V.ok){let ne=await V.text().catch(()=>"");throw new Error(ne||"HTTP "+V.status)}const oe=await V.json().catch(()=>[]),ie=(Array.isArray(oe)?oe:[]).map(ne=>({key:String((ne==null?void 0:ne.key)??""),label:ne!=null&&ne.label?String(ne.label):void 0,amount:Number((ne==null?void 0:ne.amount)??0)}));Tt(ne=>({...ne,rows:ie,loading:!1,error:null}))}catch(X){Tt(te=>({...te,loading:!1,error:(X==null?void 0:X.message)||"조회 오류",rows:[]}))}}function na(k,z){if(z)try{_n({x:z.clientX||0,y:z.clientY||0})}catch{}Tt({open:!0,company:k,group:"customer",loading:!1,error:null,rows:[]}),Mn(k,"customer")}function ur(){Tt(k=>({...k,open:!1}))}async function ci(){Le(!0),Ie(null);try{const k=(localStorage.getItem("tnt.sales.empName")||"").trim();if(!k){yt({tnt:0,dys:0}),Ie("로그인이 필요합니다");return}if(!Y||isNaN(Number(Y))){yt({tnt:0,dys:0});return}const z=new URL("/api/v1/targets/assigned",window.location.origin);z.searchParams.set("year",String(Y)),z.searchParams.set("empNames",k);try{const oe=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),ie=oe==="moderate"?"2":oe==="best"?"1":"";ie&&z.searchParams.set("versionNo",ie)}catch{}const X=await fetch(z.toString());if(!X.ok)throw new Error(`HTTP ${X.status}`);const te=await X.json().catch(()=>[]),Z=Array.isArray(te)?te.find(oe=>String(oe.company_name||"").toUpperCase()==="TNT"):null,V=Array.isArray(te)?te.find(oe=>String(oe.company_name||"").toUpperCase()==="DYS"):null;yt({tnt:Math.round(Number((Z==null?void 0:Z.assigned_amount)||0)),dys:Math.round(Number((V==null?void 0:V.assigned_amount)||0)),tntStage:String((Z==null?void 0:Z.target_stage)||"").trim()||void 0,dysStage:String((V==null?void 0:V.target_stage)||"").trim()||void 0})}catch(k){Ie((k==null?void 0:k.message)||"조회 오류"),yt({tnt:0,dys:0})}finally{Le(!1)}}const[fr,ra]=c.useState(0);c.useEffect(()=>{const k=()=>ra(z=>z+1);return window.addEventListener("tnt.sales.assign.mode.changed",k),()=>window.removeEventListener("tnt.sales.assign.mode.changed",k)},[]),c.useEffect(()=>{ci()},[Y,fr]),c.useEffect(()=>{(async()=>{try{const k=Number(Y),z=(localStorage.getItem("tnt.sales.assigneeId")||"").trim();if(!z||!Number.isFinite(k)||k<=0){lt({tnt:0,dys:0});return}const X=new URL("/api/v1/sales/plan/totals-by-assignee",window.location.origin);X.searchParams.set("year",String(k)),X.searchParams.set("assigneeId",z);const te=await fetch(X.toString());if(!te.ok)throw new Error(`HTTP ${te.status}`);const Z=await te.json().catch(()=>[]);let V=0,oe=0;Array.isArray(Z)&&Z.forEach(ie=>{const ne=String((ie==null?void 0:ie.company_type)||(ie==null?void 0:ie.companyType)||"").toUpperCase(),de=Number((ie==null?void 0:ie.amount)||0);ne==="TNT"?V+=de:ne==="DYS"&&(oe+=de)}),lt({tnt:Math.round(V),dys:Math.round(oe)})}catch{lt({tnt:0,dys:0})}})()},[Y]),c.useEffect(()=>{async function k(){try{F(!1);const z=Number(Y);if(!Number.isFinite(z)||z<=0){fe(ze=>({...ze,show:!1})),F(!0);return}const X=localStorage.getItem("tnt.sales.assigneeId")||"",te=localStorage.getItem("tnt.sales.empId")||"",Z=new URL("/api/v1/sales/plan/status",window.location.origin);Z.searchParams.set("year",String(z)),X?Z.searchParams.set("assigneeId",X):te&&Z.searchParams.set("empId",te);const V=await fetch(Z.toString());if(!V.ok){fe(ze=>({...ze,show:!1})),F(!0);return}const oe=await V.json().catch(()=>({})),ie=(localStorage.getItem("tnt.sales.empName")||"").trim()||"사용자",ne=Number((oe==null?void 0:oe.tnt)||0),de=Number((oe==null?void 0:oe.dys)||0),he=!!(oe!=null&&oe.hasP),ue=!!(oe!=null&&oe.hasC),Ce=!!(oe!=null&&oe.hasI);let we="";ue&&!he&&!Ce?we="목표수립완료":Ce&&!he&&!ue?we="초기설정완료":(he||ue&&Ce)&&(we="계획수립 중"),fe({show:!!we,name:ie,tnt:ne,dys:de,year:z,label:we,hasP:he,hasC:ue,hasI:Ce}),D(ue&&!he&&!Ce?"confirm":he?"sim":"init"),F(!0)}catch{fe(X=>({...X,show:!1})),F(!0)}}k()},[Y]);const[nr,aa]=c.useState(0),[at,Mt]=c.useState({loading:!1,error:null,rows:[]});c.useEffect(()=>{const k=Number((w==null?void 0:w.customerSeq)||0),z=Number(Y);if(!k||!Number.isFinite(z)||z<=0){Mt({loading:!1,error:null,rows:[]});return}let X=!1;return(async()=>{try{Mt(ne=>({...ne,loading:!0,error:null}));const te=localStorage.getItem("tnt.sales.assigneeId")||"",Z=new URL("/api/v1/sales/plan/customer-monthly-rows",window.location.origin);Z.searchParams.set("year",String(z)),Z.searchParams.set("customerSeq",String(k)),S&&Z.searchParams.set("companyType",S),te&&Z.searchParams.set("assigneeId",te);const V=await fetch(Z.toString());if(!V.ok){let ne=`HTTP ${V.status}`;try{const de=await V.json();de!=null&&de.error&&(ne=de.error)}catch{}throw new Error(ne)}const oe=await V.json().catch(()=>[]),ie=(Array.isArray(oe)?oe:[]).map(ne=>({sub:String((ne==null?void 0:ne.item_subcategory)??(ne==null?void 0:ne.itemSubcategory)??""),unit:String((ne==null?void 0:ne.sales_mgmt_unit)??(ne==null?void 0:ne.salesMgmtUnit)??""),months:Array.from({length:12},(de,he)=>Number((ne==null?void 0:ne[`qty_${String(he+1).padStart(2,"0")}`])??0)),amounts:Array.from({length:12},(de,he)=>Number((ne==null?void 0:ne[`amount_${String(he+1).padStart(2,"0")}`])??0)),type:String((ne==null?void 0:ne.plan_type)||(ne==null?void 0:ne.planType)||"").toUpperCase()==="P"?"P":"B",stage:String((ne==null?void 0:ne.target_stage)||(ne==null?void 0:ne.targetStage)||"").toUpperCase()||void 0}));X||Mt({loading:!1,error:null,rows:ie})}catch(te){X||Mt({loading:!1,error:(te==null?void 0:te.message)||"오류",rows:[]})}})(),()=>{X=!0}},[w==null?void 0:w.customerSeq,Y,S,nr]),c.useEffect(()=>{try{if(!Number((w==null?void 0:w.customerSeq)||0))return;const z=Array.isArray(at.rows)?at.rows:[];if(!z.length){D("init");return}const X=z.some(V=>String((V==null?void 0:V.type)||"").toUpperCase()==="P"),te=z.map(V=>String((V==null?void 0:V.stage)||"").toUpperCase()).filter(Boolean),Z=te.length>0&&te.every(V=>V==="C");D(Z?"confirm":X?"sim":"init")}catch{}},[w==null?void 0:w.customerSeq,at.rows]);const[re,xe]=c.useState({open:!1,dist:new Array(12).fill(0),curMonths:new Array(12).fill(0),curAmounts:new Array(12).fill(0),success:null}),[ye,De]=c.useState({}),[ce,Oe]=c.useState({}),[Se,Be]=c.useState({});function qe(k){return String(k||"").trim().toUpperCase()}function Ye(k){try{const z=Ue(),te=(ye[z]||{})[qe(k)];if(Number.isFinite(te)&&Number(te)>0)return Number(te);const Z=it(),oe=((ce==null?void 0:ce[Z])||{})[qe(k)];return Number.isFinite(oe)&&Number(oe)>0?Number(oe):void 0}catch{return}}function Ue(){const k=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),z=Number(Y),X=new Date().getFullYear()-1,te=Number.isFinite(z)&&z>0?z-1:X;return`${k}|${S||""}|${te}`}async function At(){try{const k=Ue();if(!k||ye[k])return;const[z,X,te]=k.split("|"),Z=Number(te);if(!z||!X||!Number.isFinite(Z)||Z<=0)return;const V=new URL("/api/v1/dashboard/avg-unit-price-by-emp",window.location.origin);V.searchParams.set("assigneeId",z),V.searchParams.set("companyType",X),V.searchParams.set("year",String(Z));const oe=await fetch(V.toString());if(!oe.ok)return;const ie=await oe.json().catch(()=>[]),ne={},de={};Array.isArray(ie)&&ie.forEach(he=>{const ue=qe((he==null?void 0:he.sales_mgmt_unit)||(he==null?void 0:he.salesMgmtUnit)),Ce=Number((he==null?void 0:he.avg_unit_price)||(he==null?void 0:he.avgUnitPrice)||0);ue&&(ne[ue]=Ce),ue&&(de[ue]={itemUnit:String((he==null?void 0:he.item_unit)||(he==null?void 0:he.itemUnit)||""),itemStdUnit:String((he==null?void 0:he.item_std_unit)||(he==null?void 0:he.itemStdUnit)||"")})}),De(he=>({...he,[k]:ne})),Be(he=>({...he,[k]:de}))}catch{}}function it(){const k=Number(Y),z=new Date().getFullYear()-1,X=Number.isFinite(k)&&k>0?k-1:z;return`${S||""}|${X}`}async function tt(){try{const k=it();if(!k||ce[k])return;const[z,X]=k.split("|"),te=Number(X);if(!z||!Number.isFinite(te)||te<=0)return;const Z=new URL("/api/v1/dashboard/avg-unit-price",window.location.origin);Z.searchParams.set("companyType",z),Z.searchParams.set("year",String(te));const V=await fetch(Z.toString());if(!V.ok)return;const oe=await V.json().catch(()=>[]),ie={};Array.isArray(oe)&&oe.forEach(ne=>{const de=qe((ne==null?void 0:ne.sales_mgmt_unit)||(ne==null?void 0:ne.salesMgmtUnit)),he=Number((ne==null?void 0:ne.avg_unit_price)||(ne==null?void 0:ne.avgUnitPrice)||0);de&&(ie[de]=he)}),Oe(ne=>({...ne,[k]:ie}))}catch{}}async function hr(k){try{await tt()}catch{}}async function Xt(k){try{const z=Ue();if(!z)return;const[X,te,Z]=z.split("|"),V=Number(Z);if(!X||!te||!Number.isFinite(V)||V<=0)return;const oe=new URL("/api/v1/dashboard/avg-unit-price-by-emp",window.location.origin);oe.searchParams.set("assigneeId",X),oe.searchParams.set("companyType",te),oe.searchParams.set("year",String(V));const ie=await fetch(oe.toString());if(!ie.ok)return;const ne=await ie.json().catch(()=>[]);let de=null;if(Array.isArray(ne)){const he=qe(k);de=ne.find(ue=>qe((ue==null?void 0:ue.sales_mgmt_unit)||(ue==null?void 0:ue.salesMgmtUnit))===he)}if(de){const he=qe((de==null?void 0:de.sales_mgmt_unit)||(de==null?void 0:de.salesMgmtUnit)),ue=Number((de==null?void 0:de.avg_unit_price)||(de==null?void 0:de.avgUnitPrice)||0),Ce={itemUnit:String((de==null?void 0:de.item_unit)||(de==null?void 0:de.itemUnit)||""),itemStdUnit:String((de==null?void 0:de.item_std_unit)||(de==null?void 0:de.itemStdUnit)||"")};De(we=>({...we,[z]:{...we[z]||{},[he]:ue}})),Be(we=>({...we,[z]:{...we[z]||{},[he]:Ce}}))}}catch{}}function $r(k,z){const X=(at.rows||[]).find(V=>V.sub===k&&V.unit===z),te=X!=null&&X.months?X.months.slice():new Array(12).fill(0),Z=X!=null&&X.amounts?X.amounts.slice():new Array(12).fill(0);xe({open:!0,sub:k,unit:z,stage:X==null?void 0:X.stage,month:"",qty:"",dist:new Array(12).fill(0),curMonths:te,curAmounts:Z,success:null});try{At()}catch{}try{tt()}catch{}}function Lr(){xe({open:!1,dist:new Array(12).fill(0),curMonths:new Array(12).fill(0),curAmounts:new Array(12).fill(0),success:null})}function cs(k,z){const X=Number(k),te=Number(z),Z=new Array(12).fill(0);if(Number.isFinite(X)&&X>=1&&X<=12&&Number.isFinite(te)&&te>0){const V=12-X+1,oe=te/V;for(let ie=X-1;ie<12;ie++)Z[ie]=oe}xe(V=>({...V,month:k,qty:z,dist:Z}))}async function ds(){try{const k=Number(Y),z=S,X=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),te=Number((w==null?void 0:w.customerSeq)||0),Z=(re.sub||"").trim(),V=(re.unit||"").trim();if(!Number.isFinite(k)||k<=0){alert("연도를 선택하세요.");return}if(!X){alert("로그인이 필요합니다.");return}if(!te||!Z||!V){alert("거래처/중분류/영업관리단위가 필요합니다.");return}const oe=(re.dist||[]).map(ue=>{const Ce=Number(ue);return!Number.isFinite(Ce)||Ce<=0?0:Math.round(Ce*100)/100});if(!oe.some(ue=>ue>0)&&!(re.month&&Number(re.month)>0)){alert("매출월을 선택하세요.");return}const ie={year:k,companyType:z,assigneeId:X,customerSeq:te,itemSubcategory:Z,salesMgmtUnit:V,qty:oe},ne={"Content-Type":"application/json","X-ASSIGNEE-ID":X},de=(localStorage.getItem("tnt.sales.empId")||"").trim();de&&(ne["X-EMP-ID"]=de);const he=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:ne,body:JSON.stringify(ie)});if(!he.ok){let ue=await he.text().catch(()=>"");throw new Error(ue||"HTTP "+he.status)}xe(ue=>({...ue,success:"목표가 변경되었습니다"}))}catch(k){alert((k==null?void 0:k.message)||"저장 중 오류가 발생했습니다")}}async function G(){try{const k=Number(Y),z=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),X=Number((w==null?void 0:w.customerSeq)||0);if(Number.isFinite(k)&&k>0&&z&&X){const te=new URL("/api/v1/sales/plan/customer-monthly-rows",window.location.origin);te.searchParams.set("year",String(k)),te.searchParams.set("customerSeq",String(X)),S&&te.searchParams.set("companyType",S),te.searchParams.set("assigneeId",z);const Z=await fetch(te.toString());if(Z.ok){const V=await Z.json().catch(()=>[]),oe=(Array.isArray(V)?V:[]).map(ie=>({sub:String((ie==null?void 0:ie.item_subcategory)??(ie==null?void 0:ie.itemSubcategory)??""),unit:String((ie==null?void 0:ie.sales_mgmt_unit)??(ie==null?void 0:ie.salesMgmtUnit)??""),months:Array.from({length:12},(ne,de)=>Number((ie==null?void 0:ie[`qty_${String(de+1).padStart(2,"0")}`])??0)),amounts:Array.from({length:12},(ne,de)=>Number((ie==null?void 0:ie[`amount_${String(de+1).padStart(2,"0")}`])??0)),type:String((ie==null?void 0:ie.plan_type)||(ie==null?void 0:ie.planType)||"").toUpperCase()==="P"?"P":"B",stage:String((ie==null?void 0:ie.target_stage)||(ie==null?void 0:ie.targetStage)||"").toUpperCase()||void 0}));Mt({loading:!1,error:null,rows:oe})}}}catch{}Lr();try{Re()}catch{}try{Rr()}catch{}try{fs()}catch{}}const[le,be]=c.useState({open:!1,rows:[],success:null});function Pe(){const k=(at.rows||[]).map((z,X)=>({key:`${z.sub}||${z.unit}||${X}`,sub:z.sub,unit:z.unit,stage:z.stage,type:z.type,month:"",qty:"",dist:new Array(12).fill(0),curMonths:z.months?z.months.slice():new Array(12).fill(0),curAmounts:z.amounts?z.amounts.slice():new Array(12).fill(0)}));be({open:!0,rows:k,success:null});try{At()}catch{}try{tt()}catch{}}function Re(){be({open:!1,rows:[],success:null})}function Ae(k,z,X){be(te=>{const Z=te.rows.slice(),V={...Z[k]},oe=Number(z??V.month),ie=Number(X??V.qty),ne=new Array(12).fill(0);if(Number.isFinite(oe)&&oe>=1&&oe<=12&&Number.isFinite(ie)&&ie>0){const de=12-oe+1,he=ie/de;for(let ue=oe-1;ue<12;ue++)ne[ue]=he}return V.month=z??V.month,V.qty=X??V.qty,V.dist=ne,Z[k]=V,{...te,rows:Z}})}async function Ee(){try{const k=Number(Y),z=S,X=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),te=Number((w==null?void 0:w.customerSeq)||0);if(!Number.isFinite(k)||k<=0){alert("연도를 선택하세요.");return}if(!X){alert("로그인이 필요합니다.");return}if(!te){alert("거래처를 선택하세요.");return}const Z={"Content-Type":"application/json","X-ASSIGNEE-ID":X},V=(localStorage.getItem("tnt.sales.empId")||"").trim();V&&(Z["X-EMP-ID"]=V);const oe=(le.rows||[]).filter(ie=>!!ie.month&&Number(ie.month)>0);if(oe.length===0){alert("매출월을 선택한 행이 없습니다.");return}for(const ie of oe){const ne=Number(ie.month),de=Number(ie.qty||0),he=new Array(12).fill(0);if(Number.isFinite(ne)&&ne>=1&&ne<=12){const ze=12-ne+1,$e=Number.isFinite(de)&&de>0?de/ze:0;for(let Ke=ne-1;Ke<12;Ke++)he[Ke]=$e}const ue=he.map(ze=>{const $e=Number(ze);return!Number.isFinite($e)||$e<=0?0:Math.round($e*100)/100}),Ce={year:k,companyType:z,assigneeId:X,customerSeq:te,itemSubcategory:ie.sub,salesMgmtUnit:ie.unit,qty:ue},we=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:Z,body:JSON.stringify(Ce)});if(!we.ok){let ze=await we.text().catch(()=>"");throw new Error(ze||"HTTP "+we.status)}}be(ie=>({...ie,success:"목표가 변경되었습니다"}))}catch(k){alert((k==null?void 0:k.message)||"저장 중 오류가 발생했습니다")}}function We(k){try{const z=k.getBoundingClientRect(),X=(z==null?void 0:z.width)||k.offsetWidth||600,te=(z==null?void 0:z.height)||k.offsetHeight||400,Z=Math.max(0,Math.round((window.innerWidth-X)/2)),oe=Math.max(0,Math.round(window.innerHeight-te-40));return{x:Z,y:oe}}catch{const z=Math.max(0,Math.round((window.innerWidth-600)/2)),te=Math.max(0,Math.round(window.innerHeight-400-40));return{x:z,y:te}}}function dt(k){try{const z=k.getBoundingClientRect(),X=(z==null?void 0:z.width)||k.offsetWidth||600,te=(z==null?void 0:z.height)||k.offsetHeight||400,Z=Math.max(0,Math.round((window.innerWidth-X)/2)),V=Math.max(0,Math.round((window.innerHeight-te)/2));return{x:Z,y:V}}catch{const te=Math.max(0,Math.round((window.innerWidth-600)/2)),Z=Math.max(0,Math.round((window.innerHeight-400)/2));return{x:te,y:Z}}}function qt(k){try{const z=k.getBoundingClientRect(),X=(z==null?void 0:z.width)||k.offsetWidth||460,te=Math.max(0,Math.round(window.innerWidth-X)),Z=Math.max(0,Math.round(window.innerHeight*.17));return{x:te,y:Z}}catch{const X=Math.max(0,Math.round(window.innerWidth-460)),te=Math.max(0,Math.round(window.innerHeight*.17));return{x:X,y:te}}}const on=jn("sales-plan-target-input",!!re.open,We,{persist:!1,resetOnOpen:!0}),Ge=jn("sales-plan-bulk-input",!!le.open,dt,{persist:!1,resetOnOpen:!0}),[vt,ia]=c.useState({open:!1,rows:[],success:null}),[di,us]=c.useState("");function mn(){const k=(at.rows||[]).map((z,X)=>({key:`${z.sub}||${z.unit}||${X}`,sub:z.sub,unit:z.unit,stage:z.stage,type:z.type,month:"",qty:"",dist:new Array(12).fill(0),curMonths:z.months?z.months.slice():new Array(12).fill(0),curAmounts:z.amounts?z.amounts.slice():new Array(12).fill(0)}));ia({open:!0,rows:k,success:null});try{At()}catch{}try{tt()}catch{}}function Rr(){ia({open:!1,rows:[],success:null})}function rr(){const k=Number(di);if(!Number.isFinite(k)){alert("적용 비율(%)을 입력하세요.");return}let z=1+k/100;(!Number.isFinite(z)||z<0)&&(z=0),ia(X=>{const te=(X.rows||[]).map(Z=>{const V=Z.curMonths||[],oe=Array.from({length:12},(ie,ne)=>{const de=Number(V[ne]||0);return Number.isFinite(de)?de*z:0});return{...Z,dist:oe}});return{...X,rows:te}})}const ui=jn("sales-plan-bulk-ratio",!!vt.open,dt,{persist:!1,resetOnOpen:!0});async function Rl(){try{const k=Number(Y),z=S,X=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),te=Number((w==null?void 0:w.customerSeq)||0);if(!Number.isFinite(k)||k<=0){alert("연도를 선택하세요.");return}if(!X){alert("로그인이 필요합니다.");return}if(!te){alert("거래처를 선택하세요.");return}const Z={"Content-Type":"application/json","X-ASSIGNEE-ID":X},V=(localStorage.getItem("tnt.sales.empId")||"").trim();V&&(Z["X-EMP-ID"]=V);const oe=(vt.rows||[]).filter(ie=>(ie.dist||[]).some(ne=>Number(ne)>0));if(oe.length===0){alert("적용 비율을 먼저 적용하세요.");return}for(const ie of oe){const ne=(ie.dist||[]).map(ue=>{const Ce=Number(ue);return!Number.isFinite(Ce)||Ce<=0?0:Math.round(Ce*100)/100}),de={year:k,companyType:z,assigneeId:X,customerSeq:te,itemSubcategory:ie.sub,salesMgmtUnit:ie.unit,qty:ne},he=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:Z,body:JSON.stringify(de)});if(!he.ok){let ue=await he.text().catch(()=>"");throw new Error(ue||"HTTP "+he.status)}}ia(ie=>({...ie,success:"목표가 변경되었습니다"}))}catch(k){alert((k==null?void 0:k.message)||"저장 중 오류가 발생했습니다")}}const[Xe,kn]=c.useState({open:!1,loading:!1,error:null,success:null,opts:[],dist:new Array(12).fill(0),rows:[]}),fi=jn("sales-plan-new-item",!!Xe.open,dt,{persist:!1,resetOnOpen:!0});function Tb(k){try{const z=k.getBoundingClientRect(),X=(z==null?void 0:z.width)||k.offsetWidth||480,te=(z==null?void 0:z.height)||k.offsetHeight||300,Z=12;let V=Math.round(rt.x-Math.min(X/2,240)),oe=Math.round(rt.y+Z);return V=Math.max(8,Math.min(V,window.innerWidth-X-8)),oe=Math.max(8,Math.min(oe,window.innerHeight-te-8)),{x:V,y:oe}}catch{const z=Math.max(8,Math.min(rt.x,window.innerWidth-500)),X=Math.max(8,Math.min(rt.y,window.innerHeight-320));return{x:z,y:X}}}const zl=jn("plan-totals-breakdown",ct.open,Tb,{persist:!1,resetOnOpen:!0});async function Pf(){kn(k=>({...k,open:!0,loading:!0,error:null,unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0),rows:[]}));try{const k=await fetch("/api/v1/items/dim"),z=k.ok?await k.json():[],X=Array.isArray(z)?z.map(V=>({itemSubcategory:String(V.itemSubcategory||V.item_subcategory||""),salesMgmtUnit:String(V.salesMgmtUnit||V.sales_mgmt_unit||"")})):[],te={};X.forEach(V=>{const oe=V.salesMgmtUnit.trim();oe&&!te[oe]&&(te[oe]=V)});const Z=Object.values(te).sort((V,oe)=>V.salesMgmtUnit.localeCompare(oe.salesMgmtUnit));kn(V=>({...V,loading:!1,opts:Z}));try{At()}catch{}}catch(k){kn(z=>({...z,loading:!1,error:(k==null?void 0:k.message)||"조회 오류",opts:[]}))}}c.useEffect(()=>{if(Xe.open){try{At()}catch{}try{tt()}catch{}}},[Xe.open,Y,S]);function fs(){kn({open:!1,loading:!1,error:null,success:null,opts:[],dist:new Array(12).fill(0),rows:[]})}function Ob(k){const z=Xe.opts.find(X=>X.salesMgmtUnit===k);kn(X=>({...X,unit:k,sub:(z==null?void 0:z.itemSubcategory)||X.sub}));try{At()}catch{}try{Xt(k)}catch{}try{hr(k)}catch{}}function Ef(k,z){const X=Number(k??Xe.month),te=Number(z??Xe.qty),Z=new Array(12).fill(0);if(Number.isFinite(X)&&X>=1&&X<=12&&Number.isFinite(te)&&te>0){const V=12-X+1,oe=te/V;for(let ie=X-1;ie<12;ie++)Z[ie]=oe}kn(V=>({...V,month:k??V.month,qty:z??V.qty,dist:Z}))}function _b(){const k=(Xe.unit||"").trim(),z=(Xe.sub||"").trim(),X=Xe.month,te=Xe.qty;if(!k||!X||!te){alert("영업관리단위, 매출월, 매출 수량을 입력하세요.");return}const Z={sub:z||"(신규)",unit:k,months:Xe.dist.slice()};kn(V=>{const oe=V.rows.slice(),ie=oe.findIndex(ne=>(ne.unit||"").trim()===k&&(ne.sub||"").trim()===(Z.sub||"").trim());return ie>=0?oe[ie]={...oe[ie],sub:Z.sub,unit:Z.unit,months:Z.months.slice()}:oe.push(Z),{...V,rows:oe,unit:"",sub:"",month:"",qty:"",dist:new Array(12).fill(0)}})}async function Mb(){try{const k=Number(Y),z=S,X=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),te=Number((w==null?void 0:w.customerSeq)||0);if(!Number.isFinite(k)||k<=0){alert("연도를 선택하세요.");return}if(!X){alert("로그인이 필요합니다.");return}if(!te){alert("거래처를 선택하세요.");return}const Z=Xe.rows||[];if(!Z.length){alert("추가된 영업관리단위가 없습니다.");return}const V=new Set((at.rows||[]).map(de=>`${String(de.sub||"").trim()}||${String(de.unit||"").trim()}`).filter(de=>!!de&&de!=="||")),oe=Z.map(de=>({sub:String(de.sub||"").trim(),unit:String(de.unit||"").trim()})).filter(de=>de.sub&&de.unit&&V.has(`${de.sub}||${de.unit}`)).map(de=>de.unit);if(oe.length>0){kn(de=>({...de,error:`${oe.join(", ")} 이미 목표에 등록되어 있습니다. 목표 수정을 통해 작업 하세요.`}));return}const ie={"Content-Type":"application/json","X-ASSIGNEE-ID":X},ne=(localStorage.getItem("tnt.sales.empId")||"").trim();ne&&(ie["X-EMP-ID"]=ne);for(const de of Z){const he=(de.months||[]).map(Ct=>{const nt=Number(Ct);return!Number.isFinite(nt)||nt<=0?0:Math.round(nt*100)/100}),ue=String(de.unit||"").trim(),Ce=Ye(ue),we=Number.isFinite(Ce)?Math.round(Number(Ce)):0,ze=he.map(Ct=>Number.isFinite(Ct)&&we>0?Math.round(Number(Ct)*we):0),$e={year:k,companyType:z,assigneeId:X,customerSeq:te,itemSubcategory:de.sub,salesMgmtUnit:de.unit,qty:he,amount:ze},Ke=await fetch("/api/v1/sales/plan/upsert-row",{method:"POST",headers:ie,body:JSON.stringify($e)});if(!Ke.ok){let Ct=await Ke.text().catch(()=>"");throw new Error(Ct||"HTTP "+Ke.status)}}kn(de=>({...de,success:"목표가 변경되었습니다"}))}catch(k){alert((k==null?void 0:k.message)||"저장 중 오류가 발생했습니다")}}c.useEffect(()=>{if(!re.open&&!le.open&&!Xe.open)return;const k=z=>{z.key==="Escape"&&(re.open&&Lr(),le.open&&Re(),Xe.open&&fs())};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[re.open,le.open,Xe.open]);async function sa(k=!0){f(null),k?(l(!0),K(0),ee(!0)):T(!0);try{const z=Number(Y);if(!Number.isFinite(z)||z<=0){k&&(h([]),ee(!0),K(0),j({}),$({}));return}const X=localStorage.getItem("tnt.sales.assigneeId");if(!X){h([]),f(ot.loginRequired);return}const te=new URL("/api/v1/customers",window.location.origin);te.searchParams.set("mineOnly","true"),te.searchParams.set("assigneeId",X),te.searchParams.set("companyType",S),Y&&te.searchParams.set("year",String(Y)),m.trim()&&te.searchParams.set("name",m.trim()),te.searchParams.set("limit",String(J)),te.searchParams.set("offset",String(k?0:q));const Z=await fetch(te.toString());if(!Z.ok){let ie=`HTTP ${Z.status}`;try{const ne=await Z.json();ne!=null&&ne.error&&(ie=ne.error)}catch{const ne=await Z.text();ne&&(ie=ne)}throw new Error(ie)}const V=await Z.json(),oe=Array.isArray(V)?V:[];h(k?oe:ie=>[...ie,...oe]),ee(oe.length>=J),K(ie=>k?J:ie+J);try{if(X){const ie=new URL("/api/v1/customers/count",window.location.origin);ie.searchParams.set("mineOnly","true"),ie.searchParams.set("assigneeId",X);const ne=await fetch(ie.toString());if(ne.ok){const de=await ne.json().catch(()=>({})),he=Number((de==null?void 0:de.total)??0);_(Number.isFinite(he)?he:0)}else _(0)}else _(0)}catch{_(0)}try{const ie=oe.map(ne=>Number(ne.customerSeq||0)).filter(ne=>Number.isFinite(ne)&&ne>0);if(ie.length>0){const ne=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);ne.searchParams.set("custSeq",Array.from(new Set(ie)).join(",")),ne.searchParams.set("years","2");const de=await fetch(ne.toString());if(de.ok){const he=await de.json(),ue={};Array.isArray(he)&&he.forEach(Ce=>{const we=Number((Ce==null?void 0:Ce.customerSeq)||(Ce==null?void 0:Ce.customerSeqText)||0);Number.isFinite(we)&&(ue[we]=!!(Ce!=null&&Ce.hasRecent))}),j(Ce=>k?ue:{...Ce,...ue})}else k&&j({})}else k&&j({})}catch{j({})}try{const ie=Number(Y),ne=Number.isFinite(ie)&&ie>0?ie:new Date().getFullYear(),de=localStorage.getItem("tnt.sales.assigneeId")||"",he=oe.map(ue=>Number(ue.customerSeq||0)).filter(ue=>Number.isFinite(ue)&&ue>0);if(de&&he.length>0){const ue=new URL("/api/v1/sales/plan/stages",window.location.origin);ue.searchParams.set("year",String(ne)),S&&ue.searchParams.set("companyType",S),ue.searchParams.set("assigneeId",de),ue.searchParams.set("customerSeqs",Array.from(new Set(he)).join(","));const Ce=await fetch(ue.toString());if(Ce.ok){const we=await Ce.json(),ze={};Array.isArray(we)&&we.forEach($e=>{const Ke=Number(($e==null?void 0:$e.customer_seq)??($e==null?void 0:$e.customerSeq)??0),Ct=String(($e==null?void 0:$e.target_stage)??($e==null?void 0:$e.targetStage)??"").trim();Number.isFinite(Ke)&&Ct&&(ze[Ke]=Ct)}),$($e=>k?ze:{...$e,...ze})}else k&&$({})}else k&&$({})}catch{k&&$({})}}catch(z){f(z.message||"조회 중 오류가 발생했습니다")}finally{k?l(!1):T(!1)}}c.useEffect(()=>{Y&&sa(!0)},[Y,S]),c.useEffect(()=>{Y||(h([]),ee(!0),K(0),j({}),$({}))},[Y]),c.useEffect(()=>{async function k(){try{const z=localStorage.getItem("tnt.sales.assigneeId");if(!z){H({tnt:0,dys:0});return}const X=Number(Y);if(!Number.isFinite(X)||X<=0){H({tnt:0,dys:0});return}const te=new URL("/api/v1/customers/with-invoice-count",window.location.origin);te.searchParams.set("assigneeId",z),te.searchParams.set("year",String(X));const Z=await fetch(te.toString());if(!Z.ok){H({tnt:0,dys:0});return}const V=await Z.json().catch(()=>({})),oe=Number((V==null?void 0:V.tnt)??0),ie=Number((V==null?void 0:V.dys)??0);H({tnt:Number.isFinite(oe)?oe:0,dys:Number.isFinite(ie)?ie:0})}catch{H({tnt:0,dys:0})}}k()},[Y]);const Db=c.useMemo(()=>{const k=Number(Y);return Number.isFinite(k)&&k>0?`${k-1}년`:"전년도"},[Y]),$b=c.useMemo(()=>(localStorage.getItem("tnt.sales.empName")||"").trim()||"사용자",[]),Ot="#1e3a8a";c.useEffect(()=>{if(!g.open)return;const k=()=>b({open:!1,x:0,y:0});return window.addEventListener("click",k),()=>window.removeEventListener("click",k)},[g.open]),c.useEffect(()=>{if(!g.open)return;const k=z=>{z.key==="Escape"&&b({open:!1,x:0,y:0})};return window.addEventListener("keydown",k),()=>window.removeEventListener("keydown",k)},[g.open]),c.useEffect(()=>{const k=z=>{((z==null?void 0:z.key)==="Escape"||(z==null?void 0:z.key)==="Esc"||(z==null?void 0:z.keyCode)===27)&&(b({open:!1,x:0,y:0}),N({open:!1,x:0,y:0}))};return document.addEventListener("keydown",k,!0),()=>document.removeEventListener("keydown",k,!0)},[]);async function Lb(k,z){k.preventDefault(),k.stopPropagation(),b({open:!1,x:0,y:0});const X=k.clientX,te=k.clientY;N({open:!0,x:X,y:te,row:z,loading:!1,error:null,data:[]})}const If=c.useMemo(()=>{var z,X,te,Z,V,oe,ie,ne,de,he,ue,Ce,we,ze,$e;const k=[...u].sort((Ke,Ct)=>{const nt=Number(Ke.customerSeq||0),Dn=Number(Ct.customerSeq||0),$n=!!I[nt],Gn=!!I[Dn];if($n!==Gn)return $n?-1:1;const mr=(Ke.customerName||"").toString(),ql=(Ct.customerName||"").toString();return mr.localeCompare(ql,"ko",{sensitivity:"base"})});return n.jsx(n.Fragment,{children:n.jsxs("div",{ref:B,className:"table-container",onClick:()=>b({open:!1,x:0,y:0}),style:{height:"100%",overflow:"auto"},children:[k.length===0?n.jsx("div",{className:"empty-state",children:ot.empty}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsx("tr",{children:n.jsx("th",{style:{width:"auto"},children:"거래처명"})})}),n.jsx("tbody",{children:k.map((Ke,Ct)=>n.jsx("tr",{onClick:nt=>{nt.preventDefault(),nt.stopPropagation(),M(Ke),N({open:!1,x:0,y:0})},onContextMenu:nt=>Lb(nt,Ke),"aria-selected":(w==null?void 0:w.customerId)===Ke.customerId?!0:void 0,style:(w==null?void 0:w.customerId)===Ke.customerId?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:n.jsx("td",{children:(()=>{const nt=Number(Ke.customerSeq||0),Dn=I[nt],$n={};return Dn==="P"&&($n.color="#dc2626"),Dn==="C"&&($n.fontWeight=700),n.jsxs("span",{children:[n.jsx("span",{style:$n,children:Ke.customerName}),Dn?n.jsx("span",{className:"badge stage-badge",style:{marginLeft:6},children:Dn}):null]})})()})},Ct))})]}),E&&n.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:ot.loading}),!o&&!E&&!L&&u.length>0&&n.jsx("div",{className:"muted",style:{padding:"8px 10px",textAlign:"center"},children:"마지막 데이터입니다."}),C.open&&n.jsxs("div",{className:"context-menu",style:{left:C.x+6,top:C.y+6,maxWidth:420,padding:8},onClick:Ke=>Ke.stopPropagation(),children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 상세"}),C.error?n.jsx("div",{className:"error",style:{maxWidth:380},children:C.error}):n.jsx("table",{className:"table",style:{width:"100%"},children:n.jsxs("tbody",{children:[n.jsxs("tr",{children:[n.jsx("th",{style:{width:110,textAlign:"left"},children:"거래처번호"}),n.jsx("td",{children:((z=C.row)==null?void 0:z.customerId)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"사업자번호"}),n.jsx("td",{children:((X=C.row)==null?void 0:X.bizNo)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"대표자명"}),n.jsx("td",{children:((te=C.row)==null?void 0:te.ownerName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"업태"}),n.jsx("td",{children:((Z=C.row)==null?void 0:Z.bizKind)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"종목"}),n.jsx("td",{children:((V=C.row)==null?void 0:V.bizType)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"전화번호"}),n.jsx("td",{children:((oe=C.row)==null?void 0:oe.telNo)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"담당자명"}),n.jsx("td",{children:((ie=C.row)==null?void 0:ie.empName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"부서명"}),n.jsx("td",{children:((ne=C.row)==null?void 0:ne.deptName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"시/도"}),n.jsx("td",{children:((de=C.row)==null?void 0:de.addrProvinceName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"시/군/구"}),n.jsx("td",{children:((he=C.row)==null?void 0:he.addrCityName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"고객유형"}),n.jsx("td",{children:((ue=C.row)==null?void 0:ue.customerTypeName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"비고"}),n.jsx("td",{children:((Ce=C.row)==null?void 0:Ce.customerRemark)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"생성자"}),n.jsx("td",{children:((we=C.row)==null?void 0:we.createdBy)??""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"수정자"}),n.jsx("td",{children:((ze=C.row)==null?void 0:ze.updatedBy)??""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"생성일시"}),n.jsx("td",{children:qj(($e=C.row)==null?void 0:$e.createdAt)})]})]})})]})]})})},[u,g,y,C,w,I,o,E,L]);c.useEffect(()=>{const k=B.current;if(!k)return;function z(){k.scrollTop+k.clientHeight>=k.scrollHeight-48&&L&&!E&&!o&&sa(!1)}return k.addEventListener("scroll",z),()=>k.removeEventListener("scroll",z)},[L,E,o,q]);const[Yn,Oa]=c.useState({open:!1,loading:!1,error:null,rows:[]}),[Wl,Rb]=c.useState(10),[zr,Tf]=c.useState(""),[hi,Bl]=c.useState("TNT"),Fl=jn("unit-amounts-by-emp",Yn.open,qt,{persist:!1,resetOnOpen:!0}),[_a,hs]=c.useState({total:0,confirmed:0,inprogress:0,loading:!1,error:null}),[mi,ms]=c.useState({tnt:0,dys:0,loading:!1,error:null});c.useEffect(()=>{async function k(){const z=Number(Y),X=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),te=(localStorage.getItem("tnt.sales.empId")||"").trim();if(!Number.isFinite(z)||z<=0||!X&&!te){hs({total:0,confirmed:0,inprogress:0,loading:!1,error:null});return}hs(Z=>({...Z,loading:!0,error:null}));try{const Z=new URL("/api/v1/sales/plan/customer-counts-overall",window.location.origin);Z.searchParams.set("year",String(z)),X?Z.searchParams.set("assigneeId",X):te&&Z.searchParams.set("empId",te);const V=await fetch(Z.toString());if(!V.ok)throw new Error(`HTTP ${V.status}`);const oe=await V.json(),ie=Number((oe==null?void 0:oe.total_customers)??0)||0,ne=Number((oe==null?void 0:oe.confirmed_customers)??0)||0,de=Number((oe==null?void 0:oe.inprogress_customers)??0)||0;hs({total:ie,confirmed:ne,inprogress:de,loading:!1,error:null})}catch(Z){hs({total:0,confirmed:0,inprogress:0,loading:!1,error:(Z==null?void 0:Z.message)||"요약 조회 오류"})}}k()},[Y,fr]);async function zb(){try{const k=localStorage.getItem("tnt.sales.assigneeId");if(!k||!zr){Oa(ue=>({...ue,loading:!1}));return}const z=new URL("/api/v1/dashboard/avg-unit-price-by-emp",window.location.origin);z.searchParams.set("assigneeId",k),z.searchParams.set("companyType",hi),z.searchParams.set("year",String(zr));const X=await fetch(z.toString());if(!X.ok)throw new Error(`HTTP ${X.status}`);const te=await X.json(),Z=new URL("/api/v1/dashboard/avg-unit-price",window.location.origin);Z.searchParams.set("companyType",hi),Z.searchParams.set("year",String(zr));const V=await fetch(Z.toString()),oe=V.ok?await V.json():[],ie={},ne={};Array.isArray(te)&&te.forEach(ue=>{const we=String((ue==null?void 0:ue.sales_mgmt_unit)??(ue==null?void 0:ue.salesMgmtUnit)??"").trim().toUpperCase();we&&(ie[we]={amount:Number((ue==null?void 0:ue.avg_unit_price)??(ue==null?void 0:ue.avgUnitPrice)??0),itemUnit:String((ue==null?void 0:ue.item_unit)??(ue==null?void 0:ue.itemUnit)??""),itemStdUnit:String((ue==null?void 0:ue.item_std_unit)??(ue==null?void 0:ue.itemStdUnit)??"")})}),Array.isArray(oe)&&oe.forEach(ue=>{const we=String((ue==null?void 0:ue.sales_mgmt_unit)??(ue==null?void 0:ue.salesMgmtUnit)??"").trim().toUpperCase();we&&(ne[we]={amount:Number((ue==null?void 0:ue.avg_unit_price)??(ue==null?void 0:ue.avgUnitPrice)??0),itemUnit:String((ue==null?void 0:ue.item_unit)??(ue==null?void 0:ue.itemUnit)??""),itemStdUnit:String((ue==null?void 0:ue.item_std_unit)??(ue==null?void 0:ue.itemStdUnit)??"")})});const he=Array.from(new Set([...Object.keys(ie),...Object.keys(ne)])).sort().map(ue=>{var Ce,we,ze,$e,Ke,Ct;return{unit:ue,amountMy:Number(((Ce=ie[ue])==null?void 0:Ce.amount)??0),amountGlobal:Number(((we=ne[ue])==null?void 0:we.amount)??0),itemUnit:((ze=ie[ue])==null?void 0:ze.itemUnit)||(($e=ne[ue])==null?void 0:$e.itemUnit)||"",itemStdUnit:((Ke=ie[ue])==null?void 0:Ke.itemStdUnit)||((Ct=ne[ue])==null?void 0:Ct.itemStdUnit)||""}});Oa({open:!0,loading:!1,error:null,rows:he})}catch(k){Oa({open:!0,loading:!1,error:(k==null?void 0:k.message)||"조회 오류",rows:[]})}}function Wb(){Oa({open:!0,loading:!0,error:null,rows:[]});const k=Number(Y),z=Number.isFinite(k)&&k>0?k-1:new Date().getFullYear()-1,X=Math.max(2025,Math.min(2030,z));Tf(X),Bl("TNT")}function Bb(k){const z=k.target.value;ve(z)}function Of(){Oa(k=>({...k,open:!1}))}return c.useEffect(()=>{if(!Yn.open)return;const k=z=>{z.key==="Escape"&&Of()};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[Yn.open]),c.useEffect(()=>{Yn.open&&zr&&(Oa(k=>({...k,loading:!0})),zb())},[Yn.open,zr,hi]),c.useEffect(()=>{(async()=>{try{ms(ne=>({...ne,loading:!0,error:null}));const k=Number(Y),z=(localStorage.getItem("tnt.sales.assigneeId")||"").trim(),X=(localStorage.getItem("tnt.sales.empId")||"").trim();if(!Number.isFinite(k)||k<=0||!z&&!X){ms({tnt:0,dys:0,loading:!1,error:null});return}const te=new URL("/api/v1/sales/plan/totals-confirmed-by-assignee",window.location.origin);te.searchParams.set("year",String(k)),z?te.searchParams.set("assigneeId",z):X&&te.searchParams.set("empId",X);const Z=await fetch(te.toString());if(!Z.ok)throw new Error(`HTTP ${Z.status}`);const V=await Z.json().catch(()=>[]);let oe=0,ie=0;if(Array.isArray(V))for(const ne of V){const de=String((ne==null?void 0:ne.company_type)||(ne==null?void 0:ne.companyType)||"").toUpperCase(),he=Number((ne==null?void 0:ne.amount)||0);de==="TNT"?oe+=he:de==="DYS"&&(ie+=he)}ms({tnt:Math.round(oe),dys:Math.round(ie),loading:!1,error:null})}catch(k){ms({tnt:0,dys:0,loading:!1,error:(k==null?void 0:k.message)||"확정 합계 조회 오류"})}})()},[Y]),c.useEffect(()=>{if(!re.open)return;const k=z=>{z.key==="Escape"&&Lr()};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[re.open]),c.useEffect(()=>{if(!le.open)return;const k=z=>{z.key==="Escape"&&Re()};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[le.open]),c.useEffect(()=>{if(!vt.open)return;const k=z=>{z.key==="Escape"&&Rr()};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[vt.open]),c.useEffect(()=>{if(!Xe.open)return;const k=z=>{z.key==="Escape"&&fs()};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[Xe.open]),c.useEffect(()=>{if(!ct.open)return;const k=z=>{z.key==="Escape"&&ur()};return window.addEventListener("keydown",k,!0),()=>window.removeEventListener("keydown",k,!0)},[ct.open]),n.jsxs("section",{"aria-busy":kt||void 0,children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:18},children:"목표 Simulation"}),n.jsxs("div",{className:"muted count-text",style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[n.jsx("span",{style:{fontWeight:700},children:"현재목표"}),n.jsxs("span",{onClick:k=>na("TNT",k),style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #3b82f6",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent",cursor:"pointer"},title:"TNT 계획 합계 (클릭하여 상세)",children:[n.jsx("span",{style:{fontSize:12,color:"#3b82f6",fontWeight:700},children:"TNT"}),n.jsx("span",{style:{color:"#3b82f6"},children:Lt.format(He.tnt)}),n.jsx("span",{style:{fontSize:12,color:"#3b82f6"},children:"원"})]}),n.jsxs("span",{onClick:k=>na("DYS",k),style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #10b981",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent",cursor:"pointer"},title:"DYS 계획 합계 (클릭하여 상세)",children:[n.jsx("span",{style:{fontSize:12,color:"#10b981",fontWeight:700},children:"DYS"}),n.jsx("span",{style:{color:"#10b981"},children:Lt.format(He.dys)}),n.jsx("span",{style:{fontSize:12,color:"#10b981"},children:"원"})]}),n.jsx("span",{"aria-hidden":!0,style:{width:1,height:20,background:"var(--border)",display:"inline-block"}}),n.jsx("span",{style:{fontWeight:700},children:"목표확정"}),mi.loading?n.jsx("span",{className:"muted",style:{fontSize:12},children:"불러오는 중…"}):mi.error?n.jsx("span",{className:"error",style:{fontSize:12},children:mi.error}):n.jsxs(n.Fragment,{children:[n.jsxs("span",{title:"확정된 고객 합계 (TNT)",style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #3b82f6",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent"},children:[n.jsx("span",{style:{fontSize:12,color:"#3b82f6",fontWeight:700},children:"TNT"}),n.jsx("span",{style:{color:"#3b82f6"},children:Lt.format(mi.tnt)}),n.jsx("span",{style:{fontSize:12,color:"#3b82f6"},children:"원"})]}),n.jsxs("span",{title:"확정된 고객 합계 (DYS)",style:{display:"inline-flex",alignItems:"baseline",gap:8,padding:"6px 10px",border:"2px solid #10b981",borderRadius:999,fontWeight:800,fontSize:16,background:"transparent"},children:[n.jsx("span",{style:{fontSize:12,color:"#10b981",fontWeight:700},children:"DYS"}),n.jsx("span",{style:{color:"#10b981"},children:Lt.format(mi.dys)}),n.jsx("span",{style:{fontSize:12,color:"#10b981"},children:"원"})]})]}),n.jsx("button",{className:"btn-plain",title:"내 평균거래 단가",onClick:Wb,"aria-label":"평균거래 단가 팝업 열기",children:n.jsx("img",{src:Zp,className:"icon",alt:"단가"})}),P.toLocaleString(),"개 거래처"]})]}),n.jsxs("div",{className:"card",style:{padding:8,marginTop:8,display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[n.jsx("div",{className:"muted",children:"목표년도"}),n.jsxs("select",{className:"search-input",value:Y,onChange:Bb,"aria-label":"목표년도",style:{height:28},children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Ne().map(k=>n.jsxs("option",{value:String(k),children:[k,"년"]},k))]}),n.jsx("div",{className:"muted",style:{marginLeft:12},children:"가중치"}),n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[n.jsx("input",{className:"search-input",value:String(Wl),onChange:k=>{const z=Number((k.target.value||"").replace(/[^0-9]/g,""));Number.isFinite(z)&&Rb(Math.max(0,Math.min(999,z)))},inputMode:"numeric","aria-label":"가중치(%)",style:{width:72,height:28,textAlign:"right"}}),n.jsx("span",{className:"muted",children:"%"})]})]}),(()=>{const k=!!(U.hasC&&!U.hasP&&!U.hasI),z=!!(U.hasI&&!U.hasP&&!U.hasC),X=!!(U.hasP||U.hasC&&U.hasI),te=k?"목표수립완료":z?"초기설정완료":X?"계획수립 중":"초기설정",Z=k||z||X,V=Z||kt?{opacity:.6,cursor:"not-allowed",background:"var(--border)",color:"var(--muted)"}:void 0;return n.jsx("button",{className:"btn btn-card btn-3d",onClick:Fb,disabled:Z||kt,style:V,children:te})})(),Y?U.show?n.jsxs("div",{className:"muted",style:{display:"inline-flex",alignItems:"center",gap:6,flexWrap:"wrap",fontSize:12},children:[n.jsxs("span",{style:{fontSize:12},children:[U.name,"님"]}),n.jsxs("span",{style:{color:Ot,fontWeight:700,fontSize:14,whiteSpace:"pre"},children:[U.year,"년"]}),n.jsx("span",{style:{fontSize:12},children:" "}),n.jsxs("span",{style:{color:Ot,fontWeight:700,fontSize:14},children:["TNT ",U.tnt.toLocaleString(),"개"]}),n.jsx("span",{style:{fontSize:12},children:","}),n.jsxs("span",{style:{color:Ot,fontWeight:700,fontSize:14},children:[" DYS ",U.dys.toLocaleString(),"개"]}),n.jsx("span",{style:{fontSize:12},children:U.label||""})]}):ae?n.jsxs("div",{className:"muted",style:{display:"inline-flex",alignItems:"center",gap:6,flexWrap:"wrap",fontSize:12},children:[n.jsxs("span",{style:{fontSize:12},children:[$b,"님,"]}),n.jsx("span",{style:{color:Ot,fontWeight:700,fontSize:14},children:Db}),n.jsx("span",{style:{fontSize:12},children:"매출 기준으로 담당 거래처"}),n.jsx("span",{style:{color:Ot,fontWeight:700,fontSize:14},children:"TNT"}),n.jsx("span",{style:{color:Ot,fontWeight:700,fontSize:14},children:pe.tnt.toLocaleString()}),n.jsx("span",{style:{fontSize:12},children:"개,"}),n.jsx("span",{style:{color:Ot,fontWeight:700,fontSize:14},children:"DYS"}),n.jsx("span",{style:{color:Ot,fontWeight:700,fontSize:14},children:pe.dys.toLocaleString()}),n.jsx("span",{style:{fontSize:12},children:"개에 대해"}),n.jsxs("span",{style:{color:Ot,fontWeight:700,fontSize:14},children:[Wl,"%"]}),n.jsx("span",{style:{fontSize:12},children:"추가하여 목표 설정합니다."})]}):null:null,n.jsx("div",{className:"muted",style:{marginLeft:"auto"},children:_a.loading?"요약 불러오는 중…":_a.error?n.jsx("span",{className:"error",children:_a.error}):n.jsxs(n.Fragment,{children:["수립대상 ",_a.total.toLocaleString(),"개, 확정 ",_a.confirmed.toLocaleString(),"개, 진행 중 ",_a.inprogress.toLocaleString(),"개"]})})]}),ct.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"transparent",zIndex:60},children:n.jsxs("div",{ref:zl.ref,className:"card",style:{...zl.style,width:720,maxWidth:"92vw",background:"var(--panel)",padding:12,fontSize:12},children:[n.jsx("div",{...zl.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:ur,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{className:"page-title",style:{marginBottom:8,alignItems:"center"},children:[n.jsxs("h2",{style:{margin:0},children:[ct.company," 계획 합계 상세"]}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[n.jsx("input",{type:"radio",name:"totals-group",checked:ct.group==="customer",onChange:()=>{Tt(k=>({...k,group:"customer"})),Mn(ct.company,"customer")}}),"거래처별"]}),n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[n.jsx("input",{type:"radio",name:"totals-group",checked:ct.group==="unit",onChange:()=>{Tt(k=>({...k,group:"unit"})),Mn(ct.company,"unit")}}),"영업관리단위별"]})]})]}),ct.error?n.jsx("div",{className:"error",children:ct.error}):null,n.jsx("div",{className:"table-container",style:{maxHeight:"66vh",overflow:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left",width:380},children:ct.group==="customer"?"거래처":"영업관리단위"}),n.jsx("th",{style:{textAlign:"right",width:200},children:"금액(원)"})]})}),n.jsx("tbody",{children:ct.loading?n.jsx("tr",{children:n.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"불러오는 중…"})}):ct.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):ct.rows.map((k,z)=>{const X=ct.group==="customer"&&k.label||k.key;return n.jsxs("tr",{children:[n.jsx("td",{children:X}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Lt.format(Math.round(k.amount))})]},z)})})]})})]})}),ta?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:80,display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:280,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:ta}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>vn(null),children:"확인"})})]})}):null,n.jsx("div",{className:"c360-tabs",role:"tablist","aria-label":"회사 구분 탭",style:{marginTop:8},children:["TNT","DYS"].map(k=>n.jsx("button",{role:"tab","aria-selected":tr===k,className:`tab ${tr===k?"active":""}`,onClick:()=>{xn(k);try{R(k)}catch{}},children:k},k))}),tr==="TNT"?n.jsxs(n.Fragment,{children:[d&&n.jsx("div",{className:"error",children:d||ot.errorGeneric}),n.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[n.jsxs("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:[n.jsx("div",{className:"card",style:{padding:8,marginBottom:8},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{className:"search-input",placeholder:"거래처명",value:m,onChange:k=>p(k.target.value),onKeyDown:k=>{k.key==="Enter"&&sa(!0)},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:()=>sa(!0),disabled:o,style:{flex:"0 0 auto"},children:"조회"})]})}),Y?If:n.jsx("div",{className:"muted",style:{padding:"12px 10px"},children:"연도를 먼저 선택하세요."})]}),n.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[n.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:ge.map((k,z)=>{const X=z<je,te=z===je;return n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:z===ge.length-1?"0 0 auto":"1 1 0"},children:[n.jsx("div",{title:k.label,onClick:()=>D(k.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:X||te?"var(--accent)":"transparent",border:`2px solid ${X||te?"var(--accent)":"var(--border)"}`,color:X||te?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":te?"step":void 0,children:X?"✓":z+1}),n.jsx("div",{style:{fontSize:12,color:te||X?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:k.label}),z<ge.length-1&&n.jsx("div",{style:{height:2,background:z<je?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},k.key)})}),n.jsx("div",{children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:Ta,disabled:!(w!=null&&w.customerSeq)||!Y,title:"해당 거래처 목표 확정",children:"확정"})})]}),w!=null&&w.customerSeq&&Y?n.jsxs("div",{className:"card",style:{marginBottom:12,padding:8},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginBottom:8,gap:8,flexWrap:"wrap"},children:[n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:mn,children:"일괄비율"}),n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:Pe,children:"일괄입력"}),n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:Pf,children:"신규 영업관리단위"})]}),at.error?n.jsx("div",{className:"error",children:at.error}):n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left",width:220},children:"중분류"}),n.jsx("th",{style:{textAlign:"left",width:220},children:"영업관리단위"}),n.jsx("th",{style:{textAlign:"center",width:120},children:"목표입력"}),n.jsx("th",{className:"sum-head",style:{textAlign:"right",width:140},children:"합계"}),Array.from({length:12},(k,z)=>z+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:at.rows.length===0?n.jsx("tr",{children:n.jsx("td",{className:"muted",colSpan:16,style:{padding:"12px 10px"},children:at.loading?"불러오는 중…":"데이터가 없습니다"})}):at.rows.map((k,z)=>{const X=(k.months||[]).reduce((Z,V)=>Z+(Number.isFinite(V)?Number(V):0),0),te=(k.amounts||[]).reduce((Z,V)=>Z+(Number.isFinite(V)?Number(V):0),0);return n.jsxs("tr",{children:[n.jsx("td",{children:k.sub}),n.jsxs("td",{children:[n.jsx("span",{children:k.unit}),k.stage?n.jsx("span",{className:"stage-badge",style:{marginLeft:6},title:String(k.stage),children:k.stage}):null]}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx("button",{type:"button",className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:Z=>{Z.preventDefault(),Z.stopPropagation(),$r(k.sub,k.unit)},children:"입력"})}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(X,0,te)}),k.months.map((Z,V)=>{var oe;return n.jsx("td",{style:{textAlign:"right"},children:Qe(Z,V,(oe=k.amounts)==null?void 0:oe[V],k.stage==="P"?"#dc2626":void 0,k.stage==="C")},V)})]},z)})}),(()=>{if(!at.rows||at.rows.length===0)return null;const k=Array.from({length:12},(Z,V)=>at.rows.reduce((oe,ie)=>{var ne;return oe+(Number((ne=ie.months)==null?void 0:ne[V])||0)},0)),z=Array.from({length:12},(Z,V)=>at.rows.reduce((oe,ie)=>{var ne;return oe+(Number((ne=ie.amounts)==null?void 0:ne[V])||0)},0)),X=k.reduce((Z,V)=>Z+(Number(V)||0),0),te=z.reduce((Z,V)=>Z+(Number(V)||0),0);return n.jsx("tfoot",{children:n.jsxs("tr",{className:"sum-row",children:[n.jsx("td",{colSpan:3,style:{textAlign:"center",fontWeight:700},children:"합계"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(X,0,te)}),k.map((Z,V)=>n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(Z,V,z[V])},V))]})})})()]})})]}):null]})]})]}):n.jsxs(n.Fragment,{children:[d&&n.jsx("div",{className:"error",children:d||ot.errorGeneric}),n.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[n.jsxs("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:[n.jsx("div",{className:"card",style:{padding:8,marginBottom:8},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{className:"search-input",placeholder:"거래처명",value:m,onChange:k=>p(k.target.value),onKeyDown:k=>{k.key==="Enter"&&sa(!0)},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:()=>sa(!0),disabled:o,style:{flex:"0 0 auto"},children:"조회"})]})}),Y?If:n.jsx("div",{className:"muted",style:{padding:"12px 10px"},children:"연도를 먼저 선택하세요."})]}),n.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[n.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:ge.map((k,z)=>{const X=z<je,te=z===je;return n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:z===ge.length-1?"0 0 auto":"1 1 0"},children:[n.jsx("div",{title:k.label,onClick:()=>D(k.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:X||te?"var(--accent)":"transparent",border:`2px solid ${X||te?"var(--accent)":"var(--border)"}`,color:X||te?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":te?"step":void 0,children:X?"✓":z+1}),n.jsx("div",{style:{fontSize:12,color:te||X?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:k.label}),z<ge.length-1&&n.jsx("div",{style:{height:2,background:z<je?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},k.key)})}),n.jsx("div",{children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:Ta,disabled:!(w!=null&&w.customerSeq)||!Y,title:"해당 거래처 목표 확정",children:"확정"})})]}),w!=null&&w.customerSeq&&Y?n.jsxs("div",{className:"card",style:{marginBottom:12,padding:8},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",marginBottom:8,gap:8,flexWrap:"wrap"},children:[n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:mn,children:"일괄비율"}),n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:Pe,children:"일괄입력"}),n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:Pf,children:"신규 영업관리단위"})]}),at.error?n.jsx("div",{className:"error",children:at.error}):n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left",width:220},children:"중분류"}),n.jsx("th",{style:{textAlign:"left",width:220},children:"영업관리단위"}),n.jsx("th",{style:{textAlign:"center",width:120},children:"목표입력"}),n.jsx("th",{className:"sum-head",style:{textAlign:"right",width:140},children:"합계"}),Array.from({length:12},(k,z)=>z+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:at.rows.length===0?n.jsx("tr",{children:n.jsx("td",{className:"muted",colSpan:16,style:{padding:"12px 10px"},children:at.loading?"불러오는 중…":"데이터가 없습니다"})}):at.rows.map((k,z)=>{const X=(k.months||[]).reduce((Z,V)=>Z+(Number.isFinite(V)?Number(V):0),0),te=(k.amounts||[]).reduce((Z,V)=>Z+(Number.isFinite(V)?Number(V):0),0);return n.jsxs("tr",{children:[n.jsx("td",{children:k.sub}),n.jsxs("td",{children:[n.jsx("span",{children:k.unit}),k.stage?n.jsx("span",{className:"badge stage-badge",style:{marginLeft:6},children:k.stage}):null]}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx("button",{type:"button",className:"btn btn-card btn-3d",style:{fontSize:12,padding:"4px 8px"},onClick:Z=>{Z.preventDefault(),Z.stopPropagation(),$r(k.sub,k.unit)},children:"입력"})}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(X,0,te)}),k.months.map((Z,V)=>{var oe;return n.jsx("td",{style:{textAlign:"right"},children:Qe(Z,V,(oe=k.amounts)==null?void 0:oe[V],k.stage==="P"?"#dc2626":void 0,k.stage==="C")},V)})]},z)})}),(()=>{if(!at.rows||at.rows.length===0)return null;const k=Array.from({length:12},(Z,V)=>at.rows.reduce((oe,ie)=>{var ne;return oe+(Number((ne=ie.months)==null?void 0:ne[V])||0)},0)),z=Array.from({length:12},(Z,V)=>at.rows.reduce((oe,ie)=>{var ne;return oe+(Number((ne=ie.amounts)==null?void 0:ne[V])||0)},0)),X=k.reduce((Z,V)=>Z+(Number(V)||0),0),te=z.reduce((Z,V)=>Z+(Number(V)||0),0);return n.jsx("tfoot",{children:n.jsxs("tr",{className:"sum-row",children:[n.jsx("td",{colSpan:3,style:{textAlign:"center",fontWeight:700},children:"합계"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(X,0,te)}),k.map((Z,V)=>n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(Z,V,z[V])},V))]})})})()]})})]}):null,w!=null&&w.customerSeq&&Y?n.jsxs("div",{className:"card",style:{marginBottom:12,padding:8},children:[n.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:8},children:[n.jsx("div",{className:"muted",style:{fontWeight:700,lineHeight:"28px",fontSize:14},children:"목표수립의견"}),n.jsx("textarea",{className:"search-input",value:hn.val,onChange:k=>an(z=>({...z,val:k.target.value})),placeholder:"목표수립에 대한 의견을 입력하세요",rows:6,style:{flex:1,resize:"vertical",height:80,minHeight:80,fontSize:12}})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"flex-end",gap:8,marginTop:8},children:[hn.loading?n.jsx("span",{className:"muted",style:{fontSize:12},children:"(읽는 중…)"}):null,hn.error?n.jsx("span",{className:"error",style:{fontSize:12},children:hn.error}):null,hn.success?n.jsx("span",{style:{fontSize:12,color:"var(--accent)",fontWeight:700},children:hn.success}):null,n.jsx("button",{className:"btn btn-card btn-3d",onClick:Ia,disabled:hn.saving,children:hn.saving?"저장중…":"저장"})]})]}):null]})]})]}),re.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:on.ref,className:"card compact",style:{...on.style,position:"relative",width:900,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[n.jsx("div",{...on.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:Lr,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1.6fr 120px 1fr",gap:8,alignItems:"center"},children:[n.jsx("div",{className:"muted form-label",children:"영업관리단위"}),n.jsx("div",{children:re.unit||""}),n.jsx("div",{className:"muted form-label",children:"중분류"}),n.jsx("div",{children:re.sub||""}),n.jsx("div",{className:"muted form-label",children:"매출 수량"}),n.jsx("div",{style:{gridColumn:"2 / 5"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,flexWrap:"nowrap",minWidth:0},children:[n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:re.qty||"",onChange:k=>cs(re.month,k.target.value)}),(()=>{const k=Ue(),z=(re.unit||"").trim(),X=qe(z),te=ye[k]||{},Z=Number(te[X]||0),V=it(),oe=(ce==null?void 0:ce[V])||{},ie=Number(oe[X]||0),ne=Number.isFinite(Z)&&Z>0?Lt.format(Math.round(Z)):"-",de=Number.isFinite(ie)&&ie>0?Lt.format(Math.round(ie)):"-",he=Number.isFinite(Z)&&Number.isFinite(ie)?Z>=ie?Ot:"#dc2626":Ot;return n.jsxs("span",{className:"muted",style:{fontSize:12,whiteSpace:"nowrap"},children:[n.jsxs("span",{style:{color:he,fontWeight:700},children:["내단가 ",ne," 원"]})," | 전체단가 ",de," 원/단위"]})})()]})}),n.jsx("div",{className:"muted form-label",children:"매출월"}),n.jsx("div",{children:n.jsxs("select",{className:"search-input",value:re.month||"",onChange:k=>cs(k.target.value,re.qty),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(k,z)=>z+1).map(k=>n.jsxs("option",{value:String(k),children:[k,"월"]},k))]})})]}),n.jsxs("div",{style:{marginTop:12},children:[n.jsx("div",{className:"pane-header",style:{margin:0},children:"현재 목표"}),n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(k,z)=>z+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:n.jsx("tr",{children:(()=>{const k=(re.curMonths||[]).reduce((X,te)=>X+(Number.isFinite(te)?Number(te):0),0),z=(re.curAmounts||[]).reduce((X,te)=>X+(Number.isFinite(te)?Number(te):0),0);return n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(k,0,z)}),re.curMonths.map((X,te)=>{var Z;return n.jsx("td",{children:Qe(X,te,(Z=re.curAmounts)==null?void 0:Z[te],re.stage==="P"?"#dc2626":void 0,re.stage==="C")},te)})]})})()})})]})})]}),n.jsxs("div",{style:{marginTop:12},children:[n.jsx("div",{className:"pane-header",style:{margin:0},children:"분배 미리보기"}),n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(k,z)=>z+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:n.jsx("tr",{children:(()=>{const k=Ue();ye[k];const z=(re.unit||"").trim(),X=Ye(z),te=Number.isFinite(X)?Number(X):0,Z=(re.dist||[]).reduce((ie,ne)=>ie+(Number.isFinite(ne)?Number(ne):0),0),V=Number.isFinite(te)?Math.round(te):0,oe=(re.dist||[]).reduce((ie,ne)=>ie+(Number.isFinite(ne)&&V>0?Number(ne)*V:0),0);return n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(Z,0,oe)}),re.dist.map((ie,ne)=>{const de=Number.isFinite(te)?Math.round(te):0,he=Number.isFinite(ie)&&de>0?Number(ie)*de:void 0;return n.jsx("td",{children:Qe(ie,ne,he,re.stage==="P"?"#dc2626":void 0,re.stage==="C")},ne)})]})})()})})]})})]}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:ds,children:"목표등록"})}),re.success?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:re.success}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:G,children:"확인"})})]})}):null]})}),le.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:Ge.ref,className:"card compact",style:{...Ge.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[n.jsx("div",{...Ge.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:Re,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h2",{style:{margin:0},children:"목표 일괄입력"})}),n.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto",position:"relative"},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:68,textAlign:"center"},children:"구분"}),n.jsx("th",{style:{width:160,textAlign:"left"},children:"내 평균단가"}),n.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(k,z)=>z+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:le.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:19,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):le.rows.map((k,z)=>{const X=Ue();ye[X];const te=Ye((k.unit||"").trim()),Z=Number.isFinite(te)?Number(te):0,V=Number(k.month||0),oe=Number(k.qty||0),ie=new Array(12).fill(0);if(Number.isFinite(V)&&V>=1&&V<=12&&Number.isFinite(oe)&&oe>0){const we=12-V+1,ze=oe/we;for(let $e=V-1;$e<12;$e++)ie[$e]=ze}const ne=ie,de=(k.curMonths||[]).reduce((we,ze)=>we+(Number.isFinite(ze)?Number(ze):0),0),he=(k.curAmounts||[]).reduce((we,ze)=>we+(Number.isFinite(ze)?Number(ze):0),0),ue=ie.reduce((we,ze)=>we+(Number.isFinite(ze)?Number(ze):0),0),Ce=ie.reduce((we,ze)=>we+(Number.isFinite(ze)&&Number.isFinite(Z)?Number(ze)*Z:0),0);return n.jsxs(n.Fragment,{children:[n.jsxs("tr",{children:[n.jsx("td",{children:n.jsx("span",{style:{fontSize:12},children:k.sub})}),n.jsxs("td",{children:[n.jsx("span",{style:{fontSize:12},children:k.unit}),k.stage?n.jsx("span",{className:"stage-badge",style:{marginLeft:6},title:String(k.stage),children:String(k.stage)}):null]}),n.jsx("td",{style:{textAlign:"center"},className:"muted",children:"현재"}),n.jsx("td",{className:"muted",children:"-"}),n.jsx("td",{className:"muted",children:"-"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(de,0,he)}),k.curMonths.map((we,ze)=>{var $e;return n.jsx("td",{children:Qe(we,ze,($e=k.curAmounts)==null?void 0:$e[ze],k.stage==="P"?"#dc2626":void 0,k.stage==="C")},ze)})]},k.key+":cur"),n.jsxs("tr",{style:{background:"var(--panel-2)"},children:[n.jsx("td",{}),n.jsx("td",{}),n.jsx("td",{style:{textAlign:"center"},className:"sum-head",children:"적용"}),n.jsx("td",{children:n.jsxs("select",{className:"search-input",value:k.month||"",onChange:we=>Ae(z,we.target.value,void 0),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(we,ze)=>ze+1).map(we=>n.jsxs("option",{value:String(we),children:[we,"월"]},we))]})}),n.jsx("td",{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:k.qty||"",onChange:we=>Ae(z,void 0,we.target.value)}),(()=>{var _f;const we=Ue(),$e=(((_f=(Se[we]||{})[(k.unit||"").trim()])==null?void 0:_f.itemStdUnit)||"").trim(),Ke=qe(k.unit||""),Ct=ye[we]||{},nt=Number(Ct[Ke]||0),Dn=it(),$n=(ce==null?void 0:ce[Dn])||{},Gn=Number($n[Ke]||0),mr=Number.isFinite(nt)&&nt>0?Lt.format(Math.round(nt)):"-",ql=Number.isFinite(Gn)&&Gn>0?Lt.format(Math.round(Gn)):"-",qb=Number.isFinite(nt)&&Number.isFinite(Gn)?nt>=Gn?Ot:"#dc2626":Ot;return n.jsxs("span",{className:"muted",style:{fontSize:12},children:[n.jsxs("span",{style:{color:qb,fontWeight:700},children:["내단가 ",mr," 원"]})," | 전체단가 ",ql," 원/",$e||"단위"]})})()]})}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(ue,0,Ce)}),ne.map((we,ze)=>{const $e=Number.isFinite(Z)?Math.round(Z):0,Ke=Number.isFinite(we)&&$e>0?Number(we)*$e:void 0;return n.jsx("td",{children:Qe(we,ze,Ke,k.stage==="P"?"#dc2626":void 0,k.stage==="C")},ze)})]},k.key+":prev")]})})}),(()=>{if(!le.rows||le.rows.length===0)return null;const k=Ue();ye[k];const z=Array.from({length:12},(de,he)=>le.rows.reduce((ue,Ce)=>{var we;return ue+(Number((we=Ce.curMonths)==null?void 0:we[he])||0)},0)),X=Array.from({length:12},(de,he)=>le.rows.reduce((ue,Ce)=>{var we;return ue+(Number((we=Ce.curAmounts)==null?void 0:we[he])||0)},0)),te=z.reduce((de,he)=>de+(Number(he)||0),0),Z=X.reduce((de,he)=>de+(Number(he)||0),0),V=Array.from({length:12},(de,he)=>le.rows.reduce((ue,Ce)=>{var we;return ue+(Number((we=Ce.dist)==null?void 0:we[he])||0)},0)),oe=Array.from({length:12},(de,he)=>le.rows.reduce((ue,Ce)=>{var Ke;const we=Ye((Ce.unit||"").trim()),ze=Number.isFinite(we)?Math.round(Number(we)):0,$e=Number(((Ke=Ce.dist)==null?void 0:Ke[he])||0);return ue+(Number.isFinite($e)&&ze>0?$e*ze:0)},0)),ie=V.reduce((de,he)=>de+(Number(he)||0),0),ne=oe.reduce((de,he)=>de+(Number(he)||0),0);return n.jsxs("tfoot",{children:[n.jsxs("tr",{className:"sum-row-current",children:[n.jsx("td",{colSpan:5,style:{textAlign:"center",fontWeight:700},children:"[현재] 합계"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(te,0,Z)}),z.map((de,he)=>n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(de,he,X[he])},he))]}),n.jsxs("tr",{className:"sum-row-apply",style:{background:"var(--panel-2)"},children:[n.jsx("td",{colSpan:5,style:{textAlign:"center",fontWeight:700},children:"[적용] 합계"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(ie,0,ne)}),V.map((de,he)=>n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(de,he,oe[he])},he))]})]})})()]})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:Ee,children:"목표등록"})}),le.success?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"absolute",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:80},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:le.success}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:G,children:"확인"})})]})}):null]})}),vt.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:ui.ref,className:"card compact",style:{...ui.style,width:"92vw",maxWidth:1100,background:"var(--panel)",padding:12},children:[n.jsx("div",{...ui.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:Rr,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{className:"page-title",style:{marginBottom:8,alignItems:"center"},children:[n.jsx("h2",{style:{margin:0},children:"목표 일괄비율"}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsx("span",{className:"muted",children:"적용 비율(%)"}),n.jsx("input",{className:"assign-input",type:"number",min:0,max:100,step:1,placeholder:"0",value:di,onChange:k=>us(k.target.value),style:{width:100},"aria-label":"일괄 비율 입력"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:rr,children:"적용"})]})]}),n.jsx("div",{className:"table-container",style:{maxHeight:"70vh",overflow:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:68,textAlign:"center"},children:"구분"}),n.jsx("th",{style:{width:160,textAlign:"left"},children:"내 평균단가"}),n.jsx("th",{className:"sum-head",style:{textAlign:"right",width:120},children:"합계"}),Array.from({length:12},(k,z)=>z+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:vt.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:19,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):vt.rows.map((k,z)=>{const X=Ue();ye[X];const te=Ye((k.unit||"").trim()),Z=Number.isFinite(te)?Number(te):0,V=Array.isArray(k.dist)?k.dist.slice():new Array(12).fill(0),oe=(k.curMonths||[]).reduce((he,ue)=>he+(Number.isFinite(ue)?Number(ue):0),0),ie=(k.curAmounts||[]).reduce((he,ue)=>he+(Number.isFinite(ue)?Number(ue):0),0),ne=V.reduce((he,ue)=>he+(Number.isFinite(ue)?Number(ue):0),0),de=V.reduce((he,ue)=>he+(Number.isFinite(ue)&&Number.isFinite(Z)?Number(ue)*Z:0),0);return n.jsxs(n.Fragment,{children:[n.jsxs("tr",{children:[n.jsx("td",{children:n.jsx("span",{style:{fontSize:12},children:k.sub})}),n.jsxs("td",{children:[n.jsx("span",{style:{fontSize:12},children:k.unit}),k.stage?n.jsx("span",{className:"stage-badge",style:{marginLeft:6},title:String(k.stage),children:String(k.stage)}):null]}),n.jsx("td",{style:{textAlign:"center"},className:"muted",children:"현재"}),n.jsx("td",{className:"muted",style:{textAlign:"left"},children:(()=>{var mr;const he=Ue(),Ce=(((mr=(Se[he]||{})[(k.unit||"").trim()])==null?void 0:mr.itemStdUnit)||"").trim(),we=qe(k.unit||""),ze=ye[he]||{},$e=Number(ze[we]||0),Ke=it(),Ct=(ce==null?void 0:ce[Ke])||{},nt=Number(Ct[we]||0),Dn=Number.isFinite($e)&&$e>0?Lt.format(Math.round($e)):"-",$n=Number.isFinite(nt)&&nt>0?Lt.format(Math.round(nt)):"-",Gn=Number.isFinite($e)&&Number.isFinite(nt)?$e>=nt?Ot:"#dc2626":Ot;return n.jsxs("span",{children:[n.jsxs("span",{style:{color:Gn,fontWeight:700},children:["내단가 ",Dn," 원"]})," | 전체단가 ",$n," 원/",Ce||"단위"]})})()}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(oe,0,ie)}),k.curMonths.map((he,ue)=>{var Ce;return n.jsx("td",{children:Qe(he,ue,(Ce=k.curAmounts)==null?void 0:Ce[ue],k.stage==="P"?"#dc2626":void 0,k.stage==="C")},ue)})]},k.key+":cur"),n.jsxs("tr",{style:{background:"var(--panel-2)"},children:[n.jsx("td",{}),n.jsx("td",{}),n.jsx("td",{style:{textAlign:"center"},className:"sum-head",children:"적용"}),n.jsx("td",{className:"muted",style:{textAlign:"left"},children:(()=>{var mr;const he=Ue(),Ce=(((mr=(Se[he]||{})[(k.unit||"").trim()])==null?void 0:mr.itemStdUnit)||"").trim(),we=qe(k.unit||""),ze=ye[he]||{},$e=Number(ze[we]||0),Ke=it(),Ct=(ce==null?void 0:ce[Ke])||{},nt=Number(Ct[we]||0),Dn=Number.isFinite($e)&&$e>0?Lt.format(Math.round($e)):"-",$n=Number.isFinite(nt)&&nt>0?Lt.format(Math.round(nt)):"-",Gn=Number.isFinite($e)&&Number.isFinite(nt)?$e>=nt?Ot:"#dc2626":Ot;return n.jsxs("span",{children:[n.jsxs("span",{style:{color:Gn,fontWeight:700},children:["내단가 ",Dn," 원"]})," | 전체단가 ",$n," 원/",Ce||"단위"]})})()}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(ne,0,de)}),V.map((he,ue)=>{const Ce=Number.isFinite(Z)?Math.round(Z):0,we=Number.isFinite(he)&&Ce>0?Number(he)*Ce:void 0;return n.jsx("td",{children:Qe(he,ue,we,k.stage==="P"?"#dc2626":void 0,k.stage==="C")},ue)})]},k.key+":prev")]})})}),(()=>{if(!vt.rows||vt.rows.length===0)return null;const k=Ue();ye[k];const z=Array.from({length:12},(de,he)=>vt.rows.reduce((ue,Ce)=>{var we;return ue+(Number((we=Ce.curMonths)==null?void 0:we[he])||0)},0)),X=Array.from({length:12},(de,he)=>vt.rows.reduce((ue,Ce)=>{var we;return ue+(Number((we=Ce.curAmounts)==null?void 0:we[he])||0)},0)),te=z.reduce((de,he)=>de+(Number(he)||0),0),Z=X.reduce((de,he)=>de+(Number(he)||0),0),V=Array.from({length:12},(de,he)=>vt.rows.reduce((ue,Ce)=>{var we;return ue+(Number((we=Ce.dist)==null?void 0:we[he])||0)},0)),oe=Array.from({length:12},(de,he)=>vt.rows.reduce((ue,Ce)=>{var Ke;const we=Ye((Ce.unit||"").trim()),ze=Number.isFinite(we)?Math.round(Number(we)):0,$e=Number(((Ke=Ce.dist)==null?void 0:Ke[he])||0);return ue+(Number.isFinite($e)&&ze>0?$e*ze:0)},0)),ie=V.reduce((de,he)=>de+(Number(he)||0),0),ne=oe.reduce((de,he)=>de+(Number(he)||0),0);return n.jsxs("tfoot",{children:[n.jsxs("tr",{className:"sum-row-current",children:[n.jsx("td",{colSpan:4,style:{textAlign:"center",fontWeight:700},children:"[현재] 합계"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(te,0,Z)}),z.map((de,he)=>n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(de,he,X[he])},he))]}),n.jsxs("tr",{className:"sum-row-apply",style:{background:"var(--panel-2)"},children:[n.jsx("td",{colSpan:4,style:{textAlign:"center",fontWeight:700},children:"[적용] 합계"}),n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(ie,0,ne)}),V.map((de,he)=>n.jsx("td",{className:"sum-cell",style:{textAlign:"right"},children:Qe(de,he,oe[he])},he))]})]})})()]})}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:Rl,children:"목표등록"})}),vt.success?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:vt.success}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:G,children:"확인"})})]})}):null]})}),Xe.open&&n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.35)",zIndex:50},children:n.jsxs("div",{ref:fi.ref,className:"card",style:{...fi.style,width:984,maxWidth:"92vw",background:"var(--panel)",padding:12},children:[n.jsx("div",{...fi.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:fs,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h2",{style:{margin:0},children:"신규 영업관리단위"})}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr 120px 1fr",gap:8,alignItems:"center",fontSize:12},children:[n.jsx("div",{className:"muted",children:"영업관리단위"}),n.jsx("div",{children:n.jsxs("select",{className:"search-input",value:Xe.unit||"",onChange:k=>Ob(k.target.value),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Xe.opts.map((k,z)=>n.jsx("option",{value:k.salesMgmtUnit,children:k.salesMgmtUnit},z))]})}),n.jsx("div",{className:"muted",children:"중분류"}),n.jsx("div",{children:n.jsx("input",{className:"assign-input",value:Xe.sub||"",readOnly:!0,placeholder:"자동"})}),n.jsx("div",{className:"muted",children:"매출월"}),n.jsx("div",{children:n.jsxs("select",{className:"search-input",value:Xe.month||"",onChange:k=>Ef(k.target.value,void 0),children:[n.jsx("option",{value:"",disabled:!0,children:"선택"}),Array.from({length:12},(k,z)=>z+1).map(k=>n.jsxs("option",{value:String(k),children:[k,"월"]},k))]})}),n.jsx("div",{className:"muted",children:"매출 수량"}),n.jsx("div",{children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{className:"assign-input",type:"number",min:0,step:1,placeholder:"0",value:Xe.qty||"",onChange:k=>Ef(void 0,k.target.value)}),(()=>{var we;const k=Ue(),z=ye[k]||{},X=Se[k]||{},te=(Xe.unit||"").trim(),Z=qe(te),V=Number((z==null?void 0:z[Z])||0),oe=it(),ie=(ce==null?void 0:ce[oe])||{},ne=Number(ie[Z]||0),de=(((we=X[te])==null?void 0:we.itemStdUnit)||"").trim(),he=Number.isFinite(V)&&V>0?Lt.format(Math.round(V)):"-",ue=Number.isFinite(ne)&&ne>0?Lt.format(Math.round(ne)):"-",Ce=Number.isFinite(V)&&Number.isFinite(ne)?V>=ne?Ot:"#dc2626":Ot;return n.jsxs("span",{className:"muted",style:{fontSize:12,whiteSpace:"nowrap"},children:[n.jsxs("span",{style:{color:Ce,fontWeight:700},children:["내단가 ",he," 원"]})," | 전체단가 ",ue," 원/",de||"단위"]})})()]})})]}),n.jsx("div",{style:{marginTop:12},children:n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsx("tr",{children:Array.from({length:12},(k,z)=>z+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))})}),n.jsx("tbody",{children:n.jsx("tr",{children:Xe.dist.map((k,z)=>{const X=Ue();ye[X];const te=Ye((Xe.unit||"").trim()),Z=Number.isFinite(te)?Number(te):0,V=Number.isFinite(Z)?Math.round(Z):0,oe=Number.isFinite(k)&&V>0?Number(k)*V:void 0;return n.jsx("td",{children:Qe(k,z,oe)},z)})})})]})})}),n.jsxs("div",{style:{marginTop:12},children:[n.jsx("div",{className:"pane-header",style:{margin:0},children:"추가된 영업관리단위"}),n.jsx("div",{className:"table-container",children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200,textAlign:"left"},children:"중분류"}),n.jsx("th",{style:{width:220,textAlign:"left"},children:"영업관리단위"}),Array.from({length:12},(k,z)=>z+1).map(k=>n.jsxs("th",{style:{textAlign:"right"},children:[String(k).padStart(2,"0"),"월"]},k))]})}),n.jsx("tbody",{children:Xe.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:14,className:"muted",style:{padding:"12px 10px"},children:"추가된 영업관리단위가 없습니다"})}):Xe.rows.map((k,z)=>n.jsxs("tr",{children:[n.jsxs("td",{children:[n.jsx("button",{className:"btn-plain","aria-label":"삭제",title:"삭제",onClick:()=>kn(X=>({...X,rows:X.rows.filter((te,Z)=>Z!==z)})),style:{marginRight:6,verticalAlign:"middle"},children:n.jsx("img",{src:Pt,className:"icon",alt:"삭제"})}),k.sub]}),n.jsx("td",{children:k.unit}),k.months.map((X,te)=>{const Z=Ue();ye[Z];const V=Ye((k.unit||"").trim()),oe=Number.isFinite(V)?Number(V):0,ie=Number.isFinite(oe)?Math.round(oe):0,ne=Number.isFinite(X)&&ie>0?Number(X)*ie:void 0;return n.jsx("td",{children:Qe(X,te,ne)},te)})]},z))})]})})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8,gap:8},children:[n.jsx("button",{className:"btn btn-card btn-3d",onClick:_b,children:"추가"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:Mb,children:"목표등록"})]}),Xe.error?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:Xe.error}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>kn(k=>({...k,error:null})),children:"확인"})})]})}):null,Xe.success?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:Xe.success}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:G,children:"확인"})})]})}):null]})}),Yn.open&&n.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:60},children:n.jsxs("div",{ref:Fl.ref,className:"card",style:{...Fl.style,height:"66vh",width:760,maxWidth:"96vw",background:"var(--panel)",padding:12,borderLeft:"1px solid var(--border)",boxShadow:"-8px 0 24px rgba(0,0,0,0.18)",overflow:"hidden"},children:[n.jsx("div",{...Fl.bindHeader,style:{position:"absolute",top:0,left:0,right:36,height:32,cursor:"move"},"aria-hidden":"true"}),n.jsx("button",{"aria-label":"닫기",onClick:Of,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{className:"page-title",style:{marginBottom:8,display:"flex",alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,display:"flex",alignItems:"center",gap:6,fontSize:14},children:zr?n.jsxs(n.Fragment,{children:[n.jsxs("span",{style:{color:Ot,fontWeight:700,fontSize:14},children:[zr,"년"]}),n.jsx("span",{style:{fontSize:12},children:"내 평균거래 단가"})]}):n.jsx("span",{style:{fontSize:12},children:"내 평균거래 단가"})}),n.jsxs("div",{style:{marginLeft:"auto",display:"inline-flex",alignItems:"center",gap:8,flexWrap:"nowrap"},children:[n.jsx("select",{className:"search-input",value:zr,onChange:k=>Tf(Number(k.target.value)),"aria-label":"평균단가 조회 연도",style:{height:28},children:[2025,2026,2027,2028,2029,2030].map(k=>n.jsxs("option",{value:k,children:[k,"년"]},k))}),n.jsxs("div",{role:"radiogroup","aria-label":"회사 구분",className:"segmented",style:{display:"inline-flex",alignItems:"center",gap:8,height:28,border:"1px solid var(--border)",borderRadius:6,padding:"0 6px"},children:[n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:12,height:"100%"},children:[n.jsx("input",{type:"radio",name:"unit-company",value:"TNT",checked:hi==="TNT",onChange:()=>Bl("TNT")}),n.jsx("span",{style:{fontSize:12},children:"TNT"})]}),n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,fontSize:12,height:"100%"},children:[n.jsx("input",{type:"radio",name:"unit-company",value:"DYS",checked:hi==="DYS",onChange:()=>Bl("DYS")}),n.jsx("span",{style:{fontSize:12},children:"DYS"})]})]})]})]}),Yn.error?n.jsx("div",{className:"error",style:{maxWidth:420},children:Yn.error}):n.jsx("div",{className:"table-container",style:{height:"calc(66vh - 120px)",overflow:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:180,textAlign:"left"},children:"영업관리단위"}),n.jsx("th",{style:{width:120,textAlign:"left"},children:"판매단위"}),n.jsx("th",{style:{width:120,textAlign:"left"},children:"표준단위"}),n.jsx("th",{style:{width:120,textAlign:"right"},children:"내평균단가(원)"}),n.jsx("th",{style:{width:120,textAlign:"right"},children:"전체단가(원)"})]})}),n.jsx("tbody",{children:Yn.loading?n.jsx("tr",{children:n.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"불러오는 중…"})}):Yn.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:2,className:"muted",style:{padding:"12px 10px"},children:"데이터가 없습니다"})}):Yn.rows.map((k,z)=>n.jsxs("tr",{children:[n.jsx("td",{children:k.unit||"na"}),n.jsx("td",{children:k.itemUnit||"-"}),n.jsx("td",{children:k.itemStdUnit||"-"}),(()=>{const X=Number(k.amountMy||0),te=Number(k.amountGlobal||0),Z=Number.isFinite(X)&&Number.isFinite(te)?X>=te?Ot:"#dc2626":Ot;return n.jsx("td",{style:{textAlign:"right",color:Z,fontWeight:700},children:Number.isFinite(X)&&X>0?`${Lt.format(Math.round(X))} 원`:"-"})})(),n.jsx("td",{style:{textAlign:"right"},children:Number.isFinite(Number(k.amountGlobal))&&Number(k.amountGlobal)>0?`${Lt.format(Math.round(Number(k.amountGlobal)))} 원`:"-"})]},z))})]})})]})}),kt&&n.jsx("div",{role:"alert","aria-live":"assertive","aria-busy":"true",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:100},children:n.jsxs("div",{className:"card",style:{padding:16,background:"var(--panel)",minWidth:280,textAlign:"center",boxShadow:"0 4px 16px rgba(0,0,0,.3)"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700},children:"초기설정 진행 중"}),n.jsx("div",{className:"muted",style:{marginBottom:12},children:li||"작업을 준비 중입니다…"}),n.jsx("div",{className:"muted",style:{fontSize:12},children:"작업이 완료될 때까지 다른 동작을 할 수 없습니다."})]})})]});async function Fb(){try{if(Zn(!0),er("초기설정 요청 중입니다…"),!Y||isNaN(Number(Y))){alert("연도를 선택하세요.");return}const k=localStorage.getItem("tnt.sales.assigneeId")||"";if(!k){alert("로그인이 필요합니다.");return}const z={year:Number(Y),companyType:S,upliftPercent:Math.max(0,Math.min(999,Number(Wl)||0)),versionNo:1,assigneeId:k},X=localStorage.getItem("tnt.sales.empSeq")||"",te=localStorage.getItem("tnt.sales.empId")||"",Z={"Content-Type":"application/json"};X&&(Z["X-EMP-SEQ"]=X),te&&(Z["X-EMP-ID"]=te),Z["X-ASSIGNEE-ID"]=k;const V=await fetch("/api/v1/sales/plan/init",{method:"POST",headers:Z,body:JSON.stringify(z)});if(er("초기 목표를 저장하고 있습니다…"),!V.ok){let ne=`HTTP ${V.status}`;try{const de=await V.json();de!=null&&de.error&&(ne=de.error)}catch{const de=await V.text();de&&(ne=de)}throw new Error(ne)}await V.json().catch(()=>({}));const oe=(localStorage.getItem("tnt.sales.empName")||"").trim()||"사용자",ie=Number(Y);fe({show:!0,name:oe,tnt:pe.tnt,dys:pe.dys,year:Number.isFinite(ie)&&ie>0?ie:0,hasP:!1,hasC:!1,hasI:!0,label:"초기설정완료"});try{await sa(!0)}catch{}}catch(k){alert((k==null?void 0:k.message)||"초기설정 중 오류가 발생했습니다.")}finally{Zn(!1),er("")}}}function Hj(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function Kj(){const[e,t]=c.useState(""),[r,a]=c.useState(""),[i,s]=c.useState(""),[o,l]=c.useState(!1),[d,f]=c.useState(null),[u,h]=c.useState([]),[m,p]=c.useState(!1),[x,v]=c.useState({open:!1,x:0,y:0}),[g,b]=c.useState(()=>new Set),[y,A]=c.useState({open:!1,x:0,y:0}),[C,N]=c.useState(void 0),[w,M]=c.useState("init"),[O,D]=c.useState({}),W=["init","sim","apply","confirm"],j=[{key:"init",label:"초기설정"},{key:"sim",label:"Simulation"},{key:"apply",label:"목표반영"},{key:"confirm",label:"확정"}],S=W.indexOf(w),R=()=>{const H=Math.max(0,S-1);M(W[H])},I=()=>{const H=Math.min(W.length-1,S+1);M(W[H])},[$,J]=c.useState(!1),[q,K]=c.useState(null);new Date().getFullYear();const[L,ee]=c.useState("prev1"),[E,T]=c.useState(()=>new Array(12).fill(0)),[B,P]=c.useState({loading:!1});async function _(){if(!(C!=null&&C.customerSeq)){T(new Array(12).fill(0));return}J(!0),K(null);try{const H=new Date().getFullYear(),Q=L==="prev1"?[H-1]:L==="last2"?[H-1,H-2]:[H-1,H-2,H-3],ge=[];await Promise.all(Q.map(async Ne=>{try{const Y=await fetch(`/api/v1/customers/${C.customerSeq}/invoice-monthly?year=${Ne}`);if(!Y.ok)return;const ve=await Y.json().catch(()=>[]),se=(Array.isArray(ve)?ve:[]).map(Le=>({month:Number(Le.month??0),amount:Number(Le.amount??0)}));ge.push(...se)}catch{}}));const je=new Array(12).fill(0);for(const Ne of ge){const Y=Math.min(12,Math.max(1,Number(Ne.month)||0))-1;je[Y]+=Number.isFinite(Ne.amount)?Number(Ne.amount):0}T(je)}catch(H){K(H.message||"조회 중 오류가 발생했습니다"),T(new Array(12).fill(0))}finally{J(!1)}}c.useEffect(()=>{w==="init"&&_()},[w,C==null?void 0:C.customerSeq,L]);async function U(){if(!(C!=null&&C.customerSeq)){P({loading:!1,hasRecent:void 0,error:null});return}P({loading:!0,hasRecent:void 0,error:null});try{const H=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);H.searchParams.set("custSeq",String(C.customerSeq)),H.searchParams.set("years","2");const Q=await fetch(H.toString());if(!Q.ok){let Ne=`HTTP ${Q.status}`;try{const Y=await Q.json();Y!=null&&Y.error&&(Ne=Y.error)}catch{}throw new Error(Ne)}const ge=await Q.json(),je=Array.isArray(ge)&&ge.some(Ne=>Number((Ne==null?void 0:Ne.customerSeq)||(Ne==null?void 0:Ne.customerSeqText)||0)===Number(C.customerSeq)&&!!(Ne!=null&&Ne.hasRecent));P({loading:!1,hasRecent:je,error:null})}catch(H){P({loading:!1,hasRecent:void 0,error:H.message||"오류"})}}c.useEffect(()=>{w==="init"&&U()},[w,C==null?void 0:C.customerSeq]);const fe=c.useMemo(()=>n.jsx("div",{className:"table-container",style:{border:"1px solid var(--border)",borderRadius:8,marginTop:8},children:n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsx("tr",{children:Array.from({length:12},(H,Q)=>n.jsxs("th",{style:{width:100,textAlign:"right"},children:[String(Q+1).padStart(2,"0"),"월"]},Q))})}),n.jsx("tbody",{children:n.jsx("tr",{children:E.map((H,Q)=>n.jsx("td",{style:{textAlign:"right"},children:Math.round(H).toLocaleString()},Q))})})]})}),[E]);async function ae(){f(null),l(!0);try{const H=localStorage.getItem("tnt.sales.empId");if(!H){h([]),f(ot.loginRequired);return}const Q=new URL("/api/v1/customers",window.location.origin);Q.searchParams.set("mineOnly","true"),Q.searchParams.set("empId",H);const ge=await fetch(Q.toString());if(!ge.ok){let Y=`HTTP ${ge.status}`;try{const ve=await ge.json();ve!=null&&ve.error&&(Y=ve.error)}catch{const ve=await ge.text();ve&&(Y=ve)}throw new Error(Y)}const je=await ge.json(),Ne=Array.isArray(je)?je:[];h(Ne);try{const Y=Ne.map(ve=>Number(ve.customerSeq||0)).filter(ve=>Number.isFinite(ve)&&ve>0);if(Y.length>0){const ve=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);ve.searchParams.set("custSeq",Array.from(new Set(Y)).join(",")),ve.searchParams.set("years","2");const se=await fetch(ve.toString());if(se.ok){const Le=await se.json(),Fe={};Array.isArray(Le)&&Le.forEach(Ie=>{const Ve=Number((Ie==null?void 0:Ie.customerSeq)||(Ie==null?void 0:Ie.customerSeqText)||0);Number.isFinite(Ve)&&(Fe[Ve]=!!(Ie!=null&&Ie.hasRecent))}),D(Fe)}else D({})}else D({})}catch{D({})}}catch(H){f(H.message||"조회 중 오류가 발생했습니다")}finally{l(!1)}}c.useEffect(()=>{ae()},[]),c.useEffect(()=>{if(!x.open)return;const H=()=>v({open:!1,x:0,y:0});return window.addEventListener("click",H),()=>window.removeEventListener("click",H)},[x.open]),c.useEffect(()=>{if(!x.open)return;const H=Q=>{Q.key==="Escape"&&v({open:!1,x:0,y:0})};return window.addEventListener("keydown",H),()=>window.removeEventListener("keydown",H)},[x.open]),c.useEffect(()=>{const H=Q=>{((Q==null?void 0:Q.key)==="Escape"||(Q==null?void 0:Q.key)==="Esc"||(Q==null?void 0:Q.keyCode)===27)&&(v({open:!1,x:0,y:0}),A({open:!1,x:0,y:0}))};return document.addEventListener("keydown",H,!0),()=>document.removeEventListener("keydown",H,!0)},[]);async function F(H,Q){H.preventDefault(),H.stopPropagation(),v({open:!1,x:0,y:0});const ge=H.clientX,je=H.clientY;A({open:!0,x:ge,y:je,row:Q,loading:!1,error:null,data:[]})}const pe=c.useMemo(()=>{var H,Q,ge,je,Ne,Y,ve,se,Le,Fe,Ie,Ve,yt,It,nn;return n.jsx(n.Fragment,{children:n.jsxs("div",{className:"table-container",onClick:()=>v({open:!1,x:0,y:0}),style:{height:"100%",overflow:"auto"},children:[u.length===0?n.jsx("div",{className:"empty-state",children:ot.empty}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsx("tr",{children:n.jsx("th",{style:{width:"auto"},children:"거래처명"})})}),n.jsx("tbody",{children:u.map((He,lt)=>n.jsx("tr",{onClick:ht=>{ht.preventDefault(),ht.stopPropagation(),N(He),A({open:!1,x:0,y:0})},onContextMenu:ht=>F(ht,He),"aria-selected":(C==null?void 0:C.customerId)===He.customerId?!0:void 0,style:(C==null?void 0:C.customerId)===He.customerId?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:n.jsx("td",{children:(()=>{const ht=Number(He.customerSeq||0);return O[ht]?n.jsxs("span",{children:[He.customerName," "," ","$"]}):He.customerName})()})},lt))})]}),y.open&&n.jsxs("div",{className:"context-menu",style:{left:y.x+6,top:y.y+6,maxWidth:420,padding:8},onClick:He=>He.stopPropagation(),children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 상세"}),y.error?n.jsx("div",{className:"error",style:{maxWidth:380},children:y.error}):n.jsx("table",{className:"table",style:{width:"100%"},children:n.jsxs("tbody",{children:[n.jsxs("tr",{children:[n.jsx("th",{style:{width:110,textAlign:"left"},children:"거래처번호"}),n.jsx("td",{children:((H=y.row)==null?void 0:H.customerId)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"사업자번호"}),n.jsx("td",{children:((Q=y.row)==null?void 0:Q.bizNo)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"대표자명"}),n.jsx("td",{children:((ge=y.row)==null?void 0:ge.ownerName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"업태"}),n.jsx("td",{children:((je=y.row)==null?void 0:je.bizKind)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"종목"}),n.jsx("td",{children:((Ne=y.row)==null?void 0:Ne.bizType)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"전화번호"}),n.jsx("td",{children:((Y=y.row)==null?void 0:Y.telNo)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"담당자명"}),n.jsx("td",{children:((ve=y.row)==null?void 0:ve.empName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"부서명"}),n.jsx("td",{children:((se=y.row)==null?void 0:se.deptName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"시/도"}),n.jsx("td",{children:((Le=y.row)==null?void 0:Le.addrProvinceName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"시/군/구"}),n.jsx("td",{children:((Fe=y.row)==null?void 0:Fe.addrCityName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"고객유형"}),n.jsx("td",{children:((Ie=y.row)==null?void 0:Ie.customerTypeName)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"비고"}),n.jsx("td",{children:((Ve=y.row)==null?void 0:Ve.customerRemark)||""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"생성자"}),n.jsx("td",{children:((yt=y.row)==null?void 0:yt.createdBy)??""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"수정자"}),n.jsx("td",{children:((It=y.row)==null?void 0:It.updatedBy)??""})]}),n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left"},children:"생성일시"}),n.jsx("td",{children:Hj((nn=y.row)==null?void 0:nn.createdAt)})]})]})})]})]})})},[u,x,g,y,C,O]);return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:18},children:"목표 Simulation"}),n.jsxs("div",{className:"muted count-text",children:[u.length.toLocaleString(),"개 거래처"]})]}),d&&n.jsx("div",{className:"error",children:d||ot.errorGeneric}),n.jsxs("div",{style:{marginTop:12,display:"flex",gap:12,alignItems:"stretch",height:"calc(100vh - 140px)"},children:[n.jsx("div",{style:{flex:"0 0 17%",maxWidth:"17%",minWidth:240,height:"100%",overflow:"auto"},children:pe}),n.jsxs("aside",{className:"card",style:{flex:"1 1 83%",maxWidth:"83%",height:"100%",padding:12,overflow:"auto"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12,gap:16},children:[n.jsx("div",{style:{display:"flex",alignItems:"center",gap:8,flex:1,minWidth:0},children:(()=>{const H=[];for(let Q=0;Q<j.length;Q++){const ge=j[Q],je=Q<S,Ne=Q===S;H.push(n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,minWidth:0,flex:Q===j.length-1?"0 0 auto":"1 1 0"},children:[n.jsx("div",{title:ge.label,onClick:()=>M(ge.key),style:{width:22,height:22,borderRadius:999,display:"inline-flex",alignItems:"center",justifyContent:"center",background:je||Ne?"var(--accent)":"transparent",border:`2px solid ${je||Ne?"var(--accent)":"var(--border)"}`,color:je||Ne?"var(--on-accent)":"var(--muted)",cursor:"pointer",flex:"0 0 auto"},"aria-current":Ne?"step":void 0,children:je?"✓":Q+1}),n.jsx("div",{style:{fontSize:12,color:Ne||je?"var(--text)":"var(--muted)",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:ge.label}),Q<j.length-1&&n.jsx("div",{style:{height:2,background:Q<S?"var(--accent)":"var(--border)",flex:1,borderRadius:2}})]},ge.key))}return H})()}),n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6},children:[n.jsx("button",{className:"btn btn-icon",onClick:R,disabled:S===0,"aria-label":"이전 단계",title:"이전 단계",children:n.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:n.jsx("path",{d:"M15 18l-6-6 6-6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),n.jsx("button",{className:"btn btn-icon",onClick:I,disabled:S===j.length-1,"aria-label":"다음 단계",title:"다음 단계",children:n.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",children:n.jsx("path",{d:"M9 6l6 6-6 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]})]}),w==="init"&&n.jsxs("section",{style:{marginTop:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:12},children:[n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:10},children:[n.jsx("b",{children:"기준매출"}),n.jsxs("select",{value:L,onChange:H=>ee(H.target.value),style:{height:28,padding:"4px 8px",borderRadius:8,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12},"aria-label":"기준 기간 선택",children:[n.jsx("option",{value:"prev1",children:"전년"}),n.jsx("option",{value:"last2",children:"최근2년"}),n.jsx("option",{value:"last3",children:"최근3년"})]})]}),q&&n.jsx("span",{className:"error",children:q})]}),$?n.jsx("div",{className:"empty-state",style:{marginTop:8},children:"불러오는 중…"}):fe]})]})]})]})}const Yj="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpath%20d='M12%201v22'/%3e%3cpath%20d='M17%205H9.5a3.5%203.5%200%200%200%200%207H14a3.5%203.5%200%200%201%200%207H6'/%3e%3c/svg%3e",Gj="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cpolyline%20points='3%2017%209%2011%2013%2015%2021%207'%20/%3e%3ccircle%20cx='21'%20cy='7'%20r='1'%20/%3e%3c/svg%3e";function gs(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function eg({compact:e=!1,maxHeight:t,context:r="list"}){const[a,i]=c.useState(""),[s,o]=c.useState(""),[l,d]=c.useState(""),[f,u]=c.useState(!1),[h,m]=c.useState(null),[p,x]=c.useState([]),[v,g]=c.useState("mine"),[b,y]=c.useState({open:!1,x:0,y:0}),[A,C]=c.useState(()=>new Set),[N,w]=c.useState({open:!1,x:0,y:0}),[M,O]=c.useState({}),[D,W]=c.useState({}),[j,S]=c.useState(!1),[R,I]=c.useState(0),$=100,[J,q]=c.useState(0),[K,L]=c.useState(!0),[ee,E]=c.useState(!1),T=ke.useRef(null),[B,P]=c.useState(()=>{try{const Y=localStorage.getItem("tnt.sales.selectedCustomer");if(Y){const ve=JSON.parse(Y),se=Number(ve==null?void 0:ve.customerSeq);return Number.isFinite(se)?se:null}}catch{}return null}),[_,U]=c.useState(()=>{try{const Y=localStorage.getItem("tnt.sales.selectedCustomer");if(Y){const ve=JSON.parse(Y);return String((ve==null?void 0:ve.customerId)||"")||null}}catch{}return null}),fe=c.useMemo(()=>{const Y=typeof window<"u"?localStorage.getItem("tnt.sales.empName"):"",ve=typeof window<"u"?localStorage.getItem("tnt.sales.assigneeId"):"";return Y||ve||""},[]);function ae(Y,ve){C(se=>{const Le=new Set(se);return ve?Le.add(Y):Le.delete(Y),Le})}function F(Y){if(!Y){C(new Set);return}const ve=new Set;p.forEach(se=>{se.customerId&&ve.add(se.customerId)}),C(ve)}async function pe(Y=!0){m(null),Y?(u(!0),q(0),L(!0)):E(!0);try{const ve=localStorage.getItem("tnt.sales.assigneeId");if(!ve){x([]),m(ot.loginRequired);return}const se=new URL("/api/v1/customers",window.location.origin);a.trim()&&se.searchParams.set("name",a.trim()),s.trim()&&se.searchParams.set("provinceName",s.trim()),l.trim()&&se.searchParams.set("cityName",l.trim());const Le=v==="mine";se.searchParams.set("mineOnly",Le?"true":"false"),Le&&ve&&se.searchParams.set("assigneeId",ve),se.searchParams.set("limit",String($)),se.searchParams.set("offset",String(Y?0:J));const Fe=await fetch(se.toString());if(!Fe.ok){let He=`HTTP ${Fe.status}`;try{const lt=await Fe.json();lt!=null&&lt.error&&(He=lt.error)}catch{const ht=await Fe.text();ht&&(He=ht)}throw new Error(He)}const Ie=await Fe.json(),Ve=Array.isArray(Ie)?Ie:[],yt=[...Ve].sort((He,lt)=>{const ht=(He.customerName||"").toString(),rn=(lt.customerName||"").toString();return ht.localeCompare(rn,"ko",{sensitivity:"base"})}),It=(Y?yt:Ve).map(He=>Number(He.customerSeq||0)).filter(He=>Number.isFinite(He)&&He>0),nn=Array.from(new Set(It)).join(",");try{if(It.length>0){const He=new URL("/api/v1/customers/recent-invoice-flags",window.location.origin);He.searchParams.set("custSeq",nn),He.searchParams.set("years","2");const lt=new URL("/api/v1/customers/demand-flags",window.location.origin);lt.searchParams.set("custSeq",nn);const[ht,rn]=await Promise.all([fetch(He.toString()),fetch(lt.toString())]);if(ht.ok){const ct=await ht.json(),Tt={};Array.isArray(ct)&&ct.forEach(rt=>{const _n=Number((rt==null?void 0:rt.customerSeq)||0);Number.isFinite(_n)&&(Tt[_n]=!!(rt!=null&&rt.hasRecent))}),O(rt=>Y?Tt:{...rt,...Tt})}else Y&&O({});if(rn.ok){const ct=await rn.json(),Tt={};Array.isArray(ct)&&ct.forEach(rt=>{const _n=Number((rt==null?void 0:rt.customerSeq)||0);Number.isFinite(_n)&&(Tt[_n]=!!(rt!=null&&rt.hasDemand))}),W(rt=>Y?Tt:{...rt,...Tt})}else Y&&W({})}else Y&&(O({}),W({}))}catch{Y&&(O({}),W({}))}x(Y?yt:He=>[...He,...yt]),L(Ve.length>=$),q(Y?$:He=>He+$),Y&&!j&&yt.length>0&&(H(yt[0]),S(!0));try{if(ve&&v==="mine"){const He=new URL("/api/v1/customers/count",window.location.origin);He.searchParams.set("mineOnly","true"),He.searchParams.set("assigneeId",ve);const lt=await fetch(He.toString());if(lt.ok){const ht=await lt.json().catch(()=>({})),rn=Number((ht==null?void 0:ht.total)??0);I(Number.isFinite(rn)?rn:0)}else I(0)}else I(0)}catch{I(0)}}catch(ve){m(ve.message||"조회 중 오류가 발생했습니다")}finally{Y?u(!1):E(!1)}}c.useEffect(()=>{pe(!0)},[]),c.useEffect(()=>{const Y=()=>{try{const ve=localStorage.getItem("tnt.sales.selectedCustomer");if(ve){const se=JSON.parse(ve),Le=Number(se==null?void 0:se.customerSeq);P(Number.isFinite(Le)?Le:null),U((se==null?void 0:se.customerId)||null)}}catch{}};return window.addEventListener("tnt.sales.customer.selected",Y),()=>window.removeEventListener("tnt.sales.customer.selected",Y)},[]),c.useEffect(()=>{pe(!0)},[v]),c.useEffect(()=>{const Y=T.current;if(!Y)return;function ve(){Y.scrollTop+Y.clientHeight>=Y.scrollHeight-48&&K&&!ee&&!f&&pe(!1)}return Y.addEventListener("scroll",ve),()=>Y.removeEventListener("scroll",ve)},[K,ee,f,J,a,s,l,v]),c.useEffect(()=>{if(!b.open)return;const Y=()=>y({open:!1,x:0,y:0});return window.addEventListener("click",Y),()=>window.removeEventListener("click",Y)},[b.open]),c.useEffect(()=>{if(!b.open)return;const Y=ve=>{ve.key==="Escape"&&y({open:!1,x:0,y:0})};return window.addEventListener("keydown",Y),()=>window.removeEventListener("keydown",Y)},[b.open]),c.useEffect(()=>{if(!N.open)return;const Y=()=>w({open:!1,x:0,y:0}),ve=se=>{se.key==="Escape"&&w({open:!1,x:0,y:0})};return window.addEventListener("click",Y),window.addEventListener("keydown",ve),()=>{window.removeEventListener("click",Y),window.removeEventListener("keydown",ve)}},[N.open]),c.useEffect(()=>{const Y=ve=>{((ve==null?void 0:ve.key)==="Escape"||(ve==null?void 0:ve.key)==="Esc"||(ve==null?void 0:ve.keyCode)===27)&&(y({open:!1,x:0,y:0}),w({open:!1,x:0,y:0}))};return document.addEventListener("keydown",Y,!0),()=>document.removeEventListener("keydown",Y,!0)},[]);function H(Y){try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(Y||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:Y}}))}catch{}P((()=>{const ve=Number(Y.customerSeq);return Number.isFinite(ve)?ve:null})()),U(Y.customerId||null),y({open:!1,x:0,y:0}),w({open:!1,x:0,y:0})}function Q(Y,ve){const se=Y.clientX,Le=Y.clientY;w({open:!0,x:se,y:Le,row:ve,loading:!1,error:null,data:[]})}function ge(Y){N.open&&w(ve=>({...ve,x:Y.clientX,y:Y.clientY}))}function je(){w({open:!1,x:0,y:0})}const Ne=c.useMemo(()=>n.jsx(n.Fragment,{children:n.jsxs("div",{ref:T,className:"table-container",onClick:()=>y({open:!1,x:0,y:0}),style:{maxHeight:t??(e?"32vh":void 0),overflow:"auto"},children:[p.length===0?n.jsx("div",{className:"empty-state",children:ot.empty}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:36,textAlign:"center"},children:n.jsx("input",{type:"checkbox",checked:p.length>0&&A.size===p.length,indeterminate:void 0,onChange:Y=>F(Y.target.checked)})}),n.jsx("th",{style:{width:140},children:r==="c360"?"회사구분":"거래처번호"}),n.jsx("th",{style:{width:200},children:"거래처명"}),n.jsx("th",{style:{width:80},children:"추가정보"}),n.jsx("th",{style:{width:140},children:"사업자번호"}),n.jsx("th",{style:{width:120},children:"대표자명"}),n.jsx("th",{style:{width:120},children:"업태"}),n.jsx("th",{style:{width:120},children:"종목"}),n.jsx("th",{style:{width:130},children:"전화번호"}),n.jsx("th",{style:{width:120},children:"담당자명"}),n.jsx("th",{style:{width:140},children:"부서명"}),n.jsx("th",{style:{width:120},children:"시/도"}),n.jsx("th",{style:{width:120},children:"시/군/구"}),n.jsx("th",{style:{width:120},children:"고객유형"}),n.jsx("th",{children:"비고"}),n.jsx("th",{style:{width:120},children:"생성자"}),n.jsx("th",{style:{width:120},children:"수정자"}),n.jsx("th",{style:{width:180},children:"생성일시"}),n.jsx("th",{style:{width:180},children:"수정일시"})]})}),n.jsx("tbody",{children:p.map((Y,ve)=>n.jsxs("tr",{className:Number(Y.customerSeq||0)===(B||-1)||_&&Y.customerId===_?"selected":void 0,onClick:()=>H(Y),onContextMenu:se=>{se.preventDefault(),se.stopPropagation(),je(),y({open:!0,x:se.clientX,y:se.clientY,row:Y})},children:[n.jsx("td",{style:{textAlign:"center"},onClick:se=>se.stopPropagation(),children:n.jsx("input",{type:"checkbox",checked:A.has(Y.customerId),onChange:se=>ae(Y.customerId,se.target.checked)})}),n.jsx("td",{onMouseEnter:se=>Q(se,Y),onMouseMove:ge,onMouseLeave:je,children:r==="c360"?Y.companyType||"":Y.customerId}),n.jsx("td",{children:Y.customerName}),n.jsx("td",{children:(()=>{const se=Number(Y.customerSeq||0),Le=!!M[se],Fe=!!D[se];return!Le&&!Fe?"":n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[Le&&n.jsx("img",{src:Yj,className:"icon",alt:"",title:"최근2년 매출 있음",style:{width:14,height:14}}),Fe&&n.jsx("img",{src:Gj,className:"icon",alt:"",title:"수요 있음",style:{width:14,height:14}})]})})()}),n.jsx("td",{children:Y.bizNo||""}),n.jsx("td",{children:Y.ownerName||""}),n.jsx("td",{children:Y.bizKind||""}),n.jsx("td",{children:Y.bizType||""}),n.jsx("td",{children:Y.telNo||""}),n.jsx("td",{children:Y.empName||""}),n.jsx("td",{children:Y.deptName||""}),n.jsx("td",{children:Y.addrProvinceName||""}),n.jsx("td",{children:Y.addrCityName||""}),n.jsx("td",{children:Y.customerTypeName||""}),n.jsx("td",{children:Y.customerRemark||""}),n.jsx("td",{children:Y.createdBy??""}),n.jsx("td",{children:Y.updatedBy??""}),n.jsx("td",{children:gs(Y.createdAt)}),n.jsx("td",{children:gs(Y.updatedAt)})]},ve))})]}),ee&&n.jsx("div",{className:"muted",style:{padding:"6px 8px"},children:ot.loading}),!f&&!ee&&!K&&p.length>0&&n.jsx("div",{className:"muted",style:{padding:"8px 10px",textAlign:"center"},children:"마지막 데이터입니다."}),b.open&&n.jsxs("div",{className:"context-menu",style:{left:b.x+4,top:b.y+4},onClick:Y=>Y.stopPropagation(),children:[r!=="c360"?n.jsxs(n.Fragment,{children:[n.jsx("button",{className:"context-item",onClick:()=>{try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(b.row||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:b.row}}))}catch{}const Y=document.querySelector('button[data-key="customer:c360"]');Y&&Y.click(),y({open:!1,x:0,y:0})},children:"C360"}),n.jsx("button",{className:"context-item",onClick:()=>{try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(b.row||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:b.row}}))}catch{}window.dispatchEvent(new CustomEvent("tnt.sales.navigate",{detail:{key:"sales-mgmt:receivables"}})),y({open:!1,x:0,y:0})},children:"미수현황"})]}):null,n.jsx("button",{className:"context-item",onClick:()=>{try{localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify(b.row||{})),window.dispatchEvent(new CustomEvent("tnt.sales.customer.selected",{detail:{source:"customer-search",customer:b.row}}))}catch{}const Y=document.querySelector('button[data-key="customer:sales-activity-new"]');Y&&Y.click(),y({open:!1,x:0,y:0})},children:"활동등록"})]}),N.open&&N.row&&n.jsxs("div",{className:"context-menu",style:{left:N.x+6,top:N.y+6,maxWidth:500,padding:10},onClick:Y=>Y.stopPropagation(),onMouseLeave:je,children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"거래처 정보"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr",gap:6,maxWidth:480},children:[n.jsx("div",{className:"muted",children:"거래처번호"}),n.jsx("div",{children:N.row.customerId||""}),n.jsx("div",{className:"muted",children:"거래처명"}),n.jsx("div",{children:N.row.customerName||""}),N.row.customerFullName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"정식명"}),n.jsx("div",{children:N.row.customerFullName})]}):null,N.row.bizNo?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"사업자번호"}),n.jsx("div",{children:N.row.bizNo})]}):null,N.row.ownerName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"대표자명"}),n.jsx("div",{children:N.row.ownerName})]}):null,N.row.bizKind?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"업태"}),n.jsx("div",{children:N.row.bizKind})]}):null,N.row.bizType?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"종목"}),n.jsx("div",{children:N.row.bizType})]}):null,N.row.telNo?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"전화번호"}),n.jsx("div",{children:N.row.telNo})]}):null,N.row.empName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"담당자명"}),n.jsx("div",{children:N.row.empName})]}):null,N.row.deptName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"부서명"}),n.jsx("div",{children:N.row.deptName})]}):null,N.row.addrProvinceName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"시/도"}),n.jsx("div",{children:N.row.addrProvinceName})]}):null,N.row.addrCityName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"시/군/구"}),n.jsx("div",{children:N.row.addrCityName})]}):null,N.row.customerTypeName?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"고객유형"}),n.jsx("div",{children:N.row.customerTypeName})]}):null,N.row.customerRemark?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"비고"}),n.jsx("div",{children:N.row.customerRemark})]}):null,N.row.createdAt?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"생성일시"}),n.jsx("div",{children:gs(N.row.createdAt)})]}):null,N.row.updatedAt?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",children:"수정일시"}),n.jsx("div",{children:gs(N.row.updatedAt)})]}):null]})]})]})}),[p,b,A,N]);return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:8,alignItems:"center",flex:"1 1 auto",minWidth:0},children:[n.jsxs("select",{value:v,onChange:Y=>g(Y.target.value),style:{height:30,padding:"2px 8px",fontSize:11,background:v==="mine"?"rgba(59,130,246,.15)":"#fff",borderRadius:8,border:v==="mine"?"1px solid var(--accent)":"1px solid var(--border)"},children:[n.jsx("option",{value:"mine",children:"내 거래처"}),n.jsx("option",{value:"hq",children:"본부 거래처"}),n.jsx("option",{value:"all",children:"전체"})]}),n.jsx("input",{className:"search-input",value:a,onChange:Y=>i(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&pe()},placeholder:"거래처명",style:{background:"#fff",borderRadius:8,border:"1px solid var(--border)"}}),n.jsx("input",{className:"search-input",value:s,onChange:Y=>o(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&pe()},placeholder:"시/도",style:{background:"#fff",borderRadius:8,border:"1px solid var(--border)",minWidth:100}}),n.jsx("input",{className:"search-input",value:l,onChange:Y=>d(Y.target.value),onKeyDown:Y=>{Y.key==="Enter"&&pe()},placeholder:"시/군/구",style:{background:"#fff",borderRadius:8,border:"1px solid var(--border)",minWidth:120}}),n.jsx("button",{className:"btn",onClick:pe,disabled:f,style:{height:30,padding:"0 12px"},children:"조회"}),f&&n.jsx("span",{className:"muted",style:{lineHeight:"30px"},children:ot.loading})]}),n.jsx("div",{className:"meta",style:{gap:0},children:n.jsxs("span",{className:"muted count-text",children:[v==="mine"&&fe?`${fe} · `:"",(v==="mine"?R:p.length).toLocaleString(),"개 거래처",A.size?` · 선택 ${A.size}건`:""]})})]}),h&&n.jsx("div",{className:"error",children:h||ot.errorGeneric}),n.jsx("div",{style:{marginTop:12},children:Ne})]})}function pr(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function bd({customerSeq:e,customerId:t,hideHeader:r=!1,hideRefresh:a=!1,enableContextMenu:i=!1}){const[s,o]=c.useState([]),[l,d]=c.useState(!1),[f,u]=c.useState(null),[h,m]=c.useState({open:!1,x:0,y:0}),p=c.useRef(null),[x,v]=c.useState(null);async function g(){u(null),d(!0);try{const N=new URL("/api/v1/sales-activities",window.location.origin);N.searchParams.set("mineOnly","false");const w=t&&t.trim()||(()=>{try{const D=localStorage.getItem("tnt.sales.selectedCustomer");if(D){const W=JSON.parse(D);return(W==null?void 0:W.customerId)||""}}catch{}return""})();N.searchParams.set("sfAccountId",w||"");const M=await fetch(N.toString());if(!M.ok){let D=`HTTP ${M.status}`;try{const W=await M.json();W!=null&&W.error&&(D=W.error)}catch{}throw new Error(D)}const O=await M.json();o(Array.isArray(O)?O:[])}catch(N){u(N.message||"조회 중 오류가 발생했습니다")}finally{d(!1)}}c.useEffect(()=>{e&&g()},[e,t]);async function b(N){try{const w=new URL("/api/v1/sales-activities",window.location.origin);w.searchParams.set("mineOnly","false");const M=t&&t.trim()||(()=>{try{const j=localStorage.getItem("tnt.sales.selectedCustomer");if(j){const S=JSON.parse(j);return(S==null?void 0:S.customerId)||""}}catch{}return""})();w.searchParams.set("sfAccountId",M||""),w.searchParams.set("parentSeq",String(N)),w.searchParams.set("includeParent","true");const O=await fetch(w.toString());if(!O.ok)return;const D=await O.json(),W=Array.isArray(D)?D:[];W.sort((j,S)=>{const R=!j.parentSeq,I=!S.parentSeq;if(R&&!I)return-1;if(!R&&I)return 1;const $=j.createdAt?new Date(j.createdAt).getTime():0;return(S.createdAt?new Date(S.createdAt).getTime():0)-$}),v(W)}catch{v([])}}c.useEffect(()=>{if(!h.open)return;const N=w=>{if(w.button!==0)return;const M=w.target;p.current&&M&&p.current.contains(M)||m({open:!1,x:0,y:0})};return window.addEventListener("mousedown",N,!0),()=>window.removeEventListener("mousedown",N,!0)},[h.open]),c.useEffect(()=>{if(!h.open)return;const N=w=>{((w==null?void 0:w.key)==="Escape"||(w==null?void 0:w.key)==="Esc"||(w==null?void 0:w.keyCode)===27)&&m({open:!1,x:0,y:0})};return document.addEventListener("keydown",N,!0),()=>document.removeEventListener("keydown",N,!0)},[h.open]),c.useEffect(()=>{if(!x)return;const N=w=>{w.key==="Escape"&&(w.preventDefault(),w.stopPropagation(),v(null))};return window.addEventListener("keydown",N,!0),()=>window.removeEventListener("keydown",N,!0)},[x]);const y=(N,w)=>N?w==="type"?{site_visit:"정기방문",opportunity:"영업기회",AR_mgmt:"채권관리",meeting:"미팅",call:"전화",email:"이메일",demo:"데모",task:"업무",other:"기타"}[N]||N:w==="status"?{scheduled:"계획",completed:"완료",canceled:"취소",postponed:"연기",no_show:"미방문"}[N]||N:w==="channel"&&{in_person:"방문",phone:"전화",email:"문자/메일/팩스",other:"기타",video:"영상",chat:"채팅",sms:"문자"}[N]||N:"",A=N=>[`제목: ${N.subject||""}`,`활동설명: ${N.description||""}`,`활동유형: ${y(N.activityType,"type")}`,`활동방법: ${y(N.channel,"channel")}`,`상태: ${y(N.activityStatus,"status")}`,`상위활동: ${N.parentSubject||""}`,`계획 일시: ${pr(N.plannedStartAt)}`,`종료 일시: ${pr(N.plannedEndAt)}`,`생성일시: ${pr(N.createdAt)}`,N.customerName?`거래처명: ${N.customerName}`:""].filter(Boolean).join(`
`),C=c.useMemo(()=>n.jsxs(n.Fragment,{children:[!r&&n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:6},children:[n.jsx("div",{className:"muted"}),n.jsxs("div",{className:"muted count-text",children:["총 ",s.length,"건"]})]}),n.jsx("div",{className:"table-container",children:s.length===0?n.jsx("div",{className:"empty-state",children:"활동이 없습니다."}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:240},children:"제목"}),n.jsx("th",{style:{width:280},children:"활동설명"}),n.jsx("th",{style:{width:120},children:"활동유형"}),n.jsx("th",{style:{width:120},children:"활동방법"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:220},children:"상위활동"}),n.jsx("th",{style:{width:180},children:"계획 일시"}),n.jsx("th",{style:{width:180},children:"종료 일시"}),n.jsx("th",{style:{width:180},children:"생성일시"})]})}),n.jsx("tbody",{children:s.map((N,w)=>n.jsxs("tr",{title:A(N),onContextMenu:M=>{i&&N.parentSeq&&(M.preventDefault(),M.stopPropagation(),m({open:!0,x:M.clientX,y:M.clientY,row:N}))},children:[n.jsx("td",{children:N.subject||""}),n.jsx("td",{title:N.description||"",style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:N.description||""}),n.jsx("td",{children:y(N.activityType,"type")}),n.jsx("td",{children:y(N.channel,"channel")}),n.jsx("td",{children:y(N.activityStatus,"status")}),n.jsx("td",{children:N.parentSubject||""}),n.jsx("td",{children:pr(N.plannedStartAt)}),n.jsx("td",{children:pr(N.plannedEndAt)}),n.jsx("td",{children:pr(N.createdAt)})]},w))})]})})]}),[s]);return n.jsxs("section",{children:[!a&&n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[n.jsx("button",{className:"btn",onClick:g,disabled:l,children:l?"새로고침…":"새로고침"}),f&&n.jsx("span",{className:"error",children:f})]}),a&&f&&n.jsx("div",{className:"error",children:f}),n.jsx("div",{style:{marginTop:12},children:C}),h.open&&n.jsx("div",{ref:p,className:"context-menu",style:{left:h.x+4,top:h.y+4},onClick:N=>N.stopPropagation(),children:n.jsx("button",{className:"context-item",onClick:()=>{var N,w;(N=h.row)!=null&&N.parentSeq?b(h.row.parentSeq):(w=h.row)!=null&&w.id&&b(h.row.id),m({open:!1,x:0,y:0})},children:"관련활동"})}),x&&n.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.4)"},onClick:()=>v(null),children:n.jsxs("div",{className:"card",style:{width:"min(1200px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:N=>N.stopPropagation(),children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[n.jsxs("div",{className:"list-title",style:{display:"flex",alignItems:"center",gap:6},children:[n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":"true",focusable:"false",style:{color:"#555"},children:[n.jsx("circle",{cx:"6",cy:"6",r:"3",stroke:"currentColor",strokeWidth:"1.8"}),n.jsx("circle",{cx:"18",cy:"6",r:"3",stroke:"currentColor",strokeWidth:"1.8"}),n.jsx("circle",{cx:"12",cy:"18",r:"3",stroke:"currentColor",strokeWidth:"1.8"}),n.jsx("line",{x1:"8.5",y1:"7.4",x2:"15.5",y2:"7.4",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),n.jsx("line",{x1:"7.2",y1:"8.9",x2:"10.8",y2:"15.1",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"}),n.jsx("line",{x1:"16.8",y1:"8.9",x2:"13.2",y2:"15.1",stroke:"currentColor",strokeWidth:"1.6",strokeLinecap:"round"})]}),n.jsx("span",{style:{fontWeight:600,fontSize:14},children:"관련활동"}),n.jsxs("span",{className:"muted count-text",style:{marginLeft:8},children:["총 ",x.length,"건"]})]}),n.jsx("button",{onClick:()=>v(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:N=>{N.currentTarget.style.background="var(--panel-2)",N.currentTarget.style.color="var(--text)"},onMouseLeave:N=>{N.currentTarget.style.background="transparent",N.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)",children:"×"})]}),n.jsx("div",{className:"table-container",children:x.length===0?n.jsx("div",{className:"empty-state",children:"관련활동이 없습니다."}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:200},children:"상위활동"}),n.jsx("th",{style:{width:240},children:"제목"}),n.jsx("th",{style:{width:280},children:"활동설명"}),n.jsx("th",{style:{width:120},children:"활동유형"}),n.jsx("th",{style:{width:120},children:"활동방법"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:180},children:"계획 일시"}),n.jsx("th",{style:{width:180},children:"종료 일시"}),n.jsx("th",{style:{width:180},children:"생성일시"})]})}),n.jsx("tbody",{children:x.map((N,w)=>n.jsxs("tr",{title:A(N),className:N.parentSeq?void 0:"row-parent",children:[n.jsx("td",{children:N.parentSubject||""}),n.jsx("td",{children:N.subject||""}),n.jsx("td",{style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:N.description||""}),n.jsx("td",{children:y(N.activityType,"type")}),n.jsx("td",{children:y(N.channel,"channel")}),n.jsx("td",{children:y(N.activityStatus,"status")}),n.jsx("td",{children:pr(N.plannedStartAt)}),n.jsx("td",{children:pr(N.plannedEndAt)}),n.jsx("td",{children:pr(N.createdAt)})]},`rel-${w}`))})]})})]})})]})}function Vj(){const[e,t]=c.useState(null),[r,a]=c.useState("form");c.useEffect(()=>{try{const s=localStorage.getItem("tnt.sales.selectedCustomer");t(s?JSON.parse(s):null)}catch{t(null)}},[]);const i=c.useMemo(()=>e?n.jsx("section",{className:"card compact-form",children:n.jsxs("div",{className:"form-grid",children:[n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"거래처번호"}),n.jsx(Rt,{value:e.customerId||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"거래처명"}),n.jsx(Rt,{value:e.customerName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"정식명"}),n.jsx(Rt,{value:e.customerFullName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"사업자번호"}),n.jsx(Rt,{value:e.bizNo||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"대표자명"}),n.jsx(Rt,{value:e.ownerName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"고객유형"}),n.jsx(Rt,{value:e.customerTypeName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"시/도"}),n.jsx(Rt,{value:e.addrProvinceName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"시/군/구"}),n.jsx(Rt,{value:e.addrCityName||"",readOnly:!0})]}),n.jsxs("div",{className:"field row-2",children:[n.jsx("label",{children:"비고"}),n.jsx(Rt,{value:e.customerRemark||"",readOnly:!0})]})]})}):null,[e]);return n.jsxs("section",{style:{display:"flex",flexDirection:"column",height:"100%"},children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:18},children:"영업활동"}),n.jsx("div",{className:"muted count-text"})]}),i,n.jsxs("section",{className:"card sales-activity-panel",style:{marginTop:12},children:[n.jsxs("div",{className:"tabs c360-tabs",children:[n.jsx("button",{className:r==="form"?"tab active":"tab",onClick:()=>a("form"),children:"영업활동 등록"}),n.jsx("button",{className:r==="list"?"tab active":"tab",onClick:()=>a("list"),children:"영업활동"})]}),n.jsx("div",{className:"sales-activity-content",children:r==="form"?n.jsx(Fi,{bare:!0}):n.jsx(bd,{customerSeq:(()=>{try{const s=localStorage.getItem("tnt.sales.selectedCustomer");if(s){const o=JSON.parse(s);return Number(o==null?void 0:o.customerSeq)||0}}catch{}return 0})(),customerId:(()=>{try{const s=localStorage.getItem("tnt.sales.selectedCustomer");if(s){const o=JSON.parse(s);return String((o==null?void 0:o.customerId)||"")}}catch{}return""})(),hideRefresh:!0,enableContextMenu:!0})})]})]})}function tg({customerSeq:e}){const[t,r]=c.useState([]),[a,i]=c.useState(!1),[s,o]=c.useState(null),[l,d]=c.useState([]);async function f(){o(null),i(!0);try{const x=e??(()=>{try{const w=localStorage.getItem("tnt.sales.selectedCustomer");if(w){const M=JSON.parse(w);return Number(M==null?void 0:M.customerSeq)}}catch{}})();if(!x||Number.isNaN(x)){r([]),d([]),i(!1);return}const v=new URL(`/api/v1/customers/${x}/transactions`,window.location.origin),g=await fetch(v.toString());if(!g.ok){let w=`HTTP ${g.status}`;try{const M=await g.json();M!=null&&M.error&&(w=M.error)}catch{}throw new Error(w)}const b=await g.json(),y=Array.isArray(b)?b:[];r(y);let A=[];if(y.length>0){const w=new Map;y.forEach(M=>{const O=M.minorName||"na",D=w.get(O)||{qty:0,amt:0};D.qty+=Number(M.qty??M.qty??0)||0,D.amt+=Number(M.curAmt||0)||0,w.set(O,D)}),A=Array.from(w.entries()).map(([M,O])=>({name:M,qty:O.qty,amt:O.amt})),A.sort((M,O)=>O.qty-M.qty||O.amt-M.amt),d(A)}else d([]);const C=await fetch(`/api/v1/customers/${x}/transactions/summary`);let N=[];if(C.ok)try{const w=await C.json();N=(Array.isArray(w)?w:[]).map(M=>({name:M.minorName||"na",qty:Number(M.qty||0),amt:Number(M.amt||0)}))}catch{N=[]}N.sort((w,M)=>M.qty-w.qty||M.amt-w.amt),N.length>0&&d(N)}catch(x){o(x.message||"조회 중 오류가 발생했습니다")}finally{i(!1)}}c.useEffect(()=>{f()},[e]);const u=c.useMemo(()=>{const x=[...l];return x.sort((v,g)=>g.qty-v.qty||g.amt-v.amt),x},[l]),h=c.useMemo(()=>{const x=[...l];return x.sort((v,g)=>g.amt-v.amt||g.qty-v.qty),x},[l]);function m({data:x,type:v}){const b={top:10,right:10,bottom:60,left:10},y=Math.max(360,x.length*80),A=y-b.left-b.right,C=180-b.top-b.bottom,N=Math.max(1,...x.map(M=>M.value)),w=A/Math.max(1,x.length);return n.jsx("div",{style:{overflowX:"auto"},children:n.jsx("svg",{width:y,height:180,children:n.jsx("g",{transform:`translate(${b.left},${b.top})`,children:x.map((M,O)=>{const D=O*w+w*.15,W=w*.7,j=Math.max(0,M.value/N*C),S=C-j;return n.jsxs("g",{transform:`translate(${D},0)`,children:[n.jsx("rect",{x:0,y:S,width:W,height:j,fill:v==="amt"?"#4e79a7":"#f28e2b"}),n.jsx("text",{x:W/2,y:C+14,fontSize:11,textAnchor:"middle",fill:"var(--muted)",transform:`rotate(25 ${W/2},${C+14})`,children:M.name}),n.jsx("text",{x:W/2,y:S-4,fontSize:11,textAnchor:"middle",fill:"var(--text)",children:M.value.toLocaleString()})]},O)})})})})}const p=c.useMemo(()=>n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:6},children:n.jsxs("div",{className:"muted count-text",children:["총 ",t.length,"건"]})}),t.length>0&&n.jsxs("div",{className:"card",style:{padding:12,marginBottom:8},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"baseline"},children:[n.jsx("b",{children:"중분류별 금액/수량"}),n.jsx("span",{className:"muted",style:{fontSize:12},children:"가로축: 중분류"})]}),n.jsxs("div",{style:{marginTop:8},children:[n.jsxs("div",{style:{marginBottom:12},children:[n.jsx("div",{className:"muted",style:{marginBottom:4},children:"금액"}),n.jsx(m,{type:"amt",data:h.map(x=>({name:x.name,value:x.amt}))})]}),n.jsxs("div",{children:[n.jsx("div",{className:"muted",style:{marginBottom:4},children:"수량"}),n.jsx(m,{type:"qty",data:u.map(x=>({name:x.name,value:x.qty}))})]})]})]}),n.jsx("div",{className:"table-container",children:t.length===0?n.jsx("div",{className:"empty-state",children:"거래 내역이 없습니다."}):n.jsxs("table",{className:"table transactions",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:160},children:"전표번호"}),n.jsx("th",{style:{width:160},children:"중분류"}),n.jsx("th",{children:"품목명"}),n.jsx("th",{style:{width:100,textAlign:"right"},children:"수량"}),n.jsx("th",{style:{width:160,textAlign:"right"},children:"금액"}),n.jsx("th",{style:{width:140},children:"전표일자"})]})}),n.jsx("tbody",{children:(()=>{let x="",v="",g="";const b=[];return t.forEach((y,A)=>{const C=y.invoiceNo!==x;let N="",w="",M="",O;C?(A>0&&b.push(n.jsx("tr",{className:"sep-row",children:n.jsx("td",{colSpan:6})},`sep-${A}`)),N=y.invoiceNo,w=y.invoiceDate,M=y.minorName||"na",O=void 0,x=y.invoiceNo,v=y.invoiceDate,g=y.minorName):(y.invoiceDate!==v&&(w=y.invoiceDate,v=y.invoiceDate),y.minorName!==g&&(M=y.minorName||"na",g=y.minorName),O="same-invoice"),b.push(n.jsxs("tr",{className:O,children:[n.jsx("td",{className:"col-invno",children:N}),n.jsx("td",{children:M}),n.jsx("td",{children:y.itemName}),n.jsx("td",{style:{textAlign:"right"},children:Number(y.qty??y.qty??0).toLocaleString()}),n.jsx("td",{style:{textAlign:"right"},children:Number(y.curAmt||0).toLocaleString()}),n.jsx("td",{className:"col-invdate",children:w?(()=>{const D=new Date(w);if(isNaN(D.getTime()))return w;const W=String(D.getFullYear()%100).padStart(2,"0"),j=String(D.getMonth()+1).padStart(2,"0"),S=String(D.getDate()).padStart(2,"0"),R=String(D.getHours()).padStart(2,"0"),I=String(D.getMinutes()).padStart(2,"0");return`${W}-${j}-${S} ${R}:${I}`})():""})]},`row-${A}`))}),b})()})]})})]}),[t]);return n.jsxs("div",{children:[n.jsx("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:s&&n.jsx("span",{className:"error",children:s})}),p]})}function Xj(e){if(e==null)return"";const t=Number(e);return isFinite(t)?`${(t<=1?t*100:t).toLocaleString(void 0,{maximumFractionDigits:2})}%`:""}function ng({customerName:e,refreshTick:t=0}){const[r,a]=c.useState([]),[i,s]=c.useState(!1),[o,l]=c.useState(null);async function d(){if(e!=null&&e.trim()){s(!0),l(null);try{const u=new URLSearchParams({customer:e,limit:"1000"}),h=await fetch(`/api/v1/demand?${u.toString()}`);if(!h.ok){const x=await h.json().catch(()=>({}));throw new Error((x==null?void 0:x.error)||`HTTP ${h.status}`)}const p=(await h.json()||[]).map(x=>({itemSubcategory:x.itemSubcategory??null,supplierName:x.supplierName??null,salesMgmtUnit:x.salesMgmtUnit??null,shareRate:x.shareRate??null}));a(p)}catch(u){l(u.message||"로드 중 오류가 발생했습니다")}finally{s(!1)}}}c.useEffect(()=>{d()},[e,t]);const f=c.useMemo(()=>{const u=new Set,h=new Set,m=new Map;for(const v of r){const g=v.itemSubcategory||"-",b=`${v.supplierName||"-"}|${v.salesMgmtUnit||"-"}`;u.add(g),h.add(b);const y=`${g}::${b}`;m.set(y,v.shareRate)}const p=Array.from(u).sort((v,g)=>v.localeCompare(g)),x=Array.from(h).sort((v,g)=>v.localeCompare(g));return{rows:p,cols:x,cell:m}},[r]);return n.jsxs("section",{children:[i&&n.jsx("div",{className:"muted",style:{marginBottom:8},children:"불러오는 중…"}),o&&n.jsx("div",{className:"error",style:{marginTop:8},children:o}),n.jsx("div",{className:"table-container",style:{marginTop:8,border:"1px solid var(--border)",borderRadius:8},children:n.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"separate",borderSpacing:0},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{position:"sticky",left:0,background:"var(--bg)",textAlign:"left",padding:"8px 10px",zIndex:1},children:"중분류"}),f.cols.map(u=>{const[h,m]=u.split("|");return n.jsxs("th",{style:{textAlign:"center",padding:"8px 10px",whiteSpace:"nowrap"},children:[n.jsx("div",{children:h}),n.jsx("div",{className:"muted",style:{fontSize:12},children:m})]},u)})]})}),n.jsx("tbody",{children:f.rows.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:Math.max(1,f.cols.length+1),className:"muted",style:{padding:"12px 10px"},children:i?"불러오는 중…":"데이터가 없습니다"})}):f.rows.map(u=>n.jsxs("tr",{children:[n.jsx("td",{style:{position:"sticky",left:0,background:"var(--bg)",padding:"8px 10px"},children:u}),f.cols.map(h=>{const m=`${u}::${h}`,p=f.cell.get(m)??null;return n.jsx("td",{style:{textAlign:"right",padding:"8px 10px"},children:Xj(p)},h)})]},u))})]})})]})}function Qj(e){if(e==null)return 0;const t=Number(e);return isFinite(t)?t<=1?t*100:t:0}const Ci=["#4e79a7","#f28e2b","#e15759","#76b7b2","#59a14f","#edc949","#af7aa1","#ff9da7","#9c755f","#bab0ab","#1f77b4","#ff7f0e"];function Jj({data:e,size:t=140}){const r=t/2,a=r,i=r,s=e.filter(f=>(f.value||0)>0),o=s.reduce((f,u)=>f+Math.max(0,u.value),0)||1;if(s.length===1)return n.jsx("svg",{width:t,height:t,viewBox:`0 0 ${t} ${t}`,children:n.jsx("circle",{cx:a,cy:i,r,fill:Ci[0],stroke:"#0b1324",strokeWidth:1})});let l=-Math.PI/2;const d=s.map((f,u)=>{const p=Math.max(0,f.value)/o*Math.PI*2,x=a+r*Math.cos(l),v=i+r*Math.sin(l),g=a+r*Math.cos(l+p),b=i+r*Math.sin(l+p),y=p>Math.PI?1:0,A=`M ${a} ${i} L ${x} ${v} A ${r} ${r} 0 ${y} 1 ${g} ${b} Z`;return l+=p,{path:A,color:Ci[u%Ci.length],label:f.label,value:f.value}});return n.jsx("svg",{width:t,height:t,viewBox:`0 0 ${t} ${t}`,children:d.map((f,u)=>n.jsx("path",{d:f.path,fill:f.color,stroke:"#0b1324",strokeWidth:1},u))})}function rg({customerName:e,refreshTick:t=0}){const[r,a]=c.useState([]),[i,s]=c.useState(!1),[o,l]=c.useState(null);async function d(){s(!0),l(null);try{const u=new URLSearchParams({customer:e,limit:"1000"}),h=await fetch(`/api/v1/demand?${u.toString()}`);if(!h.ok){const x=await h.json().catch(()=>({}));throw new Error((x==null?void 0:x.error)||`HTTP ${h.status}`)}const p=(await h.json()||[]).map(x=>({itemSubcategory:x.itemSubcategory??null,supplierName:x.supplierName??null,salesMgmtUnit:x.salesMgmtUnit??null,shareRate:x.shareRate??null}));a(p)}catch(u){l(u.message||"로드 중 오류가 발생했습니다")}finally{s(!1)}}c.useEffect(()=>{e&&d()},[e,t]);const f=c.useMemo(()=>{const u=new Map;for(const h of r){const m=h.itemSubcategory||"-",p=`${h.supplierName||"-"} / ${h.salesMgmtUnit||"-"}`,x=Qj(h.shareRate);u.has(m)||u.set(m,[]);const v=u.get(m),g=v.find(b=>b.label===p);g?g.value+=x:v.push({label:p,value:x})}for(const[h,m]of u)m.sort((p,x)=>x.value-p.value);return u},[r]);return e?n.jsxs("section",{className:"card",style:{marginTop:12},children:[i&&n.jsx("div",{className:"muted",children:ot.loading}),o&&n.jsx("div",{className:"error",children:o||ot.errorGeneric}),!i&&!o&&n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16},children:[Array.from(f.entries()).map(([u,h])=>n.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",border:"1px solid var(--border)",borderRadius:12,padding:12,width:"calc((100% - 16px) / 2)"},children:[n.jsx("div",{style:{flex:"0 0 auto"},children:n.jsx(Jj,{data:h})}),n.jsxs("div",{style:{flex:1,minWidth:0},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6,fontSize:13},children:u}),n.jsxs("div",{style:{fontSize:12},children:[h.slice(0,8).map((m,p)=>n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[n.jsx("span",{style:{width:10,height:10,borderRadius:2,background:Ci[p%Ci.length],display:"inline-block"}}),n.jsx("span",{style:{minWidth:160},children:m.label}),n.jsxs("span",{style:{color:"var(--muted)"},children:[m.value.toLocaleString(void 0,{maximumFractionDigits:2}),"%"]})]},p)),h.length>8&&n.jsxs("div",{className:"muted",children:["외 ",h.length-8,"개…"]})]})]})]},u)),f.size===0&&n.jsx("div",{className:"empty-state",children:"데이터가 없습니다"})]})]}):null}function ag({customerName:e,customerSeq:t,empSeq:r,empName:a,onSuccess:i}){const[s,o]=c.useState([]),[l,d]=c.useState([]),[f,u]=c.useState([]),[h,m]=c.useState(""),[p,x]=c.useState(""),[v,g]=c.useState(""),[b,y]=c.useState(""),[A,C]=c.useState({subcats:!1,suppliers:!1,units:!1,submit:!1}),[N,w]=c.useState(null),[M,O]=c.useState(null);c.useEffect(()=>{async function j(){C(S=>({...S,subcats:!0})),w(null);try{const S=await fetch("/api/v1/supplier/subcategories");if(!S.ok)throw new Error(`HTTP ${S.status}`);const R=await S.json();o(R||[])}catch(S){w(S.message||"중분류 목록을 불러오지 못했습니다")}finally{C(S=>({...S,subcats:!1}))}}j()},[]),c.useEffect(()=>{if(x(""),d([]),g(""),u([]),!h)return;async function j(){C(S=>({...S,suppliers:!0})),w(null);try{const S=new URLSearchParams({subcategory:h}),R=await fetch(`/api/v1/supplier/names?${S.toString()}`);if(!R.ok)throw new Error(`HTTP ${R.status}`);const I=await R.json();d(I||[])}catch(S){w(S.message||"공급사 목록을 불러오지 못했습니다")}finally{C(S=>({...S,suppliers:!1}))}}j()},[h]),c.useEffect(()=>{if(g(""),u([]),!h||!p)return;async function j(){C(S=>({...S,units:!0})),w(null);try{const S=new URLSearchParams({subcategory:h,supplier:p}),R=await fetch(`/api/v1/supplier/units?${S.toString()}`);if(!R.ok)throw new Error(`HTTP ${R.status}`);const I=await R.json();u(I||[])}catch(S){w(S.message||"영업관리단위를 불러오지 못했습니다")}finally{C(S=>({...S,units:!1}))}}j()},[h,p]);const D=c.useMemo(()=>{if(!b)return"";const j=Number(b);if(!isFinite(j))return"숫자를 입력하세요";const S=j<=1?j*100:j;return ot.hint.sharePreview(S)},[b]);async function W(){if(O(null),w(null),!h||!p||!v){w("중분류/공급사/영업관리단위를 선택하세요");return}const j=Number(b);if(!isFinite(j)||j<=0){w("점유율을 올바르게 입력하세요");return}C(S=>({...S,submit:!0}));try{const S={customerSeq:t,customerName:e||void 0,empSeq:r&&r>0?r:void 0,empName:a||void 0,itemSubcategory:h,supplierName:p,salesMgmtUnit:v,share:j},R=await fetch("/api/v1/demand/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)}),I=await R.json().catch(()=>({}));if(!R.ok)throw new Error((I==null?void 0:I.error)||`HTTP ${R.status}`);O("등록되었습니다"),i&&i()}catch(S){w(S.message||"등록 중 오류가 발생했습니다")}finally{C(S=>({...S,submit:!1}))}}return n.jsxs("section",{style:{marginTop:16},children:[n.jsx("h3",{style:{marginTop:0},children:"수요등록"}),n.jsxs("div",{className:"card",style:{padding:12},children:[n.jsxs("div",{className:"form-grid",style:{gridTemplateColumns:"1fr 1fr 1fr 1fr"},children:[n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"중분류"}),n.jsxs("select",{value:h,onChange:j=>m(j.target.value),children:[n.jsx("option",{value:"",children:"선택하세요"}),s.map(j=>n.jsx("option",{value:j,children:j},j))]}),A.subcats&&n.jsx("div",{className:"muted",style:{marginTop:4},children:"불러오는 중…"})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"공급사"}),n.jsxs("select",{value:p,onChange:j=>x(j.target.value),disabled:!h||A.suppliers,children:[n.jsx("option",{value:"",children:"선택하세요"}),l.map(j=>n.jsx("option",{value:j,children:j},j))]})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"영업관리단위"}),n.jsxs("select",{value:v,onChange:j=>g(j.target.value),disabled:!h||!p||A.units,children:[n.jsx("option",{value:"",children:"선택하세요"}),f.map(j=>n.jsx("option",{value:j,children:j},j))]})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"점유율(%)"}),n.jsx(Rt,{value:b,onChange:j=>y(j),placeholder:"예: 0.25 또는 25"}),D&&n.jsx("div",{className:"muted",style:{marginTop:4},children:D})]})]}),N&&n.jsx("div",{className:"error",style:{marginTop:8},children:N||ot.errorGeneric}),M&&n.jsx("div",{className:"muted",style:{marginTop:8},children:M}),n.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:12},children:n.jsx("button",{className:"btn",onClick:W,disabled:A.submit,children:A.submit?ot.fetching:e?`${e}에 ${ot.action.register}`:ot.action.register})})]})]})}const ig=[{value:"Credit / Receivable",label:"신용·채권"},{value:"Pricing / Terms",label:"가격·조건"},{value:"Quality / Claim",label:"품질·클레임"},{value:"Logistics / Delivery",label:"물류·납기"},{value:"Contract / Legal",label:"계약·법무"},{value:"Relationship / Strategic",label:"관계·전략"},{value:"Operational",label:"운영 이슈"},{value:"기타",label:"기타"}],Zj=e=>{if(!e)return"미정";const t=ig.find(r=>r.value===e);return(t==null?void 0:t.label)??e},Ff={noteTitle:"",noteContent:"",noteType:"",importanceLevel:1},e1=e=>{try{const t=new Date(e),r=String(t.getFullYear()).slice(-2),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}catch{return e}},qf=e=>e==null?"중요도 미정":["하","중","상"][Math.min(Math.max(e,0),2)];function t1({customerSeq:e,customerId:t,empName:r}){const[a,i]=c.useState([]),[s,o]=c.useState(!1),[l,d]=c.useState(null),[f,u]=c.useState(0),[h,m]=c.useState(!1),[p,x]=c.useState(!1),[v,g]=c.useState(null),[b,y]=c.useState(()=>({...Ff})),[A,C]=c.useState(null),N=c.useMemo(()=>typeof window>"u"?"":localStorage.getItem("tnt.sales.assigneeId")??"",[]),[w,M]=c.useState(null),[O,D]=c.useState(null),[W,j]=c.useState(!1);c.useEffect(()=>{if(!t){d("고객 ID가 없어 특이사항을 불러올 수 없습니다."),i([]);return}let L=!1;async function ee(){o(!0),d(null);try{const E=await fetch(`/api/v1/customers/${t}/special-notes`);if(!E.ok)throw new Error(`HTTP ${E.status}`);const T=await E.json();if(L)return;const B=Array.isArray(T)?T:[];B.sort((P,_)=>new Date(_.updatedAt??_.createdAt).getTime()-new Date(P.updatedAt??P.createdAt).getTime()),i(B)}catch(E){if(L)return;d(E.message||"특이사항을 불러오지 못했습니다."),i([])}finally{L||o(!1)}}return ee(),()=>{L=!0}},[t,f]);const S=async L=>{if(L.preventDefault(),!t)return;x(!0),g(null);const ee=A!=null,E=N||"system";try{const T={customerId:t,customerSeq:e,noteTitle:b.noteTitle.trim()||"특이사항",noteContent:b.noteContent.trim(),noteType:b.noteType||void 0,importanceLevel:b.importanceLevel},B=ee?`/api/v1/customers/${t}/special-notes/${A.id}`:`/api/v1/customers/${t}/special-notes`,P=ee?"PUT":"POST";ee||(T.createdBy=E),T.updatedBy=E;const _=await fetch(B,{method:P,headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(!_.ok){const U=await _.json().catch(()=>null);throw new Error((U==null?void 0:U.error)||`HTTP ${_.status}`)}I(),u(U=>U+1)}catch(T){g(T.message||(ee?"수정 중 오류가 발생했습니다.":"등록 중 오류가 발생했습니다."))}finally{x(!1)}};c.useEffect(()=>{if(!h)return;const L=ee=>{ee.key==="Escape"&&I()};return window.addEventListener("keydown",L),()=>window.removeEventListener("keydown",L)},[h]);const R=()=>y({...Ff}),I=()=>{m(!1),C(null),R(),g(null)},$=L=>{C(L??null),y({noteTitle:(L==null?void 0:L.noteTitle)??"",noteContent:(L==null?void 0:L.noteContent)??"",noteType:(L==null?void 0:L.noteType)??"",importanceLevel:(L==null?void 0:L.importanceLevel)??1}),g(null),m(!0)},J=L=>{M(L)},q=async()=>{if(!t||!w)return;const L=w;g(null),j(!0);try{const ee=N||"system",E=await fetch(`/api/v1/customers/${t}/special-notes/${L.id}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({updatedBy:ee})});if(!E.ok){const T=await E.json().catch(()=>null);throw new Error((T==null?void 0:T.error)||`HTTP ${E.status}`)}D("특이사항을 삭제했습니다."),i(T=>T.filter(B=>B.id!==L.id)),u(T=>T+1)}catch(ee){g(ee.message||"삭제 중 오류가 발생했습니다.")}finally{j(!1),M(null)}};c.useEffect(()=>{if(!O)return;const L=window.setTimeout(()=>D(null),4e3);return()=>window.clearTimeout(L)},[O]);const K=L=>L==null?"unknown":L>=2?"high":L===1?"medium":"low";return n.jsxs("div",{className:"special-notes",children:[n.jsx("header",{className:"special-notes-header",children:n.jsx("button",{className:"btn btn-card btn-3d",type:"button",onClick:()=>$(),children:"신규"})}),l?n.jsx("div",{className:"empty-state",children:l}):s?n.jsx("div",{className:"empty-state",children:"특이사항을 불러오는 중입니다…"}):a.length===0?n.jsx("div",{className:"empty-state",children:"등록된 특이사항이 없습니다."}):n.jsx("div",{className:"special-notes-list",children:a.map(L=>n.jsxs("article",{className:"special-note-card",children:[n.jsxs("div",{className:"note-actions",children:[n.jsx("button",{type:"button",className:"note-edit-button","aria-label":"특이사항 수정",onClick:()=>$(L),children:"✎"}),n.jsx("button",{type:"button",className:"note-delete-button","aria-label":"특이사항 삭제",onClick:()=>J(L),children:"🗑"})]}),n.jsxs("div",{className:"note-top",children:[n.jsx("span",{className:`importance-dot level-${K(L.importanceLevel)}`,"aria-label":`중요도 ${qf(L.importanceLevel)}`,children:qf(L.importanceLevel)}),n.jsxs("div",{className:"note-meta-info",children:[n.jsx("span",{className:"note-type",children:Zj(L.noteType)}),n.jsx("strong",{className:"note-date",children:e1(L.updatedAt??L.createdAt)})]})]}),n.jsx("strong",{className:"note-title",children:L.noteTitle||"특이사항"}),n.jsx("p",{className:"note-content",children:L.noteContent}),n.jsxs("div",{className:"special-note-meta",children:[n.jsxs("span",{className:"meta-pill",children:[n.jsx("span",{className:"meta-icon edit-icon","aria-hidden":"true",children:"✎"}),n.jsx("span",{children:"수정자"}),n.jsx("strong",{children:L.updatedByName||L.updatedBy||"-"})]}),n.jsxs("span",{className:"meta-pill",children:[n.jsx("span",{className:"meta-icon user-icon","aria-hidden":"true",children:"👤"}),n.jsx("span",{children:"등록자"}),n.jsx("strong",{children:L.createdByName||L.createdBy})]})]})]},L.id))}),h&&n.jsx("div",{className:"overlay-modal",role:"dialog","aria-modal":"true",children:n.jsxs("div",{className:"overlay-card",children:[n.jsx("button",{type:"button",className:"modal-close","aria-label":"닫기",onClick:I,children:"×"}),n.jsx("h4",{children:"특이사항 등록"}),n.jsxs("form",{className:"special-note-form",onSubmit:S,children:[n.jsxs("label",{children:[n.jsx("span",{children:"제목"}),n.jsx("input",{type:"text",value:b.noteTitle,onChange:L=>y(ee=>({...ee,noteTitle:L.target.value})),placeholder:"예: 신용이슈",required:!0})]}),n.jsxs("label",{children:[n.jsx("span",{children:"유형"}),n.jsxs("select",{value:b.noteType,onChange:L=>y(ee=>({...ee,noteType:L.target.value})),children:[n.jsx("option",{value:"",children:"선택 안 함"}),ig.map(L=>n.jsx("option",{value:L.value,children:L.label},L.value))]})]}),n.jsxs("label",{children:[n.jsx("span",{children:"중요도"}),n.jsxs("select",{value:b.importanceLevel,onChange:L=>y(ee=>({...ee,importanceLevel:Number(L.target.value)})),children:[n.jsx("option",{value:2,children:"상"}),n.jsx("option",{value:1,children:"중"}),n.jsx("option",{value:0,children:"하"})]})]}),n.jsxs("label",{children:[n.jsx("span",{children:"내용"}),n.jsx("textarea",{value:b.noteContent,onChange:L=>y(ee=>({...ee,noteContent:L.target.value})),rows:4,required:!0})]}),v?n.jsx("div",{className:"empty-state",children:v}):null,n.jsxs("footer",{children:[n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>m(!1),disabled:p,children:"취소"}),n.jsx("button",{type:"submit",className:"btn btn-card btn-3d",disabled:p,children:p?"등록 중…":"등록"})]})]})]})}),O&&n.jsxs("div",{className:"toast-message",children:[n.jsx("span",{children:O}),n.jsx("button",{type:"button",onClick:()=>D(null),children:"×"})]}),w&&n.jsx("div",{className:"confirm-overlay",role:"dialog","aria-modal":"true",children:n.jsxs("div",{className:"confirm-card",children:[n.jsxs("p",{children:[n.jsx("strong",{children:w.noteTitle||"특이사항"}),"을(를) 삭제하시겠습니까?",n.jsx("br",{}),"삭제하면 되돌릴 수 없습니다."]}),n.jsxs("div",{className:"confirm-actions",children:[n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>M(null),disabled:W,children:"취소"}),n.jsx("button",{type:"button",className:"btn btn-card btn-3d",onClick:q,disabled:W,children:W?"삭제 중…":"삭제"})]})]})})]})}function n1(){const[e,t]=c.useState(()=>{try{const d=localStorage.getItem("tnt.sales.selectedCustomer");return d?JSON.parse(d):null}catch{return null}}),[r,a]=c.useState("transactions"),[i,s]=c.useState(0);c.useEffect(()=>{try{const d=localStorage.getItem("tnt.sales.selectedCustomer");t(d?JSON.parse(d):null)}catch{t(null)}},[]),c.useEffect(()=>{const d=()=>{try{const f=localStorage.getItem("tnt.sales.selectedCustomer");t(f?JSON.parse(f):null)}catch{t(null)}};return window.addEventListener("tnt.sales.customer.selected",d),()=>window.removeEventListener("tnt.sales.customer.selected",d)},[]);const o=c.useMemo(()=>n.jsx(eg,{compact:!0,maxHeight:"32vh",context:"c360"}),[]),l=()=>!e||e.customerSeq==null?n.jsx("div",{className:"empty-state",children:"거래처를 선택하세요."}):r==="transactions"?n.jsx(tg,{customerSeq:e.customerSeq}):r==="activities"?n.jsx(bd,{customerSeq:e.customerSeq,customerId:e.customerId||"",hideRefresh:!0,enableContextMenu:!0}):r==="demand"?e.customerName?n.jsxs("div",{className:"c360-demand-stack",children:[n.jsx(ng,{customerName:e.customerName,refreshTick:i}),n.jsx(rg,{customerName:e.customerName,refreshTick:i}),n.jsx(ag,{customerName:e.customerName,customerSeq:e.customerSeq,empSeq:e.empSeq,empName:e.empName||void 0,onSuccess:()=>s(d=>d+1)})]}):n.jsx("div",{className:"empty-state",children:"수요정보를 보려면 거래처명을 확인하세요."}):r==="special-notes"?n.jsx(t1,{customerSeq:e.customerSeq,customerId:e.customerId,empName:e.empName}):r==="complaint"?n.jsx("div",{className:"card",style:{padding:12},children:n.jsx("div",{className:"muted",children:"Complaint 기능은 추후 제공될 예정입니다."})}):null;return n.jsxs("section",{className:"c360",children:[o,n.jsxs("section",{className:"card c360-panel",style:{marginTop:12,minHeight:240},children:[n.jsxs("div",{className:"tabs c360-tabs",children:[n.jsx("button",{className:r==="transactions"?"tab active":"tab",onClick:()=>a("transactions"),children:"거래 내역"}),n.jsx("button",{className:r==="activities"?"tab active":"tab",onClick:()=>a("activities"),children:"영업활동"}),n.jsx("button",{className:r==="demand"?"tab active":"tab",onClick:()=>a("demand"),children:"수요정보"}),n.jsx("button",{className:r==="special-notes"?"tab active":"tab",onClick:()=>a("special-notes"),children:"특이사항"}),n.jsx("button",{className:r==="complaint"?"tab active":"tab",onClick:()=>a("complaint"),children:"Complaint"})]}),n.jsx("div",{className:`c360-tab-panel-wrapper ${r==="demand"?"c360-demand-scroll":""}`,children:n.jsx("div",{className:"c360-tab-panel",children:l()})})]})]})}function sg({open:e,onClose:t,leadId:r,leadName:a,targetKind:i,targetCompanyType:s,editId:o,initial:l,onSaved:d}){const{ref:f,style:u,bindHeader:h,bindContainer:m}=jn("lead.activity",e,N=>{const w=document.querySelector(".pane.center"),M=w?w.getBoundingClientRect():null,O=N.getBoundingClientRect(),D=O.width,W=O.height,j=M?M.left+(M.width-D)/2:(window.innerWidth-D)/2,S=M?M.top+Math.max(24,(M.height-W)*.2):Math.max(24,(window.innerHeight-W)*.2);return{x:j,y:S}},{persist:!1,resetOnOpen:!0});c.useEffect(()=>{if(!e)return;const N=w=>{w.key==="Escape"&&t()};return window.addEventListener("keydown",N,!0),()=>window.removeEventListener("keydown",N,!0)},[e,t]);const p=c.useCallback(()=>{o||t()},[o,t]),x=i||(r?"lead":void 0),v=(()=>{const N=(a??"").toString().trim();return N||((l==null?void 0:l.customerName)??"").toString().trim()})(),g=(s??"").toString().trim().toUpperCase(),b=x==="lead"?"잠":g.includes("TNT")?"T":g.includes("DYS")?"D":g?g.slice(0,1):"거",y=x==="lead"?"잠재고객":g||"거래처",A=x?n.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:22,height:22,borderRadius:"50%",fontSize:12,fontWeight:700,background:x==="lead"?"rgba(236,72,153,.2)":"rgba(59,130,246,.2)",color:x==="lead"?"#be185d":"#1d4ed8"},title:y,children:b}):null,C=o?"영업활동":"영업활동 등록";return e?n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:11e3,pointerEvents:"none"},children:[n.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)",pointerEvents:"none"}}),n.jsxs("div",{ref:f,className:"card",style:{...u,width:"min(880px, 96vw)",maxHeight:"86vh",overflow:"auto",padding:16,pointerEvents:"auto"},...m,children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6,cursor:"move"},...h,children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[n.jsx("h3",{style:{margin:0},children:C}),v||A?n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,fontSize:13,fontWeight:600,color:"var(--text)"},children:[v?n.jsx("span",{children:v}):null,A]}):null]}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:t,children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})})]}),n.jsx(Fi,{bare:!0,editId:o??void 0,leadId:r??void 0,initial:l,onNoticeClose:p,onSaved:N=>{d?d():t()}})]})]}):null}function pi(e){if(!e)return"";const t=new Date(e);if(isNaN(t.getTime()))return"";const r=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0");return`${r}-${a}-${i}`}function ys(e,t=0){if(!e)return;const r=e.trim();if(!r)return;const[a,i,s]=r.split("-").map(l=>Number(l));if(!a||!i||!s)return;const o=new Date(a,i-1,s,t,0,0,0);if(!isNaN(o.getTime()))return o.toISOString()}function Uf(e){if(e.type==="customer"){const t=(e.companyType??"").toString().trim(),r=t||"거래처",a=t.toUpperCase(),i=a.includes("TNT")?"T":a.includes("DYS")?"D":(a||"거")[0];return{label:r,bg:"rgba(59,130,246,.12)",color:"#1d4ed8",icon:i,iconBg:"#1d4ed8"}}return{label:"잠재",bg:"rgba(236,72,153,.12)",color:"#be185d",icon:"잠",iconBg:"#be185d"}}function r1({onClose:e,prefillAt:t}){const[r,a]=ke.useState(""),[i,s]=ke.useState([]),[o,l]=ke.useState(!1),[d,f]=ke.useState(null),[u,h]=ke.useState([]),[m,p]=ke.useState(null);async function x(){l(!0),f(null);try{const y=new URL("/api/v1/customers",window.location.origin);y.searchParams.set("mineOnly","false"),r.trim()&&y.searchParams.set("name",r.trim()),y.searchParams.set("limit","100");try{console.debug("[customer search]",y.toString())}catch{}const A=await fetch(y.toString());if(!A.ok)throw new Error(`HTTP ${A.status}`);const C=await A.json(),N=Array.isArray(C)?C.map(w=>({customerSeq:(w==null?void 0:w.customerSeq)??(w==null?void 0:w.customer_seq)??null,customerId:(w==null?void 0:w.customerId)??(w==null?void 0:w.customer_id)??null,customerName:(w==null?void 0:w.customerName)??(w==null?void 0:w.customer_name)??null,ownerName:(w==null?void 0:w.ownerName)??(w==null?void 0:w.owner_name)??null,companyType:(w==null?void 0:w.companyType)??(w==null?void 0:w.company_type)??null})).sort((w,M)=>String(w.customerName||"").localeCompare(String(M.customerName||""),"ko-KR")):[];s(N)}catch(y){f((y==null?void 0:y.message)||"조회 실패"),s([])}finally{l(!1)}}function v(y){h(A=>{const N=A.some(w=>(w.customerId||"")===(y.customerId||""))?A:[y,...A];return!m&&N.length>0&&b(N[0]),N})}function g(y){if(h(A=>A.filter(C=>(C.customerId||"")!==(y.customerId||""))),m&&(m.customerId||"")===(y.customerId||"")){const A=u.filter(C=>(C.customerId||"")!==(y.customerId||""));b(A[0]||null)}}function b(y){p(y||null);try{y&&localStorage.setItem("tnt.sales.selectedCustomer",JSON.stringify({customerId:y.customerId||"",customerName:y.customerName||""}))}catch{}}return ke.useEffect(()=>{const y=A=>{A.key==="Escape"&&e()};return window.addEventListener("keydown",y,!0),()=>window.removeEventListener("keydown",y,!0)},[e]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:12e3},children:[n.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"6%",left:"50%",transform:"translateX(-50%)",width:"min(1200px,96vw)",maxHeight:"88vh",overflow:"auto",padding:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[n.jsx("h3",{style:{margin:0},children:"거래처 활동계획수립"}),n.jsx("button",{className:"btn-plain","aria-label":"닫기",title:"닫기",onClick:e,style:{width:32,height:32,display:"inline-flex",alignItems:"center",justifyContent:"center"},children:n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),n.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr",gap:12,minHeight:520,alignItems:"start"},children:[n.jsxs("div",{className:"card",style:{padding:12,overflow:"auto"},children:[n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"거래처명",value:r,onChange:y=>a(y.target.value),onKeyDown:y=>{y.key==="Enter"&&x()},style:{flex:"0 0 220px",height:28,fontSize:12}}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button",title:"조회","aria-label":"조회",onClick:x,children:n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:[n.jsx("circle",{cx:"11",cy:"11",r:"8"}),n.jsx("path",{d:"m21 21-4.35-4.35"})]})})]}),n.jsx("div",{className:"table-container",style:{maxHeight:240,overflowY:"auto",overflowX:"hidden",fontSize:12},children:i.length===0?n.jsx("div",{className:"empty-state",children:o?"불러오는 중…":d||"검색 결과가 없습니다"}):n.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:100},children:"회사구분"}),n.jsx("th",{style:{width:180},children:"거래처명"}),n.jsx("th",{style:{width:120},children:"대표자명"}),n.jsx("th",{style:{width:48}})]})}),n.jsx("tbody",{children:i.map((y,A)=>n.jsxs("tr",{children:[n.jsx("td",{title:y.companyType||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.companyType||""}),n.jsx("td",{title:y.customerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.customerName||""}),n.jsx("td",{title:y.ownerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.ownerName||""}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx("span",{role:"button",tabIndex:0,className:"icon-button",title:"계획수립대상 담기","aria-label":"계획수립대상 담기",onClick:()=>v(y),children:n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:[n.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),n.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]})})})]},A))})]})}),n.jsxs("div",{style:{marginTop:12,fontWeight:700},children:["계획수립대상(",u.length,")"]}),n.jsx("div",{className:"table-container",style:{maxHeight:220,overflowY:"auto",overflowX:"hidden",fontSize:12},children:u.length===0?n.jsx("div",{className:"empty-state",children:"담긴 거래처가 없습니다."}):n.jsxs("table",{className:"table",style:{tableLayout:"fixed",width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:100},children:"회사구분"}),n.jsx("th",{style:{width:180},children:"거래처명"}),n.jsx("th",{style:{width:120},children:"대표자명"}),n.jsx("th",{style:{width:60},children:"작업"})]})}),n.jsx("tbody",{children:u.map((y,A)=>n.jsxs("tr",{className:m&&(m.customerId||"")===(y.customerId||"")?"selected":"",onClick:()=>b(y),children:[n.jsx("td",{title:y.companyType||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.companyType||""}),n.jsx("td",{title:y.customerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.customerName||""}),n.jsx("td",{title:y.ownerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:y.ownerName||""}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx("span",{role:"button",tabIndex:0,className:"icon-button",title:"삭제","aria-label":"삭제",onClick:C=>{C.stopPropagation(),g(y)},children:n.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:n.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})})})})]},A))})]})})]}),n.jsxs("div",{className:"card plan-compact-card",style:{overflow:"auto"},children:[!m&&n.jsx("div",{className:"empty-state",children:"좌측에서 거래처를 선택해 주세요."}),n.jsx(Fi,{bare:!0,initial:{plannedStartAt:t||void 0,...m?{sfAccountId:m.customerId||"",customerName:m.customerName||"",subject:m!=null&&m.customerName?`${m.customerName} (활동계획) 으로 저장됩니다.`:""}:{}},lockSubject:!0,planMode:!0,multiTargets:u})]})]})]})]})}function a1(e){const t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=t.getDay()||7;return r!==1&&t.setDate(t.getDate()-(r-1)),t.setHours(0,0,0,0),t}function i1(e){const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),r=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-r);const a=new Date(Date.UTC(t.getUTCFullYear(),0,1)),i=Math.ceil(((t.getTime()-a.getTime())/864e5+1)/7);return{year:t.getUTCFullYear(),week:i}}function s1(e){const t=e.getFullYear(),r=e.getMonth()+1;return`${t}년 ${r}월`}function o1(e){return String(e.getDate())}const l1=Array.from({length:24},(e,t)=>t),Da=60,Hf=18,Yl=18;function c1(){const[e,t]=ke.useState(()=>new Date),r=ke.useMemo(()=>i1(e),[e]),a=ke.useMemo(()=>a1(e),[e]),i=ke.useMemo(()=>{const re=new Date(a);return re.setDate(a.getDate()+6),re.setHours(23,59,59,999),re},[a]),s=ke.useMemo(()=>Array.from({length:7}).map((re,xe)=>{const ye=new Date(a);return ye.setDate(a.getDate()+xe),ye}),[a]),o=ke.useRef(null),[l,d]=ke.useState(()=>({open:!1,x:0,y:0})),f=ke.useRef(null),[u,h]=ke.useState(!1),[m,p]=ke.useState(!1),[x,v]=ke.useState([]),[g,b]=ke.useState(""),[y,A]=ke.useState([]),[C,N]=ke.useState(""),[w,M]=ke.useState(""),[O,D]=ke.useState(""),[W,j]=ke.useState(""),[S,R]=ke.useState(""),[I,$]=ke.useState(""),[J,q]=ke.useState(""),[K,L]=ke.useState(!1),[ee,E]=ke.useState(null),[T,B]=ke.useState(null),[P,_]=ke.useState(null),[U,fe]=ke.useState(""),[ae,F]=ke.useState([]),[pe,H]=ke.useState(!1),[Q,ge]=ke.useState(null),[je,Ne]=ke.useState([]),[Y,ve]=ke.useState(null),[se,Le]=ke.useState([]),[Fe,Ie]=ke.useState([]),[Ve,yt]=ke.useState(null),[It,nn]=ke.useState(null),[He,lt]=ke.useState(""),[ht,rn]=ke.useState(null),[ct,Tt]=ke.useState(""),[rt,_n]=ke.useState(void 0),[Lt,ea]=ke.useState(!1),ta=ke.useRef(null),vn=ke.useMemo(()=>{const re=new Array(24).fill(0).map(()=>Da);if(!se||se.length===0)return re;const xe=new Array(24).fill(0),ye=new Date(a.getFullYear(),a.getMonth(),a.getDate());for(let De=0;De<24;De++){let ce=0;for(let Oe=0;Oe<7;Oe++){const Se=new Date(ye);Se.setDate(Se.getDate()+Oe);const Be=Se.getFullYear(),qe=Se.getMonth(),Ye=Se.getDate(),Ue=se.reduce((At,it)=>{if(!it.plannedStartAt)return At;const tt=new Date(it.plannedStartAt);return tt.getFullYear()===Be&&tt.getMonth()===qe&&tt.getDate()===Ye&&tt.getHours()===De?At+1:At},0);Ue>ce&&(ce=Ue)}xe[De]=ce}for(let De=0;De<24;De++){const ce=Math.max(0,xe[De]-1);re[De]=Math.min(Da+ce*Yl,Da+64)}return re},[se,a]),hn=ke.useMemo(()=>{const re=[0];for(let xe=0;xe<24;xe++)re[xe+1]=re[xe]+(vn[xe]||Da);return re},[vn]),an=ke.useCallback(async()=>{try{const re=localStorage.getItem("tnt.sales.assigneeId")||"",xe=localStorage.getItem("tnt.sales.empId")||"",ye=new URL("/api/v1/sales-activities",window.location.origin);re?ye.searchParams.set("assigneeId",re):xe&&ye.searchParams.set("empId",xe),ye.searchParams.set("mineOnly","true"),ye.searchParams.set("start",a.toISOString()),ye.searchParams.set("end",i.toISOString()),ye.searchParams.set("onlyRoot","true"),ye.searchParams.set("_t",Date.now().toString());const De=await fetch(ye.toString(),{cache:"no-cache"});if(!De.ok)throw new Error(`HTTP ${De.status}`);const ce=await De.json(),Oe=Array.isArray(ce)?ce:[];Le(Oe.map(Se=>{const Be=Se.plannedStartAt||Se.planned_start_at,qe=(Se.activityStatus||Se.activity_status||"").toString().toLowerCase(),Ye=qe==="completed"||qe==="완료";return{id:Number(Se.id),subject:Se.subject,description:Se.description,activityType:Se.activityType||Se.activity_type,activityStatus:Se.activityStatus||Se.activity_status,channel:Se.channel,plannedStartAt:Be?new Date(Be).toISOString():void 0,plannedEndAt:Se.plannedEndAt||Se.planned_end_at||null,actualStartAt:Se.actualStartAt||Se.actual_start_at||void 0,sfAccountId:Se.sfAccountId||Se.sf_account_id||void 0,customerName:Se.customerName||Se.customer_name||"",leadId:Se.sfLeadId||Se.sf_lead_id||null,companyType:Se.companyType||Se.company_type||Se.companyTypeName||Se.company_type_name||null,isCompleted:Ye}}))}catch{Le([])}},[a,i]),Hn=ke.useCallback(async()=>{try{const re=localStorage.getItem("tnt.sales.assigneeId")||localStorage.getItem("tnt.sales.empId")||"";if(!re){Ie([]);return}const xe=new URL("/api/v1/region-activity-plans",window.location.origin);xe.searchParams.set("assigneeId",re),xe.searchParams.set("start",a.toISOString()),xe.searchParams.set("end",i.toISOString());const ye=await fetch(xe.toString());if(!ye.ok)throw new Error(`HTTP ${ye.status}`);const De=await ye.json(),ce=Array.isArray(De)?De:[];Ie(ce.map(Oe=>({id:Number(Oe.id),subject:Oe.subject,plannedStartAt:Oe.planned_start_at||Oe.plannedStartAt||null,plannedEndAt:Oe.planned_end_at||Oe.plannedEndAt||null,actualStartAt:Oe.actual_start_at||Oe.actualStartAt||null,actualEndAt:Oe.actual_end_at||Oe.actualEndAt||null,isCompleted:!!(Oe.actual_start_at||Oe.actualStartAt||Oe.actual_end_at||Oe.actualEndAt)})))}catch{Ie([])}},[a,i]);ke.useEffect(()=>{an()},[an]),ke.useEffect(()=>{Hn()},[Hn]),ke.useEffect(()=>{const re=()=>{try{an()}catch{}};return window.addEventListener("tnt.sales.activity.updated",re),()=>window.removeEventListener("tnt.sales.activity.updated",re)},[an]);const Ia=`${r.week}주차`,Ta=s1(e),kt=ke.useCallback(()=>{t(re=>{const xe=new Date(re);return xe.setDate(xe.getDate()-7),xe})},[]),Zn=ke.useCallback(()=>{t(re=>{const xe=new Date(re);return xe.setDate(xe.getDate()+7),xe})},[]),li=ke.useCallback(()=>{t(new Date)},[]);ke.useEffect(()=>{function re(ye){let De=ye;for(;De;){const ce=(De.tagName||"").toLowerCase();if(["input","textarea","select","button","label","a"].includes(ce)||De!=null&&De.isContentEditable)return!0;De=De.parentElement}return!1}function xe(ye){const De=ye.target;re(De)||re(document.activeElement)||(ye.key==="ArrowLeft"?(ye.preventDefault(),kt()):ye.key==="ArrowRight"&&(ye.preventDefault(),Zn()))}return window.addEventListener("keydown",xe,!0),()=>window.removeEventListener("keydown",xe,!0)},[kt,Zn]);const er=ke.useRef(!1);ke.useEffect(()=>{if(er.current)return;const re=o.current;if(!re)return;const xe=hn[7]||7*Da;let ye=0;const De=30,ce=()=>{if(re){if(re.scrollTop=xe,ye+=1,Math.abs(re.scrollTop-xe)<2||ye>=De){er.current=!0;return}setTimeout(()=>requestAnimationFrame(ce),50)}};requestAnimationFrame(ce)},[hn]),ke.useEffect(()=>{if(!l.open)return;const re=ye=>{const De=(ye==null?void 0:ye.target)||null;f.current&&De&&f.current.contains(De)||d({open:!1,x:0,y:0})},xe=ye=>{ye.key==="Escape"&&re()};return window.addEventListener("click",re,!0),window.addEventListener("contextmenu",re,!0),window.addEventListener("keydown",xe,!0),()=>{window.removeEventListener("click",re,!0),window.removeEventListener("contextmenu",re,!0),window.removeEventListener("keydown",xe,!0)}},[l.open]);const tr=ke.useCallback(async()=>{try{const re=await fetch("/api/v1/address/provinces"),xe=re.ok?await re.json():[],ye=Array.isArray(xe)?xe.filter(Boolean):[];v(ye)}catch{v([])}},[]),xn=ke.useCallback(async re=>{try{if(!re){A([]);return}const xe=new URL("/api/v1/address/districts",window.location.origin);xe.searchParams.set("province",re);const ye=await fetch(xe.toString()),De=ye.ok?await ye.json():[],ce=Array.isArray(De)?De.filter(Boolean):[];A(ce)}catch{A([])}},[]),Kn=ke.useCallback(()=>{M(""),D(""),j(""),R(""),$(""),q(""),E(null),Ne([]),_(null)},[]),Qe=ke.useCallback(()=>{Kn();const re=Y?pi(Y):"";j(re),b(""),N(""),A([]),p(!0),tr()},[Y,tr,Kn]),Mn=ke.useCallback(()=>{Kn(),B(null),p(!1)},[Kn]);ke.useEffect(()=>{if(!m)return;const re=xe=>{xe.key==="Escape"&&(xe.preventDefault(),Mn())};return window.addEventListener("keydown",re,!0),()=>window.removeEventListener("keydown",re,!0)},[m,Mn]);const na=ke.useCallback(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||localStorage.getItem("tnt.sales.empId")||""}catch{return""}},[]);ke.useEffect(()=>{if(!m||w&&w.trim().length>0||!g)return;const re=C?`${g} ${C}`:g;M(`${re} 지역활동`)},[m,w,g,C]);async function ur(re){try{const xe=await fetch(`/api/v1/region-activity-plans/${re}`);if(!xe.ok)throw new Error(`HTTP ${xe.status}`);const ye=await xe.json();Kn(),_(re),M((ye==null?void 0:ye.subject)||""),D((ye==null?void 0:ye.description)||"");const De=(ye==null?void 0:ye.addrProvinceName)||(ye==null?void 0:ye.addr_province_name)||"",ce=(ye==null?void 0:ye.addrDistrictName)||(ye==null?void 0:ye.addr_district_name)||"";await tr(),b(De),De?await xn(De):A([]),N(ce),j(ye!=null&&ye.planned_start_at?pi(ye.planned_start_at):""),R(ye!=null&&ye.planned_end_at?pi(ye.planned_end_at):""),$(ye!=null&&ye.actual_start_at?pi(ye.actual_start_at):""),q(ye!=null&&ye.actual_end_at?pi(ye.actual_end_at):"");const Oe=Array.isArray(ye==null?void 0:ye.targets)?ye.targets:[];Ne(Oe.map((Se,Be)=>{const qe=(Se==null?void 0:Se.customerId)||(Se==null?void 0:Se.customer_id)||"",Ye=(Se==null?void 0:Se.leadId)||(Se==null?void 0:Se.lead_id)||"",Ue=qe?"customer":"lead";return{key:qe?`customer-${qe}`:Ye?`lead-${Ye}`:`target-${Be}-${re}`,type:Ue,name:(Se==null?void 0:Se.displayName)||(Se==null?void 0:Se.display_name)||qe||Ye||"(대상)",companyType:(Se==null?void 0:Se.companyType)||(Se==null?void 0:Se.company_type)||null,customerId:qe||void 0,leadId:Ye||void 0}})),p(!0)}catch(xe){window.alert((xe==null?void 0:xe.message)||"지역활동 계획을 불러오지 못했습니다.")}}async function ci(){const re=w.trim();if(!re){E("제목을 입력해 주세요."),B(null);return}if(!g){E("방문 도(Province)를 선택해 주세요."),B(null);return}if(!C){E("방문 시/군/구(District)를 선택해 주세요."),B(null);return}const xe=na().trim();if(!xe){E("담당자 정보를 확인할 수 없습니다. 다시 로그인해 주세요."),B(null);return}const ye={subject:re,addrProvinceName:g,addrDistrictName:C,assigneeId:xe},De=O==null?void 0:O.trim();De&&(ye.description=De);const ce=ys(W,8),Oe=ys(S);ce&&(ye.plannedStartAt=ce),Oe&&(ye.plannedEndAt=Oe);const Se=ys(I),Be=ys(J);Se&&(ye.actualStartAt=Se),Be&&(ye.actualEndAt=Be);const qe=je.map(Ue=>Ue.type==="customer"&&Ue.customerId?{customerId:Ue.customerId}:Ue.type==="lead"&&Ue.leadId?{leadId:Ue.leadId}:null).filter(Boolean);qe.length>0&&(ye.targets=qe);const Ye=Number(xe);Number.isNaN(Ye)||(P||(ye.createdBy=Ye),ye.updatedBy=Ye),L(!0),E(null),B(null);try{const Ue=P?`/api/v1/region-activity-plans/${P}`:"/api/v1/region-activity-plans",it=await fetch(Ue,{method:P?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ye)});let tt=null;try{tt=await it.json()}catch{tt=null}if(!it.ok){const Xt=(tt==null?void 0:tt.message)||(tt==null?void 0:tt.error)||`HTTP ${it.status}`;throw new Error(Xt)}B(P?"지역활동 계획이 수정되었습니다.":"지역활동 계획이 등록되었습니다."),E(null),await Hn()}catch(Ue){E((Ue==null?void 0:Ue.message)||"등록에 실패했습니다."),B(null)}finally{L(!1)}}async function fr(){const re=U.trim();if(!re){ge("검색어를 입력해 주세요."),F([]);return}H(!0),ge(null);try{const[xe,ye]=await Promise.all([(async()=>{const ce=new URL("/api/v1/customers",window.location.origin);ce.searchParams.set("mineOnly","false"),ce.searchParams.set("limit","50"),ce.searchParams.set("name",re);const Oe=await fetch(ce.toString());if(!Oe.ok)throw new Error(`거래처 조회 실패 (HTTP ${Oe.status})`);const Se=await Oe.json();return Array.isArray(Se)?Se:[]})(),(async()=>{const ce=new URL("/api/v1/leads",window.location.origin);ce.searchParams.set("limit","50"),ce.searchParams.set("company_name",re);const Oe=await fetch(ce.toString());if(!Oe.ok)throw new Error(`잠재고객 조회 실패 (HTTP ${Oe.status})`);const Se=await Oe.json();return Array.isArray(Se)?Se:[]})()]),De=[...xe.map((ce,Oe)=>{const Se=(ce==null?void 0:ce.customerId)??(ce==null?void 0:ce.customer_id)??(ce==null?void 0:ce.customerSeq)??(ce==null?void 0:ce.customer_seq)??"",Be=Se!=null?String(Se).trim():"",qe=Be?`customer-${Be}`:`customer-${Oe}-${Math.random().toString(36).slice(2)}`,Ye=(ce==null?void 0:ce.companyType)??(ce==null?void 0:ce.company_type)??(ce==null?void 0:ce.companyTypeName)??(ce==null?void 0:ce.company_type_name)??(ce==null?void 0:ce.companyClass)??(ce==null?void 0:ce.company_class)??(ce==null?void 0:ce.companyGroup)??(ce==null?void 0:ce.company_group)??null;return{key:qe,type:"customer",name:(ce==null?void 0:ce.customerName)??(ce==null?void 0:ce.customer_name)??"(이름 없음)",companyType:Ye!=null?String(Ye):null,customerId:Be||void 0}}),...ye.map((ce,Oe)=>{const Se=(ce==null?void 0:ce.id)??(ce==null?void 0:ce.lead_id)??"",Be=Se!=null?String(Se).trim():"";return{key:Be?`lead-${Be}`:`lead-${Oe}-${Math.random().toString(36).slice(2)}`,type:"lead",name:(ce==null?void 0:ce.company_name)??(ce==null?void 0:ce.companyName)??(ce==null?void 0:ce.contact_name)??"(이름 없음)",leadId:Be||void 0}})];F(De),De.length===0&&ge("조회 결과가 없습니다.")}catch(xe){ge((xe==null?void 0:xe.message)||"조회에 실패했습니다."),F([])}finally{H(!1)}}function ra(re){Ne(xe=>xe.some(ye=>ye.key===re.key)?xe:[...xe,re])}function nr(re){Ne(xe=>xe.filter(ye=>ye.key!==re))}const aa=ke.useCallback(re=>{yt(re.id);const xe=re.leadId?"lead":"customer";ta.current!==re.id?(nn(re.leadId??null),lt(re.customerName||""),rn(xe),Tt(xe==="customer"&&re.companyType||""),_n({id:re.id,subject:re.subject,description:re.description,activityType:re.activityType,activityStatus:re.activityStatus,channel:re.channel,plannedStartAt:re.plannedStartAt,actualStartAt:re.actualStartAt,sfAccountId:re.sfAccountId,customerName:re.customerName}),ta.current=re.id):rn(xe),ea(!0)},[]),at=ke.useCallback(()=>{ea(!1),yt(null),nn(null),lt(""),rn(null),Tt(""),_n(void 0),ta.current=null},[]),Mt=ke.useMemo(()=>{const re=se.length,xe=se.filter(Be=>Be.isCompleted).length,ye=Fe.length,De=Fe.filter(Be=>Be.isCompleted).length,ce=re+ye,Oe=xe+De,Se=ce>0?Math.round(Oe/ce*100):0;return{customerTotal:re,customerCompleted:xe,regionTotal:ye,regionCompleted:De,totalPlanned:ce,totalCompleted:Oe,achievementRate:Se}},[se,Fe]);return n.jsxs("section",{className:"activity-plan-page",children:[n.jsx("div",{className:"card",style:{padding:"12px 16px",marginBottom:12,flexShrink:0},children:n.jsxs("div",{style:{display:"flex",gap:4,alignItems:"center"},children:[n.jsx("button",{onClick:kt,title:"이전 주",style:{width:32,height:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"var(--text)",transition:"background-color 0.2s"},onMouseEnter:re=>re.currentTarget.style.backgroundColor="var(--hover)",onMouseLeave:re=>re.currentTarget.style.backgroundColor="transparent",children:n.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:n.jsx("polyline",{points:"15 18 9 12 15 6"})})}),n.jsx("button",{onClick:Zn,title:"다음 주",style:{width:32,height:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:"4px",cursor:"pointer",color:"var(--text)",transition:"background-color 0.2s"},onMouseEnter:re=>re.currentTarget.style.backgroundColor="var(--hover)",onMouseLeave:re=>re.currentTarget.style.backgroundColor="transparent",children:n.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:n.jsx("polyline",{points:"9 18 15 12 9 6"})})}),n.jsx("button",{className:"btn",onClick:li,style:{marginLeft:4},children:"오늘"}),n.jsxs("span",{className:"badge",style:{marginLeft:"auto"},children:[Ta," ",Ia]})]})}),n.jsxs("div",{className:"activity-kpi-grid",children:[n.jsxs("div",{className:"card kpi-card",style:{background:"linear-gradient(135deg, rgba(59,130,246,0.1) 0%, rgba(147,51,234,0.1) 100%)"},children:[n.jsx("div",{className:"kpi-label",children:"주간 달성률"}),n.jsxs("div",{className:"kpi-value",children:[n.jsx("span",{className:"kpi-number",children:Mt.achievementRate}),n.jsx("span",{className:"kpi-unit",children:"%"})]}),n.jsxs("div",{className:"kpi-desc",children:["목표 ",Mt.totalPlanned,"건 / 완료 ",Mt.totalCompleted,"건"]})]}),n.jsxs("div",{className:"card kpi-card",children:[n.jsx("div",{className:"kpi-label",children:"거래처 활동"}),n.jsxs("div",{className:"kpi-stats",children:[n.jsxs("div",{children:[n.jsx("div",{className:"kpi-stat-label",style:{color:"#dc2626"},children:"목표"}),n.jsx("div",{className:"kpi-stat-value",style:{color:"#dc2626"},children:Mt.customerTotal})]}),n.jsx("div",{className:"kpi-arrow",children:"→"}),n.jsxs("div",{children:[n.jsx("div",{className:"kpi-stat-label",style:{color:"#2563eb"},children:"완료"}),n.jsx("div",{className:"kpi-stat-value",style:{color:"#2563eb"},children:Mt.customerCompleted})]})]}),n.jsx("div",{className:"kpi-progress",children:n.jsx("div",{style:{width:`${Mt.customerTotal>0?Mt.customerCompleted/Mt.customerTotal*100:0}%`,background:"linear-gradient(90deg, #dc2626 0%, #2563eb 100%)"}})})]}),n.jsxs("div",{className:"card kpi-card",children:[n.jsx("div",{className:"kpi-label",children:"지역 활동"}),n.jsxs("div",{className:"kpi-stats",children:[n.jsxs("div",{children:[n.jsx("div",{className:"kpi-stat-label",style:{color:"#dc2626"},children:"목표"}),n.jsx("div",{className:"kpi-stat-value",style:{color:"#dc2626"},children:Mt.regionTotal})]}),n.jsx("div",{className:"kpi-arrow",children:"→"}),n.jsxs("div",{children:[n.jsx("div",{className:"kpi-stat-label",style:{color:"#10b981"},children:"완료"}),n.jsx("div",{className:"kpi-stat-value",style:{color:"#10b981"},children:Mt.regionCompleted})]})]}),n.jsx("div",{className:"kpi-progress",children:n.jsx("div",{style:{width:`${Mt.regionTotal>0?Mt.regionCompleted/Mt.regionTotal*100:0}%`,background:"linear-gradient(90deg, #dc2626 0%, #10b981 100%)"}})})]})]}),n.jsxs("div",{className:"card",style:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",minHeight:0},children:[n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px repeat(7, 1fr)",background:"var(--panel)",borderBottom:"1px solid var(--border)",flex:"0 0 auto"},children:[n.jsx("div",{style:{padding:8,fontSize:12,color:"var(--text-muted)"},children:"시간"}),s.map((re,xe)=>n.jsx("div",{style:{padding:8,textAlign:"center",borderLeft:xe>0?"1px solid var(--border)":"none"},children:n.jsxs("div",{style:{fontSize:12,color:"var(--text-muted)"},children:[["월","화","수","목","금","토","일"][xe]," ",o1(re)]})},xe))]}),n.jsx("div",{ref:o,className:"calendar-scroll",onContextMenu:re=>{re.preventDefault();const xe=re.target;let ye=null,De=null;const ce=Be=>{var it,tt;if(!Be)return!1;const qe=Be.getAttribute("data-day")||((it=Be.dataset)==null?void 0:it.day),Ye=Be.getAttribute("data-hour")||((tt=Be.dataset)==null?void 0:tt.hour),Ue=qe?parseInt(qe,10):NaN,At=Ye?parseInt(Ye,10):NaN;return!Number.isNaN(Ue)&&!Number.isNaN(At)?(ye=Ue,De=At,!0):!1},Oe=xe?xe.closest(".week-event"):null,Se=xe?xe.closest(".week-cell"):null;if(!(ce(Oe)||ce(Se))){const Be=o.current;if(Be){const qe=Be.getBoundingClientRect(),Ye=re.clientX-qe.left,Ue=re.clientY-qe.top+Be.scrollTop,At=Ye-60,it=Math.max(1,(qe.width-60)/7),tt=Math.floor(At/it);let hr=0;for(let Xt=0;Xt<24&&Ue>=hn[Xt];Xt++)hr=Xt;tt>=0&&tt<=6&&hr>=0&&hr<=23&&(ye=tt,De=hr)}}if(ye!=null&&De!=null){const Be=new Date(a);Be.setDate(Be.getDate()+ye),Be.setHours(De,0,0,0),ve(new Date(Be).toISOString())}d({open:!0,x:re.clientX,y:re.clientY})},style:{flex:1,overflowY:"scroll",overflowX:"hidden",minHeight:0},children:n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"60px repeat(7, 1fr)",gridTemplateRows:vn.map(re=>`${re}px`).join(" "),position:"relative"},children:[l1.map(re=>n.jsxs(ke.Fragment,{children:[n.jsxs("div",{style:{gridColumn:"1",gridRow:`${re+1}`,height:vn[re]||Da,padding:"4px 8px",fontSize:11,color:"var(--text-muted)",borderTop:"1px solid var(--border)"},children:[String(re).padStart(2,"0"),":00"]}),s.map((xe,ye)=>n.jsx("div",{className:"week-cell","data-day":ye,"data-hour":re,style:{gridColumn:`${ye+2}`,gridRow:`${re+1}`,borderTop:"1px solid var(--border)",borderLeft:"1px solid var(--border)"}},`${re}-${ye}`))]},re)),(()=>{const re=new Map,xe=se.map(ce=>{if(!ce.plannedStartAt)return null;const Oe=new Date(ce.plannedStartAt),Se=Math.floor((new Date(Oe.getFullYear(),Oe.getMonth(),Oe.getDate()).getTime()-new Date(a.getFullYear(),a.getMonth(),a.getDate()).getTime())/864e5);if(Se<0||Se>6)return null;const Be=Oe.getHours(),qe=`${Se}-${Be}`,Ye=re.get(qe)||0;re.set(qe,Ye+1);const Ue=ce.isCompleted?"(완)":"(계)",At=ce.isCompleted?"#2563eb":"#dc2626";return n.jsxs("div",{className:"week-event","data-day":Se,"data-hour":Be,onDoubleClick:it=>{it.stopPropagation(),aa(ce)},style:{gridColumn:`${Se+2}`,gridRow:`${Be+1}`,height:Hf,padding:"0 6px",fontSize:10,background:"rgba(59,130,246,.12)",border:"1px solid var(--accent)",borderRadius:6,margin:1,marginTop:Ye*Yl,display:"flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left"},title:ce.subject||"",children:[n.jsx("span",{style:{color:At,fontWeight:700,marginRight:4},children:Ue}),n.jsx("span",{children:ce.subject||"(제목 없음)"})]},`ev-${ce.id}-${Ye}`)}),ye=new Date(a.getFullYear(),a.getMonth(),a.getDate()),De=Fe.map(ce=>{if(!ce.plannedStartAt)return null;const Oe=new Date(ce.plannedStartAt);if(isNaN(Oe.getTime()))return null;const Se=Math.floor((new Date(Oe.getFullYear(),Oe.getMonth(),Oe.getDate()).getTime()-ye.getTime())/864e5);if(Se<0||Se>6)return null;const Be=Oe.getHours(),qe=`${Se}-${Be}`,Ye=re.get(qe)||0;re.set(qe,Ye+1);const Ue=ce.isCompleted||!!ce.actualEndAt,At=Ue?"(완)":"(계)",it=Ue?"#2563eb":"#dc2626";return n.jsxs("div",{className:"week-event","data-day":Se,"data-hour":Be,onDoubleClick:tt=>{tt.stopPropagation(),ur(ce.id)},style:{gridColumn:`${Se+2}`,gridRow:`${Be+1}`,height:Hf,padding:"0 6px",fontSize:10,background:"rgba(16,185,129,.18)",border:"1px solid rgba(16,185,129,.6)",borderRadius:6,margin:1,marginTop:Ye*Yl,display:"flex",alignItems:"center",justifyContent:"flex-start",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",textAlign:"left"},title:ce.subject||"",children:[n.jsx("span",{style:{color:it,fontWeight:700,marginRight:4},children:At}),n.jsx("span",{children:ce.subject||"(지역활동)"})]},`region-${ce.id}-${Se}-${Be}-${Ye}`)}).filter(Boolean);return[...xe,...De]})()]})})]}),l.open&&n.jsxs("div",{className:"context-menu",role:"menu",ref:f,style:{position:"fixed",left:l.x+6,top:l.y+6,zIndex:20050},children:[n.jsx("button",{className:"context-item",role:"menuitem",onClick:()=>{d({open:!1,x:0,y:0}),h(!0)},children:"거래처활동"}),n.jsx("button",{className:"context-item",role:"menuitem",onClick:()=>{d({open:!1,x:0,y:0}),Qe()},children:"지역활동"})]}),u&&n.jsx(r1,{onClose:()=>h(!1),prefillAt:Y}),m&&n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:13e3},children:[n.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),n.jsx("div",{style:{position:"absolute",top:"8%",left:"50%",transform:"translateX(-50%)",width:"min(920px,96vw)",maxHeight:"84vh"},children:n.jsxs("div",{className:"card plan-compact-card",style:{height:"100%",overflow:"auto",padding:12,position:"relative"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[n.jsx("h3",{style:{margin:0},children:"지역활동 계획"}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:Mn,children:n.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"icon",children:[n.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),n.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"minmax(0,1fr) minmax(0,380px)",gap:12},children:[n.jsxs("div",{className:"plan-compact",style:{display:"flex",flexDirection:"column",gap:8},children:[n.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[n.jsx("label",{children:"제목"}),n.jsx("input",{className:"subject-input",value:w,onChange:re=>M(re.target.value),placeholder:"예: 서울 강남구 지역활동"})]}),n.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[n.jsx("label",{children:"도 선택"}),n.jsxs("select",{value:g,onChange:re=>{const xe=re.target.value;b(xe),N(""),xn(xe)},style:{height:32},children:[n.jsx("option",{value:"",children:"— 선택 —"}),x.map((re,xe)=>n.jsx("option",{value:re,children:re},`${re}-${xe}`))]})]}),n.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[n.jsx("label",{children:"시군 선택"}),n.jsxs("select",{value:C,onChange:re=>N(re.target.value),disabled:!g,style:{height:32},children:[n.jsx("option",{value:"",children:"— 선택 —"}),y.map((re,xe)=>n.jsx("option",{value:re,children:re},`${re}-${xe}`))]})]}),n.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[n.jsx("label",{children:"계획 일정"}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:n.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[n.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:n.jsx("input",{className:"subject-input",type:"date",value:W,onChange:re=>j(re.target.value),style:{flex:1}})}),n.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"~"}),n.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:n.jsx("input",{className:"subject-input",type:"date",value:S,onChange:re=>R(re.target.value),style:{flex:1}})})]})})]}),n.jsxs("div",{className:"field",style:{display:"grid",gridTemplateColumns:"90px 1fr",gap:6,alignItems:"center"},children:[n.jsx("label",{children:"완료일"}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:n.jsxs("div",{style:{display:"flex",gap:6,alignItems:"center",flexWrap:"wrap"},children:[n.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:n.jsx("input",{className:"subject-input",type:"date",value:I,onChange:re=>$(re.target.value),style:{flex:1}})}),n.jsx("span",{style:{fontSize:12,color:"var(--text-muted)"},children:"~"}),n.jsx("div",{style:{flex:1,minWidth:160,display:"flex",gap:4},children:n.jsx("input",{className:"subject-input",type:"date",value:J,onChange:re=>q(re.target.value),style:{flex:1}})})]})})]}),n.jsxs("div",{className:"field",style:{display:"flex",flexDirection:"column",gap:4},children:[n.jsx("label",{children:"활동계획/설명"}),n.jsx("textarea",{value:O,onChange:re=>D(re.target.value),placeholder:"방문 목적, 세부 활동계획, 비고 등을 입력해 주세요.",rows:4,style:{resize:"vertical",padding:8}})]})]}),n.jsxs("div",{className:"card",style:{padding:10,background:"var(--panel-2)",borderRadius:12,display:"flex",flexDirection:"column",gap:8,minHeight:0},children:[n.jsx("div",{style:{fontWeight:600,fontSize:13},children:"영업대상 조회/등록"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:6},children:[n.jsx("input",{className:"subject-input",placeholder:"거래처 또는 잠재고객명으로 검색",value:U,onChange:re=>fe(re.target.value),onKeyDown:re=>{re.key==="Enter"&&(re.preventDefault(),fr())}}),n.jsx("button",{className:"btn",type:"button",onClick:fr,disabled:pe,children:"조회"})]}),n.jsx("div",{className:"table-container",style:{maxHeight:220,overflowY:"auto",overflowX:"hidden",background:"var(--panel)",borderRadius:8,padding:6},children:pe?n.jsx("div",{className:"empty-state",children:"조회 중…"}):ae.length===0?n.jsx("div",{className:"empty-state",children:Q||"조회 결과가 없습니다."}):ae.map(re=>{const xe=Uf(re);return n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 4px",borderBottom:"1px solid var(--border)"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,minWidth:0},children:[n.jsx("span",{title:re.name,style:{fontSize:13,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:1},children:re.name}),n.jsx("span",{title:xe.label,style:{width:22,height:22,borderRadius:"50%",background:xe.bg,color:xe.color,fontWeight:700,display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:12},children:n.jsx("span",{style:{width:18,height:18,borderRadius:"50%",background:xe.iconBg,color:"#fff",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:11},children:xe.icon})})]}),n.jsx("button",{className:"btn-ghost",type:"button",onClick:()=>ra(re),style:{width:28,height:28,display:"inline-flex",alignItems:"center",justifyContent:"center",border:"none"},"aria-label":"등록",children:n.jsx("span",{style:{fontSize:18,lineHeight:1},children:"+"})})]},re.key)})}),n.jsxs("div",{style:{fontWeight:600,fontSize:12},children:["등록된 대상 (",je.length,")"]}),n.jsx("div",{className:"table-container",style:{maxHeight:140,overflowY:"auto",background:"var(--panel)",borderRadius:8,padding:6},children:je.length===0?n.jsx("div",{className:"empty-state",children:"등록된 대상이 없습니다."}):je.map(re=>{const xe=Uf(re);return n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 2px",borderBottom:"1px dashed var(--border)"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,minWidth:0},children:[n.jsx("span",{title:re.name,style:{fontSize:13,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",flex:1},children:re.name}),n.jsx("span",{title:xe.label,style:{width:22,height:22,borderRadius:"50%",background:xe.bg,color:xe.color,fontWeight:700,display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:12},children:n.jsx("span",{style:{width:18,height:18,borderRadius:"50%",background:xe.iconBg,color:"#fff",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:11},children:xe.icon})})]}),n.jsx("button",{className:"btn-ghost",type:"button",onClick:()=>nr(re.key),style:{width:28,height:28,display:"inline-flex",alignItems:"center",justifyContent:"center",border:"none"},"aria-label":"삭제",children:n.jsx("span",{style:{fontSize:22,lineHeight:1},children:"−"})})]},`selected-${re.key}`)})})]})]}),ee&&n.jsx("div",{style:{color:"#dc2626",fontSize:12,marginTop:8},children:ee}),T&&n.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center",gap:8,border:"1px solid #10b981",background:"#ecfdf5",padding:"6px 10px",borderRadius:6},children:[n.jsx("span",{style:{color:"#047857",fontWeight:600},children:T}),n.jsx("button",{className:"btn btn-plain",type:"button",onClick:()=>B(null),style:{padding:"2px 8px",fontSize:12},children:"확인"})]}),n.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:12},children:[n.jsx("button",{className:"btn",type:"button",onClick:Mn,children:"취소"}),n.jsx("button",{className:"btn btn-accent",type:"button",onClick:ci,disabled:K,children:K?"저장 중…":"저장"})]})]})})]}),n.jsx(sg,{open:Lt&&Ve!=null,onClose:at,editId:Ve??void 0,leadId:It&&/^\d+$/.test(It)?Number(It):void 0,leadName:He,targetKind:ht??void 0,targetCompanyType:ct||void 0,initial:rt,onSaved:()=>{setTimeout(()=>an(),50)}})]})}function d1(){const[e,t]=c.useState(()=>{try{const l=localStorage.getItem("tnt.sales.selectedCustomer");return l?JSON.parse(l):null}catch{return null}}),[r,a]=c.useState("transactions"),[i,s]=c.useState(0);c.useEffect(()=>{try{const l=localStorage.getItem("tnt.sales.selectedCustomer");t(l?JSON.parse(l):null)}catch{t(null)}},[]);const o=c.useMemo(()=>e?n.jsx("section",{className:"card compact-form",children:n.jsxs("div",{className:"form-grid",children:[n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"거래처번호"}),n.jsx(Rt,{value:e.customerId||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"거래처명"}),n.jsx(Rt,{value:e.customerName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"정식명"}),n.jsx(Rt,{value:e.customerFullName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"사업자번호"}),n.jsx(Rt,{value:e.bizNo||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"대표자명"}),n.jsx(Rt,{value:e.ownerName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"전화번호"}),n.jsx(Rt,{value:e.telNo||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"고객유형"}),n.jsx(Rt,{value:e.customerTypeName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"시/도"}),n.jsx(Rt,{value:e.addrProvinceName||"",readOnly:!0})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"시/군/구"}),n.jsx(Rt,{value:e.addrCityName||"",readOnly:!0})]}),n.jsxs("div",{className:"field row-2",children:[n.jsx("label",{children:"비고"}),n.jsx(Rt,{value:e.customerRemark||"",readOnly:!0})]})]})}):n.jsx("div",{className:"empty-state",children:"선택된 거래처가 없습니다."}),[e]);return n.jsxs("section",{className:"c360",children:[n.jsx("div",{className:"page-title"}),o,n.jsxs("section",{className:"card",style:{marginTop:12,minHeight:240},children:[n.jsxs("div",{className:"tabs c360-tabs",children:[n.jsx("button",{className:r==="transactions"?"tab active":"tab",onClick:()=>a("transactions"),children:"거래 내역"}),n.jsx("button",{className:r==="activities"?"tab active":"tab",onClick:()=>a("activities"),children:"영업활동"}),n.jsx("button",{className:r==="demand"?"tab active":"tab",onClick:()=>a("demand"),children:"수요정보"})]}),n.jsxs("div",{style:{marginTop:12},children:[r==="transactions"&&(e==null?void 0:e.customerSeq)!=null&&n.jsx(tg,{customerSeq:e.customerSeq}),r==="activities"&&(e==null?void 0:e.customerSeq)!=null&&n.jsx(bd,{customerSeq:e.customerSeq,customerId:e.customerId||"",hideRefresh:!0,enableContextMenu:!0}),r==="demand"&&(e==null?void 0:e.customerName)&&n.jsxs(n.Fragment,{children:[n.jsx(ng,{customerName:e.customerName,refreshTick:i}),n.jsx(rg,{customerName:e.customerName,refreshTick:i}),n.jsx(ag,{customerName:e.customerName,customerSeq:e.customerSeq,empSeq:e.empSeq,empName:e.empName||void 0,onSuccess:()=>s(l=>l+1)})]}),(!e||e.customerSeq==null)&&n.jsx("div",{className:"empty-state",children:"탭을 선택하세요"})]})]})]})}function vs(e){const t=new Date(e);return t.setDate(1),t.setHours(0,0,0,0),t}function Kf(e,t){const r=new Date(e);return r.setMonth(r.getMonth()+t),r}function $a(e,t){const r=new Date(e);return r.setDate(r.getDate()+t),r}function Gl(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function u1(){const[e,t]=c.useState(()=>vs(new Date)),r=new Date,[a,i]=c.useState([]),[s,o]=c.useState([]),[l,d]=c.useState(!1),[f,u]=c.useState(null),[h,m]=c.useState("month"),[p,x]=c.useState({open:!1,x:0,y:0}),[v,g]=c.useState(0),[b,y]=c.useState(null),[A,C]=c.useState({open:!1}),N=c.useMemo(()=>{const q=[];if(h==="month"){const K=vs(e),L=K.getDay(),ee=new Date(K);ee.setDate(K.getDate()-L);for(let E=0;E<42;E++){const T=new Date(ee);T.setDate(ee.getDate()+E),q.push({date:T,inMonth:T.getMonth()===e.getMonth(),isToday:Gl(T,r)})}}else if(h==="week"){const K=new Date(e),L=K.getDay(),ee=new Date(K);ee.setDate(K.getDate()-L);for(let E=0;E<7;E++){const T=new Date(ee);T.setDate(ee.getDate()+E),q.push({date:T,inMonth:!0,isToday:Gl(T,r)})}}else{const K=new Date(e);q.push({date:K,inMonth:!0,isToday:Gl(K,r)})}return q},[e,h]),w=c.useMemo(()=>{const q=e.getFullYear(),K=String(e.getMonth()+1).padStart(2,"0"),L=String(e.getDate()).padStart(2,"0");if(h==="month")return`${q}.${K}`;if(h==="week"){const ee=e.getDay(),E=$a(new Date(e),-ee),T=$a(new Date(E),6),B=String(E.getMonth()+1).padStart(2,"0"),P=String(E.getDate()).padStart(2,"0"),_=String(T.getMonth()+1).padStart(2,"0"),U=String(T.getDate()).padStart(2,"0");return`${q}.${B}.${P} ~ ${T.getFullYear()}.${_}.${U}`}return`${q}.${K}.${L}`},[e,h]);c.useEffect(()=>{const q=localStorage.getItem("tnt.sales.assigneeId");if(!q){u("로그인이 필요합니다"),i([]),o([]),d(!1);return}u(null),d(!0),(async()=>{const K=[],L=new Date(N[0].date);L.setHours(0,0,0,0);const ee=new Date(N[N.length-1].date);ee.setHours(23,59,59,999);try{const E=new URL("/api/v1/sales-activities",window.location.origin);E.searchParams.set("mineOnly","true"),E.searchParams.set("assigneeId",String(q)),E.searchParams.set("start",L.toISOString()),E.searchParams.set("end",ee.toISOString());const T=await fetch(E.toString());if(!T.ok){let _=`HTTP ${T.status}`;try{const U=await T.json();U!=null&&U.error&&(_=U.error)}catch{}throw new Error(_)}const B=await T.json(),P=Array.isArray(B)?B.map(_=>({id:Number(_==null?void 0:_.id),subject:(_==null?void 0:_.subject)??void 0,plannedStartAt:(_==null?void 0:_.plannedStartAt)??(_==null?void 0:_.planned_start_at)??void 0,plannedEndAt:(_==null?void 0:_.plannedEndAt)??(_==null?void 0:_.planned_end_at)??null,activityStatus:(_==null?void 0:_.activityStatus)??(_==null?void 0:_.activity_status)??void 0,leadId:(_==null?void 0:_.sfLeadId)??(_==null?void 0:_.sf_lead_id)??(_==null?void 0:_.leadId)??(_==null?void 0:_.lead_id)??null,source:"sales"})):[];i(P)}catch(E){K.push((E==null?void 0:E.message)||"활동 조회 중 오류가 발생했습니다"),i([])}try{const E=new URL("/api/v1/region-activity-plans",window.location.origin);E.searchParams.set("assigneeId",String(q)),E.searchParams.set("start",L.toISOString()),E.searchParams.set("end",ee.toISOString());const T=await fetch(E.toString());if(!T.ok)throw new Error(`HTTP ${T.status}`);const B=await T.json(),P=Array.isArray(B)?B.map(_=>{const U=(_==null?void 0:_.plannedStartAt)??(_==null?void 0:_.planned_start_at)??null,fe=(_==null?void 0:_.plannedEndAt)??(_==null?void 0:_.planned_end_at)??null,ae=!!(_!=null&&_.actualStartAt||_!=null&&_.actual_start_at||_!=null&&_.actualEndAt||_!=null&&_.actual_end_at),F=_!=null&&_.subject?`[지역] ${_.subject}`:"지역활동";return{id:Number(_==null?void 0:_.id),subject:F,plannedStartAt:U||void 0,plannedEndAt:fe||null,activityStatus:ae?"completed":"region",leadId:null,source:"region"}}):[];o(P)}catch(E){K.push((E==null?void 0:E.message)||"지역활동 조회 중 오류가 발생했습니다"),o([])}u(K.length?K.join(" / "):null),d(!1)})()},[e,h,N,v]);const M=c.useMemo(()=>{const q=new Map,K=[...a,...s];if(!K||K.length===0)return q;const L=new Date(N[0].date),ee=new Date(N[N.length-1].date);ee.setHours(23,59,59,999);for(const E of K){if(!E.plannedStartAt&&!E.plannedEndAt)continue;const T=E.plannedStartAt?new Date(E.plannedStartAt):null,B=E.plannedEndAt?new Date(E.plannedEndAt):T;if(!T)continue;const P=T,_=B||T;if(_<L||P>ee)continue;const U=`${P.getFullYear()}-${String(P.getMonth()+1).padStart(2,"0")}-${String(P.getDate()).padStart(2,"0")}`,fe=P.toTimeString().slice(0,5),ae=_.toTimeString().slice(0,5),F=q.get(U)||[];F.push({id:E.id,subject:E.subject,time:fe,endTime:ae,status:E.activityStatus,start:P,end:_,leadId:E.leadId??null,source:E.source}),q.set(U,F)}return q},[a,s,N]);function O(q){return q.getHours()*60+q.getMinutes()}function D(q){const K=Math.floor(q/60).toString().padStart(2,"0"),L=(q%60).toString().padStart(2,"0");return`${K}:${L}`}const W=ke.useCallback(q=>{const K=new Date(q);K.setHours(0,0,0,0);const L=new Date(q);L.setHours(23,59,59,999);const ee=[],E=[...a,...s];for(const T of E){const B=T.plannedStartAt?new Date(T.plannedStartAt):null,P=T.plannedEndAt?new Date(T.plannedEndAt):B;if(!B)continue;const _=P||B;if(_<K||B>L)continue;const U=B<K?K:B,fe=_>L?L:_;ee.push({id:T.id,subject:T.subject,status:T.activityStatus,start:U,end:fe,leadId:T.leadId??null,source:T.source})}return ee.sort((T,B)=>T.start.getTime()-B.start.getTime()),ee},[a,s]),j=c.useCallback(()=>{x({open:!1,x:0,y:0,event:void 0})},[]);c.useEffect(()=>{if(!p.open)return;const q=L=>{L.target.closest(".context-menu")||j()},K=L=>{L.key==="Escape"&&j()};return window.addEventListener("click",q,!0),window.addEventListener("contextmenu",q,!1),window.addEventListener("keydown",K,!0),()=>{window.removeEventListener("click",q,!0),window.removeEventListener("contextmenu",q,!0),window.removeEventListener("keydown",K,!0)}},[p.open,j]);function S(q,K){K.source!=="region"&&(q.preventDefault(),q.stopPropagation(),x({open:!0,x:q.clientX,y:q.clientY,event:K}))}async function R(q){const K=q==null?void 0:q.id;if(K)try{const L=await fetch(`/api/v1/sales-activities/${K}`);if(!L.ok)throw new Error(`HTTP ${L.status}`);const ee=await L.json(),E=(ee==null?void 0:ee.customerName)||(ee==null?void 0:ee.customer_name)||"";C({open:!0,event:q,customerName:E})}catch(L){console.error("활동 상세 조회 실패:",L),C({open:!0,event:q,customerName:""})}}async function I(){var K;const q=(K=A.event)==null?void 0:K.id;if(!q){C({open:!1});return}try{const L=await fetch(`/api/v1/sales-activities/${q}`,{method:"DELETE"});if(!L.ok)throw new Error(`HTTP ${L.status}`);i(ee=>ee.filter(E=>E.id!==q));try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated",{detail:{id:q}}))}catch{}C({open:!1}),j()}catch(L){window.alert((L==null?void 0:L.message)||"삭제 중 오류가 발생했습니다"),C({open:!1})}}function $(){C({open:!1})}c.useEffect(()=>{(h==="week"||h==="day")&&setTimeout(()=>{document.querySelectorAll(".day-timeline").forEach(q=>{q.scrollTop=7*40})},0)},[h,N]);async function J(q){q.source!=="region"&&q!=null&&q.id&&y(q.id)}return c.useEffect(()=>{if(h!=="week")return;const q=Array.from(document.querySelectorAll(".day-timeline"));if(q.length===0)return;const K=L=>{const ee=L.target,E=ee.scrollTop;q.forEach(T=>{T!==ee&&(T.scrollTop=E)})};return q.forEach(L=>L.addEventListener("scroll",K)),()=>q.forEach(L=>L.removeEventListener("scroll",K))},[h,N]),c.useEffect(()=>{if(!b)return;const q=K=>{K.key==="Escape"&&(K.preventDefault(),K.stopPropagation(),y(null))};return window.addEventListener("keydown",q,!0),()=>window.removeEventListener("keydown",q,!0)},[b]),n.jsxs(n.Fragment,{children:[n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",children:[n.jsx("h2",{children:"일정"}),n.jsx("div",{className:"meta",children:n.jsx("button",{className:"btn",onClick:()=>t(vs(new Date)),children:"오늘"})})]}),n.jsxs("div",{className:"card",style:{padding:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("button",{className:"btn",onClick:()=>t(q=>h==="month"?Kf(q,-1):h==="week"?$a(q,-7):$a(q,-1)),children:"〈"}),n.jsx("div",{style:{fontWeight:700},children:w}),n.jsx("button",{className:"btn",onClick:()=>t(q=>h==="month"?Kf(q,1):h==="week"?$a(q,7):$a(q,1)),children:"〉"})]}),n.jsxs("div",{style:{display:"flex",gap:6},children:[n.jsx("button",{className:"btn",onClick:()=>{m("month"),t(vs(new Date))},disabled:h==="month",children:"월"}),n.jsx("button",{className:"btn",onClick:()=>{m("week"),t(new Date)},disabled:h==="week",children:"주"}),n.jsx("button",{className:"btn",onClick:()=>{m("day"),t(new Date)},disabled:h==="day",children:"일"})]})]}),f&&n.jsx("div",{className:"error",style:{marginBottom:8},children:f}),l&&n.jsx("div",{className:"muted",style:{marginBottom:8},children:"활동 불러오는 중…"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:`repeat(${h==="day"?1:7}, 1fr)`,gap:4},children:[(h==="day"?[""]:["일","월","화","수","목","금","토"]).map((q,K)=>n.jsx("div",{style:{textAlign:"center",color:"var(--muted)",padding:"6px 0"},children:q},K)),h==="month"&&N.map((q,K)=>n.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8,padding:8,height:120,overflow:"hidden",display:"flex",flexDirection:"column",background:q.inMonth?"transparent":"var(--panel-2)",outline:q.isToday?"2px solid var(--accent)":"none"},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6,opacity:q.inMonth?1:.6},children:q.date.getDate()}),(()=>{const L=`${q.date.getFullYear()}-${String(q.date.getMonth()+1).padStart(2,"0")}-${String(q.date.getDate()).padStart(2,"0")}`,ee=M.get(L)||[];return ee.length?n.jsxs("div",{className:"cal-events",style:{overflow:"hidden"},children:[ee.slice(0,3).map((E,T)=>n.jsxs("div",{className:`cal-pill status-${(E.status||"scheduled").replaceAll(" ","_")}`,title:E.subject||"",onClick:()=>{E.source!=="region"&&J(E)},onContextMenu:B=>{E.source!=="region"&&S(B,E)},style:{cursor:E.source==="region"?"default":"pointer"},children:[n.jsx("span",{className:"time",children:E.time}),n.jsx("span",{className:"subj",children:E.subject||"활동"})]},T)),ee.length>3&&n.jsxs("div",{className:"muted",style:{fontSize:12,marginTop:4},children:["+",ee.length-3," 더보기"]})]}):null})()]},K)),(h==="week"||h==="day")&&(()=>{const K=.6666666666666666;return N.map((L,ee)=>{const E=`${L.date.getFullYear()}-${String(L.date.getMonth()+1).padStart(2,"0")}-${String(L.date.getDate()).padStart(2,"0")}`,T=(M.get(E)||[]).sort((P,_)=>P.start.getTime()-_.start.getTime()),B=h==="day"?W(L.date):T;return n.jsxs("div",{style:{border:"1px solid var(--border)",borderRadius:8,padding:8},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6},children:L.date.getDate()}),n.jsxs("div",{className:"day-timeline",style:{position:"relative",height:960,borderTop:"1px solid var(--border)",overflowY:"auto",maxHeight:480},children:[[...Array(24)].map((P,_)=>n.jsx("div",{style:{position:"absolute",top:_*40,left:0,right:0,borderTop:"1px dashed var(--border)",fontSize:10,color:"var(--muted)"},children:n.jsxs("span",{style:{position:"absolute",left:0,transform:"translateY(-50%)",paddingLeft:4},children:[_,":00"]})},_)),B.map((P,_)=>{const U=O(P.start),fe=O(P.end),ae=U*K,F=Math.max(20,(fe-U)*K);return n.jsxs("div",{className:`cal-pill status-${(P.status||"scheduled").replaceAll(" ","_")}`,style:{position:"absolute",top:ae,left:60,right:4,height:F},title:`${D(U)}~${D(fe)} ${P.subject||""}`,onClick:()=>{P.source!=="region"&&J(P)},onContextMenu:pe=>{P.source!=="region"&&S(pe,P)},"aria-disabled":P.source==="region"?!0:void 0,children:[n.jsx("span",{className:"time",children:D(U)}),n.jsx("span",{className:"subj",children:P.subject||"활동"})]},_)})]})]},ee)})})()]}),p.open&&p.event&&n.jsxs("div",{className:"context-menu",style:{left:p.x+4,top:p.y+4},onClick:q=>q.stopPropagation(),children:[n.jsx("button",{className:"context-item",onClick:()=>{y(p.event.id),j()},children:"활동 수정"}),n.jsx("button",{className:"context-item",onClick:()=>{j(),R(p.event)},children:"활동 삭제"})]})]})]}),b&&n.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:9999,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.4)"},onClick:()=>y(null),children:n.jsxs("div",{className:"card",style:{width:"min(920px, 92vw)",maxHeight:"90vh",overflow:"auto",padding:16,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,boxShadow:"0 8px 32px rgba(0,0,0,.2)"},onClick:q=>q.stopPropagation(),children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[n.jsx("h3",{style:{margin:0,fontSize:16,fontWeight:700},children:"영업활동 수정"}),n.jsx("button",{onClick:()=>y(null),style:{width:32,height:32,display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",border:"none",borderRadius:4,cursor:"pointer",color:"var(--muted)",fontSize:20,transition:"all 0.2s"},onMouseEnter:q=>{q.currentTarget.style.background="var(--panel-2)",q.currentTarget.style.color="var(--text)"},onMouseLeave:q=>{q.currentTarget.style.background="transparent",q.currentTarget.style.color="var(--muted)"},title:"닫기 (ESC)",children:"×"})]}),n.jsx(Fi,{bare:!0,editId:b,onSaved:()=>{y(null),g(q=>q+1)},onNoticeClose:()=>y(null)})]})}),A.open&&n.jsx("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e4,display:"flex",alignItems:"center",justifyContent:"center",background:"rgba(0,0,0,.5)"},onClick:$,children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:20,border:"1px solid var(--border)",borderRadius:12,minWidth:320,maxWidth:"86vw",boxShadow:"0 8px 32px rgba(0,0,0,.3)"},onClick:q=>q.stopPropagation(),children:[n.jsx("div",{style:{marginBottom:16,fontSize:16,fontWeight:700,color:"var(--text)",textAlign:"center"},children:"활동 삭제"}),n.jsxs("div",{style:{marginBottom:20,fontSize:14,color:"var(--text)",textAlign:"center",lineHeight:1.6},children:[A.customerName&&n.jsx("div",{style:{marginBottom:8,fontWeight:600,color:"var(--primary)"},children:A.customerName}),n.jsx("div",{children:"정말로 삭제하시겠습니까?"})]}),n.jsxs("div",{style:{display:"flex",gap:8,justifyContent:"center"},children:[n.jsx("button",{className:"btn",onClick:$,style:{minWidth:80,background:"var(--panel-2)",border:"1px solid var(--border)",color:"var(--text)",display:"flex",alignItems:"center",justifyContent:"center"},children:"취소"}),n.jsx("button",{className:"btn",onClick:I,style:{minWidth:80,background:"#dc2626",border:"1px solid #b91c1c",color:"#fff",display:"flex",alignItems:"center",justifyContent:"center"},children:"삭제"})]})]})})]})}function f1(){const[e,t]=c.useState(()=>{const S=new Date;return S.setMinutes(S.getMinutes()-S.getTimezoneOffset()),S.toISOString().slice(0,10)}),[r,a]=c.useState(null),[i,s]=c.useState(new Array(12).fill(0)),[o,l]=c.useState(new Array(12).fill(0)),[d,f]=c.useState([]),[u,h]=c.useState([]),[m,p]=c.useState(!1),[x,v]=c.useState(null),[g,b]=c.useState("compare");async function y(S){p(!0),v(null);try{const R=await fetch(`/api/v1/dashboard/sales-summary?date=${encodeURIComponent(S)}`),I=await R.json().catch(()=>({}));if(!R.ok||I&&I.error)throw new Error(I.error||`HTTP ${R.status}`);a(I);const $=new Date(S),J=$.getFullYear(),q=J-1,K=S,[L,ee]=await Promise.all([fetch(`/api/v1/dashboard/monthly?year=${q}`),fetch(`/api/v1/dashboard/monthly?year=${J}&until=${encodeURIComponent(K)}`)]),E=await L.json().catch(()=>[]),T=await ee.json().catch(()=>[]),B=pe=>{const H=new Array(12).fill(0);return Array.isArray(pe)&&pe.forEach(Q=>{const ge=Number(Q==null?void 0:Q.month),je=Number((Q==null?void 0:Q.amount)||0);ge>=1&&ge<=12&&(H[ge-1]=je)}),H};s(B(E)),l(B(T));const P=$.getMonth()+1,[_,U]=await Promise.all([fetch(`/api/v1/dashboard/daily?year=${q}&month=${P}`),fetch(`/api/v1/dashboard/daily?year=${J}&month=${P}&until=${encodeURIComponent(K)}`)]),fe=await _.json().catch(()=>[]),ae=await U.json().catch(()=>[]),F=(pe,H,Q)=>{let ge=31;try{ge=new Date(H,Q,0).getDate()}catch{}const je=new Array(ge).fill(0);return Array.isArray(pe)&&pe.forEach(Ne=>{const Y=Number(Ne==null?void 0:Ne.day),ve=Number((Ne==null?void 0:Ne.amount)||0);Y>=1&&Y<=ge&&(je[Y-1]=ve)}),je};f(F(fe,q,P)),h(F(ae,J,P))}catch(R){v((R==null?void 0:R.message)||"조회 중 오류가 발생했습니다"),a(null)}finally{p(!1)}}c.useEffect(()=>{y(e)},[]);const A=S=>{if(S==null)return"-";try{return new Intl.NumberFormat("ko-KR").format(S)}catch{return String(S)}},C=new Date(e),N=C.getFullYear(),w=C.getMonth()+1,M=C.getDate(),O=S=>String(S).padStart(2,"0"),D=N-1,W=new Date(D,w,0).getDate(),j=Math.min(M,W);return n.jsxs("section",{style:{display:"flex",flexDirection:"column",fontSize:12},children:[n.jsxs("div",{className:"tabs",style:{display:"flex",gap:8,padding:"6px 8px",marginBottom:8},children:[n.jsx("button",{className:g==="compare"?"tab active":"tab",onClick:()=>b("compare"),children:"전년동기 매출비교"}),n.jsx("button",{className:g==="arrears"?"tab active":"tab",onClick:()=>b("arrears"),children:"미수 분석"})]}),g==="compare"?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"page-title",children:[n.jsx("h2",{children:"전년동기 매출비교"}),n.jsx("div",{className:"controls",style:{gap:8},children:n.jsx("input",{type:"date",className:"subject-input",value:e,onChange:S=>{t(S.target.value),y(S.target.value)}})})]}),x&&n.jsx("div",{className:"error",style:{marginBottom:8},children:x}),n.jsx("div",{className:"card",style:{padding:12},children:m?n.jsx("div",{className:"empty-state",children:"불러오는 중…"}):r?n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(6, 1fr)",gap:12},children:[n.jsx(La,{label:`${D} 전체`,value:A(r.prevYearTotal)}),n.jsx(La,{label:`${D}-01-01 ~ ${D}-${O(w)}-${O(M)}`,value:A(r.prevYearToDate)}),n.jsx(La,{label:`${N}-01-01 ~ ${N}-${O(w)}-${O(M)}`,value:A(r.currentYearToDate)}),n.jsx(La,{label:`${D}-${O(w)} 전체`,value:A(r.prevYearMonthTotal)}),n.jsx(La,{label:`${D}-${O(w)}-01 ~ ${D}-${O(w)}-${O(j)}`,value:A(r.prevYearMonthToDate)}),n.jsx(La,{label:`${N}-${O(w)}-01 ~ ${N}-${O(w)}-${O(M)}`,value:A(r.currentYearMonthToDate)})]}):n.jsx("div",{className:"empty-state",children:"데이터가 없습니다"})}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12,marginTop:12},children:[n.jsxs("div",{className:"card",style:{padding:12},children:[n.jsx("div",{className:"muted",style:{marginBottom:8},children:"월별 매출 (올해 vs 전년)"}),n.jsx(h1,{prev:i,cur:o,upToMonth:new Date(e).getMonth()+1})]}),n.jsxs("div",{className:"card",style:{padding:12},children:[n.jsx("div",{className:"muted",style:{marginBottom:8},children:"일별 매출 (해당 월: 올해 vs 전년)"}),n.jsx(m1,{prev:d,cur:u,upToDay:new Date(e).getDate()})]})]}),n.jsxs("div",{className:"controls",style:{justifyContent:"flex-start",marginTop:12},children:[n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"8px 12px",borderRadius:10},onClick:async()=>{try{const S=await fetch(`/api/v1/dashboard/churn?date=${encodeURIComponent(e)}`),R=await S.json().catch(()=>[]);if(!S.ok||R&&R.error)throw new Error(R.error||`HTTP ${S.status}`);try{window.dispatchEvent(new CustomEvent("tnt.sales.dashboard.churn",{detail:{items:R}}))}catch{}}catch{alert("이탈거래처 조회 실패")}},children:"이탈거래처"}),n.jsx("button",{className:"btn btn-card btn-3d",style:{fontSize:12,padding:"8px 12px",borderRadius:10,marginLeft:12},onClick:async()=>{try{const S=await fetch(`/api/v1/dashboard/newcustomers?date=${encodeURIComponent(e)}`),R=await S.json().catch(()=>[]);if(!S.ok||R&&R.error)throw new Error(R.error||`HTTP ${S.status}`);try{window.dispatchEvent(new CustomEvent("tnt.sales.dashboard.newcustomers",{detail:{items:R}}))}catch{}}catch{alert("신규 거래처 조회 실패")}},children:"신규 거래처"})]})]}):n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"page-title",children:n.jsx("h2",{children:"미수 분석"})}),n.jsx("div",{className:"card",style:{padding:12},children:n.jsx("div",{className:"empty-state",children:"미수 분석 콘텐츠가 준비 중입니다."})})]})]})}function La({label:e,value:t}){return n.jsxs("div",{className:"card",style:{padding:12},children:[n.jsx("div",{className:"muted",style:{fontSize:10,marginBottom:8},children:e}),n.jsx("div",{style:{fontSize:16,fontWeight:700},children:t})]})}function h1({prev:e,cur:t,upToMonth:r}){const o=Array.from({length:12},(g,b)=>b+1),l=Math.max(1,...e,...t),d=g=>36+g*(320-2*36)/11,f=g=>204-g/l*(240-2*36),u=(g,b)=>o.filter(A=>!b||A<=b).map((A,C)=>`${C===0?"M":"L"} ${d(A-1)} ${f(g[A-1]||0)}`).join(" "),h=4,m=Array.from({length:h},(g,b)=>Math.round((b+1)*l/h)),p=g=>`${Math.round((g||0)/1e6)}`,x=g=>new Intl.NumberFormat("ko-KR",{maximumFractionDigits:0}).format((g||0)/1e6),v={prev:"#64748b",cur:"#2563eb"};return n.jsxs("svg",{width:"100%",viewBox:"0 0 320 240",children:[n.jsx("rect",{x:0,y:0,width:320,height:240,fill:"transparent"}),m.map((g,b)=>{const y=f(g);return n.jsxs("g",{children:[n.jsx("line",{x1:36,y1:y,x2:284,y2:y,stroke:"var(--border)"}),n.jsx("text",{x:30,y:y+2,textAnchor:"end",fontSize:4,fill:"var(--muted)",children:p(g)})]},b)}),n.jsx("text",{x:4,y:10,fontSize:4,fill:"var(--muted)",children:"단위: 백만원"}),n.jsx("path",{d:u(e),fill:"none",stroke:v.prev,strokeWidth:2}),n.jsx("path",{d:u(t,r),fill:"none",stroke:v.cur,strokeWidth:2}),o.map(g=>{const b=e[g-1]||0,y=f(b)-4;return n.jsx("text",{x:d(g-1),y,textAnchor:"middle",fontSize:4,fill:v.prev,children:x(b)},`p-${g}`)}),o.filter(g=>g<=r).map(g=>{const b=t[g-1]||0,y=f(b)-4;return n.jsx("text",{x:d(g-1),y:y-6,textAnchor:"middle",fontSize:4,fill:v.cur,children:x(b)},`c-${g}`)}),o.map(g=>n.jsxs("text",{x:d(g-1),y:234,textAnchor:"middle",fontSize:4,fill:"var(--muted)",children:[g,"월"]},g)),n.jsxs("g",{children:[n.jsx("circle",{cx:196,cy:14,r:4,fill:v.prev}),n.jsx("text",{x:206,y:18,fontSize:4,fill:"var(--muted)",children:"전년"}),n.jsx("circle",{cx:250,cy:14,r:4,fill:v.cur}),n.jsx("text",{x:260,y:18,fontSize:4,fill:"var(--muted)",children:"올해"})]})]})}function m1({prev:e,cur:t,upToDay:r}){const l=Math.max(1,...e,...t),d=(320-2*36)/31,f=Math.max(1,Math.floor(d*.35)),u=A=>36+A*d,h=A=>204-A/l*(240-2*36),m=A=>`${Math.round((A||0)/1e6)}`,p=Array.from({length:31},(A,C)=>C+1),x=Array.from({length:4},(A,C)=>Math.round((C+1)*l/4)),[v,g]=ke.useState(null),b=A=>{const N=A.currentTarget.getBoundingClientRect(),w=A.clientX-N.left,M=Math.max(0,Math.min(320-2*36,w-36)),O=Math.max(0,Math.min(30,Math.floor(M/d)));g(O)},y={prev:"#94a3b8",cur:"#3b82f6"};return n.jsxs("svg",{width:"100%",viewBox:"0 0 320 240",onMouseMove:b,onMouseLeave:()=>g(null),children:[n.jsx("rect",{x:0,y:0,width:320,height:240,fill:"transparent"}),x.map((A,C)=>{const N=h(A);return n.jsxs("g",{children:[n.jsx("line",{x1:36,y1:N,x2:284,y2:N,stroke:"var(--border)"}),n.jsx("text",{x:30,y:N+2,textAnchor:"end",fontSize:4,fill:"var(--muted)",children:m(A)})]},C)}),n.jsx("text",{x:4,y:10,fontSize:4,fill:"var(--muted)",children:"단위: 백만원"}),Array.from({length:31},(A,C)=>C).map(A=>{const C=u(A),N=204-h(e[A]||0),w=204-h(t[A]||0);return n.jsxs("g",{children:[n.jsx("rect",{x:C-f-1,y:h(e[A]||0),width:f,height:N,fill:y.prev}),n.jsx("rect",{x:C+1,y:h(t[A]||0),width:f,height:w,fill:y.cur})]},A)}),p.map(A=>n.jsx("text",{x:u(A-1),y:232,textAnchor:"middle",fontSize:3,fill:"var(--muted)",children:A},A)),n.jsxs("g",{children:[n.jsx("rect",{x:194,y:8,width:8,height:8,fill:y.prev}),n.jsx("text",{x:208,y:16,fontSize:4,fill:"var(--muted)",children:"전년"}),n.jsx("rect",{x:244,y:8,width:8,height:8,fill:y.cur}),n.jsx("text",{x:258,y:16,fontSize:4,fill:"var(--muted)",children:"올해"})]}),v!=null&&v<31&&n.jsxs("g",{children:[n.jsx("line",{x1:u(v),y1:32,x2:u(v),y2:208,stroke:"var(--border)"}),n.jsxs("g",{transform:`translate(${Math.min(174,Math.max(36,u(v)-55))}, 36)`,children:[n.jsx("rect",{x:0,y:0,width:110,height:38,rx:6,fill:"var(--panel)",stroke:"var(--border)"}),n.jsxs("text",{x:6,y:12,fontSize:4,fill:"var(--muted)",children:[v+1,"일"]}),n.jsxs("text",{x:6,y:22,fontSize:4,fill:y.prev,children:["전년 ",m(e[v]||0)]}),n.jsxs("text",{x:6,y:32,fontSize:4,fill:y.cur,children:["올해 ",v+1<=r?m(t[v]||0):"-"]})]})]})]})}function p1({activity:e}){return n.jsxs("section",{className:"card activity-edit-panel",style:{marginTop:12,minHeight:240},children:[n.jsx("div",{className:"tabs c360-tabs",children:n.jsx("button",{className:"tab active",children:"영업활동 변경"})}),n.jsx("div",{className:"activity-form-wrapper",children:n.jsx(Fi,{bare:!0,editId:e==null?void 0:e.id,initial:{id:e==null?void 0:e.id,subject:(e==null?void 0:e.subject)||"",description:(e==null?void 0:e.description)||"",channel:(e==null?void 0:e.channel)||"in_person",activityType:(e==null?void 0:e.activityType)||"site_visit",activityStatus:(e==null?void 0:e.activityStatus)||"scheduled",plannedStartAt:(e==null?void 0:e.plannedStartAt)||"",plannedEndAt:(e==null?void 0:e.plannedEndAt)||"",sfAccountId:(e==null?void 0:e.sfAccountId)||"",customerName:(e==null?void 0:e.customerName)||"",parentActivitySeq:e==null?void 0:e.parentSeq,parentSubject:e==null?void 0:e.parentSubject}},`edit-${(e==null?void 0:e.id)??"new"}`)})]})}function ar(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function g1(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState(()=>new Set),[d,f]=c.useState(null),[u,h]=c.useState(""),[m,p]=c.useState([]),[x,v]=c.useState(""),[g,b]=c.useState(void 0),[y,A]=c.useState({open:!1,x:0,y:0});function C(){try{const W=localStorage.getItem("tnt.sales.visitPlanActivities"),j=W?JSON.parse(W):[],S=new Set;return Array.isArray(j)&&j.forEach(R=>{(R==null?void 0:R.id)!=null&&S.add(Number(R.id))}),S}catch{return new Set}}async function N(){s(null),a(!0);try{const W=localStorage.getItem("tnt.sales.assigneeId");if(!W)throw new Error(ot.loginRequired);const j=new URL("/api/v1/sales-activities",window.location.origin);j.searchParams.set("mineOnly","true"),j.searchParams.set("assigneeId",String(W)),u&&u.trim()&&j.searchParams.set("customerName",u.trim()),x&&x.trim()&&j.searchParams.append("status",x.trim());const S=await fetch(j.toString());if(!S.ok){let q=`HTTP ${S.status}`;try{const K=await S.json();K!=null&&K.error&&(q=K.error)}catch{}throw new Error(q)}const R=await S.json(),I=Array.isArray(R)?R:[],$=C(),J=I.filter(q=>!$.has(q.id));t(J),b(q=>{if(!(!J||J.length===0))return q&&J.some(K=>K.id===q.id)?q:J[0]})}catch(W){s(W.message||"조회 중 오류가 발생했습니다")}finally{a(!1)}}c.useEffect(()=>{N(),(async()=>{try{const S=await fetch("/api/v1/sales-activities/statuses");if(S.ok){const R=await S.json(),I=["scheduled","completed","canceled","postponed"];Array.isArray(R)&&R.length>0?p(R):p(I)}else p(["scheduled","completed","canceled","postponed"])}catch{}})();const W=()=>{try{const S=localStorage.getItem("tnt.sales.availableActivities");if(S){const R=JSON.parse(S);if(Array.isArray(R)){const I=R;t(I),b($=>{if(!(!I||I.length===0))return $&&I.some(J=>J.id===$.id)?$:I[0]})}}}catch{}};window.addEventListener("tnt.sales.availableActivitiesUpdated",W);const j=()=>{N()};return window.addEventListener("tnt.sales.activity.updated",j),()=>window.removeEventListener("tnt.sales.availableActivitiesUpdated",W)},[]),c.useEffect(()=>{if(!y.open)return;const W=()=>A({open:!1,x:0,y:0}),j=S=>{S.key==="Escape"&&A({open:!1,x:0,y:0})};return window.addEventListener("click",W),window.addEventListener("keydown",j),()=>{window.removeEventListener("click",W),window.removeEventListener("keydown",j)}},[y.open]);function w(W,j){W.preventDefault(),W.stopPropagation();const S=(j.parentSubject||"").trim();if(!S){A({open:!1,x:0,y:0});return}const R=e.find($=>($.subject||"").trim()===S)||null,I=e.filter($=>($.parentSubject||"").trim()===S);A({open:!0,x:W.clientX,y:W.clientY,parent:R,siblings:I})}function M(){if(f(null),o.size===0){f("선택된 활동이 없습니다");return}const W=e.filter(S=>o.has(S.id)),j=e.filter(S=>!o.has(S.id));try{let S=[];try{const K=localStorage.getItem("tnt.sales.visitPlanActivities");if(K){const L=JSON.parse(K);Array.isArray(L)&&(S=L)}}catch{}const R=new Map;S.forEach(K=>R.set(K.id,K)),W.forEach(K=>R.set(K.id,K));const I=Array.from(R.values());localStorage.setItem("tnt.sales.visitPlanActivities",JSON.stringify(I));let $=[];try{const K=localStorage.getItem("tnt.sales.availableActivities");if(K){const L=JSON.parse(K);Array.isArray(L)&&($=L)}}catch{}const J=new Map;$.forEach(K=>J.set(K.id,K)),j.forEach(K=>J.set(K.id,K)),W.forEach(K=>J.delete(K.id));const q=Array.from(J.values());localStorage.setItem("tnt.sales.availableActivities",JSON.stringify(q)),window.dispatchEvent(new CustomEvent("tnt.sales.visitPlanUpdated")),window.dispatchEvent(new CustomEvent("tnt.sales.availableActivitiesUpdated")),f(`방문 일정 대상 ${W.length}건을 우측 패널에 추가했습니다`),t(q),l(new Set)}catch{f("저장 중 오류가 발생했습니다")}}const O=(W,j)=>W?j==="type"?{site_visit:"정기방문",opportunity:"영업기회",AR_mgmt:"채권관리",meeting:"미팅",call:"전화",email:"이메일",demo:"데모",task:"업무",other:"기타"}[W]||W:j==="status"?{scheduled:"계획",completed:"완료",canceled:"취소",postponed:"연기",no_show:"미방문"}[W]||W:j==="channel"&&{in_person:"방문",phone:"전화",email:"문자/메일/팩스",other:"기타",video:"영상",chat:"채팅",sms:"문자"}[W]||W:"",D=c.useMemo(()=>{const W=j=>[`제목: ${j.subject||""}`,`활동설명: ${j.description||""}`,`활동유형: ${O(j.activityType,"type")}`,`활동방법: ${O(j.channel,"channel")}`,`상태: ${O(j.activityStatus,"status")}`,`상위활동: ${j.parentSubject||""}`,`계획 일시: ${ar(j.plannedStartAt)}`,`종료 일시: ${ar(j.plannedEndAt)}`,`거래처명: ${j.customerName||""}`,`생성일시: ${ar(j.createdAt)}`].join(`
`);return n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"table-container",style:{maxHeight:"32vh"},children:e.length===0?n.jsx("div",{className:"empty-state",children:ot.empty}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:36,textAlign:"center"},children:n.jsx("input",{type:"checkbox",checked:e.length>0&&o.size===e.length,onChange:j=>{if(j.target.checked){const S=new Set;e.forEach(R=>S.add(R.id)),l(S)}else l(new Set)}})}),n.jsx("th",{style:{width:240},children:"제목"}),n.jsx("th",{style:{width:120},children:"활동방법"}),n.jsx("th",{style:{width:200},children:"거래처명"}),n.jsx("th",{style:{width:280},children:"활동설명"}),n.jsx("th",{style:{width:220},children:"상위활동"}),n.jsx("th",{style:{width:120},children:"활동유형"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:180},children:"계획 일시"}),n.jsx("th",{style:{width:180},children:"종료 일시"}),n.jsx("th",{style:{width:180},children:"생성일시"})]})}),n.jsx("tbody",{children:e.map((j,S)=>n.jsxs("tr",{title:W(j),onClick:()=>b(j),onContextMenu:R=>w(R,j),"aria-selected":(g==null?void 0:g.id)===j.id?!0:void 0,style:(g==null?void 0:g.id)===j.id?{background:"var(--row-selected, rgba(0, 128, 255, 0.12))"}:void 0,children:[n.jsx("td",{style:{textAlign:"center"},children:n.jsx("input",{type:"checkbox",checked:o.has(j.id),onChange:R=>{l(I=>{const $=new Set(I);return R.target.checked?$.add(j.id):$.delete(j.id),$})}})}),n.jsx("td",{children:j.subject||""}),n.jsx("td",{children:O(j.channel,"channel")}),n.jsx("td",{children:j.customerName||""}),n.jsx("td",{title:j.description||"",style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:j.description||""}),n.jsx("td",{children:j.parentSubject||""}),n.jsx("td",{children:O(j.activityType,"type")}),n.jsx("td",{children:O(j.activityStatus,"status")}),n.jsx("td",{children:ar(j.plannedStartAt)}),n.jsx("td",{children:ar(j.plannedEndAt)}),n.jsx("td",{children:ar(j.createdAt)})]},S))})]})}),y.open&&n.jsxs("div",{className:"context-menu",style:{left:y.x+6,top:y.y+6,maxWidth:720,padding:10,fontSize:10},onClick:j=>j.stopPropagation(),children:[n.jsx("div",{style:{fontWeight:700,marginBottom:8},children:"상위활동"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:8},children:[y.parent&&n.jsx("div",{className:"card",style:{padding:8},children:n.jsx("div",{style:{overflowX:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%",fontSize:10},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"제목"}),n.jsx("th",{children:"활동설명"}),n.jsx("th",{children:"활동유형"}),n.jsx("th",{children:"활동방법"}),n.jsx("th",{children:"상태"}),n.jsx("th",{children:"거래처명"}),n.jsx("th",{children:"계획 일시"}),n.jsx("th",{children:"종료 일시"})]})}),n.jsx("tbody",{children:n.jsxs("tr",{children:[n.jsx("td",{children:y.parent.subject||""}),n.jsx("td",{style:{whiteSpace:"pre-wrap",maxWidth:360},children:y.parent.description||""}),n.jsx("td",{children:O(y.parent.activityType,"type")}),n.jsx("td",{children:O(y.parent.channel,"channel")}),n.jsx("td",{children:O(y.parent.activityStatus,"status")}),n.jsx("td",{children:y.parent.customerName||""}),n.jsx("td",{children:ar(y.parent.plannedStartAt)}),n.jsx("td",{children:ar(y.parent.plannedEndAt)})]})})]})})}),n.jsxs("div",{className:"card",style:{padding:8},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:6},children:"관련활동"}),y.siblings&&y.siblings.length>0?n.jsxs("table",{className:"table",style:{width:"100%",fontSize:10},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:240},children:"제목"}),n.jsx("th",{style:{width:120},children:"활동유형"}),n.jsx("th",{style:{width:120},children:"활동방법"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:180},children:"계획 일시"}),n.jsx("th",{style:{width:180},children:"종료 일시"})]})}),n.jsx("tbody",{children:y.siblings.map((j,S)=>n.jsxs("tr",{onClick:()=>{b(j),A({open:!1,x:0,y:0})},children:[n.jsx("td",{children:j.subject||""}),n.jsx("td",{children:O(j.activityType,"type")}),n.jsx("td",{children:O(j.channel,"channel")}),n.jsx("td",{children:O(j.activityStatus,"status")}),n.jsx("td",{children:ar(j.plannedStartAt)}),n.jsx("td",{children:ar(j.plannedEndAt)})]},S))})]}):n.jsx("div",{className:"muted",children:"하위 활동이 없습니다"})]})]})]})]})},[e,o,g,y]);return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("input",{value:u,onChange:W=>h(W.target.value),onKeyDown:W=>{W.key==="Enter"&&!r&&N()},placeholder:"거래처명 입력",style:{width:220,height:28,padding:"6px 8px",borderRadius:6,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12}}),n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8,marginLeft:8},children:[n.jsx("label",{className:"muted",style:{fontSize:12},children:"상태"}),n.jsxs("select",{value:x,onChange:W=>v(W.target.value),style:{minWidth:140,height:28,padding:"4px 8px",borderRadius:8,border:"1px solid var(--border)",background:"transparent",color:"var(--text)",fontSize:12},children:[n.jsx("option",{value:"",children:"전체"}),m.map(W=>n.jsx("option",{value:W,children:O(W,"status")},W))]})]}),n.jsx("button",{className:"btn",onClick:N,disabled:r,children:r?"조회중…":"조회"}),n.jsx("button",{className:"btn",onClick:M,disabled:!0,title:"준비중 기능",style:{marginLeft:8,opacity:.6,cursor:"not-allowed"},children:ot.action.addToPlan}),i&&n.jsx("span",{className:"error",children:i||ot.errorGeneric}),d&&n.jsx("span",{className:"muted",children:d}),n.jsx("div",{style:{flex:1}}),n.jsxs("div",{className:"muted count-text",children:["총 ",e.length,"건",o.size?` · 선택 ${o.size}건`:""]})]}),n.jsx("div",{style:{marginTop:12},children:D}),n.jsx(p1,{activity:g})]})}function y1(){return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",children:[n.jsx("h2",{children:"Complaint"}),n.jsx("div",{className:"meta",children:"준비 중"})]}),n.jsx("div",{className:"empty-state",children:"Complaint 기능은 추후 제공될 예정입니다."})]})}function v1({compact:e=!1,maxHeight:t}){const[r,a]=c.useState([]),[i,s]=c.useState(!1),[o,l]=c.useState(null),[d,f]=c.useState({open:!1,x:0,y:0}),[u,h]=c.useState(()=>{try{const v=localStorage.getItem("tnt.sales.selectedInquiry");if(v){const g=JSON.parse(v),b=Number(g==null?void 0:g.id);return Number.isFinite(b)?b:null}}catch{}return null});async function m(v){l(null),s(!0);try{let g=null;try{const y=await fetch("/api/v1/inquiries");y.ok&&(g=await y.json())}catch{}let b=[];if(Array.isArray(g)?b=g.map((y,A)=>({id:Number((y==null?void 0:y.id)??A+1),title:(y==null?void 0:y.title)!=null?String(y.title):"",customerSeq:(y==null?void 0:y.customerSeq)!=null?Number(y.customerSeq):(y==null?void 0:y.customer_seq)!=null?Number(y.customer_seq):null,customerName:(y==null?void 0:y.customerName)??(y==null?void 0:y.customer_name)??null,inquiryStatus:(y==null?void 0:y.inquiryStatus)??(y==null?void 0:y.inquiry_status)??(y==null?void 0:y.status)??"",assigneeSeq:(y==null?void 0:y.assigneeSeq)!=null?Number(y.assigneeSeq):(y==null?void 0:y.assignee_seq)!=null?Number(y.assignee_seq):null,assigneeName:(y==null?void 0:y.assigneeName)??(y==null?void 0:y.assignee_name)??null,assigneeId:(y==null?void 0:y.assigneeId)??(y==null?void 0:y.assignee_id)??null,openedAt:(y==null?void 0:y.openedAt)??(y==null?void 0:y.opened_at)??"",updatedAt:(y==null?void 0:y.updatedAt)??(y==null?void 0:y.updated_at)??"",inquiryCategory:(y==null?void 0:y.inquiryCategory)??(y==null?void 0:y.inquiry_category)??"",ownerSeq:(y==null?void 0:y.ownerSeq)!=null?Number(y.ownerSeq):(y==null?void 0:y.owner_seq)!=null?Number(y.owner_seq):null,ownerName:(y==null?void 0:y.ownerName)??(y==null?void 0:y.owner_name)??null,channel:(y==null?void 0:y.channel)??"",contactSeq:(y==null?void 0:y.contactSeq)!=null?Number(y.contactSeq):(y==null?void 0:y.contact_seq)!=null?Number(y.contact_seq):null,contactName:(y==null?void 0:y.contactName)??(y==null?void 0:y.contact_name)??null,leadId:(y==null?void 0:y.leadId)??"",severity:(y==null?void 0:y.severity)??"",closedAt:(y==null?void 0:y.closedAt)??(y==null?void 0:y.closed_at)??"",inquiryContent:(y==null?void 0:y.inquiryContent)??(y==null?void 0:y.inquiry_content)??"",answerContent:(y==null?void 0:y.answerContent)??(y==null?void 0:y.answer_content)??""})):b=[],b.sort((y,A)=>{const C=y.updatedAt?Date.parse(y.updatedAt):0,N=A.updatedAt?Date.parse(A.updatedAt):0;return N!==C?N-C:(y.title||"").localeCompare(A.title||"","ko",{sensitivity:"base"})}),a(b),v!=null){const y=b.find(A=>A.id===v);if(y){p(y);return}}b.length>0&&u==null&&p(b[0])}catch(g){l((g==null?void 0:g.message)||"조회 중 오류가 발생했습니다")}finally{s(!1)}}c.useEffect(()=>{m()},[]),c.useEffect(()=>{const v=g=>{var y;const b=((y=g==null?void 0:g.detail)==null?void 0:y.focusId)!=null?Number(g.detail.focusId):null;m(b)};return window.addEventListener("tnt.sales.inquiry.reload",v),()=>window.removeEventListener("tnt.sales.inquiry.reload",v)},[]);function p(v){h(v.id);try{localStorage.setItem("tnt.sales.selectedInquiry",JSON.stringify(v)),window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.selected",{detail:{inquiry:v}}))}catch{}}return c.useMemo(()=>n.jsxs("div",{className:"table-container",style:{height:t??(e?"32vh":void 0),maxHeight:t??(e?"32vh":void 0)},children:[r.length===0?n.jsx("div",{className:"empty-state",children:i?"불러오는 중…":o||"데이터가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"제목"}),n.jsx("th",{style:{width:200},children:"거래처명"}),n.jsx("th",{style:{width:120},children:"문의유형"}),n.jsx("th",{style:{width:120},children:"접수자"}),n.jsx("th",{style:{width:120},children:"당사담당자"}),n.jsx("th",{style:{width:160},children:"접수시간"})]})}),n.jsx("tbody",{children:r.map((v,g)=>{const b=(()=>{if(String(v.inquiryStatus||"").trim()==="완료")return!1;const A=v.openedAt?Date.parse(v.openedAt):NaN;return Number.isFinite(A)?A<=Date.now()-864e5:!1})();return n.jsxs("tr",{className:u===v.id?"selected":void 0,onClick:()=>p(v),onMouseEnter:y=>f({open:!0,x:y.clientX+8,y:y.clientY+8,row:v}),onMouseMove:y=>f(A=>({...A,x:y.clientX+8,y:y.clientY+8})),onMouseLeave:()=>f({open:!1,x:0,y:0}),style:b?{color:"#ef4444"}:void 0,children:[n.jsx("td",{children:v.title||""}),n.jsx("td",{children:v.customerName||(v.customerSeq!=null?String(v.customerSeq):"")}),n.jsx("td",{children:v.inquiryCategory||""}),n.jsx("td",{children:v.ownerName||(v.ownerSeq!=null?String(v.ownerSeq):"")}),n.jsx("td",{children:v.assigneeName||(v.assigneeSeq!=null?String(v.assigneeSeq):"")}),n.jsx("td",{children:v.openedAt?(()=>{const y=new Date(v.openedAt);if(isNaN(y.getTime()))return v.openedAt;const A=String(y.getFullYear()%100).padStart(2,"0"),C=String(y.getMonth()+1).padStart(2,"0"),N=String(y.getDate()).padStart(2,"0"),w=String(y.getHours()).padStart(2,"0"),M=String(y.getMinutes()).padStart(2,"0");return`${A}-${C}-${N} ${w}:${M}`})():""})]},g)})})]}),d.open&&d.row&&n.jsxs("div",{role:"dialog","aria-label":"문의 상세",style:{position:"fixed",left:Math.min(d.x,(typeof window<"u"?window.innerWidth:1200)-420),top:Math.min(d.y,(typeof window<"u"?window.innerHeight:800)-320),zIndex:9999,maxWidth:400,background:"var(--panel)",color:"var(--text)",border:"1px solid var(--border)",borderRadius:10,boxShadow:"0 12px 28px rgba(0,0,0,.25)",padding:10,fontSize:12,lineHeight:1.4,pointerEvents:"none"},children:[n.jsx("div",{style:{fontWeight:700,marginBottom:6},children:d.row.title||"(문의)"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"120px 1fr",columnGap:8,rowGap:4},children:[n.jsx("span",{className:"muted",children:"거래처"}),n.jsx("span",{children:d.row.customerName||(d.row.customerSeq!=null?String(d.row.customerSeq):"")}),n.jsx("span",{className:"muted",children:"문의유형"}),n.jsx("span",{children:d.row.inquiryCategory||""}),n.jsx("span",{className:"muted",children:"상태"}),n.jsx("span",{children:d.row.inquiryStatus||""}),n.jsx("span",{className:"muted",children:"난이도"}),n.jsx("span",{children:d.row.severity||""}),n.jsx("span",{className:"muted",children:"접수자"}),n.jsx("span",{children:d.row.ownerName||(d.row.ownerSeq!=null?String(d.row.ownerSeq):"")}),n.jsx("span",{className:"muted",children:"당사담당자"}),n.jsx("span",{children:d.row.assigneeName||(d.row.assigneeSeq!=null?String(d.row.assigneeSeq):"")}),n.jsx("span",{className:"muted",children:"리드ID"}),n.jsx("span",{children:d.row.leadId||""}),n.jsx("span",{className:"muted",children:"채널"}),n.jsx("span",{children:d.row.channel||""}),n.jsx("span",{className:"muted",children:"접수시각"}),n.jsx("span",{children:d.row.openedAt?(()=>{const v=new Date(d.row.openedAt);if(isNaN(v.getTime()))return String(d.row.openedAt);const g=String(v.getFullYear()%100).padStart(2,"0"),b=String(v.getMonth()+1).padStart(2,"0"),y=String(v.getDate()).padStart(2,"0"),A=String(v.getHours()).padStart(2,"0"),C=String(v.getMinutes()).padStart(2,"0");return`${g}-${b}-${y} ${A}:${C}`})():""}),n.jsx("span",{className:"muted",children:"종료시각"}),n.jsx("span",{children:d.row.closedAt?(()=>{const v=new Date(d.row.closedAt);if(isNaN(v.getTime()))return String(d.row.closedAt);const g=String(v.getFullYear()%100).padStart(2,"0"),b=String(v.getMonth()+1).padStart(2,"0"),y=String(v.getDate()).padStart(2,"0"),A=String(v.getHours()).padStart(2,"0"),C=String(v.getMinutes()).padStart(2,"0");return`${g}-${b}-${y} ${A}:${C}`})():""}),n.jsx("span",{className:"muted",children:"문의내용"}),n.jsx("span",{style:{whiteSpace:"pre-wrap"},children:d.row.inquiryContent||""}),n.jsx("span",{className:"muted",children:"답변내용"}),n.jsx("span",{style:{whiteSpace:"pre-wrap"},children:d.row.answerContent||""}),n.jsx("span",{className:"muted",children:"수정시각"}),n.jsx("span",{children:d.row.updatedAt?(()=>{const v=new Date(d.row.updatedAt);if(isNaN(v.getTime()))return String(d.row.updatedAt);const g=String(v.getFullYear()%100).padStart(2,"0"),b=String(v.getMonth()+1).padStart(2,"0"),y=String(v.getDate()).padStart(2,"0"),A=String(v.getHours()).padStart(2,"0"),C=String(v.getMinutes()).padStart(2,"0");return`${g}-${b}-${y} ${A}:${C}`})():""}),n.jsx("span",{className:"muted",children:"ID"}),n.jsx("span",{children:d.row.id})]})]})]}),[r,u,i,o,e,t,d])}const Pi="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20width='16'%20height='16'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20aria-hidden='true'%3e%3ccircle%20cx='11'%20cy='11'%20r='7'%20/%3e%3cline%20x1='21'%20y1='21'%20x2='16.65'%20y2='16.65'%20/%3e%3c/svg%3e";function og({open:e,onClose:t,title:r,children:a,footer:i,width:s=380}){return c.useEffect(()=>{if(!e)return;const o=l=>{l.key==="Escape"&&t()};return window.addEventListener("keydown",o,!0),()=>window.removeEventListener("keydown",o,!0)},[e,t]),e?yd.createPortal(n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:2e3},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"22%",left:"50%",transform:"translateX(-50%)",width:s,maxWidth:"92vw",padding:12},children:[r?n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h3",{style:{margin:0,fontSize:14},children:r})}):null,n.jsx("div",{style:{padding:"4px 2px",fontSize:13},children:a}),n.jsx("div",{className:"controls",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:i})]})]}),document.body):null}function x1({open:e,onClose:t,onSubmit:r}){const[a,i]=c.useState(""),[s,o]=c.useState(""),[l,d]=c.useState(""),[f,u]=c.useState(""),[h,m]=c.useState(""),[p,x]=c.useState(""),[v,g]=c.useState(""),[b,y]=c.useState(!1),[A,C]=c.useState(""),[N,w]=c.useState(""),[M,O]=c.useState(""),[D,W]=c.useState(""),[j,S]=c.useState(""),[R,I]=c.useState(!1),[$,J]=c.useState(""),[q,K]=c.useState(""),[L,ee]=c.useState(!1),[E,T]=c.useState(""),[B,P]=c.useState(""),[_,U]=c.useState(""),[fe,ae]=c.useState(""),[F,pe]=c.useState(null),H=c.useRef(null),[Q,ge]=c.useState(!1),[je,Ne]=c.useState({left:0,top:0});c.useEffect(()=>{if(e){const se=new Date;se.setMinutes(se.getMinutes()-se.getTimezoneOffset()),T(se.toISOString().slice(0,16)),P(""),i(""),o(""),d(""),u(""),m(""),x(""),g(""),C("");try{const Le=localStorage.getItem("tnt.sales.empName")||"",Fe=localStorage.getItem("tnt.sales.assigneeId")||"";w(Le),O(Fe)}catch{w(""),O("")}W(""),S(""),J(""),K(""),U(""),ae(""),ge(!1)}},[e]),c.useEffect(()=>{if(!e)return;const se=Le=>{if(Le.key==="Escape"){if(b||L||R)return;t()}};return window.addEventListener("keydown",se,!0),()=>window.removeEventListener("keydown",se,!0)},[e,t,b,L,R]),c.useEffect(()=>{if(!F)return;const se=Le=>{Le.key==="Escape"&&pe(null)};return window.addEventListener("keydown",se,!0),()=>window.removeEventListener("keydown",se,!0)},[F]);function Y(se){var He;se.preventDefault();const Le=(He=H.current)==null?void 0:He.getBoundingClientRect(),Fe=se.clientX,Ie=se.clientY,Ve=Le?Le.left:je.left,yt=Le?Le.top:je.top,It=lt=>{const ht=lt.clientX-Fe,rn=lt.clientY-Ie;Ne({left:Ve+ht,top:yt+rn}),ge(!0)},nn=()=>{window.removeEventListener("mousemove",It),window.removeEventListener("mouseup",nn)};window.addEventListener("mousemove",It),window.addEventListener("mouseup",nn)}if(!e)return null;function ve(){const se=(a||"").trim().length>0,Le=(s||"").trim().length>0,Fe=!!(p&&Number(p)),Ie=!!($&&String($).trim());if(!se){pe("제목을 입력해 주세요.");return}if(!Le){pe("상태를 선택해 주세요.");return}if(!(Fe||Ie)){pe("거래처 또는 잠재고객 중 하나를 선택해 주세요.");return}const Ve={title:a,inquiryStatus:s,severity:l,inquiryCategory:f,channel:h,customerSeq:p?Number(p):null,contactName:A||null,ownerId:M||null,assigneeId:j||null,createdBy:M||null,updatedBy:M||null,leadId:$,openedAt:E||null,closedAt:B||null,inquiryContent:_,answerContent:fe};r==null||r(Ve)}return n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e3},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),n.jsxs("div",{ref:H,className:"card",style:{position:"absolute",zIndex:1001,width:"90%",maxWidth:900,maxHeight:"90%",overflow:"auto",padding:12,left:Q?je.left:"50%",top:Q?je.top:"50%",transform:Q?"none":"translate(-50%, -50%)"},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{onMouseDown:Y,style:{display:"flex",alignItems:"center",gap:8,marginBottom:12,cursor:"move"},children:[n.jsx("span",{className:"muted",style:{fontWeight:700},children:"새 문의"}),n.jsx("div",{style:{flex:1,height:1,background:"var(--border)"}})]}),n.jsxs("div",{className:"form-grid",children:[n.jsxs("div",{className:"inline-field",children:[n.jsxs("label",{children:["제목",n.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),n.jsx("input",{className:"subject-input",value:a,onChange:se=>i(se.target.value),placeholder:"제목"})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"문의유형"}),n.jsxs("select",{className:"subject-input",value:f,onChange:se=>u(se.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"제품문의",children:"제품문의"}),n.jsx("option",{value:"재고/배송문의",children:"재고/배송문의"}),n.jsx("option",{value:"가격문의",children:"가격문의"}),n.jsx("option",{value:"기타문의",children:"기타문의"})]})]}),n.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[n.jsx("label",{children:"문의내용"}),n.jsx("textarea",{className:"subject-input",value:_,onChange:se=>U(se.target.value),placeholder:"상세 설명",style:{minHeight:120}})]}),n.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[n.jsx("label",{children:"답변내용"}),n.jsx("textarea",{className:"subject-input",value:fe,onChange:se=>ae(se.target.value),placeholder:"답변/조치",style:{minHeight:120}})]}),n.jsxs("div",{className:"inline-field",children:[n.jsxs("label",{children:["상태",n.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),n.jsxs("select",{className:"subject-input",value:s,onChange:se=>o(se.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"신규접수",children:"신규접수"}),n.jsx("option",{value:"확인 중",children:"확인 중"}),n.jsx("option",{value:"완료",children:"완료"}),n.jsx("option",{value:"보류",children:"보류"})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"난이도"}),n.jsxs("select",{className:"subject-input",value:l,onChange:se=>d(se.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"상",children:"상"}),n.jsx("option",{value:"중",children:"중"}),n.jsx("option",{value:"하",children:"하"})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"접수경로"}),n.jsxs("select",{className:"subject-input",value:h,onChange:se=>m(se.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"전화",children:"전화"}),n.jsx("option",{value:"이메일",children:"이메일"}),n.jsx("option",{value:"고객채널",children:"고객채널"}),n.jsx("option",{value:"직접입력",children:"직접입력"})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"잠재고객"}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("input",{className:"subject-input",type:"text",value:q,onChange:se=>{K(se.target.value),J("")},placeholder:"잠재고객명",style:{paddingRight:28}}),n.jsx("button",{type:"button","aria-label":"잠재고객 검색",title:"잠재고객 검색",onClick:()=>ee(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:n.jsx("img",{src:Pi,className:"icon",alt:"검색"})})]}),$&&n.jsxs("div",{className:"muted",style:{fontSize:11,marginTop:4},children:["선택됨: id ",$]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"거래처"}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("input",{className:"subject-input",type:"text",value:v,onChange:se=>{g(se.target.value),x("")},placeholder:"거래처명",style:{paddingRight:28}}),n.jsx("button",{type:"button","aria-label":"거래처 검색",title:"거래처 검색",onClick:()=>y(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:n.jsx("img",{src:Pi,className:"icon",alt:"검색"})})]}),p&&n.jsxs("div",{className:"muted",style:{fontSize:11,marginTop:4},children:["선택됨: seq ",p]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"거래처 담당자"}),n.jsx("input",{className:"subject-input",type:"text",value:A,onChange:se=>C(se.target.value),placeholder:"이름"})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"접수자"}),n.jsx("input",{className:"subject-input",value:N,readOnly:!0,title:"로그인 사용자"})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"당사 담당자"}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("input",{className:"subject-input",type:"text",value:D,onChange:se=>{W(se.target.value),S("")},placeholder:"이름",style:{paddingRight:28}}),n.jsx("button",{type:"button","aria-label":"직원 검색",title:"직원 검색",onClick:()=>I(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:n.jsx("img",{src:Pi,className:"icon",alt:"검색"})})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"접수시각"}),n.jsx("input",{className:"subject-input",type:"datetime-local",value:E,onChange:se=>T(se.target.value)})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"종료시각"}),n.jsx("input",{className:"subject-input",type:"datetime-local",value:B,onChange:se=>P(se.target.value)})]})]}),n.jsxs("div",{className:"controls",style:{gap:8,justifyContent:"flex-end"},children:[n.jsx("button",{className:"btn",onClick:ve,children:"저장"}),n.jsx("button",{className:"btn",onClick:t,children:"취소"})]})]}),b&&n.jsx(b1,{defaultQuery:v,onClose:()=>y(!1),onSelect:se=>{x(se.customerSeq?String(se.customerSeq):""),g(se.customerName||""),y(!1)}}),R&&n.jsx(w1,{defaultQuery:D,onClose:()=>I(!1),onSelect:se=>{S(se.assigneeId||""),W(se.empName||""),I(!1)}}),L&&n.jsx(j1,{defaultQuery:q,onClose:()=>ee(!1),onSelect:se=>{J(se.id!=null?String(se.id):""),K(se.companyName||""),ee(!1)}}),n.jsx(og,{open:!!F,onClose:()=>pe(null),width:360,footer:n.jsx("button",{className:"btn",onClick:()=>pe(null),children:"확인"}),children:F})]})}function b1({defaultQuery:e,onClose:t,onSelect:r}){const[a,i]=c.useState(e||""),[s,o]=c.useState([]),[l,d]=c.useState(!1),[f,u]=c.useState(null);async function h(m=!0){d(!0),u(null);try{const p=new URL("/api/v1/customers",window.location.origin);a.trim()&&p.searchParams.set("name",a.trim()),p.searchParams.set("mineOnly","false"),p.searchParams.set("limit","100");const x=await fetch(p.toString());if(!x.ok)throw new Error(`HTTP ${x.status}`);const v=await x.json();if(Array.isArray(v)){const g=v.map(b=>({customerSeq:(b==null?void 0:b.customerSeq)??(b==null?void 0:b.customer_seq)??null,customerId:(b==null?void 0:b.customerId)??(b==null?void 0:b.customer_id)??null,customerName:(b==null?void 0:b.customerName)??(b==null?void 0:b.customer_name)??null,telNo:(b==null?void 0:b.telNo)??(b==null?void 0:b.tel_no)??null,addrProvinceName:(b==null?void 0:b.addrProvinceName)??(b==null?void 0:b.addr_province_name)??null,addrCityName:(b==null?void 0:b.addrCityName)??(b==null?void 0:b.addr_city_name)??null,companyType:(b==null?void 0:b.companyType)??(b==null?void 0:b.company_type)??null,ownerName:(b==null?void 0:b.ownerName)??(b==null?void 0:b.owner_name)??null}));o(g)}else o([])}catch(p){u((p==null?void 0:p.message)||"조회 중 오류가 발생했습니다"),o([])}finally{d(!1)}}return c.useEffect(()=>{h(!0)},[]),c.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"거래처명",value:a,onChange:m=>i(m.target.value),onKeyDown:m=>{m.key==="Enter"&&h(!0)},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:()=>h(!0),children:"조회"})]}),n.jsx("div",{className:"table-container",style:{height:360},children:s.length===0?n.jsx("div",{className:"empty-state",children:l?"불러오는 중…":f||"결과가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:220},children:"거래처명"}),n.jsx("th",{style:{width:140},children:"회사구분"}),n.jsx("th",{style:{width:140},children:"대표자명"}),n.jsx("th",{style:{width:180},children:"지역"})]})}),n.jsx("tbody",{children:s.map((m,p)=>n.jsxs("tr",{onDoubleClick:()=>r(m),onClick:()=>r(m),children:[n.jsx("td",{children:m.customerName||""}),n.jsx("td",{children:m.companyType||""}),n.jsx("td",{children:m.ownerName||""}),n.jsx("td",{children:[m.addrProvinceName,m.addrCityName].filter(Boolean).join(" ")})]},p))})]})})]})]})}function j1({defaultQuery:e,onClose:t,onSelect:r}){const[a,i]=c.useState(e||""),[s,o]=c.useState([]),[l,d]=c.useState(!1),[f,u]=c.useState(null);async function h(m=!0){d(!0),u(null);try{const p=new URL("/api/v1/leads",window.location.origin);a.trim()&&p.searchParams.set("company_name",a.trim()),p.searchParams.set("limit","100");const x=await fetch(p.toString());if(!x.ok)throw new Error(`HTTP ${x.status}`);const v=await x.json();if(Array.isArray(v)){const g=v.map(b=>({id:(b==null?void 0:b.id)!=null?Number(b.id):null,companyName:(b==null?void 0:b.company_name)??null,leadStatus:(b==null?void 0:b.lead_status)??null,ownerName:(b==null?void 0:b.owner_name)??null,addrProvinceName:(b==null?void 0:b.addr_province_name)??null}));o(g)}else o([])}catch(p){u((p==null?void 0:p.message)||"조회 중 오류가 발생했습니다"),o([])}finally{d(!1)}}return c.useEffect(()=>{h(!0)},[]),c.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"잠재고객명",value:a,onChange:m=>i(m.target.value),onKeyDown:m=>{m.key==="Enter"&&h(!0)},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:()=>h(!0),children:"조회"})]}),n.jsx("div",{className:"table-container",style:{height:360},children:s.length===0?n.jsx("div",{className:"empty-state",children:l?"불러오는 중…":f||"결과가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:220},children:"잠재고객명"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:140},children:"소유자"}),n.jsx("th",{style:{width:160},children:"지역"})]})}),n.jsx("tbody",{children:s.map((m,p)=>n.jsxs("tr",{onDoubleClick:()=>r(m),onClick:()=>r(m),children:[n.jsx("td",{children:m.companyName||""}),n.jsx("td",{children:m.leadStatus||""}),n.jsx("td",{children:m.ownerName||""}),n.jsx("td",{children:m.addrProvinceName||""})]},p))})]})})]})]})}function w1({defaultQuery:e,onClose:t,onSelect:r}){const[a,i]=c.useState(e||""),[s,o]=c.useState([]),[l,d]=c.useState(!1),[f,u]=c.useState(null);async function h(){d(!0),u(null);try{const m=new URL("/api/v1/employees",window.location.origin);m.searchParams.set("depts","all");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const x=await p.json(),v=Array.isArray(x)?x.map(y=>({empId:(y==null?void 0:y.emp_id)??null,empName:(y==null?void 0:y.emp_name)??null,deptName:(y==null?void 0:y.dept_name)??null,assigneeId:(y==null?void 0:y.assignee_id)??null})):[],g=a.trim().toLowerCase(),b=(g?v.filter(y=>(y.empName||"").toLowerCase().includes(g)||(y.empId||"").toLowerCase().includes(g)||(y.deptName||"").toLowerCase().includes(g)):v).sort((y,A)=>(y.empName||"").localeCompare(A.empName||"","ko",{sensitivity:"base"}));o(b)}catch(m){u((m==null?void 0:m.message)||"조회 실패"),o([])}finally{d(!1)}}return c.useEffect(()=>{h()},[]),c.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:700,maxHeight:"80%",overflow:"auto",padding:12},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"이름/사번/부서",value:a,onChange:m=>i(m.target.value),onKeyDown:m=>{m.key==="Enter"&&h()},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:h,children:"조회"})]}),n.jsx("div",{className:"table-container",style:{height:320},children:s.length===0?n.jsx("div",{className:"empty-state",children:l?"불러오는 중…":f||"결과가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:160},children:"이름"}),n.jsx("th",{style:{width:160},children:"부서"}),n.jsx("th",{style:{width:140},children:"사번"}),n.jsx("th",{style:{width:140},children:"assignee_id"})]})}),n.jsx("tbody",{children:s.map((m,p)=>n.jsxs("tr",{onDoubleClick:()=>r(m),onClick:()=>r(m),children:[n.jsx("td",{children:m.empName||""}),n.jsx("td",{children:m.deptName||""}),n.jsx("td",{children:m.empId||""}),n.jsx("td",{children:m.assigneeId||""})]},p))})]})})]})]})}function S1(){const[e,t]=c.useState(()=>{try{const j=localStorage.getItem("tnt.sales.selectedInquiry");return j?JSON.parse(j):null}catch{return null}});c.useEffect(()=>{const j=()=>{try{const S=localStorage.getItem("tnt.sales.selectedInquiry");t(S?JSON.parse(S):null)}catch{t(null)}};return window.addEventListener("tnt.sales.inquiry.selected",j),()=>window.removeEventListener("tnt.sales.inquiry.selected",j)},[]);const[r,a]=c.useState(null),[i,s]=c.useState(null),[o,l]=c.useState(!1),[d,f]=c.useState(null);c.useEffect(()=>{if(!i)return;const j=S=>{S.key==="Escape"&&s(null)};return window.addEventListener("keydown",j,!0),()=>window.removeEventListener("keydown",j,!0)},[i]),c.useEffect(()=>{if(!o)return;const j=S=>{S.key==="Escape"&&l(!1)};return window.addEventListener("keydown",j,!0),()=>window.removeEventListener("keydown",j,!0)},[o]),c.useEffect(()=>{if(!d)return;const j=S=>{S.key==="Escape"&&f(null)};return window.addEventListener("keydown",j,!0),()=>window.removeEventListener("keydown",j,!0)},[d]);const u=j=>{if(!j)return"";try{const S=new Date(j);if(isNaN(S.getTime()))return"";const R=String(S.getFullYear()),I=String(S.getMonth()+1).padStart(2,"0"),$=String(S.getDate()).padStart(2,"0"),J=String(S.getHours()).padStart(2,"0"),q=String(S.getMinutes()).padStart(2,"0");return`${R}-${I}-${$}T${J}:${q}`}catch{return""}},[h,m]=c.useState({}),[p,x]=c.useState(!1),[v,g]=c.useState(!1),[b,y]=c.useState(!1);c.useEffect(()=>{if(!e){m({});return}const j=typeof window<"u"&&localStorage.getItem("tnt.sales.empName")||"",S=typeof window<"u"&&localStorage.getItem("tnt.sales.assigneeId")||"";m({title:e.title||"",inquiryCategory:e.inquiryCategory||"",inquiryContent:e.inquiryContent||"",answerContent:e.answerContent||"",inquiryStatus:e.inquiryStatus||"",severity:e.severity||"",channel:e.channel||"",leadId:e.leadId||"",leadName:"",customerSeq:e.customerSeq!=null?String(e.customerSeq):"",customerName:e.customerName||"",contactName:e.contactName||"",ownerName:j,ownerId:S,assigneeName:e.assigneeName||"",assigneeId:e.assigneeId||"",openedAt:u(e.openedAt),closedAt:u(e.closedAt)})},[e]),c.useEffect(()=>{const j=h.leadId;if(!j||h.leadName)return;let S=!1;return(async()=>{try{const R=await fetch(`/api/v1/leads/${encodeURIComponent(String(j))}`);if(!R.ok)return;const I=await R.json().catch(()=>null);!S&&I&&m($=>({...$,leadName:I.company_name||$.leadName||""}))}catch{}})(),()=>{S=!0}},[h.leadId,h.leadName]);function A(j,S){m(R=>({...R,[j]:S}))}async function C(){if(!(e!=null&&e.id))return;const j=(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||""}catch{return""}})(),S=String(h.title||"").trim().length>0,R=String(h.inquiryStatus||"").trim().length>0,I=!!(h.customerSeq&&Number(h.customerSeq)),$=!!(h.leadId&&String(h.leadId).trim());if(!S){s("제목을 입력해 주세요.");return}if(!R){s("상태를 선택해 주세요.");return}if(!(I||$)){s("거래처 또는 잠재고객 중 하나를 선택해 주세요.");return}const J={title:h.title,inquiryCategory:h.inquiryCategory,inquiryContent:h.inquiryContent,answerContent:h.answerContent,inquiryStatus:h.inquiryStatus,severity:h.severity,channel:h.channel,leadId:h.leadId,customerSeq:h.customerSeq?Number(h.customerSeq):null,contactName:h.contactName||null,ownerId:h.ownerId||null,assigneeId:h.assigneeId||null,updatedBy:j||h.ownerId||null,openedAt:h.openedAt||null,closedAt:h.closedAt||null};try{const q=await fetch(`/api/v1/inquiries/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(J)});if(!q.ok){const K=await q.text().catch(()=>"");s("수정 실패: "+(K||q.status));return}try{a("수정 되었습니다."),window.setTimeout(()=>a(null),3e3)}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.reload",{detail:{focusId:e.id}}))}catch{}}catch{alert("수정 중 오류가 발생했습니다")}}const N=c.useMemo(()=>n.jsx("div",{className:"card",style:{padding:12},children:e?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"form-grid",children:[n.jsxs("div",{className:"inline-field",children:[n.jsxs("label",{children:["제목",n.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),n.jsx("input",{className:"subject-input",value:h.title||"",onChange:j=>A("title",j.target.value)})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"문의유형"}),n.jsxs("select",{className:"subject-input",value:h.inquiryCategory||"",onChange:j=>A("inquiryCategory",j.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"제품문의",children:"제품문의"}),n.jsx("option",{value:"재고/배송문의",children:"재고/배송문의"}),n.jsx("option",{value:"가격문의",children:"가격문의"}),n.jsx("option",{value:"기타문의",children:"기타문의"})]})]}),n.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[n.jsx("label",{children:"문의내용"}),n.jsx("textarea",{className:"subject-input",value:h.inquiryContent||"",onChange:j=>A("inquiryContent",j.target.value),style:{minHeight:80}})]}),n.jsxs("div",{className:"inline-field",style:{gridColumn:"1 / -1"},children:[n.jsx("label",{children:"답변내용"}),n.jsx("textarea",{className:"subject-input",value:h.answerContent||"",onChange:j=>A("answerContent",j.target.value),style:{minHeight:80}})]}),n.jsxs("div",{className:"inline-field",children:[n.jsxs("label",{children:["상태",n.jsx("span",{className:"req-dot","aria-hidden":"true"})]}),n.jsxs("select",{className:"subject-input",value:h.inquiryStatus||"",onChange:j=>A("inquiryStatus",j.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"신규접수",children:"신규접수"}),n.jsx("option",{value:"확인 중",children:"확인 중"}),n.jsx("option",{value:"완료",children:"완료"}),n.jsx("option",{value:"보류",children:"보류"})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"난이도"}),n.jsxs("select",{className:"subject-input",value:h.severity||"",onChange:j=>A("severity",j.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"상",children:"상"}),n.jsx("option",{value:"중",children:"중"}),n.jsx("option",{value:"하",children:"하"})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"접수경로"}),n.jsxs("select",{className:"subject-input",value:h.channel||"",onChange:j=>A("channel",j.target.value),children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"전화",children:"전화"}),n.jsx("option",{value:"이메일",children:"이메일"}),n.jsx("option",{value:"고객채널",children:"고객채널"}),n.jsx("option",{value:"직접입력",children:"직접입력"})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"잠재고객"}),n.jsx("input",{className:"subject-input",value:h.leadName||"",readOnly:!0,placeholder:"-"})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"거래처"}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("input",{className:"subject-input",value:h.customerName||"",onChange:j=>{A("customerName",j.target.value),A("customerSeq","")},placeholder:"거래처명",style:{paddingRight:28}}),n.jsx("button",{type:"button","aria-label":"거래처 검색",title:"거래처 검색",onClick:()=>x(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:n.jsx("img",{src:Pi,className:"icon",alt:"검색"})})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"거래처 담당자"}),n.jsx("input",{className:"subject-input",value:h.contactName||"",onChange:j=>A("contactName",j.target.value),placeholder:"이름"})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"접수자"}),n.jsx("input",{className:"subject-input",value:h.ownerName||"",readOnly:!0,title:"로그인 사용자"})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"당사 담당자"}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("input",{className:"subject-input",value:h.assigneeName||"",onChange:j=>{A("assigneeName",j.target.value),A("assigneeId","")},placeholder:"이름",style:{paddingRight:28}}),n.jsx("button",{type:"button","aria-label":"직원 검색",title:"직원 검색",onClick:()=>y(!0),className:"btn-plain no-focus-ring",style:{position:"absolute",right:4,top:"50%",transform:"translateY(-50%)",padding:4,cursor:"pointer"},children:n.jsx("img",{src:Pi,className:"icon",alt:"검색"})})]})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"접수시각"}),n.jsx("input",{className:"subject-input",type:"datetime-local",value:h.openedAt||"",onChange:j=>A("openedAt",j.target.value)})]}),n.jsxs("div",{className:"inline-field",children:[n.jsx("label",{children:"종료시각"}),n.jsx("input",{className:"subject-input",type:"datetime-local",value:h.closedAt||"",onChange:j=>A("closedAt",j.target.value)})]})]}),n.jsxs("div",{className:"controls",style:{gap:8,justifyContent:"flex-end",alignItems:"center"},children:[r&&n.jsx("span",{className:"success",children:r}),n.jsx("button",{className:"btn",onClick:C,children:"저장"}),n.jsx("button",{className:"btn",onClick:W,children:"삭제"})]})]}):n.jsx("div",{className:"empty-state",children:"선택된 케이스가 없습니다."})}),[e,h,r]),[w,M]=c.useState(!1);async function O(j){try{const S=await fetch("/api/v1/inquiries",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(j)});if(!S.ok){const $=await S.text().catch(()=>"");alert("저장 실패: "+($||S.status));return}const R=await S.json().catch(()=>null),I=R&&R.id!=null?Number(R.id):null;M(!1);try{window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.reload",{detail:{focusId:I}}))}catch{}}catch{alert("저장 중 오류가 발생했습니다")}}async function D(){try{const j=await fetch(`/api/v1/inquiries/${e.id}`,{method:"DELETE"});if(!j.ok){const S=await j.text().catch(()=>"");s("삭제 실패: "+(S||j.status));return}try{localStorage.removeItem("tnt.sales.selectedInquiry")}catch{}t(null),f("삭제 되었습니다.");try{window.dispatchEvent(new CustomEvent("tnt.sales.inquiry.reload",{detail:{}}))}catch{}}catch{s("삭제 중 오류가 발생했습니다")}}async function W(){e!=null&&e.id&&l(!0)}return n.jsxs(n.Fragment,{children:[n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,minWidth:0,flex:"1 1 auto"},children:[n.jsx("h2",{style:{margin:0},children:"문의"}),(()=>{const j=["신규접수","확인 중","완료"],S=String(h.inquiryStatus||"").trim(),R=S==="보류";let I=j.indexOf(S);R&&(I=1),I<0&&(I=0);const $=Math.max(0,Math.min(100,Math.round(I/Math.max(1,j.length-1)*100)));return n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,flex:"0 1 520px"},children:[n.jsx("div",{className:"progress",style:{width:"min(520px, 48vw)"},children:n.jsx("div",{className:"progress-bar",style:{width:`${$}%`,background:R?"#ef4444":"var(--accent)"}})}),n.jsx("div",{style:{display:"flex",justifyContent:"space-between",width:"min(520px, 48vw)",fontSize:11,color:"var(--muted)"},children:j.map(J=>n.jsx("span",{style:{fontWeight:S===J?700:400},children:J},J))})]})})()]}),n.jsx("div",{className:"controls",style:{gap:8},children:n.jsx("button",{className:"btn",onClick:()=>M(!0),children:"신규 등록"})})]}),p&&n.jsx(N1,{defaultQuery:h.customerName,onClose:()=>x(!1),onSelect:j=>{A("customerSeq",j.customerSeq?String(j.customerSeq):""),A("customerName",j.customerName||""),x(!1)}}),v&&n.jsx(k1,{defaultQuery:h.leadName,onClose:()=>g(!1),onSelect:j=>{A("leadId",j.id!=null?String(j.id):""),A("leadName",j.companyName||""),g(!1)}}),b&&n.jsx(A1,{defaultQuery:h.assigneeName,onClose:()=>y(!1),onSelect:j=>{A("assigneeId",j.assigneeId||""),A("assigneeName",j.empName||""),y(!1)}}),n.jsx(v1,{compact:!0,maxHeight:"21vh"}),n.jsx("section",{className:"card",style:{marginTop:12,minHeight:240},children:N})]}),n.jsx(x1,{open:w,onClose:()=>M(!1),onSubmit:O}),n.jsx(og,{open:!!i,onClose:()=>s(null),width:380,footer:n.jsx("button",{className:"btn",onClick:()=>s(null),children:"확인"}),children:i}),o&&n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:90},children:[n.jsx("div",{onClick:()=>l(!1),style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"24%",left:"50%",transform:"translateX(-50%)",width:380,maxWidth:"92vw",padding:12},children:[n.jsx("div",{style:{padding:"4px 2px",fontSize:13},children:"선택한 문의를 삭제하시겠습니까?"}),n.jsxs("div",{className:"controls",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:[n.jsx("button",{className:"btn",onClick:()=>l(!1),children:"취소"}),n.jsx("button",{className:"btn",onClick:()=>{l(!1),D()},children:"삭제"})]})]})]}),d&&n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:90},children:[n.jsx("div",{onClick:()=>f(null),style:{position:"absolute",inset:0,background:"rgba(0,0,0,.35)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"20%",left:"50%",transform:"translateX(-50%)",width:360,maxWidth:"92vw",padding:12},children:[n.jsx("div",{className:"page-title",style:{marginBottom:8},children:n.jsx("h3",{style:{margin:0,fontSize:14},children:"알림"})}),n.jsx("div",{style:{padding:"4px 2px",fontSize:13},children:d}),n.jsx("div",{className:"controls",style:{justifyContent:"flex-end",gap:8,marginTop:8},children:n.jsx("button",{className:"btn",onClick:()=>f(null),children:"확인"})})]})]})]})}function N1({defaultQuery:e,onClose:t,onSelect:r}){const[a,i]=c.useState(e||""),[s,o]=c.useState([]),[l,d]=c.useState(!1),[f,u]=c.useState(null);async function h(){d(!0),u(null);try{const m=new URL("/api/v1/customers",window.location.origin);a.trim()&&m.searchParams.set("name",a.trim()),m.searchParams.set("mineOnly","false"),m.searchParams.set("limit","100");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const x=await p.json(),v=Array.isArray(x)?x.map(g=>({customerSeq:(g==null?void 0:g.customerSeq)??(g==null?void 0:g.customer_seq)??null,customerId:(g==null?void 0:g.customerId)??(g==null?void 0:g.customer_id)??null,customerName:(g==null?void 0:g.customerName)??(g==null?void 0:g.customer_name)??null,telNo:(g==null?void 0:g.telNo)??(g==null?void 0:g.tel_no)??null,addrProvinceName:(g==null?void 0:g.addrProvinceName)??(g==null?void 0:g.addr_province_name)??null,addrCityName:(g==null?void 0:g.addrCityName)??(g==null?void 0:g.addr_city_name)??null,companyType:(g==null?void 0:g.companyType)??(g==null?void 0:g.company_type)??null,ownerName:(g==null?void 0:g.ownerName)??(g==null?void 0:g.owner_name)??null})):[];o(v)}catch(m){u((m==null?void 0:m.message)||"조회 실패"),o([])}finally{d(!1)}}return c.useEffect(()=>{h()},[]),c.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"거래처명",value:a,onChange:m=>i(m.target.value),onKeyDown:m=>{m.key==="Enter"&&h()},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:h,children:"조회"})]}),n.jsx("div",{className:"table-container",style:{height:360},children:s.length===0?n.jsx("div",{className:"empty-state",children:l?"불러오는 중…":f||"결과가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:220},children:"거래처명"}),n.jsx("th",{style:{width:140},children:"회사구분"}),n.jsx("th",{style:{width:140},children:"대표자명"}),n.jsx("th",{style:{width:180},children:"지역"})]})}),n.jsx("tbody",{children:s.map((m,p)=>n.jsxs("tr",{onDoubleClick:()=>r(m),onClick:()=>r(m),children:[n.jsx("td",{children:m.customerName||""}),n.jsx("td",{children:m.companyType||""}),n.jsx("td",{children:m.ownerName||""}),n.jsx("td",{children:[m.addrProvinceName,m.addrCityName].filter(Boolean).join(" ")})]},p))})]})})]})]})}function k1({defaultQuery:e,onClose:t,onSelect:r}){const[a,i]=c.useState(e||""),[s,o]=c.useState([]),[l,d]=c.useState(!1),[f,u]=c.useState(null);async function h(){d(!0),u(null);try{const m=new URL("/api/v1/leads",window.location.origin);a.trim()&&m.searchParams.set("company_name",a.trim()),m.searchParams.set("limit","100");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const x=await p.json(),v=Array.isArray(x)?x.map(g=>({id:(g==null?void 0:g.id)!=null?Number(g.id):null,companyName:(g==null?void 0:g.company_name)??null,leadStatus:(g==null?void 0:g.lead_status)??null,ownerName:(g==null?void 0:g.owner_name)??null,addrProvinceName:(g==null?void 0:g.addr_province_name)??null})):[];o(v)}catch(m){u((m==null?void 0:m.message)||"조회 실패"),o([])}finally{d(!1)}}return c.useEffect(()=>{h()},[]),c.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:800,maxHeight:"80%",overflow:"auto",padding:12},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"잠재고객명",value:a,onChange:m=>i(m.target.value),onKeyDown:m=>{m.key==="Enter"&&h()},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:h,children:"조회"})]}),n.jsx("div",{className:"table-container",style:{height:360},children:s.length===0?n.jsx("div",{className:"empty-state",children:l?"불러오는 중…":f||"결과가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:220},children:"잠재고객명"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:140},children:"소유자"}),n.jsx("th",{style:{width:160},children:"지역"})]})}),n.jsx("tbody",{children:s.map((m,p)=>n.jsxs("tr",{onDoubleClick:()=>r(m),onClick:()=>r(m),children:[n.jsx("td",{children:m.companyName||""}),n.jsx("td",{children:m.leadStatus||""}),n.jsx("td",{children:m.ownerName||""}),n.jsx("td",{children:m.addrProvinceName||""})]},p))})]})})]})]})}function A1({defaultQuery:e,onClose:t,onSelect:r}){const[a,i]=c.useState(e||""),[s,o]=c.useState([]),[l,d]=c.useState(!1),[f,u]=c.useState(null);async function h(){d(!0),u(null);try{const m=new URL("/api/v1/employees",window.location.origin);m.searchParams.set("depts","all");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const x=await p.json(),v=Array.isArray(x)?x.map(y=>({empId:(y==null?void 0:y.emp_id)??null,empName:(y==null?void 0:y.emp_name)??null,deptName:(y==null?void 0:y.dept_name)??null,assigneeId:(y==null?void 0:y.assignee_id)??null})):[],g=a.trim().toLowerCase(),b=(g?v.filter(y=>(y.empName||"").toLowerCase().includes(g)||(y.empId||"").toLowerCase().includes(g)||(y.deptName||"").toLowerCase().includes(g)):v).sort((y,A)=>(y.empName||"").localeCompare(A.empName||"","ko",{sensitivity:"base"}));o(b)}catch(m){u((m==null?void 0:m.message)||"조회 실패"),o([])}finally{d(!1)}}return c.useEffect(()=>{h()},[]),c.useEffect(()=>{const m=p=>{p.key==="Escape"&&(p.preventDefault(),t())};return window.addEventListener("keydown",m,!0),()=>window.removeEventListener("keydown",m,!0)},[t]),n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1100},children:[n.jsx("div",{onClick:t,style:{position:"absolute",inset:0,background:"rgba(0,0,0,.4)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",top:"10%",left:"50%",transform:"translateX(-50%)",width:"90%",maxWidth:700,maxHeight:"80%",overflow:"auto",padding:12},children:[n.jsx("button",{"aria-label":"닫기",onClick:t,className:"btn-plain",style:{position:"absolute",top:8,right:8},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})}),n.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center",marginBottom:8},children:[n.jsx("input",{className:"subject-input",placeholder:"이름/사번/부서",value:a,onChange:m=>i(m.target.value),onKeyDown:m=>{m.key==="Enter"&&h()},style:{flex:1}}),n.jsx("button",{className:"btn",onClick:h,children:"조회"})]}),n.jsx("div",{className:"table-container",style:{height:320},children:s.length===0?n.jsx("div",{className:"empty-state",children:l?"불러오는 중…":f||"결과가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:160},children:"이름"}),n.jsx("th",{style:{width:160},children:"부서"}),n.jsx("th",{style:{width:140},children:"사번"}),n.jsx("th",{style:{width:140},children:"assignee_id"})]})}),n.jsx("tbody",{children:s.map((m,p)=>n.jsxs("tr",{onDoubleClick:()=>r(m),onClick:()=>r(m),children:[n.jsx("td",{children:m.empName||""}),n.jsx("td",{children:m.deptName||""}),n.jsx("td",{children:m.empId||""}),n.jsx("td",{children:m.assigneeId||""})]},p))})]})})]})]})}function C1({compact:e=!1,maxHeight:t}){const[r,a]=c.useState([]),[i,s]=c.useState(!1),[o,l]=c.useState(null),[d,f]=c.useState(()=>{try{const p=localStorage.getItem("tnt.sales.selectedEstimate");if(p){const x=JSON.parse(p),v=Number(x==null?void 0:x.id);return Number.isFinite(v)?v:null}}catch{}return null});async function u(){l(null),s(!0);try{const p=["/api/v1/estimates","/api/v1/quotes"];let x=null;for(const g of p)try{const b=await fetch(g);if(b.ok){x=await b.json();break}}catch{}let v=[];Array.isArray(x)?v=x.map((g,b)=>({id:Number((g==null?void 0:g.id)??b+1),estimateNumber:String((g==null?void 0:g.estimateNumber)??(g==null?void 0:g.estimate_number)??""),title:String((g==null?void 0:g.title)??""),status:String((g==null?void 0:g.status)??""),owner:String((g==null?void 0:g.owner)??(g==null?void 0:g.ownerId)??(g==null?void 0:g.owner_id)??""),issuedAt:String((g==null?void 0:g.issuedAt)??(g==null?void 0:g.issued_at)??"")})):v=[{id:1,estimateNumber:"E-2025-0001",title:"제품 견적 A",status:"draft",owner:"kim",issuedAt:"2025-02-01T10:00:00Z"},{id:2,estimateNumber:"E-2025-0002",title:"서비스 견적 B",status:"sent",owner:"lee",issuedAt:"2025-02-03T11:00:00Z"}],v.sort((g,b)=>(g.title||"").localeCompare(b.title||"","ko",{sensitivity:"base"})),a(v),v.length>0&&d==null&&h(v[0])}catch(p){l((p==null?void 0:p.message)||"조회 중 오류가 발생했습니다")}finally{s(!1)}}c.useEffect(()=>{u()},[]);function h(p){f(p.id);try{localStorage.setItem("tnt.sales.selectedEstimate",JSON.stringify(p)),window.dispatchEvent(new CustomEvent("tnt.sales.estimate.selected",{detail:{estimate:p}}))}catch{}}return c.useMemo(()=>n.jsx("div",{className:"table-container",style:{maxHeight:t??(e?"32vh":void 0)},children:r.length===0?n.jsx("div",{className:"empty-state",children:i?"불러오는 중…":o||"데이터가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:140},children:"견적번호"}),n.jsx("th",{children:"제목"}),n.jsx("th",{style:{width:120},children:"상태"}),n.jsx("th",{style:{width:140},children:"소유자"}),n.jsx("th",{style:{width:180},children:"발행시각"})]})}),n.jsx("tbody",{children:r.map((p,x)=>n.jsxs("tr",{className:d===p.id?"selected":void 0,onClick:()=>h(p),children:[n.jsx("td",{children:p.estimateNumber||""}),n.jsx("td",{children:p.title||""}),n.jsx("td",{children:p.status||""}),n.jsx("td",{children:p.owner||""}),n.jsx("td",{children:p.issuedAt?(()=>{const v=new Date(p.issuedAt);if(isNaN(v.getTime()))return p.issuedAt;const g=String(v.getFullYear()%100).padStart(2,"0"),b=String(v.getMonth()+1).padStart(2,"0"),y=String(v.getDate()).padStart(2,"0"),A=String(v.getHours()).padStart(2,"0"),C=String(v.getMinutes()).padStart(2,"0");return`${g}-${b}-${y} ${A}:${C}`})():""})]},x))})]})}),[r,d,i,o,e,t])}function P1(){const[e,t]=c.useState(()=>{try{const s=localStorage.getItem("tnt.sales.selectedEstimate");return s?JSON.parse(s):null}catch{return null}});c.useEffect(()=>{const s=()=>{try{const o=localStorage.getItem("tnt.sales.selectedEstimate");t(o?JSON.parse(o):null)}catch{t(null)}};return window.addEventListener("tnt.sales.estimate.selected",s),()=>window.removeEventListener("tnt.sales.estimate.selected",s)},[]);const r=c.useMemo(()=>n.jsx("div",{className:"card",style:{padding:12},children:e?n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:10},children:[n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"견적번호"}),n.jsx("div",{className:"subject-input",children:e.estimateNumber||""})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"상태"}),n.jsx("div",{className:"subject-input",children:e.status||""})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"제목"}),n.jsx("div",{className:"subject-input",children:e.title||""})]}),n.jsxs("div",{className:"field",children:[n.jsx("label",{children:"소유자"}),n.jsx("div",{className:"subject-input",children:e.owner||""})]})]}):n.jsx("div",{className:"empty-state",children:"선택된 견적이 없습니다."})}),[e]),[a,i]=c.useState("details");return n.jsxs("section",{children:[n.jsx("div",{className:"page-title",children:n.jsx("h2",{children:"견적"})}),n.jsx(C1,{compact:!0,maxHeight:"32vh"}),n.jsxs("section",{className:"card",style:{marginTop:12,minHeight:240},children:[n.jsxs("div",{className:"tabs c360-tabs",children:[n.jsx("button",{className:a==="details"?"tab active":"tab",onClick:()=>i("details"),children:"상세"}),n.jsx("button",{className:a==="items"?"tab active":"tab",onClick:()=>i("items"),children:"품목"}),n.jsx("button",{className:a==="attachments"?"tab active":"tab",onClick:()=>i("attachments"),children:"첨부"})]}),n.jsxs("div",{style:{marginTop:12},children:[a==="details"&&r,a==="items"&&n.jsx("div",{className:"empty-state",children:"견적 품목(추후)"}),a==="attachments"&&n.jsx("div",{className:"empty-state",children:"첨부 파일(추후)"})]})]})]})}function E1(){const[e,t]=c.useState(()=>Df()),[r,a]=c.useState(Hl());c.useEffect(()=>Kb(()=>a(Hl())),[]);function i(s){const o=!Kl(s);Yb(s,o),a(Hl())}return n.jsxs("section",{children:[n.jsx("h1",{children:"설정"}),n.jsx("p",{className:"muted",children:"좌측 메뉴(1, 2 레벨)를 표시/숨김으로 제어합니다. 모든 사용자에게 동일하게 적용됩니다(임시: 로컬 저장소 기반)."}),n.jsx("div",{style:{display:"flex",gap:24,alignItems:"flex-start",marginTop:12},children:n.jsxs("div",{style:{flex:1},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n.jsx("h3",{style:{margin:"12px 0"},children:"메뉴 표시 설정"}),n.jsx("button",{className:"btn",onClick:()=>t(Df()),children:"메뉴 다시 읽기"})]}),n.jsx("ul",{style:{listStyle:"none",padding:0,margin:0},children:e.map(s=>{var o;return n.jsxs("li",{style:{marginBottom:10},children:[n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Kl(s.key),onChange:()=>i(s.key)}),n.jsx("strong",{children:s.label}),n.jsxs("span",{className:"muted",style:{fontSize:12},children:["(",s.key,")"]})]}),(o=s.children)!=null&&o.length?n.jsx("ul",{style:{listStyle:"none",padding:"6px 0 0 22px",margin:0},children:s.children.map(l=>n.jsx("li",{style:{marginBottom:6},children:n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"checkbox",checked:Kl(l.key),onChange:()=>i(l.key)}),n.jsx("span",{children:l.label}),n.jsxs("span",{className:"muted",style:{fontSize:12},children:["(",l.key,")"]})]})},l.key))}):null]},s.key)})})]})})]})}function I1(){const[e,t]=c.useState(null),[r,a]=c.useState({}),[i,s]=c.useState(null),[o,l]=c.useState({open:!1,text:""}),[d,f]=c.useState([]),u=c.useMemo(()=>{try{return localStorage.getItem("tnt.sales.assigneeId")||""}catch{return""}},[]),h=c.useMemo(()=>{try{return localStorage.getItem("tnt.sales.empId")||""}catch{return""}},[]);c.useEffect(()=>{const E=()=>{try{const T=localStorage.getItem("tnt.sales.selectedLead"),B=T?JSON.parse(T):null;t(B),a({...B||{}}),s(null)}catch{t(null),a({}),s(null)}};return window.addEventListener("tnt.sales.lead.selected",E),()=>window.removeEventListener("tnt.sales.lead.selected",E)},[]);function m(E,T){a(B=>({...B,[E]:T})),i&&s(null)}async function p(){if(!(!r||r.id==null))try{const E={...r};delete E.created_by_name,delete E.updated_by_name,delete E.created_at,delete E.updated_at;try{(!r.assignee_id||String(r.assignee_id).trim()==="")&&(delete E.assignee_id,delete E.owner_name,delete E.owner_id)}catch{}try{const P=localStorage.getItem("tnt.sales.assigneeId")||"";P&&(E.updated_by=P)}catch{}const T=await fetch(`/api/v1/leads/${r.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)});if(!T.ok)throw new Error(`HTTP ${T.status}`);const B=await T.json().catch(()=>({}));if(B!=null&&B.ok){const P=r.company_name||"";l({open:!0,text:`${P} 수정되었습니다.`});try{const _=await fetch(`/api/v1/leads/${r.id}`),U=_.ok?await _.json():r;a(fe=>({...fe,...U||{}})),t(fe=>({...fe||{},...U||{}})),localStorage.setItem("tnt.sales.selectedLead",JSON.stringify(U||r)),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:U||r}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:U||r}}))}catch{try{localStorage.setItem("tnt.sales.selectedLead",JSON.stringify(r)),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:r}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:r}}))}catch{}}}else throw new Error("저장 실패")}catch(E){s((E==null?void 0:E.message)||"저장 중 오류가 발생했습니다")}}c.useEffect(()=>{(async()=>{try{const E=await fetch("/api/v1/employees");if(!E.ok)return;const T=await E.json();if(Array.isArray(T)){let B=[...T];if(!B.some(_=>String((_==null?void 0:_.emp_name)||"")==="윤이랑"))try{const _=await fetch("/api/v1/employees?depts=all");if(_.ok){const U=await _.json();if(Array.isArray(U)){const fe=U.find(ae=>String((ae==null?void 0:ae.emp_name)||"")==="윤이랑");fe&&(B=[...B,fe])}}}catch{}f(B)}}catch{}})()},[]);const x=!r||r.id==null,[v,g]=c.useState(!1),[b,y]=c.useState(""),[A,C]=c.useState(""),[N,w]=c.useState(!1),[M,O]=c.useState({}),[D,W]=c.useState(!1),{ref:j,style:S,bindHeader:R,bindContainer:I}=jn("lead.tm",v,E=>{const T=document.querySelector(".pane.center"),B=T?T.getBoundingClientRect():null,P=E.getBoundingClientRect(),_=P.width,U=P.height,fe=B?B.left+(B.width-_)/2:(window.innerWidth-_)/2,ae=Math.max(0,window.innerHeight-U-16),F=Math.min(Math.max(0,fe),window.innerWidth-_),pe=Math.min(Math.max(0,ae),window.innerHeight-U);return{x:F,y:pe}},{persist:!1,resetOnOpen:!0}),{ref:$,style:J,bindHeader:q,bindContainer:K}=jn("lead.new",N,E=>{const T=document.querySelector(".pane.center"),B=T?T.getBoundingClientRect():null,P=E.getBoundingClientRect(),_=P.width,U=P.height,fe=B?B.left+(B.width-_)/2:(window.innerWidth-_)/2,ae=Math.max(0,window.innerHeight*.1),F=Math.min(Math.max(0,fe),window.innerWidth-_),pe=Math.min(Math.max(0,ae),window.innerHeight-U);return{x:F,y:pe}},{persist:!1,resetOnOpen:!0});c.useEffect(()=>{if(!N)return;const E=T=>{T.key==="Escape"&&w(!1)};return window.addEventListener("keydown",E,!0),()=>window.removeEventListener("keydown",E,!0)},[N]),c.useEffect(()=>{if(!v)return;const E=T=>{T.key==="Escape"&&g(!1)};return window.addEventListener("keydown",E,!0),()=>window.removeEventListener("keydown",E,!0)},[v]);function L(E){if(!E)return"";const T=new Date(E);return isNaN(T.getTime())?String(E):new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}).format(T)}const ee=c.useMemo(()=>{const E=["신규등록","접촉 중","영업 접촉 중","전환성공"],T=((r==null?void 0:r.lead_status)||"").trim(),B=T==="자격미달"||T==="전환실패";let P=E.indexOf(T);T==="자격미달"&&(P=1),T==="전환실패"&&(P=E.length-1),P<0&&(P=0);const _=Math.max(0,Math.min(100,Math.round(P/Math.max(1,E.length-1)*100)));return n.jsxs("div",{className:"page-title",children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,minWidth:0,flex:"1 1 auto"},children:[n.jsx("h2",{style:{margin:0},children:"잠재고객"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,flex:"0 1 520px"},children:[n.jsx("div",{className:"progress",style:{width:"min(520px, 48vw)"},children:n.jsx("div",{className:"progress-bar",style:{width:`${_}%`,background:B?"#ef4444":"var(--accent)"}})}),n.jsx("div",{style:{display:"flex",justifyContent:"space-between",width:"min(520px, 48vw)",fontSize:11,color:"var(--muted)"},children:E.map(U=>n.jsx("span",{style:{fontWeight:T===U?700:400},children:U},U))})]})]}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsx("button",{className:"btn",onClick:()=>{O({}),w(!0)},children:"신규"}),n.jsx("button",{className:"btn",onClick:()=>W(!0),disabled:x,children:"영업활동 등록"}),n.jsx("button",{className:"btn",onClick:()=>{g(!0),s(null)},disabled:x,children:"TM활동 등록"})]})]})},[x,r.lead_status]);return n.jsxs("section",{children:[ee,n.jsx("div",{className:"card",style:{padding:12},children:r&&r.id!=null?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"form-grid",style:{columnGap:10,rowGap:6},children:[n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"상태"}),n.jsxs("select",{className:"search-input",value:r.lead_status||"",onChange:E=>m("lead_status",E.target.value),children:[n.jsx("option",{value:"",children:"(선택)"}),n.jsx("option",{value:"신규등록",children:"신규등록"}),n.jsx("option",{value:"자격미달",children:"자격미달"}),n.jsx("option",{value:"접촉 중",children:"접촉 중"}),n.jsx("option",{value:"영업 접촉 중",children:"영업 접촉 중"}),n.jsx("option",{value:"전환성공",children:"전환성공"}),n.jsx("option",{value:"전환실패",children:"전환실패"})]})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"소스"}),n.jsxs("select",{className:"search-input",value:r.lead_source||"",onChange:E=>m("lead_source",E.target.value),children:[n.jsx("option",{value:"",children:"(선택)"}),n.jsx("option",{value:"목록구매",children:"목록구매"}),n.jsx("option",{value:"내부추천",children:"내부추천"}),n.jsx("option",{value:"외부추천",children:"외부추천"}),n.jsx("option",{value:"전시회/행사",children:"전시회/행사"})]})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"회사"}),n.jsx("input",{className:"search-input",type:"text",value:r.company_name||"",onChange:E=>m("company_name",E.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"거래처 담당자"}),n.jsx("input",{className:"search-input",type:"text",value:r.contact_name||"",onChange:E=>m("contact_name",E.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"이메일"}),n.jsx("input",{className:"search-input",type:"text",value:r.email||"",onChange:E=>m("email",E.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"연락처"}),n.jsx("input",{className:"search-input",type:"text",value:r.contact_phone||"",onChange:E=>m("contact_phone",E.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"대표번호"}),n.jsx("input",{className:"search-input",type:"text",value:r.office_phone||"",onChange:E=>m("office_phone",E.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"업종"}),n.jsxs("select",{className:"search-input",value:r.biz_type||"",onChange:E=>m("biz_type",E.target.value),children:[n.jsx("option",{value:"",children:"(선택)"}),n.jsx("option",{value:"가공",children:"가공"}),n.jsx("option",{value:"시공",children:"시공"}),n.jsx("option",{value:"가시공",children:"가시공"}),n.jsx("option",{value:"유통",children:"유통"}),n.jsx("option",{value:"알수없음",children:"알수없음"})]})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"사업자번호"}),n.jsx("input",{className:"search-input",type:"text",value:r.biz_no||"",onChange:E=>m("biz_no",E.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"지역(도/광역)"}),n.jsx("input",{className:"search-input",type:"text",value:r.addr_province_name||"",onChange:E=>m("addr_province_name",E.target.value)})]}),n.jsxs("div",{className:"field inline-field row-2",children:[n.jsx("label",{children:"주소"}),n.jsx("input",{className:"search-input",type:"text",value:r.address||"",onChange:E=>m("address",E.target.value)})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"팩스"}),n.jsx("input",{className:"search-input",type:"text",value:r.fax_no||"",onChange:E=>m("fax_no",E.target.value)})]}),n.jsxs("div",{className:"field inline-field row-2",children:[n.jsx("label",{children:"비고"}),n.jsx("textarea",{className:"search-input",value:r.note||"",onChange:E=>m("note",E.target.value),style:{minHeight:80}})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"소유자"}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,alignItems:"center"},children:[n.jsxs("select",{className:"search-input",value:r.assignee_id||"",onChange:E=>m("assignee_id",E.target.value||null),children:[n.jsx("option",{value:"",children:"(선택)"}),d.map(E=>n.jsxs("option",{value:E.assignee_id,children:[E.dept_name," · ",E.emp_name]},E.assignee_id))]}),n.jsx("div",{style:{whiteSpace:"nowrap",alignSelf:"center",fontSize:12},children:(()=>{const E=r.owner_name&&String(r.owner_name).trim()?String(r.owner_name):"",T=r.assignee_id||"",B=d.find(_=>_.assignee_id===T);return`현재소유자 : ${E||(B?B.emp_name:"")||"-"}`})()})]})]}),n.jsxs("div",{className:"field inline-four row-2",children:[n.jsx("label",{children:"작성자"}),n.jsxs("div",{className:"subject-input",style:{padding:"6px 8px"},children:[r.created_by_name||(r.created_by??"")||u||h,r.created_at?`, ${L(r.created_at)}`:""]}),n.jsx("label",{children:"최종 수정자"}),n.jsxs("div",{className:"subject-input",style:{padding:"6px 8px"},children:[r.updated_by_name||(r.updated_by??"")||u||h,r.updated_at?`, ${L(r.updated_at)}`:""]})]})]}),n.jsxs("div",{className:"controls",style:{justifyContent:"space-between",marginTop:10,gap:8},children:[n.jsx("div",{"aria-live":"polite",style:{fontSize:12,color:"var(--accent)"},children:i||""}),n.jsx("div",{children:n.jsxs("div",{style:{display:"inline-flex",gap:8},children:[n.jsx("button",{className:"btn",onClick:p,disabled:x,children:"저장"}),x?null:n.jsx("button",{className:"btn btn-danger",onClick:async()=>{if(r!=null&&r.id){`${r.id}`;try{const E=await fetch(`/api/v1/leads/${r.id}`,{method:"DELETE"});if(!E.ok){const T=await E.json().catch(()=>null);throw new Error((T==null?void 0:T.message)||`HTTP ${E.status}`)}l({open:!0,text:"삭제되었습니다."}),a({}),t(null),localStorage.removeItem("tnt.sales.selectedLead"),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:null}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:null}}))}catch(E){s((E==null?void 0:E.message)||"삭제 중 오류가 발생했습니다")}}},children:"삭제"})]})})]})]}):n.jsx("div",{className:"empty-state",children:"우측에서 잠재고객을 선택하세요."})}),v&&n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e4,pointerEvents:"none"},children:[n.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)",pointerEvents:"none"}}),n.jsxs("div",{ref:j,className:"card",style:{...S,width:"min(720px, 92vw)",maxHeight:"80vh",overflow:"auto",padding:16,pointerEvents:"auto"},...I,children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10,cursor:"move"},...R,children:[n.jsx("h3",{style:{margin:0},children:"TM 활동 등록"}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:()=>g(!1),onKeyDown:E=>{(E.key==="Enter"||E.key===" ")&&(E.preventDefault(),g(!1))},children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"제목"}),n.jsx("input",{className:"search-input",type:"text",value:b,onChange:E=>y(E.target.value),placeholder:"제목"})]}),n.jsxs("div",{className:"field inline-field row-2",children:[n.jsx("label",{children:"활동 설명"}),n.jsx("textarea",{className:"search-input",value:A,onChange:E=>C(E.target.value),placeholder:"활동 설명",style:{minHeight:100}})]}),n.jsxs("div",{className:"field inline-field row-2",children:[n.jsx("label",{children:"잠재고객"}),n.jsxs("div",{className:"subject-input",style:{padding:"6px 8px"},children:[r.company_name||"",r.contact_name?` / ${r.contact_name}`:"",r.contact_phone?` / ${r.contact_phone}`:""]})]}),n.jsxs("div",{className:"controls",style:{justifyContent:"flex-end",marginTop:10,gap:8},children:[n.jsx("button",{className:"btn",onClick:()=>g(!1),children:"취소"}),n.jsx("button",{className:"btn",onClick:async()=>{try{const E=localStorage.getItem("tnt.sales.assigneeId")||localStorage.getItem("tnt.sales.empId")||"";if(!E){s("로그인이 필요합니다");return}const T={sfOwnerId:E,subject:b||"",description:A||"",activityType:"전화",activityStatus:"계획",channel:"전화",sfLeadId:(r==null?void 0:r.id)!=null?String(r.id):void 0,createdBy:localStorage.getItem("tnt.sales.empId")||void 0,updatedBy:localStorage.getItem("tnt.sales.empId")||void 0},B=await fetch("/api/v1/sales-activities",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)});if(!B.ok){let P=`HTTP ${B.status}`;try{const _=await B.json();_!=null&&_.error&&(P=_.error)}catch{}throw new Error(P)}g(!1),y(""),C("");try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated",{detail:{leadId:r==null?void 0:r.id}}))}catch{}l({open:!0,text:"TM 활동이 등록되었습니다."})}catch(E){s((E==null?void 0:E.message)||"TM 활동 등록 실패")}},children:"저장"})]})]})]}),N&&n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:1e4,pointerEvents:"none"},children:[n.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)",pointerEvents:"none"}}),n.jsxs("div",{ref:$,className:"card",style:{...J,width:"min(880px, 96vw)",maxHeight:"86vh",overflow:"auto",padding:16,pointerEvents:"auto"},...K,children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10,cursor:"move"},...q,children:[n.jsx("h3",{style:{margin:0},children:"잠재고객 신규"}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:()=>w(!1),children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})})]}),n.jsxs("div",{className:"form-grid",style:{columnGap:10,rowGap:6},children:[n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"상태"}),n.jsxs("select",{className:"search-input",value:M.lead_status||"",onChange:E=>O(T=>({...T,lead_status:E.target.value})),children:[n.jsx("option",{value:"",children:"(선택)"}),n.jsx("option",{value:"신규등록",children:"신규등록"}),n.jsx("option",{value:"자격미달",children:"자격미달"}),n.jsx("option",{value:"접촉 중",children:"접촉 중"}),n.jsx("option",{value:"영업 접촉 중",children:"영업 접촉 중"}),n.jsx("option",{value:"전환성공",children:"전환성공"}),n.jsx("option",{value:"전환실패",children:"전환실패"})]})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"소스"}),n.jsxs("select",{className:"search-input",value:M.lead_source||"",onChange:E=>O(T=>({...T,lead_source:E.target.value})),children:[n.jsx("option",{value:"",children:"(선택)"}),n.jsx("option",{value:"목록구매",children:"목록구매"}),n.jsx("option",{value:"내부추천",children:"내부추천"}),n.jsx("option",{value:"외부추천",children:"외부추천"}),n.jsx("option",{value:"전시회/행사",children:"전시회/행사"})]})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"회사"}),n.jsx("input",{className:"search-input",type:"text",value:M.company_name||"",onChange:E=>O(T=>({...T,company_name:E.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"거래처 담당자"}),n.jsx("input",{className:"search-input",type:"text",value:M.contact_name||"",onChange:E=>O(T=>({...T,contact_name:E.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"이메일"}),n.jsx("input",{className:"search-input",type:"text",value:M.email||"",onChange:E=>O(T=>({...T,email:E.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"연락처"}),n.jsx("input",{className:"search-input",type:"text",value:M.contact_phone||"",onChange:E=>O(T=>({...T,contact_phone:E.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"대표번호"}),n.jsx("input",{className:"search-input",type:"text",value:M.office_phone||"",onChange:E=>O(T=>({...T,office_phone:E.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"업종"}),n.jsxs("select",{className:"search-input",value:M.biz_type||"",onChange:E=>O(T=>({...T,biz_type:E.target.value})),children:[n.jsx("option",{value:"",children:"(선택)"}),n.jsx("option",{value:"가공",children:"가공"}),n.jsx("option",{value:"시공",children:"시공"}),n.jsx("option",{value:"가시공",children:"가시공"}),n.jsx("option",{value:"유통",children:"유통"}),n.jsx("option",{value:"알수없음",children:"알수없음"})]})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"사업자번호"}),n.jsx("input",{className:"search-input",type:"text",value:M.biz_no||"",onChange:E=>O(T=>({...T,biz_no:E.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"지역(도/광역)"}),n.jsx("input",{className:"search-input",type:"text",value:M.addr_province_name||"",onChange:E=>O(T=>({...T,addr_province_name:E.target.value}))})]}),n.jsxs("div",{className:"field inline-field row-2",children:[n.jsx("label",{children:"주소"}),n.jsx("input",{className:"search-input",type:"text",value:M.address||"",onChange:E=>O(T=>({...T,address:E.target.value}))})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"팩스"}),n.jsx("input",{className:"search-input",type:"text",value:M.fax_no||"",onChange:E=>O(T=>({...T,fax_no:E.target.value}))})]}),n.jsxs("div",{className:"field inline-field row-2",children:[n.jsx("label",{children:"비고"}),n.jsx("textarea",{className:"search-input",value:M.note||"",onChange:E=>O(T=>({...T,note:E.target.value})),style:{minHeight:80}})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"소유자"}),n.jsxs("select",{className:"search-input",value:M.assignee_id||"",onChange:E=>O(T=>({...T,assignee_id:E.target.value||null})),children:[n.jsx("option",{value:"",children:"(선택)"}),d.map(E=>n.jsxs("option",{value:E.assignee_id,children:[E.dept_name," · ",E.emp_name]},E.assignee_id))]})]})]}),n.jsxs("div",{className:"controls",style:{justifyContent:"flex-end",marginTop:10,gap:8},children:[n.jsx("button",{className:"btn",onClick:()=>w(!1),children:"취소"}),n.jsx("button",{className:"btn",onClick:async()=>{try{const E={...M},T=localStorage.getItem("tnt.sales.empId")||void 0;T&&(E.created_by=T,E.updated_by=T);const B=await fetch("/api/v1/leads",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E)}),P=await B.json().catch(()=>({}));if(!B.ok||P&&P.error)throw new Error((P==null?void 0:P.error)||`HTTP ${B.status}`);const _=P==null?void 0:P.id,U={...M||{},id:_};try{localStorage.setItem("tnt.sales.selectedLead",JSON.stringify(U)),window.dispatchEvent(new CustomEvent("tnt.sales.lead.selected",{detail:{lead:U}})),window.dispatchEvent(new CustomEvent("tnt.sales.lead.updated",{detail:{lead:U}}))}catch{}w(!1);const fe=M.company_name||"";l({open:!0,text:`${fe} 신규 생성되었습니다.`})}catch{}},children:"저장"})]})]})]}),n.jsx(sg,{open:D,onClose:()=>W(!1),leadId:(r==null?void 0:r.id)??null,leadName:(r==null?void 0:r.company_name)||""}),o.open?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:o.text}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>l({open:!1,text:""}),children:"확인"})})]})}):null]})}function Vl(e){if(!e)return"";const t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"";const r=String(t.getFullYear()%100).padStart(2,"0"),a=String(t.getMonth()+1).padStart(2,"0"),i=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0");return`${r}-${a}-${i} ${s}:${o}`}function T1({leadId:e}){const[t,r]=c.useState([]),[a,i]=c.useState(!1),[s,o]=c.useState(null),[l,d]=c.useState(()=>({open:!1,x:0,y:0})),[f,u]=c.useState(!1),[h,m]=c.useState(""),[p,x]=c.useState(""),[v,g]=c.useState(null),[b,y]=c.useState({open:!1,text:""});async function A(){if(!e){r([]);return}i(!0),o(null);try{const M=new URL("/api/v1/sales-activities",window.location.origin);M.searchParams.set("mineOnly","false"),M.searchParams.set("sfLeadId",String(e));const O=await fetch(M.toString());if(!O.ok)throw new Error(`HTTP ${O.status}`);const D=await O.json(),W=Array.isArray(D)?D.map(j=>({id:Number(j==null?void 0:j.id),subject:(j==null?void 0:j.subject)??"",description:(j==null?void 0:j.description)??"",activityType:(j==null?void 0:j.activityType)??"",activityStatus:(j==null?void 0:j.activityStatus)??"",channel:(j==null?void 0:j.channel)??"",plannedStartAt:(j==null?void 0:j.plannedStartAt)??null,plannedEndAt:(j==null?void 0:j.plannedEndAt)??null,createdAt:(j==null?void 0:j.createdAt)??null,lastUpdateAt:(j==null?void 0:j.lastUpdateAt)??null,ownerName:(j==null?void 0:j.ownerName)??(j==null?void 0:j.owner_name)??""})):[];r(W)}catch(M){o((M==null?void 0:M.message)||"조회 중 오류가 발생했습니다"),r([])}finally{i(!1)}}c.useEffect(()=>{A()},[e]),c.useEffect(()=>{const M=()=>{A()};return window.addEventListener("tnt.sales.activity.updated",M),()=>window.removeEventListener("tnt.sales.activity.updated",M)},[e]),c.useEffect(()=>{if(!f)return;const M=O=>{O.key==="Escape"&&u(!1)};return window.addEventListener("keydown",M,!0),()=>window.removeEventListener("keydown",M,!0)},[f]),c.useEffect(()=>{f||(C.current=null)},[f]),c.useEffect(()=>{if(!l.open)return;const M=()=>d({open:!1,x:0,y:0}),O=D=>{D.key==="Escape"&&d({open:!1,x:0,y:0})};return window.addEventListener("click",M,!1),window.addEventListener("keydown",O,!0),()=>{window.removeEventListener("click",M,!1),window.removeEventListener("keydown",O,!0)}},[l.open]);const C=c.useRef(null);function N(M){g(M.id),C.current!==M.id&&(m(M.subject||""),x(M.description||""),C.current=M.id),u(!0)}const w=c.useMemo(()=>n.jsxs("div",{className:"table-container",style:{maxHeight:"50vh",overflow:"auto"},children:[t.length===0?n.jsx("div",{className:"empty-state",children:a?"불러오는 중…":s||"활동이 없습니다."}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:120},children:"담당자"}),n.jsx("th",{style:{width:260},children:"제목"}),n.jsx("th",{children:"활동내역"}),n.jsx("th",{style:{width:150},children:"계획일시"}),n.jsx("th",{style:{width:150},children:"종료 일시"}),n.jsx("th",{style:{width:120},children:"활동유형"}),n.jsx("th",{style:{width:120},children:"활동상태"}),n.jsx("th",{style:{width:180},children:"최종 수정일"})]})}),n.jsx("tbody",{children:t.map(M=>n.jsxs("tr",{onContextMenu:O=>{O.preventDefault(),O.stopPropagation(),d({open:!0,x:O.clientX,y:O.clientY,row:M})},children:[n.jsx("td",{title:M.ownerName||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:M.ownerName||""}),n.jsx("td",{title:M.subject||"",style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:M.subject||""}),n.jsx("td",{title:M.description||"",style:{maxWidth:600,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:M.description||""}),n.jsx("td",{children:Vl(M.plannedStartAt)}),n.jsx("td",{children:Vl(M.plannedEndAt)}),n.jsx("td",{children:M.activityType||""}),n.jsx("td",{children:M.activityStatus||""}),n.jsx("td",{children:Vl(M.lastUpdateAt)})]},M.id))})]}),l.open&&l.row&&n.jsx("div",{className:"context-menu",style:{left:l.x+4,top:l.y+4},onClick:M=>M.stopPropagation(),children:n.jsx("button",{className:"context-item",style:{width:96,padding:"4px 6px"},onClick:M=>{M.preventDefault(),M.stopPropagation(),N(l.row),d({open:!1,x:0,y:0})},children:"수정"})})]}),[t,a,s,l]);return n.jsxs("section",{children:[w,f&&n.jsxs("div",{role:"dialog","aria-modal":"true",style:{position:"fixed",inset:0,zIndex:2e4},children:[n.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,.25)"}}),n.jsxs("div",{className:"card",style:{position:"absolute",left:"50%",top:"20%",transform:"translateX(-50%)",width:"min(720px, 92vw)",maxHeight:"80vh",overflow:"auto",padding:16},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:10},children:[n.jsx("h3",{style:{margin:0},children:"TM 활동 수정"}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"닫기",title:"닫기",onClick:()=>u(!1),children:n.jsx("img",{src:Pt,className:"icon",alt:"닫기"})})]}),n.jsxs("div",{className:"field inline-field",children:[n.jsx("label",{children:"제목"}),n.jsx("input",{className:"search-input",type:"text",value:h,onChange:M=>m(M.target.value),placeholder:"제목"})]}),n.jsxs("div",{className:"field inline-field row-2",children:[n.jsx("label",{children:"활동 설명"}),n.jsx("textarea",{className:"search-input",value:p,onChange:M=>x(M.target.value),placeholder:"활동 설명",style:{minHeight:100}})]}),n.jsxs("div",{className:"controls",style:{justifyContent:"flex-end",marginTop:10,gap:8},children:[n.jsx("button",{className:"btn",onClick:()=>u(!1),children:"취소"}),n.jsx("button",{className:"btn",onClick:async()=>{try{if(!v)return;const M={subject:h||"",description:p||""},O=await fetch(`/api/v1/sales-activities/${v}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(M)});if(!O.ok)throw new Error(`HTTP ${O.status}`);u(!1),y({open:!0,text:`${(h||"").trim()||"(제목없음)"} 변경되었습니다.`});try{window.dispatchEvent(new CustomEvent("tnt.sales.activity.updated",{detail:{id:v}}))}catch{}}catch{}},children:"저장"})]})]})]}),b.open?n.jsx("div",{role:"dialog","aria-modal":"true",className:"card",style:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:70},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:10,minWidth:260,maxWidth:"86vw"},children:[n.jsx("div",{style:{marginBottom:8,fontWeight:700,textAlign:"center"},children:b.text}),n.jsx("div",{style:{display:"flex",justifyContent:"center"},children:n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>y({open:!1,text:""}),children:"확인"})})]})}):null]})}function O1(){const[e,t]=c.useState(null);return c.useEffect(()=>{try{localStorage.removeItem("tnt.sales.selectedLead")}catch{}const r=()=>{try{const a=localStorage.getItem("tnt.sales.selectedLead");t(a?JSON.parse(a):null)}catch{t(null)}};return window.addEventListener("tnt.sales.lead.selected",r),()=>window.removeEventListener("tnt.sales.lead.selected",r)},[]),n.jsxs("section",{children:[n.jsx(I1,{}),n.jsxs("section",{className:"card",style:{marginTop:12,minHeight:240},children:[n.jsx("div",{className:"tabs c360-tabs",children:n.jsx("button",{className:"tab active",children:"활동"})}),n.jsx("div",{style:{marginTop:12},children:e!=null&&e.id?n.jsx(T1,{leadId:e.id}):n.jsx("div",{style:{minHeight:160}})})]})]})}function _1(e){if(!e)return"-";const t=new Date(e);if(Number.isNaN(t.getTime()))return"-";const r=d=>String(d).padStart(2,"0"),a=r(t.getFullYear()%100),i=r(t.getMonth()+1),s=r(t.getDate()),o=r(t.getHours()),l=r(t.getMinutes());return`${a}-${i}-${s} ${o}:${l}`}function M1(){const[e,t]=c.useState("weekly"),[r,a]=c.useState("owner"),[i,s]=c.useState(""),[o,l]=c.useState(()=>new Date().toISOString().split("T")[0]),[d,f]=c.useState([]),[u,h]=c.useState([]),[m,p]=c.useState(null),[x,v]=c.useState([]),[g,b]=c.useState(null),[y,A]=c.useState(!1),[C,N]=c.useState([]);c.useEffect(()=>{(async()=>{try{const j=await fetch("/api/v1/employees");if(!j.ok)return;const S=await j.json();if(Array.isArray(S)){let R=[...S];if(!R.some($=>String(($==null?void 0:$.emp_name)||"")==="윤이랑"))try{const $=await fetch("/api/v1/employees?depts=all");if($.ok){const J=await $.json();if(Array.isArray(J)){const q=J.find(K=>String((K==null?void 0:K.emp_name)||"")==="윤이랑");q&&(R=[...R,q])}}}catch{}N(R)}}catch{}})()},[]);function w(){const j=new Date(o);if(e==="daily"){const S=new Date(j);S.setDate(S.getDate()-1);const R=new Date(j);return R.setDate(R.getDate()+1),[{label:"전일",startDate:S.toISOString().split("T")[0],endDate:S.toISOString().split("T")[0],count:0},{label:"금일",startDate:o,endDate:o,count:0},{label:"익일",startDate:R.toISOString().split("T")[0],endDate:R.toISOString().split("T")[0],count:0}]}else if(e==="weekly"){const S=new Date(j),R=S.getDay(),I=S.getDate()-R+(R===0?-6:1),$=new Date(S.setDate(I)),J=$.toISOString().split("T")[0],q=new Date($);q.setDate(q.getDate()+6);const K=new Date($);K.setDate(K.getDate()-7);const L=new Date(K);L.setDate(L.getDate()+6);const ee=new Date($);ee.setDate(ee.getDate()+7);const E=new Date(ee);return E.setDate(E.getDate()+6),[{label:"전주",startDate:K.toISOString().split("T")[0],endDate:L.toISOString().split("T")[0],count:0},{label:"금주",startDate:J,endDate:q.toISOString().split("T")[0],count:0},{label:"차주",startDate:ee.toISOString().split("T")[0],endDate:E.toISOString().split("T")[0],count:0}]}else{const S=new Date(j),R=new Date(S.getFullYear(),S.getMonth(),1),I=new Date(S.getFullYear(),S.getMonth()+1,0),$=new Date(S.getFullYear(),S.getMonth()-1,1),J=new Date(S.getFullYear(),S.getMonth(),0),q=new Date(S.getFullYear(),S.getMonth()+1,1),K=new Date(S.getFullYear(),S.getMonth()+2,0);return[{label:"전월",startDate:$.toISOString().split("T")[0],endDate:J.toISOString().split("T")[0],count:0},{label:"금월",startDate:R.toISOString().split("T")[0],endDate:I.toISOString().split("T")[0],count:0},{label:"익월",startDate:q.toISOString().split("T")[0],endDate:K.toISOString().split("T")[0],count:0}]}}async function M(){A(!0),p(null),v([]),b(null);const j=w();try{const S={period:e,filterType:r,baseDate:o};i&&(S.empId=i);const R=new URLSearchParams(S),[I,$]=await Promise.all([fetch(`/api/v1/lead-stats/registration?${R.toString()}`),fetch(`/api/v1/lead-stats/activity?${R.toString()}`)]);if(I.ok&&$.ok){const J=await I.json(),q=await $.json(),K=(L,ee)=>!Array.isArray(L)||L.length===0?ee:L.map(E=>({label:E.label,count:Number(E.count)||0,startDate:E.startDate||o,endDate:E.endDate||o}));f(K(J,j)),h(K(q,j))}else{if(console.error("Failed to fetch stats. Reg:",I.status,"Act:",$.status),!I.ok){const J=await I.text();console.error("Registration error:",J)}if(!$.ok){const J=await $.text();console.error("Activity error:",J)}f(j),h(j)}}catch(S){console.error("Failed to load stats",S),f(j),h(j)}finally{A(!1)}}async function O(j){try{const S=r==="owner"&&i?`AND CAST(l.assignee_id AS TEXT) = '${i}'`:"",R=r==="creator"&&i?`AND CAST(l.created_by AS TEXT) = '${i}'`:"",I={filterType:r,startDate:j.startDate,endDate:j.endDate};i&&(I.empId=i);const $=new URLSearchParams(I),J=await fetch(`/api/v1/lead-stats/registration/details?${$.toString()}`);if(J.ok){const q=await J.json();v(q),p(j),b(null)}}catch(S){console.error("Failed to load registration details",S)}}function D(j){const S=new Date(o);let R;e==="daily"?R=j==="prev"?new Date(S.setDate(S.getDate()-1)):new Date(S.setDate(S.getDate()+1)):e==="weekly"?R=j==="prev"?new Date(S.setDate(S.getDate()-7)):new Date(S.setDate(S.getDate()+7)):R=j==="prev"?new Date(S.setMonth(S.getMonth()-1)):new Date(S.setMonth(S.getMonth()+1));const I=R.toISOString().split("T")[0];l(I),setTimeout(()=>{W(I)},0)}async function W(j){A(!0),p(null),v([]),b(null);const R=(()=>{const I=new Date(j);if(e==="daily"){const $=new Date(I);$.setDate($.getDate()-1);const J=new Date(I);return J.setDate(J.getDate()+1),[{label:"전일",startDate:$.toISOString().split("T")[0],endDate:$.toISOString().split("T")[0],count:0},{label:"금일",startDate:j,endDate:j,count:0},{label:"익일",startDate:J.toISOString().split("T")[0],endDate:J.toISOString().split("T")[0],count:0}]}else if(e==="weekly"){const $=new Date(I),J=$.getDay(),q=$.getDate()-J+(J===0?-6:1),K=new Date($.setDate(q)),L=K.toISOString().split("T")[0],ee=new Date(K);ee.setDate(ee.getDate()+6);const E=new Date(K);E.setDate(E.getDate()-7);const T=new Date(E);T.setDate(T.getDate()+6);const B=new Date(K);B.setDate(B.getDate()+7);const P=new Date(B);return P.setDate(P.getDate()+6),[{label:"전주",startDate:E.toISOString().split("T")[0],endDate:T.toISOString().split("T")[0],count:0},{label:"금주",startDate:L,endDate:ee.toISOString().split("T")[0],count:0},{label:"차주",startDate:B.toISOString().split("T")[0],endDate:P.toISOString().split("T")[0],count:0}]}else{const $=new Date(I),J=new Date($.getFullYear(),$.getMonth(),1),q=new Date($.getFullYear(),$.getMonth()+1,0),K=new Date($.getFullYear(),$.getMonth()-1,1),L=new Date($.getFullYear(),$.getMonth(),0),ee=new Date($.getFullYear(),$.getMonth()+1,1),E=new Date($.getFullYear(),$.getMonth()+2,0);return[{label:"전월",startDate:K.toISOString().split("T")[0],endDate:L.toISOString().split("T")[0],count:0},{label:"금월",startDate:J.toISOString().split("T")[0],endDate:q.toISOString().split("T")[0],count:0},{label:"익월",startDate:ee.toISOString().split("T")[0],endDate:E.toISOString().split("T")[0],count:0}]}})();try{const I={period:e,filterType:r,baseDate:j};i&&(I.empId=i);const $=new URLSearchParams(I),[J,q]=await Promise.all([fetch(`/api/v1/lead-stats/registration?${$.toString()}`),fetch(`/api/v1/lead-stats/activity?${$.toString()}`)]);if(J.ok&&q.ok){const K=await J.json(),L=await q.json(),ee=(E,T)=>!Array.isArray(E)||E.length===0?T:E.map(B=>({label:B.label,count:Number(B.count)||0,startDate:B.startDate||j,endDate:B.endDate||j}));f(ee(K,R)),h(ee(L,R))}else f(R),h(R)}catch(I){console.error("Failed to load stats",I),f(R),h(R)}finally{A(!1)}}return n.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",overflow:"hidden"},children:[n.jsx("div",{style:{padding:"16px 20px",borderBottom:"1px solid var(--border)",background:"var(--panel)"},children:n.jsx("h2",{style:{margin:0,fontSize:18,fontWeight:700,color:"var(--text)"},children:"TM현황"})}),n.jsxs("div",{style:{padding:"12px 20px",borderBottom:"1px solid var(--border)",background:"var(--panel)",display:"flex",gap:12,flexWrap:"wrap",alignItems:"center"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:"조회기간:"}),n.jsxs("select",{value:e,onChange:j=>t(j.target.value),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13},children:[n.jsx("option",{value:"daily",children:"일별"}),n.jsx("option",{value:"weekly",children:"주간"}),n.jsx("option",{value:"monthly",children:"월간"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:"구분:"}),n.jsxs("select",{value:r,onChange:j=>a(j.target.value),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13},children:[n.jsx("option",{value:"owner",children:"소유자"}),n.jsx("option",{value:"creator",children:"등록자"})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsxs("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:[r==="owner"?"소유자":"등록자",":"]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr auto",gap:8,alignItems:"center"},children:[n.jsxs("select",{className:"search-input",value:i||"",onChange:j=>s(j.target.value||""),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13,minWidth:160},children:[n.jsx("option",{value:"",children:"전체"}),C.map(j=>n.jsxs("option",{value:j.assignee_id,children:[j.dept_name," · ",j.emp_name]},j.assignee_id))]}),n.jsx("div",{style:{whiteSpace:"nowrap",alignSelf:"center",fontSize:12,color:"var(--muted)"},children:(()=>{const j=C.find(R=>R.assignee_id===i);return`현재선택 : ${j?j.emp_name:"전체"}`})()})]})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("label",{style:{fontSize:13,color:"var(--muted)",whiteSpace:"nowrap"},children:"기준일자:"}),n.jsx("input",{type:"date",value:o,onChange:j=>l(j.target.value),style:{height:32,padding:"0 8px",borderRadius:6,border:"1px solid var(--border)",background:"var(--panel)",color:"var(--text)",fontSize:13}})]}),n.jsx("button",{onClick:M,disabled:y,className:"btn btn-card btn-3d",style:{height:32,fontSize:13,padding:"0 20px",fontWeight:600},children:y?"조회 중...":"조회"}),n.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[n.jsx("button",{onClick:()=>D("prev"),className:"btn btn-card",style:{height:32,width:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center"},title:"이전",disabled:d.length===0&&u.length===0,children:n.jsx("img",{src:Gp,alt:"이전",style:{width:16,height:16}})}),n.jsx("button",{onClick:()=>D("next"),className:"btn btn-card",style:{height:32,width:32,padding:0,display:"flex",alignItems:"center",justifyContent:"center"},title:"다음",disabled:d.length===0&&u.length===0,children:n.jsx("img",{src:Vp,alt:"다음",style:{width:16,height:16}})})]})]}),n.jsx("div",{style:{flex:1,minHeight:0,overflow:"auto",padding:20},children:y?n.jsx("div",{style:{textAlign:"center",padding:40,color:"var(--muted)"},children:"데이터를 불러오는 중..."}):n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20,height:"100%"},children:[n.jsxs("div",{style:{flex:"0 0 auto",display:"flex",gap:20,flexWrap:"wrap"},children:[n.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:12},children:[n.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"var(--text)"},children:"잠재고객 등록현황"}),d.length===0?n.jsxs("div",{style:{textAlign:"center",padding:40,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8},children:[n.jsx("div",{style:{fontSize:48,marginBottom:16,opacity:.3},children:"📊"}),n.jsx("div",{style:{fontSize:15,color:"var(--muted)",marginBottom:8},children:"조회 조건을 설정하고 조회 버튼을 클릭하세요"})]}):n.jsx(n.Fragment,{children:n.jsx("div",{style:{display:"flex",gap:12},children:d.map((j,S)=>n.jsxs("button",{onClick:()=>O(j),className:"btn btn-card btn-3d",style:{flex:1,minHeight:120,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:8,background:(m==null?void 0:m.label)===j.label?"var(--primary)":"var(--panel)",color:(m==null?void 0:m.label)===j.label?"#fff":"var(--text)",border:(m==null?void 0:m.label)===j.label?"2px solid var(--primary)":"1px solid var(--border)"},children:[n.jsx("div",{style:{fontSize:14,fontWeight:600},children:j.label}),n.jsx("div",{style:{fontSize:28,fontWeight:700},children:j.count}),n.jsx("div",{style:{fontSize:11,opacity:.7},children:j.startDate===j.endDate?j.startDate:`${j.startDate} ~ ${j.endDate}`})]},S))})})]}),n.jsxs("div",{style:{flex:1,minWidth:0,display:"flex",flexDirection:"column",gap:12},children:[n.jsx("h3",{style:{margin:0,fontSize:15,fontWeight:600,color:"var(--text)"},children:"잠재고객 활동현황"}),u.length===0?n.jsxs("div",{style:{textAlign:"center",padding:40,background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8},children:[n.jsx("div",{style:{fontSize:48,marginBottom:16,opacity:.3},children:"📊"}),n.jsx("div",{style:{fontSize:15,color:"var(--muted)",marginBottom:8},children:"조회 조건을 설정하고 조회 버튼을 클릭하세요"})]}):n.jsx("div",{style:{display:"flex",gap:12},children:u.map((j,S)=>n.jsxs("div",{className:"btn-card btn-3d",style:{flex:1,minHeight:120,display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:8,background:"var(--panel)",color:"var(--text)",border:"1px solid var(--border)",cursor:"default",opacity:.8},children:[n.jsx("div",{style:{fontSize:14,fontWeight:600},children:j.label}),n.jsx("div",{style:{fontSize:28,fontWeight:700},children:j.count}),n.jsx("div",{style:{fontSize:11,opacity:.7},children:j.startDate===j.endDate?j.startDate:`${j.startDate} ~ ${j.endDate}`})]},S))})]})]}),m&&x.length>0&&n.jsxs("div",{style:{flex:1,minHeight:0,display:"flex",gap:12},children:[n.jsxs("div",{style:{flex:1,minWidth:0,overflow:"auto",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,padding:12},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[n.jsxs("h4",{style:{margin:0,fontSize:14,fontWeight:600,color:"var(--text)"},children:[m.label," 등록 목록 (",x.length,"건)"]}),n.jsx("span",{style:{fontSize:12,color:"#e11d48",fontWeight:600},children:"잠재고객 클릭시 활동 조회"})]}),n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:x.map(j=>n.jsxs("button",{onClick:()=>b(j.id),style:{padding:10,background:g===j.id?"var(--primary-light)":"var(--background)",border:g===j.id?"2px solid var(--primary)":"1px solid var(--border)",borderRadius:6,fontSize:13,textAlign:"left",cursor:"pointer",transition:"all 0.2s"},children:[n.jsxs("div",{style:{fontWeight:600,color:g===j.id?"var(--primary)":"var(--text)",marginBottom:4},children:[j.company_name||"-",j.activities&&j.activities.length>0&&n.jsxs("span",{style:{marginLeft:8,fontSize:11,color:"var(--muted)"},children:["(활동 ",j.activities.length,"건)"]})]}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12},children:["담당자: ",j.contact_name||"-"]}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["상태: ",j.lead_status||"-"," | 업종: ",j.biz_type||"-"]}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["지역: ",j.addr_province_name||"-"]}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["최종수정: ",_1(j.updated_at)]})]},j.id))})]}),g&&(()=>{var S;const j=x.find(R=>R.id===g);return j?n.jsxs("div",{style:{flex:1,minWidth:0,overflow:"auto",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,padding:12},children:[n.jsxs("h4",{style:{margin:"0 0 12px",fontSize:14,fontWeight:600,color:"var(--text)"},children:[j.company_name||"-"," 활동 목록 (",((S=j.activities)==null?void 0:S.length)||0,"건)"]}),!j.activities||j.activities.length===0?n.jsx("div",{style:{textAlign:"center",padding:20,color:"var(--muted)",fontSize:13},children:"활동 데이터가 없습니다"}):n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:j.activities.map(R=>n.jsxs("div",{style:{padding:10,background:"var(--background)",border:"1px solid var(--border)",borderRadius:6,fontSize:13},children:[n.jsx("div",{style:{fontWeight:600,color:"var(--text)",marginBottom:4},children:R.subject||"-"}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12},children:["유형: ",R.activity_type||"-"," | 상태: ",R.activity_status||"-"]}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["계획: ",R.planned_start_at?new Date(R.planned_start_at).toLocaleString("ko-KR"):"-"]}),R.actual_start_at&&n.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["실제: ",new Date(R.actual_start_at).toLocaleString("ko-KR")]}),R.description&&n.jsx("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:R.description}),n.jsxs("div",{style:{color:"var(--muted)",fontSize:12,marginTop:4},children:["수정: ",R.updated_at?new Date(R.updated_at).toLocaleString("ko-KR"):"-"]})]},R.id))})]}):null})()]})]})})]})}const Yf="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3cline%20x1='12'%20y1='5'%20x2='12'%20y2='19'/%3e%3cline%20x1='5'%20y1='12'%20x2='19'%20y2='12'/%3e%3c/svg%3e";function D1(){const[e,t]=c.useState(""),[r,a]=c.useState(""),[i,s]=c.useState([]),[o,l]=c.useState(!1),[d,f]=c.useState(null),[u,h]=c.useState(null),[m,p]=c.useState([]),[x,v]=c.useState(!1),[g,b]=c.useState(!1),[y,A]=c.useState({open:!1,x:0,y:0}),C=c.useRef(null);async function N(P){try{v(!0);const _=u!=null?i[u]:null,U=new URLSearchParams;U.set("q",r.trim()||e.trim());const fe=P??(_==null?void 0:_.customerSeq);fe!=null&&U.set("customerSeq",String(fe));const ae=await fetch(`/api/v1/items/search?${U.toString()}`),F=ae.ok?await ae.json():[],pe=Array.isArray(F)?F.map(H=>({itemSeq:H==null?void 0:H.itemSeq,itemName:String((H==null?void 0:H.itemName)??""),recentInvoiceDate:(H==null?void 0:H.recentInvoiceDate)??(H==null?void 0:H.recent_invoice_date)??null,curAmt:(H==null?void 0:H.curAmt)??null,qty:(H==null?void 0:H.qty)??null,srcPri:(H==null?void 0:H.srcPri)!=null?Number(H.srcPri):void 0,itemStdUnit:(H==null?void 0:H.itemStdUnit)??(H==null?void 0:H.item_std_unit)??null,companyType:(H==null?void 0:H.companyType)||(H==null?void 0:H.company_type)||null})):[];p(pe)}catch{p([])}finally{v(!1)}}const[w,M]=c.useState(()=>({open:!1,text:""})),[O,D]=c.useState([]);async function W(P){if(!(P==null||P.itemName==null)){b(!0);try{let _,U=typeof P.itemStdUnit=="string"?P.itemStdUnit:void 0,fe,ae;const F=await fetch(`/api/v1/items/spec?itemName=${encodeURIComponent(String(P.itemName))}`);if(F.ok){const ge=await F.json().catch(()=>({}));ge&&ge.itemSpec&&(_=String(ge.itemSpec)),!U&&ge&&ge.itemStdUnit&&(fe=String(ge.itemStdUnit),U=fe),ge&&ge.companyType&&(ae=String(ge.companyType))}const pe=localStorage.getItem("tnt.sales.ordersheet.cart"),H=pe?JSON.parse(pe):[];if((Array.isArray(H)?H.findIndex(ge=>String(ge.itemName)===String(P.itemName)):-1)>=0){alert("이미 주문에 포함되어 있습니다."),b(!1);return}else{const ge=ae||P.companyType||null,je={itemSeq:P.itemSeq,itemName:P.itemName,itemSpec:_||"",qty:"",itemStdUnit:U||void 0,companyType:ge};H.push(je)}localStorage.setItem("tnt.sales.ordersheet.cart",JSON.stringify(H)),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.cart.changed",{detail:{cart:H}}))}catch{}finally{b(!1)}}}function j(P){try{const U=[JSON.parse(P)];let fe=null;for(;U.length;){const ae=U.shift();if(Array.isArray(ae)){if(ae.length&&typeof ae[0]=="object"){fe=ae;break}}else if(ae&&typeof ae=="object")for(const F of Object.keys(ae))U.push(ae[F])}return fe?fe.map(ae=>{const F=(ae==null?void 0:ae.WHName)??(ae==null?void 0:ae.whName)??(ae==null?void 0:ae.warehouseName)??(ae==null?void 0:ae.WH_NM)??(ae==null?void 0:ae.wh_nm)??"",pe=Number((ae==null?void 0:ae.AvailStock)??(ae==null?void 0:ae.availStock)??(ae==null?void 0:ae.AVAIL_STOCK)??(ae==null?void 0:ae.qty)??0)||0,H=(ae==null?void 0:ae.UnitName)??(ae==null?void 0:ae.unitName)??(ae==null?void 0:ae.UNIT_NAME)??(ae==null?void 0:ae.salesMgmtUnit)??"";return{whName:String(F||""),avail:pe,unitName:String(H||"")}}):[]}catch{return[]}}async function S(P,_){const fe=P.currentTarget.getBoundingClientRect(),ae=fe.right,F=fe.bottom;A({open:!0,x:ae,y:F,loading:!0});try{const pe={bizUnit:"",stdDate:"",whSeq:"",itemName:String(_.itemName||""),itemNo:"",itemSeq:String(_.itemSeq||""),pageNo:"",pageSize:""},H=await fetch("/api/v1/items/avail-stock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(pe)});if(H.ok){const Q=await H.json().catch(()=>({})),ge=Q&&(Q.receivedPayload||Q),je=JSON.stringify(ge,null,2),Ne=j(je);A({open:!0,x:ae,y:F,loading:!1,error:null,rows:Ne})}else A({open:!0,x:ae,y:F,loading:!1,error:`HTTP ${H.status}`})}catch(pe){A({open:!0,x:ae,y:F,loading:!1,error:(pe==null?void 0:pe.message)||"재고 조회 실패"})}}c.useEffect(()=>{if(!y.open)return;const P=U=>{const fe=C.current;fe&&U.target instanceof Node&&!fe.contains(U.target)&&A({open:!1,x:0,y:0})},_=U=>{U.key==="Escape"&&A({open:!1,x:0,y:0})};return document.addEventListener("mousedown",P,!0),window.addEventListener("keydown",_,!0),()=>{document.removeEventListener("mousedown",P,!0),window.removeEventListener("keydown",_,!0)}},[y.open]);async function R(){var P;l(!0),f(null);try{const _=new URLSearchParams;e.trim()&&_.set("name",e.trim()),_.set("mineOnly","false");const U=await fetch(`/api/v1/customers?${_.toString()}`);if(!U.ok)throw new Error(`HTTP ${U.status}`);const fe=await U.json(),ae=Array.isArray(fe)?fe.map(F=>({customerId:(F==null?void 0:F.customerId)??"",customerName:(F==null?void 0:F.customerName)??"",bizNo:(F==null?void 0:F.bizNo)??"",ownerName:(F==null?void 0:F.ownerName)??(F==null?void 0:F.empName)??"",telNo:(F==null?void 0:F.telNo)??"",customerSeq:(F==null?void 0:F.customerSeq)!=null?Number(F.customerSeq):void 0,addrProvinceName:(F==null?void 0:F.addrProvinceName)??(F==null?void 0:F.addr_province_name)??"",addrCityName:(F==null?void 0:F.addrCityName)??(F==null?void 0:F.addr_city_name)??"",companyType:String((F==null?void 0:F.company_type)??(F==null?void 0:F.companyType)??(F==null?void 0:F.company)??"").toUpperCase(),companyCode:String((F==null?void 0:F.companyCode)??(F==null?void 0:F.company_code)??(F==null?void 0:F.company_type)??(F==null?void 0:F.companyType)??(F==null?void 0:F.company)??"").toUpperCase()})):[];if(ae.sort((F,pe)=>String(F.customerName||"").localeCompare(String(pe.customerName||""),"ko-KR")),s(ae),ae.length>0){h(0);try{localStorage.setItem("tnt.sales.ordersheet.selectedCustomer",JSON.stringify(ae[0])),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.customer.selected",{detail:{customer:ae[0]}}))}catch{}await N((P=ae[0])==null?void 0:P.customerSeq)}else h(null),p([])}catch(_){f((_==null?void 0:_.message)||"조회 중 오류가 발생했습니다"),s([])}finally{l(!1)}}c.useEffect(()=>{try{localStorage.removeItem("tnt.sales.ordersheet.selectedCustomer"),localStorage.removeItem("tnt.sales.ordersheet.cart"),localStorage.removeItem("tnt.sales.ordersheet.regionGroup"),localStorage.removeItem("tnt.sales.ordersheet.requests"),localStorage.removeItem("tnt.sales.ordersheet.deliveryDueDate")}catch{}},[]);function I(P,_){h(_);try{localStorage.setItem("tnt.sales.ordersheet.selectedCustomer",JSON.stringify(P)),window.dispatchEvent(new CustomEvent("tnt.sales.ordersheet.customer.selected",{detail:{customer:P}}))}catch{}N(P.customerSeq),$(P.customerSeq)}async function $(P){try{D([]);const _=P!=null?Number(P):NaN;if(!Number.isFinite(_))return;const U=await fetch(`/api/v1/customers/${_}/transactions`,{cache:"no-store"});if(!U.ok)return;const fe=await U.json().catch(()=>[]);if(!Array.isArray(fe)){D([]);return}const ae=Date.now()-365*24*60*60*1e3,F={};for(const H of fe){const Q=String((H==null?void 0:H.itemName)??(H==null?void 0:H.item_name)??"").trim();if(!Q)continue;const ge=(H==null?void 0:H.itemSeq)??(H==null?void 0:H.item_seq)??null,je=(H==null?void 0:H.companyType)??(H==null?void 0:H.company_type)??null,Ne=Number((H==null?void 0:H.curAmt)??(H==null?void 0:H.cur_amt)??0)||0,Y=Number((H==null?void 0:H.qty)??0)||0,ve=String((H==null?void 0:H.invoiceDate)??(H==null?void 0:H.invoice_date)??""),se=Date.parse(ve)||Date.parse(ve.replace(" ","T"))||NaN;if(!Number.isFinite(se)||se<ae)continue;const Le=ge!=null?String(ge):Q,Fe=F[Le]||{itemSeq:ge,itemName:Q,companyType:je||null,recent:0,totalAmt:0,totalQty:0};Fe.totalAmt+=Ne,Fe.totalQty+=Y,se>Fe.recent&&(Fe.recent=se),Fe.itemSeq==null&&ge!=null&&(Fe.itemSeq=ge),!Fe.companyType&&je&&(Fe.companyType=je),F[Le]=Fe}const pe=Object.values(F).sort((H,Q)=>Q.recent-H.recent||H.itemName.localeCompare(Q.itemName,"ko",{sensitivity:"base"})).map(H=>({itemSeq:H.itemSeq,itemName:H.itemName,companyType:H.companyType,recentDate:new Date(H.recent).toISOString().slice(0,10),totalAmt:H.totalAmt,totalQty:H.totalQty}));D(pe)}catch{D([])}}const J=c.useMemo(()=>n.jsx("div",{className:"table-container",style:{maxHeight:"40vh"},children:i.length===0?n.jsx("div",{className:"empty-state",children:o?"불러오는 중…":d||"데이터가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:160},children:"회사코드"}),n.jsx("th",{children:"거래처명"}),n.jsx("th",{style:{width:160},children:"대표자"}),n.jsx("th",{style:{width:180},children:"사업자번호"}),n.jsx("th",{style:{width:160},children:"대표번호"})]})}),n.jsx("tbody",{children:i.map((P,_)=>n.jsxs("tr",{className:u===_?"selected":void 0,onClick:()=>I(P,_),children:[n.jsx("td",{children:P.companyCode||P.companyType||""}),n.jsx("td",{children:P.customerName}),n.jsx("td",{children:P.ownerName}),n.jsx("td",{children:P.bizNo}),n.jsx("td",{children:P.telNo})]},_))})]})}),[i,o,d,u]),q=c.useMemo(()=>O.length===0?null:n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"muted",style:{fontSize:12,marginTop:8,marginBottom:4},children:"최근거래내역"}),n.jsx("div",{className:"table-container",style:{maxHeight:"24vh"},children:n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"품목"}),n.jsx("th",{style:{width:120},children:"최근거래일"}),n.jsx("th",{style:{width:140,textAlign:"right"},children:"총금액"}),n.jsx("th",{style:{width:100,textAlign:"right"},children:"총수량"}),n.jsx("th",{style:{width:80}})]})}),n.jsx("tbody",{children:O.map((P,_)=>n.jsxs("tr",{children:[n.jsx("td",{children:P.itemName}),n.jsx("td",{children:P.recentDate}),n.jsx("td",{style:{textAlign:"right"},children:Number(P.totalAmt||0).toLocaleString()}),n.jsx("td",{style:{textAlign:"right"},children:Number(P.totalQty||0).toLocaleString()}),n.jsxs("td",{children:[n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"재고 조회",title:"재고 조회",onClick:U=>ee(U,P.itemName),onKeyDown:U=>{(U.key==="Enter"||U.key===" ")&&(U.preventDefault(),ee(U,P.itemName))},children:n.jsx("img",{src:Rf,className:"icon",alt:"재고"})}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"담기",title:"담기",onClick:()=>E(P),onKeyDown:U=>{(U.key==="Enter"||U.key===" ")&&(U.preventDefault(),E(P))},children:n.jsx("img",{src:Yf,className:"icon",alt:"담기"})})]})]},_))})]})})]}),[O]);function K(){try{const P=localStorage.getItem("tnt.sales.ordersheet.selectedCustomer");if(!P)return null;const _=JSON.parse(P),U=Number(_==null?void 0:_.customerSeq);return Number.isFinite(U)?U:null}catch{return null}}async function L(P){const _=m.find(U=>String(U.itemName).trim()===String(P).trim());if(_&&_.itemSeq!=null)return{itemSeq:_.itemSeq,itemName:_.itemName};try{const U=new URLSearchParams;U.set("q",P);const fe=K();fe!=null&&U.set("customerSeq",String(fe));const ae=await fetch(`/api/v1/items/search?${U.toString()}`),F=ae.ok?await ae.json():[],pe=Array.isArray(F)?F:[],H=pe.find(Q=>String((Q==null?void 0:Q.itemName)||"").trim()===String(P).trim())||pe[0];if(H&&H.itemSeq!=null)return{itemSeq:H.itemSeq,itemName:String(H.itemName||P)}}catch{}return null}async function ee(P,_){const U=await L(_);U&&await S(P,U)}async function E(P){let _=P;if(!_.itemSeq){const U=await L(P.itemName);if(!U)return;_={..._,...U}}await W({itemSeq:_.itemSeq,itemName:_.itemName,companyType:_.companyType||void 0})}const T=new Intl.NumberFormat("ko-KR"),B=c.useMemo(()=>n.jsx("div",{className:"table-container",style:{maxHeight:"32vh",marginTop:12},children:m.length===0?n.jsx("div",{className:"empty-state",children:x?"품목 불러오는 중…":"품목 데이터가 없습니다"}):n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"품목명"}),n.jsx("th",{style:{width:140},children:"최근거래일시"}),n.jsx("th",{style:{width:120,textAlign:"right"},children:"총금액"}),n.jsx("th",{style:{width:100,textAlign:"right"},children:"총수량"}),n.jsx("th",{style:{width:90}})]})}),n.jsx("tbody",{children:m.map((P,_)=>n.jsxs("tr",{className:P.srcPri===0?"inv-row":void 0,onDoubleClick:()=>W(P),title:"더블클릭하면 우측 수주장에 담습니다",children:[n.jsxs("td",{style:{display:"flex",alignItems:"center",gap:6},children:[(()=>{const fe=(P.companyType||P.company_type||P.companyCode||P.company_code||"").toString().toUpperCase(),ae=fe==="TNT"?"T":fe==="DYS"?"D":fe==="ALL"?"A":"",F=fe==="TNT"?"#2563eb":fe==="DYS"?"#10b981":fe==="ALL"?"#f59e0b":"#9ca3af";return ae?n.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:18,height:18,borderRadius:"50%",background:F,color:"#fff",fontSize:11,fontWeight:800,boxShadow:"0 0 0 1px rgba(0,0,0,.08)"},children:ae}):null})(),n.jsx("span",{children:P.itemName}),P.itemStdUnit?n.jsxs("span",{style:{fontSize:11,color:"var(--text-muted)"},children:["(",P.itemStdUnit,")"]}):null]}),n.jsx("td",{children:P.recentInvoiceDate||""}),n.jsx("td",{style:{textAlign:"right"},children:P.curAmt!=null&&P.curAmt!==""?T.format(Number(P.curAmt)):""}),n.jsx("td",{style:{textAlign:"right"},children:P.qty!=null&&P.qty!==""?T.format(Number(P.qty)):""}),n.jsxs("td",{children:[n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"재고 조회",title:"재고 조회",onClick:U=>S(U,P),onKeyDown:U=>{(U.key==="Enter"||U.key===" ")&&(U.preventDefault(),S({currentTarget:U.currentTarget},P))},children:n.jsx("img",{src:Rf,className:"icon",alt:"재고"})}),n.jsx("span",{role:"button",tabIndex:0,className:"icon-button","aria-label":"담기",title:"담기",onClick:()=>W(P),onKeyDown:U=>{(U.key==="Enter"||U.key===" ")&&(U.preventDefault(),W(P))},children:n.jsx("img",{src:Yf,className:"icon",alt:"담기"})})]})]},_))})]})}),[m,x]);return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",children:[n.jsx("h2",{children:"수주장"}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsx("input",{className:"search-input",type:"text",placeholder:"거래처명",value:e,onChange:P=>t(P.target.value),onKeyDown:P=>{P.key==="Enter"&&R()},style:{width:240}}),n.jsx("button",{className:"btn",onClick:R,disabled:o,children:"조회"})]})]}),J,q,n.jsxs("div",{className:"controls",style:{gap:8,marginTop:10},children:[n.jsx("input",{className:"search-input",type:"text",placeholder:"품목명",value:r,onChange:P=>a(P.target.value),onKeyDown:P=>{P.key==="Enter"&&N()},style:{width:240}}),n.jsx("button",{className:"btn",onClick:()=>N(),disabled:x,children:"품목 조회"})]}),B,y.open&&n.jsx("div",{ref:C,className:"context-menu",style:{left:y.x+6,top:y.y+6,position:"fixed",maxWidth:420,padding:8},onClick:P=>P.stopPropagation(),children:y.loading?n.jsx("div",{className:"muted",children:"재고 불러오는 중…"}):y.error?n.jsx("div",{className:"error",children:y.error}):!y.rows||y.rows.length===0?n.jsx("div",{className:"empty-state",children:"재고 데이터가 없습니다"}):n.jsx("div",{className:"table-container",style:{maxHeight:200,overflow:"auto",border:0},children:n.jsxs("table",{className:"table",style:{width:"100%",fontSize:12},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"창고명"}),n.jsx("th",{style:{width:100,textAlign:"right"},children:"가용재고"}),n.jsx("th",{style:{width:120},children:"단위"})]})}),n.jsx("tbody",{children:(y.rows||[]).map((P,_)=>n.jsxs("tr",{children:[n.jsx("td",{children:P.whName||"-"}),n.jsx("td",{style:{textAlign:"right"},children:Number(P.avail||0).toLocaleString()}),n.jsx("td",{children:P.unitName||""})]},_))})]})})})]})}function $1(){const e=[];for(let t=2030;t>=2026;t--)e.push(t);return e}function L1(){const[e,t]=c.useState(2026),[r,a]=c.useState(()=>{try{return localStorage.getItem("tnt.sales.assign.mode")==="Moderate"?"Moderate":"Best"}catch{return"Best"}}),[i,s]=c.useState([{company:"TNT",group:"TNT",name:"복층유리",amount:0,stage:""},{company:"TNT",group:"TNT",name:"건자재",amount:0,stage:""},{company:"DYS",group:"DYS",name:"실란트",amount:0,stage:""}]),[o,l]=c.useState(!1),[d,f]=c.useState(null),[u,h]=c.useState(null),m=new Intl.NumberFormat("ko-KR");async function p(){l(!0),f(null);try{const C=new URL("/api/v1/targets/year",window.location.origin);C.searchParams.set("year",String(e)),C.searchParams.set("versionNo",r==="Moderate"?"2":"1");const N=await fetch(C.toString()),w=N.ok?await N.json():[],M=new Map;if(Array.isArray(w))for(const O of w){const D=String((O==null?void 0:O.company_name)||"").toUpperCase()==="DYS"?"DYS":"TNT",W=String((O==null?void 0:O.biz_area_name)||""),j=Number((O==null?void 0:O.version_no)??0),S=Number((O==null?void 0:O.target_amount_max)??(O==null?void 0:O.target_amount_min)??0),R=String((O==null?void 0:O.target_stage)??""),I=`${D}||${W}`,$=M.get(I);(!$||j>$.ver)&&M.set(I,{ver:j,amt:Number.isFinite(S)?S:0,stage:R,company:D,name:W})}M.size===0?(s(O=>O.map(D=>({...D,amount:0,stage:""}))),h("영업목표가 수립되지 않았습니다.")):(s(O=>O.map(D=>{const W=`${D.company}||${D.name}`,j=M.get(W);return j?{...D,amount:j.amt,stage:j.stage}:D})),h(null))}catch(C){f((C==null?void 0:C.message)||"조회 오류")}finally{l(!1)}}c.useEffect(()=>{p()},[e,r]),c.useEffect(()=>{try{localStorage.setItem("tnt.sales.assign.mode",r)}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.assign.mode.changed",{detail:{mode:r}}))}catch{}},[r]),c.useEffect(()=>{try{localStorage.setItem("tnt.sales.assign.year",String(e)),window.dispatchEvent(new CustomEvent("tnt.sales.assign.year.changed"))}catch{}},[e]);const x=c.useMemo(()=>i.filter(C=>C.company==="TNT").reduce((C,N)=>C+(Number(N.amount)||0),0),[i]),v=c.useMemo(()=>i.filter(C=>C.company==="DYS").reduce((C,N)=>C+(Number(N.amount)||0),0),[i]);c.useEffect(()=>{try{const C={tnt:Number(x)||0,dys:Number(v)||0,year:e};localStorage.setItem("tnt.sales.assign.companyTotals",JSON.stringify(C)),window.dispatchEvent(new CustomEvent("tnt.sales.assign.companyTotals.changed"))}catch{}},[x,v,e]);function g(C,N){const w=Number((N||"").replace(/[\s,]/g,""));s(M=>M.map((O,D)=>D===C?{...O,amount:Number.isFinite(w)?w:0}:O))}async function b(C=!1){try{const N=i.map(D=>({targetYear:`${e}-01-01`,versionNo:1,companyName:D.company,bizAreaGroup:D.group,bizAreaName:D.name,targetAmountMin:D.amount,targetAmountMax:D.amount,targetStage:C?"확정":"기안중"})),w=localStorage.getItem("tnt.sales.empSeq")||"",M={"Content-Type":"application/json"};w&&(M["X-EMP-SEQ"]=String(w));const O=await fetch("/api/v1/targets/year/upsert",{method:"POST",headers:M,body:JSON.stringify(N)});if(!O.ok)throw new Error(`HTTP ${O.status}`);C&&await fetch(`/api/v1/targets/year/confirm?year=${e}`,{method:"POST",headers:M}),await p(),alert(C?"확정되었습니다.":"저장되었습니다.")}catch(N){alert((N==null?void 0:N.message)||"저장 중 오류")}}const y=c.useMemo(()=>{const C=i.filter(N=>N.company==="TNT").map(N=>(N.stage||"").trim());return C.includes("확정")?"확정":C.includes("기안중")?"기안중":""},[i]),A=c.useMemo(()=>{const C=i.filter(N=>N.company==="DYS").map(N=>(N.stage||"").trim());return C.includes("확정")?"확정":C.includes("기안중")?"기안중":""},[i]);return n.jsxs("section",{className:"card",style:{padding:12},children:[n.jsxs("div",{className:"page-title",style:{marginBottom:12},children:[n.jsx("h2",{style:{margin:0},children:"회사별 목표 입력"}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsxs("div",{role:"radiogroup","aria-label":"목표 산정 모드",className:"segmented",children:[n.jsxs("label",{className:`seg ${r==="Best"?"selected":""}`,children:[n.jsx("input",{type:"radio",name:"assign-mode",checked:r==="Best",onChange:()=>a("Best")}),n.jsx("span",{children:"Best"})]}),n.jsxs("label",{className:`seg ${r==="Moderate"?"selected":""}`,children:[n.jsx("input",{type:"radio",name:"assign-mode",checked:r==="Moderate",onChange:()=>a("Moderate")}),n.jsx("span",{children:"Moderate"})]})]}),n.jsx("select",{className:"search-input",value:e,onChange:C=>t(Number(C.target.value)),children:$1().map(C=>n.jsxs("option",{value:C,children:[C,"년"]},C))}),n.jsx("button",{className:"btn btn-3d btn-card",onClick:()=>b(!1),children:"저장"}),n.jsx("button",{className:"btn btn-3d btn-card",onClick:()=>b(!0),children:"확정"})]})]}),d&&n.jsx("div",{className:"error",children:d}),u&&!d&&n.jsx("div",{className:"empty-state",style:{marginBottom:12},children:u}),n.jsxs("div",{style:{display:"flex",gap:12,flexWrap:"nowrap",width:"100%"},children:[n.jsxs("div",{className:"card",style:{padding:12,flex:"1 1 0",minWidth:0},children:[n.jsxs("div",{style:{fontWeight:700,marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[n.jsx("span",{children:"TNT"}),y?n.jsx("span",{className:"badge",children:y}):null,o&&n.jsx("span",{className:"muted",style:{marginLeft:"auto",fontSize:12},children:"불러오는 중…"})]}),i.filter(C=>C.company==="TNT").map(C=>{const N=i.findIndex(w=>w.company===C.company&&w.name===C.name);return n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr 42px",alignItems:"center",gap:8,marginBottom:8},children:[n.jsx("div",{children:n.jsx("span",{className:"muted",children:C.name})}),n.jsx("input",{className:"assign-input",style:{textAlign:"right"},value:C.amount?m.format(C.amount):"",onChange:w=>g(N,w.target.value),placeholder:"0",disabled:r==="Moderate",title:r==="Moderate"?"Moderate 모드에서는 회사별 목표 수정이 비활성화됩니다":"값을 입력하세요"}),n.jsx("div",{className:"muted",style:{textAlign:"left"},children:"억원"})]},`TNT-${C.name}`)}),n.jsxs("div",{style:{textAlign:"right",fontWeight:700},children:["합계: ",m.format(x)," 억원"]})]}),n.jsxs("div",{className:"card",style:{padding:12,flex:"1 1 0",minWidth:0},children:[n.jsxs("div",{style:{fontWeight:700,marginBottom:8,display:"flex",alignItems:"center",gap:8},children:[n.jsx("span",{children:"DYS"}),A?n.jsx("span",{className:"badge",children:A}):null,o&&n.jsx("span",{className:"muted",style:{marginLeft:"auto",fontSize:12},children:"불러오는 중…"})]}),i.filter(C=>C.company==="DYS").map(C=>{const N=i.findIndex(w=>w.company===C.company&&w.name===C.name);return n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"180px 1fr 42px",alignItems:"center",gap:8,marginBottom:8},children:[n.jsx("div",{children:n.jsx("span",{className:"muted",children:C.name})}),n.jsx("input",{className:"assign-input",style:{textAlign:"right"},value:C.amount?m.format(C.amount):"",onChange:w=>g(N,w.target.value),placeholder:"0",disabled:r==="Moderate",title:r==="Moderate"?"Moderate 모드에서는 회사별 목표 수정이 비활성화됩니다":"값을 입력하세요"}),n.jsx("div",{className:"muted",style:{textAlign:"left"},children:"억원"})]},`DYS-${C.name}`)}),n.jsxs("div",{style:{textAlign:"right",fontWeight:700},children:["합계: ",m.format(v)," 억원"]})]})]})]})}const R1=["영업1본부","영업1팀","영업2본부","영업2팀"];function z1(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState(!1),[d,f]=c.useState(()=>{try{const I=localStorage.getItem("tnt.sales.assign.year");return I?Number(I):new Date().getFullYear()}catch{return new Date().getFullYear()}}),[u,h]=c.useState({}),[m,p]=c.useState(null),[x,v]=c.useState({}),[g,b]=c.useState(""),y=new Intl.NumberFormat("ko-KR"),[A,C]=c.useState(0);c.useEffect(()=>{const I=()=>C($=>$+1);return window.addEventListener("tnt.sales.assign.mode.changed",I),()=>window.removeEventListener("tnt.sales.assign.mode.changed",I)},[]);const N=c.useMemo(()=>{try{return(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase()==="moderate"}catch{return!1}},[A]);async function w(){a(!0),s(null);try{const I=new URL("/api/v1/targets/assigned",window.location.origin);I.searchParams.set("year",String(d));try{const T=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),B=T==="moderate"?"2":T==="best"?"1":"";B&&I.searchParams.set("versionNo",B)}catch{}const $=await fetch(I.toString()),J=$.ok?await $.json():[],q=Array.isArray(J)?J:[];if(q.length>0){const T=q.reduce((B,P)=>{const _=String(P.emp_id??P.empId??"").trim(),U=String(P.emp_name??P.empName??"").trim(),fe=String(P.dept_name??P.deptName??""),ae=_||(U?`name:${U}`:"");return ae&&(B.some(F=>F.key===ae)||B.push({key:ae,empId:_,empName:U,deptName:fe})),B},[]);T.sort((B,P)=>(B.deptName||"").localeCompare(P.deptName||"")||(B.empName||"").localeCompare(P.empName||"")),t(T),a(!1);return}const K=new URL("/api/v1/employees",window.location.origin);K.searchParams.set("depts",R1.join(","));const L=await fetch(K.toString());if(!L.ok)throw new Error(`HTTP ${L.status}`);const ee=await L.json(),E=Array.isArray(ee)?ee.map(T=>{const B=String(T.empId??T.emp_id??"").trim(),P=String(T.empName??T.emp_name??"").trim(),_=String(T.deptName??T.dept_name??""),U=String(T.assignee_id??T.assigneeId??"").trim()||void 0;return{key:B||U||(P?`name:${P}`:""),empId:B,empName:P,deptName:_,assigneeId:U}}).filter(T=>!!T.key):[];E.sort((T,B)=>(T.deptName||"").localeCompare(B.deptName||"")||(T.empName||"").localeCompare(B.empName||"")),t(E)}catch(I){s((I==null?void 0:I.message)||"조회 중 오류"),t([])}finally{a(!1)}}c.useEffect(()=>{w()},[]),c.useEffect(()=>{try{localStorage.setItem("tnt.sales.assign.empList",JSON.stringify(e)),window.dispatchEvent(new CustomEvent("tnt.sales.assign.emps.changed"))}catch{}},[e]),c.useEffect(()=>{const I=()=>{try{const $=localStorage.getItem("tnt.sales.assign.year");$&&f(Number($)),v({}),b&&b("")}catch{}};return window.addEventListener("tnt.sales.assign.year.changed",I),()=>window.removeEventListener("tnt.sales.assign.year.changed",I)},[]),c.useEffect(()=>{async function I(){try{if(!e.length){v({});return}const $=new URL("/api/v1/targets/assigned",window.location.origin);$.searchParams.set("year",String(d));try{const E=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase(),T=E==="moderate"?"2":E==="best"?"1":"";T&&$.searchParams.set("versionNo",T)}catch{}const J=await fetch($.toString()),q=J.ok?await J.json():[],K={};let L="";Array.isArray(q)&&q.forEach(E=>{const T=String(E.emp_id??E.empId??"").trim(),B=String(E.emp_name??E.empName??"").trim(),P=T||(B?`name:${B}`:"");if(!P)return;const _=String(E.company_name??E.companyName??"").toUpperCase(),U=Number(E.assigned_amount??E.assignedAmount??0),fe=String(E.target_stage??E.targetStage??"").trim(),ae=K[P]||{tnt:0,dys:0};_==="TNT"?ae.tnt=Math.round(U):_==="DYS"&&(ae.dys=Math.round(U)),K[P]=ae,fe==="확정"?L="확정":!L&&fe==="기안중"&&(L="기안중")});const ee={};e.forEach(E=>{const T=K[E.key];T&&(ee[E.key]={tnt:T.tnt||0,dys:T.dys||0})}),v(ee),b(L)}catch{}}I()},[d,e,A]),c.useEffect(()=>{async function I(){try{const $=Array.from(new Set(e.map(E=>String(E.empName||"").trim()).filter(Boolean)));if(!$.length){h({});return}const J=new URL("/api/v1/sales/employee-yearly",window.location.origin);J.searchParams.set("year",String(d)),J.searchParams.set("empNames",$.join(",")),J.searchParams.set("joinKey","emp_name");const q=await fetch(J.toString()),K=q.ok?await q.json():[],L=Array.isArray(K)?K:Array.isArray(K==null?void 0:K.employees)?K.employees:[],ee={};L.forEach(E=>{const T=String(E.emp_name??E.empName??"").trim();if(!T)return;const B=Number(E.tnt_amount??0),P=Number(E.dys_amount??0),_=ee[T]||{tnt:0,dys:0};ee[T]={tnt:_.tnt+(Number.isFinite(B)?B:0),dys:_.dys+(Number.isFinite(P)?P:0)}}),h(ee)}catch{h({})}}I()},[d,e]);function M(I,$){const J=Number($);return!Number.isFinite(J)||J<=0?"-":`${(Math.max(0,Number(I||0))*1e8/J*100).toFixed(1)}%`}const O=e;function D(I){p(I);try{localStorage.setItem("tnt.sales.selectedEmployee",JSON.stringify(I))}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.employee.selected"))}catch{}}function W(I,$,J){const q=Number((J||"").replace(/[,\s]/g,"")),K=Number.isFinite(q)?q:0;v(L=>{const E={...L[I]||{tnt:0,dys:0},[$]:K};return{...L,[I]:E}})}function j(I,$){const J=Math.max(0,Math.round(Number(I)||0)),q=$.reduce((B,P)=>B+(Number(P.value)||0),0);if(!Number.isFinite(q)||q<=0||J<=0){const B={};return $.forEach(P=>{B[P.key]=0}),B}const L=$.map(B=>({key:B.key,exact:J*((Number(B.value)||0)/q)})).map(B=>({key:B.key,floor:Math.floor(B.exact),frac:B.exact-Math.floor(B.exact)}));let ee=L.reduce((B,P)=>B+P.floor,0),E=J-ee;L.sort((B,P)=>P.frac-B.frac);for(let B=0;B<E&&L.length>0;B++){const P=B%L.length;L[P].floor+=1}const T={};return L.forEach(B=>{T[B.key]=B.floor}),T}async function S(){if(!o){l(!0);try{let I=null;try{const pe=localStorage.getItem("tnt.sales.assign.companyTotals");I=pe?JSON.parse(pe):null}catch{}const $=Math.round(Number((I==null?void 0:I.tnt)||0)),J=Math.round(Number((I==null?void 0:I.dys)||0));if(!Number.isFinite($)||!Number.isFinite(J)){alert("회사별 목표 합계를 찾을 수 없습니다. 상단 패널을 확인하세요.");return}const q=e.map(pe=>String(pe.empName||"").trim()).filter(pe=>!!pe);if(!q.length){alert("대상 직원이 없습니다.");return}const K=new URL("/api/v1/sales/employee-yearly",window.location.origin);K.searchParams.set("year",String(d)),K.searchParams.set("empNames",q.join(",")),K.searchParams.set("joinKey","emp_name");const L=await fetch(K.toString()),ee=L.ok?await L.json():[],E=Array.isArray(ee)?ee:Array.isArray(ee==null?void 0:ee.employees)?ee.employees:[],T={};Array.isArray(E)&&E.forEach(pe=>{const H=String(pe.emp_name??pe.empName??"").trim();if(!H)return;const Q=Number(pe.tnt_amount??0),ge=Number(pe.dys_amount??0),je=T[H]||{tnt:0,dys:0};T[H]={tnt:je.tnt+(Number.isFinite(Q)?Q:0),dys:je.dys+(Number.isFinite(ge)?ge:0)}});const B={};e.forEach(pe=>{const H=String(pe.empName||"").trim();B[H]=(B[H]||0)+1});const P=[],_=[];e.forEach(pe=>{const H=String(pe.empName||"").trim(),Q=T[H]||{tnt:0,dys:0},ge=Math.max(1,B[H]||1);P.push({key:pe.key,value:Q.tnt/ge}),_.push({key:pe.key,value:Q.dys/ge})});const U=j($,P),fe=j(J,_);v(pe=>{const H={...pe};return e.forEach(Q=>{H[Q.key]={tnt:U[Q.key]??0,dys:fe[Q.key]??0}}),H});const ae=pe=>Object.values(pe||{}).reduce((H,Q)=>H+(Number(Q)||0),0),F=`TNT 합계 ${y.format(ae(U))} / 목표 ${y.format($)}
DYS 합계 ${y.format(ae(fe))} / 목표 ${y.format(J)}`;ae(U)!==$||ae(fe)!==J?alert(`배정 완료(합계 보정 필요):
`+F):alert(`배정이 완료되었습니다.
`+F)}catch(I){alert((I==null?void 0:I.message)||"배정 중 오류가 발생했습니다.")}finally{l(!1)}}}return n.jsxs("section",{children:[n.jsx(L1,{}),n.jsxs("div",{className:"page-title",style:{alignItems:"center",marginTop:12},children:[n.jsxs("h2",{style:{margin:0,fontSize:18,display:"flex",alignItems:"center",gap:8},children:["목표배정",g?n.jsx("span",{className:"badge",title:"해당 연도 전체 단계",children:g}):null]}),n.jsxs("div",{style:{marginLeft:"auto",display:"inline-flex",alignItems:"center",gap:8},children:[n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>S(),disabled:o,title:"전년도 매출 비율로 자동 배정",children:"할당(매출 기반)"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>R(!1),title:"현재 배정값 저장",children:"저장"}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>R(!0),title:"현재 배정값 확정",children:"확정"})]})]}),i&&n.jsx("div",{className:"error",children:i}),n.jsx("div",{className:"table-container",style:{height:"calc(100vh - 140px)"},children:r?n.jsx("div",{className:"empty-state",children:"불러오는 중…"}):O.length===0?n.jsx("div",{className:"empty-state",children:"데이터가 없습니다"}):n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:140},children:"부서"}),n.jsx("th",{style:{width:140},children:"사번"}),n.jsx("th",{style:{width:180,textAlign:"left"},children:"이름"}),n.jsx("th",{style:{width:140,textAlign:"right"},children:"TNT"}),n.jsx("th",{style:{width:110,textAlign:"right"},children:"TNT 전년대비"}),n.jsx("th",{style:{width:140,textAlign:"right"},children:"DYS"}),n.jsx("th",{style:{width:110,textAlign:"right"},children:"DYS 전년대비"})]})}),n.jsx("tbody",{children:O.map((I,$)=>{var ee,E;const J=x[I.key]||{tnt:0,dys:0},q=String(I.empName||"").trim(),K=Number(((ee=u[q])==null?void 0:ee.tnt)||0),L=Number(((E=u[q])==null?void 0:E.dys)||0);return n.jsxs("tr",{onClick:()=>D(I),"aria-selected":(m==null?void 0:m.key)===I.key?!0:void 0,style:(m==null?void 0:m.key)===I.key?{background:"rgba(59,130,246,.12)"}:void 0,children:[n.jsx("td",{children:I.deptName}),n.jsx("td",{children:I.empId}),n.jsx("td",{style:{textAlign:"left"},children:I.empName}),n.jsx("td",{style:{textAlign:"right"},children:n.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9,]*",value:J.tnt?y.format(J.tnt):"",onChange:T=>W(I.key,"tnt",T.target.value),placeholder:"0",style:{width:"100%",textAlign:"right"},className:"assign-input","aria-label":`TNT 목표(${I.empName})`,title:N?"Moderate 모드에서는 목표 수정이 비활성화됩니다":"TNT 매출목표",disabled:N})}),n.jsx("td",{style:{textAlign:"right"},title:"해당 직원 전년도 TNT 매출 대비 올해 목표 비율",children:n.jsx("span",{className:"muted",children:M(J.tnt,K)})}),n.jsx("td",{style:{textAlign:"right"},children:n.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9,]*",value:J.dys?y.format(J.dys):"",onChange:T=>W(I.key,"dys",T.target.value),placeholder:"0",style:{width:"100%",textAlign:"right"},className:"assign-input","aria-label":`DYS 목표(${I.empName})`,title:N?"Moderate 모드에서는 목표 수정이 비활성화됩니다":"DYS 매출목표",disabled:N})}),n.jsx("td",{style:{textAlign:"right"},title:"해당 직원 전년도 DYS 매출 대비 올해 목표 비율",children:n.jsx("span",{className:"muted",children:M(J.dys,L)})})]},$)})})]})})]});async function R(I){try{const $=I?"확정":"기안중",q=(localStorage.getItem("tnt.sales.assign.mode")||"").toLowerCase()==="moderate"?2:1,K=[],L=`${d}-01-01`;e.forEach(B=>{const P=x[B.key]||{tnt:0,dys:0};K.push({targetYear:L,empName:B.empName,companyName:"TNT",targetAmount:Math.round(P.tnt||0),targetStage:$,versionNo:q}),K.push({targetYear:L,empName:B.empName,companyName:"DYS",targetAmount:Math.round(P.dys||0),targetStage:$,versionNo:q})});const ee=localStorage.getItem("tnt.sales.empSeq")||"",E={"Content-Type":"application/json"};ee&&(E["X-EMP-SEQ"]=String(ee));const T=await fetch("/api/v1/targets/assigned/upsert",{method:"POST",headers:E,body:JSON.stringify(K)});if(!T.ok)throw new Error(`HTTP ${T.status}`);I&&await fetch(`/api/v1/targets/assigned/confirm?year=${d}`,{method:"POST",headers:E}),alert(I?"배정이 확정되었습니다.":"배정이 저장되었습니다.")}catch($){alert(($==null?void 0:$.message)||"배정 저장 중 오류가 발생했습니다.")}}}function W1(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState("TNT"),[d,f]=c.useState("mine");function u(){const E=new Date,T=String(E.getFullYear()%100).padStart(2,"0"),B=String(E.getMonth()+1).padStart(2,"0"),P=String(E.getDate()).padStart(2,"0");return`${T}-${B}-${P}`}const[h,m]=c.useState(u()),[p,x]=c.useState(u()),[v,g]=c.useState(null),[b,y]=c.useState(null),A=c.useRef(null),[C,N]=c.useState(null),[w,M]=c.useState(null),[O,D]=c.useState(null),[W,j]=c.useState("");async function S(E){try{const T=typeof window<"u"&&localStorage.getItem("tnt.sales.assigneeId")||"",B=typeof window<"u"&&localStorage.getItem("tnt.sales.empId")||"",P=new URLSearchParams;T&&P.set("assigneeId",T),B&&P.set("empId",B),P.set("companyCode",E);const _=await fetch(`/api/v1/employee/by-assignee?${P.toString()}`,{cache:"no-store"});if(!_.ok)return"";const U=await _.json().catch(()=>null),fe=(U==null?void 0:U.resolvedSalesEmpSeq)??(E==="DYS"?U==null?void 0:U.dys_emp_seq:U==null?void 0:U.tnt_emp_seq);return fe!=null&&String(fe)?String(fe):""}catch{return""}}function R(E){if(!E)return"";let T=String(E).trim();const B=T.replace(/[^0-9]/g,"");if(B.length===6){const U=B.slice(0,2),fe=B.slice(2,4),ae=B.slice(4,6);return I(U,fe,ae)?`${U}-${fe}-${ae}`:null}if(B.length===8){const U=B.slice(2,4),fe=B.slice(4,6),ae=B.slice(6,8);return I(U,fe,ae)?`${U}-${fe}-${ae}`:null}const P=T.match(/^\s*(\d{2})[-/](\d{2})[-/](\d{2})\s*$/);if(P){const[,U,fe,ae]=P;return I(U,fe,ae)?`${U}-${fe}-${ae}`:null}const _=T.match(/^\s*(\d{4})[-/](\d{2})[-/](\d{2})\s*$/);if(_){const[,U,fe,ae]=_,F=U.slice(2);return I(F,fe,ae)?`${F}-${fe}-${ae}`:null}return null}function I(E,T,B){const P=Number(E),_=Number(T),U=Number(B);return!(!Number.isInteger(P)||!Number.isInteger(_)||!Number.isInteger(U)||_<1||_>12||U<1||U>31||U>[31,28,31,30,31,30,31,31,30,31,30,31][_-1])}function $(E){const T=E.match(/^(\d{2})-(\d{2})-(\d{2})$/);return T?`20${T[1]}-${T[2]}-${T[3]}`:null}function J(E){try{let T=String(E??"");return T=T.replace(/\r\n/g,`
`).replace(/\r/g,`
`).replace(/\\n/g,`
`),T}catch{return String(E??"")}}function q(E){const T=String(E??"").trim();if(!T)return"";const B=T.replace(/[^0-9]/g,"");return B.length===8?`${B.slice(0,4)}-${B.slice(4,6)}-${B.slice(6,8)}`:B.length===6?`20${B.slice(0,2)}-${B.slice(2,4)}-${B.slice(4,6)}`:T}async function K(E=!1){const T=h.trim(),B=p.trim();let P=T?R(T):"",_=B?R(B):"";if(M(null),D(null),T&&!P){M("형식: YY-MM-DD");return}if(B&&!_){D("형식: YY-MM-DD");return}if(typeof P=="string"&&m(P),typeof _=="string"&&x(_),P&&_){const U=$(P),fe=$(_);if(U>fe){D("종료일이 시작일보다 빠릅니다");return}}a(!0),s(null);try{const U=new URL("/api/v1/orders/external/tsl-order-text",window.location.origin);if(U.searchParams.set("company",o),P&&U.searchParams.set("fromDate",P),_&&U.searchParams.set("toDate",_),d==="mine"){const H=await S(o);H&&U.searchParams.set("salesEmpSeq",H)}const fe=await fetch(U.toString(),{cache:"no-store"});if(!fe.ok)throw new Error(`HTTP ${fe.status}`);const ae=await fe.json().catch(()=>[]);let F=Array.isArray(ae)?ae:[];const pe=W.trim();if(pe){const H=pe.split(/\s+/).map(Q=>Q.toLowerCase());F=F.filter(Q=>{const ge=(()=>{const je=Object.entries(Q);let Ne=null;for(const[Y,ve]of je){const se=String(Y).toLowerCase();if(se==="custseq"||se==="custname"||se==="customername"||se==="customer_name"){Ne=ve;break}}return String(Ne??"")})().toLowerCase();return H.every(je=>ge.includes(je))})}t(F)}catch(U){s((U==null?void 0:U.message)||"조회 실패"),t([])}finally{a(!1)}}c.useEffect(()=>{if(!(b!=null&&b.open))return;const E=B=>{const P=A.current;P&&B.target instanceof Node&&!P.contains(B.target)&&y(null)},T=B=>{B.key==="Escape"&&y(null)};return document.addEventListener("mousedown",E,!0),window.addEventListener("keydown",T,!0),()=>{document.removeEventListener("mousedown",E,!0),window.removeEventListener("keydown",T,!0)}},[b==null?void 0:b.open]);const L=c.useMemo(()=>{if(!e.length)return[];const E=e[0];return Object.keys(E)},[e]);function ee(E){const T=(E||"").toString();return/^OrderTextNo$/i.test(T)?"수주장번호":/^OrderTextDate$/i.test(T)||/^OrderTextDat$/i.test(T)?"주문일자":/^CustSeq$/i.test(T)||/^CustName$/i.test(T)||/^CustomerName$/i.test(T)?"거래처명":/^RegionGroup$/i.test(T)||/^region_group$/i.test(T)?"지역그룹":/^SalesEmpSeq$/i.test(T)?"영업":/^OrderText$/i.test(T)?"수주내역":/^IsCancel$/i.test(T)?"중단여부":/^CancelText$/i.test(T)?"중단사유":/^Remark$/i.test(T)?"비고":/^LastDateTime$/i.test(T)?"최종수정일시":/^WHSeq$/i.test(T)?"창고번호":/^DelvDate$/i.test(T)?"납기예정일":/^CustEmpName$/i.test(T)?"거래처담당":/^IsClaim$/i.test(T)?"Claim":/^OrderRemark$/i.test(T)?"주문요청사항":/^Request(Date|Dt)$/i.test(T)||/^ReqDate$/i.test(T)?"요청일자":T}return n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:18},children:"수주장 조회"}),n.jsxs("div",{style:{marginLeft:"auto",display:"flex",flexDirection:"column",alignItems:"flex-end",gap:8},children:[n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:12,fontSize:12},children:[n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:4},children:[n.jsx("input",{type:"radio",name:"company",checked:o==="TNT",onChange:()=>l("TNT")})," TNT"]}),n.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:4},children:[n.jsx("input",{type:"radio",name:"company",checked:o==="DYS",onChange:()=>l("DYS")})," DYS"]}),n.jsxs("select",{className:"search-input",value:d,onChange:E=>f(E.target.value||"all"),title:"조회 범위",style:{minWidth:110},children:[n.jsx("option",{value:"mine",children:"내수주"}),n.jsx("option",{value:"all",children:"전체"})]}),n.jsx("div",{style:{width:8}}),n.jsx("label",{className:"muted",children:"수주일"}),n.jsx("input",{className:"search-input",placeholder:"YY-MM-DD",value:h,onChange:E=>{m(E.target.value),w&&M(null)},onBlur:E=>{const T=R(E.target.value);T===null&&E.target.value.trim()?M("형식: YY-MM-DD"):typeof T=="string"&&m(T)},style:{width:90}}),w?n.jsx("div",{className:"error",style:{fontSize:11},children:w}):null,n.jsx("span",{className:"muted",children:"~"}),n.jsx("input",{className:"search-input",placeholder:"YY-MM-DD",value:p,onChange:E=>{x(E.target.value),O&&D(null)},onBlur:E=>{const T=R(E.target.value);T===null&&E.target.value.trim()?D("형식: YY-MM-DD"):typeof T=="string"&&x(T)},style:{width:90}}),O?n.jsx("div",{className:"error",style:{fontSize:11},children:O}):null,n.jsx("button",{className:"btn btn-card btn-3d",onClick:()=>K(!0),disabled:!!w||!!O||r,children:"조회"})]}),n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:6,alignSelf:"stretch",fontSize:12},children:[n.jsx("label",{className:"muted",children:"거래처명"}),n.jsx("input",{className:"search-input",placeholder:"검색어(공백으로 AND)",value:W,onChange:E=>j(E.target.value),style:{width:320}})]})]})]}),i?n.jsx("div",{className:"error",children:i}):null,n.jsx("div",{className:"table-container",style:{height:"calc(100vh - 160px)"},children:r?n.jsx("div",{className:"empty-state",children:"불러오는 중…"}):e.length===0?n.jsx("div",{className:"empty-state",children:"데이터가 없습니다"}):n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsx("tr",{children:L.map(E=>n.jsx("th",{children:ee(E)},E))})}),n.jsx("tbody",{children:e.map((E,T)=>n.jsx("tr",{onMouseEnter:B=>{const P=(B.clientX||0)+12,_=(B.clientY||0)+12;b!=null&&b.open||g({open:!0,x:P,y:_,rec:E})},onMouseMove:B=>{if(!(v!=null&&v.open))return;const P=(B.clientX||0)+12,_=(B.clientY||0)+12;b!=null&&b.open||g({open:!0,x:P,y:_,rec:E})},onMouseLeave:()=>g(null),onContextMenu:B=>{B.preventDefault();const P=B.clientX,_=B.clientY;y({open:!0,x:P,y:_,rec:E})},children:L.map(B=>n.jsx("td",{children:String((E==null?void 0:E[B])??"")},B))},T))})]})}),v!=null&&v.open&&!(b!=null&&b.open)?n.jsx("div",{role:"dialog","aria-live":"polite",style:{position:"fixed",left:Math.min(Math.max(8,v.x),window.innerWidth-460),top:Math.min(Math.max(8,v.y),window.innerHeight-300),zIndex:80,pointerEvents:"none"},children:n.jsx("div",{className:"card",style:{background:"var(--panel)",padding:12,border:"1px solid var(--border)",borderRadius:8,minWidth:320,maxWidth:600,maxHeight:"85vh",overflow:"auto",boxShadow:"0 8px 24px rgba(0,0,0,.18)"},children:n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:6},children:L.map(E=>{const T=(v.rec||{})[E],B=J(T);return n.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:10,paddingBottom:6,borderBottom:"1px solid var(--border-light)"},children:[n.jsx("div",{style:{minWidth:120,fontWeight:600,fontSize:12,color:"var(--text-secondary)"},children:ee(E)}),n.jsx("div",{style:{flex:1,whiteSpace:"pre-wrap",fontSize:12,wordBreak:"break-word"},children:B||n.jsx("span",{style:{color:"var(--text-muted)",fontStyle:"italic"},children:"-"})})]},E)})})})}):null,b!=null&&b.open?(()=>{const E=Math.min(Math.max(8,b.x),window.innerWidth-220),T=Math.min(Math.max(8,b.y),window.innerHeight-120);async function B(){try{const _=L.find(se=>/^OrderText$/i.test(se))||L.find(se=>ee(se)==="수주내역"),U=L.find(se=>/^OrderRemark$/i.test(se))||L.find(se=>ee(se)==="주문요청사항"),fe=L.find(se=>ee(se)==="거래처명")||L.find(se=>/^(CustName|CustomerName|customer_name|CustSeq)$/i.test(se)),ae=L.find(se=>/^(UserName|CreatedBy|created_by)$/i.test(se)),F=L.find(se=>/^(RegionGroup|region_group)$/i.test(se)),pe=o,H=fe?String((b.rec||{})[fe]??""):"";let Q=ae?String((b.rec||{})[ae]??""):"",ge=F?String((b.rec||{})[F]??""):"",je=_?J((b.rec||{})[_]):"";const Ne=U?J((b.rec||{})[U]):"";if(!Q){const se=L.find(Le=>ee(Le)==="영업");se&&(Q=String((b.rec||{})[se]??""))}if(je){const se=String(je).split(/\n/),Le=[];for(const Fe of se){const Ie=Fe.match(/^\s*지역\s*그룹\s*[:：]\s*(.*)\s*$/)||Fe.match(/^\s*지역그룹\s*[:：]\s*(.*)\s*$/);if(Ie){const Ve=(Ie[1]||"").trim();!ge&&Ve&&(ge=Ve)}else Le.push(Fe)}je=Le.join(`
`)}let Y=[];Y.push(`회사코드: ${pe}`),Y.push(`거래처: ${H}`),Y.push(`등록자: ${Q}`),Y.push(`지역 그룹: ${ge}`),Y.push("주문내용:"),Y.push(je),Y.push("요청사항:"),Y.push(Ne);let ve=Y.join(`
`);if(!je&&!Ne&&(ve=JSON.stringify(b.rec??{},null,2)),navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(ve);else{const se=document.createElement("textarea");se.value=ve,se.style.position="fixed",se.style.left="-9999px",document.body.appendChild(se),se.focus(),se.select(),document.execCommand("copy"),document.body.removeChild(se)}N({open:!0,x:E+8,y:T+8}),setTimeout(()=>N(null),1200)}catch{}y(null)}async function P(){try{const _=L.find(Ie=>/^OrderText$/i.test(Ie))||L.find(Ie=>ee(Ie)==="수주내역"),U=L.find(Ie=>/^OrderRemark$/i.test(Ie))||L.find(Ie=>ee(Ie)==="주문요청사항"),fe=L.find(Ie=>ee(Ie)==="거래처명")||L.find(Ie=>/^(CustName|CustomerName|customer_name|CustSeq)$/i.test(Ie)),ae=L.find(Ie=>ee(Ie)==="수주장번호")||L.find(Ie=>/^OrderTextNo$/i.test(Ie)),F=[L.find(Ie=>ee(Ie)==="요청일자"),L.find(Ie=>/^Request(Date|Dt)$/i.test(Ie)),L.find(Ie=>/^DelvDate$/i.test(Ie)),L.find(Ie=>/^OrderTextDate$/i.test(Ie))].filter(Boolean);let pe="";const H=L.find(Ie=>/^(UserName|CreatedBy|created_by)$/i.test(Ie));if(H&&(pe=String((b.rec||{})[H]??"")),!pe){const Ie=L.find(Ve=>ee(Ve)==="영업");Ie&&(pe=String((b.rec||{})[Ie]??""))}let Q="";const ge=L.find(Ie=>/^(RegionGroup|region_group)$/i.test(Ie));ge&&(Q=String((b.rec||{})[ge]??""));let je=_?J((b.rec||{})[_]):"";const Ne=U?J((b.rec||{})[U]):"";if(je){const Ie=String(je).split(/\n/),Ve=[];for(const yt of Ie){const It=yt.match(/^\s*지역\s*그룹\s*[:：]\s*(.*)\s*$/)||yt.match(/^\s*지역그룹\s*[:：]\s*(.*)\s*$/);if(It){const nn=(It[1]||"").trim();!Q&&nn&&(Q=nn)}else Ve.push(yt)}je=Ve.join(`
`)}const Y=ae?String((b.rec||{})[ae]??"").trim():"";let ve="";for(const Ie of F){const Ve=Ie?String((b.rec||{})[Ie]??"").trim():"";if(Ve){ve=q(Ve);break}}const se={orderNo:Y,companyCode:o,customerName:fe?String((b.rec||{})[fe]??""):"",createdBy:pe,regionGroup:Q,orderText:je,orderRemark:Ne,requestDate:ve},Le=await fetch("/api/v1/slack/send-order-copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(se)}),Fe=await Le.json().catch(()=>({}));Le.ok&&Fe.success?(N({open:!0,x:E+8,y:T+8,message:"Slack 전송 완료"}),setTimeout(()=>N(null),1500)):alert(Fe.message||`Slack 전송 실패 (HTTP ${Le.status})`)}catch(_){console.error("Slack 전송 실패:",_),alert("Slack 전송 중 오류가 발생했습니다.")}y(null)}return n.jsx("div",{ref:A,role:"menu",style:{position:"fixed",left:E,top:T,zIndex:90,minWidth:180},children:n.jsxs("div",{className:"card",style:{background:"var(--panel)",padding:4,border:"1px solid var(--border)",borderRadius:8,boxShadow:"0 8px 24px rgba(0,0,0,.18)",display:"flex",flexDirection:"column",gap:2,fontSize:13},children:[n.jsx("button",{className:"btn-plain",style:{width:"100%",textAlign:"left",padding:"4px 6px",fontSize:13},onClick:P,children:"Slack전송"}),n.jsx("button",{className:"btn-plain",style:{width:"100%",textAlign:"left",padding:"4px 6px",fontSize:13},onClick:B,children:"복사"})]})})})():null,C!=null&&C.open?n.jsx("div",{style:{position:"fixed",left:C.x,top:C.y,zIndex:95},children:n.jsx("div",{className:"card",style:{background:"var(--panel)",padding:"2px 6px",border:"1px solid var(--border)",borderRadius:6,fontSize:11},children:C.message||"복사했습니다"})}):null]})}const B1=["매출","가격","재고","경쟁사","Complaint","품질관리","공급사"];function F1(){const[e,t]=c.useState(""),[r,a]=c.useState([]),[i,s]=c.useState(!1),[o,l]=c.useState(null),[d,f]=c.useState("매출"),u=new Intl.NumberFormat("ko-KR");async function h(){s(!0),l(null);try{const m=new URL("/api/v1/items/search",window.location.origin);m.searchParams.set("q",e||""),m.searchParams.set("limit","100");const p=await fetch(m.toString());if(!p.ok)throw new Error(`HTTP ${p.status}`);const x=await p.json(),v=Array.isArray(x)?x.map(g=>({itemSeq:Number(g.itemSeq??g.item_seq??0),itemName:String(g.itemName??g.item_name??""),recentInvoiceDate:String(g.recentInvoiceDate??g.recent_invoice_date??""),curAmt:Number(g.curAmt??g.cur_amt??0),qty:Number(g.qty??0)})):[];a(v)}catch(m){l((m==null?void 0:m.message)||"조회 오류"),a([])}finally{s(!1)}}return c.useEffect(()=>{h()},[]),n.jsxs("section",{children:[n.jsxs("div",{className:"page-title",style:{alignItems:"center"},children:[n.jsx("h2",{style:{margin:0,fontSize:18},children:"Item360"}),n.jsxs("div",{className:"controls",style:{gap:8},children:[n.jsx("input",{className:"search-input",value:e,onChange:m=>t(m.target.value),placeholder:"품목명 검색",onKeyDown:m=>{m.key==="Enter"&&h()}}),n.jsx("button",{className:"btn btn-card btn-3d",onClick:h,disabled:i,children:"검색"})]})]}),o&&n.jsx("div",{className:"error",children:o}),n.jsx("div",{className:"table-container",style:{height:300},children:i?n.jsx("div",{className:"empty-state",children:"불러오는 중…"}):r.length===0?n.jsx("div",{className:"empty-state",children:"데이터가 없습니다"}):n.jsxs("table",{className:"table",style:{width:"100%"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:120},children:"품목코드"}),n.jsx("th",{style:{textAlign:"left"},children:"품목명"}),n.jsx("th",{style:{width:140},children:"최근 매출일"}),n.jsx("th",{style:{width:140,textAlign:"right"},children:"매출금액"}),n.jsx("th",{style:{width:120,textAlign:"right"},children:"수량"})]})}),n.jsx("tbody",{children:r.map((m,p)=>n.jsxs("tr",{children:[n.jsx("td",{children:m.itemSeq||""}),n.jsx("td",{style:{textAlign:"left"},children:m.itemName||""}),n.jsx("td",{children:m.recentInvoiceDate||""}),n.jsxs("td",{style:{textAlign:"right"},children:[u.format(Math.round(Number(m.curAmt||0)))," 원"]}),n.jsx("td",{style:{textAlign:"right"},children:u.format(Math.round(Number(m.qty||0)))})]},p))})]})}),n.jsxs("div",{style:{marginTop:12},children:[n.jsx("div",{style:{display:"flex",gap:6,borderBottom:"1px solid var(--border)"},children:B1.map(m=>n.jsx("button",{className:"btn btn-card",style:{borderBottom:d===m?"2px solid var(--accent)":"2px solid transparent"},onClick:()=>f(m),children:m},m))}),n.jsx("div",{style:{padding:12},children:n.jsxs("div",{className:"empty-state",children:[d," 탭은 준비중입니다."]})})]})]})}const q1=["영업1본부","영업1팀","영업2본부","영업2팀"];function U1(){const[e,t]=c.useState(()=>{try{const T=localStorage.getItem("tnt.sales.assign.year");return T?Number(T):new Date().getFullYear()}catch{return new Date().getFullYear()}}),[r,a]=c.useState([]),[i,s]=c.useState(!1),[o,l]=c.useState(null),[d,f]=c.useState([]),[u,h]=c.useState(!1),m=c.useRef(null),[p,x]=c.useState([]),[v,g]=c.useState(!1),[b,y]=c.useState(null),[A,C]=c.useState({tnt:0,dys:0}),[N,w]=c.useState([]),[M,O]=c.useState(!1),[D,W]=c.useState(null),j=c.useMemo(()=>{try{let T=0,B=0;for(const P of p){const _=String((P==null?void 0:P.company_name)??(P==null?void 0:P.companyName)??"").toUpperCase(),U=Number((P==null?void 0:P.target_amount_max)??0);Number.isFinite(U)&&(_==="TNT"?T+=U:_==="DYS"&&(B+=U))}return{tnt:T,dys:B}}catch{return{tnt:0,dys:0}}},[p]),S=c.useMemo(()=>({tnt:A.tnt/1e8,dys:A.dys/1e8}),[A]),R=c.useMemo(()=>({tnt:j.tnt-S.tnt,dys:j.dys-S.dys}),[j,S]),I=c.useMemo(()=>{try{const T=fe=>p.reduce((ae,F)=>{const pe=String((F==null?void 0:F.biz_area_name)??(F==null?void 0:F.bizAreaName)??""),H=Number((F==null?void 0:F.target_amount_max)??0);return ae+(pe===fe&&Number.isFinite(H)?H:0)},0),B=T("복층유리"),P=T("건자재"),_=T("실란트");return(Number.isFinite(B)?B:0)+(Number.isFinite(P)?P:0)+(Number.isFinite(_)?_:0)}catch{return 0}},[p]),$=c.useMemo(()=>{const T=[];for(let B=2030;B>=2026;B--)T.push(B);return T},[]);async function J(T){s(!0),l(null);try{const B=new URL("/api/v1/targets/assigned",window.location.origin);B.searchParams.set("year",String(T));const P=await fetch(B.toString()),_=P.ok?await P.json():[],U=Array.isArray(_)?_:[];if(U.length>0){const H=U.reduce((Q,ge)=>{const je=String(ge.emp_id??ge.empId??"").trim(),Ne=String(ge.emp_name??ge.empName??"").trim(),Y=String(ge.dept_name??ge.deptName??""),ve=je||(Ne?`name:${Ne}`:"");return ve&&(Q.some(se=>se.key===ve)||Q.push({key:ve,empId:je,empName:Ne,deptName:Y})),Q},[]);H.sort((Q,ge)=>(Q.deptName||"").localeCompare(ge.deptName||"")||(Q.empName||"").localeCompare(ge.empName||"")),a(H),s(!1);return}const fe=new URL("/api/v1/employees",window.location.origin);fe.searchParams.set("depts",q1.join(","));const ae=await fetch(fe.toString());if(!ae.ok)throw new Error(`HTTP ${ae.status}`);const F=await ae.json(),pe=Array.isArray(F)?F.map(H=>{const Q=String(H.empId??H.emp_id??"").trim(),ge=String(H.empName??H.emp_name??"").trim(),je=String(H.deptName??H.dept_name??""),Ne=String(H.assignee_id??H.assigneeId??"").trim()||void 0;return{key:Q||Ne||(ge?`name:${ge}`:""),empId:Q,empName:ge,deptName:je,assigneeId:Ne}}).filter(H=>!!H.key):[];pe.sort((H,Q)=>(H.deptName||"").localeCompare(Q.deptName||"")||(H.empName||"").localeCompare(Q.empName||"")),a(pe)}catch(B){l((B==null?void 0:B.message)||"조회 중 오류"),a([])}finally{s(!1)}}c.useEffect(()=>{J(e)},[e]),c.useEffect(()=>{async function T(){g(!0),y(null);try{const B=new URL("/api/v1/targets/year",window.location.origin);B.searchParams.set("year",String(e));const P=await fetch(B.toString());if(!P.ok)throw new Error(`HTTP ${P.status}`);const _=await P.json();x(Array.isArray(_)?_:[])}catch(B){x([]),y((B==null?void 0:B.message)||"조회 오류")}finally{g(!1)}}T()},[e]),c.useEffect(()=>{async function T(){const B=d.length?r.filter(U=>d.includes(U.key)):r,P=B.map(U=>String(U.empId||"").trim()).filter(Boolean),_=B.map(U=>String(U.assigneeId||"").trim()).filter(Boolean);if(!e||P.length===0&&_.length===0){w([]),W(null);return}O(!0),W(null);try{const U=new URL("/api/v1/sales/plan/customer-counts",window.location.origin);U.searchParams.set("year",String(e)),P.length>0&&U.searchParams.set("empIds",P.join(",")),_.length>0&&U.searchParams.set("assigneeIds",_.join(","));const fe=await fetch(U.toString());if(!fe.ok)throw new Error(`HTTP ${fe.status}`);const ae=await fe.json();w(Array.isArray(ae)?ae:[])}catch(U){w([]),W((U==null?void 0:U.message)||"고객수 요약 조회 오류")}finally{O(!1)}}T()},[e,d,r]),c.useEffect(()=>{async function T(){try{const B=new URL("/api/v1/sales/plan/totals",window.location.origin);B.searchParams.set("year",String(e));const P=await fetch(B.toString());if(!P.ok)throw new Error(`HTTP ${P.status}`);const _=await P.json().catch(()=>[]);let U=0,fe=0;Array.isArray(_)&&_.forEach(ae=>{const F=String((ae==null?void 0:ae.company)||(ae==null?void 0:ae.company_type)||(ae==null?void 0:ae.companyName)||"").toUpperCase(),pe=Number((ae==null?void 0:ae.total)||(ae==null?void 0:ae.total_amount)||0);F==="TNT"?U+=Number.isFinite(pe)?pe:0:F==="DYS"&&(fe+=Number.isFinite(pe)?pe:0)}),C({tnt:U,dys:fe})}catch{C({tnt:0,dys:0})}}T()},[e]);function q(T){const B=Number(T.target.value);if(!(!Number.isFinite(B)||B<=0)){t(B);try{localStorage.setItem("tnt.sales.assign.year",String(B))}catch{}}}function K(T){f(T);const B=r.filter(_=>T.includes(_.key));try{localStorage.setItem("tnt.sales.selectedEmployees",JSON.stringify(B))}catch{}const P=B[0]||null;try{P?localStorage.setItem("tnt.sales.selectedEmployee",JSON.stringify(P)):localStorage.removeItem("tnt.sales.selectedEmployee")}catch{}try{window.dispatchEvent(new CustomEvent("tnt.sales.employees.selected",{detail:{items:B}}))}catch{}try{P&&window.dispatchEvent(new CustomEvent("tnt.sales.employee.selected"))}catch{}}function L(T){K(T?r.map(B=>B.key):[])}function ee(T,B){const P=new Set(d);B?P.add(T):P.delete(T),K(Array.from(P))}c.useEffect(()=>{if(!u)return;const T=P=>{m.current&&(m.current.contains(P.target)||h(!1))},B=P=>{P.key==="Escape"&&h(!1)};return window.addEventListener("click",T,!0),window.addEventListener("keydown",B,!0),()=>{window.removeEventListener("click",T,!0),window.removeEventListener("keydown",B,!0)}},[u]);const E=c.useMemo(()=>{if(!d.length)return"전체";const T=r.filter(B=>d.includes(B.key)).map(B=>B.empName||B.empId||B.key);return T.length<=2?T.join(", "):`${T.slice(0,2).join(", ")} 외 ${T.length-2}명`},[d,r]);return n.jsxs("section",{children:[n.jsxs("div",{className:"card",style:{padding:8,marginBottom:12,display:"flex",alignItems:"center",gap:16,flexWrap:"wrap"},children:[n.jsxs("div",{style:{display:"inline-flex",alignItems:"center",gap:8},children:[n.jsx("div",{className:"muted",children:"목표년도"}),n.jsx("select",{className:"search-input",value:e,onChange:q,"aria-label":"목표년도",style:{height:28},children:$.map(T=>n.jsxs("option",{value:String(T),children:[T,"년"]},T))})]}),n.jsxs("div",{ref:m,style:{position:"relative",display:"inline-flex",alignItems:"center",gap:8},children:[n.jsx("div",{className:"muted",children:"영업사원"}),n.jsxs("button",{type:"button",className:"search-input","aria-haspopup":"listbox","aria-expanded":u,onClick:()=>h(T=>!T),style:{height:28,minWidth:260,display:"inline-flex",alignItems:"center",justifyContent:"space-between",gap:8},children:[n.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:E}),n.jsx("span",{"aria-hidden":!0,children:"▾"})]}),u&&n.jsxs("div",{role:"listbox",className:"card",style:{position:"absolute",zIndex:60,top:"100%",left:0,width:380,maxHeight:260,overflow:"auto",background:"var(--panel)",border:"1px solid var(--border)",borderRadius:8,padding:8,marginTop:6,fontSize:11},children:[n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 6px"},children:[n.jsx("input",{type:"checkbox",checked:d.length===r.length&&r.length>0,onChange:T=>L(T.target.checked)}),n.jsx("span",{children:"전체"})]}),i?n.jsx("div",{className:"muted",style:{padding:"6px 6px"},children:"불러오는 중…"}):r.length===0?n.jsx("div",{className:"muted",style:{padding:"6px 6px"},children:"목록이 없습니다"}):r.map(T=>{const B=d.includes(T.key),P=`${T.deptName||"-"} / ${T.empName||""}${T.empId?` (${T.empId})`:""}`;return n.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,padding:"4px 6px",cursor:"pointer"},children:[n.jsx("input",{type:"checkbox",checked:B,onChange:_=>ee(T.key,_.target.checked)}),n.jsx("span",{children:P})]},T.key)}),o?n.jsx("div",{className:"error",style:{padding:"6px 6px"},children:o}):null]})]})]}),n.jsxs("div",{className:"card",style:{padding:8},children:[b?n.jsx("div",{className:"error",style:{marginBottom:8},children:b}):null,v?n.jsx("div",{className:"muted",style:{padding:"8px 6px"},children:"불러오는 중…"}):n.jsxs("div",{style:{display:"flex",alignItems:"stretch",gap:12},children:[n.jsxs("div",{style:{flex:"1 1 auto",display:"flex",flexDirection:"column",gap:6},children:[n.jsxs("div",{style:{display:"flex",alignItems:"baseline",justifyContent:"space-between",margin:"0 2px"},children:[n.jsx("div",{className:"muted",style:{fontWeight:800},children:"회사 목표"}),n.jsx("div",{style:{fontWeight:800},children:Number.isFinite(I)?`${Number(I).toLocaleString(void 0,{maximumFractionDigits:1})} 억원`:"-"})]}),(()=>{let T=0,B=0,P,_=0,U;p.forEach(F=>{const pe=String((F==null?void 0:F.company_name)??(F==null?void 0:F.companyName)??"").toUpperCase(),H=String((F==null?void 0:F.biz_area_name)??(F==null?void 0:F.bizAreaName)??""),Q=Number((F==null?void 0:F.target_amount_max)??0),ge=String((F==null?void 0:F.target_stage)??(F==null?void 0:F.targetStage)??"")||void 0;pe==="TNT"?(H==="복층유리"&&Number.isFinite(Q)?T+=Q:H==="건자재"&&Number.isFinite(Q)&&(B+=Q),ge&&(P=ge)):pe==="DYS"&&H==="실란트"&&(Number.isFinite(Q)&&(_+=Q),ge&&(U=ge))});const fe=[{company:"TNT",biz:"복층유리+건자재",max:T+B,stage:P},{company:"DYS",biz:"실란트",max:_,stage:U}];return n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, minmax(0, 1fr))",gap:8},children:fe.map((F,pe)=>{const H=F.company,Q=F.biz,ge=F.max,je=F.stage||"";return n.jsx("div",{className:"card",style:{padding:8,border:"1px solid var(--border)",borderRadius:10,display:"flex",alignItems:"center",minHeight:92,position:"relative"},children:n.jsxs("div",{style:{flex:1},children:[je?n.jsx("div",{style:{position:"absolute",top:6,left:6},children:n.jsx("span",{className:"badge",style:{fontSize:8,padding:"0 4px",lineHeight:1.1,border:"1px solid var(--border)",borderRadius:6},children:je})}):null,H==="TNT"&&Q==="복층유리+건자재"?(()=>{try{let Ne=0,Y=0;for(const se of p){const Le=String((se==null?void 0:se.company_name)??(se==null?void 0:se.companyName)??"").toUpperCase(),Fe=String((se==null?void 0:se.biz_area_name)??(se==null?void 0:se.bizAreaName)??""),Ie=Number((se==null?void 0:se.target_amount_max)??0);Le==="TNT"&&Number.isFinite(Ie)&&(Fe==="복층유리"?Ne+=Ie:Fe==="건자재"&&(Y+=Ie))}const ve=Number.isFinite(ge)?Number(ge):Ne+Y;return n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,textAlign:"center"},children:[n.jsxs("div",{style:{fontWeight:800,fontSize:18,lineHeight:1.1},children:["TNT ",ve.toLocaleString(void 0,{maximumFractionDigits:1}),"억원"]}),n.jsxs("div",{className:"muted",style:{fontSize:10,lineHeight:1.1},children:["(",`복층${Ne.toLocaleString(void 0,{maximumFractionDigits:1})}억원+건자재${Y.toLocaleString(void 0,{maximumFractionDigits:1})}억원`,")"]})]})}catch{return n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,textAlign:"center"},children:[n.jsx("div",{style:{fontWeight:700,fontSize:11},children:"TNT"}),n.jsx("div",{className:"muted",style:{fontSize:11,lineHeight:1.1},children:"데이터 없음"})]})}})():n.jsx("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4,textAlign:"center"},children:String(H||"").toUpperCase()==="DYS"&&Q==="실란트"?n.jsx(n.Fragment,{children:n.jsxs("div",{style:{fontWeight:800,fontSize:18,lineHeight:1.1},children:["DYS ",Number(ge).toLocaleString(void 0,{maximumFractionDigits:1}),"억원"]})}):n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{fontWeight:700,fontSize:11},children:Q||"-"}),n.jsx("div",{style:{fontSize:11,fontWeight:800,lineHeight:1.1},children:Number.isFinite(ge)?`${Number(ge).toLocaleString(void 0,{maximumFractionDigits:1})} 억원`:"-"})]})})]})},pe)})})})()]}),n.jsx("div",{style:{flex:"0 0 auto",width:1,background:"var(--border)"}}),n.jsxs("aside",{style:{flex:"0 0 260px",maxWidth:320,paddingLeft:8,display:"flex",flexDirection:"column",justifyContent:"center"},children:[n.jsx("div",{style:{fontWeight:800,marginBottom:8},children:"목표수립 현황"}),n.jsx("div",{className:"card",style:{padding:10,border:"1px solid var(--border)",borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",minHeight:92},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,width:"100%"},children:[n.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:n.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`TNT ${S.tnt.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})}),n.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:n.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`DYS ${S.dys.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})})]})})]}),n.jsx("div",{style:{flex:"0 0 auto",width:1,background:"var(--border)"}}),n.jsxs("aside",{style:{flex:"0 0 260px",maxWidth:320,paddingLeft:8,display:"flex",flexDirection:"column",justifyContent:"center"},children:[n.jsx("div",{style:{fontWeight:800,marginBottom:8},children:"차액"}),n.jsx("div",{className:"card",style:{padding:10,border:"1px solid var(--border)",borderRadius:10,display:"flex",alignItems:"center",justifyContent:"center",minHeight:92},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:10,width:"100%"},children:[n.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:n.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`TNT ${R.tnt.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})}),n.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:n.jsx("strong",{style:{fontSize:18,lineHeight:1.1},children:`DYS ${R.dys.toLocaleString(void 0,{maximumFractionDigits:1})} 억원`})})]})})]})]})]}),n.jsxs("div",{className:"card",style:{padding:8,marginTop:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[n.jsx("div",{style:{fontWeight:800},children:"고객수 요약"}),M?n.jsx("div",{className:"muted",style:{fontSize:12},children:"불러오는 중…"}):null]}),D?n.jsx("div",{className:"error",style:{marginBottom:8},children:D}):null,(()=>{const T=d.length?r.filter(P=>d.includes(P.key)):r,B=new Map;for(const P of N){const _=String((P==null?void 0:P.assignee_id)||(P==null?void 0:P.emp_id)||"").trim();if(!_)continue;const U=B.get(_)||[];U.push(P),B.set(_,U)}return n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:10},children:T.map(P=>{const _=String(P.assigneeId||P.empId||P.key||""),U=B.get(_)||[],fe=["TNT","DYS"],ae=[...U].sort((F,pe)=>fe.indexOf(String(F.company||"").toUpperCase())-fe.indexOf(String(pe.company||"").toUpperCase()));return n.jsxs("div",{className:"card",style:{padding:10,border:"1px solid var(--border)",borderRadius:10},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[n.jsxs("div",{style:{fontWeight:700},children:[P.deptName||"-"," / ",P.empName||P.empId||P.key]}),n.jsxs("div",{className:"muted",style:{fontSize:11},children:[e,"년"]})]}),ae.length===0?n.jsx("div",{className:"muted",style:{fontSize:12},children:"데이터가 없습니다"}):n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:8},children:ae.map((F,pe)=>n.jsxs("div",{className:"card",style:{padding:8,border:"1px solid var(--border)",borderRadius:8,minHeight:92,display:"flex",flexDirection:"column",justifyContent:"center"},children:[n.jsx("div",{style:{fontWeight:700,marginBottom:6},children:String(F.company||"").toUpperCase()}),n.jsxs("div",{style:{display:"flex",gap:16,fontSize:12,justifyContent:"space-between"},children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[n.jsx("span",{className:"muted",children:"수립대상"}),n.jsx("strong",{children:Number(F.total_customers||0).toLocaleString()})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[n.jsx("span",{className:"muted",children:"확정"}),n.jsx("strong",{children:Number(F.confirmed_customers||0).toLocaleString()})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",flex:1},children:[n.jsx("span",{className:"muted",children:"진행 중"}),n.jsx("strong",{children:Number(F.planning_customers||0).toLocaleString()})]})]})]},pe))})]},_)})})})()]})]})}function H1(){return n.jsxs("section",{children:[n.jsx("h1",{children:"매출관리"}),n.jsx("div",{className:"empty-state",children:"초기 스켈레톤: 매출관리 화면"})]})}const Gf="http://220.73.213.73/Angkor.Ylw.Common.HttpExecute/RestOutsideService.svc/OpenApi/IsStoredProcedure/tnt_SWAPISLCustCreditListInfo",K1={certId:"TNT_CRM",certKey:"9836164F-3601-4DBB-9D6D-54685CD89B95",dsn:"tnt_bis",dsnOper:"tnt_oper",securityType:0,CompanySeq:1},Xl=[20,50,100],gr=e=>new Intl.NumberFormat("ko-KR",{maximumFractionDigits:0}).format(Math.round(e||0)),Y1=e=>{const t=r=>{const a=Number(r);return Number.isFinite(a)?a:0};return{CustName:String(e.CustName??""),CustNo:String(e.CustNo??""),CustSeq:String(e.CustSeq??""),IsCreditCheck:e.IsCreditCheck==="Y"?"Y":e.IsCreditCheck==="N"?"N":"",CurrName:String(e.CurrName??""),PrevCreditAmt:t(e.PrevCreditAmt),SalesAmt:t(e.SalesAmt),SalesVat:t(e.SalesVat),TotSalesAmt:t(e.TotSalesAmt),ReceiptAmt:t(e.ReceiptAmt),NoReceiptAmt:t(e.NoReceiptAmt)}},G1=({stdDate:e,custSeq:t,empSeq:r,pageNo:a,pageSize:i})=>({ROOT:{...K1,data:{ROOT:{DataBlock1:{StdDate:e.replace(/-/g,""),CustSeq:t.trim()?Number(t):"",EmpSeq:r.trim()?Number(r):"",SMQryType:1078004,IncludeMiNote:1,PAGE_NO:a,PAGE_SIZE:i}}}}});function V1(){const e=new Date().toISOString().slice(0,10),[t,r]=c.useState({stdDate:e,custSeq:"",empSeq:""}),[a,i]=c.useState(t),[s,o]=c.useState(1),[l,d]=c.useState(Xl[0]),[f,u]=c.useState([]),[h,m]=c.useState({PAGE_NO:1,PAGE_SIZE:Xl[0],TotalData:0,TotalPage:0}),[p,x]=c.useState(!1),[v,g]=c.useState(null),[b,y]=c.useState(null),[A,C]=c.useState(null),[N,w]=c.useState(!1),[M,O]=c.useState(null),D=($,J)=>{r(q=>({...q,[$]:J}))},W=()=>{i(t),o(1)},j=$=>{d($),o(1)},S=$=>{o(J=>$==="next"?h.TotalPage&&J>=h.TotalPage?J:J+1:Math.max(1,J-1))},R=c.useMemo(()=>f.reduce(($,J)=>($.sales+=J.SalesAmt,$.receipt+=J.ReceiptAmt,$.noReceipt+=J.NoReceiptAmt,$),{sales:0,receipt:0,noReceipt:0}),[f]),I=c.useCallback(async()=>{x(!0),g(null);try{const $=G1({stdDate:a.stdDate,custSeq:a.custSeq,empSeq:a.empSeq,pageNo:s,pageSize:l}),J=JSON.stringify($,null,2);C(J),w(!0);const q=await fetch(Gf,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify($)});if(!q.ok)throw new Error(`서버 응답이 존재하지 않거나 상태값 ${q.status}`);const K=await q.json(),L=K==null?void 0:K.ROOT,ee=L==null?void 0:L.ReturnCode;if(ee!=="0000"){const B=`ReturnCode: ${ee??"N/A"}${L!=null&&L.ReturnMessage?` • ${L.ReturnMessage}`:""}`;throw O(B),new Error((L==null?void 0:L.ReturnMessage)??"데이터를 불러오는 데 실패했습니다.")}O(`ReturnCode: ${ee??"N/A"}${L!=null&&L.ReturnMessage?` • ${L.ReturnMessage}`:""}`);const E=Array.isArray(L==null?void 0:L.DataBlock1)?L.DataBlock1:[];u(E.map(Y1));const T=Array.isArray(L==null?void 0:L.DataBlock2)?L.DataBlock2[0]:null;m(T?{PAGE_NO:Number(T.PAGE_NO??s),PAGE_SIZE:Number(T.PAGE_SIZE??l),TotalData:Number(T.TotalData??E.length),TotalPage:Number(T.TotalPage??0)}:B=>({...B,PAGE_NO:s,PAGE_SIZE:l,TotalData:E.length,TotalPage:Math.max(1,Math.ceil(E.length/l))})),y(new Date().toLocaleString())}catch($){g($.message??"데이터를 불러오는 중 알 수 없는 오류가 발생했습니다."),u([])}finally{x(!1)}},[a,s,l]);return c.useEffect(()=>{I()},[I]),n.jsxs("section",{className:"receivables-page",children:[n.jsxs("div",{className:"page-title",children:[n.jsx("h1",{children:"미수현황"}),n.jsx("p",{children:"기준일/필터를 설정하고 서버에서 고객 미수/판매/수금 데이터를 조회하세요."})]}),n.jsxs("div",{className:"filters-grid",children:[n.jsxs("label",{className:"field",children:[n.jsx("span",{children:"기준일"}),n.jsx("input",{type:"date",value:t.stdDate,onChange:$=>D("stdDate",$.target.value),className:"search-input"})]}),n.jsxs("label",{className:"field",children:[n.jsx("span",{children:"거래처 코드(CustSeq)"}),n.jsx("input",{type:"number",placeholder:"전체",value:t.custSeq,min:0,onChange:$=>D("custSeq",$.target.value),className:"search-input"})]}),n.jsxs("label",{className:"field",children:[n.jsx("span",{children:"사원 코드(EmpSeq)"}),n.jsx("input",{type:"number",placeholder:"전체",value:t.empSeq,min:0,onChange:$=>D("empSeq",$.target.value),className:"search-input"})]}),n.jsxs("label",{className:"field",children:[n.jsx("span",{children:"페이지 크기"}),n.jsx("select",{value:l,onChange:$=>j(Number($.target.value)),className:"search-input",children:Xl.map($=>n.jsxs("option",{value:$,children:[$,"개"]},$))})]}),n.jsxs("div",{className:"field actions",children:[n.jsx("button",{type:"button",className:"btn",onClick:W,disabled:p,children:"조회하기"}),n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>o(1),disabled:s===1,children:"첫 페이지"}),n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>A&&w(!0),disabled:!A,children:"최근 전문 보기"})]})]}),n.jsxs("div",{className:"summary-cards",children:[n.jsxs("article",{className:"summary-card",children:[n.jsxs("div",{children:[n.jsx("p",{className:"muted",children:"총 데이터"}),n.jsxs("strong",{children:[h.TotalData.toLocaleString(),"건"]})]}),n.jsxs("span",{className:"muted",children:[h.PAGE_NO," / ",Math.max(1,h.TotalPage)," 페이지"]})]}),n.jsxs("article",{className:"summary-card",children:[n.jsxs("div",{children:[n.jsx("p",{className:"muted",children:"금월 판매"}),n.jsxs("strong",{children:[gr(R.sales)," 원"]})]}),n.jsx("span",{className:"muted",children:"합계"})]}),n.jsxs("article",{className:"summary-card",children:[n.jsxs("div",{children:[n.jsx("p",{className:"muted",children:"금월 수금"}),n.jsxs("strong",{children:[gr(R.receipt)," 원"]})]}),n.jsx("span",{className:"muted",children:"합계"})]}),n.jsxs("article",{className:"summary-card highlight",children:[n.jsxs("div",{children:[n.jsx("p",{className:"muted",children:"현미수액"}),n.jsxs("strong",{children:[gr(R.noReceipt)," 원"]})]}),n.jsx("span",{className:"muted",children:"수금과 대비"})]})]}),n.jsxs("div",{className:"table-panel",children:[n.jsxs("div",{className:"table-panel-header",children:[n.jsx("div",{children:n.jsxs("p",{className:"muted",children:["마지막 업데이트: ",b??"—"]})}),n.jsxs("div",{className:"pagination-controls",children:[n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>S("prev"),disabled:s===1,children:"이전"}),n.jsxs("span",{children:[s," page / ",Math.max(1,h.TotalPage)," page"]}),n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>S("next"),disabled:h.TotalPage>0?s>=h.TotalPage:f.length<l,children:"다음"})]})]}),v&&n.jsx("div",{className:"empty-state",children:v}),n.jsx("div",{className:"table-container receivables-table",children:n.jsxs("table",{className:"table",children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{children:"거래처 코드"}),n.jsx("th",{children:"거래처명"}),n.jsx("th",{children:"통화"}),n.jsx("th",{children:"전월이월"}),n.jsx("th",{children:"금월판매"}),n.jsx("th",{children:"부가세"}),n.jsx("th",{children:"금월판매계"}),n.jsx("th",{children:"금월수금"}),n.jsx("th",{children:"현미수액"}),n.jsx("th",{children:"미수 여부"})]})}),n.jsx("tbody",{children:p?n.jsx("tr",{children:n.jsx("td",{colSpan:10,children:n.jsx("div",{className:"empty-state",children:"데이터를 불러오는 중입니다…"})})}):f.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:10,children:n.jsx("div",{className:"empty-state",children:"조회 결과가 없습니다."})})}):f.map($=>n.jsxs("tr",{children:[n.jsx("td",{children:$.CustSeq}),n.jsx("td",{children:$.CustName}),n.jsx("td",{children:$.CurrName}),n.jsxs("td",{children:[gr($.PrevCreditAmt)," 원"]}),n.jsxs("td",{children:[gr($.SalesAmt)," 원"]}),n.jsxs("td",{children:[gr($.SalesVat)," 원"]}),n.jsxs("td",{children:[gr($.TotSalesAmt)," 원"]}),n.jsxs("td",{children:[gr($.ReceiptAmt)," 원"]}),n.jsxs("td",{className:"highlight-cell",children:[gr($.NoReceiptAmt)," 원"]}),n.jsx("td",{children:$.IsCreditCheck||"N"})]},`${$.CustSeq}-${$.CustNo}`))})]})})]}),N&&A?n.jsx("div",{className:"json-modal-backdrop",role:"dialog","aria-modal":"true",children:n.jsxs("div",{className:"json-modal",children:[n.jsx("div",{className:"json-modal-header",children:n.jsx("strong",{children:"직전 요청 전문"})}),n.jsxs("p",{className:"muted",style:{fontSize:12},children:["요청 URL: ",Gf]}),n.jsx("pre",{children:A}),M?n.jsx("p",{className:"muted",style:{wordBreak:"break-all"},children:M}):null,n.jsx("div",{className:"json-modal-actions",children:n.jsx("button",{type:"button",className:"btn secondary",onClick:()=>w(!1),children:"닫기"})})]})}):null]})}const X1="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='16'%20height='16'%20viewBox='0%200%2024%2024'%20fill='none'%20stroke='currentColor'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3ccircle%20cx='12'%20cy='12'%20r='10'/%3e%3ccircle%20cx='12'%20cy='12'%20r='6'/%3e%3ccircle%20cx='12'%20cy='12'%20r='2'/%3e%3c/svg%3e";function xs({value:e,max:t,color:r,label:a}){const i=Math.max(0,Math.min(100,t>0?e/t*100:0));return n.jsxs("div",{"aria-label":a,style:{position:"relative",width:"100%",height:11,background:"rgba(0,0,0,.04)",borderRadius:999,overflow:"hidden"},children:[n.jsx("div",{style:{width:`${i}%`,height:"100%",background:r,borderRadius:999,transition:"width .2s ease"}}),n.jsx("div",{style:{position:"absolute",right:6,top:0,bottom:0,display:"flex",alignItems:"center",fontSize:10,color:"var(--text)"},children:e})]})}function Q1(){const[e,t]=c.useState(!0),[r,a]=c.useState(null),[i,s]=c.useState([]),[o,l]=c.useState(0),[d,f]=c.useState("default"),[u,h]=c.useState([]),[m,p]=c.useState(!0),[x,v]=c.useState(null);c.useEffect(()=>{let j=!1;async function S(){t(!0),a(null);try{const R=await fetch("/api/v1/employees");if(!R.ok)throw new Error(`EMP HTTP ${R.status}`);const I=await R.json();if(j)return;const $=(Array.isArray(I)?I:[]).map((J,q)=>({id:String(J.assignee_id??J.emp_id??q),name:String(J.emp_name??""),prevWeek:{plan:0,actual:0},thisWeek:{plan:0,actual:0},nextWeek:{plan:0,actual:0}}));s($);try{const[J,q]=await Promise.all([bs(o),bs(o-1)]);if(j)return;const K=Xf(J),L=Ql(q);s($.map(ee=>{const E=K.get(ee.id),T=L.get(ee.id);return{...ee,prevWeek:{plan:(T==null?void 0:T.plan)??0,actual:(T==null?void 0:T.actual)??0},thisWeek:{plan:(E==null?void 0:E.thisPlan)??0,actual:(E==null?void 0:E.thisActual)??0},nextWeek:{plan:(E==null?void 0:E.nextPlan)??0,actual:(E==null?void 0:E.nextActual)??0}}}))}catch{a("주간 활동 요약을 불러오지 못했습니다")}}catch{if(j)return;a("직원 목록을 불러오지 못했습니다");try{const I=await bs(o),$=await bs(o-1).catch(()=>[]);if(j)return;const J=Ql($),q=(Array.isArray(I)?I:[]).map((K,L)=>{var T,B,P,_;const ee=String(K.assignee_id??K.emp_id??L),E=J.get(ee);return{id:ee,name:String(K.emp_name??""),prevWeek:{plan:(E==null?void 0:E.plan)??0,actual:(E==null?void 0:E.actual)??0},thisWeek:{plan:Number(((T=K.thisWeek)==null?void 0:T.plan)??0),actual:Number(((B=K.thisWeek)==null?void 0:B.actual)??0)},nextWeek:{plan:Number(((P=K.nextWeek)==null?void 0:P.plan)??0),actual:Number(((_=K.nextWeek)==null?void 0:_.actual)??0)}}});s(q)}catch{s([{id:"e01",name:"김영업",prevWeek:{plan:0,actual:0},thisWeek:{plan:0,actual:0},nextWeek:{plan:0,actual:0}},{id:"e02",name:"박세일",prevWeek:{plan:0,actual:0},thisWeek:{plan:0,actual:0},nextWeek:{plan:0,actual:0}}])}}finally{j||t(!1)}}return S(),()=>{j=!0}},[o]),c.useEffect(()=>{let j=!1;async function S(){p(!0),v(null);try{const[R,I]=await Promise.all([Vf(o),Vf(o-1)]);if(j)return;const $=Xf(R),J=Ql(I),q=new Set;for(const L of[...R,...I]){const ee=String(L.assignee_id??L.emp_id??"");ee&&q.add(ee)}const K=Array.from(q).map(L=>{const ee=$.get(L),E=J.get(L),T=R.find(P=>String(P.assignee_id??P.emp_id)===L)||I.find(P=>String(P.assignee_id??P.emp_id)===L),B=T?String(T.emp_name??L):L;return{id:L,name:B,prevWeek:{plan:(E==null?void 0:E.plan)??0,actual:(E==null?void 0:E.actual)??0},thisWeek:{plan:(ee==null?void 0:ee.thisPlan)??0,actual:(ee==null?void 0:ee.thisActual)??0},nextWeek:{plan:(ee==null?void 0:ee.nextPlan)??0,actual:(ee==null?void 0:ee.nextActual)??0}}});K.sort((L,ee)=>L.name.localeCompare(ee.name)),h(K)}catch{if(j)return;v("지역 활동 계획을 불러오지 못했습니다"),h([])}finally{j||p(!1)}}return S(),()=>{j=!0}},[o]);const g=c.useMemo(()=>{let j=1;for(const S of i)j=Math.max(j,S.prevWeek.plan,S.prevWeek.actual,S.thisWeek.plan,S.thisWeek.actual,S.nextWeek.plan,S.nextWeek.actual);return j},[i]),b=c.useMemo(()=>{let j=1;for(const S of u)j=Math.max(j,S.prevWeek.plan,S.prevWeek.actual,S.thisWeek.plan,S.thisWeek.actual,S.nextWeek.plan,S.nextWeek.actual);return j},[u]),y=c.useMemo(()=>i.map(j=>{const S=j.prevWeek.plan,R=j.prevWeek.actual,I=S+R,$=I>0?R/I*100:0;return{...j,achievementRate:$,prevTotal:I}}),[i]),A=c.useMemo(()=>u.map(j=>{const S=j.prevWeek.plan,R=j.prevWeek.actual,I=S+R,$=I>0?R/I*100:0;return{...j,achievementRate:$,prevTotal:I}}),[u]),C=c.useMemo(()=>{const j=[...y];return d==="rate-high"?j.sort((S,R)=>R.achievementRate-S.achievementRate):d==="rate-low"?j.sort((S,R)=>S.achievementRate-R.achievementRate):j},[y,d]),N=c.useMemo(()=>{const j=[...A];return d==="rate-high"?j.sort((S,R)=>R.achievementRate-S.achievementRate):d==="rate-low"?j.sort((S,R)=>S.achievementRate-R.achievementRate):j},[A,d]),w="#3b82f6",M="#10b981",O=ke.useCallback((j,S,R,I)=>{const $=Lf(o+S);try{window.dispatchEvent(new CustomEvent(I?"tnt.sales.region-plans.select":"tnt.sales.activities.select",{detail:{assigneeId:j.id,empName:j.name,startIso:$.start.toISOString(),endIso:$.end.toISOString(),label:`${j.name} · ${R} 계획/실적`,isRegion:I||!1}}))}catch{}},[o]),D=c.useMemo(()=>Qb(Lf(o)),[o]);function W(j,S){const R=j>=90?"#10b981":j>=70?"#f59e0b":"#ef4444";return{display:S?`${Math.round(j)}%`:"-",color:R}}return n.jsxs("section",{className:"sales-activities-panel",style:{display:"flex",flexDirection:"column",gap:20},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:16,paddingBottom:12,borderBottom:"2px solid var(--border)"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"baseline",gap:12},children:[n.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700},children:"활동관리"}),n.jsx("div",{className:"muted",style:{fontSize:13,fontWeight:500},children:"주간 계획·실적"})]}),n.jsxs("div",{style:{display:"flex",gap:10,flexWrap:"wrap",alignItems:"center"},children:[n.jsxs("div",{className:"card",style:{display:"inline-flex",alignItems:"center",gap:8,padding:"0 12px",border:"1px solid var(--border)",borderRadius:10,background:"var(--panel)",boxShadow:"0 1px 3px rgba(0,0,0,.05)",height:44},children:[n.jsx("button",{className:"icon-button",title:"전주","aria-label":"전주",onClick:()=>l(j=>j-1),onKeyDown:j=>{(j.key==="Enter"||j.key===" ")&&(j.preventDefault(),l(S=>S-1))},style:{width:30,height:30,borderRadius:6},children:n.jsx("img",{src:Gp,className:"icon",alt:"전주"})}),n.jsx("button",{className:"icon-button",title:"이번주로","aria-label":"이번주로",onClick:()=>l(0),onKeyDown:j=>{(j.key==="Enter"||j.key===" ")&&(j.preventDefault(),l(0))},style:{width:30,height:30,borderRadius:6},children:n.jsx("img",{src:X1,className:"icon",alt:"이번주로"})}),n.jsx("button",{className:"icon-button",title:"다음주","aria-label":"다음주",onClick:()=>l(j=>j+1),onKeyDown:j=>{(j.key==="Enter"||j.key===" ")&&(j.preventDefault(),l(S=>S+1))},style:{width:30,height:30,borderRadius:6},children:n.jsx("img",{src:Vp,className:"icon",alt:"다음주"})}),n.jsx("span",{className:"muted",style:{fontSize:12,marginLeft:4,whiteSpace:"nowrap",fontWeight:600,minWidth:140,textAlign:"center"},children:D})]}),n.jsxs("div",{className:"card",style:{padding:"0 12px",border:"1px solid var(--border)",borderRadius:10,display:"inline-flex",alignItems:"center",gap:8,background:"var(--panel)",boxShadow:"0 1px 3px rgba(0,0,0,.05)",height:44},children:[n.jsx("label",{htmlFor:"sort-select",style:{fontSize:12,color:"var(--text-muted)",fontWeight:500,display:"flex",alignItems:"center"},children:"정렬"}),n.jsxs("select",{id:"sort-select",value:d,onChange:j=>f(j.target.value),style:{fontSize:12,padding:"4px 8px",border:"1px solid var(--border)",borderRadius:6,background:"var(--panel)",color:"var(--text)",cursor:"pointer",fontWeight:500},children:[n.jsx("option",{value:"default",children:"기본"}),n.jsx("option",{value:"rate-high",children:"달성률 높은순"}),n.jsx("option",{value:"rate-low",children:"달성률 낮은순"})]})]}),n.jsxs("div",{className:"card",style:{padding:"0 14px",border:"1px solid var(--border)",borderRadius:10,display:"inline-flex",alignItems:"center",gap:12,fontSize:11,background:"var(--panel)",boxShadow:"0 1px 3px rgba(0,0,0,.05)",height:44},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[n.jsx("span",{style:{width:10,height:10,background:w,borderRadius:2}}),n.jsx("span",{style:{fontWeight:500},children:"계획"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[n.jsx("span",{style:{width:10,height:10,background:M,borderRadius:2}}),n.jsx("span",{style:{fontWeight:500},children:"실적"})]})]})]})]}),e?n.jsx("div",{className:"muted",style:{padding:12,textAlign:"center",fontSize:13},children:"직원 목록을 불러오는 중…"}):null,r?n.jsx("div",{className:"error",style:{padding:12,borderRadius:8,background:"rgba(239,68,68,.1)",fontSize:13},children:r}):null,n.jsxs("div",{style:{background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,padding:20,boxShadow:"0 2px 8px rgba(0,0,0,.04)"},children:[n.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"var(--text)",marginBottom:16,paddingBottom:12,borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:8},children:[n.jsx("span",{style:{width:4,height:18,background:"#3b82f6",borderRadius:2}}),"영업 활동"]}),C.length===0?n.jsx("div",{className:"empty-state",style:{padding:16},children:"조회된 활동 데이터가 없습니다."}):n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 90px repeat(3, minmax(0, 1fr))",gap:"6px 12px",alignItems:"center"},children:[n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"영업사원"}),n.jsx("div",{className:"muted",style:{fontSize:12,textAlign:"center",fontWeight:700},children:"전주 달성률"}),n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"전주"}),n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"이번주"}),n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"차주"}),C.map(j=>{const S=W(j.achievementRate,j.prevTotal>0),R=[{key:"prev",label:"전주",data:j.prevWeek,offset:-1},{key:"this",label:"이번주",data:j.thisWeek,offset:0},{key:"next",label:"차주",data:j.nextWeek,offset:1}];return n.jsxs(ke.Fragment,{children:[n.jsx("div",{style:{padding:"3px 0",fontWeight:600,fontSize:12},children:j.name}),n.jsx("div",{style:{padding:"3px 0",textAlign:"center",fontWeight:700,color:S.color},children:S.display}),R.map(I=>n.jsx("div",{role:"button",tabIndex:0,title:`${I.label} 계획/실적 (클릭하여 상세보기)`,style:{cursor:"pointer",padding:"3px 0"},onClick:()=>O(j,I.offset,I.label),onKeyDown:$=>{($.key==="Enter"||$.key===" ")&&($.preventDefault(),O(j,I.offset,I.label))},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3,pointerEvents:"none"},children:[n.jsx(xs,{value:I.data.plan,max:g,color:w,label:`${j.name} ${I.label} 계획`}),n.jsx(xs,{value:I.data.actual,max:g,color:M,label:`${j.name} ${I.label} 실적`})]})},`${j.id}-${I.key}`))]},j.id)})]})]}),n.jsxs("div",{style:{background:"var(--panel)",border:"1px solid var(--border)",borderRadius:12,padding:20,boxShadow:"0 2px 8px rgba(0,0,0,.04)"},children:[n.jsxs("div",{style:{fontSize:15,fontWeight:700,color:"var(--text)",marginBottom:16,paddingBottom:12,borderBottom:"1px solid var(--border)",display:"flex",alignItems:"center",gap:8},children:[n.jsx("span",{style:{width:4,height:18,background:"#10b981",borderRadius:2}}),"지역 활동 계획"]}),m?n.jsx("div",{className:"muted",style:{padding:12,textAlign:"center",fontSize:13},children:"지역 활동 계획을 불러오는 중…"}):x?n.jsx("div",{className:"error",style:{padding:12,borderRadius:8,background:"rgba(239,68,68,.1)",fontSize:13},children:x}):N.length===0?n.jsx("div",{className:"muted",style:{padding:12,textAlign:"center",fontSize:13},children:"지역 활동 계획 데이터가 없습니다."}):n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"140px 90px repeat(3, minmax(0, 1fr))",gap:"6px 12px",alignItems:"center"},children:[n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"영업사원"}),n.jsx("div",{className:"muted",style:{fontSize:12,textAlign:"center",fontWeight:700},children:"전주 달성률"}),n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"전주"}),n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"이번주"}),n.jsx("div",{className:"muted",style:{fontSize:12,fontWeight:700},children:"차주"}),N.map(j=>{const S=W(j.achievementRate,j.prevTotal>0),R=[{key:"prev",label:"전주",data:j.prevWeek,offset:-1},{key:"this",label:"이번주",data:j.thisWeek,offset:0},{key:"next",label:"차주",data:j.nextWeek,offset:1}];return n.jsxs(ke.Fragment,{children:[n.jsx("div",{style:{padding:"3px 0",fontWeight:600,fontSize:12},children:j.name}),n.jsx("div",{style:{padding:"3px 0",textAlign:"center",fontWeight:700,color:S.color},children:S.display}),R.map(I=>n.jsx("div",{role:"button",tabIndex:0,title:`${I.label} 계획/실적 (클릭하여 상세보기)`,style:{cursor:"pointer",padding:"3px 0"},onClick:()=>O(j,I.offset,I.label,!0),onKeyDown:$=>{($.key==="Enter"||$.key===" ")&&($.preventDefault(),O(j,I.offset,I.label,!0))},children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:3,pointerEvents:"none"},children:[n.jsx(xs,{value:I.data.plan,max:b,color:w,label:`${j.name} ${I.label} 계획`}),n.jsx(xs,{value:I.data.actual,max:b,color:M,label:`${j.name} ${I.label} 실적`})]})},`${j.id}-${I.key}`))]},j.id)})]})]})]})}async function bs(e){const t=await fetch(`/api/v1/sales-activities/summary/weekly?offsetWeeks=${encodeURIComponent(e)}&depts=all`);if(!t.ok)throw new Error(`SUM HTTP ${t.status}`);const r=await t.json();return Array.isArray(r)?r:[]}async function Vf(e){const t=await fetch(`/api/v1/region-activity-plans/summary/weekly?offsetWeeks=${encodeURIComponent(e)}&depts=all`);if(!t.ok)throw new Error(`REGION HTTP ${t.status}`);const r=await t.json();return Array.isArray(r)?r:[]}function Xf(e){const t=new Map;for(const r of e){const a=String(r.assignee_id??r.emp_id??"");if(!a)continue;const i=r.thisWeek||{},s=r.nextWeek||{};t.set(a,{thisPlan:Number(i.plan??0),thisActual:Number(i.actual??0),nextPlan:Number(s.plan??0),nextActual:Number(s.actual??0)})}return t}function Ql(e){const t=new Map;for(const r of e){const a=String(r.assignee_id??r.emp_id??"");if(!a)continue;const i=r.thisWeek||{};t.set(a,{plan:Number(i.plan??0),actual:Number(i.actual??0)})}return t}const J1=({isOpen:e,onClose:t,onSelect:r})=>{const[a,i]=c.useState(""),[s,o]=c.useState(""),[l,d]=c.useState([]),[f,u]=c.useState(!1),[h,m]=c.useState([]);if(ke.useEffect(()=>{e&&(i(""),o(""),d([]),fetch("/api/v1/inventory/subcategories-ag").then(x=>x.ok?x.json():[]).then(x=>m(x)).catch(x=>console.error("Failed to fetch subcategories",x)))},[e]),!e)return null;const p=async()=>{u(!0);try{const x=new URLSearchParams;a&&x.append("keyword",a),s&&x.append("subcategory",s);const v=await fetch(`/api/v1/inventory/items-popup?${x.toString()}`);if(v.ok){const g=await v.json();d(g)}}catch(x){console.error("Failed to search items",x)}finally{u(!1)}};return n.jsx("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,background:"rgba(0,0,0,0.5)",zIndex:50,display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsxs("div",{style:{background:"#fff",borderRadius:8,boxShadow:"0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04)",width:700,maxHeight:"80vh",display:"flex",flexDirection:"column",overflow:"hidden"},children:[n.jsxs("div",{style:{padding:"16px 24px",borderBottom:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("h2",{style:{fontSize:18,fontWeight:600,color:"#111827",margin:0},children:"품목 검색"}),n.jsx("button",{onClick:t,style:{background:"none",border:"none",cursor:"pointer",color:"#6b7280",padding:4},children:n.jsx(Jp,{size:20})})]}),n.jsxs("div",{style:{padding:16,borderBottom:"1px solid #e5e7eb",background:"#f9fafb",display:"flex",gap:8},children:[n.jsxs("select",{style:{border:"1px solid #d1d5db",borderRadius:6,padding:"8px 12px",fontSize:14,flex:1,outline:"none",background:"#fff"},value:s,onChange:x=>o(x.target.value),children:[n.jsx("option",{value:"",children:"전체 중분류"}),h.map(x=>n.jsx("option",{value:x,children:x},x))]}),n.jsx("input",{style:{border:"1px solid #d1d5db",borderRadius:6,padding:"8px 12px",fontSize:14,flex:1,outline:"none"},placeholder:"품목명/품목코드",value:a,onChange:x=>i(x.target.value),onKeyDown:x=>x.key==="Enter"&&p()}),n.jsxs("button",{onClick:p,style:{background:"#2563eb",color:"#fff",padding:"8px 16px",borderRadius:6,fontSize:14,fontWeight:500,border:"none",cursor:"pointer",display:"flex",alignItems:"center",gap:6},children:[n.jsx(ya,{size:16}),"검색"]})]}),n.jsx("div",{style:{flex:1,overflow:"auto"},children:n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{style:{background:"#f9fafb",position:"sticky",top:0,zIndex:10},children:n.jsxs("tr",{children:[n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",fontWeight:600,borderBottom:"1px solid #e5e7eb"},children:"중분류"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",fontWeight:600,borderBottom:"1px solid #e5e7eb"},children:"품목코드"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",fontWeight:600,borderBottom:"1px solid #e5e7eb"},children:"품목명"})]})}),n.jsx("tbody",{children:f?n.jsx("tr",{children:n.jsx("td",{colSpan:3,style:{padding:"32px",textAlign:"center",color:"#6b7280",fontSize:14},children:"검색 중..."})}):l.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:3,style:{padding:"32px",textAlign:"center",color:"#6b7280",fontSize:14},children:"검색 결과가 없습니다."})}):l.map((x,v)=>n.jsxs("tr",{onClick:()=>{r(x.itemName),t()},style:{cursor:"pointer",borderBottom:"1px solid #f3f4f6"},onMouseEnter:g=>g.currentTarget.style.background="#f9fafb",onMouseLeave:g=>g.currentTarget.style.background="transparent",children:[n.jsx("td",{style:{padding:"12px 16px",fontSize:14,color:"#6b7280"},children:x.itemSubcategory}),n.jsx("td",{style:{padding:"12px 16px",fontSize:14,color:"#6b7280"},children:x.itemNo}),n.jsx("td",{style:{padding:"12px 16px",fontSize:14,color:"#111827",fontWeight:500},children:x.itemName})]},v))})]})})]})})};function Z1(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState("all"),[d,f]=c.useState("item"),[u,h]=c.useState(""),[m,p]=c.useState(""),[x,v]=c.useState(""),[g,b]=c.useState("ALL"),[y,A]=c.useState(""),[C,N]=c.useState(0),[w,M]=c.useState([]),[O,D]=c.useState(!1),W=async()=>{a(!0),s(null);try{const P=new URLSearchParams;u&&P.append("whName",u),m&&P.append("itemName",m),x&&P.append("category",x),y&&P.append("remainDayMax",y),C>0&&P.append("daysOffset",C.toString()),g!=="ALL"&&P.append("bizUnit",g);const _=await fetch(`/api/v1/inventory/expiry-stock-ag?${P.toString()}`);if(!_.ok)throw new Error(`API 호출 실패: ${_.status}`);const U=await _.json();Array.isArray(U)?t(U):U.error?(s(U.error),t([])):t([])}catch(P){console.error("유통기한재고(AG) 조회 실패:",P),s(P.message||"데이터 조회 중 오류가 발생했습니다.")}finally{a(!1)}},j=async()=>{try{console.log("Fetching warehouse options...");const P=await fetch("/api/v1/inventory/warehouses-ag");if(console.log("Warehouse response status:",P.status),P.ok){const _=await P.json();console.log("Warehouse data:",_),M(_)}else console.error("Warehouse fetch failed:",P.statusText)}catch(P){console.error("Failed to fetch warehouse options",P)}};c.useEffect(()=>{j()},[]),c.useEffect(()=>{W()},[]);const[S,R]=c.useState(new Set),I=P=>{const _=new Set(S);_.has(P)?_.delete(P):_.add(P),R(_)},[$,J]=c.useState(new Set),q=P=>{const _=new Set($);_.has(P)?_.delete(P):_.add(P),J(_)};c.useEffect(()=>{try{window.dispatchEvent(new CustomEvent("tnt.inventory.expiry.selection",{detail:{count:$.size,items:Array.from($)}}))}catch{}},[$]),c.useEffect(()=>{const P=_=>{var ae;const U=(ae=_.detail)==null?void 0:ae.promotionId;if(!U)return;const fe=Array.from($);if(fe.length===0){alert("적용할 품목을 선택하세요.");return}alert(`프로모션 ${U}을(를) ${fe.length}개 품목에 적용합니다.`)};return window.addEventListener("tnt.inventory.apply-promotion",P),()=>window.removeEventListener("tnt.inventory.apply-promotion",P)},[$]);const K=c.useMemo(()=>e.map(P=>{const _=P.remainDay||0;let U="good",fe="Normal",ae=100;return _<=0?(U="expired",fe="즉시 폐기",ae=0):_<=60?(U="critical",fe="긴급 처분 (Clearance)",ae=20):_<=120?(U="warning",fe="집중 모니터링",ae=50):fe="정상 판매",{...P,_status:U,_action:fe,_score:ae}}),[e]),L=c.useMemo(()=>K.filter(P=>o==="disposal"?P._status==="expired":o==="clearance"?P._status==="critical":o==="watch"?P._status==="warning":!0),[K,o]),ee=c.useMemo(()=>{const P={};return K.forEach(_=>{const U=_.itemSubcategory||"미분류";P[U]||(P[U]={name:U,totalQty:0,expiredQty:0,criticalQty:0,warningQty:0,itemCount:0,totalScore:0,items:[]}),P[U].totalQty+=_.stockQty||0,P[U].itemCount+=1,P[U].totalScore+=_._score,P[U].items.push(_),_._status==="expired"&&(P[U].expiredQty+=_.stockQty||0),_._status==="critical"&&(P[U].criticalQty+=_.stockQty||0),_._status==="warning"&&(P[U].warningQty+=_.stockQty||0)}),Object.values(P).map(_=>({..._,avgScore:_.itemCount>0?Math.round(_.totalScore/_.itemCount):0,riskRatio:_.totalQty>0?Math.round((_.expiredQty+_.criticalQty)/_.totalQty*100):0})).sort((_,U)=>U.riskRatio-_.riskRatio)},[K]),E=c.useMemo(()=>{const P=K.reduce((ae,F)=>ae+(F.stockQty||0),0),_=K.filter(ae=>ae._status==="expired").reduce((ae,F)=>ae+(F.stockQty||0),0),U=K.filter(ae=>ae._status==="critical").reduce((ae,F)=>ae+(F.stockQty||0),0),fe=K.filter(ae=>ae._status==="warning").reduce((ae,F)=>ae+(F.stockQty||0),0);return{totalQty:P,expiredQty:_,criticalQty:U,warningQty:fe}},[K]),T=P=>P?Number(P).toLocaleString("ko-KR"):"-",B=P=>{if(!P)return"-";const _=String(P);return _.length===8?`${_.substring(0,4)}-${_.substring(4,6)}-${_.substring(6,8)}`:_};return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[n.jsxs("div",{style:{marginBottom:24,display:"flex",alignItems:"baseline",gap:12},children:[n.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"재고 건전성 분석"}),n.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"유통기한 기반 재고 리스크 분석 및 처분 제안"})]}),n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",marginBottom:20},children:[n.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex",marginRight:12},children:["ALL","TNT","DYS"].map(P=>n.jsx("button",{onClick:()=>b(P),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:g===P?"#fff":"transparent",color:g===P?"#2563eb":"#6b7280",boxShadow:g===P?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:P},P))}),n.jsxs("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"flex",marginRight:12},children:[n.jsxs("button",{onClick:()=>f("item"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:d==="item"?"#fff":"transparent",color:d==="item"?"#111827":"#6b7280",boxShadow:d==="item"?"0 1px 2px rgba(0,0,0,0.1)":"none",display:"flex",alignItems:"center",gap:6,whiteSpace:"nowrap"},children:[n.jsx(Sj,{size:16}),"품목별 보기"]}),n.jsxs("button",{onClick:()=>f("category"),style:{padding:"6px 12px",borderRadius:6,border:"none",fontSize:13,fontWeight:600,cursor:"pointer",background:d==="category"?"#fff":"transparent",color:d==="category"?"#111827":"#6b7280",boxShadow:d==="category"?"0 1px 2px rgba(0,0,0,0.1)":"none",display:"flex",alignItems:"center",gap:6,whiteSpace:"nowrap"},children:[n.jsx(Qp,{size:16}),"중분류 분석"]})]}),n.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:[n.jsx("input",{className:"search-input",placeholder:"품목명 검색 (클릭)",value:m,readOnly:!0,onClick:()=>D(!0),style:{width:180,paddingLeft:12,paddingRight:32,cursor:"pointer"}}),n.jsx(ya,{size:14,style:{position:"absolute",right:10,color:"#9ca3af",pointerEvents:"none"}})]}),n.jsx("div",{style:{position:"relative",display:"flex",alignItems:"center"},children:n.jsxs("select",{className:"search-input",value:u,onChange:P=>h(P.target.value),style:{width:150},children:[n.jsx("option",{value:"",children:"전체 창고"}),w.map(P=>n.jsx("option",{value:P,children:P},P))]})}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,paddingLeft:12,borderLeft:"1px solid #e5e7eb"},children:[n.jsxs("select",{className:"search-input",value:C,onChange:P=>N(Number(P.target.value)),style:{width:130,color:C>0?"#ef4444":"inherit",fontWeight:C>0?600:400},children:[n.jsx("option",{value:0,children:"현재 기준"}),n.jsx("option",{value:7,children:"1주 후 예측"}),n.jsx("option",{value:14,children:"2주 후 예측"}),n.jsx("option",{value:21,children:"3주 후 예측"}),n.jsx("option",{value:28,children:"4주 후 예측"}),n.jsx("option",{value:60,children:"2개월 후 예측"}),n.jsx("option",{value:90,children:"3개월 후 예측"}),n.jsx("option",{value:180,children:"6개월 후 예측"})]}),n.jsx("input",{className:"search-input",type:"number",placeholder:"잔여일수(이하)",value:y,onChange:P=>A(P.target.value),style:{width:110}})]}),n.jsxs("div",{style:{display:"flex",gap:8,marginLeft:"auto"},children:[n.jsx("button",{className:"btn",onClick:W,disabled:r,style:{height:30,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",whiteSpace:"nowrap"},children:r?"분석 중...":"분석 실행"}),n.jsx("button",{className:"btn secondary",onClick:()=>{p(""),h(""),A(""),N(0),b("ALL"),W()},style:{height:30,padding:"0 12px",fontSize:13,whiteSpace:"nowrap"},children:"초기화"})]})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[n.jsx(js,{title:"전체 재고",value:T(E.totalQty),icon:n.jsx(Xp,{size:24}),color:"#3b82f6"}),n.jsx(js,{title:"폐기 대상 (만료)",value:T(E.expiredQty),subtext:"즉시 조치 필요",icon:n.jsx(vd,{size:24}),color:"#ef4444",active:o==="disposal"&&d==="item",onClick:()=>{l("disposal"),f("item")}}),n.jsx(js,{title:"긴급 처분 (<60일)",value:T(E.criticalQty),subtext:"프로모션 권장",icon:n.jsx(jj,{size:24}),color:"#f97316",active:o==="clearance"&&d==="item",onClick:()=>{l("clearance"),f("item")}}),n.jsx(js,{title:"관심 품목 (<120일)",value:T(E.warningQty),subtext:"모니터링 필요",icon:n.jsx(xj,{size:24}),color:"#eab308",active:o==="watch"&&d==="item",onClick:()=>{l("watch"),f("item")}})]})]}),d==="item"&&n.jsx("div",{style:{padding:"0 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:n.jsxs("div",{style:{display:"flex",gap:24},children:[n.jsx(ws,{label:"전체 목록",active:o==="all",onClick:()=>l("all")}),n.jsx(ws,{label:"폐기 대상",count:E.expiredQty,active:o==="disposal",onClick:()=>l("disposal"),color:"#ef4444"}),n.jsx(ws,{label:"긴급 처분",count:E.criticalQty,active:o==="clearance",onClick:()=>l("clearance"),color:"#f97316"}),n.jsx(ws,{label:"관심 품목",count:E.warningQty,active:o==="watch",onClick:()=>l("watch"),color:"#eab308"})]})}),n.jsx("div",{style:{flex:1,padding:24,overflow:"hidden",display:"flex",gap:24},children:n.jsx("div",{className:"card",style:{flex:1,height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:i?n.jsx("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:i}):e.length===0&&!r?n.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"데이터가 없습니다."}):n.jsx("div",{style:{overflow:"auto",flex:1},children:d==="item"?n.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:n.jsxs("tr",{children:[n.jsx("th",{style:{padding:"12px 16px",width:40},children:n.jsx("input",{type:"checkbox",onChange:P=>{P.target.checked?J(new Set(L.map(_=>_.itemNo).filter(Boolean))):J(new Set)},checked:L.length>0&&$.size===L.length})}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"상태"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"품목명 / 코드"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"중분류"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"창고"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"재고수량"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"유통기한"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"잔여일수"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"건전성"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"추천 조치"})]})}),n.jsx("tbody",{children:L.map((P,_)=>n.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6",":hover":{background:"#f9fafb"}},children:[n.jsx("td",{style:{padding:"12px 16px"},children:n.jsx("input",{type:"checkbox",checked:P.itemNo?$.has(P.itemNo):!1,onChange:()=>P.itemNo&&q(P.itemNo)})}),n.jsx("td",{style:{padding:"12px 16px"},children:n.jsx(Qf,{status:P._status})}),n.jsxs("td",{style:{padding:"12px 16px"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[P.srcBizunit==="TNT"&&n.jsx("span",{style:{background:"#e0f2fe",color:"#0369a1",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"T"}),P.srcBizunit==="DYS"&&n.jsx("span",{style:{background:"#fce7f3",color:"#be185d",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"D"}),n.jsx("div",{style:{fontWeight:500,color:"#111827"},children:P.itemName})]}),n.jsxs("div",{style:{fontSize:11,color:"#9ca3af",marginTop:2},children:[P.itemNo," | ",P.spec]})]}),n.jsx("td",{style:{padding:"12px 16px",color:"#4b5563",fontSize:12},children:P.itemSubcategory}),n.jsx("td",{style:{padding:"12px 16px",color:"#4b5563"},children:P.whName}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600},children:T(P.stockQty)}),n.jsx("td",{style:{padding:"12px 16px",color:"#4b5563"},children:B(P.expDate)}),n.jsx("td",{style:{padding:"12px 16px"},children:n.jsxs("span",{style:{fontWeight:600,color:P.remainDay&&P.remainDay<=60?"#ef4444":"#111827"},children:[P.remainDay,"일"]})}),n.jsx("td",{style:{padding:"12px 16px"},children:n.jsx(Jf,{score:P._score})}),n.jsx("td",{style:{padding:"12px 16px"},children:n.jsx("span",{style:{fontSize:12,fontWeight:500,color:P._status==="expired"?"#ef4444":P._status==="critical"?"#f97316":"#374151"},children:P._action})})]},P.id||_))})]}):n.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:n.jsxs("tr",{children:[n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"순위"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"중분류명"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"전체 재고"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"폐기 대상"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"긴급 처분"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"관심 품목"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:"리스크 비율"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280"},children:"평균 건전성"}),n.jsx("th",{style:{width:40}})]})}),n.jsx("tbody",{children:ee.map((P,_)=>n.jsxs(ke.Fragment,{children:[n.jsxs("tr",{onClick:()=>I(P.name),style:{borderBottom:"1px solid #f3f4f6",cursor:"pointer",background:S.has(P.name)?"#f9fafb":"#fff"},children:[n.jsx("td",{style:{padding:"12px 16px",color:"#9ca3af",fontWeight:500},children:_+1}),n.jsx("td",{style:{padding:"12px 16px",fontWeight:600,color:"#111827"},children:P.name}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600},children:T(P.totalQty)}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:P.expiredQty>0?"#ef4444":"#d1d5db",fontWeight:P.expiredQty>0?700:400},children:T(P.expiredQty)}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:P.criticalQty>0?"#f97316":"#d1d5db",fontWeight:P.criticalQty>0?700:400},children:T(P.criticalQty)}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",color:P.warningQty>0?"#eab308":"#d1d5db",fontWeight:P.warningQty>0?700:400},children:T(P.warningQty)}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right"},children:n.jsxs("span",{style:{color:P.riskRatio>50?"#ef4444":P.riskRatio>20?"#f97316":"#10b981",fontWeight:700},children:[P.riskRatio,"%"]})}),n.jsx("td",{style:{padding:"12px 16px"},children:n.jsx(Jf,{score:P.avgScore})}),n.jsx("td",{style:{padding:"12px 16px",color:"#9ca3af"},children:S.has(P.name)?n.jsx(Jb,{size:16}):n.jsx(qs,{size:16})})]}),S.has(P.name)&&n.jsx("tr",{children:n.jsx("td",{colSpan:9,style:{padding:0,background:"#f9fafb"},children:n.jsx("div",{style:{padding:"12px 24px",borderBottom:"1px solid #e5e7eb"},children:n.jsxs("table",{style:{width:"100%",fontSize:13},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"품목명"}),n.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"코드"}),n.jsx("th",{style:{textAlign:"right",padding:"8px 12px",color:"#6b7280"},children:"재고"}),n.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"유통기한"}),n.jsx("th",{style:{textAlign:"left",padding:"8px 12px",color:"#6b7280"},children:"상태"})]})}),n.jsx("tbody",{children:P.items.map((U,fe)=>n.jsxs("tr",{style:{borderTop:"1px solid #e5e7eb"},children:[n.jsx("td",{style:{padding:"8px 12px",color:"#111827",fontWeight:500},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[U.srcBizunit==="TNT"&&n.jsx("span",{style:{background:"#e0f2fe",color:"#0369a1",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"T"}),U.srcBizunit==="DYS"&&n.jsx("span",{style:{background:"#fce7f3",color:"#be185d",width:18,height:18,borderRadius:4,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:"D"}),U.itemName]})}),n.jsx("td",{style:{padding:"8px 12px",color:"#6b7280"},children:U.itemNo}),n.jsx("td",{style:{padding:"8px 12px",textAlign:"right",fontWeight:600},children:T(U.stockQty)}),n.jsxs("td",{style:{padding:"8px 12px",color:"#4b5563"},children:[B(U.expDate)," (",U.remainDay,"일)"]}),n.jsx("td",{style:{padding:"8px 12px"},children:n.jsx(Qf,{status:U._status})})]},fe))})]})})})})]},P.name))})]})})})}),n.jsx(J1,{isOpen:O,onClose:()=>D(!1),onSelect:P=>{p(P)}})]})}function js({title:e,value:t,subtext:r,icon:a,color:i,active:s,onClick:o}){return n.jsxs("div",{onClick:o,style:{background:s?`${i}10`:"#fff",border:`1px solid ${s?i:"#e5e7eb"}`,borderRadius:12,padding:20,cursor:o?"pointer":"default",transition:"all 0.2s",boxShadow:s?`0 4px 12px ${i}20`:"none"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:8},children:[n.jsx("span",{style:{fontSize:14,color:"#6b7280",fontWeight:500},children:e}),n.jsx("span",{style:{color:i},children:a})]}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:t}),r&&n.jsx("div",{style:{fontSize:12,color:i,marginTop:4,fontWeight:500},children:r})]})}function ws({label:e,count:t,active:r,onClick:a,color:i="#3b82f6"}){return n.jsxs("button",{onClick:a,style:{padding:"16px 0",background:"none",border:"none",borderBottom:`2px solid ${r?i:"transparent"}`,color:r?i:"#6b7280",fontWeight:r?600:500,cursor:"pointer",fontSize:14,display:"flex",alignItems:"center",gap:6},children:[e,t!==void 0&&n.jsx("span",{style:{background:r?i:"#f3f4f6",color:r?"#fff":"#6b7280",padding:"2px 8px",borderRadius:99,fontSize:11,fontWeight:600},children:t>999?"999+":t})]})}function Qf({status:e}){const t={expired:{bg:"#fef2f2",text:"#ef4444",label:"만료"},critical:{bg:"#fff7ed",text:"#f97316",label:"위험"},warning:{bg:"#fefce8",text:"#eab308",label:"주의"},good:{bg:"#ecfdf5",text:"#10b981",label:"정상"}},r=t[e]||t.good;return n.jsx("span",{style:{background:r.bg,color:r.text,padding:"4px 8px",borderRadius:6,fontSize:11,fontWeight:600,border:`1px solid ${r.text}20`},children:r.label})}function Jf({score:e}){let t="#10b981";return e<=20?t="#ef4444":e<=50&&(t="#eab308"),n.jsx("div",{style:{width:80,height:6,background:"#e5e7eb",borderRadius:3,overflow:"hidden"},children:n.jsx("div",{style:{width:`${e}%`,height:"100%",background:t,borderRadius:3}})})}function ew(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState(null),[d,f]=c.useState(!1),[u,h]=c.useState([]);c.useEffect(()=>{let x=!0;return a(!0),s(null),fetch("/api/v1/items/unit-usage").then(async v=>{if(!v.ok)throw new Error(`HTTP ${v.status}`);return v.json()}).then(v=>{if(!x)return;const g=Array.isArray(v)?v.map(b=>({salesMgmtUnitSeq:Number(b.salesMgmtUnitSeq??0),salesMgmtUnit:String(b.salesMgmtUnit??"미지정"),itemStdUnit:String(b.itemStdUnit??"미지정"),itemUnit:String(b.itemUnit??"미지정"),itemCount:Number(b.itemCount??0)})):[];t(g)}).catch(v=>{x&&s(v.message||"조회 중 오류가 발생했습니다")}).finally(()=>{x&&a(!1)}),()=>{x=!1}},[]);const m=c.useMemo(()=>{const x={};for(const v of e){const g=v.salesMgmtUnit;x[g]||(x[g]=[]),x[g].push(v)}return Object.values(x).forEach(v=>v.sort((g,b)=>b.itemCount-g.itemCount)),Object.entries(x).sort((v,g)=>{const b=v[0],y=g[0],A=b==="미지정",C=y==="미지정";return A&&!C?1:!A&&C?-1:b.localeCompare(y)})},[e]);async function p(x){f(!0),s(null);try{const v=await fetch(`/api/v1/items/unit-usage/items?salesMgmtUnit=${encodeURIComponent(x)}`);if(!v.ok)throw new Error(`HTTP ${v.status}`);const g=await v.json(),b=Array.isArray(g)?g.map(y=>({itemSeq:y.itemSeq??null,itemName:String(y.itemName??""),itemStdUnit:String(y.itemStdUnit??"미지정"),itemUnit:String(y.itemUnit??"미지정"),salesMgmtUnitSeq:y.salesMgmtUnitSeq??null})):[];h(b)}catch(v){s((v==null?void 0:v.message)||"상세 조회 중 오류가 발생했습니다")}finally{f(!1)}}return n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[n.jsxs("div",{children:[n.jsx("h2",{style:{margin:0},children:"품목단위분석"}),n.jsx("p",{style:{margin:"4px 0 0",color:"var(--muted)"},children:"item 테이블 기준으로 영업관리단위별 사용 단위(표준단위/판매단위) 분포를 확인합니다."})]}),r?n.jsx("span",{style:{color:"var(--muted)"},children:"불러오는 중…"}):null,i?n.jsx("span",{style:{color:"crimson"},children:i}):null]}),m.length===0&&!r?n.jsx("div",{className:"empty-state",children:"데이터가 없습니다."}):n.jsx("div",{className:"card",style:{padding:12,height:"calc(100vh - 200px)",display:"flex",flexDirection:"column"},children:n.jsx("div",{style:{flex:1,minHeight:0,overflow:"auto"},children:n.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{textAlign:"right",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"No."}),n.jsx("th",{style:{textAlign:"left",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"영업관리단위"}),n.jsx("th",{style:{textAlign:"left",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"판매단위(item_unit)"}),n.jsx("th",{style:{textAlign:"left",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"표준단위(item_std_unit)"}),n.jsx("th",{style:{textAlign:"right",padding:"6px 8px",position:"sticky",top:0,background:"var(--bg)",zIndex:1},children:"품목수"})]})}),n.jsx("tbody",{children:m.map(([x,v],g)=>n.jsxs(ke.Fragment,{children:[v.map((b,y)=>n.jsxs("tr",{style:{borderTop:"1px solid var(--border)"},children:[y===0?n.jsxs(n.Fragment,{children:[n.jsx("td",{rowSpan:v.length,style:{padding:"6px 8px",textAlign:"right",color:"var(--muted)",fontVariantNumeric:"tabular-nums"},children:g+1}),n.jsxs("td",{rowSpan:v.length,style:{padding:"6px 8px",fontWeight:600,cursor:"pointer"},onClick:()=>{const A=o===x?null:x;l(A),A&&p(A)},children:[x,n.jsx("span",{style:{marginLeft:8,fontSize:12,color:"var(--muted)"},children:o===x?"닫기":"품목 보기"})]})]}):null,n.jsx("td",{style:{padding:"6px 8px"},children:b.itemUnit}),n.jsx("td",{style:{padding:"6px 8px"},children:b.itemStdUnit}),n.jsx("td",{style:{padding:"6px 8px",textAlign:"right"},children:b.itemCount.toLocaleString()})]},x+y)),o===x?n.jsx("tr",{style:{background:"var(--muted-bg, #fafafa)"},children:n.jsx("td",{colSpan:5,style:{padding:"8px 8px 12px"},children:d?n.jsx("div",{style:{color:"var(--muted)"},children:"품목 불러오는 중…"}):u.length===0?n.jsx("div",{style:{color:"var(--muted)"},children:"해당 영업관리단위에 품목이 없습니다."}):n.jsx("div",{style:{maxHeight:"50vh",minHeight:200,overflow:"auto",border:"1px solid var(--border)",borderRadius:6},children:n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{children:n.jsxs("tr",{style:{position:"sticky",top:0,background:"var(--bg)"},children:[n.jsx("th",{style:{textAlign:"left",padding:"6px 8px"},children:"품목명"}),n.jsx("th",{style:{textAlign:"left",padding:"6px 8px"},children:"판매단위"}),n.jsx("th",{style:{textAlign:"left",padding:"6px 8px"},children:"표준단위"}),n.jsx("th",{style:{textAlign:"right",padding:"6px 8px"},children:"품목SEQ"})]})}),n.jsx("tbody",{children:u.map((b,y)=>n.jsxs("tr",{style:{borderTop:"1px solid var(--border)"},children:[n.jsx("td",{style:{padding:"6px 8px"},children:b.itemName||"(이름 없음)"}),n.jsx("td",{style:{padding:"6px 8px"},children:b.itemUnit||"미지정"}),n.jsx("td",{style:{padding:"6px 8px"},children:b.itemStdUnit||"미지정"}),n.jsx("td",{style:{padding:"6px 8px",textAlign:"right",color:"var(--muted)"},children:b.itemSeq??""})]},(b.itemSeq??"na")+"-"+y))})]})})})}):null]},x))})]})})})]})}const tw=["TNT","DYS"];function nw(){const[e,t]=c.useState("TNT"),[r,a]=c.useState("2022"),[i,s]=c.useState([]),[o,l]=c.useState("all"),[d,f]=c.useState([]),[u,h]=c.useState([]),[m,p]=c.useState(!1),[x,v]=c.useState(null);c.useEffect(()=>{g()},[e,r]);const g=async()=>{const D=Number(r)||2022;try{const W=new URLSearchParams;W.append("companyType",e),W.append("fromYear",String(D));const j=await fetch(`/api/v1/analysis/price-sim/employees?${W.toString()}`);if(!j.ok)throw new Error(`HTTP ${j.status}`);const S=await j.json();s(S),l(S.length?"all":"")}catch(W){s([]),l(""),v((W==null?void 0:W.message)||"영업사원 목록 조회 실패")}},b=async()=>{p(!0),v(null);const D=Number(r)||2022;try{const W=new URLSearchParams;e!=="ALL"&&W.append("companyType",e),W.append("fromYear",String(D)),o&&o!=="all"&&W.append("empName",o);const j=await fetch(`/api/v1/analysis/price-sim?${W.toString()}`);if(!j.ok)throw new Error(`HTTP ${j.status}`);const S=await j.json();if(S.error)throw new Error(S.error);const R=Array.isArray(S.data)?S.data.map($=>({salesYear:Number($.salesYear??$.salesyear??0),salesUnit:String($.salesUnit??$.salesunit??"미지정"),empName:String($.empName??$.empname??"미지정"),salesCount:$.salesCount??$.salescount,totalQty:$.totalQty??$.totalqty,totalAmt:$.totalAmt??$.totalamt,avgPrice:(()=>{const J=Number($.totalQty??$.totalqty??0),q=$.avgPrice??$.avgprice??null;if(!Number.isFinite(J)||J<=0)return null;const K=Number(q);return Number.isFinite(K)?K:null})()})):[];f(R);const I=Array.isArray(S.companyAvg)?S.companyAvg.map($=>({salesUnit:String($.salesUnit??$.salesunit??"미지정"),avgPrice:$.avgPrice??$.avgprice??null})):[];h(I)}catch(W){f([]),h([]),v((W==null?void 0:W.message)||"조회 실패")}finally{p(!1)}},y=c.useMemo(()=>{const D=[...d];return D.sort((W,j)=>{if(j.salesYear!==W.salesYear)return j.salesYear-W.salesYear;const S=W.salesUnit||"미지정",R=j.salesUnit||"미지정",I=S==="미지정",$=R==="미지정";return I&&!$?1:!I&&$?-1:S.localeCompare(R)}),D},[d]),A=c.useMemo(()=>Array.from(new Set(y.map(D=>D.salesYear))).sort((D,W)=>W-D),[y]),C=c.useMemo(()=>{const D=new Map;for(const W of u)D.set(W.salesUnit||"미지정",W.avgPrice??null);return D},[u]),N=c.useMemo(()=>{const D=new Map;for(const W of y){const j=`${W.empName}__${W.salesUnit}`;if(!D.has(j)){const R={};A.forEach(I=>{R[I]=null}),D.set(j,{empName:W.empName||"미지정",salesUnit:W.salesUnit||"미지정",yearly:R})}const S=D.get(j);S.yearly[W.salesYear]=W.avgPrice}return Array.from(D.values()).sort((W,j)=>{const S=W.salesUnit==="미지정",R=j.salesUnit==="미지정";if(S&&!R)return 1;if(!S&&R)return-1;const I=W.salesUnit.localeCompare(j.salesUnit);return I!==0?I:W.empName.localeCompare(j.empName)})},[y,A]),w=c.useMemo(()=>{const D=y.reduce((R,I)=>R+(I.salesCount||0),0),W=y.reduce((R,I)=>R+(I.totalQty||0),0),j=y.reduce((R,I)=>R+(I.totalAmt||0),0),S=W>0?j/W:0;return{totalSalesCount:D,totalQty:W,totalAmt:j,avgPrice:S}},[y]),M=D=>{if(D==null||D==="")return"-";const W=Number(D);return Number.isFinite(W)?W.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(D)},O=D=>{if(D==null||D==="")return"-";const W=Number(D);return Number.isFinite(W)?W.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(D)};return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[n.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:"판매단가 시뮬레이션"}),n.jsxs("div",{style:{marginTop:16,display:"flex",gap:12,alignItems:"flex-end"},children:[n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"회사 구분"}),n.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"inline-flex",gap:2},children:tw.map(D=>n.jsx("button",{onClick:()=>t(D),style:{background:e===D?"#fff":"transparent",border:"none",padding:"8px 16px",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer",color:e===D?"#111827":"#6b7280",boxShadow:e===D?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:D},D))})]}),n.jsxs("div",{style:{flex:1,maxWidth:240},children:[n.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"영업사원"}),n.jsxs("select",{className:"input",value:o,onChange:D=>l(D.target.value),style:{width:"100%",padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13,color:"#111827",background:"#fff"},children:[n.jsx("option",{value:"all",children:"전체"}),i.map(D=>n.jsx("option",{value:D,children:D},D))]})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"시작 연도"}),n.jsx("input",{className:"input",type:"number",min:2e3,max:new Date().getFullYear(),value:r,onChange:D=>a(D.target.value),style:{width:100,padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13,textAlign:"center",color:"#111827",background:"#fff"}})]}),n.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:n.jsxs("button",{onClick:b,disabled:m,style:{background:m?"#93c5fd":"#3b82f6",border:"none",padding:"8px 20px",borderRadius:6,fontSize:13,fontWeight:600,cursor:m?"not-allowed":"pointer",color:"#fff",display:"flex",alignItems:"center",gap:6},children:[n.jsx(Ai,{size:14}),m?"조회 중...":"분석 실행"]})})]}),d.length>0&&n.jsxs("div",{style:{marginTop:20,display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[n.jsx(Ss,{title:"총 거래 건수",value:M(w.totalSalesCount),subtext:"Invoice 기준",icon:n.jsx(xd,{size:24}),color:"#3b82f6"}),n.jsx(Ss,{title:"총 판매 수량",value:M(w.totalQty),subtext:"전체 기간 합계",icon:n.jsx(Xp,{size:24}),color:"#10b981"}),n.jsx(Ss,{title:"총 판매 금액",value:M(w.totalAmt),subtext:"원화 기준",icon:n.jsx(Ai,{size:24}),color:"#f59e0b"}),n.jsx(Ss,{title:"평균 판매 단가",value:O(w.avgPrice),subtext:"금액 ÷ 수량",icon:n.jsx(Ai,{size:24}),color:"#8b5cf6"})]})]}),n.jsx("div",{style:{flex:1,padding:24,overflow:"hidden"},children:n.jsx("div",{className:"card",style:{height:"100%",display:"flex",flexDirection:"column",overflow:"hidden",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:x?n.jsx("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:x}):y.length===0?n.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"조건을 선택하고 분석을 실행하세요"}):n.jsx("div",{style:{overflow:"auto",flex:1,padding:16},children:n.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:n.jsxs("tr",{children:[n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",width:160},children:"영업사원"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",width:160},children:"영업관리단위"}),n.jsx("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280",width:120},children:"회사 평균단가"}),A.map(D=>n.jsxs("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:[D,"년 평균단가"]},D))]})}),n.jsx("tbody",{children:N.map((D,W)=>n.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[n.jsx("td",{style:{padding:"12px 16px",fontWeight:500,color:"#111827"},children:D.empName||"-"}),n.jsx("td",{style:{padding:"12px 16px",color:"#4b5563"},children:D.salesUnit||"미지정"}),n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600,color:"#6b7280"},children:O(C.get(D.salesUnit||"미지정"))}),A.map(j=>n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600,color:"#111827"},children:O(D.yearly[j])},j))]},D.empName+D.salesUnit+W))})]})})})})]})}function Ss({title:e,value:t,subtext:r,icon:a,color:i}){return n.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:8,padding:12,transition:"all 0.2s"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:4},children:[n.jsx("span",{style:{fontSize:11,color:"#6b7280",fontWeight:500},children:e}),n.jsx("span",{style:{color:i},children:ke.cloneElement(a,{size:16})})]}),n.jsx("div",{style:{fontSize:18,fontWeight:700,color:"#111827"},children:t}),r&&n.jsx("div",{style:{fontSize:10,color:"#6b7280",marginTop:2},children:r})]})}const rw=["TNT","DYS"];function aw(){const[e,t]=c.useState("TNT"),[r,a]=c.useState("2022"),[i,s]=c.useState([]),[o,l]=c.useState(!1),[d,f]=c.useState(null);c.useEffect(()=>{u()},[]);async function u(){l(!0),f(null);try{const g=new URLSearchParams;g.append("companyType",e),g.append("fromYear",r||"2022");const b=await fetch(`/api/v1/analysis/price-sim?${g.toString()}`);if(!b.ok)throw new Error(`HTTP ${b.status}`);const y=await b.json();if(y.error)throw new Error(y.error);const A=Array.isArray(y.data)?y.data.map(C=>({salesYear:Number(C.salesYear??C.salesyear??0),salesUnit:String(C.salesUnit??C.salesunit??"미지정"),empName:String(C.empName??C.empname??"미지정"),totalQty:C.totalQty??C.totalqty,totalAmt:C.totalAmt??C.totalamt,avgPrice:C.avgPrice??C.avgprice??null})):[];s(A)}catch(g){f((g==null?void 0:g.message)||"조회 실패"),s([])}finally{l(!1)}}const h=c.useMemo(()=>Array.from(new Set(i.map(g=>g.salesYear))).sort((g,b)=>b-g),[i]),m=c.useMemo(()=>{const g=new Map;for(const y of i){const A=y.salesUnit||"미지정",C=A,N=y.salesYear;g.has(C)||g.set(C,{salesUnit:A,yearAmt:{},yearQty:{}});const w=g.get(C);w.yearAmt[N]=(w.yearAmt[N]||0)+(Number(y.totalAmt)||0),w.yearQty[N]=(w.yearQty[N]||0)+(Number(y.totalQty)||0)}const b=[];for(const{salesUnit:y,yearAmt:A,yearQty:C}of g.values()){const N={};h.forEach(w=>{const M=A[w]||0,O=C[w]||0;N[w]=O>0?M/O:null}),b.push({salesUnit:y,yearly:N})}return b.sort((y,A)=>{const C=y.salesUnit==="미지정",N=A.salesUnit==="미지정";return C&&!N?1:!C&&N?-1:y.salesUnit.localeCompare(A.salesUnit)})},[i,h]),p=c.useMemo(()=>{const g=i.reduce((A,C)=>A+(Number(C.totalAmt)||0),0),b=i.reduce((A,C)=>A+(Number(C.totalQty)||0),0),y=b>0?g/b:0;return{totalAmt:g,totalQty:b,avgPrice:y}},[i]),x=g=>{if(g==null||g==="")return"-";const b=Number(g);return Number.isFinite(b)?b.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(g)},v=g=>{if(g==null||g==="")return"-";const b=Number(g);return Number.isFinite(b)?b.toLocaleString("ko-KR",{maximumFractionDigits:1,minimumFractionDigits:1}):String(g)};return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[n.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:"판매단가 Sim (영업관리단위)"}),n.jsx("p",{style:{margin:"4px 0 0 0",color:"#6b7280",fontSize:14},children:"영업관리단위별 연도별 평균단가 (직원 합산)"}),n.jsxs("div",{style:{marginTop:20,display:"flex",gap:12,alignItems:"flex-end"},children:[n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"회사 구분"}),n.jsx("div",{style:{background:"#f3f4f6",padding:4,borderRadius:8,display:"inline-flex",gap:2},children:rw.map(g=>n.jsx("button",{onClick:()=>t(g),style:{background:e===g?"#fff":"transparent",border:"none",padding:"8px 16px",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer",color:e===g?"#111827":"#6b7280",boxShadow:e===g?"0 1px 2px rgba(0,0,0,0.1)":"none",transition:"all 0.2s"},children:g},g))})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"#6b7280",fontWeight:500},children:"시작 연도"}),n.jsx("input",{className:"input",type:"number",min:2e3,max:new Date().getFullYear(),value:r,onChange:g=>a(g.target.value),style:{width:100,padding:"8px 12px",borderRadius:6,border:"1px solid #d1d5db",fontSize:13,textAlign:"center",color:"#111827",background:"#fff"}})]}),n.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:[n.jsxs("button",{onClick:()=>{t("TNT"),a("2022"),s([]),f(null)},style:{background:"#f3f4f6",border:"none",padding:"8px 16px",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer",color:"#6b7280",display:"flex",alignItems:"center",gap:6},children:[n.jsx(Ej,{size:14}),"초기화"]}),n.jsxs("button",{onClick:u,disabled:o,style:{background:o?"#93c5fd":"#3b82f6",border:"none",padding:"8px 20px",borderRadius:6,fontSize:13,fontWeight:600,cursor:o?"not-allowed":"pointer",color:"#fff",display:"flex",alignItems:"center",gap:6},children:[n.jsx(Ai,{size:14}),o?"조회 중...":"분석 실행"]})]})]}),i.length>0&&n.jsxs("div",{style:{marginTop:20,display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:16},children:[n.jsx(Jl,{title:"총 판매 수량",value:x(p.totalQty),subtext:"전체 기간 합계",color:"#10b981"}),n.jsx(Jl,{title:"총 판매 금액",value:x(p.totalAmt),subtext:"원화 기준",color:"#f59e0b"}),n.jsx(Jl,{title:"평균 판매 단가",value:v(p.avgPrice),subtext:"금액 ÷ 수량",color:"#8b5cf6"})]})]}),n.jsx("div",{style:{flex:1,padding:24,overflow:"hidden"},children:n.jsx("div",{className:"card",style:{height:"100%",display:"flex",flexDirection:"column",overflow:"auto",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:d?n.jsx("div",{style:{padding:40,textAlign:"center",color:"#ef4444"},children:d}):m.length===0?n.jsx("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:"조건을 선택하고 분석을 실행하세요"}):n.jsx("div",{style:{overflow:"auto",flex:1,padding:16},children:n.jsxs("table",{className:"table",style:{width:"100%",borderCollapse:"collapse"},children:[n.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:10},children:n.jsxs("tr",{children:[n.jsx("th",{style:{padding:"12px 16px",textAlign:"left",fontSize:12,color:"#6b7280",width:200},children:"영업관리단위"}),h.map(g=>n.jsxs("th",{style:{padding:"12px 16px",textAlign:"right",fontSize:12,color:"#6b7280"},children:[g,"년 평균단가"]},g))]})}),n.jsx("tbody",{children:m.map((g,b)=>n.jsxs("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:[n.jsx("td",{style:{padding:"12px 16px",fontWeight:600,color:"#111827"},children:g.salesUnit}),h.map(y=>n.jsx("td",{style:{padding:"12px 16px",textAlign:"right",fontWeight:600,color:"#111827"},children:v(g.yearly[y])},y))]},g.salesUnit+b))})]})})})})]})}function Jl({title:e,value:t,subtext:r,color:a}){return n.jsxs("div",{style:{background:"#fff",border:"1px solid #e5e7eb",borderRadius:12,padding:20,transition:"all 0.2s"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"start",marginBottom:8},children:[n.jsx("span",{style:{fontSize:14,color:"#6b7280",fontWeight:500},children:e}),n.jsx("span",{style:{color:a},children:n.jsx(Ai,{size:20})})]}),n.jsx("div",{style:{fontSize:22,fontWeight:700,color:"#111827"},children:t}),r&&n.jsx("div",{style:{fontSize:12,color:"#6b7280",marginTop:4},children:r})]})}function iw(){const[e,t]=c.useState(""),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState([]),[d,f]=c.useState(!1),[u,h]=c.useState(!1),[m,p]=c.useState(null);c.useEffect(()=>{x()},[]);const x=async()=>{f(!0);try{const b=await fetch("/api/v1/nl2sql/schema");if(!b.ok)throw new Error(`HTTP ${b.status}`);const y=await b.json();y.error?p(y.error):l(y.tables||[])}catch(b){p(b.message||"스키마 조회 실패")}finally{f(!1)}},v=async b=>{if(b.preventDefault(),!!e.trim()){a(!0),p(null),s(null);try{const y=await fetch("/api/v1/nl2sql/query",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e.trim()})});if(!y.ok)throw new Error(`HTTP ${y.status}`);const A=await y.json();A.error?(p(A.error),A.sql&&s({...A,results:[],rowCount:0})):s(A)}catch(y){p(y.message||"쿼리 실행 실패")}finally{a(!1)}}},g=["2024년 총 매출액은?","영업사원별 매출 TOP 10","최근 3개월 신규 고객 수","제품별 판매 수량 합계"];return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[n.jsxs("div",{children:[n.jsx("h1",{style:{margin:0,fontSize:24,fontWeight:700,color:"#111827"},children:"VIBE Workspace"}),n.jsx("p",{style:{margin:"6px 0 0",color:"#6b7280",fontSize:14},children:"자연어로 데이터베이스에 질문하세요"})]}),n.jsxs("button",{onClick:()=>h(!u),style:{display:"flex",alignItems:"center",gap:6,padding:"8px 16px",background:u?"#3b82f6":"#fff",color:u?"#fff":"#374151",border:"1px solid #d1d5db",borderRadius:6,fontSize:13,fontWeight:500,cursor:"pointer"},children:[n.jsx(mj,{size:16}),u?"스키마 숨기기":"스키마 보기"]})]}),n.jsx("form",{onSubmit:v,style:{marginTop:16},children:n.jsxs("div",{style:{display:"flex",gap:12},children:[n.jsxs("div",{style:{flex:1,position:"relative"},children:[n.jsx(ya,{size:18,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}}),n.jsx("input",{type:"text",value:e,onChange:b=>t(b.target.value),placeholder:"예: 2024년 총 매출액은 얼마인가요?",disabled:r,style:{width:"100%",padding:"12px 12px 12px 40px",border:"1px solid #d1d5db",borderRadius:8,fontSize:14,color:"#111827",background:"#fff"}})]}),n.jsx("button",{type:"submit",disabled:r||!e.trim(),style:{padding:"12px 24px",background:r||!e.trim()?"#93c5fd":"#3b82f6",color:"#fff",border:"none",borderRadius:8,fontSize:14,fontWeight:600,cursor:r||!e.trim()?"not-allowed":"pointer",display:"flex",alignItems:"center",gap:8},children:r?n.jsxs(n.Fragment,{children:[n.jsx(zf,{size:16,style:{animation:"spin 1s linear infinite"}}),"분석 중..."]}):"질문하기"})]})}),n.jsxs("div",{style:{marginTop:12,display:"flex",gap:8,flexWrap:"wrap"},children:[n.jsx("span",{style:{fontSize:12,color:"#6b7280",alignSelf:"center"},children:"예시:"}),g.map((b,y)=>n.jsx("button",{onClick:()=>t(b),disabled:r,style:{padding:"4px 12px",background:"#f3f4f6",color:"#374151",border:"1px solid #e5e7eb",borderRadius:6,fontSize:12,cursor:"pointer"},children:b},y))]})]}),n.jsxs("div",{style:{flex:1,padding:24,overflow:"auto",display:"flex",gap:16},children:[u&&n.jsxs("div",{className:"card",style:{width:320,flexShrink:0,overflow:"auto",padding:16,background:"#fff"},children:[n.jsx("h3",{style:{margin:"0 0 12px",fontSize:16,fontWeight:600,color:"#111827"},children:"데이터베이스 스키마"}),d?n.jsx("div",{style:{textAlign:"center",padding:20,color:"#6b7280"},children:n.jsx(zf,{size:24,style:{animation:"spin 1s linear infinite"}})}):o.length===0?n.jsx("div",{style:{textAlign:"center",padding:20,color:"#6b7280",fontSize:13},children:"스키마 정보 없음"}):n.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:o.map((b,y)=>n.jsxs("details",{style:{background:"#f9fafb",padding:8,borderRadius:6},children:[n.jsxs("summary",{style:{cursor:"pointer",fontWeight:500,fontSize:13,color:"#374151",marginBottom:8},children:[b.schema,".",b.name]}),n.jsx("div",{style:{paddingLeft:12,fontSize:12,color:"#6b7280"},children:b.columns.map((A,C)=>n.jsxs("div",{style:{marginBottom:6,display:"flex",flexDirection:"column",gap:2},children:[n.jsxs("div",{children:[n.jsx("span",{style:{color:"#111827",fontWeight:500},children:A.name}),n.jsxs("span",{style:{color:"#9ca3af"},children:[" (",A.type,")"]})]}),A.description&&n.jsx("div",{style:{fontSize:11,color:"#3b82f6",fontWeight:500},children:A.description})]},C))})]},y))})]}),n.jsx("div",{className:"card",style:{flex:1,display:"flex",flexDirection:"column",background:"#fff"},children:m?n.jsxs("div",{style:{padding:40,textAlign:"center"},children:[n.jsx(vd,{size:48,style:{color:"#ef4444",marginBottom:12}}),n.jsx("div",{style:{color:"#ef4444",fontSize:16,fontWeight:600},children:m})]}):i?n.jsxs("div",{style:{padding:16,display:"flex",flexDirection:"column",gap:16,flex:1,overflow:"hidden"},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:12,background:"#f0fdf4",borderRadius:8},children:[n.jsx(cj,{size:20,style:{color:"#22c55e"}}),n.jsxs("div",{children:[n.jsx("div",{style:{fontSize:14,fontWeight:600,color:"#166534"},children:"쿼리 실행 완료"}),n.jsxs("div",{style:{fontSize:12,color:"#15803d",marginTop:2},children:[i.rowCount,"개의 결과를 찾았습니다"]})]})]}),n.jsxs("div",{children:[n.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6},children:"생성된 SQL:"}),n.jsx("pre",{style:{background:"#1f2937",color:"#f3f4f6",padding:12,borderRadius:6,fontSize:12,overflow:"auto",margin:0},children:i.sql})]}),i.results.length>0&&n.jsxs("div",{style:{flex:1,overflow:"auto"},children:[n.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:8},children:"결과:"}),n.jsx("div",{style:{overflow:"auto",border:"1px solid #e5e7eb",borderRadius:6},children:n.jsxs("table",{className:"table",style:{width:"100%",fontSize:13},children:[n.jsx("thead",{style:{position:"sticky",top:0,background:"#f9fafb",zIndex:1},children:n.jsx("tr",{children:Object.keys(i.results[0]).map(b=>n.jsx("th",{style:{padding:"10px 12px",textAlign:"left",fontWeight:600,color:"#374151"},children:b},b))})}),n.jsx("tbody",{children:i.results.map((b,y)=>n.jsx("tr",{style:{borderBottom:"1px solid #f3f4f6"},children:Object.values(b).map((A,C)=>n.jsx("td",{style:{padding:"10px 12px",color:"#6b7280"},children:A==null?n.jsx("span",{style:{color:"#d1d5db",fontStyle:"italic"},children:"null"}):typeof A=="object"?JSON.stringify(A):String(A)},C))},y))})]})})]})]}):n.jsxs("div",{style:{padding:40,textAlign:"center",color:"#9ca3af"},children:[n.jsx(Oj,{size:64,style:{margin:"0 auto 16px",color:"#d1d5db"}}),n.jsx("div",{style:{fontSize:16,fontWeight:500,marginBottom:8},children:"질문을 입력하세요"}),n.jsx("div",{style:{fontSize:14},children:"자연어로 데이터베이스에 질문하면 자동으로 SQL을 생성하여 실행합니다"})]})})]}),n.jsx("style",{children:`
        @keyframes spin {
          from { transform: rotate(0deg); }
          to { transform: rotate(360deg); }
        }
      `})]})}function sw(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState([]),[d,f]=c.useState([]),[u,h]=c.useState("all"),[m,p]=c.useState("all"),[x,v]=c.useState(""),[g,b]=c.useState("all"),[y,A]=c.useState("all"),[C,N]=c.useState("latest"),[w,M]=c.useState({totalAr:0,overdueAr:0,overdueCount:0,aging30Ar:0,aging30Count:0,normalAr:0}),O=async()=>{try{const I=await fetch("/api/v1/credit/sales-reps");if(!I.ok)throw new Error(`API 호출 실패: ${I.status}`);const $=await I.json();l($.salesReps||[])}catch(I){console.error("영업사원 목록 조회 실패:",I)}},D=async()=>{try{const I=await fetch("/api/v1/credit/snapshot-dates");if(!I.ok)throw new Error(`API 호출 실패: ${I.status}`);const $=await I.json();f($.dates||[])}catch(I){console.error("채권검토일 목록 조회 실패:",I)}},W=async()=>{a(!0),s(null);try{const I=new URLSearchParams;u!=="all"&&I.append("company",u),m!=="all"&&I.append("salesRep",m),x&&I.append("customerName",x),g!=="all"&&I.append("riskLevel",g),y!=="all"&&I.append("agingBucket",y),C!=="latest"&&I.append("snapshotDate",C),console.log("AR Aging 조회 요청:",I.toString());const $=await fetch(`/api/v1/credit/ar-aging?${I.toString()}`);if(!$.ok)throw new Error(`API 호출 실패: ${$.status}`);const J=await $.json();console.log("AR Aging 조회 응답:",J);const q=(J.items||[]).map(E=>({customerSeq:E.customer_seq,customerCode:E.customer_no,customerName:E.customer_name,companyType:E.company_type,salesRep:E.emp_name,department:E.dept_name,totalAr:E.total_ar,overdue:E.overdue,aging030:E.aging_0_30,aging3160:E.aging_31_60,aging6190:E.aging_61_90,aging91120:E.aging_91_120,aging121150:E.aging_121_150,aging151180:E.aging_151_180,aging181210:E.aging_181_210,aging211240:E.aging_211_240,aging241270:E.aging_241_270,aging271300:E.aging_271_300,aging301330:E.aging_301_330,aging331365:E.aging_331_365,agingOver365:E.aging_over_365,riskLevel:E.riskLevel,lastCollectionDate:E.last_collection_date}));t(q);const K=q.filter(E=>E.riskLevel==="high"),L=q.filter(E=>E.riskLevel==="medium"),ee=q.filter(E=>E.riskLevel==="low");M({totalAr:q.reduce((E,T)=>E+(T.totalAr||0),0),overdueAr:q.reduce((E,T)=>E+(T.overdue||0),0),overdueCount:K.length,aging30Ar:q.reduce((E,T)=>E+(T.aging030||0),0),aging30Count:ee.length,normalAr:q.reduce((E,T)=>E+(T.aging030||0),0)})}catch(I){console.error("AR Aging 조회 실패:",I),s(I.message||"데이터 조회 중 오류가 발생했습니다.")}finally{a(!1)}};c.useEffect(()=>{O(),D(),W()},[]);const j=I=>{if(I==null||I==="")return"-";const $=Number(I);return Number.isFinite($)?`₩${$.toLocaleString("ko-KR")}`:String(I)},S=I=>I==="TNT"?n.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,background:"#3b82f6",color:"white",borderRadius:4,fontSize:11,fontWeight:700,marginRight:6},children:"T"}):I==="DYS"?n.jsx("span",{style:{display:"inline-flex",alignItems:"center",justifyContent:"center",width:20,height:20,background:"#10b981",color:"white",borderRadius:4,fontSize:11,fontWeight:700,marginRight:6},children:"D"}):null,R=I=>I==="high"?n.jsx("span",{style:{padding:"2px 8px",background:"#ef4444",color:"white",borderRadius:4,fontSize:11},children:"고위험"}):I==="medium"?n.jsx("span",{style:{padding:"2px 8px",background:"#f59e0b",color:"white",borderRadius:4,fontSize:11},children:"중위험"}):I==="low"?n.jsx("span",{style:{padding:"2px 8px",background:"#10b981",color:"white",borderRadius:4,fontSize:11},children:"저위험"}):n.jsx("span",{style:{padding:"2px 8px",background:"#6b7280",color:"white",borderRadius:4,fontSize:11},children:"-"});return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[n.jsxs("div",{style:{marginBottom:24,display:"flex",alignItems:"baseline",gap:12,justifyContent:"space-between"},children:[n.jsxs("div",{children:[n.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"연체채권 현황"}),n.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"거래처별 채권 연령 분석 및 리스크 관리"})]}),n.jsxs("div",{style:{padding:"8px 12px",background:"#f3f4f6",borderRadius:6,fontSize:12,color:"#4b5563"},children:[n.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"위험도 분류 기준 (연체비율)"}),n.jsxs("div",{style:{display:"flex",gap:12},children:[n.jsxs("span",{children:[n.jsx("span",{style:{color:"#ef4444",fontWeight:600},children:"고위험"}),": 30% 초과"]}),n.jsxs("span",{children:[n.jsx("span",{style:{color:"#f59e0b",fontWeight:600},children:"중위험"}),": 10~30%"]}),n.jsxs("span",{children:[n.jsx("span",{style:{color:"#10b981",fontWeight:600},children:"저위험"}),": 10% 이하"]})]}),n.jsx("div",{style:{fontSize:11,color:"#6b7280",marginTop:2},children:"※ 연체비율 = 30일 초과 연체액 / 총채권액"})]})]}),n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",marginBottom:20},children:[n.jsxs("select",{className:"search-input",value:C,onChange:I=>N(I.target.value),style:{width:150},children:[n.jsx("option",{value:"latest",children:"최신 채권검토일"}),d.map(I=>n.jsx("option",{value:I,children:I},I))]}),n.jsxs("select",{className:"search-input",value:u,onChange:I=>h(I.target.value),style:{width:120},children:[n.jsx("option",{value:"all",children:"전체 회사"}),n.jsx("option",{value:"TNT",children:"TNT"}),n.jsx("option",{value:"DYS",children:"DYS"})]}),n.jsxs("select",{className:"search-input",value:m,onChange:I=>p(I.target.value),style:{width:150},children:[n.jsx("option",{value:"all",children:"전체 영업사원"}),o.map(I=>n.jsx("option",{value:I,children:I},I))]}),n.jsx("input",{type:"text",className:"search-input",value:x,onChange:I=>v(I.target.value),placeholder:"거래처명 검색",style:{width:150}}),n.jsxs("select",{className:"search-input",value:g,onChange:I=>b(I.target.value),style:{width:120},children:[n.jsx("option",{value:"all",children:"전체 위험도"}),n.jsx("option",{value:"high",children:"고위험"}),n.jsx("option",{value:"medium",children:"중위험"}),n.jsx("option",{value:"low",children:"저위험"})]}),n.jsxs("select",{className:"search-input",value:y,onChange:I=>A(I.target.value),style:{width:120},children:[n.jsx("option",{value:"all",children:"전체 구간"}),n.jsx("option",{value:"0-30",children:"0-30일 이내"}),n.jsx("option",{value:"31-60",children:"1개월 이내"}),n.jsx("option",{value:"61-90",children:"2개월 이내"}),n.jsx("option",{value:"91-120",children:"3개월 이내"}),n.jsx("option",{value:"121-150",children:"4개월 이내"}),n.jsx("option",{value:"151-180",children:"5개월 이내"}),n.jsx("option",{value:"181-210",children:"6개월 이내"}),n.jsx("option",{value:"211-240",children:"7개월 이내"}),n.jsx("option",{value:"241-270",children:"8개월 이내"}),n.jsx("option",{value:"271-300",children:"9개월 이내"}),n.jsx("option",{value:"301-330",children:"10개월 이내"}),n.jsx("option",{value:"331-365",children:"11개월 이내"}),n.jsx("option",{value:"over-365",children:"12개월 초과"})]}),n.jsx("div",{style:{display:"flex",gap:8,marginLeft:"auto"},children:n.jsx("button",{className:"btn",onClick:W,disabled:r,style:{height:30,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",whiteSpace:"nowrap"},children:r?"조회 중...":"조회"})})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[n.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #3b82f6"},children:[n.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"총채권액"}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:j(w.totalAr)})]}),n.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #ef4444"},children:[n.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:["만기도과 (",w.overdueCount,"건)"]}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#ef4444"},children:j(w.overdueAr)})]}),n.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #f59e0b"},children:[n.jsxs("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:["30일 이내 (",w.aging30Count,"건)"]}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#f59e0b"},children:j(w.aging30Ar)})]}),n.jsxs("div",{className:"card",style:{padding:16,borderTop:"3px solid #10b981"},children:[n.jsx("div",{style:{fontSize:12,color:"#6b7280",marginBottom:4},children:"정상채권"}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#10b981"},children:j(w.normalAr)})]})]})]}),n.jsx("div",{style:{flex:1,overflow:"auto",padding:24},children:i?n.jsx("div",{style:{padding:16,color:"#ef4444"},children:i}):e.length===0?n.jsx("div",{className:"empty-state",children:"조회된 데이터가 없습니다"}):n.jsx("div",{className:"card",style:{overflow:"auto",height:"100%"},children:n.jsxs("table",{className:"table",style:{fontSize:12},children:[n.jsx("thead",{children:n.jsxs("tr",{children:[n.jsx("th",{style:{width:40,textAlign:"center",position:"sticky",top:0,background:"#fff",zIndex:10},children:"#"}),n.jsx("th",{style:{width:80,position:"sticky",top:0,background:"#fff",zIndex:10},children:"위험도"}),n.jsx("th",{style:{minWidth:250,position:"sticky",top:0,background:"#fff",zIndex:10},children:"거래처 정보"}),n.jsx("th",{style:{minWidth:120,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"총채권액"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"0-30일"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"1개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"2개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"3개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"4개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"5개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"6개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"7개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"8개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"9개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"10개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"11개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"12개월"}),n.jsx("th",{style:{minWidth:100,textAlign:"right",position:"sticky",top:0,background:"#fff",zIndex:10},children:"12개월+"}),n.jsx("th",{style:{minWidth:100,textAlign:"center",position:"sticky",top:0,background:"#fff",zIndex:10},children:"액션"})]})}),n.jsx("tbody",{children:e.map((I,$)=>n.jsxs("tr",{style:{cursor:"pointer"},children:[n.jsx("td",{style:{textAlign:"center",color:"var(--muted)"},children:$+1}),n.jsx("td",{children:R(I.riskLevel||"")}),n.jsx("td",{children:n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[S(I.companyType||""),n.jsx("span",{style:{fontWeight:600,fontSize:13},children:I.customerName||"-"})]}),n.jsxs("div",{style:{fontSize:11,color:"#6b7280",display:"flex",gap:8,flexWrap:"wrap"},children:[n.jsxs("span",{children:["코드: ",I.customerCode||"-"]}),n.jsxs("span",{children:["영업: ",I.salesRep||"-"]}),n.jsxs("span",{children:["부서: ",I.department||"-"]})]})]})}),n.jsx("td",{style:{textAlign:"right",fontWeight:600},children:j(I.totalAr)}),n.jsx("td",{style:{textAlign:"right"},children:j(I.aging030)}),n.jsx("td",{style:{textAlign:"right"},children:j(I.aging3160)}),n.jsx("td",{style:{textAlign:"right"},children:j(I.aging6190)}),n.jsx("td",{style:{textAlign:"right"},children:j(I.aging91120)}),n.jsx("td",{style:{textAlign:"right"},children:j(I.aging121150)}),n.jsx("td",{style:{textAlign:"right"},children:j(I.aging151180)}),n.jsx("td",{style:{textAlign:"right"},children:j(I.aging181210)}),n.jsx("td",{style:{textAlign:"right"},children:j(I.aging211240)}),n.jsx("td",{style:{textAlign:"right"},children:j(I.aging241270)}),n.jsx("td",{style:{textAlign:"right"},children:j(I.aging271300)}),n.jsx("td",{style:{textAlign:"right"},children:j(I.aging301330)}),n.jsx("td",{style:{textAlign:"right"},children:j(I.aging331365)}),n.jsx("td",{style:{textAlign:"right"},children:j(I.agingOver365)}),n.jsx("td",{style:{textAlign:"center"},children:n.jsx("button",{className:"btn btn-sm",onClick:J=>{J.stopPropagation(),alert("거래처 상세 패널 구현 예정")},children:"상세"})})]},$))})]})})})]})}function lg(e){var t,r,a="";if(typeof e=="string"||typeof e=="number")a+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=lg(e[t]))&&(a&&(a+=" "),a+=r)}else for(r in e)e[r]&&(a&&(a+=" "),a+=r);return a}function et(){for(var e,t,r=0,a="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=lg(e))&&(a&&(a+=" "),a+=t);return a}var ow=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function jd(e){if(typeof e!="string")return!1;var t=ow;return t.includes(e)}var lw=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function cg(e){if(typeof e!="string")return!1;var t=lw;return t.includes(e)}function dg(e){return typeof e=="string"&&e.startsWith("data-")}function Tn(e){var t=Object.entries(e).filter(r=>{var[a]=r;return cg(a)||dg(a)});return Object.fromEntries(t)}function va(e){if(e==null)return null;if(c.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return Tn(t)}return typeof e=="object"&&!Array.isArray(e)?Tn(e):null}function yn(e){var t=Object.entries(e).filter(r=>{var[a]=r;return cg(a)||dg(a)||jd(a)});return Object.fromEntries(t)}function cw(e){return e==null?null:c.isValidElement(e)?yn(e.props):typeof e=="object"&&!Array.isArray(e)?yn(e):null}var dw=["children","width","height","viewBox","className","style","title","desc"];function wc(){return wc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},wc.apply(null,arguments)}function uw(e,t){if(e==null)return{};var r,a,i=fw(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function fw(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var ug=c.forwardRef((e,t)=>{var{children:r,width:a,height:i,viewBox:s,className:o,style:l,title:d,desc:f}=e,u=uw(e,dw),h=s||{width:a,height:i,x:0,y:0},m=et("recharts-surface",o);return c.createElement("svg",wc({},yn(u),{className:m,width:a,height:i,style:l,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:t}),c.createElement("title",null,d),c.createElement("desc",null,f),r)}),hw=["children","className"];function Sc(){return Sc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Sc.apply(null,arguments)}function mw(e,t){if(e==null)return{};var r,a,i=pw(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function pw(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Zt=c.forwardRef((e,t)=>{var{children:r,className:a}=e,i=mw(e,hw),s=et("recharts-layer",a);return c.createElement("g",Sc({className:s},yn(i),{ref:t}),r)}),gw=c.createContext(null);function mt(e){return function(){return e}}const fg=Math.cos,Us=Math.sin,Jn=Math.sqrt,Hs=Math.PI,zo=2*Hs,Nc=Math.PI,kc=2*Nc,oa=1e-6,yw=kc-oa;function hg(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function vw(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return hg;const r=10**t;return function(a){this._+=a[0];for(let i=1,s=a.length;i<s;++i)this._+=Math.round(arguments[i]*r)/r+a[i]}}class xw{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?hg:vw(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,a,i){this._append`Q${+t},${+r},${this._x1=+a},${this._y1=+i}`}bezierCurveTo(t,r,a,i,s,o){this._append`C${+t},${+r},${+a},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(t,r,a,i,s){if(t=+t,r=+r,a=+a,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,l=this._y1,d=a-t,f=i-r,u=o-t,h=l-r,m=u*u+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(m>oa)if(!(Math.abs(h*d-f*u)>oa)||!s)this._append`L${this._x1=t},${this._y1=r}`;else{let p=a-o,x=i-l,v=d*d+f*f,g=p*p+x*x,b=Math.sqrt(v),y=Math.sqrt(m),A=s*Math.tan((Nc-Math.acos((v+m-g)/(2*b*y)))/2),C=A/y,N=A/b;Math.abs(C-1)>oa&&this._append`L${t+C*u},${r+C*h}`,this._append`A${s},${s},0,0,${+(h*p>u*x)},${this._x1=t+N*d},${this._y1=r+N*f}`}}arc(t,r,a,i,s,o){if(t=+t,r=+r,a=+a,o=!!o,a<0)throw new Error(`negative radius: ${a}`);let l=a*Math.cos(i),d=a*Math.sin(i),f=t+l,u=r+d,h=1^o,m=o?i-s:s-i;this._x1===null?this._append`M${f},${u}`:(Math.abs(this._x1-f)>oa||Math.abs(this._y1-u)>oa)&&this._append`L${f},${u}`,a&&(m<0&&(m=m%kc+kc),m>yw?this._append`A${a},${a},0,1,${h},${t-l},${r-d}A${a},${a},0,1,${h},${this._x1=f},${this._y1=u}`:m>oa&&this._append`A${a},${a},0,${+(m>=Nc)},${h},${this._x1=t+a*Math.cos(s)},${this._y1=r+a*Math.sin(s)}`)}rect(t,r,a,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${a=+a}v${+i}h${-a}Z`}toString(){return this._}}function wd(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const a=Math.floor(r);if(!(a>=0))throw new RangeError(`invalid digits: ${r}`);t=a}return e},()=>new xw(t)}function Sd(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function mg(e){this._context=e}mg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Wo(e){return new mg(e)}function pg(e){return e[0]}function gg(e){return e[1]}function yg(e,t){var r=mt(!0),a=null,i=Wo,s=null,o=wd(l);e=typeof e=="function"?e:e===void 0?pg:mt(e),t=typeof t=="function"?t:t===void 0?gg:mt(t);function l(d){var f,u=(d=Sd(d)).length,h,m=!1,p;for(a==null&&(s=i(p=o())),f=0;f<=u;++f)!(f<u&&r(h=d[f],f,d))===m&&((m=!m)?s.lineStart():s.lineEnd()),m&&s.point(+e(h,f,d),+t(h,f,d));if(p)return s=null,p+""||null}return l.x=function(d){return arguments.length?(e=typeof d=="function"?d:mt(+d),l):e},l.y=function(d){return arguments.length?(t=typeof d=="function"?d:mt(+d),l):t},l.defined=function(d){return arguments.length?(r=typeof d=="function"?d:mt(!!d),l):r},l.curve=function(d){return arguments.length?(i=d,a!=null&&(s=i(a)),l):i},l.context=function(d){return arguments.length?(d==null?a=s=null:s=i(a=d),l):a},l}function Ns(e,t,r){var a=null,i=mt(!0),s=null,o=Wo,l=null,d=wd(f);e=typeof e=="function"?e:e===void 0?pg:mt(+e),t=typeof t=="function"?t:mt(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?gg:mt(+r);function f(h){var m,p,x,v=(h=Sd(h)).length,g,b=!1,y,A=new Array(v),C=new Array(v);for(s==null&&(l=o(y=d())),m=0;m<=v;++m){if(!(m<v&&i(g=h[m],m,h))===b)if(b=!b)p=m,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),x=m-1;x>=p;--x)l.point(A[x],C[x]);l.lineEnd(),l.areaEnd()}b&&(A[m]=+e(g,m,h),C[m]=+t(g,m,h),l.point(a?+a(g,m,h):A[m],r?+r(g,m,h):C[m]))}if(y)return l=null,y+""||null}function u(){return yg().defined(i).curve(o).context(s)}return f.x=function(h){return arguments.length?(e=typeof h=="function"?h:mt(+h),a=null,f):e},f.x0=function(h){return arguments.length?(e=typeof h=="function"?h:mt(+h),f):e},f.x1=function(h){return arguments.length?(a=h==null?null:typeof h=="function"?h:mt(+h),f):a},f.y=function(h){return arguments.length?(t=typeof h=="function"?h:mt(+h),r=null,f):t},f.y0=function(h){return arguments.length?(t=typeof h=="function"?h:mt(+h),f):t},f.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:mt(+h),f):r},f.lineX0=f.lineY0=function(){return u().x(e).y(t)},f.lineY1=function(){return u().x(e).y(r)},f.lineX1=function(){return u().x(a).y(t)},f.defined=function(h){return arguments.length?(i=typeof h=="function"?h:mt(!!h),f):i},f.curve=function(h){return arguments.length?(o=h,s!=null&&(l=o(s)),f):o},f.context=function(h){return arguments.length?(h==null?s=l=null:l=o(s=h),f):s},f}class vg{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function bw(e){return new vg(e,!0)}function jw(e){return new vg(e,!1)}const Nd={draw(e,t){const r=Jn(t/Hs);e.moveTo(r,0),e.arc(0,0,r,0,zo)}},ww={draw(e,t){const r=Jn(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},xg=Jn(1/3),Sw=xg*2,Nw={draw(e,t){const r=Jn(t/Sw),a=r*xg;e.moveTo(0,-r),e.lineTo(a,0),e.lineTo(0,r),e.lineTo(-a,0),e.closePath()}},kw={draw(e,t){const r=Jn(t),a=-r/2;e.rect(a,a,r,r)}},Aw=.8908130915292852,bg=Us(Hs/10)/Us(7*Hs/10),Cw=Us(zo/10)*bg,Pw=-fg(zo/10)*bg,Ew={draw(e,t){const r=Jn(t*Aw),a=Cw*r,i=Pw*r;e.moveTo(0,-r),e.lineTo(a,i);for(let s=1;s<5;++s){const o=zo*s/5,l=fg(o),d=Us(o);e.lineTo(d*r,-l*r),e.lineTo(l*a-d*i,d*a+l*i)}e.closePath()}},Zl=Jn(3),Iw={draw(e,t){const r=-Jn(t/(Zl*3));e.moveTo(0,r*2),e.lineTo(-Zl*r,-r),e.lineTo(Zl*r,-r),e.closePath()}},Ln=-.5,Rn=Jn(3)/2,Ac=1/Jn(12),Tw=(Ac/2+1)*3,Ow={draw(e,t){const r=Jn(t/Tw),a=r/2,i=r*Ac,s=a,o=r*Ac+r,l=-s,d=o;e.moveTo(a,i),e.lineTo(s,o),e.lineTo(l,d),e.lineTo(Ln*a-Rn*i,Rn*a+Ln*i),e.lineTo(Ln*s-Rn*o,Rn*s+Ln*o),e.lineTo(Ln*l-Rn*d,Rn*l+Ln*d),e.lineTo(Ln*a+Rn*i,Ln*i-Rn*a),e.lineTo(Ln*s+Rn*o,Ln*o-Rn*s),e.lineTo(Ln*l+Rn*d,Ln*d-Rn*l),e.closePath()}};function _w(e,t){let r=null,a=wd(i);e=typeof e=="function"?e:mt(e||Nd),t=typeof t=="function"?t:mt(t===void 0?64:+t);function i(){let s;if(r||(r=s=a()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),s)return r=null,s+""||null}return i.type=function(s){return arguments.length?(e=typeof s=="function"?s:mt(s),i):e},i.size=function(s){return arguments.length?(t=typeof s=="function"?s:mt(+s),i):t},i.context=function(s){return arguments.length?(r=s??null,i):r},i}function Ks(){}function Ys(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function jg(e){this._context=e}jg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ys(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ys(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Mw(e){return new jg(e)}function wg(e){this._context=e}wg.prototype={areaStart:Ks,areaEnd:Ks,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Ys(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Dw(e){return new wg(e)}function Sg(e){this._context=e}Sg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,a=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,a):this._context.moveTo(r,a);break;case 3:this._point=4;default:Ys(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function $w(e){return new Sg(e)}function Ng(e){this._context=e}Ng.prototype={areaStart:Ks,areaEnd:Ks,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Lw(e){return new Ng(e)}function Zf(e){return e<0?-1:1}function eh(e,t,r){var a=e._x1-e._x0,i=t-e._x1,s=(e._y1-e._y0)/(a||i<0&&-0),o=(r-e._y1)/(i||a<0&&-0),l=(s*i+o*a)/(a+i);return(Zf(s)+Zf(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(l))||0}function th(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function ec(e,t,r){var a=e._x0,i=e._y0,s=e._x1,o=e._y1,l=(s-a)/3;e._context.bezierCurveTo(a+l,i+l*t,s-l,o-l*r,s,o)}function Gs(e){this._context=e}Gs.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ec(this,this._t0,th(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,ec(this,th(this,r=eh(this,e,t)),r);break;default:ec(this,this._t0,r=eh(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function kg(e){this._context=new Ag(e)}(kg.prototype=Object.create(Gs.prototype)).point=function(e,t){Gs.prototype.point.call(this,t,e)};function Ag(e){this._context=e}Ag.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,a,i,s){this._context.bezierCurveTo(t,e,a,r,s,i)}};function Rw(e){return new Gs(e)}function zw(e){return new kg(e)}function Cg(e){this._context=e}Cg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var a=nh(e),i=nh(t),s=0,o=1;o<r;++s,++o)this._context.bezierCurveTo(a[0][s],i[0][s],a[1][s],i[1][s],e[o],t[o]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function nh(e){var t,r=e.length-1,a,i=new Array(r),s=new Array(r),o=new Array(r);for(i[0]=0,s[0]=2,o[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,s[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,s[r-1]=7,o[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)a=i[t]/s[t-1],s[t]-=a,o[t]-=a*o[t-1];for(i[r-1]=o[r-1]/s[r-1],t=r-2;t>=0;--t)i[t]=(o[t]-i[t+1])/s[t];for(s[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)s[t]=2*e[t+1]-i[t+1];return[i,s]}function Ww(e){return new Cg(e)}function Bo(e,t){this._context=e,this._t=t}Bo.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function Bw(e){return new Bo(e,.5)}function Fw(e){return new Bo(e,0)}function qw(e){return new Bo(e,1)}function Ha(e,t){if((o=e.length)>1)for(var r=1,a,i,s=e[t[0]],o,l=s.length;r<o;++r)for(i=s,s=e[t[r]],a=0;a<l;++a)s[a][1]+=s[a][0]=isNaN(i[a][1])?i[a][0]:i[a][1]}function Cc(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Uw(e,t){return e[t]}function Hw(e){const t=[];return t.key=e,t}function Kw(){var e=mt([]),t=Cc,r=Ha,a=Uw;function i(s){var o=Array.from(e.apply(this,arguments),Hw),l,d=o.length,f=-1,u;for(const h of s)for(l=0,++f;l<d;++l)(o[l][f]=[0,+a(h,o[l].key,f,s)]).data=h;for(l=0,u=Sd(t(o));l<d;++l)o[u[l]].index=l;return r(o,u),o}return i.keys=function(s){return arguments.length?(e=typeof s=="function"?s:mt(Array.from(s)),i):e},i.value=function(s){return arguments.length?(a=typeof s=="function"?s:mt(+s),i):a},i.order=function(s){return arguments.length?(t=s==null?Cc:typeof s=="function"?s:mt(Array.from(s)),i):t},i.offset=function(s){return arguments.length?(r=s??Ha,i):r},i}function Yw(e,t){if((a=e.length)>0){for(var r,a,i=0,s=e[0].length,o;i<s;++i){for(o=r=0;r<a;++r)o+=e[r][i][1]||0;if(o)for(r=0;r<a;++r)e[r][i][1]/=o}Ha(e,t)}}function Gw(e,t){if((i=e.length)>0){for(var r=0,a=e[t[0]],i,s=a.length;r<s;++r){for(var o=0,l=0;o<i;++o)l+=e[o][r][1]||0;a[r][1]+=a[r][0]=-l/2}Ha(e,t)}}function Vw(e,t){if(!(!((o=e.length)>0)||!((s=(i=e[t[0]]).length)>0))){for(var r=0,a=1,i,s,o;a<s;++a){for(var l=0,d=0,f=0;l<o;++l){for(var u=e[t[l]],h=u[a][1]||0,m=u[a-1][1]||0,p=(h-m)/2,x=0;x<l;++x){var v=e[t[x]],g=v[a][1]||0,b=v[a-1][1]||0;p+=g-b}d+=h,f+=p*h}i[a-1][1]+=i[a-1][0]=r,d&&(r-=f/d)}i[a-1][1]+=i[a-1][0]=r,Ha(e,t)}}var Fo={},Pg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Pg);var kd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(kd);var qo={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var a;return typeof r=="string"||typeof r=="symbol"?r:Object.is((a=r==null?void 0:r.valueOf)==null?void 0:a.call(r),-0)?"-0":String(r)}e.toKey=t})(qo);var Uo={},Eg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const a=String(r);return a==="0"&&Object.is(Number(r),-0)?"-0":a}e.toString=t})(Eg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Eg,r=qo;function a(i){if(Array.isArray(i))return i.map(r.toKey);if(typeof i=="symbol")return[i];i=t.toString(i);const s=[],o=i.length;if(o===0)return s;let l=0,d="",f="",u=!1;for(i.charCodeAt(0)===46&&(s.push(""),l++);l<o;){const h=i[l];f?h==="\\"&&l+1<o?(l++,d+=i[l]):h===f?f="":d+=h:u?h==='"'||h==="'"?f=h:h==="]"?(u=!1,s.push(d),d=""):d+=h:h==="["?(u=!0,d&&(s.push(d),d="")):h==="."?d&&(s.push(d),d=""):d+=h,l++}return d&&s.push(d),s}e.toPath=a})(Uo);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Pg,r=kd,a=qo,i=Uo;function s(l,d,f){if(l==null)return f;switch(typeof d){case"string":{if(t.isUnsafeProperty(d))return f;const u=l[d];return u===void 0?r.isDeepKey(d)?s(l,i.toPath(d),f):f:u}case"number":case"symbol":{typeof d=="number"&&(d=a.toKey(d));const u=l[d];return u===void 0?f:u}default:{if(Array.isArray(d))return o(l,d,f);if(Object.is(d==null?void 0:d.valueOf(),-0)?d="-0":d=String(d),t.isUnsafeProperty(d))return f;const u=l[d];return u===void 0?f:u}}}function o(l,d,f){if(d.length===0)return f;let u=l;for(let h=0;h<d.length;h++){if(u==null||t.isUnsafeProperty(d[h]))return f;u=u[d[h]]}return u===void 0?f:u}e.get=s})(Fo);var Xw=Fo.get;const xa=Gr(Xw);var Jt=e=>e===0?0:e>0?1:-1,Qn=e=>typeof e=="number"&&e!=+e,Sr=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,_e=e=>(typeof e=="number"||e instanceof Number)&&!Qn(e),lr=e=>_e(e)||typeof e=="string",Qw=0,Ii=e=>{var t=++Qw;return"".concat(e||"").concat(t)},un=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!_e(t)&&typeof t!="string")return a;var s;if(Sr(t)){if(r==null)return a;var o=t.indexOf("%");s=r*parseFloat(t.slice(0,o))/100}else s=+t;return Qn(s)&&(s=a),i&&r!=null&&s>r&&(s=r),s},Ig=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},a=0;a<t;a++)if(!r[e[a]])r[e[a]]=!0;else return!0;return!1};function xt(e,t,r){return _e(e)&&_e(t)?e+r*(t-e):t}function Tg(e,t,r){if(!(!e||!e.length))return e.find(a=>a&&(typeof t=="function"?t(a):xa(a,t))===r)}var wt=e=>e===null||typeof e>"u",qi=e=>wt(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function Jw(e){return e!=null}function Aa(){}var Zw=["type","size","sizeType"];function Pc(){return Pc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Pc.apply(null,arguments)}function rh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function ah(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?rh(Object(r),!0).forEach(function(a){eS(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function eS(e,t,r){return(t=tS(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tS(e){var t=nS(e,"string");return typeof t=="symbol"?t:t+""}function nS(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rS(e,t){if(e==null)return{};var r,a,i=aS(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function aS(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Og={symbolCircle:Nd,symbolCross:ww,symbolDiamond:Nw,symbolSquare:kw,symbolStar:Ew,symbolTriangle:Iw,symbolWye:Ow},iS=Math.PI/180,sS=e=>{var t="symbol".concat(qi(e));return Og[t]||Nd},oS=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var a=18*iS;return 1.25*e*e*(Math.tan(a)-Math.tan(a*2)*Math.tan(a)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},lS=(e,t)=>{Og["symbol".concat(qi(e))]=t},_g=e=>{var{type:t="circle",size:r=64,sizeType:a="area"}=e,i=rS(e,Zw),s=ah(ah({},i),{},{type:t,size:r,sizeType:a}),o="circle";typeof t=="string"&&(o=t);var l=()=>{var m=sS(o),p=_w().type(m).size(oS(r,a,o)),x=p();if(x!==null)return x},{className:d,cx:f,cy:u}=s,h=yn(s);return _e(f)&&_e(u)&&_e(r)?c.createElement("path",Pc({},h,{className:et("recharts-symbols",d),transform:"translate(".concat(f,", ").concat(u,")"),d:l()})):null};_g.registerSymbol=lS;var Mg=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,Ad=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(c.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var a={};return Object.keys(r).forEach(i=>{jd(i)&&(a[i]=s=>r[i](r,s))}),a},cS=(e,t,r)=>a=>(e(t,r,a),null),Ho=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var a=null;return Object.keys(e).forEach(i=>{var s=e[i];jd(i)&&typeof s=="function"&&(a||(a={}),a[i]=cS(s,t,r))}),a};function ih(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function dS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ih(Object(r),!0).forEach(function(a){uS(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ih(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function uS(e,t,r){return(t=fS(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fS(e){var t=hS(e,"string");return typeof t=="symbol"?t:t+""}function hS(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function en(e,t){var r=dS({},e),a=t,i=Object.keys(t),s=i.reduce((o,l)=>(o[l]===void 0&&a[l]!==void 0&&(o[l]=a[l]),o),r);return s}var Dg={},$g={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a){const i=new Map;for(let s=0;s<r.length;s++){const o=r[s],l=a(o);i.has(l)||i.set(l,o)}return Array.from(i.values())}e.uniqBy=t})($g);var Cd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Cd);var Lg={},Ko={},Rg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Rg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Rg;function r(a){return a!=null&&typeof a!="function"&&t.isLength(a.length)}e.isArrayLike=r})(Ko);var zg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(zg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ko,r=zg;function a(i){return r.isObjectLike(i)&&t.isArrayLike(i)}e.isArrayLikeObject=a})(Lg);var Wg={},Bg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fo;function r(a){return function(i){return t.get(i,a)}}e.property=r})(Bg);var Fg={},Pd={},qg={},Ed={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Ed);var Id={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Id);var Td={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a){return r===a||Number.isNaN(r)&&Number.isNaN(a)}e.eq=t})(Td);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ed,r=Id,a=Td;function i(u,h,m){return typeof m!="function"?i(u,h,()=>{}):s(u,h,function p(x,v,g,b,y,A){const C=m(x,v,g,b,y,A);return C!==void 0?!!C:s(x,v,p,A)},new Map)}function s(u,h,m,p){if(h===u)return!0;switch(typeof h){case"object":return o(u,h,m,p);case"function":return Object.keys(h).length>0?s(u,{...h},m,p):a.eq(u,h);default:return t.isObject(u)?typeof h=="string"?h==="":!0:a.eq(u,h)}}function o(u,h,m,p){if(h==null)return!0;if(Array.isArray(h))return d(u,h,m,p);if(h instanceof Map)return l(u,h,m,p);if(h instanceof Set)return f(u,h,m,p);const x=Object.keys(h);if(u==null)return x.length===0;if(x.length===0)return!0;if(p!=null&&p.has(h))return p.get(h)===u;p==null||p.set(h,u);try{for(let v=0;v<x.length;v++){const g=x[v];if(!r.isPrimitive(u)&&!(g in u)||h[g]===void 0&&u[g]!==void 0||h[g]===null&&u[g]!==null||!m(u[g],h[g],g,u,h,p))return!1}return!0}finally{p==null||p.delete(h)}}function l(u,h,m,p){if(h.size===0)return!0;if(!(u instanceof Map))return!1;for(const[x,v]of h.entries()){const g=u.get(x);if(m(g,v,x,u,h,p)===!1)return!1}return!0}function d(u,h,m,p){if(h.length===0)return!0;if(!Array.isArray(u))return!1;const x=new Set;for(let v=0;v<h.length;v++){const g=h[v];let b=!1;for(let y=0;y<u.length;y++){if(x.has(y))continue;const A=u[y];let C=!1;if(m(A,g,v,u,h,p)&&(C=!0),C){x.add(y),b=!0;break}}if(!b)return!1}return!0}function f(u,h,m,p){return h.size===0?!0:u instanceof Set?d([...u],[...h],m,p):!1}e.isMatchWith=i,e.isSetMatch=f})(qg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qg;function r(a,i){return t.isMatchWith(a,i,()=>{})}e.isMatch=r})(Pd);var Ug={},Od={},Hg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(a=>Object.prototype.propertyIsEnumerable.call(r,a))}e.getSymbols=t})(Hg);var _d={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(_d);var Md={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",a="[object Number]",i="[object Boolean]",s="[object Arguments]",o="[object Symbol]",l="[object Date]",d="[object Map]",f="[object Set]",u="[object Array]",h="[object Function]",m="[object ArrayBuffer]",p="[object Object]",x="[object Error]",v="[object DataView]",g="[object Uint8Array]",b="[object Uint8ClampedArray]",y="[object Uint16Array]",A="[object Uint32Array]",C="[object BigUint64Array]",N="[object Int8Array]",w="[object Int16Array]",M="[object Int32Array]",O="[object BigInt64Array]",D="[object Float32Array]",W="[object Float64Array]";e.argumentsTag=s,e.arrayBufferTag=m,e.arrayTag=u,e.bigInt64ArrayTag=O,e.bigUint64ArrayTag=C,e.booleanTag=i,e.dataViewTag=v,e.dateTag=l,e.errorTag=x,e.float32ArrayTag=D,e.float64ArrayTag=W,e.functionTag=h,e.int16ArrayTag=w,e.int32ArrayTag=M,e.int8ArrayTag=N,e.mapTag=d,e.numberTag=a,e.objectTag=p,e.regexpTag=t,e.setTag=f,e.stringTag=r,e.symbolTag=o,e.uint16ArrayTag=y,e.uint32ArrayTag=A,e.uint8ArrayTag=g,e.uint8ClampedArrayTag=b})(Md);var Kg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(Kg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Hg,r=_d,a=Md,i=Id,s=Kg;function o(u,h){return l(u,void 0,u,new Map,h)}function l(u,h,m,p=new Map,x=void 0){const v=x==null?void 0:x(u,h,m,p);if(v!==void 0)return v;if(i.isPrimitive(u))return u;if(p.has(u))return p.get(u);if(Array.isArray(u)){const g=new Array(u.length);p.set(u,g);for(let b=0;b<u.length;b++)g[b]=l(u[b],b,m,p,x);return Object.hasOwn(u,"index")&&(g.index=u.index),Object.hasOwn(u,"input")&&(g.input=u.input),g}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const g=new RegExp(u.source,u.flags);return g.lastIndex=u.lastIndex,g}if(u instanceof Map){const g=new Map;p.set(u,g);for(const[b,y]of u)g.set(b,l(y,b,m,p,x));return g}if(u instanceof Set){const g=new Set;p.set(u,g);for(const b of u)g.add(l(b,void 0,m,p,x));return g}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(s.isTypedArray(u)){const g=new(Object.getPrototypeOf(u)).constructor(u.length);p.set(u,g);for(let b=0;b<u.length;b++)g[b]=l(u[b],b,m,p,x);return g}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const g=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return p.set(u,g),d(g,u,m,p,x),g}if(typeof File<"u"&&u instanceof File){const g=new File([u],u.name,{type:u.type});return p.set(u,g),d(g,u,m,p,x),g}if(typeof Blob<"u"&&u instanceof Blob){const g=new Blob([u],{type:u.type});return p.set(u,g),d(g,u,m,p,x),g}if(u instanceof Error){const g=new u.constructor;return p.set(u,g),g.message=u.message,g.name=u.name,g.stack=u.stack,g.cause=u.cause,d(g,u,m,p,x),g}if(u instanceof Boolean){const g=new Boolean(u.valueOf());return p.set(u,g),d(g,u,m,p,x),g}if(u instanceof Number){const g=new Number(u.valueOf());return p.set(u,g),d(g,u,m,p,x),g}if(u instanceof String){const g=new String(u.valueOf());return p.set(u,g),d(g,u,m,p,x),g}if(typeof u=="object"&&f(u)){const g=Object.create(Object.getPrototypeOf(u));return p.set(u,g),d(g,u,m,p,x),g}return u}function d(u,h,m=u,p,x){const v=[...Object.keys(h),...t.getSymbols(h)];for(let g=0;g<v.length;g++){const b=v[g],y=Object.getOwnPropertyDescriptor(u,b);(y==null||y.writable)&&(u[b]=l(h[b],b,m,p,x))}}function f(u){switch(r.getTag(u)){case a.argumentsTag:case a.arrayTag:case a.arrayBufferTag:case a.dataViewTag:case a.booleanTag:case a.dateTag:case a.float32ArrayTag:case a.float64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.mapTag:case a.numberTag:case a.objectTag:case a.regexpTag:case a.setTag:case a.stringTag:case a.symbolTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=o,e.cloneDeepWithImpl=l,e.copyProperties=d})(Od);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Od;function r(a){return t.cloneDeepWithImpl(a,void 0,a,new Map,void 0)}e.cloneDeep=r})(Ug);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Pd,r=Ug;function a(i){return i=r.cloneDeep(i),s=>t.isMatch(s,i)}e.matches=a})(Fg);var Yg={},Gg={},Vg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Od,r=Md;function a(i,s){return t.cloneDeepWith(i,(o,l,d,f)=>{const u=s==null?void 0:s(o,l,d,f);if(u!==void 0)return u;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case r.numberTag:case r.stringTag:case r.booleanTag:{const h=new i.constructor(i==null?void 0:i.valueOf());return t.copyProperties(h,i),h}case r.argumentsTag:{const h={};return t.copyProperties(h,i),h.length=i.length,h[Symbol.iterator]=i[Symbol.iterator],h}default:return}})}e.cloneDeepWith=a})(Vg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Vg;function r(a){return t.cloneDeepWith(a)}e.cloneDeep=r})(Gg);var Xg={},Dd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(a,i=Number.MAX_SAFE_INTEGER){switch(typeof a){case"number":return Number.isInteger(a)&&a>=0&&a<i;case"symbol":return!1;case"string":return t.test(a)}}e.isIndex=r})(Dd);var Qg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_d;function r(a){return a!==null&&typeof a=="object"&&t.getTag(a)==="[object Arguments]"}e.isArguments=r})(Qg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kd,r=Dd,a=Qg,i=Uo;function s(o,l){let d;if(Array.isArray(l)?d=l:typeof l=="string"&&t.isDeepKey(l)&&(o==null?void 0:o[l])==null?d=i.toPath(l):d=[l],d.length===0)return!1;let f=o;for(let u=0;u<d.length;u++){const h=d[u];if((f==null||!Object.hasOwn(f,h))&&!((Array.isArray(f)||a.isArguments(f))&&r.isIndex(h)&&h<f.length))return!1;f=f[h]}return!0}e.has=s})(Xg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Pd,r=qo,a=Gg,i=Fo,s=Xg;function o(l,d){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=r.toKey(l);break}}return d=a.cloneDeep(d),function(f){const u=i.get(f,l);return u===void 0?s.has(f,l):d===void 0?u===void 0:t.isMatch(u,d)}}e.matchesProperty=o})(Yg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Cd,r=Bg,a=Fg,i=Yg;function s(o){if(o==null)return t.identity;switch(typeof o){case"function":return o;case"object":return Array.isArray(o)&&o.length===2?i.matchesProperty(o[0],o[1]):a.matches(o);case"string":case"symbol":case"number":return r.property(o)}}e.iteratee=s})(Wg);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$g,r=Cd,a=Lg,i=Wg;function s(o,l=r.identity){return a.isArrayLikeObject(o)?t.uniqBy(Array.from(o),i.iteratee(l)):[]}e.uniqBy=s})(Dg);var mS=Dg.uniqBy;const sh=Gr(mS);function pS(e,t,r){return t===!0?sh(e,r):typeof t=="function"?sh(e,t):e}var Jg={exports:{}},Zg={},ey={exports:{}},ty={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ka=c;function gS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var yS=typeof Object.is=="function"?Object.is:gS,vS=Ka.useState,xS=Ka.useEffect,bS=Ka.useLayoutEffect,jS=Ka.useDebugValue;function wS(e,t){var r=t(),a=vS({inst:{value:r,getSnapshot:t}}),i=a[0].inst,s=a[1];return bS(function(){i.value=r,i.getSnapshot=t,tc(i)&&s({inst:i})},[e,r,t]),xS(function(){return tc(i)&&s({inst:i}),e(function(){tc(i)&&s({inst:i})})},[e]),jS(r),r}function tc(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!yS(e,r)}catch{return!0}}function SS(e,t){return t()}var NS=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?SS:wS;ty.useSyncExternalStore=Ka.useSyncExternalStore!==void 0?Ka.useSyncExternalStore:NS;ey.exports=ty;var kS=ey.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yo=c,AS=kS;function CS(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var PS=typeof Object.is=="function"?Object.is:CS,ES=AS.useSyncExternalStore,IS=Yo.useRef,TS=Yo.useEffect,OS=Yo.useMemo,_S=Yo.useDebugValue;Zg.useSyncExternalStoreWithSelector=function(e,t,r,a,i){var s=IS(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=OS(function(){function d(p){if(!f){if(f=!0,u=p,p=a(p),i!==void 0&&o.hasValue){var x=o.value;if(i(x,p))return h=x}return h=p}if(x=h,PS(u,p))return x;var v=a(p);return i!==void 0&&i(x,v)?(u=p,x):(u=p,h=v)}var f=!1,u,h,m=r===void 0?null:r;return[function(){return d(t())},m===null?void 0:function(){return d(m())}]},[t,r,a,i]);var l=ES(e,s[0],s[1]);return TS(function(){o.hasValue=!0,o.value=l},[l]),_S(l),l};Jg.exports=Zg;var MS=Jg.exports,$d=c.createContext(null),DS=e=>e,St=()=>{var e=c.useContext($d);return e?e.store.dispatch:DS},Ws=()=>{},$S=()=>Ws,LS=(e,t)=>e===t;function Me(e){var t=c.useContext($d);return MS.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:$S,t?t.store.getState:Ws,t?t.store.getState:Ws,t?e:Ws,LS)}function RS(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function zS(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function WS(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(a=>typeof a=="function"?`function ${a.name||"unnamed"}()`:typeof a).join(", ");throw new TypeError(`${t}[${r}]`)}}var oh=e=>Array.isArray(e)?e:[e];function BS(e){const t=Array.isArray(e[0])?e[0]:e;return WS(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function FS(e,t){const r=[],{length:a}=e;for(let i=0;i<a;i++)r.push(e[i].apply(null,t));return r}var qS=class{constructor(e){this.value=e}deref(){return this.value}},US=typeof WeakRef<"u"?WeakRef:qS,HS=0,lh=1;function ks(){return{s:HS,v:void 0,o:null,p:null}}function ny(e,t={}){let r=ks();const{resultEqualityCheck:a}=t;let i,s=0;function o(){var h;let l=r;const{length:d}=arguments;for(let m=0,p=d;m<p;m++){const x=arguments[m];if(typeof x=="function"||typeof x=="object"&&x!==null){let v=l.o;v===null&&(l.o=v=new WeakMap);const g=v.get(x);g===void 0?(l=ks(),v.set(x,l)):l=g}else{let v=l.p;v===null&&(l.p=v=new Map);const g=v.get(x);g===void 0?(l=ks(),v.set(x,l)):l=g}}const f=l;let u;if(l.s===lh)u=l.v;else if(u=e.apply(null,arguments),s++,a){const m=((h=i==null?void 0:i.deref)==null?void 0:h.call(i))??i;m!=null&&a(m,u)&&(u=m,s!==0&&s--),i=typeof u=="object"&&u!==null||typeof u=="function"?new US(u):u}return f.s=lh,f.v=u,u}return o.clearCache=()=>{r=ks(),o.resetResultsCount()},o.resultsCount=()=>s,o.resetResultsCount=()=>{s=0},o}function KS(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,a=(...i)=>{let s=0,o=0,l,d={},f=i.pop();typeof f=="object"&&(d=f,f=i.pop()),RS(f,`createSelector expects an output function after the inputs, but received: [${typeof f}]`);const u={...r,...d},{memoize:h,memoizeOptions:m=[],argsMemoize:p=ny,argsMemoizeOptions:x=[]}=u,v=oh(m),g=oh(x),b=BS(i),y=h(function(){return s++,f.apply(null,arguments)},...v),A=p(function(){o++;const N=FS(b,arguments);return l=y.apply(null,N),l},...g);return Object.assign(A,{resultFunc:f,memoizedResultFunc:y,dependencies:b,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>l,recomputations:()=>s,resetRecomputations:()=>{s=0},memoize:h,argsMemoize:p})};return Object.assign(a,{withTypes:()=>a}),a}var me=KS(ny),YS=Object.assign((e,t=me)=>{zS(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),a=r.map(s=>e[s]);return t(a,(...s)=>s.reduce((o,l,d)=>(o[r[d]]=l,o),{}))},{withTypes:()=>YS}),ry={},ay={},iy={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(a){return typeof a=="symbol"?1:a===null?2:a===void 0?3:a!==a?4:0}const r=(a,i,s)=>{if(a!==i){const o=t(a),l=t(i);if(o===l&&o===0){if(a<i)return s==="desc"?1:-1;if(a>i)return s==="desc"?-1:1}return s==="desc"?l-o:o-l}return 0};e.compareValues=r})(iy);var sy={},Ld={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(Ld);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ld,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;function i(s,o){return Array.isArray(s)?!1:typeof s=="number"||typeof s=="boolean"||s==null||t.isSymbol(s)?!0:typeof s=="string"&&(a.test(s)||!r.test(s))||o!=null&&Object.hasOwn(o,s)}e.isKey=i})(sy);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=iy,r=sy,a=Uo;function i(s,o,l,d){if(s==null)return[];l=d?void 0:l,Array.isArray(s)||(s=Object.values(s)),Array.isArray(o)||(o=o==null?[null]:[o]),o.length===0&&(o=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(p=>String(p));const f=(p,x)=>{let v=p;for(let g=0;g<x.length&&v!=null;++g)v=v[x[g]];return v},u=(p,x)=>x==null||p==null?x:typeof p=="object"&&"key"in p?Object.hasOwn(x,p.key)?x[p.key]:f(x,p.path):typeof p=="function"?p(x):Array.isArray(p)?f(x,p):typeof x=="object"?x[p]:x,h=o.map(p=>(Array.isArray(p)&&p.length===1&&(p=p[0]),p==null||typeof p=="function"||Array.isArray(p)||r.isKey(p)?p:{key:p,path:a.toPath(p)}));return s.map(p=>({original:p,criteria:h.map(x=>u(x,p))})).slice().sort((p,x)=>{for(let v=0;v<h.length;v++){const g=t.compareValues(p.criteria[v],x.criteria[v],l[v]);if(g!==0)return g}return 0}).map(p=>p.original)}e.orderBy=i})(ay);var oy={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a=1){const i=[],s=Math.floor(a),o=(l,d)=>{for(let f=0;f<l.length;f++){const u=l[f];Array.isArray(u)&&d<s?o(u,d+1):i.push(u)}};return o(r,0),i}e.flatten=t})(oy);var Rd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Dd,r=Ko,a=Ed,i=Td;function s(o,l,d){return a.isObject(d)&&(typeof l=="number"&&r.isArrayLike(d)&&t.isIndex(l)&&l<d.length||typeof l=="string"&&l in d)?i.eq(d[l],o):!1}e.isIterateeCall=s})(Rd);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ay,r=oy,a=Rd;function i(s,...o){const l=o.length;return l>1&&a.isIterateeCall(s,o[0],o[1])?o=[]:l>2&&a.isIterateeCall(o[0],o[1],o[2])&&(o=[o[0]]),t.orderBy(s,r.flatten(o),["asc"])}e.sortBy=i})(ry);var GS=ry.sortBy;const Go=Gr(GS);var ly=e=>e.legend.settings,VS=e=>e.legend.size,XS=e=>e.legend.payload;me([XS,ly],(e,t)=>{var{itemSorter:r}=t,a=e.flat(1);return r?Go(a,r):a});var As=1;function QS(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=c.useState({height:0,left:0,top:0,width:0}),a=c.useCallback(i=>{if(i!=null){var s=i.getBoundingClientRect(),o={height:s.height,left:s.left,top:s.top,width:s.width};(Math.abs(o.height-t.height)>As||Math.abs(o.left-t.left)>As||Math.abs(o.top-t.top)>As||Math.abs(o.width-t.width)>As)&&r({height:o.height,left:o.left,top:o.top,width:o.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,a]}function sn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var JS=typeof Symbol=="function"&&Symbol.observable||"@@observable",ch=JS,nc=()=>Math.random().toString(36).substring(7).split("").join("."),ZS={INIT:`@@redux/INIT${nc()}`,REPLACE:`@@redux/REPLACE${nc()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${nc()}`},Vs=ZS;function zd(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function cy(e,t,r){if(typeof e!="function")throw new Error(sn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(sn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(sn(1));return r(cy)(e,t)}let a=e,i=t,s=new Map,o=s,l=0,d=!1;function f(){o===s&&(o=new Map,s.forEach((g,b)=>{o.set(b,g)}))}function u(){if(d)throw new Error(sn(3));return i}function h(g){if(typeof g!="function")throw new Error(sn(4));if(d)throw new Error(sn(5));let b=!0;f();const y=l++;return o.set(y,g),function(){if(b){if(d)throw new Error(sn(6));b=!1,f(),o.delete(y),s=null}}}function m(g){if(!zd(g))throw new Error(sn(7));if(typeof g.type>"u")throw new Error(sn(8));if(typeof g.type!="string")throw new Error(sn(17));if(d)throw new Error(sn(9));try{d=!0,i=a(i,g)}finally{d=!1}return(s=o).forEach(y=>{y()}),g}function p(g){if(typeof g!="function")throw new Error(sn(10));a=g,m({type:Vs.REPLACE})}function x(){const g=h;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(sn(11));function y(){const C=b;C.next&&C.next(u())}return y(),{unsubscribe:g(y)}},[ch](){return this}}}return m({type:Vs.INIT}),{dispatch:m,subscribe:h,getState:u,replaceReducer:p,[ch]:x}}function eN(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Vs.INIT})>"u")throw new Error(sn(12));if(typeof r(void 0,{type:Vs.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(sn(13))})}function dy(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const o=t[s];typeof e[o]=="function"&&(r[o]=e[o])}const a=Object.keys(r);let i;try{eN(r)}catch(s){i=s}return function(o={},l){if(i)throw i;let d=!1;const f={};for(let u=0;u<a.length;u++){const h=a[u],m=r[h],p=o[h],x=m(p,l);if(typeof x>"u")throw l&&l.type,new Error(sn(14));f[h]=x,d=d||x!==p}return d=d||a.length!==Object.keys(o).length,d?f:o}}function Xs(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...a)=>t(r(...a)))}function tN(...e){return t=>(r,a)=>{const i=t(r,a);let s=()=>{throw new Error(sn(15))};const o={getState:i.getState,dispatch:(d,...f)=>s(d,...f)},l=e.map(d=>d(o));return s=Xs(...l)(i.dispatch),{...i,dispatch:s}}}function uy(e){return zd(e)&&"type"in e&&typeof e.type=="string"}var fy=Symbol.for("immer-nothing"),dh=Symbol.for("immer-draftable"),On=Symbol.for("immer-state");function Vn(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Ti=Object.getPrototypeOf;function ba(e){return!!e&&!!e[On]}function Nr(e){var t;return e?hy(e)||Array.isArray(e)||!!e[dh]||!!((t=e.constructor)!=null&&t[dh])||Ui(e)||Xo(e):!1}var nN=Object.prototype.constructor.toString(),uh=new WeakMap;function hy(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let a=uh.get(r);return a===void 0&&(a=Function.toString.call(r),uh.set(r,a)),a===nN}function Qs(e,t,r=!0){Vo(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(i=>{t(i,e[i],e)}):e.forEach((a,i)=>t(i,a,e))}function Vo(e){const t=e[On];return t?t.type_:Array.isArray(e)?1:Ui(e)?2:Xo(e)?3:0}function Ec(e,t){return Vo(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function my(e,t,r){const a=Vo(e);a===2?e.set(t,r):a===3?e.add(r):e[t]=r}function rN(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Ui(e){return e instanceof Map}function Xo(e){return e instanceof Set}function la(e){return e.copy_||e.base_}function Ic(e,t){if(Ui(e))return new Map(e);if(Xo(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=hy(e);if(t===!0||t==="class_only"&&!r){const a=Object.getOwnPropertyDescriptors(e);delete a[On];let i=Reflect.ownKeys(a);for(let s=0;s<i.length;s++){const o=i[s],l=a[o];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(a[o]={configurable:!0,writable:!0,enumerable:l.enumerable,value:e[o]})}return Object.create(Ti(e),a)}else{const a=Ti(e);if(a!==null&&r)return{...e};const i=Object.create(a);return Object.assign(i,e)}}function Wd(e,t=!1){return Qo(e)||ba(e)||!Nr(e)||(Vo(e)>1&&Object.defineProperties(e,{set:Cs,add:Cs,clear:Cs,delete:Cs}),Object.freeze(e),t&&Object.values(e).forEach(r=>Wd(r,!0))),e}function aN(){Vn(2)}var Cs={value:aN};function Qo(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var iN={};function ja(e){const t=iN[e];return t||Vn(0,e),t}var Oi;function py(){return Oi}function sN(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function fh(e,t){t&&(ja("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Tc(e){Oc(e),e.drafts_.forEach(oN),e.drafts_=null}function Oc(e){e===Oi&&(Oi=e.parent_)}function hh(e){return Oi=sN(Oi,e)}function oN(e){const t=e[On];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function mh(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[On].modified_&&(Tc(t),Vn(4)),Nr(e)&&(e=Js(t,e),t.parent_||Zs(t,e)),t.patches_&&ja("Patches").generateReplacementPatches_(r[On].base_,e,t.patches_,t.inversePatches_)):e=Js(t,r,[]),Tc(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==fy?e:void 0}function Js(e,t,r){if(Qo(t))return t;const a=e.immer_.shouldUseStrictIteration(),i=t[On];if(!i)return Qs(t,(s,o)=>ph(e,i,t,s,o,r),a),t;if(i.scope_!==e)return t;if(!i.modified_)return Zs(e,i.base_,!0),i.base_;if(!i.finalized_){i.finalized_=!0,i.scope_.unfinalizedDrafts_--;const s=i.copy_;let o=s,l=!1;i.type_===3&&(o=new Set(s),s.clear(),l=!0),Qs(o,(d,f)=>ph(e,i,s,d,f,r,l),a),Zs(e,s,!1),r&&e.patches_&&ja("Patches").generatePatches_(i,r,e.patches_,e.inversePatches_)}return i.copy_}function ph(e,t,r,a,i,s,o){if(i==null||typeof i!="object"&&!o)return;const l=Qo(i);if(!(l&&!o)){if(ba(i)){const d=s&&t&&t.type_!==3&&!Ec(t.assigned_,a)?s.concat(a):void 0,f=Js(e,i,d);if(my(r,a,f),ba(f))e.canAutoFreeze_=!1;else return}else o&&r.add(i);if(Nr(i)&&!l){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[a]===i&&l)return;Js(e,i),(!t||!t.scope_.parent_)&&typeof a!="symbol"&&(Ui(r)?r.has(a):Object.prototype.propertyIsEnumerable.call(r,a))&&Zs(e,i)}}}function Zs(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Wd(t,r)}function lN(e,t){const r=Array.isArray(e),a={type_:r?1:0,scope_:t?t.scope_:py(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=a,s=Bd;r&&(i=[a],s=_i);const{revoke:o,proxy:l}=Proxy.revocable(i,s);return a.draft_=l,a.revoke_=o,l}var Bd={get(e,t){if(t===On)return e;const r=la(e);if(!Ec(r,t))return cN(e,r,t);const a=r[t];return e.finalized_||!Nr(a)?a:a===rc(e.base_,t)?(ac(e),e.copy_[t]=Mc(a,e)):a},has(e,t){return t in la(e)},ownKeys(e){return Reflect.ownKeys(la(e))},set(e,t,r){const a=gy(la(e),t);if(a!=null&&a.set)return a.set.call(e.draft_,r),!0;if(!e.modified_){const i=rc(la(e),t),s=i==null?void 0:i[On];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(rN(r,i)&&(r!==void 0||Ec(e.base_,t)))return!0;ac(e),_c(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return rc(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,ac(e),_c(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=la(e),a=Reflect.getOwnPropertyDescriptor(r,t);return a&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:a.enumerable,value:r[t]}},defineProperty(){Vn(11)},getPrototypeOf(e){return Ti(e.base_)},setPrototypeOf(){Vn(12)}},_i={};Qs(Bd,(e,t)=>{_i[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});_i.deleteProperty=function(e,t){return _i.set.call(this,e,t,void 0)};_i.set=function(e,t,r){return Bd.set.call(this,e[0],t,r,e[0])};function rc(e,t){const r=e[On];return(r?la(r):e)[t]}function cN(e,t,r){var i;const a=gy(t,r);return a?"value"in a?a.value:(i=a.get)==null?void 0:i.call(e.draft_):void 0}function gy(e,t){if(!(t in e))return;let r=Ti(e);for(;r;){const a=Object.getOwnPropertyDescriptor(r,t);if(a)return a;r=Ti(r)}}function _c(e){e.modified_||(e.modified_=!0,e.parent_&&_c(e.parent_))}function ac(e){e.copy_||(e.copy_=Ic(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var dN=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,a)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const o=this;return function(d=s,...f){return o.produce(d,u=>r.call(this,u,...f))}}typeof r!="function"&&Vn(6),a!==void 0&&typeof a!="function"&&Vn(7);let i;if(Nr(t)){const s=hh(this),o=Mc(t,void 0);let l=!0;try{i=r(o),l=!1}finally{l?Tc(s):Oc(s)}return fh(s,a),mh(i,s)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===fy&&(i=void 0),this.autoFreeze_&&Wd(i,!0),a){const s=[],o=[];ja("Patches").generateReplacementPatches_(t,i,s,o),a(s,o)}return i}else Vn(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...l)=>this.produceWithPatches(o,d=>t(d,...l));let a,i;return[this.produce(t,r,(o,l)=>{a=o,i=l}),a,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){Nr(e)||Vn(8),ba(e)&&(e=jr(e));const t=hh(this),r=Mc(e,void 0);return r[On].isManual_=!0,Oc(t),r}finishDraft(e,t){const r=e&&e[On];(!r||!r.isManual_)&&Vn(9);const{scope_:a}=r;return fh(a,t),mh(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const a=ja("Patches").applyPatches_;return ba(e)?a(e,t):this.produce(e,i=>a(i,t))}};function Mc(e,t){const r=Ui(e)?ja("MapSet").proxyMap_(e,t):Xo(e)?ja("MapSet").proxySet_(e,t):lN(e,t);return(t?t.scope_:py()).drafts_.push(r),r}function jr(e){return ba(e)||Vn(10,e),yy(e)}function yy(e){if(!Nr(e)||Qo(e))return e;const t=e[On];let r,a=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Ic(e,t.scope_.immer_.useStrictShallowCopy_),a=t.scope_.immer_.shouldUseStrictIteration()}else r=Ic(e,!0);return Qs(r,(i,s)=>{my(r,i,yy(s))},a),t&&(t.finalized_=!1),r}var Dc=new dN,vy=Dc.produce,uN=Dc.setUseStrictIteration.bind(Dc);function xy(e){return({dispatch:r,getState:a})=>i=>s=>typeof s=="function"?s(r,a,e):i(s)}var fN=xy(),hN=xy,mN=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Xs:Xs.apply(null,arguments)};function Bn(e,t){function r(...a){if(t){let i=t(...a);if(!i)throw new Error(In(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:a[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=a=>uy(a)&&a.type===e,r}var by=class Ni extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Ni.prototype)}static get[Symbol.species](){return Ni}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Ni(...t[0].concat(this)):new Ni(...t.concat(this))}};function gh(e){return Nr(e)?vy(e,()=>{}):e}function Ps(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function pN(e){return typeof e=="boolean"}var gN=()=>function(t){const{thunk:r=!0,immutableCheck:a=!0,serializableCheck:i=!0,actionCreatorCheck:s=!0}=t??{};let o=new by;return r&&(pN(r)?o.push(fN):o.push(hN(r.extraArgument))),o},jy="RTK_autoBatch",Ht=()=>e=>({payload:e,meta:{[jy]:!0}}),yh=e=>t=>{setTimeout(t,e)},wy=(e={type:"raf"})=>t=>(...r)=>{const a=t(...r);let i=!0,s=!1,o=!1;const l=new Set,d=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:yh(10):e.type==="callback"?e.queueNotification:yh(e.timeout),f=()=>{o=!1,s&&(s=!1,l.forEach(u=>u()))};return Object.assign({},a,{subscribe(u){const h=()=>i&&u(),m=a.subscribe(h);return l.add(u),()=>{m(),l.delete(u)}},dispatch(u){var h;try{return i=!((h=u==null?void 0:u.meta)!=null&&h[jy]),s=!i,s&&(o||(o=!0,d(f))),a.dispatch(u)}finally{i=!0}}})},yN=e=>function(r){const{autoBatch:a=!0}=r??{};let i=new by(e);return a&&i.push(wy(typeof a=="object"?a:void 0)),i};function vN(e){const t=gN(),{reducer:r=void 0,middleware:a,devTools:i=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(zd(r))l=dy(r);else throw new Error(In(1));let d;typeof a=="function"?d=a(t):d=t();let f=Xs;i&&(f=mN({trace:!1,...typeof i=="object"&&i}));const u=tN(...d),h=yN(u);let m=typeof o=="function"?o(h):h();const p=f(...m);return cy(l,s,p)}function Sy(e){const t={},r=[];let a;const i={addCase(s,o){const l=typeof s=="string"?s:s.type;if(!l)throw new Error(In(28));if(l in t)throw new Error(In(29));return t[l]=o,i},addAsyncThunk(s,o){return o.pending&&(t[s.pending.type]=o.pending),o.rejected&&(t[s.rejected.type]=o.rejected),o.fulfilled&&(t[s.fulfilled.type]=o.fulfilled),o.settled&&r.push({matcher:s.settled,reducer:o.settled}),i},addMatcher(s,o){return r.push({matcher:s,reducer:o}),i},addDefaultCase(s){return a=s,i}};return e(i),[t,r,a]}uN(!1);function xN(e){return typeof e=="function"}function bN(e,t){let[r,a,i]=Sy(t),s;if(xN(e))s=()=>gh(e());else{const l=gh(e);s=()=>l}function o(l=s(),d){let f=[r[d.type],...a.filter(({matcher:u})=>u(d)).map(({reducer:u})=>u)];return f.filter(u=>!!u).length===0&&(f=[i]),f.reduce((u,h)=>{if(h)if(ba(u)){const p=h(u,d);return p===void 0?u:p}else{if(Nr(u))return vy(u,m=>h(m,d));{const m=h(u,d);if(m===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return m}}return u},l)}return o.getInitialState=s,o}var jN="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",wN=(e=21)=>{let t="",r=e;for(;r--;)t+=jN[Math.random()*64|0];return t},SN=Symbol.for("rtk-slice-createasyncthunk");function NN(e,t){return`${e}/${t}`}function kN({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[SN];return function(i){const{name:s,reducerPath:o=s}=i;if(!s)throw new Error(In(11));const l=(typeof i.reducers=="function"?i.reducers(CN()):i.reducers)||{},d=Object.keys(l),f={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(C,N){const w=typeof C=="string"?C:C.type;if(!w)throw new Error(In(12));if(w in f.sliceCaseReducersByType)throw new Error(In(13));return f.sliceCaseReducersByType[w]=N,u},addMatcher(C,N){return f.sliceMatchers.push({matcher:C,reducer:N}),u},exposeAction(C,N){return f.actionCreators[C]=N,u},exposeCaseReducer(C,N){return f.sliceCaseReducersByName[C]=N,u}};d.forEach(C=>{const N=l[C],w={reducerName:C,type:NN(s,C),createNotation:typeof i.reducers=="function"};EN(N)?TN(w,N,u,t):PN(w,N,u)});function h(){const[C={},N=[],w=void 0]=typeof i.extraReducers=="function"?Sy(i.extraReducers):[i.extraReducers],M={...C,...f.sliceCaseReducersByType};return bN(i.initialState,O=>{for(let D in M)O.addCase(D,M[D]);for(let D of f.sliceMatchers)O.addMatcher(D.matcher,D.reducer);for(let D of N)O.addMatcher(D.matcher,D.reducer);w&&O.addDefaultCase(w)})}const m=C=>C,p=new Map,x=new WeakMap;let v;function g(C,N){return v||(v=h()),v(C,N)}function b(){return v||(v=h()),v.getInitialState()}function y(C,N=!1){function w(O){let D=O[C];return typeof D>"u"&&N&&(D=Ps(x,w,b)),D}function M(O=m){const D=Ps(p,N,()=>new WeakMap);return Ps(D,O,()=>{const W={};for(const[j,S]of Object.entries(i.selectors??{}))W[j]=AN(S,O,()=>Ps(x,O,b),N);return W})}return{reducerPath:C,getSelectors:M,get selectors(){return M(w)},selectSlice:w}}const A={name:s,reducer:g,actions:f.actionCreators,caseReducers:f.sliceCaseReducersByName,getInitialState:b,...y(o),injectInto(C,{reducerPath:N,...w}={}){const M=N??o;return C.inject({reducerPath:M,reducer:g},w),{...A,...y(M,!0)}}};return A}}function AN(e,t,r,a){function i(s,...o){let l=t(s);return typeof l>"u"&&a&&(l=r()),e(l,...o)}return i.unwrapped=e,i}var Sn=kN();function CN(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function PN({type:e,reducerName:t,createNotation:r},a,i){let s,o;if("reducer"in a){if(r&&!IN(a))throw new Error(In(17));s=a.reducer,o=a.prepare}else s=a;i.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?Bn(e,o):Bn(e))}function EN(e){return e._reducerDefinitionType==="asyncThunk"}function IN(e){return e._reducerDefinitionType==="reducerWithPrepare"}function TN({type:e,reducerName:t},r,a,i){if(!i)throw new Error(In(18));const{payloadCreator:s,fulfilled:o,pending:l,rejected:d,settled:f,options:u}=r,h=i(e,s,u);a.exposeAction(t,h),o&&a.addCase(h.fulfilled,o),l&&a.addCase(h.pending,l),d&&a.addCase(h.rejected,d),f&&a.addMatcher(h.settled,f),a.exposeCaseReducer(t,{fulfilled:o||Es,pending:l||Es,rejected:d||Es,settled:f||Es})}function Es(){}var ON="task",Ny="listener",ky="completed",Fd="cancelled",_N=`task-${Fd}`,MN=`task-${ky}`,$c=`${Ny}-${Fd}`,DN=`${Ny}-${ky}`,Jo=class{constructor(e){Ul(this,"name","TaskAbortError");Ul(this,"message");this.code=e,this.message=`${ON} ${Fd} (reason: ${e})`}},qd=(e,t)=>{if(typeof e!="function")throw new TypeError(In(32))},eo=()=>{},Ay=(e,t=eo)=>(e.catch(t),e),Cy=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),ha=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},ma=e=>{if(e.aborted){const{reason:t}=e;throw new Jo(t)}};function Py(e,t){let r=eo;return new Promise((a,i)=>{const s=()=>i(new Jo(e.reason));if(e.aborted){s();return}r=Cy(e,s),t.finally(()=>r()).then(a,i)}).finally(()=>{r=eo})}var $N=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Jo?"cancelled":"rejected",error:r}}finally{t==null||t()}},to=e=>t=>Ay(Py(e,t).then(r=>(ma(e),r))),Ey=e=>{const t=to(e);return r=>t(new Promise(a=>setTimeout(a,r)))},{assign:qa}=Object,vh={},Zo="listenerMiddleware",LN=(e,t)=>{const r=a=>Cy(e,()=>ha(a,e.reason));return(a,i)=>{qd(a);const s=new AbortController;r(s);const o=$N(async()=>{ma(e),ma(s.signal);const l=await a({pause:to(s.signal),delay:Ey(s.signal),signal:s.signal});return ma(s.signal),l},()=>ha(s,MN));return i!=null&&i.autoJoin&&t.push(o.catch(eo)),{result:to(e)(o),cancel(){ha(s,_N)}}}},RN=(e,t)=>{const r=async(a,i)=>{ma(t);let s=()=>{};const l=[new Promise((d,f)=>{let u=e({predicate:a,effect:(h,m)=>{m.unsubscribe(),d([h,m.getState(),m.getOriginalState()])}});s=()=>{u(),f()}})];i!=null&&l.push(new Promise(d=>setTimeout(d,i,null)));try{const d=await Py(t,Promise.race(l));return ma(t),d}finally{s()}};return(a,i)=>Ay(r(a,i))},Iy=e=>{let{type:t,actionCreator:r,matcher:a,predicate:i,effect:s}=e;if(t)i=Bn(t).match;else if(r)t=r.type,i=r.match;else if(a)i=a;else if(!i)throw new Error(In(21));return qd(s),{predicate:i,type:t,effect:s}},Ty=qa(e=>{const{type:t,predicate:r,effect:a}=Iy(e);return{id:wN(),effect:a,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(In(22))}}},{withTypes:()=>Ty}),xh=(e,t)=>{const{type:r,effect:a,predicate:i}=Iy(t);return Array.from(e.values()).find(s=>(typeof r=="string"?s.type===r:s.predicate===i)&&s.effect===a)},Lc=e=>{e.pending.forEach(t=>{ha(t,$c)})},zN=(e,t)=>()=>{for(const r of t.keys())Lc(r);e.clear()},bh=(e,t,r)=>{try{e(t,r)}catch(a){setTimeout(()=>{throw a},0)}},Oy=qa(Bn(`${Zo}/add`),{withTypes:()=>Oy}),WN=Bn(`${Zo}/removeAll`),_y=qa(Bn(`${Zo}/remove`),{withTypes:()=>_y}),BN=(...e)=>{console.error(`${Zo}/error`,...e)},Hi=(e={})=>{const t=new Map,r=new Map,a=p=>{const x=r.get(p)??0;r.set(p,x+1)},i=p=>{const x=r.get(p)??1;x===1?r.delete(p):r.set(p,x-1)},{extra:s,onError:o=BN}=e;qd(o);const l=p=>(p.unsubscribe=()=>t.delete(p.id),t.set(p.id,p),x=>{p.unsubscribe(),x!=null&&x.cancelActive&&Lc(p)}),d=p=>{const x=xh(t,p)??Ty(p);return l(x)};qa(d,{withTypes:()=>d});const f=p=>{const x=xh(t,p);return x&&(x.unsubscribe(),p.cancelActive&&Lc(x)),!!x};qa(f,{withTypes:()=>f});const u=async(p,x,v,g)=>{const b=new AbortController,y=RN(d,b.signal),A=[];try{p.pending.add(b),a(p),await Promise.resolve(p.effect(x,qa({},v,{getOriginalState:g,condition:(C,N)=>y(C,N).then(Boolean),take:y,delay:Ey(b.signal),pause:to(b.signal),extra:s,signal:b.signal,fork:LN(b.signal,A),unsubscribe:p.unsubscribe,subscribe:()=>{t.set(p.id,p)},cancelActiveListeners:()=>{p.pending.forEach((C,N,w)=>{C!==b&&(ha(C,$c),w.delete(C))})},cancel:()=>{ha(b,$c),p.pending.delete(b)},throwIfCancelled:()=>{ma(b.signal)}})))}catch(C){C instanceof Jo||bh(o,C,{raisedBy:"effect"})}finally{await Promise.all(A),ha(b,DN),i(p),p.pending.delete(b)}},h=zN(t,r);return{middleware:p=>x=>v=>{if(!uy(v))return x(v);if(Oy.match(v))return d(v.payload);if(WN.match(v)){h();return}if(_y.match(v))return f(v.payload);let g=p.getState();const b=()=>{if(g===vh)throw new Error(In(23));return g};let y;try{if(y=x(v),t.size>0){const A=p.getState(),C=Array.from(t.values());for(const N of C){let w=!1;try{w=N.predicate(v,A,g)}catch(M){w=!1,bh(o,M,{raisedBy:"predicate"})}w&&u(N,v,p,b)}}}finally{g=vh}return y},startListening:d,stopListening:f,clearListeners:h}};function In(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var FN={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},My=Sn({name:"chartLayout",initialState:FN,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,a,i,s;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(a=t.payload.right)!==null&&a!==void 0?a:0,e.margin.bottom=(i=t.payload.bottom)!==null&&i!==void 0?i:0,e.margin.left=(s=t.payload.left)!==null&&s!==void 0?s:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:qN,setLayout:UN,setChartSize:HN,setScale:KN}=My.actions,YN=My.reducer;function Dy(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function jh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Ba(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jh(Object(r),!0).forEach(function(a){GN(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function GN(e,t,r){return(t=VN(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VN(e){var t=XN(e,"string");return typeof t=="symbol"?t:t+""}function XN(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function pt(e,t,r){return wt(e)||wt(t)?r:lr(t)?xa(e,t,r):typeof t=="function"?t(e):r}var QN=(e,t,r)=>{if(t&&r){var{width:a,height:i}=r,{align:s,verticalAlign:o,layout:l}=t;if((l==="vertical"||l==="horizontal"&&o==="middle")&&s!=="center"&&_e(e[s]))return Ba(Ba({},e),{},{[s]:e[s]+(a||0)});if((l==="horizontal"||l==="vertical"&&s==="center")&&o!=="middle"&&_e(e[o]))return Ba(Ba({},e),{},{[o]:e[o]+(i||0)})}return e},Vr=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",$y=(e,t,r,a)=>{if(a)return e.map(l=>l.coordinate);var i,s,o=e.map(l=>(l.coordinate===t&&(i=!0),l.coordinate===r&&(s=!0),l.coordinate));return i||o.push(t),s||o.push(r),o},Ly=(e,t,r)=>{if(!e)return null;var{duplicateDomain:a,type:i,range:s,scale:o,realScaleType:l,isCategorical:d,categoricalDomain:f,tickCount:u,ticks:h,niceTicks:m,axisType:p}=e;if(!o)return null;var x=l==="scaleBand"&&o.bandwidth?o.bandwidth()/2:2,v=i==="category"&&o.bandwidth?o.bandwidth()/x:0;if(v=p==="angleAxis"&&s&&s.length>=2?Jt(s[0]-s[1])*2*v:v,h||m){var g=(h||m||[]).map((b,y)=>{var A=a?a.indexOf(b):b;return{coordinate:o(A)+v,value:b,offset:v,index:y}});return g.filter(b=>!Qn(b.coordinate))}return d&&f?f.map((b,y)=>({coordinate:o(b)+v,value:b,index:y,offset:v})):o.ticks&&u!=null?o.ticks(u).map((b,y)=>({coordinate:o(b)+v,value:b,offset:v,index:y})):o.domain().map((b,y)=>({coordinate:o(b)+v,value:a?a[b]:b,index:y,offset:v}))},wh=1e-4,JN=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,a=e.range(),i=Math.min(a[0],a[1])-wh,s=Math.max(a[0],a[1])+wh,o=e(t[0]),l=e(t[r-1]);(o<i||o>s||l<i||l>s)&&e.domain([t[0],t[r-1]])}},ZN=(e,t)=>{if(!t||t.length!==2||!_e(t[0])||!_e(t[1]))return e;var r=Math.min(t[0],t[1]),a=Math.max(t[0],t[1]),i=[e[0],e[1]];return(!_e(e[0])||e[0]<r)&&(i[0]=r),(!_e(e[1])||e[1]>a)&&(i[1]=a),i[0]>a&&(i[0]=a),i[1]<r&&(i[1]=r),i},e2=e=>{var t=e.length;if(!(t<=0))for(var r=0,a=e[0].length;r<a;++r)for(var i=0,s=0,o=0;o<t;++o){var l=Qn(e[o][r][1])?e[o][r][0]:e[o][r][1];l>=0?(e[o][r][0]=i,e[o][r][1]=i+l,i=e[o][r][1]):(e[o][r][0]=s,e[o][r][1]=s+l,s=e[o][r][1])}},t2=e=>{var t=e.length;if(!(t<=0))for(var r=0,a=e[0].length;r<a;++r)for(var i=0,s=0;s<t;++s){var o=Qn(e[s][r][1])?e[s][r][0]:e[s][r][1];o>=0?(e[s][r][0]=i,e[s][r][1]=i+o,i=e[s][r][1]):(e[s][r][0]=0,e[s][r][1]=0)}},n2={sign:e2,expand:Yw,none:Ha,silhouette:Gw,wiggle:Vw,positive:t2},r2=(e,t,r)=>{var a=n2[r],i=Kw().keys(t).value((s,o)=>Number(pt(s,o,0))).order(Cc).offset(a);return i(e)};function a2(e){return e==null?void 0:String(e)}function Sh(e){var{axis:t,ticks:r,bandSize:a,entry:i,index:s,dataKey:o}=e;if(t.type==="category"){if(!t.allowDuplicatedCategory&&t.dataKey&&!wt(i[t.dataKey])){var l=Tg(r,"value",i[t.dataKey]);if(l)return l.coordinate+a/2}return r[s]?r[s].coordinate+a/2:null}var d=pt(i,wt(o)?t.dataKey:o);return wt(d)?null:t.scale(d)}var Nh=e=>{var{axis:t,ticks:r,offset:a,bandSize:i,entry:s,index:o}=e;if(t.type==="category")return r[o]?r[o].coordinate+a:null;var l=pt(s,t.dataKey,t.scale.domain()[o]);return wt(l)?null:t.scale(l)-i/2+a},i2=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var a=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return a<=0&&i>=0?0:i<0?i:a}return r[0]},s2=e=>{var t=e.flat(2).filter(_e);return[Math.min(...t),Math.max(...t)]},o2=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],l2=(e,t,r)=>{if(e!=null)return o2(Object.keys(e).reduce((a,i)=>{var s=e[i],{stackedData:o}=s,l=o.reduce((d,f)=>{var u=Dy(f,t,r),h=s2(u);return[Math.min(d[0],h[0]),Math.max(d[1],h[1])]},[1/0,-1/0]);return[Math.min(l[0],a[0]),Math.max(l[1],a[1])]},[1/0,-1/0]))},kh=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ah=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ya=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var a=e.scale.bandwidth();if(!r||a>0)return a}if(e&&t&&t.length>=2){for(var i=Go(t,u=>u.coordinate),s=1/0,o=1,l=i.length;o<l;o++){var d=i[o],f=i[o-1];s=Math.min((d.coordinate||0)-(f.coordinate||0),s)}return s===1/0?0:s}return r?void 0:0};function Ch(e){var{tooltipEntrySettings:t,dataKey:r,payload:a,value:i,name:s}=e;return Ba(Ba({},t),{},{dataKey:r,payload:a,value:i,name:s})}function Ja(e,t){if(e)return String(e);if(typeof t=="string")return t}var c2=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},d2=(e,t)=>t==="centric"?e.angle:e.radius,Ir=e=>e.layout.width,Tr=e=>e.layout.height,u2=e=>e.layout.scale,Ry=e=>e.layout.margin,el=me(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),tl=me(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),zy="data-recharts-item-index",Wy="data-recharts-item-data-key",Ki=60;function Ph(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Is(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ph(Object(r),!0).forEach(function(a){f2(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ph(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function f2(e,t,r){return(t=h2(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h2(e){var t=m2(e,"string");return typeof t=="symbol"?t:t+""}function m2(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var p2=e=>e.brush.height;function g2(e){var t=tl(e);return t.reduce((r,a)=>{if(a.orientation==="left"&&!a.mirror&&!a.hide){var i=typeof a.width=="number"?a.width:Ki;return r+i}return r},0)}function y2(e){var t=tl(e);return t.reduce((r,a)=>{if(a.orientation==="right"&&!a.mirror&&!a.hide){var i=typeof a.width=="number"?a.width:Ki;return r+i}return r},0)}function v2(e){var t=el(e);return t.reduce((r,a)=>a.orientation==="top"&&!a.mirror&&!a.hide?r+a.height:r,0)}function x2(e){var t=el(e);return t.reduce((r,a)=>a.orientation==="bottom"&&!a.mirror&&!a.hide?r+a.height:r,0)}var Kt=me([Ir,Tr,Ry,p2,g2,y2,v2,x2,ly,VS],(e,t,r,a,i,s,o,l,d,f)=>{var u={left:(r.left||0)+i,right:(r.right||0)+s},h={top:(r.top||0)+o,bottom:(r.bottom||0)+l},m=Is(Is({},h),u),p=m.bottom;m.bottom+=a,m=QN(m,d,f);var x=e-m.left-m.right,v=t-m.top-m.bottom;return Is(Is({brushBottom:p},m),{},{width:Math.max(x,0),height:Math.max(v,0)})}),b2=me(Kt,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),Ud=me(Ir,Tr,(e,t)=>({x:0,y:0,width:e,height:t})),j2=c.createContext(null),fn=()=>c.useContext(j2)!=null,nl=e=>e.brush,rl=me([nl,Kt,Ry],(e,t,r)=>({height:e.height,x:_e(e.x)?e.x:t.left,y:_e(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:_e(e.width)?e.width:t.width})),By={},Fy={},qy={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,a,{signal:i,edges:s}={}){let o,l=null;const d=s!=null&&s.includes("leading"),f=s==null||s.includes("trailing"),u=()=>{l!==null&&(r.apply(o,l),o=void 0,l=null)},h=()=>{f&&u(),v()};let m=null;const p=()=>{m!=null&&clearTimeout(m),m=setTimeout(()=>{m=null,h()},a)},x=()=>{m!==null&&(clearTimeout(m),m=null)},v=()=>{x(),o=void 0,l=null},g=()=>{u()},b=function(...y){if(i!=null&&i.aborted)return;o=this,l=y;const A=m==null;p(),d&&A&&u()};return b.schedule=p,b.cancel=v,b.flush=g,i==null||i.addEventListener("abort",v,{once:!0}),b}e.debounce=t})(qy);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qy;function r(a,i=0,s={}){typeof s!="object"&&(s={});const{leading:o=!1,trailing:l=!0,maxWait:d}=s,f=Array(2);o&&(f[0]="leading"),l&&(f[1]="trailing");let u,h=null;const m=t.debounce(function(...v){u=a.apply(this,v),h=null},i,{edges:f}),p=function(...v){return d!=null&&(h===null&&(h=Date.now()),Date.now()-h>=d)?(u=a.apply(this,v),h=Date.now(),m.cancel(),m.schedule(),u):(m.apply(this,v),u)},x=()=>(m.flush(),u);return p.cancel=m.cancel,p.flush=x,p}e.debounce=r})(Fy);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fy;function r(a,i=0,s={}){const{leading:o=!0,trailing:l=!0}=s;return t.debounce(a,i,{leading:o,maxWait:i,trailing:l})}e.throttle=r})(By);var w2=By.throttle;const S2=Gr(w2);var no=function(t,r){for(var a=arguments.length,i=new Array(a>2?a-2:0),s=2;s<a;s++)i[s-2]=arguments[s]},Uy=(e,t,r)=>{var{width:a="100%",height:i="100%",aspect:s,maxHeight:o}=r,l=Sr(a)?e:Number(a),d=Sr(i)?t:Number(i);return s&&s>0&&(l?d=l/s:d&&(l=d*s),o&&d!=null&&d>o&&(d=o)),{calculatedWidth:l,calculatedHeight:d}},N2={width:0,height:0,overflow:"visible"},k2={width:0,overflowX:"visible"},A2={height:0,overflowY:"visible"},C2={},P2=e=>{var{width:t,height:r}=e,a=Sr(t),i=Sr(r);return a&&i?N2:a?k2:i?A2:C2};function E2(e){var{width:t,height:r,aspect:a}=e,i=t,s=r;return i===void 0&&s===void 0?(i="100%",s="100%"):i===void 0?i=a&&a>0?void 0:"100%":s===void 0&&(s=a&&a>0?void 0:"100%"),{width:i,height:s}}function $t(e){return Number.isFinite(e)}function cr(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Rc(){return Rc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Rc.apply(null,arguments)}function Eh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Ih(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Eh(Object(r),!0).forEach(function(a){I2(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Eh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function I2(e,t,r){return(t=T2(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function T2(e){var t=O2(e,"string");return typeof t=="symbol"?t:t+""}function O2(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Hy=c.createContext({width:-1,height:-1});function _2(e){return cr(e.width)&&cr(e.height)}function Ky(e){var{children:t,width:r,height:a}=e,i=c.useMemo(()=>({width:r,height:a}),[r,a]);return _2(i)?c.createElement(Hy.Provider,{value:i},t):null}var Hd=()=>c.useContext(Hy),M2=c.forwardRef((e,t)=>{var{aspect:r,initialDimension:a={width:-1,height:-1},width:i,height:s,minWidth:o=0,minHeight:l,maxHeight:d,children:f,debounce:u=0,id:h,className:m,onResize:p,style:x={}}=e,v=c.useRef(null),g=c.useRef();g.current=p,c.useImperativeHandle(t,()=>v.current);var[b,y]=c.useState({containerWidth:a.width,containerHeight:a.height}),A=c.useCallback((O,D)=>{y(W=>{var j=Math.round(O),S=Math.round(D);return W.containerWidth===j&&W.containerHeight===S?W:{containerWidth:j,containerHeight:S}})},[]);c.useEffect(()=>{if(v.current==null||typeof ResizeObserver>"u")return Aa;var O=S=>{var R,{width:I,height:$}=S[0].contentRect;A(I,$),(R=g.current)===null||R===void 0||R.call(g,I,$)};u>0&&(O=S2(O,u,{trailing:!0,leading:!1}));var D=new ResizeObserver(O),{width:W,height:j}=v.current.getBoundingClientRect();return A(W,j),D.observe(v.current),()=>{D.disconnect()}},[A,u]);var{containerWidth:C,containerHeight:N}=b;no(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:w,calculatedHeight:M}=Uy(C,N,{width:i,height:s,aspect:r,maxHeight:d});return no(w!=null&&w>0||M!=null&&M>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,w,M,i,s,o,l,r),c.createElement("div",{id:h?"".concat(h):void 0,className:et("recharts-responsive-container",m),style:Ih(Ih({},x),{},{width:i,height:s,minWidth:o,minHeight:l,maxHeight:d}),ref:v},c.createElement("div",{style:P2({width:i,height:s})},c.createElement(Ky,{width:w,height:M},f)))}),ro=c.forwardRef((e,t)=>{var r=Hd();if(cr(r.width)&&cr(r.height))return e.children;var{width:a,height:i}=E2({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:s,calculatedHeight:o}=Uy(void 0,void 0,{width:a,height:i,aspect:e.aspect,maxHeight:e.maxHeight});return _e(s)&&_e(o)?c.createElement(Ky,{width:s,height:o},e.children):c.createElement(M2,Rc({},e,{width:a,height:i,ref:t}))});function Yy(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var al=()=>{var e,t=fn(),r=Me(b2),a=Me(rl),i=(e=Me(nl))===null||e===void 0?void 0:e.padding;return!t||!a||!i?r:{width:a.width-i.left-i.right,height:a.height-i.top-i.bottom,x:i.left,y:i.top}},D2={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},Gy=()=>{var e;return(e=Me(Kt))!==null&&e!==void 0?e:D2},Vy=()=>Me(Ir),Xy=()=>Me(Tr),Je=e=>e.layout.layoutType,Yi=()=>Me(Je),$2=()=>{var e=Yi();return e!==void 0},il=e=>{var t=St(),r=fn(),{width:a,height:i}=e,s=Hd(),o=a,l=i;return s&&(o=s.width>0?s.width:a,l=s.height>0?s.height:i),c.useEffect(()=>{!r&&cr(o)&&cr(l)&&t(HN({width:o,height:l}))},[t,r,o,l]),null},L2={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},Qy=Sn({name:"legend",initialState:L2,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Ht()},removeLegendPayload:{reducer(e,t){var r=jr(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:Ht()}}}),{setLegendSize:fL,setLegendSettings:hL,addLegendPayload:Jy,removeLegendPayload:Zy}=Qy.actions,R2=Qy.reducer;function zc(){return zc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},zc.apply(null,arguments)}function Th(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function ic(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Th(Object(r),!0).forEach(function(a){z2(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Th(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function z2(e,t,r){return(t=W2(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function W2(e){var t=B2(e,"string");return typeof t=="symbol"?t:t+""}function B2(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function F2(e){return Array.isArray(e)&&lr(e[0])&&lr(e[1])?e.join(" ~ "):e}var q2=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:a={},labelStyle:i={},payload:s,formatter:o,itemSorter:l,wrapperClassName:d,labelClassName:f,label:u,labelFormatter:h,accessibilityLayer:m=!1}=e,p=()=>{if(s&&s.length){var N={padding:0,margin:0},w=(l?Go(s,l):s).map((M,O)=>{if(M.type==="none")return null;var D=M.formatter||o||F2,{value:W,name:j}=M,S=W,R=j;if(D){var I=D(W,j,M,O,s);if(Array.isArray(I))[S,R]=I;else if(I!=null)S=I;else return null}var $=ic({display:"block",paddingTop:4,paddingBottom:4,color:M.color||"#000"},a);return c.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(O),style:$},lr(R)?c.createElement("span",{className:"recharts-tooltip-item-name"},R):null,lr(R)?c.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,c.createElement("span",{className:"recharts-tooltip-item-value"},S),c.createElement("span",{className:"recharts-tooltip-item-unit"},M.unit||""))});return c.createElement("ul",{className:"recharts-tooltip-item-list",style:N},w)}return null},x=ic({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),v=ic({margin:0},i),g=!wt(u),b=g?u:"",y=et("recharts-default-tooltip",d),A=et("recharts-tooltip-label",f);g&&h&&s!==void 0&&s!==null&&(b=h(u,s));var C=m?{role:"status","aria-live":"assertive"}:{};return c.createElement("div",zc({className:y,style:x},C),c.createElement("p",{className:A,style:v},c.isValidElement(b)?b:"".concat(b)),p())},gi="recharts-tooltip-wrapper",U2={visibility:"hidden"};function H2(e){var{coordinate:t,translateX:r,translateY:a}=e;return et(gi,{["".concat(gi,"-right")]:_e(r)&&t&&_e(t.x)&&r>=t.x,["".concat(gi,"-left")]:_e(r)&&t&&_e(t.x)&&r<t.x,["".concat(gi,"-bottom")]:_e(a)&&t&&_e(t.y)&&a>=t.y,["".concat(gi,"-top")]:_e(a)&&t&&_e(t.y)&&a<t.y})}function Oh(e){var{allowEscapeViewBox:t,coordinate:r,key:a,offsetTopLeft:i,position:s,reverseDirection:o,tooltipDimension:l,viewBox:d,viewBoxDimension:f}=e;if(s&&_e(s[a]))return s[a];var u=r[a]-l-(i>0?i:0),h=r[a]+i;if(t[a])return o[a]?u:h;var m=d[a];if(m==null)return 0;if(o[a]){var p=u,x=m;return p<x?Math.max(h,m):Math.max(u,m)}if(f==null)return 0;var v=h+l,g=m+f;return v>g?Math.max(u,m):Math.max(h,m)}function K2(e){var{translateX:t,translateY:r,useTranslate3d:a}=e;return{transform:a?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function Y2(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:a,position:i,reverseDirection:s,tooltipBox:o,useTranslate3d:l,viewBox:d}=e,f,u,h;return o.height>0&&o.width>0&&r?(u=Oh({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o.width,viewBox:d,viewBoxDimension:d.width}),h=Oh({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o.height,viewBox:d,viewBoxDimension:d.height}),f=K2({translateX:u,translateY:h,useTranslate3d:l})):f=U2,{cssProperties:f,cssClasses:H2({translateX:u,translateY:h,coordinate:r})}}function _h(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Ts(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_h(Object(r),!0).forEach(function(a){Wc(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_h(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Wc(e,t,r){return(t=G2(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function G2(e){var t=V2(e,"string");return typeof t=="symbol"?t:t+""}function V2(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class X2 extends c.PureComponent{constructor(){super(...arguments),Wc(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Wc(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,a,i,s;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(a=this.props.coordinate)===null||a===void 0?void 0:a.x)!==null&&r!==void 0?r:0,y:(i=(s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:a,animationEasing:i,children:s,coordinate:o,hasPayload:l,isAnimationActive:d,offset:f,position:u,reverseDirection:h,useTranslate3d:m,viewBox:p,wrapperStyle:x,lastBoundingBox:v,innerRef:g,hasPortalFromProps:b}=this.props,{cssClasses:y,cssProperties:A}=Y2({allowEscapeViewBox:r,coordinate:o,offsetTopLeft:f,position:u,reverseDirection:h,tooltipBox:{height:v.height,width:v.width},useTranslate3d:m,viewBox:p}),C=b?{}:Ts(Ts({transition:d&&t?"transform ".concat(a,"ms ").concat(i):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&l?"visible":"hidden",position:"absolute",top:0,left:0}),N=Ts(Ts({},C),{},{visibility:!this.state.dismissed&&t&&l?"visible":"hidden"},x);return c.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:y,style:N,ref:g},s)}}var Q2=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Xr={devToolsEnabled:!1,isSsr:Q2()},ev=()=>{var e;return(e=Me(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function Bc(){return Bc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Bc.apply(null,arguments)}function Mh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Dh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Mh(Object(r),!0).forEach(function(a){J2(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Mh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function J2(e,t,r){return(t=Z2(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Z2(e){var t=ek(e,"string");return typeof t=="symbol"?t:t+""}function ek(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $h={curveBasisClosed:Dw,curveBasisOpen:$w,curveBasis:Mw,curveBumpX:bw,curveBumpY:jw,curveLinearClosed:Lw,curveLinear:Wo,curveMonotoneX:Rw,curveMonotoneY:zw,curveNatural:Ww,curveStep:Bw,curveStepAfter:qw,curveStepBefore:Fw},ao=e=>$t(e.x)&&$t(e.y),Lh=e=>e.base!=null&&ao(e.base)&&ao(e),yi=e=>e.x,vi=e=>e.y,tk=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(qi(e));return(r==="curveMonotone"||r==="curveBump")&&t?$h["".concat(r).concat(t==="vertical"?"Y":"X")]:$h[r]||Wo},nk=e=>{var{type:t="linear",points:r=[],baseLine:a,layout:i,connectNulls:s=!1}=e,o=tk(t,i),l=s?r.filter(ao):r,d;if(Array.isArray(a)){var f=r.map((p,x)=>Dh(Dh({},p),{},{base:a[x]}));i==="vertical"?d=Ns().y(vi).x1(yi).x0(p=>p.base.x):d=Ns().x(yi).y1(vi).y0(p=>p.base.y);var u=d.defined(Lh).curve(o),h=s?f.filter(Lh):f;return u(h)}i==="vertical"&&_e(a)?d=Ns().y(vi).x1(yi).x0(a):_e(a)?d=Ns().x(yi).y1(vi).y0(a):d=yg().x(yi).y(vi);var m=d.defined(ao).curve(o);return m(l)},Kd=e=>{var{className:t,points:r,path:a,pathRef:i}=e;if((!r||!r.length)&&!a)return null;var s=r&&r.length?nk(e):a;return c.createElement("path",Bc({},Tn(e),Ad(e),{className:et("recharts-curve",t),d:s===null?void 0:s,ref:i}))},rk=["x","y","top","left","width","height","className"];function Fc(){return Fc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Fc.apply(null,arguments)}function Rh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function ak(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rh(Object(r),!0).forEach(function(a){ik(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function ik(e,t,r){return(t=sk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sk(e){var t=ok(e,"string");return typeof t=="symbol"?t:t+""}function ok(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lk(e,t){if(e==null)return{};var r,a,i=ck(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function ck(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var dk=(e,t,r,a,i,s)=>"M".concat(e,",").concat(i,"v").concat(a,"M").concat(s,",").concat(t,"h").concat(r),uk=e=>{var{x:t=0,y:r=0,top:a=0,left:i=0,width:s=0,height:o=0,className:l}=e,d=lk(e,rk),f=ak({x:t,y:r,top:a,left:i,width:s,height:o},d);return!_e(t)||!_e(r)||!_e(s)||!_e(o)||!_e(a)||!_e(i)?null:c.createElement("path",Fc({},yn(f),{className:et("recharts-cross",l),d:dk(t,r,s,o,a,i)}))};function fk(e,t,r,a){var i=a/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?a:r.width-1,height:e==="horizontal"?r.height-1:a}}function zh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Wh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zh(Object(r),!0).forEach(function(a){hk(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function hk(e,t,r){return(t=mk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mk(e){var t=pk(e,"string");return typeof t=="symbol"?t:t+""}function pk(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var gk=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),tv=(e,t,r)=>e.map(a=>"".concat(gk(a)," ").concat(t,"ms ").concat(r)).join(","),yk=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,a)=>r.filter(i=>a.includes(i))),Mi=(e,t)=>Object.keys(t).reduce((r,a)=>Wh(Wh({},r),{},{[a]:e(a,t[a])}),{});function Bh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Ut(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bh(Object(r),!0).forEach(function(a){vk(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function vk(e,t,r){return(t=xk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xk(e){var t=bk(e,"string");return typeof t=="symbol"?t:t+""}function bk(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var io=(e,t,r)=>e+(t-e)*r,qc=e=>{var{from:t,to:r}=e;return t!==r},nv=(e,t,r)=>{var a=Mi((i,s)=>{if(qc(s)){var[o,l]=e(s.from,s.to,s.velocity);return Ut(Ut({},s),{},{from:o,velocity:l})}return s},t);return r<1?Mi((i,s)=>qc(s)?Ut(Ut({},s),{},{velocity:io(s.velocity,a[i].velocity,r),from:io(s.from,a[i].from,r)}):s,t):nv(e,a,r-1)};function jk(e,t,r,a,i,s){var o,l=a.reduce((m,p)=>Ut(Ut({},m),{},{[p]:{from:e[p],velocity:0,to:t[p]}}),{}),d=()=>Mi((m,p)=>p.from,l),f=()=>!Object.values(l).filter(qc).length,u=null,h=m=>{o||(o=m);var p=m-o,x=p/r.dt;l=nv(r,l,x),i(Ut(Ut(Ut({},e),t),d())),o=m,f()||(u=s.setTimeout(h))};return()=>(u=s.setTimeout(h),()=>{var m;(m=u)===null||m===void 0||m()})}function wk(e,t,r,a,i,s,o){var l=null,d=i.reduce((h,m)=>Ut(Ut({},h),{},{[m]:[e[m],t[m]]}),{}),f,u=h=>{f||(f=h);var m=(h-f)/a,p=Mi((v,g)=>io(...g,r(m)),d);if(s(Ut(Ut(Ut({},e),t),p)),m<1)l=o.setTimeout(u);else{var x=Mi((v,g)=>io(...g,r(1)),d);s(Ut(Ut(Ut({},e),t),x))}};return()=>(l=o.setTimeout(u),()=>{var h;(h=l)===null||h===void 0||h()})}const Sk=(e,t,r,a,i,s)=>{var o=yk(e,t);return r==null?()=>(i(Ut(Ut({},e),t)),()=>{}):r.isStepper===!0?jk(e,t,r,o,i,s):wk(e,t,r,a,o,i,s)};var so=1e-4,rv=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],av=(e,t)=>e.map((r,a)=>r*t**a).reduce((r,a)=>r+a),Fh=(e,t)=>r=>{var a=rv(e,t);return av(a,r)},Nk=(e,t)=>r=>{var a=rv(e,t),i=[...a.map((s,o)=>s*o).slice(1),0];return av(i,r)},kk=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var i,s=r[0].split("(");if(s[0]==="cubic-bezier"&&((i=s[1])===null||i===void 0?void 0:i.split(")")[0].split(",").length)===4){var o=s[1].split(")")[0].split(",").map(l=>parseFloat(l));return[o[0],o[1],o[2],o[3]]}}}return r.length===4?r:[0,0,1,1]},Ak=(e,t,r,a)=>{var i=Fh(e,r),s=Fh(t,a),o=Nk(e,r),l=f=>f>1?1:f<0?0:f,d=f=>{for(var u=f>1?1:f,h=u,m=0;m<8;++m){var p=i(h)-u,x=o(h);if(Math.abs(p-u)<so||x<so)return s(h);h=l(h-p/x)}return s(h)};return d.isStepper=!1,d},qh=function(){return Ak(...kk(...arguments))},Ck=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:a=8,dt:i=17}=t,s=(o,l,d)=>{var f=-(o-l)*r,u=d*a,h=d+(f-u)*i/1e3,m=d*i/1e3+o;return Math.abs(m-l)<so&&Math.abs(h)<so?[l,0]:[m,h]};return s.isStepper=!0,s.dt=i,s},Pk=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return qh(e);case"spring":return Ck();default:if(e.split("(")[0]==="cubic-bezier")return qh(e)}return typeof e=="function"?e:null};function Ek(e){var t,r=()=>null,a=!1,i=null,s=o=>{if(!a){if(Array.isArray(o)){if(!o.length)return;var l=o,[d,...f]=l;if(typeof d=="number"){i=e.setTimeout(s.bind(null,f),d);return}s(d),i=e.setTimeout(s.bind(null,f));return}typeof o=="string"&&(t=o,r(t)),typeof o=="object"&&(t=o,r(t)),typeof o=="function"&&o()}};return{stop:()=>{a=!0},start:o=>{a=!1,i&&(i(),i=null),s(o)},subscribe:o=>(r=o,()=>{r=()=>null}),getTimeoutController:()=>e}}class Ik{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=performance.now(),i=null,s=o=>{o-a>=r?t(o):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(s))};return i=requestAnimationFrame(s),()=>{i!=null&&cancelAnimationFrame(i)}}}function Tk(){return Ek(new Ik)}var Ok=c.createContext(Tk);function _k(e,t){var r=c.useContext(Ok);return c.useMemo(()=>t??r(e),[e,t,r])}var Mk={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},Uh={t:0},sc={t:1};function Gi(e){var t=en(e,Mk),{isActive:r,canBegin:a,duration:i,easing:s,begin:o,onAnimationEnd:l,onAnimationStart:d,children:f}=t,u=_k(t.animationId,t.animationManager),[h,m]=c.useState(r?Uh:sc),p=c.useRef(null);return c.useEffect(()=>{r||m(sc)},[r]),c.useEffect(()=>{if(!r||!a)return Aa;var x=Sk(Uh,sc,Pk(s),i,m,u.getTimeoutController()),v=()=>{p.current=x()};return u.start([d,o,v,i,l]),()=>{u.stop(),p.current&&p.current(),l()}},[r,a,i,s,o,d,l,u]),f(h.t)}function Vi(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=c.useRef(Ii(t)),a=c.useRef(e);return a.current!==e&&(r.current=Ii(t),a.current=e),r.current}var Dk=["radius"],$k=["radius"];function Hh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Kh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hh(Object(r),!0).forEach(function(a){Lk(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Lk(e,t,r){return(t=Rk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Rk(e){var t=zk(e,"string");return typeof t=="symbol"?t:t+""}function zk(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function oo(){return oo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},oo.apply(null,arguments)}function Yh(e,t){if(e==null)return{};var r,a,i=Wk(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Wk(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Gh=(e,t,r,a,i)=>{var s=Math.min(Math.abs(r)/2,Math.abs(a)/2),o=a>=0?1:-1,l=r>=0?1:-1,d=a>=0&&r>=0||a<0&&r<0?1:0,f;if(s>0&&i instanceof Array){for(var u=[0,0,0,0],h=0,m=4;h<m;h++)u[h]=i[h]>s?s:i[h];f="M".concat(e,",").concat(t+o*u[0]),u[0]>0&&(f+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(d,",").concat(e+l*u[0],",").concat(t)),f+="L ".concat(e+r-l*u[1],",").concat(t),u[1]>0&&(f+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(d,`,
        `).concat(e+r,",").concat(t+o*u[1])),f+="L ".concat(e+r,",").concat(t+a-o*u[2]),u[2]>0&&(f+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(d,`,
        `).concat(e+r-l*u[2],",").concat(t+a)),f+="L ".concat(e+l*u[3],",").concat(t+a),u[3]>0&&(f+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(d,`,
        `).concat(e,",").concat(t+a-o*u[3])),f+="Z"}else if(s>0&&i===+i&&i>0){var p=Math.min(s,i);f="M ".concat(e,",").concat(t+o*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(d,",").concat(e+l*p,",").concat(t,`
            L `).concat(e+r-l*p,",").concat(t,`
            A `).concat(p,",").concat(p,",0,0,").concat(d,",").concat(e+r,",").concat(t+o*p,`
            L `).concat(e+r,",").concat(t+a-o*p,`
            A `).concat(p,",").concat(p,",0,0,").concat(d,",").concat(e+r-l*p,",").concat(t+a,`
            L `).concat(e+l*p,",").concat(t+a,`
            A `).concat(p,",").concat(p,",0,0,").concat(d,",").concat(e,",").concat(t+a-o*p," Z")}else f="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(a," h ").concat(-r," Z");return f},Vh={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},iv=e=>{var t=en(e,Vh),r=c.useRef(null),[a,i]=c.useState(-1);c.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var q=r.current.getTotalLength();q&&i(q)}catch{}},[]);var{x:s,y:o,width:l,height:d,radius:f,className:u}=t,{animationEasing:h,animationDuration:m,animationBegin:p,isAnimationActive:x,isUpdateAnimationActive:v}=t,g=c.useRef(l),b=c.useRef(d),y=c.useRef(s),A=c.useRef(o),C=c.useMemo(()=>({x:s,y:o,width:l,height:d,radius:f}),[s,o,l,d,f]),N=Vi(C,"rectangle-");if(s!==+s||o!==+o||l!==+l||d!==+d||l===0||d===0)return null;var w=et("recharts-rectangle",u);if(!v){var M=yn(t),{radius:O}=M,D=Yh(M,Dk);return c.createElement("path",oo({},D,{radius:typeof f=="number"?f:void 0,className:w,d:Gh(s,o,l,d,f)}))}var W=g.current,j=b.current,S=y.current,R=A.current,I="0px ".concat(a===-1?1:a,"px"),$="".concat(a,"px 0px"),J=tv(["strokeDasharray"],m,typeof h=="string"?h:Vh.animationEasing);return c.createElement(Gi,{animationId:N,key:N,canBegin:a>0,duration:m,easing:h,isActive:v,begin:p},q=>{var K=xt(W,l,q),L=xt(j,d,q),ee=xt(S,s,q),E=xt(R,o,q);r.current&&(g.current=K,b.current=L,y.current=ee,A.current=E);var T;x?q>0?T={transition:J,strokeDasharray:$}:T={strokeDasharray:I}:T={strokeDasharray:$};var B=yn(t),{radius:P}=B,_=Yh(B,$k);return c.createElement("path",oo({},_,{radius:typeof f=="number"?f:void 0,className:w,d:Gh(ee,E,K,L,f),ref:r,style:Kh(Kh({},T),t.style)}))})};function Xh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Qh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xh(Object(r),!0).forEach(function(a){Bk(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xh(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function Bk(e,t,r){return(t=Fk(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fk(e){var t=qk(e,"string");return typeof t=="symbol"?t:t+""}function qk(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var lo=Math.PI/180,Uk=e=>e*180/Math.PI,Wt=(e,t,r,a)=>({x:e+Math.cos(-lo*a)*r,y:t+Math.sin(-lo*a)*r}),sv=function(t,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(a.left||0)-(a.right||0)),Math.abs(r-(a.top||0)-(a.bottom||0)))/2},Hk=(e,t)=>{var{x:r,y:a}=e,{x:i,y:s}=t;return Math.sqrt((r-i)**2+(a-s)**2)},Kk=(e,t)=>{var{x:r,y:a}=e,{cx:i,cy:s}=t,o=Hk({x:r,y:a},{x:i,y:s});if(o<=0)return{radius:o,angle:0};var l=(r-i)/o,d=Math.acos(l);return a>s&&(d=2*Math.PI-d),{radius:o,angle:Uk(d),angleInRadian:d}},Yk=e=>{var{startAngle:t,endAngle:r}=e,a=Math.floor(t/360),i=Math.floor(r/360),s=Math.min(a,i);return{startAngle:t-s*360,endAngle:r-s*360}},Gk=(e,t)=>{var{startAngle:r,endAngle:a}=t,i=Math.floor(r/360),s=Math.floor(a/360),o=Math.min(i,s);return e+o*360},Vk=(e,t)=>{var{chartX:r,chartY:a}=e,{radius:i,angle:s}=Kk({x:r,y:a},t),{innerRadius:o,outerRadius:l}=t;if(i<o||i>l||i===0)return null;var{startAngle:d,endAngle:f}=Yk(t),u=s,h;if(d<=f){for(;u>f;)u-=360;for(;u<d;)u+=360;h=u>=d&&u<=f}else{for(;u>d;)u-=360;for(;u<f;)u+=360;h=u>=f&&u<=d}return h?Qh(Qh({},t),{},{radius:i,angle:Gk(u,t)}):null};function ov(e){var{cx:t,cy:r,radius:a,startAngle:i,endAngle:s}=e,o=Wt(t,r,a,i),l=Wt(t,r,a,s);return{points:[o,l],cx:t,cy:r,radius:a,startAngle:i,endAngle:s}}function Uc(){return Uc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Uc.apply(null,arguments)}var Xk=(e,t)=>{var r=Jt(t-e),a=Math.min(Math.abs(t-e),359.999);return r*a},Os=e=>{var{cx:t,cy:r,radius:a,angle:i,sign:s,isExternal:o,cornerRadius:l,cornerIsExternal:d}=e,f=l*(o?1:-1)+a,u=Math.asin(l/f)/lo,h=d?i:i+s*u,m=Wt(t,r,f,h),p=Wt(t,r,a,h),x=d?i-s*u:i,v=Wt(t,r,f*Math.cos(u*lo),x);return{center:m,circleTangency:p,lineTangency:v,theta:u}},lv=e=>{var{cx:t,cy:r,innerRadius:a,outerRadius:i,startAngle:s,endAngle:o}=e,l=Xk(s,o),d=s+l,f=Wt(t,r,i,s),u=Wt(t,r,i,d),h="M ".concat(f.x,",").concat(f.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(s>d),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(a>0){var m=Wt(t,r,a,s),p=Wt(t,r,a,d);h+="L ".concat(p.x,",").concat(p.y,`
            A `).concat(a,",").concat(a,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(s<=d),`,
            `).concat(m.x,",").concat(m.y," Z")}else h+="L ".concat(t,",").concat(r," Z");return h},Qk=e=>{var{cx:t,cy:r,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:d,endAngle:f}=e,u=Jt(f-d),{circleTangency:h,lineTangency:m,theta:p}=Os({cx:t,cy:r,radius:i,angle:d,sign:u,cornerRadius:s,cornerIsExternal:l}),{circleTangency:x,lineTangency:v,theta:g}=Os({cx:t,cy:r,radius:i,angle:f,sign:-u,cornerRadius:s,cornerIsExternal:l}),b=l?Math.abs(d-f):Math.abs(d-f)-p-g;if(b<0)return o?"M ".concat(m.x,",").concat(m.y,`
        a`).concat(s,",").concat(s,",0,0,1,").concat(s*2,`,0
        a`).concat(s,",").concat(s,",0,0,1,").concat(-s*2,`,0
      `):lv({cx:t,cy:r,innerRadius:a,outerRadius:i,startAngle:d,endAngle:f});var y="M ".concat(m.x,",").concat(m.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(b>180),",").concat(+(u<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
  `);if(a>0){var{circleTangency:A,lineTangency:C,theta:N}=Os({cx:t,cy:r,radius:a,angle:d,sign:u,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),{circleTangency:w,lineTangency:M,theta:O}=Os({cx:t,cy:r,radius:a,angle:f,sign:-u,isExternal:!0,cornerRadius:s,cornerIsExternal:l}),D=l?Math.abs(d-f):Math.abs(d-f)-N-O;if(D<0&&s===0)return"".concat(y,"L").concat(t,",").concat(r,"Z");y+="L".concat(M.x,",").concat(M.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(w.x,",").concat(w.y,`
      A`).concat(a,",").concat(a,",0,").concat(+(D>180),",").concat(+(u>0),",").concat(A.x,",").concat(A.y,`
      A`).concat(s,",").concat(s,",0,0,").concat(+(u<0),",").concat(C.x,",").concat(C.y,"Z")}else y+="L".concat(t,",").concat(r,"Z");return y},Jk={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},cv=e=>{var t=en(e,Jk),{cx:r,cy:a,innerRadius:i,outerRadius:s,cornerRadius:o,forceCornerRadius:l,cornerIsExternal:d,startAngle:f,endAngle:u,className:h}=t;if(s<i||f===u)return null;var m=et("recharts-sector",h),p=s-i,x=un(o,p,0,!0),v;return x>0&&Math.abs(f-u)<360?v=Qk({cx:r,cy:a,innerRadius:i,outerRadius:s,cornerRadius:Math.min(x,p/2),forceCornerRadius:l,cornerIsExternal:d,startAngle:f,endAngle:u}):v=lv({cx:r,cy:a,innerRadius:i,outerRadius:s,startAngle:f,endAngle:u}),c.createElement("path",Uc({},yn(t),{className:m,d:v}))};function Zk(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(Mg(t)){if(e==="centric"){var{cx:a,cy:i,innerRadius:s,outerRadius:o,angle:l}=t,d=Wt(a,i,s,l),f=Wt(a,i,o,l);return[{x:d.x,y:d.y},{x:f.x,y:f.y}]}return ov(t)}}var dv={},uv={},fv={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ld;function r(a){return t.isSymbol(a)?NaN:Number(a)}e.toNumber=r})(fv);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=fv;function r(a){return a?(a=t.toNumber(a),a===1/0||a===-1/0?(a<0?-1:1)*Number.MAX_VALUE:a===a?a:0):a===0?a:0}e.toFinite=r})(uv);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Rd,r=uv;function a(i,s,o){o&&typeof o!="number"&&t.isIterateeCall(i,s,o)&&(s=o=void 0),i=r.toFinite(i),s===void 0?(s=i,i=0):s=r.toFinite(s),o=o===void 0?i<s?1:-1:r.toFinite(o);const l=Math.max(Math.ceil((s-i)/(o||1)),0),d=new Array(l);for(let f=0;f<l;f++)d[f]=i,i+=o;return d}e.range=a})(dv);var eA=dv.range;const hv=Gr(eA);function qr(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function tA(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Yd(e){let t,r,a;e.length!==2?(t=qr,r=(l,d)=>qr(e(l),d),a=(l,d)=>e(l)-d):(t=e===qr||e===tA?e:nA,r=e,a=e);function i(l,d,f=0,u=l.length){if(f<u){if(t(d,d)!==0)return u;do{const h=f+u>>>1;r(l[h],d)<0?f=h+1:u=h}while(f<u)}return f}function s(l,d,f=0,u=l.length){if(f<u){if(t(d,d)!==0)return u;do{const h=f+u>>>1;r(l[h],d)<=0?f=h+1:u=h}while(f<u)}return f}function o(l,d,f=0,u=l.length){const h=i(l,d,f,u-1);return h>f&&a(l[h-1],d)>-a(l[h],d)?h-1:h}return{left:i,center:o,right:s}}function nA(){return 0}function mv(e){return e===null?NaN:+e}function*rA(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const aA=Yd(qr),Xi=aA.right;Yd(mv).center;class Jh extends Map{constructor(t,r=oA){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[a,i]of t)this.set(a,i)}get(t){return super.get(Zh(this,t))}has(t){return super.has(Zh(this,t))}set(t,r){return super.set(iA(this,t),r)}delete(t){return super.delete(sA(this,t))}}function Zh({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):r}function iA({_intern:e,_key:t},r){const a=t(r);return e.has(a)?e.get(a):(e.set(a,r),r)}function sA({_intern:e,_key:t},r){const a=t(r);return e.has(a)&&(r=e.get(a),e.delete(a)),r}function oA(e){return e!==null&&typeof e=="object"?e.valueOf():e}function lA(e=qr){if(e===qr)return pv;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const a=e(t,r);return a||a===0?a:(e(r,r)===0)-(e(t,t)===0)}}function pv(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const cA=Math.sqrt(50),dA=Math.sqrt(10),uA=Math.sqrt(2);function co(e,t,r){const a=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(a)),s=a/Math.pow(10,i),o=s>=cA?10:s>=dA?5:s>=uA?2:1;let l,d,f;return i<0?(f=Math.pow(10,-i)/o,l=Math.round(e*f),d=Math.round(t*f),l/f<e&&++l,d/f>t&&--d,f=-f):(f=Math.pow(10,i)*o,l=Math.round(e/f),d=Math.round(t/f),l*f<e&&++l,d*f>t&&--d),d<l&&.5<=r&&r<2?co(e,t,r*2):[l,d,f]}function Hc(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const a=t<e,[i,s,o]=a?co(t,e,r):co(e,t,r);if(!(s>=i))return[];const l=s-i+1,d=new Array(l);if(a)if(o<0)for(let f=0;f<l;++f)d[f]=(s-f)/-o;else for(let f=0;f<l;++f)d[f]=(s-f)*o;else if(o<0)for(let f=0;f<l;++f)d[f]=(i+f)/-o;else for(let f=0;f<l;++f)d[f]=(i+f)*o;return d}function Kc(e,t,r){return t=+t,e=+e,r=+r,co(e,t,r)[2]}function Yc(e,t,r){t=+t,e=+e,r=+r;const a=t<e,i=a?Kc(t,e,r):Kc(e,t,r);return(a?-1:1)*(i<0?1/-i:i)}function em(e,t){let r;for(const a of e)a!=null&&(r<a||r===void 0&&a>=a)&&(r=a);return r}function tm(e,t){let r;for(const a of e)a!=null&&(r>a||r===void 0&&a>=a)&&(r=a);return r}function gv(e,t,r=0,a=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),a=Math.floor(Math.min(e.length-1,a)),!(r<=t&&t<=a))return e;for(i=i===void 0?pv:lA(i);a>r;){if(a-r>600){const d=a-r+1,f=t-r+1,u=Math.log(d),h=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*h*(d-h)/d)*(f-d/2<0?-1:1),p=Math.max(r,Math.floor(t-f*h/d+m)),x=Math.min(a,Math.floor(t+(d-f)*h/d+m));gv(e,t,p,x,i)}const s=e[t];let o=r,l=a;for(xi(e,r,t),i(e[a],s)>0&&xi(e,r,a);o<l;){for(xi(e,o,l),++o,--l;i(e[o],s)<0;)++o;for(;i(e[l],s)>0;)--l}i(e[r],s)===0?xi(e,r,l):(++l,xi(e,l,a)),l<=t&&(r=l+1),t<=l&&(a=l-1)}return e}function xi(e,t,r){const a=e[t];e[t]=e[r],e[r]=a}function fA(e,t,r){if(e=Float64Array.from(rA(e)),!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return tm(e);if(t>=1)return em(e);var a,i=(a-1)*t,s=Math.floor(i),o=em(gv(e,s).subarray(0,s+1)),l=tm(e.subarray(s+1));return o+(l-o)*(i-s)}}function hA(e,t,r=mv){if(!(!(a=e.length)||isNaN(t=+t))){if(t<=0||a<2)return+r(e[0],0,e);if(t>=1)return+r(e[a-1],a-1,e);var a,i=(a-1)*t,s=Math.floor(i),o=+r(e[s],s,e),l=+r(e[s+1],s+1,e);return o+(l-o)*(i-s)}}function mA(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var a=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,s=new Array(i);++a<i;)s[a]=e+a*r;return s}function qn(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Or(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Gc=Symbol("implicit");function Gd(){var e=new Jh,t=[],r=[],a=Gc;function i(s){let o=e.get(s);if(o===void 0){if(a!==Gc)return a;e.set(s,o=t.push(s)-1)}return r[o%r.length]}return i.domain=function(s){if(!arguments.length)return t.slice();t=[],e=new Jh;for(const o of s)e.has(o)||e.set(o,t.push(o)-1);return i},i.range=function(s){return arguments.length?(r=Array.from(s),i):r.slice()},i.unknown=function(s){return arguments.length?(a=s,i):a},i.copy=function(){return Gd(t,r).unknown(a)},qn.apply(i,arguments),i}function Vd(){var e=Gd().unknown(void 0),t=e.domain,r=e.range,a=0,i=1,s,o,l=!1,d=0,f=0,u=.5;delete e.unknown;function h(){var m=t().length,p=i<a,x=p?i:a,v=p?a:i;s=(v-x)/Math.max(1,m-d+f*2),l&&(s=Math.floor(s)),x+=(v-x-s*(m-d))*u,o=s*(1-d),l&&(x=Math.round(x),o=Math.round(o));var g=mA(m).map(function(b){return x+s*b});return r(p?g.reverse():g)}return e.domain=function(m){return arguments.length?(t(m),h()):t()},e.range=function(m){return arguments.length?([a,i]=m,a=+a,i=+i,h()):[a,i]},e.rangeRound=function(m){return[a,i]=m,a=+a,i=+i,l=!0,h()},e.bandwidth=function(){return o},e.step=function(){return s},e.round=function(m){return arguments.length?(l=!!m,h()):l},e.padding=function(m){return arguments.length?(d=Math.min(1,f=+m),h()):d},e.paddingInner=function(m){return arguments.length?(d=Math.min(1,m),h()):d},e.paddingOuter=function(m){return arguments.length?(f=+m,h()):f},e.align=function(m){return arguments.length?(u=Math.max(0,Math.min(1,m)),h()):u},e.copy=function(){return Vd(t(),[a,i]).round(l).paddingInner(d).paddingOuter(f).align(u)},qn.apply(h(),arguments)}function yv(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return yv(t())},e}function pA(){return yv(Vd.apply(null,arguments).paddingInner(1))}function Xd(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function vv(e,t){var r=Object.create(e.prototype);for(var a in t)r[a]=t[a];return r}function Qi(){}var Di=.7,uo=1/Di,Ua="\\s*([+-]?\\d+)\\s*",$i="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",or="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gA=/^#([0-9a-f]{3,8})$/,yA=new RegExp(`^rgb\\(${Ua},${Ua},${Ua}\\)$`),vA=new RegExp(`^rgb\\(${or},${or},${or}\\)$`),xA=new RegExp(`^rgba\\(${Ua},${Ua},${Ua},${$i}\\)$`),bA=new RegExp(`^rgba\\(${or},${or},${or},${$i}\\)$`),jA=new RegExp(`^hsl\\(${$i},${or},${or}\\)$`),wA=new RegExp(`^hsla\\(${$i},${or},${or},${$i}\\)$`),nm={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Xd(Qi,Li,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:rm,formatHex:rm,formatHex8:SA,formatHsl:NA,formatRgb:am,toString:am});function rm(){return this.rgb().formatHex()}function SA(){return this.rgb().formatHex8()}function NA(){return xv(this).formatHsl()}function am(){return this.rgb().formatRgb()}function Li(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=gA.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?im(t):r===3?new wn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?_s(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?_s(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=yA.exec(e))?new wn(t[1],t[2],t[3],1):(t=vA.exec(e))?new wn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=xA.exec(e))?_s(t[1],t[2],t[3],t[4]):(t=bA.exec(e))?_s(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=jA.exec(e))?lm(t[1],t[2]/100,t[3]/100,1):(t=wA.exec(e))?lm(t[1],t[2]/100,t[3]/100,t[4]):nm.hasOwnProperty(e)?im(nm[e]):e==="transparent"?new wn(NaN,NaN,NaN,0):null}function im(e){return new wn(e>>16&255,e>>8&255,e&255,1)}function _s(e,t,r,a){return a<=0&&(e=t=r=NaN),new wn(e,t,r,a)}function kA(e){return e instanceof Qi||(e=Li(e)),e?(e=e.rgb(),new wn(e.r,e.g,e.b,e.opacity)):new wn}function Vc(e,t,r,a){return arguments.length===1?kA(e):new wn(e,t,r,a??1)}function wn(e,t,r,a){this.r=+e,this.g=+t,this.b=+r,this.opacity=+a}Xd(wn,Vc,vv(Qi,{brighter(e){return e=e==null?uo:Math.pow(uo,e),new wn(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Di:Math.pow(Di,e),new wn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new wn(pa(this.r),pa(this.g),pa(this.b),fo(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:sm,formatHex:sm,formatHex8:AA,formatRgb:om,toString:om}));function sm(){return`#${da(this.r)}${da(this.g)}${da(this.b)}`}function AA(){return`#${da(this.r)}${da(this.g)}${da(this.b)}${da((isNaN(this.opacity)?1:this.opacity)*255)}`}function om(){const e=fo(this.opacity);return`${e===1?"rgb(":"rgba("}${pa(this.r)}, ${pa(this.g)}, ${pa(this.b)}${e===1?")":`, ${e})`}`}function fo(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function pa(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function da(e){return e=pa(e),(e<16?"0":"")+e.toString(16)}function lm(e,t,r,a){return a<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Xn(e,t,r,a)}function xv(e){if(e instanceof Xn)return new Xn(e.h,e.s,e.l,e.opacity);if(e instanceof Qi||(e=Li(e)),!e)return new Xn;if(e instanceof Xn)return e;e=e.rgb();var t=e.r/255,r=e.g/255,a=e.b/255,i=Math.min(t,r,a),s=Math.max(t,r,a),o=NaN,l=s-i,d=(s+i)/2;return l?(t===s?o=(r-a)/l+(r<a)*6:r===s?o=(a-t)/l+2:o=(t-r)/l+4,l/=d<.5?s+i:2-s-i,o*=60):l=d>0&&d<1?0:o,new Xn(o,l,d,e.opacity)}function CA(e,t,r,a){return arguments.length===1?xv(e):new Xn(e,t,r,a??1)}function Xn(e,t,r,a){this.h=+e,this.s=+t,this.l=+r,this.opacity=+a}Xd(Xn,CA,vv(Qi,{brighter(e){return e=e==null?uo:Math.pow(uo,e),new Xn(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Di:Math.pow(Di,e),new Xn(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,a=r+(r<.5?r:1-r)*t,i=2*r-a;return new wn(oc(e>=240?e-240:e+120,i,a),oc(e,i,a),oc(e<120?e+240:e-120,i,a),this.opacity)},clamp(){return new Xn(cm(this.h),Ms(this.s),Ms(this.l),fo(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=fo(this.opacity);return`${e===1?"hsl(":"hsla("}${cm(this.h)}, ${Ms(this.s)*100}%, ${Ms(this.l)*100}%${e===1?")":`, ${e})`}`}}));function cm(e){return e=(e||0)%360,e<0?e+360:e}function Ms(e){return Math.max(0,Math.min(1,e||0))}function oc(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Qd=e=>()=>e;function PA(e,t){return function(r){return e+r*t}}function EA(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(a){return Math.pow(e+a*t,r)}}function IA(e){return(e=+e)==1?bv:function(t,r){return r-t?EA(t,r,e):Qd(isNaN(t)?r:t)}}function bv(e,t){var r=t-e;return r?PA(e,r):Qd(isNaN(e)?t:e)}const dm=function e(t){var r=IA(t);function a(i,s){var o=r((i=Vc(i)).r,(s=Vc(s)).r),l=r(i.g,s.g),d=r(i.b,s.b),f=bv(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=l(u),i.b=d(u),i.opacity=f(u),i+""}}return a.gamma=e,a}(1);function TA(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,a=t.slice(),i;return function(s){for(i=0;i<r;++i)a[i]=e[i]*(1-s)+t[i]*s;return a}}function OA(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function _A(e,t){var r=t?t.length:0,a=e?Math.min(r,e.length):0,i=new Array(a),s=new Array(r),o;for(o=0;o<a;++o)i[o]=Za(e[o],t[o]);for(;o<r;++o)s[o]=t[o];return function(l){for(o=0;o<a;++o)s[o]=i[o](l);return s}}function MA(e,t){var r=new Date;return e=+e,t=+t,function(a){return r.setTime(e*(1-a)+t*a),r}}function ho(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function DA(e,t){var r={},a={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=Za(e[i],t[i]):a[i]=t[i];return function(s){for(i in r)a[i]=r[i](s);return a}}var Xc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,lc=new RegExp(Xc.source,"g");function $A(e){return function(){return e}}function LA(e){return function(t){return e(t)+""}}function RA(e,t){var r=Xc.lastIndex=lc.lastIndex=0,a,i,s,o=-1,l=[],d=[];for(e=e+"",t=t+"";(a=Xc.exec(e))&&(i=lc.exec(t));)(s=i.index)>r&&(s=t.slice(r,s),l[o]?l[o]+=s:l[++o]=s),(a=a[0])===(i=i[0])?l[o]?l[o]+=i:l[++o]=i:(l[++o]=null,d.push({i:o,x:ho(a,i)})),r=lc.lastIndex;return r<t.length&&(s=t.slice(r),l[o]?l[o]+=s:l[++o]=s),l.length<2?d[0]?LA(d[0].x):$A(t):(t=d.length,function(f){for(var u=0,h;u<t;++u)l[(h=d[u]).i]=h.x(f);return l.join("")})}function Za(e,t){var r=typeof t,a;return t==null||r==="boolean"?Qd(t):(r==="number"?ho:r==="string"?(a=Li(t))?(t=a,dm):RA:t instanceof Li?dm:t instanceof Date?MA:OA(t)?TA:Array.isArray(t)?_A:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?DA:ho)(e,t)}function Jd(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function zA(e,t){t===void 0&&(t=e,e=Za);for(var r=0,a=t.length-1,i=t[0],s=new Array(a<0?0:a);r<a;)s[r]=e(i,i=t[++r]);return function(o){var l=Math.max(0,Math.min(a-1,Math.floor(o*=a)));return s[l](o-l)}}function WA(e){return function(){return e}}function mo(e){return+e}var um=[0,1];function gn(e){return e}function Qc(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:WA(isNaN(t)?NaN:.5)}function BA(e,t){var r;return e>t&&(r=e,e=t,t=r),function(a){return Math.max(e,Math.min(t,a))}}function FA(e,t,r){var a=e[0],i=e[1],s=t[0],o=t[1];return i<a?(a=Qc(i,a),s=r(o,s)):(a=Qc(a,i),s=r(s,o)),function(l){return s(a(l))}}function qA(e,t,r){var a=Math.min(e.length,t.length)-1,i=new Array(a),s=new Array(a),o=-1;for(e[a]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<a;)i[o]=Qc(e[o],e[o+1]),s[o]=r(t[o],t[o+1]);return function(l){var d=Xi(e,l,1,a)-1;return s[d](i[d](l))}}function Ji(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function sl(){var e=um,t=um,r=Za,a,i,s,o=gn,l,d,f;function u(){var m=Math.min(e.length,t.length);return o!==gn&&(o=BA(e[0],e[m-1])),l=m>2?qA:FA,d=f=null,h}function h(m){return m==null||isNaN(m=+m)?s:(d||(d=l(e.map(a),t,r)))(a(o(m)))}return h.invert=function(m){return o(i((f||(f=l(t,e.map(a),ho)))(m)))},h.domain=function(m){return arguments.length?(e=Array.from(m,mo),u()):e.slice()},h.range=function(m){return arguments.length?(t=Array.from(m),u()):t.slice()},h.rangeRound=function(m){return t=Array.from(m),r=Jd,u()},h.clamp=function(m){return arguments.length?(o=m?!0:gn,u()):o!==gn},h.interpolate=function(m){return arguments.length?(r=m,u()):r},h.unknown=function(m){return arguments.length?(s=m,h):s},function(m,p){return a=m,i=p,u()}}function Zd(){return sl()(gn,gn)}function UA(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function po(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,a=e.slice(0,r);return[a.length>1?a[0]+a.slice(2):a,+e.slice(r+1)]}function Ga(e){return e=po(Math.abs(e)),e?e[1]:NaN}function HA(e,t){return function(r,a){for(var i=r.length,s=[],o=0,l=e[0],d=0;i>0&&l>0&&(d+l+1>a&&(l=Math.max(1,a-d)),s.push(r.substring(i-=l,i+l)),!((d+=l+1)>a));)l=e[o=(o+1)%e.length];return s.reverse().join(t)}}function KA(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var YA=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Ri(e){if(!(t=YA.exec(e)))throw new Error("invalid format: "+e);var t;return new eu({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Ri.prototype=eu.prototype;function eu(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}eu.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function GA(e){e:for(var t=e.length,r=1,a=-1,i;r<t;++r)switch(e[r]){case".":a=i=r;break;case"0":a===0&&(a=r),i=r;break;default:if(!+e[r])break e;a>0&&(a=0);break}return a>0?e.slice(0,a)+e.slice(i+1):e}var jv;function VA(e,t){var r=po(e,t);if(!r)return e+"";var a=r[0],i=r[1],s=i-(jv=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=a.length;return s===o?a:s>o?a+new Array(s-o+1).join("0"):s>0?a.slice(0,s)+"."+a.slice(s):"0."+new Array(1-s).join("0")+po(e,Math.max(0,t+s-1))[0]}function fm(e,t){var r=po(e,t);if(!r)return e+"";var a=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+a:a.length>i+1?a.slice(0,i+1)+"."+a.slice(i+1):a+new Array(i-a.length+2).join("0")}const hm={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:UA,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>fm(e*100,t),r:fm,s:VA,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function mm(e){return e}var pm=Array.prototype.map,gm=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function XA(e){var t=e.grouping===void 0||e.thousands===void 0?mm:HA(pm.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",a=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",s=e.numerals===void 0?mm:KA(pm.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"−":e.minus+"",d=e.nan===void 0?"NaN":e.nan+"";function f(h){h=Ri(h);var m=h.fill,p=h.align,x=h.sign,v=h.symbol,g=h.zero,b=h.width,y=h.comma,A=h.precision,C=h.trim,N=h.type;N==="n"?(y=!0,N="g"):hm[N]||(A===void 0&&(A=12),C=!0,N="g"),(g||m==="0"&&p==="=")&&(g=!0,m="0",p="=");var w=v==="$"?r:v==="#"&&/[boxX]/.test(N)?"0"+N.toLowerCase():"",M=v==="$"?a:/[%p]/.test(N)?o:"",O=hm[N],D=/[defgprs%]/.test(N);A=A===void 0?6:/[gprs]/.test(N)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function W(j){var S=w,R=M,I,$,J;if(N==="c")R=O(j)+R,j="";else{j=+j;var q=j<0||1/j<0;if(j=isNaN(j)?d:O(Math.abs(j),A),C&&(j=GA(j)),q&&+j==0&&x!=="+"&&(q=!1),S=(q?x==="("?x:l:x==="-"||x==="("?"":x)+S,R=(N==="s"?gm[8+jv/3]:"")+R+(q&&x==="("?")":""),D){for(I=-1,$=j.length;++I<$;)if(J=j.charCodeAt(I),48>J||J>57){R=(J===46?i+j.slice(I+1):j.slice(I))+R,j=j.slice(0,I);break}}}y&&!g&&(j=t(j,1/0));var K=S.length+j.length+R.length,L=K<b?new Array(b-K+1).join(m):"";switch(y&&g&&(j=t(L+j,L.length?b-R.length:1/0),L=""),p){case"<":j=S+j+R+L;break;case"=":j=S+L+j+R;break;case"^":j=L.slice(0,K=L.length>>1)+S+j+R+L.slice(K);break;default:j=L+S+j+R;break}return s(j)}return W.toString=function(){return h+""},W}function u(h,m){var p=f((h=Ri(h),h.type="f",h)),x=Math.max(-8,Math.min(8,Math.floor(Ga(m)/3)))*3,v=Math.pow(10,-x),g=gm[8+x/3];return function(b){return p(v*b)+g}}return{format:f,formatPrefix:u}}var Ds,tu,wv;QA({thousands:",",grouping:[3],currency:["$",""]});function QA(e){return Ds=XA(e),tu=Ds.format,wv=Ds.formatPrefix,Ds}function JA(e){return Math.max(0,-Ga(Math.abs(e)))}function ZA(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ga(t)/3)))*3-Ga(Math.abs(e)))}function eC(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Ga(t)-Ga(e))+1}function Sv(e,t,r,a){var i=Yc(e,t,r),s;switch(a=Ri(a??",f"),a.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return a.precision==null&&!isNaN(s=ZA(i,o))&&(a.precision=s),wv(a,o)}case"":case"e":case"g":case"p":case"r":{a.precision==null&&!isNaN(s=eC(i,Math.max(Math.abs(e),Math.abs(t))))&&(a.precision=s-(a.type==="e"));break}case"f":case"%":{a.precision==null&&!isNaN(s=JA(i))&&(a.precision=s-(a.type==="%")*2);break}}return tu(a)}function Qr(e){var t=e.domain;return e.ticks=function(r){var a=t();return Hc(a[0],a[a.length-1],r??10)},e.tickFormat=function(r,a){var i=t();return Sv(i[0],i[i.length-1],r??10,a)},e.nice=function(r){r==null&&(r=10);var a=t(),i=0,s=a.length-1,o=a[i],l=a[s],d,f,u=10;for(l<o&&(f=o,o=l,l=f,f=i,i=s,s=f);u-- >0;){if(f=Kc(o,l,r),f===d)return a[i]=o,a[s]=l,t(a);if(f>0)o=Math.floor(o/f)*f,l=Math.ceil(l/f)*f;else if(f<0)o=Math.ceil(o*f)/f,l=Math.floor(l*f)/f;else break;d=f}return e},e}function Nv(){var e=Zd();return e.copy=function(){return Ji(e,Nv())},qn.apply(e,arguments),Qr(e)}function kv(e){var t;function r(a){return a==null||isNaN(a=+a)?t:a}return r.invert=r,r.domain=r.range=function(a){return arguments.length?(e=Array.from(a,mo),r):e.slice()},r.unknown=function(a){return arguments.length?(t=a,r):t},r.copy=function(){return kv(e).unknown(t)},e=arguments.length?Array.from(e,mo):[0,1],Qr(r)}function Av(e,t){e=e.slice();var r=0,a=e.length-1,i=e[r],s=e[a],o;return s<i&&(o=r,r=a,a=o,o=i,i=s,s=o),e[r]=t.floor(i),e[a]=t.ceil(s),e}function ym(e){return Math.log(e)}function vm(e){return Math.exp(e)}function tC(e){return-Math.log(-e)}function nC(e){return-Math.exp(-e)}function rC(e){return isFinite(e)?+("1e"+e):e<0?0:e}function aC(e){return e===10?rC:e===Math.E?Math.exp:t=>Math.pow(e,t)}function iC(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function xm(e){return(t,r)=>-e(-t,r)}function nu(e){const t=e(ym,vm),r=t.domain;let a=10,i,s;function o(){return i=iC(a),s=aC(a),r()[0]<0?(i=xm(i),s=xm(s),e(tC,nC)):e(ym,vm),t}return t.base=function(l){return arguments.length?(a=+l,o()):a},t.domain=function(l){return arguments.length?(r(l),o()):r()},t.ticks=l=>{const d=r();let f=d[0],u=d[d.length-1];const h=u<f;h&&([f,u]=[u,f]);let m=i(f),p=i(u),x,v;const g=l==null?10:+l;let b=[];if(!(a%1)&&p-m<g){if(m=Math.floor(m),p=Math.ceil(p),f>0){for(;m<=p;++m)for(x=1;x<a;++x)if(v=m<0?x/s(-m):x*s(m),!(v<f)){if(v>u)break;b.push(v)}}else for(;m<=p;++m)for(x=a-1;x>=1;--x)if(v=m>0?x/s(-m):x*s(m),!(v<f)){if(v>u)break;b.push(v)}b.length*2<g&&(b=Hc(f,u,g))}else b=Hc(m,p,Math.min(p-m,g)).map(s);return h?b.reverse():b},t.tickFormat=(l,d)=>{if(l==null&&(l=10),d==null&&(d=a===10?"s":","),typeof d!="function"&&(!(a%1)&&(d=Ri(d)).precision==null&&(d.trim=!0),d=tu(d)),l===1/0)return d;const f=Math.max(1,a*l/t.ticks().length);return u=>{let h=u/s(Math.round(i(u)));return h*a<a-.5&&(h*=a),h<=f?d(u):""}},t.nice=()=>r(Av(r(),{floor:l=>s(Math.floor(i(l))),ceil:l=>s(Math.ceil(i(l)))})),t}function Cv(){const e=nu(sl()).domain([1,10]);return e.copy=()=>Ji(e,Cv()).base(e.base()),qn.apply(e,arguments),e}function bm(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function jm(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function ru(e){var t=1,r=e(bm(t),jm(t));return r.constant=function(a){return arguments.length?e(bm(t=+a),jm(t)):t},Qr(r)}function Pv(){var e=ru(sl());return e.copy=function(){return Ji(e,Pv()).constant(e.constant())},qn.apply(e,arguments)}function wm(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function sC(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function oC(e){return e<0?-e*e:e*e}function au(e){var t=e(gn,gn),r=1;function a(){return r===1?e(gn,gn):r===.5?e(sC,oC):e(wm(r),wm(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,a()):r},Qr(t)}function iu(){var e=au(sl());return e.copy=function(){return Ji(e,iu()).exponent(e.exponent())},qn.apply(e,arguments),e}function lC(){return iu.apply(null,arguments).exponent(.5)}function Sm(e){return Math.sign(e)*e*e}function cC(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function Ev(){var e=Zd(),t=[0,1],r=!1,a;function i(s){var o=cC(e(s));return isNaN(o)?a:r?Math.round(o):o}return i.invert=function(s){return e.invert(Sm(s))},i.domain=function(s){return arguments.length?(e.domain(s),i):e.domain()},i.range=function(s){return arguments.length?(e.range((t=Array.from(s,mo)).map(Sm)),i):t.slice()},i.rangeRound=function(s){return i.range(s).round(!0)},i.round=function(s){return arguments.length?(r=!!s,i):r},i.clamp=function(s){return arguments.length?(e.clamp(s),i):e.clamp()},i.unknown=function(s){return arguments.length?(a=s,i):a},i.copy=function(){return Ev(e.domain(),t).round(r).clamp(e.clamp()).unknown(a)},qn.apply(i,arguments),Qr(i)}function Iv(){var e=[],t=[],r=[],a;function i(){var o=0,l=Math.max(1,t.length);for(r=new Array(l-1);++o<l;)r[o-1]=hA(e,o/l);return s}function s(o){return o==null||isNaN(o=+o)?a:t[Xi(r,o)]}return s.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},s.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(qr),i()},s.range=function(o){return arguments.length?(t=Array.from(o),i()):t.slice()},s.unknown=function(o){return arguments.length?(a=o,s):a},s.quantiles=function(){return r.slice()},s.copy=function(){return Iv().domain(e).range(t).unknown(a)},qn.apply(s,arguments)}function Tv(){var e=0,t=1,r=1,a=[.5],i=[0,1],s;function o(d){return d!=null&&d<=d?i[Xi(a,d,0,r)]:s}function l(){var d=-1;for(a=new Array(r);++d<r;)a[d]=((d+1)*t-(d-r)*e)/(r+1);return o}return o.domain=function(d){return arguments.length?([e,t]=d,e=+e,t=+t,l()):[e,t]},o.range=function(d){return arguments.length?(r=(i=Array.from(d)).length-1,l()):i.slice()},o.invertExtent=function(d){var f=i.indexOf(d);return f<0?[NaN,NaN]:f<1?[e,a[0]]:f>=r?[a[r-1],t]:[a[f-1],a[f]]},o.unknown=function(d){return arguments.length&&(s=d),o},o.thresholds=function(){return a.slice()},o.copy=function(){return Tv().domain([e,t]).range(i).unknown(s)},qn.apply(Qr(o),arguments)}function Ov(){var e=[.5],t=[0,1],r,a=1;function i(s){return s!=null&&s<=s?t[Xi(e,s,0,a)]:r}return i.domain=function(s){return arguments.length?(e=Array.from(s),a=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(s){return arguments.length?(t=Array.from(s),a=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(s){var o=t.indexOf(s);return[e[o-1],e[o]]},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return Ov().domain(e).range(t).unknown(r)},qn.apply(i,arguments)}const cc=new Date,dc=new Date;function Yt(e,t,r,a){function i(s){return e(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(e(s=new Date(+s)),s),i.ceil=s=>(e(s=new Date(s-1)),t(s,1),e(s),s),i.round=s=>{const o=i(s),l=i.ceil(s);return s-o<l-s?o:l},i.offset=(s,o)=>(t(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,l)=>{const d=[];if(s=i.ceil(s),l=l==null?1:Math.floor(l),!(s<o)||!(l>0))return d;let f;do d.push(f=new Date(+s)),t(s,l),e(s);while(f<s&&s<o);return d},i.filter=s=>Yt(o=>{if(o>=o)for(;e(o),!s(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!s(o););else for(;--l>=0;)for(;t(o,1),!s(o););}),r&&(i.count=(s,o)=>(cc.setTime(+s),dc.setTime(+o),e(cc),e(dc),Math.floor(r(cc,dc))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(a?o=>a(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const go=Yt(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);go.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Yt(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):go);go.range;const xr=1e3,Wn=xr*60,br=Wn*60,kr=br*24,su=kr*7,Nm=kr*30,uc=kr*365,ua=Yt(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*xr)},(e,t)=>(t-e)/xr,e=>e.getUTCSeconds());ua.range;const ou=Yt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*xr)},(e,t)=>{e.setTime(+e+t*Wn)},(e,t)=>(t-e)/Wn,e=>e.getMinutes());ou.range;const lu=Yt(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Wn)},(e,t)=>(t-e)/Wn,e=>e.getUTCMinutes());lu.range;const cu=Yt(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*xr-e.getMinutes()*Wn)},(e,t)=>{e.setTime(+e+t*br)},(e,t)=>(t-e)/br,e=>e.getHours());cu.range;const du=Yt(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*br)},(e,t)=>(t-e)/br,e=>e.getUTCHours());du.range;const Zi=Yt(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Wn)/kr,e=>e.getDate()-1);Zi.range;const ol=Yt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/kr,e=>e.getUTCDate()-1);ol.range;const _v=Yt(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/kr,e=>Math.floor(e/kr));_v.range;function Ca(e){return Yt(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Wn)/su)}const ll=Ca(0),yo=Ca(1),dC=Ca(2),uC=Ca(3),Va=Ca(4),fC=Ca(5),hC=Ca(6);ll.range;yo.range;dC.range;uC.range;Va.range;fC.range;hC.range;function Pa(e){return Yt(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/su)}const cl=Pa(0),vo=Pa(1),mC=Pa(2),pC=Pa(3),Xa=Pa(4),gC=Pa(5),yC=Pa(6);cl.range;vo.range;mC.range;pC.range;Xa.range;gC.range;yC.range;const uu=Yt(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());uu.range;const fu=Yt(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());fu.range;const Ar=Yt(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ar.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Yt(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Ar.range;const Cr=Yt(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Cr.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Yt(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Cr.range;function Mv(e,t,r,a,i,s){const o=[[ua,1,xr],[ua,5,5*xr],[ua,15,15*xr],[ua,30,30*xr],[s,1,Wn],[s,5,5*Wn],[s,15,15*Wn],[s,30,30*Wn],[i,1,br],[i,3,3*br],[i,6,6*br],[i,12,12*br],[a,1,kr],[a,2,2*kr],[r,1,su],[t,1,Nm],[t,3,3*Nm],[e,1,uc]];function l(f,u,h){const m=u<f;m&&([f,u]=[u,f]);const p=h&&typeof h.range=="function"?h:d(f,u,h),x=p?p.range(f,+u+1):[];return m?x.reverse():x}function d(f,u,h){const m=Math.abs(u-f)/h,p=Yd(([,,g])=>g).right(o,m);if(p===o.length)return e.every(Yc(f/uc,u/uc,h));if(p===0)return go.every(Math.max(Yc(f,u,h),1));const[x,v]=o[m/o[p-1][2]<o[p][2]/m?p-1:p];return x.every(v)}return[l,d]}const[vC,xC]=Mv(Cr,fu,cl,_v,du,lu),[bC,jC]=Mv(Ar,uu,ll,Zi,cu,ou);function fc(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function hc(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function bi(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function wC(e){var t=e.dateTime,r=e.date,a=e.time,i=e.periods,s=e.days,o=e.shortDays,l=e.months,d=e.shortMonths,f=ji(i),u=wi(i),h=ji(s),m=wi(s),p=ji(o),x=wi(o),v=ji(l),g=wi(l),b=ji(d),y=wi(d),A={a:q,A:K,b:L,B:ee,c:null,d:Im,e:Im,f:HC,g:tP,G:rP,H:FC,I:qC,j:UC,L:Dv,m:KC,M:YC,p:E,q:T,Q:_m,s:Mm,S:GC,u:VC,U:XC,V:QC,w:JC,W:ZC,x:null,X:null,y:eP,Y:nP,Z:aP,"%":Om},C={a:B,A:P,b:_,B:U,c:null,d:Tm,e:Tm,f:lP,g:vP,G:bP,H:iP,I:sP,j:oP,L:Lv,m:cP,M:dP,p:fe,q:ae,Q:_m,s:Mm,S:uP,u:fP,U:hP,V:mP,w:pP,W:gP,x:null,X:null,y:yP,Y:xP,Z:jP,"%":Om},N={a:W,A:j,b:S,B:R,c:I,d:Pm,e:Pm,f:RC,g:Cm,G:Am,H:Em,I:Em,j:MC,L:LC,m:_C,M:DC,p:D,q:OC,Q:WC,s:BC,S:$C,u:CC,U:PC,V:EC,w:AC,W:IC,x:$,X:J,y:Cm,Y:Am,Z:TC,"%":zC};A.x=w(r,A),A.X=w(a,A),A.c=w(t,A),C.x=w(r,C),C.X=w(a,C),C.c=w(t,C);function w(F,pe){return function(H){var Q=[],ge=-1,je=0,Ne=F.length,Y,ve,se;for(H instanceof Date||(H=new Date(+H));++ge<Ne;)F.charCodeAt(ge)===37&&(Q.push(F.slice(je,ge)),(ve=km[Y=F.charAt(++ge)])!=null?Y=F.charAt(++ge):ve=Y==="e"?" ":"0",(se=pe[Y])&&(Y=se(H,ve)),Q.push(Y),je=ge+1);return Q.push(F.slice(je,ge)),Q.join("")}}function M(F,pe){return function(H){var Q=bi(1900,void 0,1),ge=O(Q,F,H+="",0),je,Ne;if(ge!=H.length)return null;if("Q"in Q)return new Date(Q.Q);if("s"in Q)return new Date(Q.s*1e3+("L"in Q?Q.L:0));if(pe&&!("Z"in Q)&&(Q.Z=0),"p"in Q&&(Q.H=Q.H%12+Q.p*12),Q.m===void 0&&(Q.m="q"in Q?Q.q:0),"V"in Q){if(Q.V<1||Q.V>53)return null;"w"in Q||(Q.w=1),"Z"in Q?(je=hc(bi(Q.y,0,1)),Ne=je.getUTCDay(),je=Ne>4||Ne===0?vo.ceil(je):vo(je),je=ol.offset(je,(Q.V-1)*7),Q.y=je.getUTCFullYear(),Q.m=je.getUTCMonth(),Q.d=je.getUTCDate()+(Q.w+6)%7):(je=fc(bi(Q.y,0,1)),Ne=je.getDay(),je=Ne>4||Ne===0?yo.ceil(je):yo(je),je=Zi.offset(je,(Q.V-1)*7),Q.y=je.getFullYear(),Q.m=je.getMonth(),Q.d=je.getDate()+(Q.w+6)%7)}else("W"in Q||"U"in Q)&&("w"in Q||(Q.w="u"in Q?Q.u%7:"W"in Q?1:0),Ne="Z"in Q?hc(bi(Q.y,0,1)).getUTCDay():fc(bi(Q.y,0,1)).getDay(),Q.m=0,Q.d="W"in Q?(Q.w+6)%7+Q.W*7-(Ne+5)%7:Q.w+Q.U*7-(Ne+6)%7);return"Z"in Q?(Q.H+=Q.Z/100|0,Q.M+=Q.Z%100,hc(Q)):fc(Q)}}function O(F,pe,H,Q){for(var ge=0,je=pe.length,Ne=H.length,Y,ve;ge<je;){if(Q>=Ne)return-1;if(Y=pe.charCodeAt(ge++),Y===37){if(Y=pe.charAt(ge++),ve=N[Y in km?pe.charAt(ge++):Y],!ve||(Q=ve(F,H,Q))<0)return-1}else if(Y!=H.charCodeAt(Q++))return-1}return Q}function D(F,pe,H){var Q=f.exec(pe.slice(H));return Q?(F.p=u.get(Q[0].toLowerCase()),H+Q[0].length):-1}function W(F,pe,H){var Q=p.exec(pe.slice(H));return Q?(F.w=x.get(Q[0].toLowerCase()),H+Q[0].length):-1}function j(F,pe,H){var Q=h.exec(pe.slice(H));return Q?(F.w=m.get(Q[0].toLowerCase()),H+Q[0].length):-1}function S(F,pe,H){var Q=b.exec(pe.slice(H));return Q?(F.m=y.get(Q[0].toLowerCase()),H+Q[0].length):-1}function R(F,pe,H){var Q=v.exec(pe.slice(H));return Q?(F.m=g.get(Q[0].toLowerCase()),H+Q[0].length):-1}function I(F,pe,H){return O(F,t,pe,H)}function $(F,pe,H){return O(F,r,pe,H)}function J(F,pe,H){return O(F,a,pe,H)}function q(F){return o[F.getDay()]}function K(F){return s[F.getDay()]}function L(F){return d[F.getMonth()]}function ee(F){return l[F.getMonth()]}function E(F){return i[+(F.getHours()>=12)]}function T(F){return 1+~~(F.getMonth()/3)}function B(F){return o[F.getUTCDay()]}function P(F){return s[F.getUTCDay()]}function _(F){return d[F.getUTCMonth()]}function U(F){return l[F.getUTCMonth()]}function fe(F){return i[+(F.getUTCHours()>=12)]}function ae(F){return 1+~~(F.getUTCMonth()/3)}return{format:function(F){var pe=w(F+="",A);return pe.toString=function(){return F},pe},parse:function(F){var pe=M(F+="",!1);return pe.toString=function(){return F},pe},utcFormat:function(F){var pe=w(F+="",C);return pe.toString=function(){return F},pe},utcParse:function(F){var pe=M(F+="",!0);return pe.toString=function(){return F},pe}}}var km={"-":"",_:" ",0:"0"},tn=/^\s*\d+/,SC=/^%/,NC=/[\\^$*+?|[\]().{}]/g;function Ze(e,t,r){var a=e<0?"-":"",i=(a?-e:e)+"",s=i.length;return a+(s<r?new Array(r-s+1).join(t)+i:i)}function kC(e){return e.replace(NC,"\\$&")}function ji(e){return new RegExp("^(?:"+e.map(kC).join("|")+")","i")}function wi(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function AC(e,t,r){var a=tn.exec(t.slice(r,r+1));return a?(e.w=+a[0],r+a[0].length):-1}function CC(e,t,r){var a=tn.exec(t.slice(r,r+1));return a?(e.u=+a[0],r+a[0].length):-1}function PC(e,t,r){var a=tn.exec(t.slice(r,r+2));return a?(e.U=+a[0],r+a[0].length):-1}function EC(e,t,r){var a=tn.exec(t.slice(r,r+2));return a?(e.V=+a[0],r+a[0].length):-1}function IC(e,t,r){var a=tn.exec(t.slice(r,r+2));return a?(e.W=+a[0],r+a[0].length):-1}function Am(e,t,r){var a=tn.exec(t.slice(r,r+4));return a?(e.y=+a[0],r+a[0].length):-1}function Cm(e,t,r){var a=tn.exec(t.slice(r,r+2));return a?(e.y=+a[0]+(+a[0]>68?1900:2e3),r+a[0].length):-1}function TC(e,t,r){var a=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return a?(e.Z=a[1]?0:-(a[2]+(a[3]||"00")),r+a[0].length):-1}function OC(e,t,r){var a=tn.exec(t.slice(r,r+1));return a?(e.q=a[0]*3-3,r+a[0].length):-1}function _C(e,t,r){var a=tn.exec(t.slice(r,r+2));return a?(e.m=a[0]-1,r+a[0].length):-1}function Pm(e,t,r){var a=tn.exec(t.slice(r,r+2));return a?(e.d=+a[0],r+a[0].length):-1}function MC(e,t,r){var a=tn.exec(t.slice(r,r+3));return a?(e.m=0,e.d=+a[0],r+a[0].length):-1}function Em(e,t,r){var a=tn.exec(t.slice(r,r+2));return a?(e.H=+a[0],r+a[0].length):-1}function DC(e,t,r){var a=tn.exec(t.slice(r,r+2));return a?(e.M=+a[0],r+a[0].length):-1}function $C(e,t,r){var a=tn.exec(t.slice(r,r+2));return a?(e.S=+a[0],r+a[0].length):-1}function LC(e,t,r){var a=tn.exec(t.slice(r,r+3));return a?(e.L=+a[0],r+a[0].length):-1}function RC(e,t,r){var a=tn.exec(t.slice(r,r+6));return a?(e.L=Math.floor(a[0]/1e3),r+a[0].length):-1}function zC(e,t,r){var a=SC.exec(t.slice(r,r+1));return a?r+a[0].length:-1}function WC(e,t,r){var a=tn.exec(t.slice(r));return a?(e.Q=+a[0],r+a[0].length):-1}function BC(e,t,r){var a=tn.exec(t.slice(r));return a?(e.s=+a[0],r+a[0].length):-1}function Im(e,t){return Ze(e.getDate(),t,2)}function FC(e,t){return Ze(e.getHours(),t,2)}function qC(e,t){return Ze(e.getHours()%12||12,t,2)}function UC(e,t){return Ze(1+Zi.count(Ar(e),e),t,3)}function Dv(e,t){return Ze(e.getMilliseconds(),t,3)}function HC(e,t){return Dv(e,t)+"000"}function KC(e,t){return Ze(e.getMonth()+1,t,2)}function YC(e,t){return Ze(e.getMinutes(),t,2)}function GC(e,t){return Ze(e.getSeconds(),t,2)}function VC(e){var t=e.getDay();return t===0?7:t}function XC(e,t){return Ze(ll.count(Ar(e)-1,e),t,2)}function $v(e){var t=e.getDay();return t>=4||t===0?Va(e):Va.ceil(e)}function QC(e,t){return e=$v(e),Ze(Va.count(Ar(e),e)+(Ar(e).getDay()===4),t,2)}function JC(e){return e.getDay()}function ZC(e,t){return Ze(yo.count(Ar(e)-1,e),t,2)}function eP(e,t){return Ze(e.getFullYear()%100,t,2)}function tP(e,t){return e=$v(e),Ze(e.getFullYear()%100,t,2)}function nP(e,t){return Ze(e.getFullYear()%1e4,t,4)}function rP(e,t){var r=e.getDay();return e=r>=4||r===0?Va(e):Va.ceil(e),Ze(e.getFullYear()%1e4,t,4)}function aP(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Ze(t/60|0,"0",2)+Ze(t%60,"0",2)}function Tm(e,t){return Ze(e.getUTCDate(),t,2)}function iP(e,t){return Ze(e.getUTCHours(),t,2)}function sP(e,t){return Ze(e.getUTCHours()%12||12,t,2)}function oP(e,t){return Ze(1+ol.count(Cr(e),e),t,3)}function Lv(e,t){return Ze(e.getUTCMilliseconds(),t,3)}function lP(e,t){return Lv(e,t)+"000"}function cP(e,t){return Ze(e.getUTCMonth()+1,t,2)}function dP(e,t){return Ze(e.getUTCMinutes(),t,2)}function uP(e,t){return Ze(e.getUTCSeconds(),t,2)}function fP(e){var t=e.getUTCDay();return t===0?7:t}function hP(e,t){return Ze(cl.count(Cr(e)-1,e),t,2)}function Rv(e){var t=e.getUTCDay();return t>=4||t===0?Xa(e):Xa.ceil(e)}function mP(e,t){return e=Rv(e),Ze(Xa.count(Cr(e),e)+(Cr(e).getUTCDay()===4),t,2)}function pP(e){return e.getUTCDay()}function gP(e,t){return Ze(vo.count(Cr(e)-1,e),t,2)}function yP(e,t){return Ze(e.getUTCFullYear()%100,t,2)}function vP(e,t){return e=Rv(e),Ze(e.getUTCFullYear()%100,t,2)}function xP(e,t){return Ze(e.getUTCFullYear()%1e4,t,4)}function bP(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Xa(e):Xa.ceil(e),Ze(e.getUTCFullYear()%1e4,t,4)}function jP(){return"+0000"}function Om(){return"%"}function _m(e){return+e}function Mm(e){return Math.floor(+e/1e3)}var Ra,zv,Wv;wP({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function wP(e){return Ra=wC(e),zv=Ra.format,Ra.parse,Wv=Ra.utcFormat,Ra.utcParse,Ra}function SP(e){return new Date(e)}function NP(e){return e instanceof Date?+e:+new Date(+e)}function hu(e,t,r,a,i,s,o,l,d,f){var u=Zd(),h=u.invert,m=u.domain,p=f(".%L"),x=f(":%S"),v=f("%I:%M"),g=f("%I %p"),b=f("%a %d"),y=f("%b %d"),A=f("%B"),C=f("%Y");function N(w){return(d(w)<w?p:l(w)<w?x:o(w)<w?v:s(w)<w?g:a(w)<w?i(w)<w?b:y:r(w)<w?A:C)(w)}return u.invert=function(w){return new Date(h(w))},u.domain=function(w){return arguments.length?m(Array.from(w,NP)):m().map(SP)},u.ticks=function(w){var M=m();return e(M[0],M[M.length-1],w??10)},u.tickFormat=function(w,M){return M==null?N:f(M)},u.nice=function(w){var M=m();return(!w||typeof w.range!="function")&&(w=t(M[0],M[M.length-1],w??10)),w?m(Av(M,w)):u},u.copy=function(){return Ji(u,hu(e,t,r,a,i,s,o,l,d,f))},u}function kP(){return qn.apply(hu(bC,jC,Ar,uu,ll,Zi,cu,ou,ua,zv).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function AP(){return qn.apply(hu(vC,xC,Cr,fu,cl,ol,du,lu,ua,Wv).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function dl(){var e=0,t=1,r,a,i,s,o=gn,l=!1,d;function f(h){return h==null||isNaN(h=+h)?d:o(i===0?.5:(h=(s(h)-r)*i,l?Math.max(0,Math.min(1,h)):h))}f.domain=function(h){return arguments.length?([e,t]=h,r=s(e=+e),a=s(t=+t),i=r===a?0:1/(a-r),f):[e,t]},f.clamp=function(h){return arguments.length?(l=!!h,f):l},f.interpolator=function(h){return arguments.length?(o=h,f):o};function u(h){return function(m){var p,x;return arguments.length?([p,x]=m,o=h(p,x),f):[o(0),o(1)]}}return f.range=u(Za),f.rangeRound=u(Jd),f.unknown=function(h){return arguments.length?(d=h,f):d},function(h){return s=h,r=h(e),a=h(t),i=r===a?0:1/(a-r),f}}function Jr(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function Bv(){var e=Qr(dl()(gn));return e.copy=function(){return Jr(e,Bv())},Or.apply(e,arguments)}function Fv(){var e=nu(dl()).domain([1,10]);return e.copy=function(){return Jr(e,Fv()).base(e.base())},Or.apply(e,arguments)}function qv(){var e=ru(dl());return e.copy=function(){return Jr(e,qv()).constant(e.constant())},Or.apply(e,arguments)}function mu(){var e=au(dl());return e.copy=function(){return Jr(e,mu()).exponent(e.exponent())},Or.apply(e,arguments)}function CP(){return mu.apply(null,arguments).exponent(.5)}function Uv(){var e=[],t=gn;function r(a){if(a!=null&&!isNaN(a=+a))return t((Xi(e,a,1)-1)/(e.length-1))}return r.domain=function(a){if(!arguments.length)return e.slice();e=[];for(let i of a)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(qr),r},r.interpolator=function(a){return arguments.length?(t=a,r):t},r.range=function(){return e.map((a,i)=>t(i/(e.length-1)))},r.quantiles=function(a){return Array.from({length:a+1},(i,s)=>fA(e,s/a))},r.copy=function(){return Uv(t).domain(e)},Or.apply(r,arguments)}function ul(){var e=0,t=.5,r=1,a=1,i,s,o,l,d,f=gn,u,h=!1,m;function p(v){return isNaN(v=+v)?m:(v=.5+((v=+u(v))-s)*(a*v<a*s?l:d),f(h?Math.max(0,Math.min(1,v)):v))}p.domain=function(v){return arguments.length?([e,t,r]=v,i=u(e=+e),s=u(t=+t),o=u(r=+r),l=i===s?0:.5/(s-i),d=s===o?0:.5/(o-s),a=s<i?-1:1,p):[e,t,r]},p.clamp=function(v){return arguments.length?(h=!!v,p):h},p.interpolator=function(v){return arguments.length?(f=v,p):f};function x(v){return function(g){var b,y,A;return arguments.length?([b,y,A]=g,f=zA(v,[b,y,A]),p):[f(0),f(.5),f(1)]}}return p.range=x(Za),p.rangeRound=x(Jd),p.unknown=function(v){return arguments.length?(m=v,p):m},function(v){return u=v,i=v(e),s=v(t),o=v(r),l=i===s?0:.5/(s-i),d=s===o?0:.5/(o-s),a=s<i?-1:1,p}}function Hv(){var e=Qr(ul()(gn));return e.copy=function(){return Jr(e,Hv())},Or.apply(e,arguments)}function Kv(){var e=nu(ul()).domain([.1,1,10]);return e.copy=function(){return Jr(e,Kv()).base(e.base())},Or.apply(e,arguments)}function Yv(){var e=ru(ul());return e.copy=function(){return Jr(e,Yv()).constant(e.constant())},Or.apply(e,arguments)}function pu(){var e=au(ul());return e.copy=function(){return Jr(e,pu()).exponent(e.exponent())},Or.apply(e,arguments)}function PP(){return pu.apply(null,arguments).exponent(.5)}const ki=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Vd,scaleDiverging:Hv,scaleDivergingLog:Kv,scaleDivergingPow:pu,scaleDivergingSqrt:PP,scaleDivergingSymlog:Yv,scaleIdentity:kv,scaleImplicit:Gc,scaleLinear:Nv,scaleLog:Cv,scaleOrdinal:Gd,scalePoint:pA,scalePow:iu,scaleQuantile:Iv,scaleQuantize:Tv,scaleRadial:Ev,scaleSequential:Bv,scaleSequentialLog:Fv,scaleSequentialPow:mu,scaleSequentialQuantile:Uv,scaleSequentialSqrt:CP,scaleSequentialSymlog:qv,scaleSqrt:lC,scaleSymlog:Pv,scaleThreshold:Ov,scaleTime:kP,scaleUtc:AP,tickFormat:Sv},Symbol.toStringTag,{value:"Module"}));var Zr=e=>e.chartData,gu=me([Zr],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),fl=(e,t,r,a)=>a?gu(e):Zr(e);function wa(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if($t(t)&&$t(r))return!0}return!1}function Dm(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function Gv(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,a]=e,i,s;if($t(r))i=r;else if(typeof r=="function")return;if($t(a))s=a;else if(typeof a=="function")return;var o=[i,s];if(wa(o))return o}}function EP(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var a=e(t,r);if(wa(a))return Dm(a,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[i,s]=e,o,l;if(i==="auto")t!=null&&(o=Math.min(...t));else if(_e(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[0]))}catch{}else if(typeof i=="string"&&kh.test(i)){var d=kh.exec(i);if(d==null||t==null)o=void 0;else{var f=+d[1];o=t[0]-f}}else o=t==null?void 0:t[0];if(s==="auto")t!=null&&(l=Math.max(...t));else if(_e(s))l=s;else if(typeof s=="function")try{t!=null&&(l=s(t==null?void 0:t[1]))}catch{}else if(typeof s=="string"&&Ah.test(s)){var u=Ah.exec(s);if(u==null||t==null)l=void 0;else{var h=+u[1];l=t[1]+h}}else l=t==null?void 0:t[1];var m=[o,l];if(wa(m))return t==null?m:Dm(m,t,r)}}}var ei=1e9,IP={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},vu,jt=!0,Fn="[DecimalError] ",ga=Fn+"Invalid argument: ",yu=Fn+"Exponent out of range: ",ti=Math.floor,ca=Math.pow,TP=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,En,Qt=1e7,gt=7,Vv=9007199254740991,xo=ti(Vv/gt),Te={};Te.absoluteValue=Te.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};Te.comparedTo=Te.cmp=function(e){var t,r,a,i,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(a=s.d.length,i=e.d.length,t=0,r=a<i?a:i;t<r;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return a===i?0:a>i^s.s<0?1:-1};Te.decimalPlaces=Te.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*gt;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};Te.dividedBy=Te.div=function(e){return wr(this,new this.constructor(e))};Te.dividedToIntegerBy=Te.idiv=function(e){var t=this,r=t.constructor;return ut(wr(t,new r(e),0,1),r.precision)};Te.equals=Te.eq=function(e){return!this.cmp(e)};Te.exponent=function(){return Ft(this)};Te.greaterThan=Te.gt=function(e){return this.cmp(e)>0};Te.greaterThanOrEqualTo=Te.gte=function(e){return this.cmp(e)>=0};Te.isInteger=Te.isint=function(){return this.e>this.d.length-2};Te.isNegative=Te.isneg=function(){return this.s<0};Te.isPositive=Te.ispos=function(){return this.s>0};Te.isZero=function(){return this.s===0};Te.lessThan=Te.lt=function(e){return this.cmp(e)<0};Te.lessThanOrEqualTo=Te.lte=function(e){return this.cmp(e)<1};Te.logarithm=Te.log=function(e){var t,r=this,a=r.constructor,i=a.precision,s=i+5;if(e===void 0)e=new a(10);else if(e=new a(e),e.s<1||e.eq(En))throw Error(Fn+"NaN");if(r.s<1)throw Error(Fn+(r.s?"NaN":"-Infinity"));return r.eq(En)?new a(0):(jt=!1,t=wr(zi(r,s),zi(e,s),s),jt=!0,ut(t,i))};Te.minus=Te.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Jv(t,e):Xv(t,(e.s=-e.s,e))};Te.modulo=Te.mod=function(e){var t,r=this,a=r.constructor,i=a.precision;if(e=new a(e),!e.s)throw Error(Fn+"NaN");return r.s?(jt=!1,t=wr(r,e,0,1).times(e),jt=!0,r.minus(t)):ut(new a(r),i)};Te.naturalExponential=Te.exp=function(){return Qv(this)};Te.naturalLogarithm=Te.ln=function(){return zi(this)};Te.negated=Te.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};Te.plus=Te.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Xv(t,e):Jv(t,(e.s=-e.s,e))};Te.precision=Te.sd=function(e){var t,r,a,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ga+e);if(t=Ft(i)+1,a=i.d.length-1,r=a*gt+1,a=i.d[a],a){for(;a%10==0;a/=10)r--;for(a=i.d[0];a>=10;a/=10)r++}return e&&t>r?t:r};Te.squareRoot=Te.sqrt=function(){var e,t,r,a,i,s,o,l=this,d=l.constructor;if(l.s<1){if(!l.s)return new d(0);throw Error(Fn+"NaN")}for(e=Ft(l),jt=!1,i=Math.sqrt(+l),i==0||i==1/0?(t=sr(l.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=ti((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),a=new d(t)):a=new d(i.toString()),r=d.precision,i=o=r+3;;)if(s=a,a=s.plus(wr(l,s,o+2)).times(.5),sr(s.d).slice(0,o)===(t=sr(a.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(ut(s,r+1,0),s.times(s).eq(l)){a=s;break}}else if(t!="9999")break;o+=4}return jt=!0,ut(a,r)};Te.times=Te.mul=function(e){var t,r,a,i,s,o,l,d,f,u=this,h=u.constructor,m=u.d,p=(e=new h(e)).d;if(!u.s||!e.s)return new h(0);for(e.s*=u.s,r=u.e+e.e,d=m.length,f=p.length,d<f&&(s=m,m=p,p=s,o=d,d=f,f=o),s=[],o=d+f,a=o;a--;)s.push(0);for(a=f;--a>=0;){for(t=0,i=d+a;i>a;)l=s[i]+p[a]*m[i-a-1]+t,s[i--]=l%Qt|0,t=l/Qt|0;s[i]=(s[i]+t)%Qt|0}for(;!s[--o];)s.pop();return t?++r:s.shift(),e.d=s,e.e=r,jt?ut(e,h.precision):e};Te.toDecimalPlaces=Te.todp=function(e,t){var r=this,a=r.constructor;return r=new a(r),e===void 0?r:(dr(e,0,ei),t===void 0?t=a.rounding:dr(t,0,8),ut(r,e+Ft(r)+1,t))};Te.toExponential=function(e,t){var r,a=this,i=a.constructor;return e===void 0?r=Sa(a,!0):(dr(e,0,ei),t===void 0?t=i.rounding:dr(t,0,8),a=ut(new i(a),e+1,t),r=Sa(a,!0,e+1)),r};Te.toFixed=function(e,t){var r,a,i=this,s=i.constructor;return e===void 0?Sa(i):(dr(e,0,ei),t===void 0?t=s.rounding:dr(t,0,8),a=ut(new s(i),e+Ft(i)+1,t),r=Sa(a.abs(),!1,e+Ft(a)+1),i.isneg()&&!i.isZero()?"-"+r:r)};Te.toInteger=Te.toint=function(){var e=this,t=e.constructor;return ut(new t(e),Ft(e)+1,t.rounding)};Te.toNumber=function(){return+this};Te.toPower=Te.pow=function(e){var t,r,a,i,s,o,l=this,d=l.constructor,f=12,u=+(e=new d(e));if(!e.s)return new d(En);if(l=new d(l),!l.s){if(e.s<1)throw Error(Fn+"Infinity");return l}if(l.eq(En))return l;if(a=d.precision,e.eq(En))return ut(l,a);if(t=e.e,r=e.d.length-1,o=t>=r,s=l.s,o){if((r=u<0?-u:u)<=Vv){for(i=new d(En),t=Math.ceil(a/gt+4),jt=!1;r%2&&(i=i.times(l),Lm(i.d,t)),r=ti(r/2),r!==0;)l=l.times(l),Lm(l.d,t);return jt=!0,e.s<0?new d(En).div(i):ut(i,a)}}else if(s<0)throw Error(Fn+"NaN");return s=s<0&&e.d[Math.max(t,r)]&1?-1:1,l.s=1,jt=!1,i=e.times(zi(l,a+f)),jt=!0,i=Qv(i),i.s=s,i};Te.toPrecision=function(e,t){var r,a,i=this,s=i.constructor;return e===void 0?(r=Ft(i),a=Sa(i,r<=s.toExpNeg||r>=s.toExpPos)):(dr(e,1,ei),t===void 0?t=s.rounding:dr(t,0,8),i=ut(new s(i),e,t),r=Ft(i),a=Sa(i,e<=r||r<=s.toExpNeg,e)),a};Te.toSignificantDigits=Te.tosd=function(e,t){var r=this,a=r.constructor;return e===void 0?(e=a.precision,t=a.rounding):(dr(e,1,ei),t===void 0?t=a.rounding:dr(t,0,8)),ut(new a(r),e,t)};Te.toString=Te.valueOf=Te.val=Te.toJSON=Te[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ft(e),r=e.constructor;return Sa(e,t<=r.toExpNeg||t>=r.toExpPos)};function Xv(e,t){var r,a,i,s,o,l,d,f,u=e.constructor,h=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),jt?ut(t,h):t;if(d=e.d,f=t.d,o=e.e,i=t.e,d=d.slice(),s=o-i,s){for(s<0?(a=d,s=-s,l=f.length):(a=f,i=o,l=d.length),o=Math.ceil(h/gt),l=o>l?o+1:l+1,s>l&&(s=l,a.length=1),a.reverse();s--;)a.push(0);a.reverse()}for(l=d.length,s=f.length,l-s<0&&(s=l,a=f,f=d,d=a),r=0;s;)r=(d[--s]=d[s]+f[s]+r)/Qt|0,d[s]%=Qt;for(r&&(d.unshift(r),++i),l=d.length;d[--l]==0;)d.pop();return t.d=d,t.e=i,jt?ut(t,h):t}function dr(e,t,r){if(e!==~~e||e<t||e>r)throw Error(ga+e)}function sr(e){var t,r,a,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)a=e[t]+"",r=gt-a.length,r&&(s+=Wr(r)),s+=a;o=e[t],a=o+"",r=gt-a.length,r&&(s+=Wr(r))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var wr=function(){function e(a,i){var s,o=0,l=a.length;for(a=a.slice();l--;)s=a[l]*i+o,a[l]=s%Qt|0,o=s/Qt|0;return o&&a.unshift(o),a}function t(a,i,s,o){var l,d;if(s!=o)d=s>o?1:-1;else for(l=d=0;l<s;l++)if(a[l]!=i[l]){d=a[l]>i[l]?1:-1;break}return d}function r(a,i,s){for(var o=0;s--;)a[s]-=o,o=a[s]<i[s]?1:0,a[s]=o*Qt+a[s]-i[s];for(;!a[0]&&a.length>1;)a.shift()}return function(a,i,s,o){var l,d,f,u,h,m,p,x,v,g,b,y,A,C,N,w,M,O,D=a.constructor,W=a.s==i.s?1:-1,j=a.d,S=i.d;if(!a.s)return new D(a);if(!i.s)throw Error(Fn+"Division by zero");for(d=a.e-i.e,M=S.length,N=j.length,p=new D(W),x=p.d=[],f=0;S[f]==(j[f]||0);)++f;if(S[f]>(j[f]||0)&&--d,s==null?y=s=D.precision:o?y=s+(Ft(a)-Ft(i))+1:y=s,y<0)return new D(0);if(y=y/gt+2|0,f=0,M==1)for(u=0,S=S[0],y++;(f<N||u)&&y--;f++)A=u*Qt+(j[f]||0),x[f]=A/S|0,u=A%S|0;else{for(u=Qt/(S[0]+1)|0,u>1&&(S=e(S,u),j=e(j,u),M=S.length,N=j.length),C=M,v=j.slice(0,M),g=v.length;g<M;)v[g++]=0;O=S.slice(),O.unshift(0),w=S[0],S[1]>=Qt/2&&++w;do u=0,l=t(S,v,M,g),l<0?(b=v[0],M!=g&&(b=b*Qt+(v[1]||0)),u=b/w|0,u>1?(u>=Qt&&(u=Qt-1),h=e(S,u),m=h.length,g=v.length,l=t(h,v,m,g),l==1&&(u--,r(h,M<m?O:S,m))):(u==0&&(l=u=1),h=S.slice()),m=h.length,m<g&&h.unshift(0),r(v,h,g),l==-1&&(g=v.length,l=t(S,v,M,g),l<1&&(u++,r(v,M<g?O:S,g))),g=v.length):l===0&&(u++,v=[0]),x[f++]=u,l&&v[0]?v[g++]=j[C]||0:(v=[j[C]],g=1);while((C++<N||v[0]!==void 0)&&y--)}return x[0]||x.shift(),p.e=d,ut(p,o?s+Ft(p)+1:s)}}();function Qv(e,t){var r,a,i,s,o,l,d=0,f=0,u=e.constructor,h=u.precision;if(Ft(e)>16)throw Error(yu+Ft(e));if(!e.s)return new u(En);for(jt=!1,l=h,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),f+=5;for(a=Math.log(ca(2,f))/Math.LN10*2+5|0,l+=a,r=i=s=new u(En),u.precision=l;;){if(i=ut(i.times(e),l),r=r.times(++d),o=s.plus(wr(i,r,l)),sr(o.d).slice(0,l)===sr(s.d).slice(0,l)){for(;f--;)s=ut(s.times(s),l);return u.precision=h,t==null?(jt=!0,ut(s,h)):s}s=o}}function Ft(e){for(var t=e.e*gt,r=e.d[0];r>=10;r/=10)t++;return t}function mc(e,t,r){if(t>e.LN10.sd())throw jt=!0,r&&(e.precision=r),Error(Fn+"LN10 precision limit exceeded");return ut(new e(e.LN10),t)}function Wr(e){for(var t="";e--;)t+="0";return t}function zi(e,t){var r,a,i,s,o,l,d,f,u,h=1,m=10,p=e,x=p.d,v=p.constructor,g=v.precision;if(p.s<1)throw Error(Fn+(p.s?"NaN":"-Infinity"));if(p.eq(En))return new v(0);if(t==null?(jt=!1,f=g):f=t,p.eq(10))return t==null&&(jt=!0),mc(v,f);if(f+=m,v.precision=f,r=sr(x),a=r.charAt(0),s=Ft(p),Math.abs(s)<15e14){for(;a<7&&a!=1||a==1&&r.charAt(1)>3;)p=p.times(e),r=sr(p.d),a=r.charAt(0),h++;s=Ft(p),a>1?(p=new v("0."+r),s++):p=new v(a+"."+r.slice(1))}else return d=mc(v,f+2,g).times(s+""),p=zi(new v(a+"."+r.slice(1)),f-m).plus(d),v.precision=g,t==null?(jt=!0,ut(p,g)):p;for(l=o=p=wr(p.minus(En),p.plus(En),f),u=ut(p.times(p),f),i=3;;){if(o=ut(o.times(u),f),d=l.plus(wr(o,new v(i),f)),sr(d.d).slice(0,f)===sr(l.d).slice(0,f))return l=l.times(2),s!==0&&(l=l.plus(mc(v,f+2,g).times(s+""))),l=wr(l,new v(h),f),v.precision=g,t==null?(jt=!0,ut(l,g)):l;l=d,i+=2}}function $m(e,t){var r,a,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(a=t.search(/e/i))>0?(r<0&&(r=a),r+=+t.slice(a+1),t=t.substring(0,a)):r<0&&(r=t.length),a=0;t.charCodeAt(a)===48;)++a;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(a,i),t){if(i-=a,r=r-a-1,e.e=ti(r/gt),e.d=[],a=(r+1)%gt,r<0&&(a+=gt),a<i){for(a&&e.d.push(+t.slice(0,a)),i-=gt;a<i;)e.d.push(+t.slice(a,a+=gt));t=t.slice(a),a=gt-t.length}else a-=i;for(;a--;)t+="0";if(e.d.push(+t),jt&&(e.e>xo||e.e<-xo))throw Error(yu+r)}else e.s=0,e.e=0,e.d=[0];return e}function ut(e,t,r){var a,i,s,o,l,d,f,u,h=e.d;for(o=1,s=h[0];s>=10;s/=10)o++;if(a=t-o,a<0)a+=gt,i=t,f=h[u=0];else{if(u=Math.ceil((a+1)/gt),s=h.length,u>=s)return e;for(f=s=h[u],o=1;s>=10;s/=10)o++;a%=gt,i=a-gt+o}if(r!==void 0&&(s=ca(10,o-i-1),l=f/s%10|0,d=t<0||h[u+1]!==void 0||f%s,d=r<4?(l||d)&&(r==0||r==(e.s<0?3:2)):l>5||l==5&&(r==4||d||r==6&&(a>0?i>0?f/ca(10,o-i):0:h[u-1])%10&1||r==(e.s<0?8:7))),t<1||!h[0])return d?(s=Ft(e),h.length=1,t=t-s-1,h[0]=ca(10,(gt-t%gt)%gt),e.e=ti(-t/gt)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(a==0?(h.length=u,s=1,u--):(h.length=u+1,s=ca(10,gt-a),h[u]=i>0?(f/ca(10,o-i)%ca(10,i)|0)*s:0),d)for(;;)if(u==0){(h[0]+=s)==Qt&&(h[0]=1,++e.e);break}else{if(h[u]+=s,h[u]!=Qt)break;h[u--]=0,s=1}for(a=h.length;h[--a]===0;)h.pop();if(jt&&(e.e>xo||e.e<-xo))throw Error(yu+Ft(e));return e}function Jv(e,t){var r,a,i,s,o,l,d,f,u,h,m=e.constructor,p=m.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new m(e),jt?ut(t,p):t;if(d=e.d,h=t.d,a=t.e,f=e.e,d=d.slice(),o=f-a,o){for(u=o<0,u?(r=d,o=-o,l=h.length):(r=h,a=f,l=d.length),i=Math.max(Math.ceil(p/gt),l)+2,o>i&&(o=i,r.length=1),r.reverse(),i=o;i--;)r.push(0);r.reverse()}else{for(i=d.length,l=h.length,u=i<l,u&&(l=i),i=0;i<l;i++)if(d[i]!=h[i]){u=d[i]<h[i];break}o=0}for(u&&(r=d,d=h,h=r,t.s=-t.s),l=d.length,i=h.length-l;i>0;--i)d[l++]=0;for(i=h.length;i>o;){if(d[--i]<h[i]){for(s=i;s&&d[--s]===0;)d[s]=Qt-1;--d[s],d[i]+=Qt}d[i]-=h[i]}for(;d[--l]===0;)d.pop();for(;d[0]===0;d.shift())--a;return d[0]?(t.d=d,t.e=a,jt?ut(t,p):t):new m(0)}function Sa(e,t,r){var a,i=Ft(e),s=sr(e.d),o=s.length;return t?(r&&(a=r-o)>0?s=s.charAt(0)+"."+s.slice(1)+Wr(a):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Wr(-i-1)+s,r&&(a=r-o)>0&&(s+=Wr(a))):i>=o?(s+=Wr(i+1-o),r&&(a=r-i-1)>0&&(s=s+"."+Wr(a))):((a=i+1)<o&&(s=s.slice(0,a)+"."+s.slice(a)),r&&(a=r-o)>0&&(i+1===o&&(s+="."),s+=Wr(a))),e.s<0?"-"+s:s}function Lm(e,t){if(e.length>t)return e.length=t,!0}function Zv(e){var t,r,a;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(ga+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return $m(o,s.toString())}else if(typeof s!="string")throw Error(ga+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,TP.test(s))$m(o,s);else throw Error(ga+s)}if(i.prototype=Te,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=Zv,i.config=i.set=OP,e===void 0&&(e={}),e)for(a=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<a.length;)e.hasOwnProperty(r=a[t++])||(e[r]=this[r]);return i.config(e),i}function OP(e){if(!e||typeof e!="object")throw Error(Fn+"Object expected");var t,r,a,i=["precision",1,ei,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((a=e[r=i[t]])!==void 0)if(ti(a)===a&&a>=i[t+1]&&a<=i[t+2])this[r]=a;else throw Error(ga+r+": "+a);if((a=e[r="LN10"])!==void 0)if(a==Math.LN10)this[r]=new this(a);else throw Error(ga+r+": "+a);return this}var vu=Zv(IP);En=new vu(1);const st=vu;var _P=e=>e,e0={},t0=e=>e===e0,Rm=e=>function t(){return arguments.length===0||arguments.length===1&&t0(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},n0=(e,t)=>e===1?t:Rm(function(){for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];var s=a.filter(o=>o!==e0).length;return s>=e?t(...a):n0(e-s,Rm(function(){for(var o=arguments.length,l=new Array(o),d=0;d<o;d++)l[d]=arguments[d];var f=a.map(u=>t0(u)?l.shift():u);return t(...f,...l)}))}),hl=e=>n0(e.length,e),Jc=(e,t)=>{for(var r=[],a=e;a<t;++a)r[a-e]=a;return r},MP=hl((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),DP=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];if(!r.length)return _P;var i=r.reverse(),s=i[0],o=i.slice(1);return function(){return o.reduce((l,d)=>d(l),s(...arguments))}},Zc=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),r0=e=>{var t=null,r=null;return function(){for(var a=arguments.length,i=new Array(a),s=0;s<a;s++)i[s]=arguments[s];return t&&i.every((o,l)=>{var d;return o===((d=t)===null||d===void 0?void 0:d[l])})||(t=i,r=e(...i)),r}};function a0(e){var t;return e===0?t=1:t=Math.floor(new st(e).abs().log(10).toNumber())+1,t}function i0(e,t,r){for(var a=new st(e),i=0,s=[];a.lt(t)&&i<1e5;)s.push(a.toNumber()),a=a.add(r),i++;return s}hl((e,t,r)=>{var a=+e,i=+t;return a+r*(i-a)});hl((e,t,r)=>{var a=t-+e;return a=a||1/0,(r-e)/a});hl((e,t,r)=>{var a=t-+e;return a=a||1/0,Math.max(0,Math.min(1,(r-e)/a))});var s0=e=>{var[t,r]=e,[a,i]=[t,r];return t>r&&([a,i]=[r,t]),[a,i]},o0=(e,t,r)=>{if(e.lte(0))return new st(0);var a=a0(e.toNumber()),i=new st(10).pow(a),s=e.div(i),o=a!==1?.05:.1,l=new st(Math.ceil(s.div(o).toNumber())).add(r).mul(o),d=l.mul(i);return t?new st(d.toNumber()):new st(Math.ceil(d.toNumber()))},$P=(e,t,r)=>{var a=new st(1),i=new st(e);if(!i.isint()&&r){var s=Math.abs(e);s<1?(a=new st(10).pow(a0(e)-1),i=new st(Math.floor(i.div(a).toNumber())).mul(a)):s>1&&(i=new st(Math.floor(e)))}else e===0?i=new st(Math.floor((t-1)/2)):r||(i=new st(Math.floor(e)));var o=Math.floor((t-1)/2),l=DP(MP(d=>i.add(new st(d-o).mul(a)).toNumber()),Jc);return l(0,t)},l0=function(t,r,a,i){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(a-1)))return{step:new st(0),tickMin:new st(0),tickMax:new st(0)};var o=o0(new st(r).sub(t).div(a-1),i,s),l;t<=0&&r>=0?l=new st(0):(l=new st(t).add(r).div(2),l=l.sub(new st(l).mod(o)));var d=Math.ceil(l.sub(t).div(o).toNumber()),f=Math.ceil(new st(r).sub(l).div(o).toNumber()),u=d+f+1;return u>a?l0(t,r,a,i,s+1):(u<a&&(f=r>0?f+(a-u):f,d=r>0?d:d+(a-u)),{step:o,tickMin:l.sub(new st(d).mul(o)),tickMax:l.add(new st(f).mul(o))})};function LP(e){var[t,r]=e,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,s=Math.max(a,2),[o,l]=s0([t,r]);if(o===-1/0||l===1/0){var d=l===1/0?[o,...Jc(0,a-1).map(()=>1/0)]:[...Jc(0,a-1).map(()=>-1/0),l];return t>r?Zc(d):d}if(o===l)return $P(o,a,i);var{step:f,tickMin:u,tickMax:h}=l0(o,l,s,i,0),m=i0(u,h.add(new st(.1).mul(f)),f);return t>r?Zc(m):m}function RP(e,t){var[r,a]=e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[s,o]=s0([r,a]);if(s===-1/0||o===1/0)return[r,a];if(s===o)return[s];var l=Math.max(t,2),d=o0(new st(o).sub(s).div(l-1),i,0),f=[...i0(new st(s),new st(o),d),o];return i===!1&&(f=f.map(u=>Math.round(u))),r>a?Zc(f):f}var zP=r0(LP),WP=r0(RP),c0=e=>e.rootProps.maxBarSize,BP=e=>e.rootProps.barGap,d0=e=>e.rootProps.barCategoryGap,FP=e=>e.rootProps.barSize,es=e=>e.rootProps.stackOffset,xu=e=>e.options.chartName,bu=e=>e.rootProps.syncId,u0=e=>e.rootProps.syncMethod,ju=e=>e.options.eventEmitter,Bt={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},yr={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Pn={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},ml=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},qP={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:yr.angleAxisId,includeHidden:!1,name:void 0,reversed:yr.reversed,scale:yr.scale,tick:yr.tick,tickCount:void 0,ticks:void 0,type:yr.type,unit:void 0},UP={allowDataOverflow:Pn.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Pn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Pn.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Pn.scale,tick:Pn.tick,tickCount:Pn.tickCount,ticks:void 0,type:Pn.type,unit:void 0},HP={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:yr.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:yr.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:yr.scale,tick:yr.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},KP={allowDataOverflow:Pn.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Pn.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Pn.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Pn.scale,tick:Pn.tick,tickCount:Pn.tickCount,ticks:void 0,type:"category",unit:void 0},wu=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?HP:qP,Su=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?KP:UP,pl=e=>e.polarOptions,Nu=me([Ir,Tr,Kt],sv),f0=me([pl,Nu],(e,t)=>{if(e!=null)return un(e.innerRadius,t,0)}),h0=me([pl,Nu],(e,t)=>{if(e!=null)return un(e.outerRadius,t,t*.8)}),YP=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},m0=me([pl],YP);me([wu,m0],ml);var p0=me([Nu,f0,h0],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});me([Su,p0],ml);var g0=me([Je,pl,f0,h0,Ir,Tr],(e,t,r,a,i,s)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||a==null)){var{cx:o,cy:l,startAngle:d,endAngle:f}=t;return{cx:un(o,i,i/2),cy:un(l,s,s/2),innerRadius:r,outerRadius:a,startAngle:d,endAngle:f,clockWise:!1}}}),Nt=(e,t)=>t,ts=(e,t,r)=>r;function ku(e){return e==null?void 0:e.id}function y0(e,t,r){var{chartData:a=[]}=t,{allowDuplicatedCategory:i,dataKey:s}=r,o=new Map;return e.forEach(l=>{var d,f=(d=l.data)!==null&&d!==void 0?d:a;if(!(f==null||f.length===0)){var u=ku(l);f.forEach((h,m)=>{var p=s==null||i?m:String(pt(h,s,null)),x=pt(h,l.dataKey,0),v;o.has(p)?v=o.get(p):v={},Object.assign(v,{[u]:x}),o.set(p,v)})}}),Array.from(o.values())}function gl(e){return e.stackId!=null&&e.dataKey!=null}var yl=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function vl(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function GP(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var Gt=e=>{var t=Je(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},ni=e=>e.tooltip.settings.axisId;function zm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function bo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zm(Object(r),!0).forEach(function(a){VP(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zm(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function VP(e,t,r){return(t=XP(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XP(e){var t=QP(e,"string");return typeof t=="symbol"?t:t+""}function QP(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ed=[0,"auto"],An={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},v0=(e,t)=>e.cartesianAxis.xAxis[t],_r=(e,t)=>{var r=v0(e,t);return r??An},Cn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:ed,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Ki},x0=(e,t)=>e.cartesianAxis.yAxis[t],Mr=(e,t)=>{var r=x0(e,t);return r??Cn},JP={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},Au=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??JP},Et=(e,t,r)=>{switch(t){case"xAxis":return _r(e,r);case"yAxis":return Mr(e,r);case"zAxis":return Au(e,r);case"angleAxis":return wu(e,r);case"radiusAxis":return Su(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},ZP=(e,t,r)=>{switch(t){case"xAxis":return _r(e,r);case"yAxis":return Mr(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},ns=(e,t,r)=>{switch(t){case"xAxis":return _r(e,r);case"yAxis":return Mr(e,r);case"angleAxis":return wu(e,r);case"radiusAxis":return Su(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},b0=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Cu(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var xl=e=>e.graphicalItems.cartesianItems,eE=me([Nt,ts],Cu),Pu=(e,t,r)=>e.filter(r).filter(a=>(t==null?void 0:t.includeHidden)===!0?!0:!a.hide),rs=me([xl,Et,eE],Pu,{memoizeOptions:{resultEqualityCheck:vl}}),j0=me([rs],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(gl)),w0=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),tE=me([rs],w0),Eu=e=>e.map(t=>t.data).filter(Boolean).flat(1),nE=me([rs],Eu,{memoizeOptions:{resultEqualityCheck:vl}}),Iu=(e,t)=>{var{chartData:r=[],dataStartIndex:a,dataEndIndex:i}=t;return e.length>0?e:r.slice(a,i+1)},Tu=me([nE,fl],Iu),Ou=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(a=>({value:pt(a,t.dataKey)})):r.length>0?r.map(a=>a.dataKey).flatMap(a=>e.map(i=>({value:pt(i,a)}))):e.map(a=>({value:a})),bl=me([Tu,Et,rs],Ou);function S0(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Bs(e){if(lr(e)||e instanceof Date){var t=Number(e);if($t(t))return t}}function Wm(e){if(Array.isArray(e)){var t=[Bs(e[0]),Bs(e[1])];return wa(t)?t:void 0}var r=Bs(e);if(r!=null)return[r,r]}function Pr(e){return e.map(Bs).filter(Jw)}function rE(e,t,r){return!r||typeof t!="number"||Qn(t)?[]:r.length?Pr(r.flatMap(a=>{var i=pt(e,a.dataKey),s,o;if(Array.isArray(i)?[s,o]=i:s=o=i,!(!$t(s)||!$t(o)))return[t-s,t+o]})):[]}var Vt=e=>{var t=Gt(e),r=ni(e);return ns(e,t,r)},N0=me([Vt],e=>e==null?void 0:e.dataKey),aE=me([j0,fl,Vt],y0),k0=(e,t,r)=>{var a={},i=t.reduce((s,o)=>(o.stackId==null||(s[o.stackId]==null&&(s[o.stackId]=[]),s[o.stackId].push(o)),s),a);return Object.fromEntries(Object.entries(i).map(s=>{var[o,l]=s,d=l.map(ku);return[o,{stackedData:r2(e,d,r),graphicalItems:l}]}))},td=me([aE,j0,es],k0),A0=(e,t,r,a)=>{var{dataStartIndex:i,dataEndIndex:s}=t;if(a==null&&r!=="zAxis"){var o=l2(e,i,s);if(!(o!=null&&o[0]===0&&o[1]===0))return o}},iE=me([Et],e=>e.allowDataOverflow),_u=e=>{var t;if(e==null||!("domain"in e))return ed;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Pr(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:ed},Mu=me([Et],_u),Du=me([Mu,iE],Gv),sE=me([td,Zr,Nt,Du],A0,{memoizeOptions:{resultEqualityCheck:yl}}),jl=e=>e.errorBars,oE=(e,t,r)=>e.flatMap(a=>t[a.id]).filter(Boolean).filter(a=>S0(r,a)),jo=function(){for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];var i=r.filter(Boolean);if(i.length!==0){var s=i.flat(),o=Math.min(...s),l=Math.max(...s);return[o,l]}},$u=(e,t,r,a,i)=>{var s,o;if(r.length>0&&e.forEach(l=>{r.forEach(d=>{var f,u,h=(f=a[d.id])===null||f===void 0?void 0:f.filter(b=>S0(i,b)),m=pt(l,(u=t.dataKey)!==null&&u!==void 0?u:d.dataKey),p=rE(l,m,h);if(p.length>=2){var x=Math.min(...p),v=Math.max(...p);(s==null||x<s)&&(s=x),(o==null||v>o)&&(o=v)}var g=Wm(m);g!=null&&(s=s==null?g[0]:Math.min(s,g[0]),o=o==null?g[1]:Math.max(o,g[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(l=>{var d=Wm(pt(l,t.dataKey));d!=null&&(s=s==null?d[0]:Math.min(s,d[0]),o=o==null?d[1]:Math.max(o,d[1]))}),$t(s)&&$t(o))return[s,o]},lE=me([Tu,Et,tE,jl,Nt],$u,{memoizeOptions:{resultEqualityCheck:yl}});function cE(e){var{value:t}=e;if(lr(t)||t instanceof Date)return t}var dE=(e,t,r)=>{var a=e.map(cE).filter(i=>i!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&Ig(a))?hv(0,e.length):t.allowDuplicatedCategory?a:Array.from(new Set(a))},C0=e=>e.referenceElements.dots,ri=(e,t,r)=>e.filter(a=>a.ifOverflow==="extendDomain").filter(a=>t==="xAxis"?a.xAxisId===r:a.yAxisId===r),uE=me([C0,Nt,ts],ri),P0=e=>e.referenceElements.areas,fE=me([P0,Nt,ts],ri),E0=e=>e.referenceElements.lines,hE=me([E0,Nt,ts],ri),I0=(e,t)=>{var r=Pr(e.map(a=>t==="xAxis"?a.x:a.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},mE=me(uE,Nt,I0),T0=(e,t)=>{var r=Pr(e.flatMap(a=>[t==="xAxis"?a.x1:a.y1,t==="xAxis"?a.x2:a.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},pE=me([fE,Nt],T0);function gE(e){var t;if(e.x!=null)return Pr([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(a=>a.x);return r==null||r.length===0?[]:Pr(r)}function yE(e){var t;if(e.y!=null)return Pr([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(a=>a.y);return r==null||r.length===0?[]:Pr(r)}var O0=(e,t)=>{var r=e.flatMap(a=>t==="xAxis"?gE(a):yE(a));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},vE=me([hE,Nt],O0),xE=me(mE,vE,pE,(e,t,r)=>jo(e,r,t)),Lu=(e,t,r,a,i,s,o,l)=>{if(r!=null)return r;var d=o==="vertical"&&l==="xAxis"||o==="horizontal"&&l==="yAxis",f=d?jo(a,s,i):jo(s,i);return EP(t,f,e.allowDataOverflow)},bE=me([Et,Mu,Du,sE,lE,xE,Je,Nt],Lu,{memoizeOptions:{resultEqualityCheck:yl}}),jE=[0,1],Ru=(e,t,r,a,i,s,o)=>{if(!((e==null||r==null||r.length===0)&&o===void 0)){var{dataKey:l,type:d}=e,f=Vr(t,s);if(f&&l==null){var u;return hv(0,(u=r==null?void 0:r.length)!==null&&u!==void 0?u:0)}return d==="category"?dE(a,e,f):i==="expand"?jE:o}},zu=me([Et,Je,Tu,bl,es,Nt,bE],Ru),_0=(e,t,r,a,i)=>{if(e!=null){var{scale:s,type:o}=e;if(s==="auto")return t==="radial"&&i==="radiusAxis"?"band":t==="radial"&&i==="angleAxis"?"linear":o==="category"&&a&&(a.indexOf("LineChart")>=0||a.indexOf("AreaChart")>=0||a.indexOf("ComposedChart")>=0&&!r)?"point":o==="category"?"band":"linear";if(typeof s=="string"){var l="scale".concat(qi(s));return l in ki?l:"point"}}},ai=me([Et,Je,b0,xu,Nt],_0);function wE(e){if(e!=null){if(e in ki)return ki[e]();var t="scale".concat(qi(e));if(t in ki)return ki[t]()}}function Wu(e,t,r,a){if(!(r==null||a==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(a);var i=wE(t);if(i!=null){var s=i.domain(r).range(a);return JN(s),s}}}var Bu=(e,t,r)=>{var a=_u(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(a)&&(a[0]==="auto"||a[1]==="auto")&&wa(e))return zP(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&wa(e))return WP(e,t.tickCount,t.allowDecimals)}},Fu=me([zu,ns,ai],Bu),qu=(e,t,r,a)=>{if(a!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&wa(t)&&Array.isArray(r)&&r.length>0){var i=t[0],s=r[0],o=t[1],l=r[r.length-1];return[Math.min(i,s),Math.max(o,l)]}return t},SE=me([Et,zu,Fu,Nt],qu),NE=me(bl,Et,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,a=Array.from(Pr(e.map(l=>l.value))).sort((l,d)=>l-d);if(a.length<2)return 1/0;var i=a[a.length-1]-a[0];if(i===0)return 1/0;for(var s=0;s<a.length-1;s++){var o=a[s+1]-a[s];r=Math.min(r,o)}return r/i}}),M0=me(NE,Je,d0,Kt,(e,t,r,a)=>a,(e,t,r,a,i)=>{if(!$t(e))return 0;var s=t==="vertical"?a.height:a.width;if(i==="gap")return e*s/2;if(i==="no-gap"){var o=un(r,e*s),l=e*s/2;return l-o-(l-o)/s*o}return 0}),kE=(e,t)=>{var r=_r(e,t);return r==null||typeof r.padding!="string"?0:M0(e,"xAxis",t,r.padding)},AE=(e,t)=>{var r=Mr(e,t);return r==null||typeof r.padding!="string"?0:M0(e,"yAxis",t,r.padding)},CE=me(_r,kE,(e,t)=>{var r,a;if(e==null)return{left:0,right:0};var{padding:i}=e;return typeof i=="string"?{left:t,right:t}:{left:((r=i.left)!==null&&r!==void 0?r:0)+t,right:((a=i.right)!==null&&a!==void 0?a:0)+t}}),PE=me(Mr,AE,(e,t)=>{var r,a;if(e==null)return{top:0,bottom:0};var{padding:i}=e;return typeof i=="string"?{top:t,bottom:t}:{top:((r=i.top)!==null&&r!==void 0?r:0)+t,bottom:((a=i.bottom)!==null&&a!==void 0?a:0)+t}}),EE=me([Kt,CE,rl,nl,(e,t,r)=>r],(e,t,r,a,i)=>{var{padding:s}=a;return i?[s.left,r.width-s.right]:[e.left+t.left,e.left+e.width-t.right]}),IE=me([Kt,Je,PE,rl,nl,(e,t,r)=>r],(e,t,r,a,i,s)=>{var{padding:o}=i;return s?[a.height-o.bottom,o.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),as=(e,t,r,a)=>{var i;switch(t){case"xAxis":return EE(e,r,a);case"yAxis":return IE(e,r,a);case"zAxis":return(i=Au(e,r))===null||i===void 0?void 0:i.range;case"angleAxis":return m0(e);case"radiusAxis":return p0(e,r);default:return}},D0=me([Et,as],ml),ii=me([Et,ai,SE,D0],Wu);me([rs,jl,Nt],oE);function $0(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var wl=(e,t)=>t,Sl=(e,t,r)=>r,TE=me(el,wl,Sl,(e,t,r)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===r).sort($0)),OE=me(tl,wl,Sl,(e,t,r)=>e.filter(a=>a.orientation===t).filter(a=>a.mirror===r).sort($0)),L0=(e,t)=>({width:e.width,height:t.height}),_E=(e,t)=>{var r=typeof t.width=="number"?t.width:Ki;return{width:r,height:e.height}},R0=me(Kt,_r,L0),ME=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},DE=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},$E=me(Tr,Kt,TE,wl,Sl,(e,t,r,a,i)=>{var s={},o;return r.forEach(l=>{var d=L0(t,l);o==null&&(o=ME(t,a,e));var f=a==="top"&&!i||a==="bottom"&&i;s[l.id]=o-Number(f)*d.height,o+=(f?-1:1)*d.height}),s}),LE=me(Ir,Kt,OE,wl,Sl,(e,t,r,a,i)=>{var s={},o;return r.forEach(l=>{var d=_E(t,l);o==null&&(o=DE(t,a,e));var f=a==="left"&&!i||a==="right"&&i;s[l.id]=o-Number(f)*d.width,o+=(f?-1:1)*d.width}),s}),RE=(e,t)=>{var r=_r(e,t);if(r!=null)return $E(e,r.orientation,r.mirror)},zE=me([Kt,_r,RE,(e,t)=>t],(e,t,r,a)=>{if(t!=null){var i=r==null?void 0:r[a];return i==null?{x:e.left,y:0}:{x:e.left,y:i}}}),WE=(e,t)=>{var r=Mr(e,t);if(r!=null)return LE(e,r.orientation,r.mirror)},BE=me([Kt,Mr,WE,(e,t)=>t],(e,t,r,a)=>{if(t!=null){var i=r==null?void 0:r[a];return i==null?{x:0,y:e.top}:{x:i,y:e.top}}}),z0=me(Kt,Mr,(e,t)=>{var r=typeof t.width=="number"?t.width:Ki;return{width:r,height:e.height}}),Bm=(e,t,r)=>{switch(t){case"xAxis":return R0(e,r).width;case"yAxis":return z0(e,r).height;default:return}},W0=(e,t,r,a)=>{if(r!=null){var{allowDuplicatedCategory:i,type:s,dataKey:o}=r,l=Vr(e,a),d=t.map(f=>f.value);if(o&&l&&s==="category"&&i&&Ig(d))return d}},Uu=me([Je,bl,Et,Nt],W0),B0=(e,t,r,a)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:s}=r,o=Vr(e,a);if(o&&(i==="number"||s!=="auto"))return t.map(l=>l.value)}},Hu=me([Je,bl,ns,Nt],B0),Fm=me([Je,ZP,ai,ii,Uu,Hu,as,Fu,Nt],(e,t,r,a,i,s,o,l,d)=>{if(t!=null){var f=Vr(e,d);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:d,categoricalDomain:s,duplicateDomain:i,isCategorical:f,niceTicks:l,range:o,realScaleType:r,scale:a}}}),FE=(e,t,r,a,i,s,o,l,d)=>{if(!(t==null||a==null)){var f=Vr(e,d),{type:u,ticks:h,tickCount:m}=t,p=r==="scaleBand"&&typeof a.bandwidth=="function"?a.bandwidth()/2:2,x=u==="category"&&a.bandwidth?a.bandwidth()/p:0;x=d==="angleAxis"&&s!=null&&s.length>=2?Jt(s[0]-s[1])*2*x:x;var v=h||i;if(v){var g=v.map((b,y)=>{var A=o?o.indexOf(b):b;return{index:y,coordinate:a(A)+x,value:b,offset:x}});return g.filter(b=>$t(b.coordinate))}return f&&l?l.map((b,y)=>({coordinate:a(b)+x,value:b,index:y,offset:x})).filter(b=>$t(b.coordinate)):a.ticks?a.ticks(m).map(b=>({coordinate:a(b)+x,value:b,offset:x})):a.domain().map((b,y)=>({coordinate:a(b)+x,value:o?o[b]:b,index:y,offset:x}))}},F0=me([Je,ns,ai,ii,Fu,as,Uu,Hu,Nt],FE),qE=(e,t,r,a,i,s,o)=>{if(!(t==null||r==null||a==null||a[0]===a[1])){var l=Vr(e,o),{tickCount:d}=t,f=0;return f=o==="angleAxis"&&(a==null?void 0:a.length)>=2?Jt(a[0]-a[1])*2*f:f,l&&s?s.map((u,h)=>({coordinate:r(u)+f,value:u,index:h,offset:f})):r.ticks?r.ticks(d).map(u=>({coordinate:r(u)+f,value:u,offset:f})):r.domain().map((u,h)=>({coordinate:r(u)+f,value:i?i[u]:u,index:h,offset:f}))}},Ur=me([Je,ns,ii,as,Uu,Hu,Nt],qE),Hr=me(Et,ii,(e,t)=>{if(!(e==null||t==null))return bo(bo({},e),{},{scale:t})}),UE=me([Et,ai,zu,D0],Wu);me((e,t,r)=>Au(e,r),UE,(e,t)=>{if(!(e==null||t==null))return bo(bo({},e),{},{scale:t})});var HE=me([Je,el,tl],(e,t,r)=>{switch(e){case"horizontal":return t.some(a=>a.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(a=>a.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),q0=e=>e.options.defaultTooltipEventType,U0=e=>e.options.validateTooltipEventTypes;function H0(e,t,r){if(e==null)return t;var a=e?"axis":"item";return r==null?t:r.includes(a)?a:t}function Ku(e,t){var r=q0(e),a=U0(e);return H0(t,r,a)}function KE(e){return Me(t=>Ku(t,e))}var K0=(e,t)=>{var r,a=Number(t);if(!(Qn(a)||t==null))return a>=0?e==null||(r=e[a])===null||r===void 0?void 0:r.value:void 0},YE=e=>e.tooltip.settings,Fr={active:!1,index:null,dataKey:void 0,coordinate:void 0},GE={itemInteraction:{click:Fr,hover:Fr},axisInteraction:{click:Fr,hover:Fr},keyboardInteraction:Fr,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},Y0=Sn({name:"tooltip",initialState:GE,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Ht()},removeTooltipEntrySettings:{reducer(e,t){var r=jr(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:Ht()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:VE,removeTooltipEntrySettings:XE,setTooltipSettingsState:QE,setActiveMouseOverItemIndex:G0,mouseLeaveItem:JE,mouseLeaveChart:V0,setActiveClickItemIndex:ZE,setMouseOverAxisIndex:X0,setMouseClickAxisIndex:eI,setSyncInteraction:nd,setKeyboardInteraction:rd}=Y0.actions,tI=Y0.reducer;function qm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function $s(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qm(Object(r),!0).forEach(function(a){nI(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qm(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function nI(e,t,r){return(t=rI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rI(e){var t=aI(e,"string");return typeof t=="symbol"?t:t+""}function aI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function iI(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function sI(e){return e.index!=null}var Q0=(e,t,r,a)=>{if(t==null)return Fr;var i=iI(e,t,r);if(i==null)return Fr;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var s=e.settings.active===!0;if(sI(i)){if(s)return $s($s({},i),{},{active:!0})}else if(a!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:a};return $s($s({},Fr),{},{coordinate:i.coordinate})},Yu=(e,t)=>{var r=e==null?void 0:e.index;if(r==null)return null;var a=Number(r);if(!$t(a))return r;var i=0,s=1/0;return t.length>0&&(s=t.length-1),String(Math.max(i,Math.min(a,s)))},J0=(e,t,r,a,i,s,o,l)=>{if(!(s==null||l==null)){var d=o[0],f=d==null?void 0:l(d.positions,s);if(f!=null)return f;var u=i==null?void 0:i[Number(s)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(a.top+t)/2};default:return{x:(a.left+e)/2,y:u.coordinate}}}},Z0=(e,t,r,a)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var i;return r==="hover"?i=e.itemInteraction.hover.dataKey:i=e.itemInteraction.click.dataKey,i==null&&a!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(s=>{var o;return((o=s.settings)===null||o===void 0?void 0:o.dataKey)===i})},is=e=>e.options.tooltipPayloadSearcher,si=e=>e.tooltip;function Um(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Hm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Um(Object(r),!0).forEach(function(a){oI(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Um(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function oI(e,t,r){return(t=lI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lI(e){var t=cI(e,"string");return typeof t=="symbol"?t:t+""}function cI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dI(e,t){return e??t}var ex=(e,t,r,a,i,s,o)=>{if(!(t==null||s==null)){var{chartData:l,computedData:d,dataStartIndex:f,dataEndIndex:u}=r,h=[];return e.reduce((m,p)=>{var x,{dataDefinedOnItem:v,settings:g}=p,b=dI(v,l),y=Array.isArray(b)?Dy(b,f,u):b,A=(x=g==null?void 0:g.dataKey)!==null&&x!==void 0?x:a,C=g==null?void 0:g.nameKey,N;if(a&&Array.isArray(y)&&!Array.isArray(y[0])&&o==="axis"?N=Tg(y,a,i):N=s(y,t,d,C),Array.isArray(N))N.forEach(M=>{var O=Hm(Hm({},g),{},{name:M.name,unit:M.unit,color:void 0,fill:void 0});m.push(Ch({tooltipEntrySettings:O,dataKey:M.dataKey,payload:M.payload,value:pt(M.payload,M.dataKey),name:M.name}))});else{var w;m.push(Ch({tooltipEntrySettings:g,dataKey:A,payload:N,value:pt(N,A),name:(w=pt(N,C))!==null&&w!==void 0?w:g==null?void 0:g.name}))}return m},h)}},Gu=me([Vt,Je,b0,xu,Gt],_0),uI=me([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),fI=me([Gt,ni],Cu),ss=me([uI,Vt,fI],Pu,{memoizeOptions:{resultEqualityCheck:vl}}),hI=me([ss],e=>e.filter(gl)),mI=me([ss],Eu,{memoizeOptions:{resultEqualityCheck:vl}}),oi=me([mI,Zr],Iu),pI=me([hI,Zr,Vt],y0),Vu=me([oi,Vt,ss],Ou),tx=me([Vt],_u),gI=me([Vt],e=>e.allowDataOverflow),nx=me([tx,gI],Gv),yI=me([ss],e=>e.filter(gl)),vI=me([pI,yI,es],k0),xI=me([vI,Zr,Gt,nx],A0),bI=me([ss],w0),jI=me([oi,Vt,bI,jl,Gt],$u,{memoizeOptions:{resultEqualityCheck:yl}}),wI=me([C0,Gt,ni],ri),SI=me([wI,Gt],I0),NI=me([P0,Gt,ni],ri),kI=me([NI,Gt],T0),AI=me([E0,Gt,ni],ri),CI=me([AI,Gt],O0),PI=me([SI,CI,kI],jo),EI=me([Vt,tx,nx,xI,jI,PI,Je,Gt],Lu),rx=me([Vt,Je,oi,Vu,es,Gt,EI],Ru),II=me([rx,Vt,Gu],Bu),TI=me([Vt,rx,II,Gt],qu),ax=e=>{var t=Gt(e),r=ni(e),a=!1;return as(e,t,r,a)},ix=me([Vt,ax],ml),sx=me([Vt,Gu,TI,ix],Wu),OI=me([Je,Vu,Vt,Gt],W0),_I=me([Je,Vu,Vt,Gt],B0),MI=(e,t,r,a,i,s,o,l)=>{if(t){var{type:d}=t,f=Vr(e,l);if(a){var u=r==="scaleBand"&&a.bandwidth?a.bandwidth()/2:2,h=d==="category"&&a.bandwidth?a.bandwidth()/u:0;return h=l==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?Jt(i[0]-i[1])*2*h:h,f&&o?o.map((m,p)=>({coordinate:a(m)+h,value:m,index:p,offset:h})):a.domain().map((m,p)=>({coordinate:a(m)+h,value:s?s[m]:m,index:p,offset:h}))}}},Dr=me([Je,Vt,Gu,sx,ax,OI,_I,Gt],MI),Xu=me([q0,U0,YE],(e,t,r)=>H0(r.shared,e,t)),ox=e=>e.tooltip.settings.trigger,Qu=e=>e.tooltip.settings.defaultIndex,Nl=me([si,Xu,ox,Qu],Q0),Kr=me([Nl,oi],Yu),lx=me([Dr,Kr],K0),cx=me([Nl],e=>{if(e)return e.dataKey}),dx=me([si,Xu,ox,Qu],Z0),DI=me([Ir,Tr,Je,Kt,Dr,Qu,dx,is],J0),$I=me([Nl,DI],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),LI=me([Nl],e=>e.active),RI=me([dx,Kr,Zr,N0,lx,is,Xu],ex),zI=me([RI],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function Km(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Ym(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Km(Object(r),!0).forEach(function(a){WI(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Km(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function WI(e,t,r){return(t=BI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BI(e){var t=FI(e,"string");return typeof t=="symbol"?t:t+""}function FI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var qI=()=>Me(Vt),UI=()=>{var e=qI(),t=Me(Dr),r=Me(sx);return Ya(!e||!r?void 0:Ym(Ym({},e),{},{scale:r}),t)};function Gm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function za(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gm(Object(r),!0).forEach(function(a){HI(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gm(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function HI(e,t,r){return(t=KI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KI(e){var t=YI(e,"string");return typeof t=="symbol"?t:t+""}function YI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var GI=(e,t,r,a)=>{var i=t.find(s=>s&&s.index===r);if(i){if(e==="horizontal")return{x:i.coordinate,y:a.chartY};if(e==="vertical")return{x:a.chartX,y:i.coordinate}}return{x:0,y:0}},VI=(e,t,r,a)=>{var i=t.find(f=>f&&f.index===r);if(i){if(e==="centric"){var s=i.coordinate,{radius:o}=a;return za(za(za({},a),Wt(a.cx,a.cy,o,s)),{},{angle:s,radius:o})}var l=i.coordinate,{angle:d}=a;return za(za(za({},a),Wt(a.cx,a.cy,l,d)),{},{angle:d,radius:l})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function XI(e,t){var{chartX:r,chartY:a}=e;return r>=t.left&&r<=t.left+t.width&&a>=t.top&&a<=t.top+t.height}var ux=(e,t,r,a,i)=>{var s,o=-1,l=(s=t==null?void 0:t.length)!==null&&s!==void 0?s:0;if(l<=1||e==null)return 0;if(a==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var d=0;d<l;d++){var f=d>0?r[d-1].coordinate:r[l-1].coordinate,u=r[d].coordinate,h=d>=l-1?r[0].coordinate:r[d+1].coordinate,m=void 0;if(Jt(u-f)!==Jt(h-u)){var p=[];if(Jt(h-u)===Jt(i[1]-i[0])){m=h;var x=u+i[1]-i[0];p[0]=Math.min(x,(x+f)/2),p[1]=Math.max(x,(x+f)/2)}else{m=f;var v=h+i[1]-i[0];p[0]=Math.min(u,(v+u)/2),p[1]=Math.max(u,(v+u)/2)}var g=[Math.min(u,(m+u)/2),Math.max(u,(m+u)/2)];if(e>g[0]&&e<=g[1]||e>=p[0]&&e<=p[1]){({index:o}=r[d]);break}}else{var b=Math.min(f,h),y=Math.max(f,h);if(e>(b+u)/2&&e<=(y+u)/2){({index:o}=r[d]);break}}}else if(t){for(var A=0;A<l;A++)if(A===0&&e<=(t[A].coordinate+t[A+1].coordinate)/2||A>0&&A<l-1&&e>(t[A].coordinate+t[A-1].coordinate)/2&&e<=(t[A].coordinate+t[A+1].coordinate)/2||A===l-1&&e>(t[A].coordinate+t[A-1].coordinate)/2){({index:o}=t[A]);break}}return o},QI=()=>Me(xu),Ju=(e,t)=>t,fx=(e,t,r)=>r,Zu=(e,t,r,a)=>a,JI=me(Dr,e=>Go(e,t=>t.coordinate)),ef=me([si,Ju,fx,Zu],Q0),hx=me([ef,oi],Yu),ZI=(e,t,r)=>{if(t!=null){var a=si(e);return t==="axis"?r==="hover"?a.axisInteraction.hover.dataKey:a.axisInteraction.click.dataKey:r==="hover"?a.itemInteraction.hover.dataKey:a.itemInteraction.click.dataKey}},mx=me([si,Ju,fx,Zu],Z0),wo=me([Ir,Tr,Je,Kt,Dr,Zu,mx,is],J0),eT=me([ef,wo],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),px=me([Dr,hx],K0),tT=me([mx,hx,Zr,N0,px,is,Ju],ex),nT=me([ef],e=>({isActive:e.active,activeIndex:e.index})),rT=(e,t,r,a,i,s,o)=>{if(!(!e||!r||!a||!i)&&XI(e,o)){var l=c2(e,t),d=ux(l,s,i,r,a),f=GI(t,i,d,e);return{activeIndex:String(d),activeCoordinate:f}}},aT=(e,t,r,a,i,s,o)=>{if(!(!e||!a||!i||!s||!r)){var l=Vk(e,r);if(l){var d=d2(l,t),f=ux(d,o,s,a,i),u=VI(t,s,f,l);return{activeIndex:String(f),activeCoordinate:u}}}},iT=(e,t,r,a,i,s,o,l)=>{if(!(!e||!t||!a||!i||!s))return t==="horizontal"||t==="vertical"?rT(e,t,a,i,s,o,l):aT(e,t,r,a,i,s,o)},sT=me(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var a=e[t];if(a!=null)return r?a.panoramaElementId:a.elementId}}),oT=me(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(a=>parseInt(a,10)).concat(Object.values(Bt)),r=Array.from(new Set(t));return r.sort((a,i)=>a-i)},{memoizeOptions:{resultEqualityCheck:GP}});function Vm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Xm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vm(Object(r),!0).forEach(function(a){lT(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vm(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function lT(e,t,r){return(t=cT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cT(e){var t=dT(e,"string");return typeof t=="symbol"?t:t+""}function dT(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uT={},fT={zIndexMap:Object.values(Bt).reduce((e,t)=>Xm(Xm({},e),{},{[t]:{elementId:void 0,panoramaElementId:void 0,consumers:0}}),uT)},hT=new Set(Object.values(Bt));function mT(e){return hT.has(e)}var gx=Sn({name:"zIndex",initialState:fT,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,elementId:void 0,panoramaElementId:void 0}},prepare:Ht()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!mT(r)&&delete e.zIndexMap[r])},prepare:Ht()},registerZIndexPortalId:{reducer:(e,t)=>{var{zIndex:r,elementId:a,isPanorama:i}=t.payload;e.zIndexMap[r]?i?e.zIndexMap[r].panoramaElementId=a:e.zIndexMap[r].elementId=a:e.zIndexMap[r]={consumers:0,elementId:i?void 0:a,panoramaElementId:i?a:void 0}},prepare:Ht()},unregisterZIndexPortalId:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElementId=void 0:e.zIndexMap[r].elementId=void 0)},prepare:Ht()}}}),{registerZIndexPortal:pT,unregisterZIndexPortal:gT,registerZIndexPortalId:yT,unregisterZIndexPortalId:vT}=gx.actions,xT=gx.reducer;function Nn(e){var{zIndex:t,children:r}=e,a=$2(),i=a&&t!==void 0&&t!==0,s=fn(),o=St();c.useLayoutEffect(()=>i?(o(pT({zIndex:t})),()=>{o(gT({zIndex:t}))}):Aa,[o,t,i]);var l=Me(f=>sT(f,t,s));if(!i)return r;if(!l)return null;var d=document.getElementById(l);return d?yd.createPortal(r,d):null}function ad(){return ad=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ad.apply(null,arguments)}function Qm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Ls(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qm(Object(r),!0).forEach(function(a){bT(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qm(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function bT(e,t,r){return(t=jT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jT(e){var t=wT(e,"string");return typeof t=="symbol"?t:t+""}function wT(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ST(e){var{cursor:t,cursorComp:r,cursorProps:a}=e;return c.isValidElement(t)?c.cloneElement(t,a):c.createElement(r,a)}function NT(e){var t,{coordinate:r,payload:a,index:i,offset:s,tooltipAxisBandSize:o,layout:l,cursor:d,tooltipEventType:f,chartName:u}=e,h=r,m=a,p=i;if(!d||!h||u!=="ScatterChart"&&f!=="axis")return null;var x,v,g;if(u==="ScatterChart")x=h,v=uk,g=Bt.cursorLine;else if(u==="BarChart")x=fk(l,h,s,o),v=iv,g=Bt.cursorRectangle;else if(l==="radial"&&Mg(h)){var{cx:b,cy:y,radius:A,startAngle:C,endAngle:N}=ov(h);x={cx:b,cy:y,startAngle:C,endAngle:N,innerRadius:A,outerRadius:A},v=cv,g=Bt.cursorLine}else x={points:Zk(l,h,s)},v=Kd,g=Bt.cursorLine;var w=typeof d=="object"&&"className"in d?d.className:void 0,M=Ls(Ls(Ls(Ls({stroke:"#ccc",pointerEvents:"none"},s),x),va(d)),{},{payload:m,payloadIndex:p,className:et("recharts-tooltip-cursor",w)});return c.createElement(Nn,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:g},c.createElement(ST,{cursor:d,cursorComp:v,cursorProps:M}))}function kT(e){var t=UI(),r=Gy(),a=Yi(),i=QI();return t==null||r==null||a==null||i==null?null:c.createElement(NT,ad({},e,{offset:r,layout:a,tooltipAxisBandSize:t,chartName:i}))}var yx=c.createContext(null),AT=()=>c.useContext(yx),vx={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function a(){}Object.create&&(a.prototype=Object.create(null),new a().__proto__||(r=!1));function i(d,f,u){this.fn=d,this.context=f,this.once=u||!1}function s(d,f,u,h,m){if(typeof u!="function")throw new TypeError("The listener must be a function");var p=new i(u,h||d,m),x=r?r+f:f;return d._events[x]?d._events[x].fn?d._events[x]=[d._events[x],p]:d._events[x].push(p):(d._events[x]=p,d._eventsCount++),d}function o(d,f){--d._eventsCount===0?d._events=new a:delete d._events[f]}function l(){this._events=new a,this._eventsCount=0}l.prototype.eventNames=function(){var f=[],u,h;if(this._eventsCount===0)return f;for(h in u=this._events)t.call(u,h)&&f.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(u)):f},l.prototype.listeners=function(f){var u=r?r+f:f,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var m=0,p=h.length,x=new Array(p);m<p;m++)x[m]=h[m].fn;return x},l.prototype.listenerCount=function(f){var u=r?r+f:f,h=this._events[u];return h?h.fn?1:h.length:0},l.prototype.emit=function(f,u,h,m,p,x){var v=r?r+f:f;if(!this._events[v])return!1;var g=this._events[v],b=arguments.length,y,A;if(g.fn){switch(g.once&&this.removeListener(f,g.fn,void 0,!0),b){case 1:return g.fn.call(g.context),!0;case 2:return g.fn.call(g.context,u),!0;case 3:return g.fn.call(g.context,u,h),!0;case 4:return g.fn.call(g.context,u,h,m),!0;case 5:return g.fn.call(g.context,u,h,m,p),!0;case 6:return g.fn.call(g.context,u,h,m,p,x),!0}for(A=1,y=new Array(b-1);A<b;A++)y[A-1]=arguments[A];g.fn.apply(g.context,y)}else{var C=g.length,N;for(A=0;A<C;A++)switch(g[A].once&&this.removeListener(f,g[A].fn,void 0,!0),b){case 1:g[A].fn.call(g[A].context);break;case 2:g[A].fn.call(g[A].context,u);break;case 3:g[A].fn.call(g[A].context,u,h);break;case 4:g[A].fn.call(g[A].context,u,h,m);break;default:if(!y)for(N=1,y=new Array(b-1);N<b;N++)y[N-1]=arguments[N];g[A].fn.apply(g[A].context,y)}}return!0},l.prototype.on=function(f,u,h){return s(this,f,u,h,!1)},l.prototype.once=function(f,u,h){return s(this,f,u,h,!0)},l.prototype.removeListener=function(f,u,h,m){var p=r?r+f:f;if(!this._events[p])return this;if(!u)return o(this,p),this;var x=this._events[p];if(x.fn)x.fn===u&&(!m||x.once)&&(!h||x.context===h)&&o(this,p);else{for(var v=0,g=[],b=x.length;v<b;v++)(x[v].fn!==u||m&&!x[v].once||h&&x[v].context!==h)&&g.push(x[v]);g.length?this._events[p]=g.length===1?g[0]:g:o(this,p)}return this},l.prototype.removeAllListeners=function(f){var u;return f?(u=r?r+f:f,this._events[u]&&o(this,u)):(this._events=new a,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(vx);var CT=vx.exports;const PT=Gr(CT);var Wi=new PT,id="recharts.syncEvent.tooltip",Jm="recharts.syncEvent.brush";function tf(e,t){if(t){var r=Number.parseInt(t,10);if(!Qn(r))return e==null?void 0:e[r]}}var ET={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},xx=Sn({name:"options",initialState:ET,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),IT=xx.reducer,{createEventEmitter:TT}=xx.actions;function OT(e){return e.tooltip.syncInteraction}var _T={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},bx=Sn({name:"chartData",initialState:_T,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:a}=t.payload;r!=null&&(e.dataStartIndex=r),a!=null&&(e.dataEndIndex=a)}}}),{setChartData:Zm,setDataStartEndIndexes:MT,setComputedData:mL}=bx.actions,DT=bx.reducer,$T=["x","y"];function ep(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Wa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ep(Object(r),!0).forEach(function(a){LT(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ep(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function LT(e,t,r){return(t=RT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RT(e){var t=zT(e,"string");return typeof t=="symbol"?t:t+""}function zT(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WT(e,t){if(e==null)return{};var r,a,i=BT(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function BT(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function FT(){var e=Me(bu),t=Me(ju),r=St(),a=Me(u0),i=Me(Dr),s=Yi(),o=al(),l=Me(d=>d.rootProps.className);c.useEffect(()=>{if(e==null)return Aa;var d=(f,u,h)=>{if(t!==h&&e===f){if(a==="index"){var m;if(o&&u!==null&&u!==void 0&&(m=u.payload)!==null&&m!==void 0&&m.coordinate&&u.payload.sourceViewBox){var p=u.payload.coordinate,{x,y:v}=p,g=WT(p,$T),{x:b,y,width:A,height:C}=u.payload.sourceViewBox,N=Wa(Wa({},g),{},{x:o.x+(A?(x-b)/A:0)*o.width,y:o.y+(C?(v-y)/C:0)*o.height});r(Wa(Wa({},u),{},{payload:Wa(Wa({},u.payload),{},{coordinate:N})}))}else r(u);return}if(i!=null){var w;if(typeof a=="function"){var M={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},O=a(i,M);w=i[O]}else a==="value"&&(w=i.find(J=>String(J.value)===u.payload.label));var{coordinate:D}=u.payload;if(w==null||u.payload.active===!1||D==null||o==null){r(nd({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0}));return}var{x:W,y:j}=D,S=Math.min(W,o.x+o.width),R=Math.min(j,o.y+o.height),I={x:s==="horizontal"?w.coordinate:S,y:s==="horizontal"?R:w.coordinate},$=nd({active:u.payload.active,coordinate:I,dataKey:u.payload.dataKey,index:String(w.index),label:u.payload.label,sourceViewBox:u.payload.sourceViewBox});r($)}}};return Wi.on(id,d),()=>{Wi.off(id,d)}},[l,r,t,e,a,i,s,o])}function qT(){var e=Me(bu),t=Me(ju),r=St();c.useEffect(()=>{if(e==null)return Aa;var a=(i,s,o)=>{t!==o&&e===i&&r(MT(s))};return Wi.on(Jm,a),()=>{Wi.off(Jm,a)}},[r,t,e])}function UT(){var e=St();c.useEffect(()=>{e(TT())},[e]),FT(),qT()}function HT(e,t,r,a,i,s){var o=Me(p=>ZI(p,e,t)),l=Me(ju),d=Me(bu),f=Me(u0),u=Me(OT),h=u==null?void 0:u.active,m=al();c.useEffect(()=>{if(!h&&d!=null&&l!=null){var p=nd({active:s,coordinate:r,dataKey:o,index:i,label:typeof a=="number"?String(a):a,sourceViewBox:m});Wi.emit(id,d,p,l)}},[h,r,o,i,a,l,d,f,s,m])}function tp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function np(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tp(Object(r),!0).forEach(function(a){KT(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function KT(e,t,r){return(t=YT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YT(e){var t=GT(e,"string");return typeof t=="symbol"?t:t+""}function GT(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function VT(e){return e.dataKey}function XT(e,t){return c.isValidElement(e)?c.cloneElement(e,t):typeof e=="function"?c.createElement(e,t):c.createElement(q2,t)}var rp=[],QT={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Xr.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function sd(e){var t,r,a=en(e,QT),{active:i,allowEscapeViewBox:s,animationDuration:o,animationEasing:l,content:d,filterNull:f,isAnimationActive:u,offset:h,payloadUniqBy:m,position:p,reverseDirection:x,useTranslate3d:v,wrapperStyle:g,cursor:b,shared:y,trigger:A,defaultIndex:C,portal:N,axisId:w}=a,M=St(),O=typeof C=="number"?String(C):C;c.useEffect(()=>{M(QE({shared:y,trigger:A,axisId:w,active:i,defaultIndex:O}))},[M,y,A,w,i,O]);var D=al(),W=ev(),j=KE(y),{activeIndex:S,isActive:R}=(t=Me(fe=>nT(fe,j,A,O)))!==null&&t!==void 0?t:{},I=Me(fe=>tT(fe,j,A,O)),$=Me(fe=>px(fe,j,A,O)),J=Me(fe=>eT(fe,j,A,O)),q=I,K=AT(),L=(r=i??R)!==null&&r!==void 0?r:!1,[ee,E]=QS([q,L]),T=j==="axis"?$:void 0;HT(j,A,J,T,S,L);var B=N??K;if(B==null||D==null||j==null)return null;var P=q??rp;L||(P=rp),f&&P.length&&(P=pS(P.filter(fe=>fe.value!=null&&(fe.hide!==!0||a.includeHidden)),m,VT));var _=P.length>0,U=c.createElement(X2,{allowEscapeViewBox:s,animationDuration:o,animationEasing:l,isAnimationActive:u,active:L,coordinate:J,hasPayload:_,offset:h,position:p,reverseDirection:x,useTranslate3d:v,viewBox:D,wrapperStyle:g,lastBoundingBox:ee,innerRef:E,hasPortalFromProps:!!N},XT(d,np(np({},a),{},{payload:P,label:T,active:L,activeIndex:S,coordinate:J,accessibilityLayer:W})));return c.createElement(c.Fragment,null,yd.createPortal(U,B),L&&c.createElement(kT,{cursor:b,tooltipEventType:j,coordinate:J,payload:P,index:S}))}var Ea=e=>null;Ea.displayName="Cell";function JT(e,t,r){return(t=ZT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZT(e){var t=eO(e,"string");return typeof t=="symbol"?t:t+""}function eO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class tO{constructor(t){JT(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var a=this.cache.keys().next().value;this.cache.delete(a)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function ap(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function nO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ap(Object(r),!0).forEach(function(a){rO(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ap(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function rO(e,t,r){return(t=aO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aO(e){var t=iO(e,"string");return typeof t=="symbol"?t:t+""}function iO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var sO={cacheSize:2e3,enableCache:!0},jx=nO({},sO),ip=new tO(jx.cacheSize),oO={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},sp="recharts_measurement_span";function lO(e,t){var r=t.fontSize||"",a=t.fontFamily||"",i=t.fontWeight||"",s=t.fontStyle||"",o=t.letterSpacing||"",l=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(o,"|").concat(l)}var op=(e,t)=>{try{var r=document.getElementById(sp);r||(r=document.createElement("span"),r.setAttribute("id",sp),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,oO,t),r.textContent="".concat(e);var a=r.getBoundingClientRect();return{width:a.width,height:a.height}}catch{return{width:0,height:0}}},Ei=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Xr.isSsr)return{width:0,height:0};if(!jx.enableCache)return op(t,r);var a=lO(t,r),i=ip.get(a);if(i)return i;var s=op(t,r);return ip.set(a,s),s},lp=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,cp=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,cO=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,dO=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,wx={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},uO=Object.keys(wx),Fa="NaN";function fO(e,t){return e*wx[t]}class bn{static parse(t){var r,[,a,i]=(r=dO.exec(t))!==null&&r!==void 0?r:[];return new bn(parseFloat(a),i??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Qn(t)&&(this.unit=""),r!==""&&!cO.test(r)&&(this.num=NaN,this.unit=""),uO.includes(r)&&(this.num=fO(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new bn(NaN,""):new bn(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new bn(NaN,""):new bn(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new bn(NaN,""):new bn(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new bn(NaN,""):new bn(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Qn(this.num)}}function Sx(e){if(e.includes(Fa))return Fa;for(var t=e;t.includes("*")||t.includes("/");){var r,[,a,i,s]=(r=lp.exec(t))!==null&&r!==void 0?r:[],o=bn.parse(a??""),l=bn.parse(s??""),d=i==="*"?o.multiply(l):o.divide(l);if(d.isNaN())return Fa;t=t.replace(lp,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var f,[,u,h,m]=(f=cp.exec(t))!==null&&f!==void 0?f:[],p=bn.parse(u??""),x=bn.parse(m??""),v=h==="+"?p.add(x):p.subtract(x);if(v.isNaN())return Fa;t=t.replace(cp,v.toString())}return t}var dp=/\(([^()]*)\)/;function hO(e){for(var t=e,r;(r=dp.exec(t))!=null;){var[,a]=r;t=t.replace(dp,Sx(a))}return t}function mO(e){var t=e.replace(/\s+/g,"");return t=hO(t),t=Sx(t),t}function pO(e){try{return mO(e)}catch{return Fa}}function pc(e){var t=pO(e.slice(5,-1));return t===Fa?"":t}var gO=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],yO=["dx","dy","angle","className","breakAll"];function od(){return od=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},od.apply(null,arguments)}function up(e,t){if(e==null)return{};var r,a,i=vO(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function vO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Nx=/[ \f\n\r\t\v\u2028\u2029]+/,kx=e=>{var{children:t,breakAll:r,style:a}=e;try{var i=[];wt(t)||(r?i=t.toString().split(""):i=t.toString().split(Nx));var s=i.map(l=>({word:l,width:Ei(l,a).width})),o=r?0:Ei(" ",a).width;return{wordsWithComputedWidth:s,spaceWidth:o}}catch{return null}};function xO(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var Ax=(e,t,r,a)=>e.reduce((i,s)=>{var{word:o,width:l}=s,d=i[i.length-1];if(d&&l!=null&&(t==null||a||d.width+l+r<Number(t)))d.words.push(o),d.width+=l+r;else{var f={words:[o],width:l};i.push(f)}return i},[]),Cx=e=>e.reduce((t,r)=>t.width>r.width?t:r),bO="…",fp=(e,t,r,a,i,s,o,l)=>{var d=e.slice(0,t),f=kx({breakAll:r,style:a,children:d+bO});if(!f)return[!1,[]];var u=Ax(f.wordsWithComputedWidth,s,o,l),h=u.length>i||Cx(u).width>Number(s);return[h,u]},jO=(e,t,r,a,i)=>{var{maxLines:s,children:o,style:l,breakAll:d}=e,f=_e(s),u=String(o),h=Ax(t,a,r,i);if(!f||i)return h;var m=h.length>s||Cx(h).width>Number(a);if(!m)return h;for(var p=0,x=u.length-1,v=0,g;p<=x&&v<=u.length-1;){var b=Math.floor((p+x)/2),y=b-1,[A,C]=fp(u,y,d,l,s,a,r,i),[N]=fp(u,b,d,l,s,a,r,i);if(!A&&!N&&(p=b+1),A&&N&&(x=b-1),!A&&N){g=C;break}v++}return g||h},hp=e=>{var t=wt(e)?[]:e.toString().split(Nx);return[{words:t,width:void 0}]},wO=e=>{var{width:t,scaleToFit:r,children:a,style:i,breakAll:s,maxLines:o}=e;if((t||r)&&!Xr.isSsr){var l,d,f=kx({breakAll:s,children:a,style:i});if(f){var{wordsWithComputedWidth:u,spaceWidth:h}=f;l=u,d=h}else return hp(a);return jO({breakAll:s,children:a,maxLines:o,style:i},l,d,t,!!r)}return hp(a)},Px="#808080",SO={breakAll:!1,capHeight:"0.71em",fill:Px,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},kl=c.forwardRef((e,t)=>{var r=en(e,SO),{x:a,y:i,lineHeight:s,capHeight:o,fill:l,scaleToFit:d,textAnchor:f,verticalAnchor:u}=r,h=up(r,gO),m=c.useMemo(()=>wO({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:d,style:h.style,width:h.width}),[h.breakAll,h.children,h.maxLines,d,h.style,h.width]),{dx:p,dy:x,angle:v,className:g,breakAll:b}=h,y=up(h,yO);if(!lr(a)||!lr(i)||m.length===0)return null;var A=Number(a)+(_e(p)?p:0),C=Number(i)+(_e(x)?x:0);if(!$t(A)||!$t(C))return null;var N;switch(u){case"start":N=pc("calc(".concat(o,")"));break;case"middle":N=pc("calc(".concat((m.length-1)/2," * -").concat(s," + (").concat(o," / 2))"));break;default:N=pc("calc(".concat(m.length-1," * -").concat(s,")"));break}var w=[];if(d){var M=m[0].width,{width:O}=h;w.push("scale(".concat(_e(O)&&_e(M)?O/M:1,")"))}return v&&w.push("rotate(".concat(v,", ").concat(A,", ").concat(C,")")),w.length&&(y.transform=w.join(" ")),c.createElement("text",od({},yn(y),{ref:t,x:A,y:C,className:et("recharts-text",g),textAnchor:f,fill:l.includes("url")?Px:l}),m.map((D,W)=>{var j=D.words.join(b?"":" ");return c.createElement("tspan",{x:A,dy:W===0?N:s,key:"".concat(j,"-").concat(W)},j)}))});kl.displayName="Text";var NO=["labelRef"];function kO(e,t){if(e==null)return{};var r,a,i=AO(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function AO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function mp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Dt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?mp(Object(r),!0).forEach(function(a){CO(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function CO(e,t,r){return(t=PO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PO(e){var t=EO(e,"string");return typeof t=="symbol"?t:t+""}function EO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vr(){return vr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},vr.apply(null,arguments)}var Ex=c.createContext(null),IO=e=>{var{x:t,y:r,upperWidth:a,lowerWidth:i,width:s,height:o,children:l}=e,d=c.useMemo(()=>({x:t,y:r,upperWidth:a,lowerWidth:i,width:s,height:o}),[t,r,a,i,s,o]);return c.createElement(Ex.Provider,{value:d},l)},Ix=()=>{var e=c.useContext(Ex),t=al();return e||Yy(t)},TO=c.createContext(null),OO=()=>{var e=c.useContext(TO),t=Me(g0);return e||t},_O=e=>{var{value:t,formatter:r}=e,a=wt(e.children)?t:e.children;return typeof r=="function"?r(a):a},nf=e=>e!=null&&typeof e=="function",MO=(e,t)=>{var r=Jt(t-e),a=Math.min(Math.abs(t-e),360);return r*a},DO=(e,t,r,a,i)=>{var{offset:s,className:o}=e,{cx:l,cy:d,innerRadius:f,outerRadius:u,startAngle:h,endAngle:m,clockWise:p}=i,x=(f+u)/2,v=MO(h,m),g=v>=0?1:-1,b,y;switch(t){case"insideStart":b=h+g*s,y=p;break;case"insideEnd":b=m-g*s,y=!p;break;case"end":b=m+g*s,y=p;break;default:throw new Error("Unsupported position ".concat(t))}y=v<=0?y:!y;var A=Wt(l,d,x,b),C=Wt(l,d,x,b+(y?1:-1)*359),N="M".concat(A.x,",").concat(A.y,`
    A`).concat(x,",").concat(x,",0,1,").concat(y?0:1,`,
    `).concat(C.x,",").concat(C.y),w=wt(e.id)?Ii("recharts-radial-line-"):e.id;return c.createElement("text",vr({},a,{dominantBaseline:"central",className:et("recharts-radial-bar-label",o)}),c.createElement("defs",null,c.createElement("path",{id:w,d:N})),c.createElement("textPath",{xlinkHref:"#".concat(w)},r))},$O=(e,t,r)=>{var{cx:a,cy:i,innerRadius:s,outerRadius:o,startAngle:l,endAngle:d}=e,f=(l+d)/2;if(r==="outside"){var{x:u,y:h}=Wt(a,i,o+t,f);return{x:u,y:h,textAnchor:u>=a?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:a,y:i,textAnchor:"middle",verticalAnchor:"end"};var m=(s+o)/2,{x:p,y:x}=Wt(a,i,m,f);return{x:p,y:x,textAnchor:"middle",verticalAnchor:"middle"}},ld=e=>"cx"in e&&_e(e.cx),LO=(e,t)=>{var{parentViewBox:r,offset:a,position:i}=e,s;r!=null&&!ld(r)&&(s=r);var{x:o,y:l,upperWidth:d,lowerWidth:f,height:u}=t,h=o,m=o+(d-f)/2,p=(h+m)/2,x=(d+f)/2,v=h+d/2,g=u>=0?1:-1,b=g*a,y=g>0?"end":"start",A=g>0?"start":"end",C=d>=0?1:-1,N=C*a,w=C>0?"end":"start",M=C>0?"start":"end";if(i==="top"){var O={x:h+d/2,y:l-b,textAnchor:"middle",verticalAnchor:y};return Dt(Dt({},O),s?{height:Math.max(l-s.y,0),width:d}:{})}if(i==="bottom"){var D={x:m+f/2,y:l+u+b,textAnchor:"middle",verticalAnchor:A};return Dt(Dt({},D),s?{height:Math.max(s.y+s.height-(l+u),0),width:f}:{})}if(i==="left"){var W={x:p-N,y:l+u/2,textAnchor:w,verticalAnchor:"middle"};return Dt(Dt({},W),s?{width:Math.max(W.x-s.x,0),height:u}:{})}if(i==="right"){var j={x:p+x+N,y:l+u/2,textAnchor:M,verticalAnchor:"middle"};return Dt(Dt({},j),s?{width:Math.max(s.x+s.width-j.x,0),height:u}:{})}var S=s?{width:x,height:u}:{};return i==="insideLeft"?Dt({x:p+N,y:l+u/2,textAnchor:M,verticalAnchor:"middle"},S):i==="insideRight"?Dt({x:p+x-N,y:l+u/2,textAnchor:w,verticalAnchor:"middle"},S):i==="insideTop"?Dt({x:h+d/2,y:l+b,textAnchor:"middle",verticalAnchor:A},S):i==="insideBottom"?Dt({x:m+f/2,y:l+u-b,textAnchor:"middle",verticalAnchor:y},S):i==="insideTopLeft"?Dt({x:h+N,y:l+b,textAnchor:M,verticalAnchor:A},S):i==="insideTopRight"?Dt({x:h+d-N,y:l+b,textAnchor:w,verticalAnchor:A},S):i==="insideBottomLeft"?Dt({x:m+N,y:l+u-b,textAnchor:M,verticalAnchor:y},S):i==="insideBottomRight"?Dt({x:m+f-N,y:l+u-b,textAnchor:w,verticalAnchor:y},S):i&&typeof i=="object"&&(_e(i.x)||Sr(i.x))&&(_e(i.y)||Sr(i.y))?Dt({x:o+un(i.x,x),y:l+un(i.y,u),textAnchor:"end",verticalAnchor:"end"},S):Dt({x:v,y:l+u/2,textAnchor:"middle",verticalAnchor:"middle"},S)},RO={offset:5,zIndex:Bt.label};function Br(e){var t=en(e,RO),{viewBox:r,position:a,value:i,children:s,content:o,className:l="",textBreakAll:d,labelRef:f}=t,u=OO(),h=Ix(),m=a==="center"?h:u??h,p,x,v;if(r==null?p=m:ld(r)?p=r:p=Yy(r),!p||wt(i)&&wt(s)&&!c.isValidElement(o)&&typeof o!="function")return null;var g=Dt(Dt({},t),{},{viewBox:p});if(c.isValidElement(o)){var{labelRef:b}=g,y=kO(g,NO);return c.cloneElement(o,y)}if(typeof o=="function"){if(x=c.createElement(o,g),c.isValidElement(x))return x}else x=_O(t);var A=yn(t);if(ld(p)){if(a==="insideStart"||a==="insideEnd"||a==="end")return DO(t,a,x,A,p);v=$O(p,t.offset,t.position)}else v=LO(t,p);return c.createElement(Nn,{zIndex:t.zIndex},c.createElement(kl,vr({ref:f,className:et("recharts-label",l)},A,v,{textAnchor:xO(A.textAnchor)?A.textAnchor:v.textAnchor,breakAll:d}),x))}Br.displayName="Label";var zO=(e,t,r)=>{if(!e)return null;var a={viewBox:t,labelRef:r};return e===!0?c.createElement(Br,vr({key:"label-implicit"},a)):lr(e)?c.createElement(Br,vr({key:"label-implicit",value:e},a)):c.isValidElement(e)?e.type===Br?c.cloneElement(e,Dt({key:"label-implicit"},a)):c.createElement(Br,vr({key:"label-implicit",content:e},a)):nf(e)?c.createElement(Br,vr({key:"label-implicit",content:e},a)):e&&typeof e=="object"?c.createElement(Br,vr({},e,{key:"label-implicit"},a)):null};function WO(e){var{label:t,labelRef:r}=e,a=Ix();return zO(t,a,r)||null}var Tx={},Ox={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(Ox);var _x={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(_x);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ox,r=_x,a=Ko;function i(s){if(a.isArrayLike(s))return t.last(r.toArray(s))}e.last=i})(Tx);var BO=Tx.last;const FO=Gr(BO);var qO=["valueAccessor"],UO=["dataKey","clockWise","id","textBreakAll","zIndex"];function So(){return So=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},So.apply(null,arguments)}function pp(e,t){if(e==null)return{};var r,a,i=HO(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function HO(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var KO=e=>Array.isArray(e.value)?FO(e.value):e.value,Mx=c.createContext(void 0),Dx=Mx.Provider,$x=c.createContext(void 0),YO=$x.Provider;function GO(){return c.useContext(Mx)}function VO(){return c.useContext($x)}function Fs(e){var{valueAccessor:t=KO}=e,r=pp(e,qO),{dataKey:a,clockWise:i,id:s,textBreakAll:o,zIndex:l}=r,d=pp(r,UO),f=GO(),u=VO(),h=f||u;return!h||!h.length?null:c.createElement(Nn,{zIndex:l??Bt.label},c.createElement(Zt,{className:"recharts-label-list"},h.map((m,p)=>{var x,v=wt(a)?t(m,p):pt(m&&m.payload,a),g=wt(s)?{}:{id:"".concat(s,"-").concat(p)};return c.createElement(Br,So({key:"label-".concat(p)},yn(m),d,g,{fill:(x=r.fill)!==null&&x!==void 0?x:m.fill,parentViewBox:m.parentViewBox,value:v,textBreakAll:o,viewBox:m.viewBox,index:p,zIndex:0}))})))}Fs.displayName="LabelList";function rf(e){var{label:t}=e;return t?t===!0?c.createElement(Fs,{key:"labelList-implicit"}):c.isValidElement(t)||nf(t)?c.createElement(Fs,{key:"labelList-implicit",content:t}):typeof t=="object"?c.createElement(Fs,So({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}function cd(){return cd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},cd.apply(null,arguments)}var Lx=e=>{var{cx:t,cy:r,r:a,className:i}=e,s=et("recharts-dot",i);return _e(t)&&_e(r)&&_e(a)?c.createElement("circle",cd({},Tn(e),Ad(e),{className:s,cx:t,cy:r,r:a})):null},Rx=e=>e.graphicalItems.polarItems,XO=me([Nt,ts],Cu),Al=me([Rx,Et,XO],Pu),QO=me([Al],Eu),Cl=me([QO,gu],Iu),JO=me([Cl,Et,Al],Ou);me([Cl,Et,Al],(e,t,r)=>r.length>0?e.flatMap(a=>r.flatMap(i=>{var s,o=pt(a,(s=t.dataKey)!==null&&s!==void 0?s:i.dataKey);return{value:o,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(a=>({value:pt(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]})));var gp=()=>{},ZO=me([Cl,Et,Al,jl,Nt],$u),e_=me([Et,Mu,Du,gp,ZO,gp,Je,Nt],Lu),zx=me([Et,Je,Cl,JO,es,Nt,e_],Ru),t_=me([zx,Et,ai],Bu);me([Et,zx,t_,Nt],qu);var n_={radiusAxis:{},angleAxis:{}},Wx=Sn({name:"polarAxis",initialState:n_,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:pL,removeRadiusAxis:gL,addAngleAxis:yL,removeAngleAxis:vL}=Wx.actions,r_=Wx.reducer;function yp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function vp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yp(Object(r),!0).forEach(function(a){a_(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function a_(e,t,r){return(t=i_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i_(e){var t=s_(e,"string");return typeof t=="symbol"?t:t+""}function s_(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var o_=(e,t)=>t,af=me([Rx,o_],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),l_=[],sf=(e,t,r)=>(r==null?void 0:r.length)===0?l_:r,Bx=me([gu,af,sf],(e,t,r)=>{var{chartData:a}=e;if(t!=null){var i;if((t==null?void 0:t.data)!=null&&t.data.length>0?i=t.data:i=a,(!i||!i.length)&&r!=null&&(i=r.map(s=>vp(vp({},t.presentationProps),s.props))),i!=null)return i}}),c_=me([Bx,af,sf],(e,t,r)=>{if(!(e==null||t==null))return e.map((a,i)=>{var s,o=pt(a,t.nameKey,t.name),l;return r!=null&&(s=r[i])!==null&&s!==void 0&&(s=s.props)!==null&&s!==void 0&&s.fill?l=r[i].props.fill:typeof a=="object"&&a!=null&&"fill"in a?l=a.fill:l=t.fill,{value:Ja(o,t.dataKey),color:l,payload:a,type:t.legendType}})}),d_=me([Bx,af,sf,Kt],(e,t,r,a)=>{if(!(t==null||e==null))return oM({offset:a,pieSettings:t,displayedData:e,cells:r})}),Fx={exports:{}},ft={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var of=Symbol.for("react.transitional.element"),lf=Symbol.for("react.portal"),Pl=Symbol.for("react.fragment"),El=Symbol.for("react.strict_mode"),Il=Symbol.for("react.profiler"),Tl=Symbol.for("react.consumer"),Ol=Symbol.for("react.context"),_l=Symbol.for("react.forward_ref"),Ml=Symbol.for("react.suspense"),Dl=Symbol.for("react.suspense_list"),$l=Symbol.for("react.memo"),Ll=Symbol.for("react.lazy"),u_=Symbol.for("react.view_transition"),f_=Symbol.for("react.client.reference");function Un(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case of:switch(e=e.type,e){case Pl:case Il:case El:case Ml:case Dl:case u_:return e;default:switch(e=e&&e.$$typeof,e){case Ol:case _l:case Ll:case $l:return e;case Tl:return e;default:return t}}case lf:return t}}}ft.ContextConsumer=Tl;ft.ContextProvider=Ol;ft.Element=of;ft.ForwardRef=_l;ft.Fragment=Pl;ft.Lazy=Ll;ft.Memo=$l;ft.Portal=lf;ft.Profiler=Il;ft.StrictMode=El;ft.Suspense=Ml;ft.SuspenseList=Dl;ft.isContextConsumer=function(e){return Un(e)===Tl};ft.isContextProvider=function(e){return Un(e)===Ol};ft.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===of};ft.isForwardRef=function(e){return Un(e)===_l};ft.isFragment=function(e){return Un(e)===Pl};ft.isLazy=function(e){return Un(e)===Ll};ft.isMemo=function(e){return Un(e)===$l};ft.isPortal=function(e){return Un(e)===lf};ft.isProfiler=function(e){return Un(e)===Il};ft.isStrictMode=function(e){return Un(e)===El};ft.isSuspense=function(e){return Un(e)===Ml};ft.isSuspenseList=function(e){return Un(e)===Dl};ft.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Pl||e===Il||e===El||e===Ml||e===Dl||typeof e=="object"&&e!==null&&(e.$$typeof===Ll||e.$$typeof===$l||e.$$typeof===Ol||e.$$typeof===Tl||e.$$typeof===_l||e.$$typeof===f_||e.getModuleId!==void 0)};ft.typeOf=Un;Fx.exports=ft;var h_=Fx.exports,xp=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",bp=null,gc=null,qx=e=>{if(e===bp&&Array.isArray(gc))return gc;var t=[];return c.Children.forEach(e,r=>{wt(r)||(h_.isFragment(r)?t=t.concat(qx(r.props.children)):t.push(r))}),gc=t,bp=e,t};function cf(e,t){var r=[],a=[];return Array.isArray(t)?a=t.map(i=>xp(i)):a=[xp(t)],qx(e).forEach(i=>{var s=xa(i,"type.displayName")||xa(i,"type.name");s&&a.indexOf(s)!==-1&&r.push(i)}),r}var Ux=e=>e&&typeof e=="object"&&"clipDot"in e?!!e.clipDot:!0,Hx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var i;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const s=r[Symbol.toStringTag];return s==null||!((i=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&i.writable)?!1:r.toString()===`[object ${s}]`}let a=r;for(;Object.getPrototypeOf(a)!==null;)a=Object.getPrototypeOf(a);return Object.getPrototypeOf(r)===a}e.isPlainObject=t})(Hx);var m_=Hx.isPlainObject;const p_=Gr(m_);function jp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function wp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?jp(Object(r),!0).forEach(function(a){g_(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function g_(e,t,r){return(t=y_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function y_(e){var t=v_(e,"string");return typeof t=="symbol"?t:t+""}function v_(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function No(){return No=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},No.apply(null,arguments)}var Sp=(e,t,r,a,i)=>{var s=r-a,o;return o="M ".concat(e,",").concat(t),o+="L ".concat(e+r,",").concat(t),o+="L ".concat(e+r-s/2,",").concat(t+i),o+="L ".concat(e+r-s/2-a,",").concat(t+i),o+="L ".concat(e,",").concat(t," Z"),o},x_={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},b_=e=>{var t=en(e,x_),{x:r,y:a,upperWidth:i,lowerWidth:s,height:o,className:l}=t,{animationEasing:d,animationDuration:f,animationBegin:u,isUpdateAnimationActive:h}=t,m=c.useRef(null),[p,x]=c.useState(-1),v=c.useRef(i),g=c.useRef(s),b=c.useRef(o),y=c.useRef(r),A=c.useRef(a),C=Vi(e,"trapezoid-");if(c.useEffect(()=>{if(m.current&&m.current.getTotalLength)try{var I=m.current.getTotalLength();I&&x(I)}catch{}},[]),r!==+r||a!==+a||i!==+i||s!==+s||o!==+o||i===0&&s===0||o===0)return null;var N=et("recharts-trapezoid",l);if(!h)return c.createElement("g",null,c.createElement("path",No({},yn(t),{className:N,d:Sp(r,a,i,s,o)})));var w=v.current,M=g.current,O=b.current,D=y.current,W=A.current,j="0px ".concat(p===-1?1:p,"px"),S="".concat(p,"px 0px"),R=tv(["strokeDasharray"],f,d);return c.createElement(Gi,{animationId:C,key:C,canBegin:p>0,duration:f,easing:d,isActive:h,begin:u},I=>{var $=xt(w,i,I),J=xt(M,s,I),q=xt(O,o,I),K=xt(D,r,I),L=xt(W,a,I);m.current&&(v.current=$,g.current=J,b.current=q,y.current=K,A.current=L);var ee=I>0?{transition:R,strokeDasharray:S}:{strokeDasharray:j};return c.createElement("path",No({},yn(t),{className:N,d:Sp(K,L,$,J,q),ref:m,style:wp(wp({},ee),t.style)}))})},j_=["option","shapeType","propTransformer","activeClassName","isActive"];function w_(e,t){if(e==null)return{};var r,a,i=S_(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function S_(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function Np(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function ko(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Np(Object(r),!0).forEach(function(a){N_(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Np(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function N_(e,t,r){return(t=k_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k_(e){var t=A_(e,"string");return typeof t=="symbol"?t:t+""}function A_(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function C_(e,t){return ko(ko({},t),e)}function P_(e,t){return e==="symbols"}function kp(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return c.createElement(iv,r);case"trapezoid":return c.createElement(b_,r);case"sector":return c.createElement(cv,r);case"symbols":if(P_(t))return c.createElement(_g,r);break;case"curve":return c.createElement(Kd,r);default:return null}}function E_(e){return c.isValidElement(e)?e.props:e}function df(e){var{option:t,shapeType:r,propTransformer:a=C_,activeClassName:i="recharts-active-shape",isActive:s}=e,o=w_(e,j_),l;if(c.isValidElement(t))l=c.cloneElement(t,ko(ko({},o),E_(t)));else if(typeof t=="function")l=t(o);else if(p_(t)&&typeof t!="boolean"){var d=a(t,o);l=c.createElement(kp,{shapeType:r,elementProps:d})}else{var f=o;l=c.createElement(kp,{shapeType:r,elementProps:f})}return s?c.createElement(Zt,{className:i},l):l}var uf=(e,t)=>{var r=St();return(a,i)=>s=>{e==null||e(a,i,s),r(G0({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition}))}},ff=e=>{var t=St();return(r,a)=>i=>{e==null||e(r,a,i),t(JE())}},hf=(e,t)=>{var r=St();return(a,i)=>s=>{e==null||e(a,i,s),r(ZE({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition}))}};function mf(e){var{fn:t,args:r}=e,a=St(),i=fn();return c.useLayoutEffect(()=>{if(!i){var s=t(r);return a(VE(s)),()=>{a(XE(s))}}},[t,r,a,i]),null}function Kx(e){var{legendPayload:t}=e,r=St(),a=fn();return c.useLayoutEffect(()=>a?Aa:(r(Jy(t)),()=>{r(Zy(t))}),[r,a,t]),null}function I_(e){var{legendPayload:t}=e,r=St(),a=Me(Je);return c.useLayoutEffect(()=>a!=="centric"&&a!=="radial"?Aa:(r(Jy(t)),()=>{r(Zy(t))}),[r,a,t]),null}var yc,T_=()=>{var[e]=c.useState(()=>Ii("uid-"));return e},O_=(yc=Gb.useId)!==null&&yc!==void 0?yc:T_;function Yx(e,t){var r=O_();return t||(e?"".concat(e,"-").concat(r):r)}var __=c.createContext(void 0),pf=e=>{var{id:t,type:r,children:a}=e,i=Yx("recharts-".concat(r),t);return c.createElement(__.Provider,{value:i},a(i))},M_={cartesianItems:[],polarItems:[]},Gx=Sn({name:"graphicalItems",initialState:M_,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Ht()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:a}=t.payload,i=jr(e).cartesianItems.indexOf(r);i>-1&&(e.cartesianItems[i]=a)},prepare:Ht()},removeCartesianGraphicalItem:{reducer(e,t){var r=jr(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:Ht()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Ht()},removePolarGraphicalItem:{reducer(e,t){var r=jr(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:Ht()}}}),{addCartesianGraphicalItem:D_,replaceCartesianGraphicalItem:$_,removeCartesianGraphicalItem:L_,addPolarGraphicalItem:R_,removePolarGraphicalItem:z_}=Gx.actions,W_=Gx.reducer;function Vx(e){var t=St(),r=c.useRef(null);return c.useLayoutEffect(()=>{r.current===null?t(D_(e)):r.current!==e&&t($_({prev:r.current,next:e})),r.current=e},[t,e]),c.useLayoutEffect(()=>()=>{r.current&&(t(L_(r.current)),r.current=null)},[t]),null}function B_(e){var t=St();return c.useLayoutEffect(()=>(t(R_(e)),()=>{t(z_(e))}),[t,e]),null}var F_=["onMouseEnter","onClick","onMouseLeave"],q_=["id"],U_=["id"];function gf(e,t){if(e==null)return{};var r,a,i=H_(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function H_(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function Ap(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function bt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ap(Object(r),!0).forEach(function(a){K_(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ap(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function K_(e,t,r){return(t=Y_(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Y_(e){var t=G_(e,"string");return typeof t=="symbol"?t:t+""}function G_(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Yr(){return Yr=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Yr.apply(null,arguments)}function V_(e){var t=c.useMemo(()=>cf(e.children,Ea),[e.children]),r=Me(a=>c_(a,e.id,t));return r==null?null:c.createElement(I_,{legendPayload:r})}function X_(e){var{dataKey:t,nameKey:r,sectors:a,stroke:i,strokeWidth:s,fill:o,name:l,hide:d,tooltipType:f}=e;return{dataDefinedOnItem:a.map(u=>u.tooltipPayload),positions:a.map(u=>u.tooltipPosition),settings:{stroke:i,strokeWidth:s,fill:o,dataKey:t,nameKey:r,name:Ja(l,t),hide:d,type:f,color:o,unit:""}}}var Q_=(e,t)=>e>t?"start":e<t?"end":"middle",J_=(e,t,r)=>un(typeof t=="function"?t(e):t,r,r*.8),Z_=(e,t,r)=>{var{top:a,left:i,width:s,height:o}=t,l=sv(s,o),d=i+un(e.cx,s,s/2),f=a+un(e.cy,o,o/2),u=un(e.innerRadius,l,0),h=J_(r,e.outerRadius,l),m=e.maxRadius||Math.sqrt(s*s+o*o)/2;return{cx:d,cy:f,innerRadius:u,outerRadius:h,maxRadius:m}},eM=(e,t)=>{var r=Jt(t-e),a=Math.min(Math.abs(t-e),360);return r*a};function tM(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}var nM=(e,t)=>{if(c.isValidElement(e))return c.cloneElement(e,t);if(typeof e=="function")return e(t);var r=et("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return c.createElement(Kd,Yr({},t,{type:"linear",className:r}))},rM=(e,t,r)=>{if(c.isValidElement(e))return c.cloneElement(e,t);var a=r;if(typeof e=="function"&&(a=e(t),c.isValidElement(a)))return a;var i=et("recharts-pie-label-text",tM(e));return c.createElement(kl,Yr({},t,{alignmentBaseline:"middle",className:i}),a)};function aM(e){var{sectors:t,props:r,showLabels:a}=e,{label:i,labelLine:s,dataKey:o}=r;if(!a||!i||!t)return null;var l=Tn(r),d=va(i),f=va(s),u=typeof i=="object"&&"offsetRadius"in i&&typeof i.offsetRadius=="number"&&i.offsetRadius||20,h=t.map((m,p)=>{var x=(m.startAngle+m.endAngle)/2,v=Wt(m.cx,m.cy,m.outerRadius+u,x),g=bt(bt(bt(bt({},l),m),{},{stroke:"none"},d),{},{index:p,textAnchor:Q_(v.x,m.cx)},v),b=bt(bt(bt(bt({},l),m),{},{fill:"none",stroke:m.fill},f),{},{index:p,points:[Wt(m.cx,m.cy,m.outerRadius,x),v],key:"line"});return c.createElement(Nn,{zIndex:Bt.label,key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(p)},c.createElement(Zt,null,s&&nM(s,b),rM(i,g,pt(m,o))))});return c.createElement(Zt,{className:"recharts-pie-labels"},h)}function iM(e){var{sectors:t,props:r,showLabels:a}=e,{label:i}=r;return typeof i=="object"&&i!=null&&"position"in i?c.createElement(rf,{label:i}):c.createElement(aM,{sectors:t,props:r,showLabels:a})}function sM(e){var{sectors:t,activeShape:r,inactiveShape:a,allOtherPieProps:i}=e,s=Me(Kr),{onMouseEnter:o,onClick:l,onMouseLeave:d}=i,f=gf(i,F_),u=uf(o,i.dataKey),h=ff(d),m=hf(l,i.dataKey);return t==null||t.length===0?null:c.createElement(c.Fragment,null,t.map((p,x)=>{if((p==null?void 0:p.startAngle)===0&&(p==null?void 0:p.endAngle)===0&&t.length!==1)return null;var v=r&&String(x)===s,g=s?a:null,b=v?r:g,y=bt(bt({},p),{},{stroke:p.stroke,tabIndex:-1,[zy]:x,[Wy]:i.dataKey});return c.createElement(Zt,Yr({key:"sector-".concat(p==null?void 0:p.startAngle,"-").concat(p==null?void 0:p.endAngle,"-").concat(p.midAngle,"-").concat(x),tabIndex:-1,className:"recharts-pie-sector"},Ho(f,p,x),{onMouseEnter:u(p,x),onMouseLeave:h(p,x),onClick:m(p,x)}),c.createElement(df,Yr({option:b,isActive:v,shapeType:"sector"},y)))}))}function oM(e){var t,{pieSettings:r,displayedData:a,cells:i,offset:s}=e,{cornerRadius:o,startAngle:l,endAngle:d,dataKey:f,nameKey:u,tooltipType:h}=r,m=Math.abs(r.minAngle),p=eM(l,d),x=Math.abs(p),v=a.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,g=a.filter(w=>pt(w,f,0)!==0).length,b=(x>=360?g:g-1)*v,y=x-g*m-b,A=a.reduce((w,M)=>{var O=pt(M,f,0);return w+(_e(O)?O:0)},0),C;if(A>0){var N;C=a.map((w,M)=>{var O=pt(w,f,0),D=pt(w,u,M),W=Z_(r,s,w),j=(_e(O)?O:0)/A,S,R=bt(bt({},w),i&&i[M]&&i[M].props);M?S=N.endAngle+Jt(p)*v*(O!==0?1:0):S=l;var I=S+Jt(p)*((O!==0?m:0)+j*y),$=(S+I)/2,J=(W.innerRadius+W.outerRadius)/2,q=[{name:D,value:O,payload:R,dataKey:f,type:h}],K=Wt(W.cx,W.cy,J,$);return N=bt(bt(bt(bt({},r.presentationProps),{},{percent:j,cornerRadius:typeof o=="string"?parseFloat(o):o,name:D,tooltipPayload:q,midAngle:$,middleRadius:J,tooltipPosition:K},R),W),{},{value:O,startAngle:S,endAngle:I,payload:R,paddingAngle:Jt(p)*v}),N})}return C}function lM(e){var{showLabels:t,sectors:r,children:a}=e,i=c.useMemo(()=>!t||!r?[]:r.map(s=>({value:s.value,payload:s.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:s.cx,cy:s.cy,innerRadius:s.innerRadius,outerRadius:s.outerRadius,startAngle:s.startAngle,endAngle:s.endAngle,clockWise:!1},fill:s.fill})),[r,t]);return c.createElement(YO,{value:t?i:void 0},a)}function cM(e){var{props:t,previousSectorsRef:r}=e,{sectors:a,isAnimationActive:i,animationBegin:s,animationDuration:o,animationEasing:l,activeShape:d,inactiveShape:f,onAnimationStart:u,onAnimationEnd:h}=t,m=Vi(t,"recharts-pie-"),p=r.current,[x,v]=c.useState(!1),g=c.useCallback(()=>{typeof h=="function"&&h(),v(!1)},[h]),b=c.useCallback(()=>{typeof u=="function"&&u(),v(!0)},[u]);return c.createElement(lM,{showLabels:!x,sectors:a},c.createElement(Gi,{animationId:m,begin:s,duration:o,isActive:i,easing:l,onAnimationStart:b,onAnimationEnd:g,key:m},y=>{var A=[],C=a&&a[0],N=C==null?void 0:C.startAngle;return a==null||a.forEach((w,M)=>{var O=p&&p[M],D=M>0?xa(w,"paddingAngle",0):0;if(O){var W=xt(O.endAngle-O.startAngle,w.endAngle-w.startAngle,y),j=bt(bt({},w),{},{startAngle:N+D,endAngle:N+W+D});A.push(j),N=j.endAngle}else{var{endAngle:S,startAngle:R}=w,I=xt(0,S-R,y),$=bt(bt({},w),{},{startAngle:N+D,endAngle:N+I+D});A.push($),N=$.endAngle}}),r.current=A,c.createElement(Zt,null,c.createElement(sM,{sectors:A,activeShape:d,inactiveShape:f,allOtherPieProps:t}))}),c.createElement(iM,{showLabels:!x,sectors:a,props:t}),t.children)}var dM={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Xr.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:Bt.area};function uM(e){var{id:t}=e,r=gf(e,q_),{hide:a,className:i,rootTabIndex:s}=e,o=c.useMemo(()=>cf(e.children,Ea),[e.children]),l=Me(u=>d_(u,t,o)),d=c.useRef(null),f=et("recharts-pie",i);return a||l==null?(d.current=null,c.createElement(Zt,{tabIndex:s,className:f})):c.createElement(Nn,{zIndex:e.zIndex},c.createElement(mf,{fn:X_,args:bt(bt({},e),{},{sectors:l})}),c.createElement(Zt,{tabIndex:s,className:f},c.createElement(cM,{props:bt(bt({},r),{},{sectors:l}),previousSectorsRef:d})))}function Xx(e){var t=en(e,dM),{id:r}=t,a=gf(t,U_),i=Tn(a);return c.createElement(pf,{id:r,type:"pie"},s=>c.createElement(c.Fragment,null,c.createElement(B_,{type:"pie",id:s,data:a.data,dataKey:a.dataKey,hide:a.hide,angleAxisId:0,radiusAxisId:0,name:a.name,nameKey:a.nameKey,tooltipType:a.tooltipType,legendType:a.legendType,fill:a.fill,cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,paddingAngle:a.paddingAngle,minAngle:a.minAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius,cornerRadius:a.cornerRadius,presentationProps:i,maxRadius:t.maxRadius}),c.createElement(V_,Yr({},a,{id:s})),c.createElement(uM,Yr({},a,{id:s}))))}Xx.displayName="Pie";var fM=["points"];function Cp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function vc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cp(Object(r),!0).forEach(function(a){hM(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function hM(e,t,r){return(t=mM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mM(e){var t=pM(e,"string");return typeof t=="symbol"?t:t+""}function pM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ao(){return Ao=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Ao.apply(null,arguments)}function gM(e,t){if(e==null)return{};var r,a,i=yM(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function yM(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function vM(e){var{option:t,dotProps:r,className:a}=e;if(c.isValidElement(t))return c.cloneElement(t,r);if(typeof t=="function")return t(r);var i=et(a,typeof t!="boolean"?t.className:""),s=r??{},{points:o}=s,l=gM(s,fM);return c.createElement(Lx,Ao({},l,{className:i}))}function xM(e,t){return e==null?!1:t?!0:e.length===1}function bM(e){var{points:t,dot:r,className:a,dotClassName:i,dataKey:s,baseProps:o,needClip:l,clipPathId:d,zIndex:f=Bt.scatter}=e;if(!xM(t,r))return null;var u=Ux(r),h=cw(r),m=t.map((x,v)=>{var g,b,y=vc(vc(vc({r:3},o),h),{},{index:v,cx:(g=x.x)!==null&&g!==void 0?g:void 0,cy:(b=x.y)!==null&&b!==void 0?b:void 0,dataKey:s,value:x.value,payload:x.payload,points:t});return c.createElement(vM,{key:"dot-".concat(v),option:r,dotProps:y,className:i})}),p={};return l&&d!=null&&(p.clipPath="url(#clipPath-".concat(u?"":"dots-").concat(d,")")),c.createElement(Nn,{zIndex:f},c.createElement(Zt,Ao({className:a},p),m))}function Pp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Ep(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pp(Object(r),!0).forEach(function(a){jM(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function jM(e,t,r){return(t=wM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wM(e){var t=SM(e,"string");return typeof t=="symbol"?t:t+""}function SM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var NM={xAxis:{},yAxis:{},zAxis:{}},Qx=Sn({name:"cartesianAxis",initialState:NM,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Ht()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Ht()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Ht()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Ht()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Ht()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Ht()},updateYAxisWidth(e,t){var{id:r,width:a}=t.payload,i=e.yAxis[r];if(i){var s=i.widthHistory||[];if(s.length===3&&s[0]===s[2]&&a===s[1]&&a!==i.width&&Math.abs(a-s[0])<=1)return;var o=[...s,a].slice(-3);e.yAxis[r]=Ep(Ep({},e.yAxis[r]),{},{width:a,widthHistory:o})}}}}),{addXAxis:kM,removeXAxis:AM,addYAxis:CM,removeYAxis:PM,addZAxis:xL,removeZAxis:bL,updateYAxisWidth:EM}=Qx.actions,IM=Qx.reducer,TM=me([Kt],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),OM=me([TM,Ir,Tr],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),yf=()=>Me(OM),_M=()=>Me(zI);function Ip(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function xc(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ip(Object(r),!0).forEach(function(a){MM(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ip(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function MM(e,t,r){return(t=DM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DM(e){var t=$M(e,"string");return typeof t=="symbol"?t:t+""}function $M(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var LM=e=>{var{point:t,childIndex:r,mainColor:a,activeDot:i,dataKey:s}=e;if(i===!1||t.x==null||t.y==null)return null;var o={index:r,dataKey:s,cx:t.x,cy:t.y,r:4,fill:a??"none",strokeWidth:2,stroke:"#fff",payload:t.payload,value:t.value},l=xc(xc(xc({},o),va(i)),Ad(i)),d;return c.isValidElement(i)?d=c.cloneElement(i,l):typeof i=="function"?d=i(l):d=c.createElement(Lx,l),c.createElement(Zt,{className:"recharts-active-dot"},d)};function RM(e){var{points:t,mainColor:r,activeDot:a,itemDataKey:i,zIndex:s=Bt.activeDot}=e,o=Me(Kr),l=_M();if(t==null||l==null)return null;var d=t.find(f=>l.includes(f.payload));return wt(d)?null:c.createElement(Nn,{zIndex:s},c.createElement(LM,{point:d,childIndex:Number(o),mainColor:r,dataKey:i,activeDot:a}))}var zM="Invariant failed";function WM(e,t){throw new Error(zM)}var BM=["x","y"];function dd(){return dd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},dd.apply(null,arguments)}function Tp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Si(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Tp(Object(r),!0).forEach(function(a){FM(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Tp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function FM(e,t,r){return(t=qM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qM(e){var t=UM(e,"string");return typeof t=="symbol"?t:t+""}function UM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function HM(e,t){if(e==null)return{};var r,a,i=KM(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function KM(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function YM(e,t){var{x:r,y:a}=e,i=HM(e,BM),s="".concat(r),o=parseInt(s,10),l="".concat(a),d=parseInt(l,10),f="".concat(t.height||i.height),u=parseInt(f,10),h="".concat(t.width||i.width),m=parseInt(h,10);return Si(Si(Si(Si(Si({},t),i),o?{x:o}:{}),d?{y:d}:{}),{},{height:u,width:m,name:t.name,radius:t.radius})}function Co(e){return c.createElement(df,dd({shapeType:"rectangle",propTransformer:YM,activeClassName:"recharts-active-bar"},e))}var GM=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(a,i)=>{if(_e(t))return t;var s=_e(a)||wt(a);return s?t(a,i):(s||WM(),r)}},VM={},Jx=Sn({name:"errorBars",initialState:VM,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:a}=t.payload;e[r]||(e[r]=[]),e[r].push(a)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:a,next:i}=t.payload;e[r]&&(e[r]=e[r].map(s=>s.dataKey===a.dataKey&&s.direction===a.direction?i:s))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:a}=t.payload;e[r]&&(e[r]=e[r].filter(i=>i.dataKey!==a.dataKey||i.direction!==a.direction))}}}),{addErrorBar:jL,replaceErrorBar:wL,removeErrorBar:SL}=Jx.actions,XM=Jx.reducer,QM=["children"];function JM(e,t){if(e==null)return{};var r,a,i=ZM(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function ZM(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var eD={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},tD=c.createContext(eD);function Zx(e){var{children:t}=e,r=JM(e,QM);return c.createElement(tD.Provider,{value:r},t)}function vf(e,t){var r,a,i=Me(f=>_r(f,e)),s=Me(f=>Mr(f,t)),o=(r=i==null?void 0:i.allowDataOverflow)!==null&&r!==void 0?r:An.allowDataOverflow,l=(a=s==null?void 0:s.allowDataOverflow)!==null&&a!==void 0?a:Cn.allowDataOverflow,d=o||l;return{needClip:d,needClipX:o,needClipY:l}}function eb(e){var{xAxisId:t,yAxisId:r,clipPathId:a}=e,i=yf(),{needClipX:s,needClipY:o,needClip:l}=vf(t,r);if(!l||!i)return null;var{x:d,y:f,width:u,height:h}=i;return c.createElement("clipPath",{id:"clipPath-".concat(a)},c.createElement("rect",{x:s?d:d-u/2,y:o?f:f-h/2,width:s?u:u*2,height:o?h:h*2}))}function nD(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&$t(e.zIndex)?e.zIndex:t}var rD=["onMouseEnter","onMouseLeave","onClick"],aD=["value","background","tooltipPosition"],iD=["id"],sD=["onMouseEnter","onClick","onMouseLeave"];function Er(){return Er=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Er.apply(null,arguments)}function Op(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function pn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Op(Object(r),!0).forEach(function(a){oD(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Op(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function oD(e,t,r){return(t=lD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lD(e){var t=cD(e,"string");return typeof t=="symbol"?t:t+""}function cD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Po(e,t){if(e==null)return{};var r,a,i=dD(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function dD(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var uD=e=>{var{dataKey:t,name:r,fill:a,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:a,value:Ja(r,t),payload:e}]};function fD(e){var{dataKey:t,stroke:r,strokeWidth:a,fill:i,name:s,hide:o,unit:l}=e;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:r,strokeWidth:a,fill:i,dataKey:t,nameKey:void 0,name:Ja(s,t),hide:o,type:e.tooltipType,color:e.fill,unit:l}}}function hD(e){var t=Me(Kr),{data:r,dataKey:a,background:i,allOtherBarProps:s}=e,{onMouseEnter:o,onMouseLeave:l,onClick:d}=s,f=Po(s,rD),u=uf(o,a),h=ff(l),m=hf(d,a);if(!i||r==null)return null;var p=va(i);return c.createElement(Nn,{zIndex:nD(i,Bt.barBackground)},r.map((x,v)=>{var{value:g,background:b,tooltipPosition:y}=x,A=Po(x,aD);if(!b)return null;var C=u(x,v),N=h(x,v),w=m(x,v),M=pn(pn(pn(pn(pn({option:i,isActive:String(v)===t},A),{},{fill:"#eee"},b),p),Ho(f,x,v)),{},{onMouseEnter:C,onMouseLeave:N,onClick:w,dataKey:a,index:v,className:"recharts-bar-background-rectangle"});return c.createElement(Co,Er({key:"background-bar-".concat(v)},M))}))}function mD(e){var{showLabels:t,children:r,rects:a}=e,i=a==null?void 0:a.map(s=>{var o={x:s.x,y:s.y,width:s.width,lowerWidth:s.width,upperWidth:s.width,height:s.height};return pn(pn({},o),{},{value:s.value,payload:s.payload,parentViewBox:s.parentViewBox,viewBox:o,fill:s.fill})});return c.createElement(Dx,{value:t?i:void 0},r)}function pD(e){var{shape:t,activeBar:r,baseProps:a,entry:i,index:s,dataKey:o}=e,l=Me(Kr),d=Me(cx),f=r&&String(s)===l&&(d==null||o===d),u=f?r:t;return f?c.createElement(Nn,{zIndex:Bt.activeBar},c.createElement(Co,Er({},a,{name:String(a.name)},i,{isActive:f,option:u,index:s,dataKey:o}))):c.createElement(Co,Er({},a,{name:String(a.name)},i,{isActive:f,option:u,index:s,dataKey:o}))}function gD(e){var{shape:t,baseProps:r,entry:a,index:i,dataKey:s}=e;return c.createElement(Co,Er({},r,{name:String(r.name)},a,{isActive:!1,option:t,index:i,dataKey:s}))}function yD(e){var t,{data:r,props:a}=e,i=(t=Tn(a))!==null&&t!==void 0?t:{},{id:s}=i,o=Po(i,iD),{shape:l,dataKey:d,activeBar:f}=a,{onMouseEnter:u,onClick:h,onMouseLeave:m}=a,p=Po(a,sD),x=uf(u,d),v=ff(m),g=hf(h,d);return r?c.createElement(c.Fragment,null,r.map((b,y)=>c.createElement(Zt,Er({key:"rectangle-".concat(b==null?void 0:b.x,"-").concat(b==null?void 0:b.y,"-").concat(b==null?void 0:b.value,"-").concat(y),className:"recharts-bar-rectangle"},Ho(p,b,y),{onMouseEnter:x(b,y),onMouseLeave:v(b,y),onClick:g(b,y)}),f?c.createElement(pD,{shape:l,activeBar:f,baseProps:o,entry:b,index:y,dataKey:d}):c.createElement(gD,{shape:l,baseProps:o,entry:b,index:y,dataKey:d})))):null}function vD(e){var{props:t,previousRectanglesRef:r}=e,{data:a,layout:i,isAnimationActive:s,animationBegin:o,animationDuration:l,animationEasing:d,onAnimationEnd:f,onAnimationStart:u}=t,h=r.current,m=Vi(t,"recharts-bar-"),[p,x]=c.useState(!1),v=!p,g=c.useCallback(()=>{typeof f=="function"&&f(),x(!1)},[f]),b=c.useCallback(()=>{typeof u=="function"&&u(),x(!0)},[u]);return c.createElement(mD,{showLabels:v,rects:a},c.createElement(Gi,{animationId:m,begin:o,duration:l,isActive:s,easing:d,onAnimationEnd:g,onAnimationStart:b,key:m},y=>{var A=y===1?a:a==null?void 0:a.map((C,N)=>{var w=h&&h[N];if(w)return pn(pn({},C),{},{x:xt(w.x,C.x,y),y:xt(w.y,C.y,y),width:xt(w.width,C.width,y),height:xt(w.height,C.height,y)});if(i==="horizontal"){var M=xt(0,C.height,y),O=xt(C.stackedBarStart,C.y,y);return pn(pn({},C),{},{y:O,height:M})}var D=xt(0,C.width,y),W=xt(C.stackedBarStart,C.x,y);return pn(pn({},C),{},{width:D,x:W})});return y>0&&(r.current=A??null),A==null?null:c.createElement(Zt,null,c.createElement(yD,{props:t,data:A}))}),c.createElement(rf,{label:t.label}),t.children)}function xD(e){var t=c.useRef(null);return c.createElement(vD,{previousRectanglesRef:t,props:e})}var tb=0,bD=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:pt(e,t)}};class jD extends c.PureComponent{render(){var{hide:t,data:r,dataKey:a,className:i,xAxisId:s,yAxisId:o,needClip:l,background:d,id:f}=this.props;if(t||r==null)return null;var u=et("recharts-bar",i),h=f;return c.createElement(Zt,{className:u,id:f},l&&c.createElement("defs",null,c.createElement(eb,{clipPathId:h,xAxisId:s,yAxisId:o})),c.createElement(Zt,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(h,")"):void 0},c.createElement(hD,{data:r,dataKey:a,background:d,allOtherBarProps:this.props}),c.createElement(xD,this.props)))}}var wD={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Xr.isSsr,legendType:"rect",minPointSize:tb,xAxisId:0,yAxisId:0,zIndex:Bt.bar};function SD(e){var{xAxisId:t,yAxisId:r,hide:a,legendType:i,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:d,animationEasing:f,isAnimationActive:u}=e,{needClip:h}=vf(t,r),m=Yi(),p=fn(),x=cf(e.children,Ea),v=Me(y=>QD(y,t,r,p,e.id,x));if(m!=="vertical"&&m!=="horizontal")return null;var g,b=v==null?void 0:v[0];return b==null||b.height==null||b.width==null?g=0:g=m==="vertical"?b.height/2:b.width/2,c.createElement(Zx,{xAxisId:t,yAxisId:r,data:v,dataPointFormatter:bD,errorBarOffset:g},c.createElement(jD,Er({},e,{layout:m,needClip:h,data:v,xAxisId:t,yAxisId:r,hide:a,legendType:i,minPointSize:s,activeBar:o,animationBegin:l,animationDuration:d,animationEasing:f,isAnimationActive:u})))}function ND(e){var{layout:t,barSettings:{dataKey:r,minPointSize:a},pos:i,bandSize:s,xAxis:o,yAxis:l,xAxisTicks:d,yAxisTicks:f,stackedData:u,displayedData:h,offset:m,cells:p,parentViewBox:x,dataStartIndex:v}=e,g=t==="horizontal"?l:o,b=u?g.scale.domain():null,y=i2({numericAxis:g}),A=g.scale(y);return h.map((C,N)=>{var w,M,O,D,W,j;u?w=ZN(u[N+v],b):(w=pt(C,r),Array.isArray(w)||(w=[y,w]));var S=GM(a,tb)(w[1],N);if(t==="horizontal"){var R,[I,$]=[l.scale(w[0]),l.scale(w[1])];M=Nh({axis:o,ticks:d,bandSize:s,offset:i.offset,entry:C,index:N}),O=(R=$??I)!==null&&R!==void 0?R:void 0,D=i.size;var J=I-$;if(W=Qn(J)?0:J,j={x:M,y:m.top,width:D,height:m.height},Math.abs(S)>0&&Math.abs(W)<Math.abs(S)){var q=Jt(W||S)*(Math.abs(S)-Math.abs(W));O-=q,W+=q}}else{var[K,L]=[o.scale(w[0]),o.scale(w[1])];if(M=K,O=Nh({axis:l,ticks:f,bandSize:s,offset:i.offset,entry:C,index:N}),D=L-K,W=i.size,j={x:m.left,y:O,width:m.width,height:W},Math.abs(S)>0&&Math.abs(D)<Math.abs(S)){var ee=Jt(D||S)*(Math.abs(S)-Math.abs(D));D+=ee}}if(M==null||O==null||D==null||W==null)return null;var E=pn(pn({},C),{},{stackedBarStart:A,x:M,y:O,width:D,height:W,value:u?w:w[1],payload:C,background:j,tooltipPosition:{x:M+D/2,y:O+W/2},parentViewBox:x},p&&p[N]&&p[N].props);return E}).filter(Boolean)}function kD(e){var t=en(e,wD),r=fn();return c.createElement(pf,{id:t.id,type:"bar"},a=>c.createElement(c.Fragment,null,c.createElement(Kx,{legendPayload:uD(t)}),c.createElement(mf,{fn:fD,args:t}),c.createElement(Vx,{type:"bar",id:a,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:a2(t.stackId),hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:r}),c.createElement(Nn,{zIndex:t.zIndex},c.createElement(SD,Er({},t,{id:a})))))}var xf=c.memo(kD);xf.displayName="Bar";function _p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function Rs(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_p(Object(r),!0).forEach(function(a){AD(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_p(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function AD(e,t,r){return(t=CD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function CD(e){var t=PD(e,"string");return typeof t=="symbol"?t:t+""}function PD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ED=(e,t)=>t,ID=(e,t,r)=>r,TD=(e,t,r,a)=>a,OD=(e,t,r,a,i)=>i,os=me([xl,OD],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),_D=me([os],e=>e==null?void 0:e.maxBarSize),MD=(e,t,r,a,i,s)=>s,Mp=(e,t,r)=>{var a=r??e;if(!wt(a))return un(a,t,0)},DD=me([Je,xl,ED,ID,TD],(e,t,r,a,i)=>t.filter(s=>e==="horizontal"?s.xAxisId===r:s.yAxisId===a).filter(s=>s.isPanorama===i).filter(s=>s.hide===!1).filter(s=>s.type==="bar")),$D=(e,t,r,a)=>{var i=Je(e);return i==="horizontal"?td(e,"yAxis",r,a):td(e,"xAxis",t,a)},LD=(e,t,r)=>{var a=Je(e);return a==="horizontal"?Bm(e,"xAxis",t):Bm(e,"yAxis",r)},RD=(e,t,r)=>{var a={},i=e.filter(gl),s=e.filter(f=>f.stackId==null),o=i.reduce((f,u)=>(f[u.stackId]||(f[u.stackId]=[]),f[u.stackId].push(u),f),a),l=Object.entries(o).map(f=>{var[u,h]=f,m=h.map(x=>x.dataKey),p=Mp(t,r,h[0].barSize);return{stackId:u,dataKeys:m,barSize:p}}),d=s.map(f=>{var u=[f.dataKey].filter(m=>m!=null),h=Mp(t,r,f.barSize);return{stackId:void 0,dataKeys:u,barSize:h}});return[...l,...d]},zD=me([DD,FP,LD],RD),WD=(e,t,r,a,i)=>{var s,o,l=os(e,t,r,a,i);if(l!=null){var d=Je(e),f=c0(e),{maxBarSize:u}=l,h=wt(u)?f:u,m,p;return d==="horizontal"?(m=Hr(e,"xAxis",t,a),p=Ur(e,"xAxis",t,a)):(m=Hr(e,"yAxis",r,a),p=Ur(e,"yAxis",r,a)),(s=(o=Ya(m,p,!0))!==null&&o!==void 0?o:h)!==null&&s!==void 0?s:0}},nb=(e,t,r,a)=>{var i=Je(e),s,o;return i==="horizontal"?(s=Hr(e,"xAxis",t,a),o=Ur(e,"xAxis",t,a)):(s=Hr(e,"yAxis",r,a),o=Ur(e,"yAxis",r,a)),Ya(s,o)};function BD(e,t,r,a,i){var s=a.length;if(!(s<1)){var o=un(e,r,0,!0),l,d=[];if($t(a[0].barSize)){var f=!1,u=r/s,h=a.reduce((b,y)=>b+(y.barSize||0),0);h+=(s-1)*o,h>=r&&(h-=(s-1)*o,o=0),h>=r&&u>0&&(f=!0,u*=.9,h=s*u);var m=(r-h)/2>>0,p={offset:m-o,size:0};l=a.reduce((b,y)=>{var A,C={stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:p.offset+p.size+o,size:f?u:(A=y.barSize)!==null&&A!==void 0?A:0}},N=[...b,C];return p=N[N.length-1].position,N},d)}else{var x=un(t,r,0,!0);r-2*x-(s-1)*o<=0&&(o=0);var v=(r-2*x-(s-1)*o)/s;v>1&&(v>>=0);var g=$t(i)?Math.min(v,i):v;l=a.reduce((b,y,A)=>[...b,{stackId:y.stackId,dataKeys:y.dataKeys,position:{offset:x+(v+o)*A+(v-g)/2,size:g}}],d)}return l}}var FD=(e,t,r,a,i,s,o)=>{var l=wt(o)?t:o,d=BD(r,a,i!==s?i:s,e,l);return i!==s&&d!=null&&(d=d.map(f=>Rs(Rs({},f),{},{position:Rs(Rs({},f.position),{},{offset:f.position.offset-i/2})}))),d},qD=me([zD,c0,BP,d0,WD,nb,_D],FD),UD=(e,t,r,a)=>Hr(e,"xAxis",t,a),HD=(e,t,r,a)=>Hr(e,"yAxis",r,a),KD=(e,t,r,a)=>Ur(e,"xAxis",t,a),YD=(e,t,r,a)=>Ur(e,"yAxis",r,a),GD=me([qD,os],(e,t)=>{if(!(e==null||t==null)){var r=e.find(a=>a.stackId===t.stackId&&t.dataKey!=null&&a.dataKeys.includes(t.dataKey));if(r!=null)return r.position}}),VD=(e,t)=>{var r=ku(t);if(!(!e||r==null||t==null)){var{stackId:a}=t;if(a!=null){var i=e[a];if(i){var{stackedData:s}=i;if(s)return s.find(o=>o.key===r)}}}},XD=me([$D,os],VD),QD=me([Kt,Ud,UD,HD,KD,YD,GD,Je,fl,nb,XD,os,MD],(e,t,r,a,i,s,o,l,d,f,u,h,m)=>{var{chartData:p,dataStartIndex:x,dataEndIndex:v}=d;if(!(h==null||o==null||t==null||l!=="horizontal"&&l!=="vertical"||r==null||a==null||i==null||s==null||f==null)){var{data:g}=h,b;if(g!=null&&g.length>0?b=g:b=p==null?void 0:p.slice(x,v+1),b!=null)return ND({layout:l,barSettings:h,pos:o,parentViewBox:t,bandSize:f,xAxis:r,yAxis:a,xAxisTicks:i,yAxisTicks:s,stackedData:u,displayedData:b,offset:e,cells:m,dataStartIndex:x})}}),rb=e=>{var{chartData:t}=e,r=St(),a=fn();return c.useEffect(()=>a?()=>{}:(r(Zm(t)),()=>{r(Zm(void 0))}),[t,r,a]),null},Dp={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},ab=Sn({name:"brush",initialState:Dp,reducers:{setBrushSettings(e,t){return t.payload==null?Dp:t.payload}}}),{setBrushSettings:NL}=ab.actions,JD=ab.reducer;function ZD(e,t,r){return(t=e6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function e6(e){var t=t6(e,"string");return typeof t=="symbol"?t:t+""}function t6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class bf{static create(t){return new bf(t)}constructor(t){this.scale=t}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(t){var{bandAware:r,position:a}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t!==void 0){if(a)switch(a){case"start":return this.scale(t);case"middle":{var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+i}case"end":{var s=this.bandwidth?this.bandwidth():0;return this.scale(t)+s}default:return this.scale(t)}if(r){var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(t)+o}return this.scale(t)}}isInRange(t){var r=this.range(),a=r[0],i=r[r.length-1];return a<=i?t>=a&&t<=i:t>=i&&t<=a}}ZD(bf,"EPS",1e-4);function n6(e){return(e%180+180)%180}var r6=function(t){var{width:r,height:a}=t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=n6(i),o=s*Math.PI/180,l=Math.atan(a/r),d=o>l&&o<Math.PI-l?a/Math.sin(o):r/Math.cos(o);return Math.abs(d)},a6={dots:[],areas:[],lines:[]},ib=Sn({name:"referenceElements",initialState:a6,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=jr(e).dots.findIndex(a=>a===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=jr(e).areas.findIndex(a=>a===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=jr(e).lines.findIndex(a=>a===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:kL,removeDot:AL,addArea:CL,removeArea:PL,addLine:EL,removeLine:IL}=ib.actions,i6=ib.reducer,s6=c.createContext(void 0),o6=e=>{var{children:t}=e,[r]=c.useState("".concat(Ii("recharts"),"-clip")),a=yf();if(a==null)return null;var{x:i,y:s,width:o,height:l}=a;return c.createElement(s6.Provider,{value:r},c.createElement("defs",null,c.createElement("clipPath",{id:r},c.createElement("rect",{x:i,y:s,height:l,width:o}))),t)};function Qa(e,t){for(var r in e)if({}.hasOwnProperty.call(e,r)&&(!{}.hasOwnProperty.call(t,r)||e[r]!==t[r]))return!1;for(var a in t)if({}.hasOwnProperty.call(t,a)&&!{}.hasOwnProperty.call(e,a))return!1;return!0}function sb(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],a=0;a<e.length;a+=t)r.push(e[a]);return r}function l6(e,t,r){var a={width:e.width+t.width,height:e.height+t.height};return r6(a,r)}function c6(e,t,r){var a=r==="width",{x:i,y:s,width:o,height:l}=e;return t===1?{start:a?i:s,end:a?i+o:s+l}:{start:a?i+o:s+l,end:a?i:s}}function Eo(e,t,r,a,i){if(e*t<e*a||e*t>e*i)return!1;var s=r();return e*(t-e*s/2-a)>=0&&e*(t+e*s/2-i)<=0}function d6(e,t){return sb(e,t+1)}function u6(e,t,r,a,i){for(var s=(a||[]).slice(),{start:o,end:l}=t,d=0,f=1,u=o,h=function(){var x=a==null?void 0:a[d];if(x===void 0)return{v:sb(a,f)};var v=d,g,b=()=>(g===void 0&&(g=r(x,v)),g),y=x.coordinate,A=d===0||Eo(e,y,b,u,l);A||(d=0,u=o,f+=1),A&&(u=y+e*(b()/2+i),d+=f)},m;f<=s.length;)if(m=h(),m)return m.v;return[]}function $p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function cn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$p(Object(r),!0).forEach(function(a){f6(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$p(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function f6(e,t,r){return(t=h6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function h6(e){var t=m6(e,"string");return typeof t=="symbol"?t:t+""}function m6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function p6(e,t,r,a,i){for(var s=(a||[]).slice(),o=s.length,{start:l}=t,{end:d}=t,f=function(m){var p=s[m],x,v=()=>(x===void 0&&(x=r(p,m)),x);if(m===o-1){var g=e*(p.coordinate+e*v()/2-d);s[m]=p=cn(cn({},p),{},{tickCoord:g>0?p.coordinate-g*e:p.coordinate})}else s[m]=p=cn(cn({},p),{},{tickCoord:p.coordinate});if(p.tickCoord!=null){var b=Eo(e,p.tickCoord,v,l,d);b&&(d=p.tickCoord-e*(v()/2+i),s[m]=cn(cn({},p),{},{isShow:!0}))}},u=o-1;u>=0;u--)f(u);return s}function g6(e,t,r,a,i,s){var o=(a||[]).slice(),l=o.length,{start:d,end:f}=t;if(s){var u=a[l-1],h=r(u,l-1),m=e*(u.coordinate+e*h/2-f);if(o[l-1]=u=cn(cn({},u),{},{tickCoord:m>0?u.coordinate-m*e:u.coordinate}),u.tickCoord!=null){var p=Eo(e,u.tickCoord,()=>h,d,f);p&&(f=u.tickCoord-e*(h/2+i),o[l-1]=cn(cn({},u),{},{isShow:!0}))}}for(var x=s?l-1:l,v=function(y){var A=o[y],C,N=()=>(C===void 0&&(C=r(A,y)),C);if(y===0){var w=e*(A.coordinate-e*N()/2-d);o[y]=A=cn(cn({},A),{},{tickCoord:w<0?A.coordinate-w*e:A.coordinate})}else o[y]=A=cn(cn({},A),{},{tickCoord:A.coordinate});if(A.tickCoord!=null){var M=Eo(e,A.tickCoord,N,d,f);M&&(d=A.tickCoord+e*(N()/2+i),o[y]=cn(cn({},A),{},{isShow:!0}))}},g=0;g<x;g++)v(g);return o}function jf(e,t,r){var{tick:a,ticks:i,viewBox:s,minTickGap:o,orientation:l,interval:d,tickFormatter:f,unit:u,angle:h}=e;if(!i||!i.length||!a)return[];if(_e(d)||Xr.isSsr){var m;return(m=d6(i,_e(d)?d:0))!==null&&m!==void 0?m:[]}var p=[],x=l==="top"||l==="bottom"?"width":"height",v=u&&x==="width"?Ei(u,{fontSize:t,letterSpacing:r}):{width:0,height:0},g=(A,C)=>{var N=typeof f=="function"?f(A.value,C):A.value;return x==="width"?l6(Ei(N,{fontSize:t,letterSpacing:r}),v,h):Ei(N,{fontSize:t,letterSpacing:r})[x]},b=i.length>=2?Jt(i[1].coordinate-i[0].coordinate):1,y=c6(s,b,x);return d==="equidistantPreserveStart"?u6(b,y,g,i,o):(d==="preserveStart"||d==="preserveStartEnd"?p=g6(b,y,g,i,o,d==="preserveStartEnd"):p=p6(b,y,g,i,o),p.filter(A=>A.isShow))}var y6=e=>{var{ticks:t,label:r,labelGapWithTick:a=5,tickSize:i=0,tickMargin:s=0}=e,o=0;if(t){Array.from(t).forEach(u=>{if(u){var h=u.getBoundingClientRect();h.width>o&&(o=h.width)}});var l=r?r.getBoundingClientRect().width:0,d=i+s,f=o+d+l+(r?a:0);return Math.round(f)}return 0},v6=["axisLine","width","height","className","hide","ticks","axisType"],x6=["viewBox"],b6=["viewBox"];function ud(e,t){if(e==null)return{};var r,a,i=j6(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function j6(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function Na(){return Na=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Na.apply(null,arguments)}function Lp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function zt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Lp(Object(r),!0).forEach(function(a){w6(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function w6(e,t,r){return(t=S6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S6(e){var t=N6(e,"string");return typeof t=="symbol"?t:t+""}function N6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var wf={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:Bt.axis};function k6(e){var{x:t,y:r,width:a,height:i,orientation:s,mirror:o,axisLine:l,otherSvgProps:d}=e;if(!l)return null;var f=zt(zt(zt({},d),Tn(l)),{},{fill:"none"});if(s==="top"||s==="bottom"){var u=+(s==="top"&&!o||s==="bottom"&&o);f=zt(zt({},f),{},{x1:t,y1:r+u*i,x2:t+a,y2:r+u*i})}else{var h=+(s==="left"&&!o||s==="right"&&o);f=zt(zt({},f),{},{x1:t+h*a,y1:r,x2:t+h*a,y2:r+i})}return c.createElement("line",Na({},f,{className:et("recharts-cartesian-axis-line",xa(l,"className"))}))}function A6(e,t,r,a,i,s,o,l,d){var f,u,h,m,p,x,v=l?-1:1,g=e.tickSize||o,b=_e(e.tickCoord)?e.tickCoord:e.coordinate;switch(s){case"top":f=u=e.coordinate,m=r+ +!l*i,h=m-v*g,x=h-v*d,p=b;break;case"left":h=m=e.coordinate,u=t+ +!l*a,f=u-v*g,p=f-v*d,x=b;break;case"right":h=m=e.coordinate,u=t+ +l*a,f=u+v*g,p=f+v*d,x=b;break;default:f=u=e.coordinate,m=r+ +l*i,h=m+v*g,x=h+v*d,p=b;break}return{line:{x1:f,y1:h,x2:u,y2:m},tick:{x:p,y:x}}}function C6(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function P6(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function E6(e){var{option:t,tickProps:r,value:a}=e,i,s=et(r.className,"recharts-cartesian-axis-tick-value");if(c.isValidElement(t))i=c.cloneElement(t,zt(zt({},r),{},{className:s}));else if(typeof t=="function")i=t(zt(zt({},r),{},{className:s}));else{var o="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(o=et(o,t==null?void 0:t.className)),i=c.createElement(kl,Na({},r,{className:o}),a)}return i}var I6=c.forwardRef((e,t)=>{var{ticks:r=[],tick:a,tickLine:i,stroke:s,tickFormatter:o,unit:l,padding:d,tickTextProps:f,orientation:u,mirror:h,x:m,y:p,width:x,height:v,tickSize:g,tickMargin:b,fontSize:y,letterSpacing:A,getTicksConfig:C,events:N,axisType:w}=e,M=jf(zt(zt({},C),{},{ticks:r}),y,A),O=C6(u,h),D=P6(u,h),W=Tn(C),j=va(a),S={};typeof i=="object"&&(S=i);var R=zt(zt({},W),{},{fill:"none"},S),I=M.map(q=>zt({entry:q},A6(q,m,p,x,v,u,g,h,b))),$=I.map(q=>{var{entry:K,line:L}=q;return c.createElement(Zt,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(K.value,"-").concat(K.coordinate,"-").concat(K.tickCoord)},i&&c.createElement("line",Na({},R,L,{className:et("recharts-cartesian-axis-tick-line",xa(i,"className"))})))}),J=I.map((q,K)=>{var{entry:L,tick:ee}=q,E=zt(zt(zt(zt({textAnchor:O,verticalAnchor:D},W),{},{stroke:"none",fill:s},j),ee),{},{index:K,payload:L,visibleTicksCount:M.length,tickFormatter:o,padding:d},f);return c.createElement(Zt,Na({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(L.value,"-").concat(L.coordinate,"-").concat(L.tickCoord)},Ho(N,L,K)),a&&c.createElement(E6,{option:a,tickProps:E,value:"".concat(typeof o=="function"?o(L.value,K):L.value).concat(l||"")}))});return c.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(w,"-ticks")},J.length>0&&c.createElement(Nn,{zIndex:Bt.label},c.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(w,"-tick-labels"),ref:t},J)),$.length>0&&c.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(w,"-tick-lines")},$))}),T6=c.forwardRef((e,t)=>{var{axisLine:r,width:a,height:i,className:s,hide:o,ticks:l,axisType:d}=e,f=ud(e,v6),[u,h]=c.useState(""),[m,p]=c.useState(""),x=c.useRef(null);c.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var g;return y6({ticks:x.current,label:(g=e.labelRef)===null||g===void 0?void 0:g.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var v=c.useCallback(g=>{if(g){var b=g.getElementsByClassName("recharts-cartesian-axis-tick-value");x.current=b;var y=b[0];if(y){var A=window.getComputedStyle(y),C=A.fontSize,N=A.letterSpacing;(C!==u||N!==m)&&(h(C),p(N))}}},[u,m]);return o||a!=null&&a<=0||i!=null&&i<=0?null:c.createElement(Nn,{zIndex:e.zIndex},c.createElement(Zt,{className:et("recharts-cartesian-axis",s)},c.createElement(k6,{x:e.x,y:e.y,width:a,height:i,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:Tn(e)}),c.createElement(I6,{ref:v,axisType:d,events:f,fontSize:u,getTicksConfig:e,height:e.height,letterSpacing:m,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:l,unit:e.unit,width:e.width,x:e.x,y:e.y}),c.createElement(IO,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},c.createElement(WO,{label:e.label,labelRef:e.labelRef}),e.children)))}),O6=c.memo(T6,(e,t)=>{var{viewBox:r}=e,a=ud(e,x6),{viewBox:i}=t,s=ud(t,b6);return Qa(r,i)&&Qa(a,s)}),Sf=c.forwardRef((e,t)=>{var r=en(e,wf);return c.createElement(O6,Na({},r,{ref:t}))});Sf.displayName="CartesianAxis";var _6=["x1","y1","x2","y2","key"],M6=["offset"],D6=["xAxisId","yAxisId"],$6=["xAxisId","yAxisId"];function Rp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function dn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Rp(Object(r),!0).forEach(function(a){L6(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function L6(e,t,r){return(t=R6(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R6(e){var t=z6(e,"string");return typeof t=="symbol"?t:t+""}function z6(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fa(){return fa=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},fa.apply(null,arguments)}function Io(e,t){if(e==null)return{};var r,a,i=W6(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function W6(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var B6=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:a,y:i,width:s,height:o,ry:l}=e;return c.createElement("rect",{x:a,y:i,ry:l,width:s,height:o,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function ob(e){var{option:t,lineItemProps:r}=e,a;if(c.isValidElement(t))a=c.cloneElement(t,r);else if(typeof t=="function")a=t(r);else{var i,{x1:s,y1:o,x2:l,y2:d,key:f}=r,u=Io(r,_6),h=(i=Tn(u))!==null&&i!==void 0?i:{},{offset:m}=h,p=Io(h,M6);a=c.createElement("line",fa({},p,{x1:s,y1:o,x2:l,y2:d,fill:"none",key:f}))}return a}function F6(e){var{x:t,width:r,horizontal:a=!0,horizontalPoints:i}=e;if(!a||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,l=Io(e,D6),d=i.map((f,u)=>{var h=dn(dn({},l),{},{x1:t,y1:f,x2:t+r,y2:f,key:"line-".concat(u),index:u});return c.createElement(ob,{key:"line-".concat(u),option:a,lineItemProps:h})});return c.createElement("g",{className:"recharts-cartesian-grid-horizontal"},d)}function q6(e){var{y:t,height:r,vertical:a=!0,verticalPoints:i}=e;if(!a||!i||!i.length)return null;var{xAxisId:s,yAxisId:o}=e,l=Io(e,$6),d=i.map((f,u)=>{var h=dn(dn({},l),{},{x1:f,y1:t,x2:f,y2:t+r,key:"line-".concat(u),index:u});return c.createElement(ob,{option:a,lineItemProps:h,key:"line-".concat(u)})});return c.createElement("g",{className:"recharts-cartesian-grid-vertical"},d)}function U6(e){var{horizontalFill:t,fillOpacity:r,x:a,y:i,width:s,height:o,horizontalPoints:l,horizontal:d=!0}=e;if(!d||!t||!t.length||l==null)return null;var f=l.map(h=>Math.round(h+i-i)).sort((h,m)=>h-m);i!==f[0]&&f.unshift(0);var u=f.map((h,m)=>{var p=!f[m+1],x=p?i+o-h:f[m+1]-h;if(x<=0)return null;var v=m%t.length;return c.createElement("rect",{key:"react-".concat(m),y:h,x:a,height:x,width:s,stroke:"none",fill:t[v],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return c.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},u)}function H6(e){var{vertical:t=!0,verticalFill:r,fillOpacity:a,x:i,y:s,width:o,height:l,verticalPoints:d}=e;if(!t||!r||!r.length)return null;var f=d.map(h=>Math.round(h+i-i)).sort((h,m)=>h-m);i!==f[0]&&f.unshift(0);var u=f.map((h,m)=>{var p=!f[m+1],x=p?i+o-h:f[m+1]-h;if(x<=0)return null;var v=m%r.length;return c.createElement("rect",{key:"react-".concat(m),x:h,y:s,width:x,height:l,stroke:"none",fill:r[v],fillOpacity:a,className:"recharts-cartesian-grid-bg"})});return c.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},u)}var K6=(e,t)=>{var{xAxis:r,width:a,height:i,offset:s}=e;return $y(jf(dn(dn(dn({},wf),r),{},{ticks:Ly(r),viewBox:{x:0,y:0,width:a,height:i}})),s.left,s.left+s.width,t)},Y6=(e,t)=>{var{yAxis:r,width:a,height:i,offset:s}=e;return $y(jf(dn(dn(dn({},wf),r),{},{ticks:Ly(r),viewBox:{x:0,y:0,width:a,height:i}})),s.top,s.top+s.height,t)},G6={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:Bt.grid};function To(e){var t=Vy(),r=Xy(),a=Gy(),i=dn(dn({},en(e,G6)),{},{x:_e(e.x)?e.x:a.left,y:_e(e.y)?e.y:a.top,width:_e(e.width)?e.width:a.width,height:_e(e.height)?e.height:a.height}),{xAxisId:s,yAxisId:o,x:l,y:d,width:f,height:u,syncWithTicks:h,horizontalValues:m,verticalValues:p}=i,x=fn(),v=Me(D=>Fm(D,"xAxis",s,x)),g=Me(D=>Fm(D,"yAxis",o,x));if(!cr(f)||!cr(u)||!_e(l)||!_e(d))return null;var b=i.verticalCoordinatesGenerator||K6,y=i.horizontalCoordinatesGenerator||Y6,{horizontalPoints:A,verticalPoints:C}=i;if((!A||!A.length)&&typeof y=="function"){var N=m&&m.length,w=y({yAxis:g?dn(dn({},g),{},{ticks:N?m:g.ticks}):void 0,width:t??f,height:r??u,offset:a},N?!0:h);no(Array.isArray(w),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof w,"]")),Array.isArray(w)&&(A=w)}if((!C||!C.length)&&typeof b=="function"){var M=p&&p.length,O=b({xAxis:v?dn(dn({},v),{},{ticks:M?p:v.ticks}):void 0,width:t??f,height:r??u,offset:a},M?!0:h);no(Array.isArray(O),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof O,"]")),Array.isArray(O)&&(C=O)}return c.createElement(Nn,{zIndex:i.zIndex},c.createElement("g",{className:"recharts-cartesian-grid"},c.createElement(B6,{fill:i.fill,fillOpacity:i.fillOpacity,x:i.x,y:i.y,width:i.width,height:i.height,ry:i.ry}),c.createElement(U6,fa({},i,{horizontalPoints:A})),c.createElement(H6,fa({},i,{verticalPoints:C})),c.createElement(F6,fa({},i,{offset:a,horizontalPoints:A,xAxis:v,yAxis:g})),c.createElement(q6,fa({},i,{offset:a,verticalPoints:C,xAxis:v,yAxis:g}))))}To.displayName="CartesianGrid";var lb=(e,t,r,a)=>Hr(e,"xAxis",t,a),cb=(e,t,r,a)=>Ur(e,"xAxis",t,a),db=(e,t,r,a)=>Hr(e,"yAxis",r,a),ub=(e,t,r,a)=>Ur(e,"yAxis",r,a),V6=me([Je,lb,db,cb,ub],(e,t,r,a,i)=>Vr(e,"xAxis")?Ya(t,a,!1):Ya(r,i,!1)),X6=(e,t,r,a,i)=>i;function Q6(e){return e.type==="line"}var J6=me([xl,X6],(e,t)=>e.filter(Q6).find(r=>r.id===t)),Z6=me([Je,lb,db,cb,ub,J6,V6,fl],(e,t,r,a,i,s,o,l)=>{var{chartData:d,dataStartIndex:f,dataEndIndex:u}=l;if(!(s==null||t==null||r==null||a==null||i==null||a.length===0||i.length===0||o==null)){var{dataKey:h,data:m}=s,p;if(m!=null&&m.length>0?p=m:p=d==null?void 0:d.slice(f,u+1),p!=null)return b$({layout:e,xAxis:t,yAxis:r,xAxisTicks:a,yAxisTicks:i,dataKey:h,bandSize:o,displayedData:p})}});function e$(e){var t=va(e),r=3,a=2;if(t!=null){var{r:i,strokeWidth:s}=t,o=Number(i),l=Number(s);return(Number.isNaN(o)||o<0)&&(o=r),(Number.isNaN(l)||l<0)&&(l=a),{r:o,strokeWidth:l}}return{r,strokeWidth:a}}var t$=["id"],n$=["type","layout","connectNulls","needClip","shape"],r$=["activeDot","animateNewValues","animationBegin","animationDuration","animationEasing","connectNulls","dot","hide","isAnimationActive","label","legendType","xAxisId","yAxisId","id"];function Bi(){return Bi=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},Bi.apply(null,arguments)}function zp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function ir(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zp(Object(r),!0).forEach(function(a){a$(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function a$(e,t,r){return(t=i$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i$(e){var t=s$(e,"string");return typeof t=="symbol"?t:t+""}function s$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nf(e,t){if(e==null)return{};var r,a,i=o$(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function o$(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var l$=e=>{var{dataKey:t,name:r,stroke:a,legendType:i,hide:s}=e;return[{inactive:s,dataKey:t,type:i,color:a,value:Ja(r,t),payload:e}]};function c$(e){var{dataKey:t,data:r,stroke:a,strokeWidth:i,fill:s,name:o,hide:l,unit:d}=e;return{dataDefinedOnItem:r,positions:void 0,settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:void 0,name:Ja(o,t),hide:l,type:e.tooltipType,color:e.stroke,unit:d}}}var fb=(e,t)=>"".concat(t,"px ").concat(e-t,"px");function d$(e,t){for(var r=e.length%2!==0?[...e,0]:e,a=[],i=0;i<t;++i)a=[...a,...r];return a}var u$=(e,t,r)=>{var a=r.reduce((h,m)=>h+m);if(!a)return fb(t,e);for(var i=Math.floor(e/a),s=e%a,o=t-e,l=[],d=0,f=0;d<r.length;f+=r[d],++d)if(f+r[d]>s){l=[...r.slice(0,d),s-f];break}var u=l.length%2===0?[0,o]:[o];return[...d$(r,i),...l,...u].map(h=>"".concat(h,"px")).join(", ")};function f$(e){var{clipPathId:t,points:r,props:a}=e,{dot:i,dataKey:s,needClip:o}=a,{id:l}=a,d=Nf(a,t$),f=Tn(d);return c.createElement(bM,{points:r,dot:i,className:"recharts-line-dots",dotClassName:"recharts-line-dot",dataKey:s,baseProps:f,needClip:o,clipPathId:t})}function h$(e){var{showLabels:t,children:r,points:a}=e,i=c.useMemo(()=>a==null?void 0:a.map(s=>{var o,l,d={x:(o=s.x)!==null&&o!==void 0?o:0,y:(l=s.y)!==null&&l!==void 0?l:0,width:0,lowerWidth:0,upperWidth:0,height:0};return ir(ir({},d),{},{value:s.value,payload:s.payload,viewBox:d,parentViewBox:void 0,fill:void 0})}),[a]);return c.createElement(Dx,{value:t?i:void 0},r)}function Wp(e){var{clipPathId:t,pathRef:r,points:a,strokeDasharray:i,props:s}=e,{type:o,layout:l,connectNulls:d,needClip:f,shape:u}=s,h=Nf(s,n$),m=ir(ir({},yn(h)),{},{fill:"none",className:"recharts-line-curve",clipPath:f?"url(#clipPath-".concat(t,")"):void 0,points:a,type:o,layout:l,connectNulls:d,strokeDasharray:i??s.strokeDasharray});return c.createElement(c.Fragment,null,(a==null?void 0:a.length)>1&&c.createElement(df,Bi({shapeType:"curve",option:u},m,{pathRef:r})),c.createElement(f$,{points:a,clipPathId:t,props:s}))}function m$(e){try{return e&&e.getTotalLength&&e.getTotalLength()||0}catch{return 0}}function p$(e){var{clipPathId:t,props:r,pathRef:a,previousPointsRef:i,longestAnimatedLengthRef:s}=e,{points:o,strokeDasharray:l,isAnimationActive:d,animationBegin:f,animationDuration:u,animationEasing:h,animateNewValues:m,width:p,height:x,onAnimationEnd:v,onAnimationStart:g}=r,b=i.current,y=Vi(r,"recharts-line-"),[A,C]=c.useState(!1),N=!A,w=c.useCallback(()=>{typeof v=="function"&&v(),C(!1)},[v]),M=c.useCallback(()=>{typeof g=="function"&&g(),C(!0)},[g]),O=m$(a.current),D=s.current;return c.createElement(h$,{points:o,showLabels:N},r.children,c.createElement(Gi,{animationId:y,begin:f,duration:u,isActive:d,easing:h,onAnimationEnd:w,onAnimationStart:M,key:y},W=>{var j=xt(D,O+D,W),S=Math.min(j,O),R;if(d)if(l){var I="".concat(l).split(/[,\s]+/gim).map(q=>parseFloat(q));R=u$(S,O,I)}else R=fb(O,S);else R=l==null?void 0:String(l);if(b){var $=b.length/o.length,J=W===1?o:o.map((q,K)=>{var L=Math.floor(K*$);if(b[L]){var ee=b[L];return ir(ir({},q),{},{x:xt(ee.x,q.x,W),y:xt(ee.y,q.y,W)})}return m?ir(ir({},q),{},{x:xt(p*2,q.x,W),y:xt(x/2,q.y,W)}):ir(ir({},q),{},{x:q.x,y:q.y})});return i.current=J,c.createElement(Wp,{props:r,points:J,clipPathId:t,pathRef:a,strokeDasharray:R})}return W>0&&O>0&&(i.current=o,s.current=S),c.createElement(Wp,{props:r,points:o,clipPathId:t,pathRef:a,strokeDasharray:R})}),c.createElement(rf,{label:r.label}))}function g$(e){var{clipPathId:t,props:r}=e,a=c.useRef(null),i=c.useRef(0),s=c.useRef(null);return c.createElement(p$,{props:r,clipPathId:t,previousPointsRef:a,longestAnimatedLengthRef:i,pathRef:s})}var y$=(e,t)=>{var r,a;return{x:(r=e.x)!==null&&r!==void 0?r:void 0,y:(a=e.y)!==null&&a!==void 0?a:void 0,value:e.value,errorVal:pt(e.payload,t)}};class v$ extends c.Component{render(){var{hide:t,dot:r,points:a,className:i,xAxisId:s,yAxisId:o,top:l,left:d,width:f,height:u,id:h,needClip:m,zIndex:p}=this.props;if(t)return null;var x=et("recharts-line",i),v=h,{r:g,strokeWidth:b}=e$(r),y=Ux(r),A=g*2+b;return c.createElement(Nn,{zIndex:p},c.createElement(Zt,{className:x},m&&c.createElement("defs",null,c.createElement(eb,{clipPathId:v,xAxisId:s,yAxisId:o}),!y&&c.createElement("clipPath",{id:"clipPath-dots-".concat(v)},c.createElement("rect",{x:d-A/2,y:l-A/2,width:f+A,height:u+A}))),c.createElement(Zx,{xAxisId:s,yAxisId:o,data:a,dataPointFormatter:y$,errorBarOffset:0},c.createElement(g$,{props:this.props,clipPathId:v}))),c.createElement(RM,{activeDot:this.props.activeDot,points:a,mainColor:this.props.stroke,itemDataKey:this.props.dataKey}))}}var hb={activeDot:!0,animateNewValues:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!0,fill:"#fff",hide:!1,isAnimationActive:!Xr.isSsr,label:!1,legendType:"line",stroke:"#3182bd",strokeWidth:1,xAxisId:0,yAxisId:0,zIndex:Bt.line};function x$(e){var t=en(e,hb),{activeDot:r,animateNewValues:a,animationBegin:i,animationDuration:s,animationEasing:o,connectNulls:l,dot:d,hide:f,isAnimationActive:u,label:h,legendType:m,xAxisId:p,yAxisId:x,id:v}=t,g=Nf(t,r$),{needClip:b}=vf(p,x),y=yf(),A=Yi(),C=fn(),N=Me(W=>Z6(W,p,x,C,v));if(A!=="horizontal"&&A!=="vertical"||N==null||y==null)return null;var{height:w,width:M,x:O,y:D}=y;return c.createElement(v$,Bi({},g,{id:v,connectNulls:l,dot:d,activeDot:r,animateNewValues:a,animationBegin:i,animationDuration:s,animationEasing:o,isAnimationActive:u,hide:f,label:h,legendType:m,xAxisId:p,yAxisId:x,points:N,layout:A,height:w,width:M,left:O,top:D,needClip:b}))}function b$(e){var{layout:t,xAxis:r,yAxis:a,xAxisTicks:i,yAxisTicks:s,dataKey:o,bandSize:l,displayedData:d}=e;return d.map((f,u)=>{var h=pt(f,o);if(t==="horizontal"){var m=Sh({axis:r,ticks:i,bandSize:l,entry:f,index:u}),p=wt(h)?null:a.scale(h);return{x:m,y:p,value:h,payload:f}}var x=wt(h)?null:r.scale(h),v=Sh({axis:a,ticks:s,bandSize:l,entry:f,index:u});return x==null||v==null?null:{x,y:v,value:h,payload:f}}).filter(Boolean)}function j$(e){var t=en(e,hb),r=fn();return c.createElement(pf,{id:t.id,type:"line"},a=>c.createElement(c.Fragment,null,c.createElement(Kx,{legendPayload:l$(t)}),c.createElement(mf,{fn:c$,args:t}),c.createElement(Vx,{type:"line",id:a,data:t.data,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,hide:t.hide,isPanorama:r}),c.createElement(x$,Bi({},t,{id:a}))))}var mb=c.memo(j$);mb.displayName="Line";var w$=["dangerouslySetInnerHTML","ticks"],S$=["id"],N$=["domain"],k$=["domain"];function fd(){return fd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},fd.apply(null,arguments)}function Oo(e,t){if(e==null)return{};var r,a,i=A$(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function A$(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function C$(e){var t=St();return c.useLayoutEffect(()=>(t(kM(e)),()=>{t(AM(e))}),[e,t]),null}var P$=e=>{var{xAxisId:t,className:r}=e,a=Me(Ud),i=fn(),s="xAxis",o=Me(g=>ii(g,s,t,i)),l=Me(g=>F0(g,s,t,i)),d=Me(g=>R0(g,t)),f=Me(g=>zE(g,t)),u=Me(g=>v0(g,t));if(d==null||f==null||u==null)return null;var{dangerouslySetInnerHTML:h,ticks:m}=e,p=Oo(e,w$),{id:x}=u,v=Oo(u,S$);return c.createElement(Sf,fd({},p,v,{scale:o,x:f.x,y:f.y,width:d.width,height:d.height,className:et("recharts-".concat(s," ").concat(s),r),viewBox:a,ticks:l,axisType:s}))},E$={allowDataOverflow:An.allowDataOverflow,allowDecimals:An.allowDecimals,allowDuplicatedCategory:An.allowDuplicatedCategory,height:An.height,hide:!1,mirror:An.mirror,orientation:An.orientation,padding:An.padding,reversed:An.reversed,scale:An.scale,tickCount:An.tickCount,type:An.type,xAxisId:0},I$=e=>{var t,r,a,i,s,o=en(e,E$);return c.createElement(c.Fragment,null,c.createElement(C$,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.xAxisId,scale:o.scale,type:o.type,padding:o.padding,allowDataOverflow:o.allowDataOverflow,domain:o.domain,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,height:o.height,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(a=o.angle)!==null&&a!==void 0?a:0,minTickGap:(i=o.minTickGap)!==null&&i!==void 0?i:5,tick:(s=o.tick)!==null&&s!==void 0?s:!0,tickFormatter:o.tickFormatter}),c.createElement(P$,o))},T$=(e,t)=>{var{domain:r}=e,a=Oo(e,N$),{domain:i}=t,s=Oo(t,k$);return Qa(a,s)?Array.isArray(r)&&r.length===2&&Array.isArray(i)&&i.length===2?r[0]===i[0]&&r[1]===i[1]:Qa({domain:r},{domain:i}):!1},_o=c.memo(I$,T$);_o.displayName="XAxis";var O$=["dangerouslySetInnerHTML","ticks"],_$=["id"],M$=["domain"],D$=["domain"];function hd(){return hd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},hd.apply(null,arguments)}function Mo(e,t){if(e==null)return{};var r,a,i=$$(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function $$(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function L$(e){var t=St();return c.useLayoutEffect(()=>(t(CM(e)),()=>{t(PM(e))}),[e,t]),null}var R$=e=>{var{yAxisId:t,className:r,width:a,label:i}=e,s=c.useRef(null),o=c.useRef(null),l=Me(Ud),d=fn(),f=St(),u="yAxis",h=Me(N=>ii(N,u,t,d)),m=Me(N=>z0(N,t)),p=Me(N=>BE(N,t)),x=Me(N=>F0(N,u,t,d)),v=Me(N=>x0(N,t));if(c.useLayoutEffect(()=>{if(!(a!=="auto"||!m||nf(i)||c.isValidElement(i)||v==null)){var N=s.current;if(N){var w=N.getCalculatedWidth();Math.round(m.width)!==Math.round(w)&&f(EM({id:t,width:w}))}}},[x,m,f,i,t,a,v]),m==null||p==null||v==null)return null;var{dangerouslySetInnerHTML:g,ticks:b}=e,y=Mo(e,O$),{id:A}=v,C=Mo(v,_$);return c.createElement(Sf,hd({},y,C,{ref:s,labelRef:o,scale:h,x:p.x,y:p.y,tickTextProps:a==="auto"?{width:void 0}:{width:a},width:m.width,height:m.height,className:et("recharts-".concat(u," ").concat(u),r),viewBox:l,ticks:x,axisType:u}))},z$={allowDataOverflow:Cn.allowDataOverflow,allowDecimals:Cn.allowDecimals,allowDuplicatedCategory:Cn.allowDuplicatedCategory,hide:!1,mirror:Cn.mirror,orientation:Cn.orientation,padding:Cn.padding,reversed:Cn.reversed,scale:Cn.scale,tickCount:Cn.tickCount,type:Cn.type,width:Cn.width,yAxisId:0},W$=e=>{var t,r,a,i,s,o=en(e,z$);return c.createElement(c.Fragment,null,c.createElement(L$,{interval:(t=o.interval)!==null&&t!==void 0?t:"preserveEnd",id:o.yAxisId,scale:o.scale,type:o.type,domain:o.domain,allowDataOverflow:o.allowDataOverflow,dataKey:o.dataKey,allowDuplicatedCategory:o.allowDuplicatedCategory,allowDecimals:o.allowDecimals,tickCount:o.tickCount,padding:o.padding,includeHidden:(r=o.includeHidden)!==null&&r!==void 0?r:!1,reversed:o.reversed,ticks:o.ticks,width:o.width,orientation:o.orientation,mirror:o.mirror,hide:o.hide,unit:o.unit,name:o.name,angle:(a=o.angle)!==null&&a!==void 0?a:0,minTickGap:(i=o.minTickGap)!==null&&i!==void 0?i:5,tick:(s=o.tick)!==null&&s!==void 0?s:!0,tickFormatter:o.tickFormatter}),c.createElement(R$,o))},B$=(e,t)=>{var{domain:r}=e,a=Mo(e,M$),{domain:i}=t,s=Mo(t,D$);return Qa(a,s)?Array.isArray(r)&&r.length===2&&Array.isArray(i)&&i.length===2?r[0]===i[0]&&r[1]===i[1]:Qa({domain:r},{domain:i}):!1},Do=c.memo(W$,B$);Do.displayName="YAxis";var F$={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ls=c;function q$(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var U$=typeof Object.is=="function"?Object.is:q$,H$=ls.useSyncExternalStore,K$=ls.useRef,Y$=ls.useEffect,G$=ls.useMemo,V$=ls.useDebugValue;F$.useSyncExternalStoreWithSelector=function(e,t,r,a,i){var s=K$(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=G$(function(){function d(p){if(!f){if(f=!0,u=p,p=a(p),i!==void 0&&o.hasValue){var x=o.value;if(i(x,p))return h=x}return h=p}if(x=h,U$(u,p))return x;var v=a(p);return i!==void 0&&i(x,v)?(u=p,x):(u=p,h=v)}var f=!1,u,h,m=r===void 0?null:r;return[function(){return d(t())},m===null?void 0:function(){return d(m())}]},[t,r,a,i]);var l=H$(e,s[0],s[1]);return Y$(function(){o.hasValue=!0,o.value=l},[l]),V$(l),l};function X$(e){e()}function Q$(){let e=null,t=null;return{clear(){e=null,t=null},notify(){X$(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let a=e;for(;a;)r.push(a),a=a.next;return r},subscribe(r){let a=!0;const i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!a||e===null||(a=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var Bp={notify(){},get:()=>[]};function J$(e,t){let r,a=Bp,i=0,s=!1;function o(v){u();const g=a.subscribe(v);let b=!1;return()=>{b||(b=!0,g(),h())}}function l(){a.notify()}function d(){x.onStateChange&&x.onStateChange()}function f(){return s}function u(){i++,r||(r=e.subscribe(d),a=Q$())}function h(){i--,r&&i===0&&(r(),r=void 0,a.clear(),a=Bp)}function m(){s||(s=!0,u())}function p(){s&&(s=!1,h())}const x={addNestedSub:o,notifyNestedSubs:l,handleChangeWrapper:d,isSubscribed:f,trySubscribe:m,tryUnsubscribe:p,getListeners:()=>a};return x}var Z$=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",e8=Z$(),t8=()=>typeof navigator<"u"&&navigator.product==="ReactNative",n8=t8(),r8=()=>e8||n8?c.useLayoutEffect:c.useEffect,a8=r8(),bc=Symbol.for("react-redux-context"),jc=typeof globalThis<"u"?globalThis:{};function i8(){if(!c.createContext)return{};const e=jc[bc]??(jc[bc]=new Map);let t=e.get(c.createContext);return t||(t=c.createContext(null),e.set(c.createContext,t)),t}var s8=i8();function o8(e){const{children:t,context:r,serverState:a,store:i}=e,s=c.useMemo(()=>{const d=J$(i);return{store:i,subscription:d,getServerState:a?()=>a:void 0}},[i,a]),o=c.useMemo(()=>i.getState(),[i]);a8(()=>{const{subscription:d}=s;return d.onStateChange=d.notifyNestedSubs,d.trySubscribe(),o!==i.getState()&&d.notifyNestedSubs(),()=>{d.tryUnsubscribe(),d.onStateChange=void 0}},[s,o]);const l=r||s8;return c.createElement(l.Provider,{value:s},t)}var l8=o8,c8=(e,t)=>t,kf=me([c8,Je,g0,Gt,ix,Dr,JI,Kt],iT),Af=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,a=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/a)}},pb=Bn("mouseClick"),gb=Hi();gb.startListening({actionCreator:pb,effect:(e,t)=>{var r=e.payload,a=kf(t.getState(),Af(r));(a==null?void 0:a.activeIndex)!=null&&t.dispatch(eI({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}});var md=Bn("mouseMove"),yb=Hi();yb.startListening({actionCreator:md,effect:(e,t)=>{var r=e.payload,a=t.getState(),i=Ku(a,a.tooltip.settings.shared),s=kf(a,Af(r));i==="axis"&&((s==null?void 0:s.activeIndex)!=null?t.dispatch(X0({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate})):t.dispatch(V0()))}});var Fp={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0},vb=Sn({name:"rootProps",initialState:Fp,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:Fp.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue}}}),d8=vb.reducer,{updateOptions:u8}=vb.actions,xb=Sn({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:f8}=xb.actions,h8=xb.reducer,bb=Bn("keyDown"),jb=Bn("focus"),Cf=Hi();Cf.startListening({actionCreator:bb,effect:(e,t)=>{var r=t.getState(),a=r.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:i}=r.tooltip,s=e.payload;if(!(s!=="ArrowRight"&&s!=="ArrowLeft"&&s!=="Enter")){var o=Number(Yu(i,oi(r))),l=Dr(r);if(s==="Enter"){var d=wo(r,"axis","hover",String(i.index));t.dispatch(rd({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:d}));return}var f=HE(r),u=f==="left-to-right"?1:-1,h=s==="ArrowRight"?1:-1,m=o+h*u;if(!(l==null||m>=l.length||m<0)){var p=wo(r,"axis","hover",String(m));t.dispatch(rd({active:!0,activeIndex:m.toString(),activeDataKey:void 0,activeCoordinate:p}))}}}}});Cf.startListening({actionCreator:jb,effect:(e,t)=>{var r=t.getState(),a=r.rootProps.accessibilityLayer!==!1;if(a){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var s="0",o=wo(r,"axis","hover",String(s));t.dispatch(rd({activeDataKey:void 0,active:!0,activeIndex:s,activeCoordinate:o}))}}}});var zn=Bn("externalEvent"),wb=Hi();wb.startListening({actionCreator:zn,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),a={activeCoordinate:$I(r),activeDataKey:cx(r),activeIndex:Kr(r),activeLabel:lx(r),activeTooltipIndex:Kr(r),isTooltipActive:LI(r)};e.payload.handler(a,e.payload.reactEvent)}}});var m8=me([si],e=>e.tooltipItemPayloads),p8=me([m8,is,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,a)=>{var i=e.find(l=>l.settings.dataKey===a);if(i!=null){var{positions:s}=i;if(s!=null){var o=t(s,r);return o}}}),Sb=Bn("touchMove"),Nb=Hi();Nb.startListening({actionCreator:Sb,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var a=t.getState(),i=Ku(a,a.tooltip.settings.shared);if(i==="axis"){var s=kf(a,Af({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(s==null?void 0:s.activeIndex)!=null&&t.dispatch(X0({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}else if(i==="item"){var o,l=r.touches[0];if(document.elementFromPoint==null)return;var d=document.elementFromPoint(l.clientX,l.clientY);if(!d||!d.getAttribute)return;var f=d.getAttribute(zy),u=(o=d.getAttribute(Wy))!==null&&o!==void 0?o:void 0,h=p8(t.getState(),f,u);t.dispatch(G0({activeDataKey:u,activeIndex:f,activeCoordinate:h}))}}}});var g8=dy({brush:JD,cartesianAxis:IM,chartData:DT,errorBars:XM,graphicalItems:W_,layout:YN,legend:R2,options:IT,polarAxis:r_,polarOptions:h8,referenceElements:i6,rootProps:d8,tooltip:tI,zIndex:xT}),y8=function(t){return vN({reducer:g8,preloadedState:t,middleware:r=>r({serializableCheck:!1}).concat([gb.middleware,yb.middleware,Cf.middleware,wb.middleware,Nb.middleware]),enhancers:r=>{var a=r;return typeof r=="function"&&(a=r()),a.concat(wy({type:"raf"}))},devTools:Xr.devToolsEnabled})};function kb(e){var{preloadedState:t,children:r,reduxStoreName:a}=e,i=fn(),s=c.useRef(null);if(i)return r;s.current==null&&(s.current=y8(t));var o=$d;return c.createElement(l8,{context:o,store:s.current},r)}function Ab(e){var{layout:t,margin:r}=e,a=St(),i=fn();return c.useEffect(()=>{i||(a(UN(t)),a(qN(r)))},[a,i,t,r]),null}function Cb(e){var t=St();return c.useEffect(()=>{t(u8(e))},[t,e]),null}function qp(e){var{zIndex:t,isPanorama:r}=e,a=r?"recharts-zindex-panorama-":"recharts-zindex-",i=Yx("".concat(a).concat(t)),s=St();return c.useLayoutEffect(()=>(s(yT({zIndex:t,elementId:i,isPanorama:r})),()=>{s(vT({zIndex:t,isPanorama:r}))}),[s,t,i,r]),c.createElement("g",{id:i})}function Up(e){var{children:t,isPanorama:r}=e,a=Me(oT);if(!a||a.length===0)return t;var i=a.filter(o=>o<0),s=a.filter(o=>o>0);return c.createElement(c.Fragment,null,i.map(o=>c.createElement(qp,{key:o,zIndex:o,isPanorama:r})),t,s.map(o=>c.createElement(qp,{key:o,zIndex:o,isPanorama:r})))}var v8=["children"];function x8(e,t){if(e==null)return{};var r,a,i=b8(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function b8(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}function $o(){return $o=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},$o.apply(null,arguments)}var j8={width:"100%",height:"100%",display:"block"},w8=c.forwardRef((e,t)=>{var r=Vy(),a=Xy(),i=ev();if(!cr(r)||!cr(a))return null;var{children:s,otherAttributes:o,title:l,desc:d}=e,f,u;return o!=null&&(typeof o.tabIndex=="number"?f=o.tabIndex:f=i?0:void 0,typeof o.role=="string"?u=o.role:u=i?"application":void 0),c.createElement(ug,$o({},o,{title:l,desc:d,role:u,tabIndex:f,width:r,height:a,style:j8,ref:t}),s)}),S8=e=>{var{children:t}=e,r=Me(rl);if(!r)return null;var{width:a,height:i,y:s,x:o}=r;return c.createElement(ug,{width:a,height:i,x:o,y:s},t)},Hp=c.forwardRef((e,t)=>{var{children:r}=e,a=x8(e,v8),i=fn();return i?c.createElement(S8,null,c.createElement(Up,{isPanorama:!0},r)):c.createElement(w8,$o({ref:t},a),c.createElement(Up,{isPanorama:!1},r))});function N8(){var e=St(),[t,r]=c.useState(null),a=Me(u2);return c.useEffect(()=>{if(t!=null){var i=t.getBoundingClientRect(),s=i.width/t.offsetWidth;$t(s)&&s!==a&&e(KN(s))}},[t,e,a]),r}function Kp(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,a)}return r}function k8(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kp(Object(r),!0).forEach(function(a){A8(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kp(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function A8(e,t,r){return(t=C8(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C8(e){var t=P8(e,"string");return typeof t=="symbol"?t:t+""}function P8(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ka(){return ka=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},ka.apply(null,arguments)}var E8=()=>(UT(),null);function Lo(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var I8=c.forwardRef((e,t)=>{var r,a,i=c.useRef(null),[s,o]=c.useState({containerWidth:Lo((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Lo((a=e.style)===null||a===void 0?void 0:a.height)}),l=c.useCallback((f,u)=>{o(h=>{var m=Math.round(f),p=Math.round(u);return h.containerWidth===m&&h.containerHeight===p?h:{containerWidth:m,containerHeight:p}})},[]),d=c.useCallback(f=>{if(typeof t=="function"&&t(f),f!=null&&typeof ResizeObserver<"u"){var{width:u,height:h}=f.getBoundingClientRect();l(u,h);var m=x=>{var{width:v,height:g}=x[0].contentRect;l(v,g)},p=new ResizeObserver(m);p.observe(f),i.current=p}},[t,l]);return c.useEffect(()=>()=>{var f=i.current;f!=null&&f.disconnect()},[l]),c.createElement(c.Fragment,null,c.createElement(il,{width:s.containerWidth,height:s.containerHeight}),c.createElement("div",ka({ref:d},e)))}),T8=c.forwardRef((e,t)=>{var{width:r,height:a}=e,[i,s]=c.useState({containerWidth:Lo(r),containerHeight:Lo(a)}),o=c.useCallback((d,f)=>{s(u=>{var h=Math.round(d),m=Math.round(f);return u.containerWidth===h&&u.containerHeight===m?u:{containerWidth:h,containerHeight:m}})},[]),l=c.useCallback(d=>{if(typeof t=="function"&&t(d),d!=null){var{width:f,height:u}=d.getBoundingClientRect();o(f,u)}},[t,o]);return c.createElement(c.Fragment,null,c.createElement(il,{width:i.containerWidth,height:i.containerHeight}),c.createElement("div",ka({ref:l},e)))}),O8=c.forwardRef((e,t)=>{var{width:r,height:a}=e;return c.createElement(c.Fragment,null,c.createElement(il,{width:r,height:a}),c.createElement("div",ka({ref:t},e)))}),_8=c.forwardRef((e,t)=>{var{width:r,height:a}=e;return Sr(r)||Sr(a)?c.createElement(T8,ka({},e,{ref:t})):c.createElement(O8,ka({},e,{ref:t}))});function M8(e){return e===!0?I8:_8}var D8=c.forwardRef((e,t)=>{var{children:r,className:a,height:i,onClick:s,onContextMenu:o,onDoubleClick:l,onMouseDown:d,onMouseEnter:f,onMouseLeave:u,onMouseMove:h,onMouseUp:m,onTouchEnd:p,onTouchMove:x,onTouchStart:v,style:g,width:b,responsive:y,dispatchTouchEvents:A=!0}=e,C=c.useRef(null),N=St(),[w,M]=c.useState(null),[O,D]=c.useState(null),W=N8(),j=Hd(),S=(j==null?void 0:j.width)>0?j.width:b,R=(j==null?void 0:j.height)>0?j.height:i,I=c.useCallback(F=>{W(F),typeof t=="function"&&t(F),M(F),D(F),F!=null&&(C.current=F)},[W,t,M,D]),$=c.useCallback(F=>{N(pb(F)),N(zn({handler:s,reactEvent:F}))},[N,s]),J=c.useCallback(F=>{N(md(F)),N(zn({handler:f,reactEvent:F}))},[N,f]),q=c.useCallback(F=>{N(V0()),N(zn({handler:u,reactEvent:F}))},[N,u]),K=c.useCallback(F=>{N(md(F)),N(zn({handler:h,reactEvent:F}))},[N,h]),L=c.useCallback(()=>{N(jb())},[N]),ee=c.useCallback(F=>{N(bb(F.key))},[N]),E=c.useCallback(F=>{N(zn({handler:o,reactEvent:F}))},[N,o]),T=c.useCallback(F=>{N(zn({handler:l,reactEvent:F}))},[N,l]),B=c.useCallback(F=>{N(zn({handler:d,reactEvent:F}))},[N,d]),P=c.useCallback(F=>{N(zn({handler:m,reactEvent:F}))},[N,m]),_=c.useCallback(F=>{N(zn({handler:v,reactEvent:F}))},[N,v]),U=c.useCallback(F=>{A&&N(Sb(F)),N(zn({handler:x,reactEvent:F}))},[N,A,x]),fe=c.useCallback(F=>{N(zn({handler:p,reactEvent:F}))},[N,p]),ae=M8(y);return c.createElement(yx.Provider,{value:w},c.createElement(gw.Provider,{value:O},c.createElement(ae,{width:S??(g==null?void 0:g.width),height:R??(g==null?void 0:g.height),className:et("recharts-wrapper",a),style:k8({position:"relative",cursor:"default",width:S,height:R},g),onClick:$,onContextMenu:E,onDoubleClick:T,onFocus:L,onKeyDown:ee,onMouseDown:B,onMouseEnter:J,onMouseLeave:q,onMouseMove:K,onMouseUp:P,onTouchEnd:fe,onTouchMove:U,onTouchStart:_,ref:I},c.createElement(E8,null),r)))}),$8=["width","height","responsive","children","className","style","compact","title","desc"];function L8(e,t){if(e==null)return{};var r,a,i=R8(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function R8(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var Pb=c.forwardRef((e,t)=>{var{width:r,height:a,responsive:i,children:s,className:o,style:l,compact:d,title:f,desc:u}=e,h=L8(e,$8),m=Tn(h);return d?c.createElement(c.Fragment,null,c.createElement(il,{width:r,height:a}),c.createElement(Hp,{otherAttributes:m,title:f,desc:u},s)):c.createElement(D8,{className:o,style:l,width:r,height:a,responsive:i??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},c.createElement(Hp,{otherAttributes:m,title:f,desc:u,ref:t},c.createElement(o6,null,s)))});function pd(){return pd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},pd.apply(null,arguments)}var z8={top:5,right:5,bottom:5,left:5},W8={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:z8,reverseStackOrder:!1,syncMethod:"index",responsive:!1},Eb=c.forwardRef(function(t,r){var a,i=en(t.categoricalChartProps,W8),{chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:d,categoricalChartProps:f}=t,u={chartName:s,defaultTooltipEventType:o,validateTooltipEventTypes:l,tooltipPayloadSearcher:d,eventEmitter:void 0};return c.createElement(kb,{preloadedState:{options:u},reduxStoreName:(a=f.id)!==null&&a!==void 0?a:s},c.createElement(rb,{chartData:f.data}),c.createElement(Ab,{layout:i.layout,margin:i.margin}),c.createElement(Cb,{baseValue:i.baseValue,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),c.createElement(Pb,pd({},i,{ref:r})))}),B8=["axis"],F8=c.forwardRef((e,t)=>c.createElement(Eb,{chartName:"LineChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:B8,tooltipPayloadSearcher:tf,categoricalChartProps:e,ref:t})),q8=["axis","item"],Ib=c.forwardRef((e,t)=>c.createElement(Eb,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:q8,tooltipPayloadSearcher:tf,categoricalChartProps:e,ref:t}));function U8(e){var t=St();return c.useEffect(()=>{t(f8(e))},[t,e]),null}var H8=["layout"];function gd(){return gd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)({}).hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},gd.apply(null,arguments)}function K8(e,t){if(e==null)return{};var r,a,i=Y8(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)r=s[a],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Y8(e,t){if(e==null)return{};var r={};for(var a in e)if({}.hasOwnProperty.call(e,a)){if(t.indexOf(a)!==-1)continue;r[a]=e[a]}return r}var G8={top:5,right:5,bottom:5,left:5},V8={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:G8,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1},X8=c.forwardRef(function(t,r){var a,i=en(t.categoricalChartProps,V8),{layout:s}=i,o=K8(i,H8),{chartName:l,defaultTooltipEventType:d,validateTooltipEventTypes:f,tooltipPayloadSearcher:u}=t,h={chartName:l,defaultTooltipEventType:d,validateTooltipEventTypes:f,tooltipPayloadSearcher:u,eventEmitter:void 0};return c.createElement(kb,{preloadedState:{options:h},reduxStoreName:(a=i.id)!==null&&a!==void 0?a:l},c.createElement(rb,{chartData:i.data}),c.createElement(Ab,{layout:s,margin:i.margin}),c.createElement(Cb,{baseValue:void 0,accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),c.createElement(U8,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),c.createElement(Pb,gd({},o,{ref:r})))}),Q8=["item"],J8={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},Z8=c.forwardRef((e,t)=>{var r=en(e,J8);return c.createElement(X8,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:Q8,tooltipPayloadSearcher:tf,categoricalChartProps:r,ref:t})});const zs={high:"#ef4444",medium:"#f59e0b",low:"#10b981",default:"#e5e7eb"};function eL(){const[e,t]=c.useState([]),[r,a]=c.useState(!1),[i,s]=c.useState(null),[o,l]=c.useState("all"),[d,f]=c.useState(""),[u,h]=c.useState(""),[m,p]=c.useState(""),[x,v]=c.useState(!1),[g,b]=c.useState(""),[y,A]=c.useState(new Date().toISOString().split("T")[0]),[C,N]=c.useState(""),[w,M]=c.useState(!1),O=async()=>{a(!0),s(null);try{const S=new URLSearchParams;o!=="all"&&S.append("status",o),d&&S.append("fromDate",d),u&&S.append("toDate",u);const R=await fetch(`/api/v1/credit/meetings?${S.toString()}`);if(!R.ok)throw new Error(`API 호출 실패: ${R.status}`);const $=((await R.json()).meetings||[]).map(J=>{var q;return{id:J.id,title:J.meeting_name,meetingDate:J.meeting_date,status:((q=J.meeting_status)==null?void 0:q.toLowerCase())==="closed"?"completed":"in_progress",customerCount:J.customer_count||0,highRiskCount:J.high_risk_count||0,mediumRiskCount:J.medium_risk_count||0,lowRiskCount:J.low_risk_count||0,createdAt:J.created_at}});t($)}catch(S){console.error("채권회의 목록 조회 실패:",S),s(S.message||"데이터 조회 중 오류가 발생했습니다.")}finally{a(!1)}};c.useEffect(()=>{O()},[]);const D=S=>{if(!S)return"-";const R=new Date(S);return new Intl.DateTimeFormat("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}).format(R)},W=async()=>{if(!g||!y){alert("회의명과 일자를 입력해주세요.");return}M(!0);try{const S=await fetch("/api/v1/credit/meetings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({meetingCode:`MTG-${y.replace(/-/g,"")}`,meetingName:g,meetingDate:y,remark:C})});if(!S.ok)throw new Error("회의 생성 실패");const R=await S.json();if(R.success)v(!1),b(""),N(""),O();else throw new Error(R.error||"회의 생성 실패")}catch(S){alert(S.message)}finally{M(!1)}},j=S=>{const R=`credit:meeting:${S}`;window.location.hash=R,window.dispatchEvent(new CustomEvent("tnt.sales.navigate",{detail:{key:R}}))};return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb"},children:[n.jsxs("div",{style:{marginBottom:24,display:"flex",alignItems:"baseline",gap:12,justifyContent:"space-between"},children:[n.jsxs("div",{children:[n.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"채권회의"}),n.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"월별 채권 심사 및 리스크 관리 현황"})]}),n.jsxs("button",{className:"btn",onClick:()=>v(!0),style:{height:36,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",display:"flex",alignItems:"center",gap:6},children:[n.jsx(Zb,{size:16}),"새 회의 생성"]})]}),n.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:12,alignItems:"center",marginBottom:0},children:[n.jsxs("select",{className:"search-input",value:o,onChange:S=>l(S.target.value),style:{width:120},children:[n.jsx("option",{value:"all",children:"전체 상태"}),n.jsx("option",{value:"in_progress",children:"진행중"}),n.jsx("option",{value:"completed",children:"완료"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx("input",{type:"date",className:"search-input",value:d,onChange:S=>f(S.target.value),style:{width:130}}),n.jsx("span",{style:{color:"#9ca3af"},children:"~"}),n.jsx("input",{type:"date",className:"search-input",value:u,onChange:S=>h(S.target.value),style:{width:130}})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("input",{type:"text",className:"search-input",value:m,onChange:S=>p(S.target.value),placeholder:"회의명 검색",style:{width:200,paddingLeft:30}}),n.jsx(ya,{size:14,style:{position:"absolute",left:10,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}})]}),n.jsx("div",{style:{display:"flex",gap:8,marginLeft:"auto"},children:n.jsx("button",{className:"btn",onClick:O,disabled:r,style:{height:30,padding:"0 16px",fontSize:13,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",whiteSpace:"nowrap"},children:r?"조회 중...":"조회"})})]})]}),n.jsx("div",{style:{flex:1,overflow:"auto",padding:24},children:i?n.jsx("div",{style:{padding:16,color:"#ef4444",background:"#fef2f2",border:"1px solid #fee2e2",borderRadius:8},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[n.jsx(Mj,{size:16}),i]})}):e.length===0?n.jsxs("div",{className:"empty-state",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:300,gap:16},children:[n.jsx($f,{size:48,style:{opacity:.2}}),n.jsxs("div",{style:{textAlign:"center"},children:[n.jsx("p",{style:{fontSize:18,fontWeight:500,color:"#6b7280",margin:0},children:"등록된 채권회의가 없습니다."}),n.jsx("p",{style:{fontSize:14,color:"#9ca3af",marginTop:4},children:"새로운 회의를 생성하여 관리를 시작해보세요."})]})]}):n.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(350px, 1fr))",gap:24},children:e.map(S=>{const R=[{name:"High",value:S.highRiskCount,color:zs.high},{name:"Medium",value:S.mediumRiskCount,color:zs.medium},{name:"Low",value:S.lowRiskCount,color:zs.low}].filter(I=>I.value>0);return R.length===0&&R.push({name:"None",value:1,color:zs.default}),n.jsxs("div",{onClick:()=>j(S.id),className:"card",style:{background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden",cursor:"pointer",transition:"all 0.2s",display:"flex",flexDirection:"column"},onMouseEnter:I=>{I.currentTarget.style.transform="translateY(-2px)",I.currentTarget.style.boxShadow="0 10px 15px -3px rgba(0, 0, 0, 0.1)",I.currentTarget.style.borderColor="#93c5fd"},onMouseLeave:I=>{I.currentTarget.style.transform="none",I.currentTarget.style.boxShadow="none",I.currentTarget.style.borderColor="#e5e7eb"},children:[n.jsxs("div",{style:{padding:20,borderBottom:"1px solid #f3f4f6",background:"linear-gradient(to right, #fff, #f9fafb)"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:12},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[S.status==="completed"?n.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,padding:"2px 8px",borderRadius:999,fontSize:11,fontWeight:600,background:"#dcfce7",color:"#15803d"},children:[n.jsx(Ro,{size:12})," 완료됨"]}):n.jsxs("span",{style:{display:"inline-flex",alignItems:"center",gap:4,padding:"2px 8px",borderRadius:999,fontSize:11,fontWeight:600,background:"#dbeafe",color:"#1d4ed8"},children:[n.jsx(fj,{size:12})," 진행중"]}),n.jsxs("span",{style:{fontSize:11,color:"#9ca3af"},children:[S.createdAt.substring(0,10)," 생성"]})]}),n.jsx("div",{style:{width:28,height:28,borderRadius:"50%",background:"#f3f4f6",display:"flex",alignItems:"center",justifyContent:"center"},children:n.jsx(qs,{size:16,color:"#9ca3af"})})]}),n.jsx("h3",{style:{fontSize:18,fontWeight:700,color:"#111827",margin:"0 0 8px 0",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:S.title}),n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:13,color:"#6b7280"},children:[n.jsx($f,{size:14}),D(S.meetingDate)]})]}),n.jsxs("div",{style:{padding:20,display:"flex",alignItems:"center",gap:24,flex:1},children:[n.jsxs("div",{style:{position:"relative",width:80,height:80,flexShrink:0},children:[n.jsx(ro,{width:"100%",height:"100%",children:n.jsx(Z8,{children:n.jsx(Xx,{data:R,innerRadius:25,outerRadius:40,paddingAngle:2,dataKey:"value",stroke:"none",children:R.map((I,$)=>n.jsx(Ea,{fill:I.color},`cell-${$}`))})})}),n.jsxs("div",{style:{position:"absolute",inset:0,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",pointerEvents:"none"},children:[n.jsx("span",{style:{fontSize:10,fontWeight:600,color:"#9ca3af"},children:"Total"}),n.jsx("span",{style:{fontSize:16,fontWeight:700,color:"#111827",lineHeight:1},children:S.customerCount})]})]}),n.jsxs("div",{style:{flex:1,display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px 8px"},children:[n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[n.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"고위험"}),n.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#ef4444"},children:S.highRiskCount})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[n.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"중위험"}),n.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#f59e0b"},children:S.mediumRiskCount})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[n.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"저위험"}),n.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#10b981"},children:S.lowRiskCount})]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[n.jsx("span",{style:{fontSize:11,color:"#9ca3af",fontWeight:500},children:"심사대상"}),n.jsx("span",{style:{fontSize:15,fontWeight:700,color:"#374151"},children:S.customerCount})]})]})]}),n.jsxs("div",{style:{padding:"12px 20px",background:"#f9fafb",borderTop:"1px solid #f3f4f6",fontSize:12,color:"#6b7280",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("span",{children:"관리자: 홍길동"}),n.jsxs("span",{style:{color:"#3b82f6",fontWeight:600,display:"flex",alignItems:"center",gap:4},children:["상세보기 ",n.jsx(qs,{size:12})]})]})]},S.id)})})}),x&&n.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.4)",backdropFilter:"blur(4px)",zIndex:50,display:"flex",alignItems:"center",justifyContent:"center",padding:16},children:n.jsxs("div",{style:{background:"#fff",borderRadius:16,boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",width:"100%",maxWidth:480,overflow:"hidden"},onClick:S=>S.stopPropagation(),children:[n.jsxs("div",{style:{padding:"20px 24px",borderBottom:"1px solid #f3f4f6",display:"flex",justifyContent:"space-between",alignItems:"center",background:"#f9fafb"},children:[n.jsx("h3",{style:{fontSize:18,fontWeight:700,color:"#111827",margin:0},children:"새 채권회의 생성"}),n.jsx("button",{onClick:()=>v(!1),style:{background:"none",border:"none",color:"#9ca3af",cursor:"pointer",padding:4},children:n.jsx("span",{style:{fontSize:24,lineHeight:1},children:"×"})})]}),n.jsxs("div",{style:{padding:24,display:"flex",flexDirection:"column",gap:20},children:[n.jsxs("div",{children:[n.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:6},children:["회의명 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"text",value:g,onChange:S=>b(S.target.value),placeholder:"예: 2025년 1월 정기 채권회의",className:"search-input",style:{width:"100%",height:42},autoFocus:!0})]}),n.jsxs("div",{children:[n.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:6},children:["회의 일자 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"date",value:y,onChange:S=>A(S.target.value),className:"search-input",style:{width:"100%",height:42}})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:6},children:"비고"}),n.jsx("textarea",{value:C,onChange:S=>N(S.target.value),rows:3,placeholder:"회의 관련 메모를 입력하세요",className:"search-input",style:{width:"100%",height:"auto",padding:"12px",resize:"none"}})]})]}),n.jsxs("div",{style:{padding:"16px 24px",background:"#f9fafb",borderTop:"1px solid #f3f4f6",display:"flex",justifyContent:"flex-end",gap:12},children:[n.jsx("button",{onClick:()=>v(!1),className:"btn",style:{background:"#f3f4f6",borderColor:"#e5e7eb",color:"#4b5563"},children:"취소"}),n.jsx("button",{onClick:W,disabled:w,className:"btn",style:{background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:w?.7:1},children:w?"생성 중...":"회의 생성"})]})]})})]})}function tL(){const t=(window.location.hash.replace("#","")||"credit:meeting:1").split(":")[2]||"1",[r,a]=c.useState(null),[i,s]=c.useState([]),[o,l]=c.useState(!1),[d,f]=c.useState("kanban"),[u,h]=c.useState(null),[m,p]=c.useState(!1),[x,v]=c.useState(""),[g,b]=c.useState("WATCH"),y=async()=>{l(!0);try{const D=await(await fetch(`/api/v1/credit/meetings/${t}`)).json();D.meeting&&a({id:D.meeting.id,meetingCode:D.meeting.meeting_code,meetingName:D.meeting.meeting_name,meetingDate:D.meeting.meeting_date,status:D.meeting.meeting_status,remark:D.meeting.remark});const W=(D.customers||[]).map(j=>({id:j.id,customerSeq:j.customer_seq,customerName:j.customer_name,riskLevel:"medium",totalAr:j.total_ar,overdue:j.overdue||0,decisionCode:j.decision_code,decisionComment:j.decision_comment,reviewFlag:j.review_flag}));s(W)}catch(O){console.error(O)}finally{l(!1)}};c.useEffect(()=>{y()},[t]);const A=O=>{h(O),v(O.decisionComment||""),b(O.decisionCode||"WATCH"),p(!0)},C=async()=>{u&&(alert("의견이 저장되었습니다."),p(!1),y())},N=O=>`₩${O.toLocaleString()}`,w=[{id:"WATCH",title:"관찰 (Watch)",color:"#fef3c7",textColor:"#92400e",borderColor:"#f59e0b"},{id:"REVIEW_UNBLOCK",title:"해제 검토",color:"#dbeafe",textColor:"#1e40af",borderColor:"#3b82f6"},{id:"KEEP_BLOCK",title:"차단 유지",color:"#fee2e2",textColor:"#991b1b",borderColor:"#ef4444"},{id:"APPROVED",title:"승인",color:"#dcfce7",textColor:"#166534",borderColor:"#22c55e"}],M=()=>i.filter(O=>!O.decisionCode);return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa",overflow:"hidden",position:"relative"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb",zIndex:10},children:[n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16,marginBottom:20},children:[n.jsx("button",{onClick:()=>window.history.back(),style:{padding:8,borderRadius:"50%",border:"none",background:"transparent",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:O=>O.currentTarget.style.background="#f3f4f6",onMouseLeave:O=>O.currentTarget.style.background="transparent",children:n.jsx(tj,{size:20,color:"#4b5563"})}),n.jsxs("div",{children:[n.jsxs("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0,display:"flex",alignItems:"center",gap:12},children:[r==null?void 0:r.meetingName,n.jsx("span",{style:{padding:"2px 10px",borderRadius:999,fontSize:12,fontWeight:600,background:(r==null?void 0:r.status)==="CLOSED"?"#dcfce7":"#dbeafe",color:(r==null?void 0:r.status)==="CLOSED"?"#15803d":"#1d4ed8"},children:r==null?void 0:r.status})]}),n.jsxs("p",{style:{margin:"4px 0 0 0",color:"#6b7280",fontSize:14},children:[r==null?void 0:r.meetingCode," · ",r==null?void 0:r.meetingDate]})]}),n.jsx("div",{style:{marginLeft:"auto",display:"flex",gap:8},children:n.jsxs("div",{style:{display:"flex",background:"#f3f4f6",padding:4,borderRadius:8},children:[n.jsx("button",{onClick:()=>f("kanban"),style:{padding:6,borderRadius:6,border:"none",background:d==="kanban"?"#fff":"transparent",boxShadow:d==="kanban"?"0 1px 2px rgba(0,0,0,0.1)":"none",color:d==="kanban"?"#2563eb":"#6b7280",cursor:"pointer",display:"flex",alignItems:"center"},children:n.jsx(Qp,{size:16})}),n.jsx("button",{onClick:()=>f("grid"),style:{padding:6,borderRadius:6,border:"none",background:d==="grid"?"#fff":"transparent",boxShadow:d==="grid"?"0 1px 2px rgba(0,0,0,0.1)":"none",color:d==="grid"?"#2563eb":"#6b7280",cursor:"pointer",display:"flex",alignItems:"center"},children:n.jsx(Aj,{size:16})})]})})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:16},children:[n.jsxs("div",{style:{background:"linear-gradient(to bottom right, #eff6ff, #fff)",padding:16,borderRadius:12,border:"1px solid #dbeafe"},children:[n.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#2563eb",marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[n.jsx(Vb,{size:12})," 총 채권액"]}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:N(i.reduce((O,D)=>O+D.totalAr,0))})]}),n.jsxs("div",{style:{background:"linear-gradient(to bottom right, #fef2f2, #fff)",padding:16,borderRadius:12,border:"1px solid #fee2e2"},children:[n.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#dc2626",marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[n.jsx(vd,{size:12})," 총 연체액"]}),n.jsx("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:N(i.reduce((O,D)=>O+D.overdue,0))})]}),n.jsxs("div",{style:{background:"linear-gradient(to bottom right, #fffbeb, #fff)",padding:16,borderRadius:12,border:"1px solid #fef3c7"},children:[n.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#d97706",marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[n.jsx($j,{size:12})," 심사 대상"]}),n.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:[i.filter(O=>O.reviewFlag).length," ",n.jsx("span",{style:{fontSize:14,fontWeight:400,color:"#6b7280"},children:"업체"})]})]}),n.jsxs("div",{style:{background:"linear-gradient(to bottom right, #ecfdf5, #fff)",padding:16,borderRadius:12,border:"1px solid #d1fae5"},children:[n.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#059669",marginBottom:4,display:"flex",alignItems:"center",gap:4},children:[n.jsx(Ro,{size:12})," 완료율"]}),n.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"#111827"},children:[Math.round(i.filter(O=>O.decisionCode).length/(i.length||1)*100),"%"]})]})]})]}),n.jsx("div",{style:{flex:1,overflowX:"auto",padding:24},children:d==="kanban"?n.jsxs("div",{style:{display:"flex",gap:24,height:"100%",minWidth:"max-content"},children:[n.jsxs("div",{style:{width:320,display:"flex",flexDirection:"column"},children:[n.jsxs("div",{style:{marginBottom:12,fontWeight:600,color:"#6b7280",display:"flex",justifyContent:"space-between",alignItems:"center"},children:["미결정 ",n.jsx("span",{style:{background:"#e5e7eb",padding:"2px 8px",borderRadius:999,fontSize:12},children:M().length})]}),n.jsx("div",{style:{flex:1,background:"#f3f4f6",borderRadius:12,padding:12,display:"flex",flexDirection:"column",gap:12,overflowY:"auto"},children:M().map(O=>n.jsxs("div",{onClick:()=>A(O),className:"card",style:{background:"#fff",padding:16,borderRadius:8,border:"1px solid #e5e7eb",cursor:"pointer",transition:"all 0.2s"},onMouseEnter:D=>{D.currentTarget.style.transform="translateY(-2px)",D.currentTarget.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.1)"},onMouseLeave:D=>{D.currentTarget.style.transform="none",D.currentTarget.style.boxShadow="none"},children:[n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[n.jsx("span",{style:{width:8,height:8,borderRadius:"50%",marginTop:6,background:O.riskLevel==="high"?"#ef4444":O.riskLevel==="medium"?"#f59e0b":"#10b981"}}),n.jsxs("span",{style:{fontSize:12,fontFamily:"monospace",color:"#9ca3af"},children:["#",O.customerSeq]})]}),n.jsx("h4",{style:{fontSize:16,fontWeight:700,color:"#111827",margin:"0 0 4px 0"},children:O.customerName}),n.jsxs("div",{style:{fontSize:14,color:"#6b7280",marginBottom:12},children:["채권: ",N(O.totalAr)]}),O.reviewFlag&&n.jsx("div",{style:{fontSize:12,background:"#f3e8ff",color:"#7e22ce",padding:"2px 8px",borderRadius:4,display:"inline-block"},children:"심사필요"})]},O.id))})]}),w.map(O=>{const D=i.filter(W=>W.decisionCode===O.id);return n.jsxs("div",{style:{width:320,display:"flex",flexDirection:"column"},children:[n.jsxs("div",{style:{marginBottom:12,fontWeight:600,color:"#374151",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[O.title,n.jsx("span",{style:{background:O.color,color:O.textColor,padding:"2px 8px",borderRadius:999,fontSize:12},children:D.length})]}),n.jsx("div",{style:{flex:1,background:"#f3f4f6",borderRadius:12,padding:12,display:"flex",flexDirection:"column",gap:12,overflowY:"auto"},children:D.map(W=>n.jsxs("div",{onClick:()=>A(W),className:"card",style:{background:"#fff",padding:16,borderRadius:8,border:"1px solid #e5e7eb",borderLeft:`4px solid ${O.borderColor}`,cursor:"pointer",transition:"all 0.2s"},onMouseEnter:j=>{j.currentTarget.style.transform="translateY(-2px)",j.currentTarget.style.boxShadow="0 4px 6px -1px rgba(0, 0, 0, 0.1)"},onMouseLeave:j=>{j.currentTarget.style.transform="none",j.currentTarget.style.boxShadow="none"},children:[n.jsx("h4",{style:{fontSize:16,fontWeight:700,color:"#111827",margin:"0 0 4px 0"},children:W.customerName}),n.jsxs("p",{style:{fontSize:12,color:"#6b7280",margin:"0 0 8px 0",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",overflow:"hidden"},children:['"',W.decisionComment,'"']}),n.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",fontSize:12,color:"#9ca3af"},children:[n.jsx("span",{children:N(W.totalAr)}),n.jsx(yj,{size:16})]})]},W.id))})]},O.id)})]}):n.jsx("div",{style:{background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",overflow:"hidden",boxShadow:"0 1px 2px rgba(0,0,0,0.05)"},children:n.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:14},children:[n.jsx("thead",{style:{background:"#f9fafb",borderBottom:"1px solid #e5e7eb"},children:n.jsxs("tr",{children:[n.jsx("th",{style:{padding:"12px 24px",textAlign:"left",fontWeight:600,color:"#6b7280"},children:"거래처"}),n.jsx("th",{style:{padding:"12px 24px",textAlign:"right",fontWeight:600,color:"#6b7280"},children:"총 채권"}),n.jsx("th",{style:{padding:"12px 24px",textAlign:"right",fontWeight:600,color:"#6b7280"},children:"연체액"}),n.jsx("th",{style:{padding:"12px 24px",textAlign:"center",fontWeight:600,color:"#6b7280"},children:"위험도"}),n.jsx("th",{style:{padding:"12px 24px",textAlign:"left",fontWeight:600,color:"#6b7280"},children:"결정"}),n.jsx("th",{style:{padding:"12px 24px",textAlign:"left",fontWeight:600,color:"#6b7280"},children:"의견"})]})}),n.jsx("tbody",{children:i.map((O,D)=>{var W;return n.jsxs("tr",{onClick:()=>A(O),style:{borderBottom:D===i.length-1?"none":"1px solid #f3f4f6",cursor:"pointer",transition:"background 0.1s"},onMouseEnter:j=>j.currentTarget.style.background="#f9fafb",onMouseLeave:j=>j.currentTarget.style.background="#fff",children:[n.jsxs("td",{style:{padding:"16px 24px"},children:[n.jsx("div",{style:{fontWeight:600,color:"#111827"},children:O.customerName}),n.jsx("div",{style:{fontSize:12,color:"#9ca3af"},children:O.customerSeq})]}),n.jsx("td",{style:{padding:"16px 24px",textAlign:"right",fontFamily:"monospace"},children:N(O.totalAr)}),n.jsx("td",{style:{padding:"16px 24px",textAlign:"right",fontFamily:"monospace",color:"#dc2626"},children:N(O.overdue)}),n.jsx("td",{style:{padding:"16px 24px",textAlign:"center"},children:n.jsx("span",{style:{display:"inline-block",width:10,height:10,borderRadius:"50%",background:O.riskLevel==="high"?"#ef4444":O.riskLevel==="medium"?"#f59e0b":"#10b981"}})}),n.jsx("td",{style:{padding:"16px 24px"},children:O.decisionCode?n.jsx("span",{style:{padding:"2px 8px",borderRadius:4,fontSize:12,fontWeight:500,background:"#f3f4f6",color:"#374151"},children:((W=w.find(j=>j.id===O.decisionCode))==null?void 0:W.title)||O.decisionCode}):n.jsx("span",{style:{color:"#d1d5db"},children:"-"})}),n.jsx("td",{style:{padding:"16px 24px",color:"#6b7280",maxWidth:300,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:O.decisionComment||"-"})]},O.id)})})]})})}),m&&u&&n.jsxs(n.Fragment,{children:[n.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.2)",backdropFilter:"blur(2px)",zIndex:40},onClick:()=>p(!1)}),n.jsxs("div",{style:{position:"fixed",top:0,right:0,bottom:0,width:500,background:"#fff",boxShadow:"-4px 0 24px rgba(0,0,0,0.15)",zIndex:50,display:"flex",flexDirection:"column",animation:"slideIn 0.3s ease-out"},children:[n.jsxs("div",{style:{padding:24,borderBottom:"1px solid #f3f4f6",display:"flex",justifyContent:"space-between",alignItems:"flex-start",background:"#f9fafb"},children:[n.jsxs("div",{children:[n.jsx("h2",{style:{fontSize:20,fontWeight:700,color:"#111827",margin:0},children:u.customerName}),n.jsxs("p",{style:{margin:"4px 0 0 0",fontSize:14,color:"#6b7280"},children:["#",u.customerSeq," · ",u.riskLevel.toUpperCase()," Risk"]})]}),n.jsx("button",{onClick:()=>p(!1),style:{background:"none",border:"none",cursor:"pointer",color:"#9ca3af",padding:4},children:n.jsx(Jp,{size:24})})]}),n.jsxs("div",{style:{flex:1,overflowY:"auto",padding:24,display:"flex",flexDirection:"column",gap:32},children:[n.jsxs("div",{children:[n.jsxs("h3",{style:{fontSize:14,fontWeight:700,color:"#111827",marginBottom:16,display:"flex",alignItems:"center",gap:8},children:[n.jsx(ij,{size:16,color:"#2563eb"})," 채권 Aging 분석"]}),n.jsx("div",{style:{height:200,background:"#fff",borderRadius:12,border:"1px solid #f3f4f6",padding:8},children:n.jsx(ro,{width:"100%",height:"100%",children:n.jsxs(Ib,{data:[{name:"정상",value:u.totalAr-u.overdue},{name:"1개월",value:u.overdue*.5},{name:"2개월",value:u.overdue*.3},{name:"3개월+",value:u.overdue*.2}],children:[n.jsx(To,{strokeDasharray:"3 3",vertical:!1,stroke:"#f3f4f6"}),n.jsx(_o,{dataKey:"name",tick:{fontSize:11,fill:"#6b7280"},axisLine:!1,tickLine:!1}),n.jsx(Do,{tick:{fontSize:11,fill:"#6b7280"},axisLine:!1,tickLine:!1}),n.jsx(sd,{contentStyle:{borderRadius:8,border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:12},formatter:O=>N(O)}),n.jsx(xf,{dataKey:"value",radius:[4,4,0,0],children:[0,1,2,3].map((O,D)=>n.jsx(Ea,{fill:D===0?"#10b981":D===3?"#ef4444":"#3b82f6"},`cell-${D}`))})]})})})]}),n.jsxs("div",{style:{background:"#f9fafb",borderRadius:12,padding:20,border:"1px solid #e5e7eb"},children:[n.jsx("h3",{style:{fontSize:14,fontWeight:700,color:"#111827",marginBottom:16},children:"심사 결정 및 의견"}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6},children:"결정 (Decision)"}),n.jsxs("select",{value:g,onChange:O=>b(O.target.value),className:"search-input",style:{width:"100%",padding:"8px 12px",borderRadius:8,border:"1px solid #d1d5db",fontSize:14},children:[n.jsx("option",{value:"WATCH",children:"관찰 (Watch)"}),n.jsx("option",{value:"REVIEW_UNBLOCK",children:"해제 검토"}),n.jsx("option",{value:"KEEP_BLOCK",children:"차단 유지"}),n.jsx("option",{value:"APPROVED",children:"승인"}),n.jsx("option",{value:"REJECTED",children:"거부"})]})]}),n.jsxs("div",{children:[n.jsx("label",{style:{display:"block",fontSize:12,fontWeight:600,color:"#6b7280",marginBottom:6},children:"의견 (Opinion)"}),n.jsx("textarea",{value:x,onChange:O=>v(O.target.value),rows:4,className:"search-input",style:{width:"100%",padding:"12px",borderRadius:8,border:"1px solid #d1d5db",fontSize:14,resize:"none"},placeholder:"심사 의견을 상세히 입력하세요..."})]})]})]})]}),n.jsx("div",{style:{padding:24,borderTop:"1px solid #f3f4f6",background:"#f9fafb"},children:n.jsx("button",{onClick:C,className:"btn",style:{width:"100%",padding:"12px",background:"#2563eb",color:"white",fontWeight:700,borderRadius:12,border:"none",fontSize:15,boxShadow:"0 4px 6px -1px rgba(37, 99, 235, 0.2)"},children:"저장하기"})})]})]}),n.jsx("style",{children:`
        @keyframes slideIn {
          from { transform: translateX(100%); }
          to { transform: translateX(0); }
        }
      `})]})}const Yp=[{id:1,title:"거래처 선택 및 현황 분석",icon:ya},{id:2,title:"해제 사유 및 계획 작성",icon:xd},{id:3,title:"요청 완료",icon:Ro}];function nL(){const[e,t]=c.useState(1),[r,a]=c.useState(""),[i,s]=c.useState(null),[o,l]=c.useState(!1),[d,f]=c.useState(""),[u,h]=c.useState(""),[m,p]=c.useState(""),[x,v]=c.useState(""),[g,b]=c.useState(!1),y=async O=>{if(O){l(!0),s(null);try{const D=await fetch(`/api/v1/credit/customers/${O}`);if(!D.ok)throw new Error("거래처 정보를 찾을 수 없습니다");const W=await D.json();if(W.customer){const j=W.customer;s({customerSeq:j.customer_seq,customerName:j.customer_name,totalAr:j.total_ar||0,weightedAgingDays:45,overdue:j.overdue||0,aging0_30:j.aging_0_30||0,aging31_60:j.aging_31_60||0,aging61_90:j.aging_61_90||0,recentCollections:[{date:"2024-12-15",amount:5e6},{date:"2024-11-20",amount:3e6},{date:"2024-10-18",amount:4e6}],avgMonthlySales:25e6,lastMeetingOpinion:"고객사 자금 사정 어려움. 1월 중순 입금 약속."})}}catch(D){console.error("거래처 조회 실패:",D),alert(D.message)}finally{l(!1)}}},A=async()=>{if(!r||!d||!u||!m||!x){alert("모든 필수 항목을 입력해주세요");return}b(!0);try{const O=await fetch("/api/v1/credit/unblock-requests",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerSeq:Number(r),requestCode:`REQ-${Date.now()}`,requestDate:new Date().toISOString().split("T")[0],requestReason:d,expectedCollectionDate:u,expectedAmount:Number(m),collectionPlan:x,assigneeId:"user1"})});if(!O.ok)throw new Error("요청 제출 실패");const D=await O.json();if(D.success)t(3);else throw new Error(D.error||"요청 제출 실패")}catch(O){alert("요청 제출 중 오류가 발생했습니다: "+O.message)}finally{b(!1)}},C=O=>`₩${O.toLocaleString("ko-KR")}`,N=()=>n.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-right-4 duration-300",children:[n.jsxs("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb"},children:[n.jsxs("h2",{style:{fontSize:18,fontWeight:700,color:"#111827",marginBottom:20,display:"flex",alignItems:"center",gap:8},children:[n.jsx(ya,{size:20,color:"#3b82f6"})," 거래처 조회"]}),n.jsxs("div",{style:{display:"flex",gap:12},children:[n.jsxs("div",{style:{position:"relative",flex:1,maxWidth:400},children:[n.jsx("input",{type:"number",value:r,onChange:O=>a(O.target.value),onKeyDown:O=>O.key==="Enter"&&y(r),placeholder:"거래처 코드 (SEQ) 입력",className:"search-input",style:{width:"100%",height:42,paddingLeft:40,fontSize:14},autoFocus:!0}),n.jsx(ya,{size:16,style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#9ca3af"}})]}),n.jsx("button",{onClick:()=>y(r),disabled:o||!r,className:"btn",style:{height:42,padding:"0 24px",fontSize:14,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:o||!r?.7:1},children:o?"조회 중...":"조회"})]})]}),i&&n.jsxs("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-500",style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:24},children:[n.jsx("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",gridColumn:"span 2"},children:n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:24},children:[n.jsxs("div",{style:{padding:16,background:"#eff6ff",borderRadius:12,border:"1px solid #dbeafe"},children:[n.jsx("div",{style:{fontSize:13,color:"#2563eb",fontWeight:600,marginBottom:4},children:"총 채권액"}),n.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:C(i.totalAr)})]}),n.jsxs("div",{style:{padding:16,background:"#fef2f2",borderRadius:12,border:"1px solid #fee2e2"},children:[n.jsx("div",{style:{fontSize:13,color:"#dc2626",fontWeight:600,marginBottom:4},children:"연체 금액"}),n.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:C(i.overdue)})]}),n.jsxs("div",{style:{padding:16,background:"#fffbeb",borderRadius:12,border:"1px solid #fef3c7"},children:[n.jsx("div",{style:{fontSize:13,color:"#d97706",fontWeight:600,marginBottom:4},children:"평균 결제일"}),n.jsxs("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:[i.weightedAgingDays,"일"]})]}),n.jsxs("div",{style:{padding:16,background:"#f9fafb",borderRadius:12,border:"1px solid #f3f4f6"},children:[n.jsx("div",{style:{fontSize:13,color:"#4b5563",fontWeight:600,marginBottom:4},children:"월 평균 매출"}),n.jsx("div",{style:{fontSize:20,fontWeight:700,color:"#111827"},children:C(i.avgMonthlySales||0)})]})]})}),n.jsxs("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",height:320},children:[n.jsx("h3",{style:{fontSize:16,fontWeight:700,color:"#111827",marginBottom:16},children:"채권 연령 분석"}),n.jsx(ro,{width:"100%",height:"100%",children:n.jsxs(Ib,{data:[{name:"정상",value:i.totalAr-i.overdue},{name:"1개월",value:i.aging0_30},{name:"2개월",value:i.aging31_60},{name:"3개월+",value:i.aging61_90}],margin:{top:20,right:30,left:20,bottom:5},children:[n.jsx(To,{strokeDasharray:"3 3",vertical:!1}),n.jsx(_o,{dataKey:"name",tick:{fontSize:12}}),n.jsx(Do,{tick:{fontSize:12}}),n.jsx(sd,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:12},formatter:O=>C(O)}),n.jsx(xf,{dataKey:"value",radius:[4,4,0,0],children:[0,1,2,3].map((O,D)=>n.jsx(Ea,{fill:D===0?"#10b981":D===3?"#ef4444":"#3b82f6"},`cell-${D}`))})]})})]}),n.jsxs("div",{className:"card",style:{padding:24,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb",height:320},children:[n.jsx("h3",{style:{fontSize:16,fontWeight:700,color:"#111827",marginBottom:16},children:"최근 수금 추이"}),n.jsx(ro,{width:"100%",height:"100%",children:n.jsxs(F8,{data:i.recentCollections,margin:{top:20,right:30,left:20,bottom:5},children:[n.jsx(To,{strokeDasharray:"3 3",vertical:!1}),n.jsx(_o,{dataKey:"date",tick:{fontSize:12}}),n.jsx(Do,{tick:{fontSize:12}}),n.jsx(sd,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",fontSize:12},formatter:O=>C(O)}),n.jsx(mb,{type:"monotone",dataKey:"amount",stroke:"#8b5cf6",strokeWidth:3,dot:{r:4},activeDot:{r:6}})]})})]})]})]}),w=()=>n.jsx("div",{className:"animate-in fade-in slide-in-from-right-4 duration-300",style:{maxWidth:800,margin:"0 auto"},children:n.jsxs("div",{className:"card",style:{padding:32,background:"#fff",borderRadius:12,border:"1px solid #e5e7eb"},children:[n.jsxs("h2",{style:{fontSize:18,fontWeight:700,color:"#111827",marginBottom:24,display:"flex",alignItems:"center",gap:8},children:[n.jsx(xd,{size:20,color:"#3b82f6"})," 해제 요청 사유 작성"]}),n.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:24},children:[n.jsxs("div",{children:[n.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["요청 사유 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("textarea",{value:d,onChange:O=>f(O.target.value),rows:5,className:"search-input",style:{width:"100%",height:"auto",padding:12,resize:"none",fontSize:14},placeholder:"매출통제 해제가 필요한 구체적인 사유를 입력해주세요."})]}),n.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:24},children:[n.jsxs("div",{children:[n.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["예상 수금일 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"date",value:u,onChange:O=>h(O.target.value),className:"search-input",style:{width:"100%",height:42}})]}),n.jsxs("div",{children:[n.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["예상 수금액 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsxs("div",{style:{position:"relative"},children:[n.jsx("span",{style:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",color:"#6b7280",fontSize:14},children:"₩"}),n.jsx("input",{type:"number",value:m,onChange:O=>p(O.target.value),className:"search-input",style:{width:"100%",height:42,paddingLeft:30},placeholder:"0"})]})]})]}),n.jsxs("div",{children:[n.jsxs("label",{style:{display:"block",fontSize:14,fontWeight:600,color:"#374151",marginBottom:8},children:["수금 계획 근거 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("textarea",{value:x,onChange:O=>v(O.target.value),rows:3,className:"search-input",style:{width:"100%",height:"auto",padding:12,resize:"none",fontSize:14},placeholder:"수금 계획의 신뢰성을 뒷받침할 근거를 입력해주세요 (예: 고객사 담당자 통화 내용, 지불각서 등)"})]})]})]})}),M=()=>n.jsxs("div",{className:"animate-in zoom-in-95 duration-500",style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"60vh"},children:[n.jsx("div",{style:{width:80,height:80,background:"#dcfce7",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",marginBottom:24},children:n.jsx(Ro,{size:40,color:"#16a34a"})}),n.jsx("h2",{style:{fontSize:24,fontWeight:700,color:"#111827",marginBottom:8},children:"요청이 완료되었습니다!"}),n.jsx("p",{style:{fontSize:16,color:"#6b7280",marginBottom:32},children:"담당자 검토 후 승인 여부가 결정됩니다."}),n.jsx("button",{onClick:()=>{t(1),a(""),s(null),f(""),h(""),p(""),v("")},className:"btn",style:{height:48,padding:"0 32px",fontSize:15,fontWeight:700,background:"#111827",borderColor:"#111827",color:"white",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"},children:"새로운 요청 작성하기"})]});return n.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"#f8f9fa"},children:[n.jsxs("div",{style:{padding:"20px 24px",background:"#fff",borderBottom:"1px solid #e5e7eb",zIndex:10},children:[n.jsxs("div",{style:{marginBottom:24},children:[n.jsx("h1",{style:{fontSize:24,fontWeight:700,color:"#111827",margin:0},children:"매출통제 해제 요청"}),n.jsx("p",{style:{margin:0,color:"#6b7280",fontSize:14},children:"연체 거래처의 일시적 매출 허용을 위한 승인 요청"})]}),n.jsxs("div",{style:{display:"flex",alignItems:"center",maxWidth:600,margin:"0 auto",position:"relative"},children:[n.jsx("div",{style:{position:"absolute",top:20,left:0,width:"100%",height:2,background:"#f3f4f6",zIndex:0}}),n.jsx("div",{style:{position:"absolute",top:20,left:0,height:2,background:"#3b82f6",zIndex:0,width:`${(e-1)/(Yp.length-1)*100}%`,transition:"width 0.3s ease"}}),Yp.map(O=>{const D=e>=O.id,W=e===O.id;return n.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",position:"relative",zIndex:1},children:[n.jsx("div",{style:{width:40,height:40,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:D?"#3b82f6":"#fff",border:D?"none":"2px solid #e5e7eb",color:D?"#fff":"#9ca3af",boxShadow:D?"0 4px 6px -1px rgba(59, 130, 246, 0.3)":"none",transition:"all 0.3s ease"},children:n.jsx(O.icon,{size:20})}),n.jsx("span",{style:{marginTop:8,fontSize:13,fontWeight:W?700:500,color:W?"#3b82f6":"#9ca3af",transition:"color 0.3s ease"},children:O.title})]},O.id)})]})]}),n.jsxs("div",{style:{flex:1,overflow:"auto",padding:32},children:[e===1&&N(),e===2&&w(),e===3&&M()]}),e<3&&n.jsxs("div",{style:{padding:"16px 32px",background:"#fff",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[n.jsx("button",{onClick:()=>t(O=>Math.max(1,O-1)),disabled:e===1,className:"btn",style:{background:"transparent",borderColor:"transparent",color:"#4b5563",opacity:e===1?.3:1,cursor:e===1?"not-allowed":"pointer",paddingLeft:0},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:4},children:[n.jsx(oj,{size:18})," 이전"]})}),e===1?n.jsx("button",{onClick:()=>t(2),disabled:!i,className:"btn",style:{height:42,padding:"0 24px",fontSize:14,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:i?1:.5,cursor:i?"pointer":"not-allowed"},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:["다음 단계 ",n.jsx(qs,{size:18})]})}):n.jsx("button",{onClick:A,disabled:g,className:"btn",style:{height:42,padding:"0 24px",fontSize:14,fontWeight:600,background:"#3b82f6",borderColor:"#3b82f6",color:"white",opacity:g?.7:1},children:n.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[g?"제출 중...":"요청 제출하기"," ",n.jsx(rj,{size:18})]})})]})]})}function TL({selectedKey:e}){return n.jsx("div",{className:"main-view",children:e==="dashboard"?n.jsx(f1,{}):e==="calendar"?n.jsx(u1,{}):e==="demand"&&ln.demandManagement?n.jsxs("section",{children:[n.jsx("h1",{children:"수요관리"}),n.jsx("p",{children:"여기에서 수요 데이터를 조회/분석/관리하는 기능이 표시됩니다."}),n.jsx("div",{className:"empty-state",children:"초기 버전: 메인 화면 스켈레톤"})]}):e==="customer"&&ln.customerManagement?n.jsxs("section",{children:[n.jsx("h1",{children:"고객관리"}),n.jsx("p",{children:"고객관리 요구사항은 별도로 정의/입력됩니다. 현재는 플레이스홀더입니다."}),n.jsx("div",{className:"empty-state",children:"초기 버전: 고객관리 화면 스켈레톤"})]}):e==="customer"&&ln.customerManagement?n.jsxs("section",{children:[n.jsx("h1",{children:"고객관리"}),n.jsx("p",{children:"고객관리 요구사항은 별도로 정의/입력됩니다. 현재는 플레이스홀더입니다."}),n.jsx("div",{className:"empty-state",children:"초기 버전: 고객관리 화면 스켈레톤"})]}):e==="customer:list"&&ln.customerManagement?n.jsx(eg,{}):e==="customer:sales-activity-new"&&ln.customerManagement?n.jsx(Vj,{}):e==="customer:c360"&&ln.customerManagement?n.jsx(n1,{}):e==="sales-mgmt:activity-plan"?n.jsx(c1,{}):e==="customer:c360-old"&&ln.customerManagement?n.jsx(d1,{}):e==="customer:my-activities"&&ln.customerManagement?n.jsx(g1,{}):e==="lead:register"||e==="lead"?n.jsx(O1,{}):e==="lead:tm-status"?n.jsx(M1,{}):e==="order-sheet"?n.jsx(D1,{}):e==="order-list"?n.jsx(W1,{}):e==="inquiry"?n.jsx(S1,{}):e==="estimate"?n.jsx(P1,{}):e==="item360"?n.jsx(F1,{}):e==="inventory:expiry-ag"?n.jsx(Z1,{}):e==="complaint"?n.jsx(y1,{}):e==="credit:ar-aging"?n.jsx(sw,{}):e==="credit:meetings"?n.jsx(eL,{}):e.startsWith("credit:meeting:")?n.jsx(tL,{}):e==="credit:unblocking"?n.jsx(nL,{}):e==="sales-receivables"?n.jsxs("section",{children:[n.jsx("h1",{children:"매출/채권"}),n.jsx("div",{className:"empty-state",children:"매출·채권 관리 화면이 준비중입니다."})]}):e==="settings"?n.jsx(E1,{}):e==="sales-mgmt:sales"?n.jsx(H1,{}):e==="sales-mgmt:receivables"?n.jsx(V1,{}):e==="sales-mgmt:activities"?n.jsx(Q1,{}):e==="lab:vibe-workspace"?n.jsx(iw,{}):e==="lab:unit-analysis"?n.jsx(ew,{}):e==="lab:price-sim"?n.jsx(nw,{}):e==="lab:price-sim-unit"?n.jsx(aw,{}):e==="demand:list"&&ln.demandManagement?n.jsx(Xb,{}):e==="sales-targets"&&ln.demandManagement?n.jsx(Bf,{}):e==="sales-dashboard"&&ln.demandManagement?n.jsx(U1,{}):e==="sales-assign"&&ln.demandManagement?n.jsx(z1,{}):e==="sales-plan"&&ln.demandManagement?n.jsx(Kj,{}):e==="sales-plan-new"&&ln.demandManagement?n.jsx(Bf,{}):e==="sales-plan-s"&&ln.demandManagement?n.jsx(Uj,{}):e==="demand:excel-upload"&&ln.demandManagement?n.jsx(Rj,{}):n.jsxs("section",{children:[n.jsx("h1",{children:e}),n.jsx("div",{className:"empty-state",children:"콘텐츠가 준비중입니다."})]})})}export{TL as MainView};
