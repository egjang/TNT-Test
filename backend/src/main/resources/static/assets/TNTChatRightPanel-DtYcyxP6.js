import{r,j as e,S as Le,L as Pe,I as Ne,F as B,R as Me,d as he,n as b,p as Q}from"./index-BB_3LKiY.js";import{u as Ue,L as Ge,U as xe,C as qe,F as Ve}from"./upload-QE74yyW2.js";import{U as He}from"./user-C1JnWx0K.js";import{X as Z}from"./x-Ci4NTfDo.js";import{D as R}from"./database-o3KgoVAW.js";import{P as Je}from"./plus-NPOo4Ump.js";import{R as ee}from"./refresh-cw-BZiQWki6.js";import{L as U}from"./loader-circle-Cdx_3rgK.js";import{C as ue}from"./circle-check-big-56oz7VR7.js";import{T as te}from"./trash-2-YQlpFIkM.js";import{C as ye}from"./chevron-down-DD_Bc6LT.js";function rt(){var fe;const[D,be]=r.useState([]),[o,G]=r.useState(""),[$,O]=r.useState(!1),[I,ne]=r.useState(""),[u,ie]=r.useState([]),[me,se]=r.useState(!1),[je,oe]=r.useState(!1),re=r.useRef(null),{instance:W,accounts:h,inProgress:ve}=Ue(),[q,ae]=r.useState(!1),[V,Se]=r.useState([]),[l,T]=r.useState([]),[we,F]=r.useState(!1),[L,H]=r.useState(null),[f,P]=r.useState([]),[A,le]=r.useState(!1),[m,J]=r.useState("store"),[j,c]=r.useState(null),[p,g]=r.useState(null),[v,w]=r.useState(null);r.useEffect(()=>{N()},[]),r.useEffect(()=>{if(o){M(o);const t=D.find(n=>n.name===o);window.dispatchEvent(new CustomEvent("tnt.chat.store.changed",{detail:{storeName:o,displayName:(t==null?void 0:t.displayName)||"",documents:u}}))}},[o]),r.useEffect(()=>{if(o){const t=D.find(n=>n.name===o);window.dispatchEvent(new CustomEvent("tnt.chat.store.changed",{detail:{storeName:o,displayName:(t==null?void 0:t.displayName)||"",documents:u}}))}},[u]);const N=async()=>{O(!0);try{const n=await(await fetch("/api/v1/rag/stores")).json();n.stores&&(be(n.stores),n.currentStore&&G(n.currentStore))}catch(t){console.error("Failed to fetch stores:",t)}finally{O(!1)}},ke=async t=>{try{(await(await fetch("/api/v1/rag/store/select",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({storeName:t})})).json()).success&&G(t)}catch(n){c(`‚ùå Ïä§ÌÜ†Ïñ¥ ÏÑ†ÌÉù Ïã§Ìå®: ${n.message}`)}},de=async()=>{if(I.trim()){O(!0);try{const n=await(await fetch("/api/v1/rag/store",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({displayName:I.trim()})})).json();n.success?(c("‚úÖ Ïä§ÌÜ†Ïñ¥ ÏÉùÏÑ± ÏôÑÎ£å!"),ne(""),N()):c(`‚ùå ${n.error}`)}catch(t){c(`‚ùå ${t.message}`)}finally{O(!1)}}},ze=(t,n)=>{n.stopPropagation();const i=D.find(a=>a.name===t),s=(i==null?void 0:i.displayName)||t.split("/").pop()||"";w({show:!0,title:"Ïä§ÌÜ†Ïñ¥ ÏÇ≠Ï†ú",message:`"${s}" Ïä§ÌÜ†Ïñ¥Î•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`,subMessage:"Ïä§ÌÜ†Ïñ¥ ÎÇ¥ Î™®Îì† Î¨∏ÏÑúÎèÑ Ìï®Íªò ÏÇ≠Ï†úÎê©ÎãàÎã§. Ïù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.",onConfirm:()=>Ce(t)})},Ce=async t=>{w(null);try{const n=t.split("/").pop(),s=await(await fetch(`/api/v1/rag/store/${n}`,{method:"DELETE"})).json();s.success?(g({show:!0,type:"success",title:"ÏÇ≠Ï†ú ÏôÑÎ£å",message:"Ïä§ÌÜ†Ïñ¥Í∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§."}),t===o&&(G(""),ie([])),N()):g({show:!0,type:"error",title:"ÏÇ≠Ï†ú Ïã§Ìå®",message:s.error||"Ïä§ÌÜ†Ïñ¥ ÏÇ≠Ï†úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§."})}catch(n){g({show:!0,type:"error",title:"ÏÇ≠Ï†ú Ïã§Ìå®",message:n.message||"Ïä§ÌÜ†Ïñ¥ ÏÇ≠Ï†ú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§."})}},M=async t=>{if(t||o){se(!0);try{const s=await(await fetch("/api/v1/rag/store/documents")).json();s.documents&&ie(s.documents)}catch(i){console.error("Failed to fetch documents:",i)}finally{se(!1)}}},Re=t=>{w({show:!0,title:"Î¨∏ÏÑú ÏÇ≠Ï†ú",message:"Î¨∏ÏÑúÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?",subMessage:"Ïù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.",onConfirm:()=>De(t)})},De=async t=>{w(null);try{const n=t.split("/").pop(),s=await(await fetch(`/api/v1/rag/store/document/${n}`,{method:"DELETE"})).json();s.success?(g({show:!0,type:"success",title:"ÏÇ≠Ï†ú ÏôÑÎ£å",message:"Î¨∏ÏÑúÍ∞Ä ÏÑ±Í≥µÏ†ÅÏúºÎ°ú ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§."}),M()):g({show:!0,type:"error",title:"ÏÇ≠Ï†ú Ïã§Ìå®",message:s.error||"Î¨∏ÏÑú ÏÇ≠Ï†úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§."})}catch(n){g({show:!0,type:"error",title:"ÏÇ≠Ï†ú Ïã§Ìå®",message:n.message||"Î¨∏ÏÑú ÏÇ≠Ï†ú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§."})}},E=async()=>{if(h.length===0)return null;try{return(await W.acquireTokenSilent({scopes:Q.oneDrive,account:h[0]})).accessToken}catch{try{return(await W.acquireTokenPopup({scopes:Q.oneDrive})).accessToken}catch{return null}}},Y=async()=>{try{await W.loginPopup({scopes:Q.oneDrive})}catch{c("‚ùå Î°úÍ∑∏Ïù∏ Ïã§Ìå®")}},Ie=async()=>{try{await W.logoutPopup()}catch(t){console.error("Logout failed:",t)}},Te=async t=>{const n=await E();if(!n){c("‚ùå MS Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§");return}oe(!0),c("üì§ OneDrive ÏóÖÎ°úÎìú Ï§ë...");try{const i=`${b.graphDriveEndpoint}/root:/Google RAG/${t.name}:/content`;(await fetch(i,{method:"PUT",headers:{Authorization:`Bearer ${n}`,"Content-Type":t.type||"application/octet-stream"},body:t})).ok?(c("‚úÖ OneDrive ÏóÖÎ°úÎìú ÏôÑÎ£å!"),await _()):c("‚ùå ÏóÖÎ°úÎìú Ïã§Ìå®")}catch(i){c(`‚ùå ${i.message}`)}finally{oe(!1)}},_=async()=>{ae(!0),F(!0);try{const t=await E();if(!t){c("‚ùå OneDrive Ïù∏Ï¶ù ÌïÑÏöî"),F(!1);return}const n=`${b.graphDriveEndpoint}/root:/Google RAG`,i=await fetch(n,{headers:{Authorization:`Bearer ${t}`}});if(i.ok){const s=await i.json();T([{id:s.id,name:"Google RAG"}]),await y(s.id)}else T([]),await y()}catch{T([]),await y()}};r.useEffect(()=>{m==="upload"&&o&&h.length>0&&!q&&_()},[m,o,h.length]);const y=async t=>{F(!0);try{const n=await E();if(!n)return;const i=t?`${b.graphDriveEndpoint}/items/${t}/children`:`${b.graphDriveEndpoint}/root/children`,s=await fetch(i,{headers:{Authorization:`Bearer ${n}`}});if(s.ok){const a=await s.json();Se(a.value||[])}}catch(n){console.error("OneDrive fetch failed:",n)}finally{F(!1)}},Ee=async t=>{t.folder&&(T(n=>[...n,{id:t.id,name:t.name}]),await y(t.id))},ce=async t=>{if(t===-1)T([]),await y();else{const n=l.slice(0,t+1);T(n),await y(n[n.length-1].id)}},Ae=t=>{P(n=>n.find(s=>s.id===t.id)?n.filter(s=>s.id!==t.id):[...n,t])},Be=t=>{P(n=>n.filter(i=>i.id!==t.id))},$e=async(t,n)=>{var i,s;try{const a=await E();if(!a)return!1;const d="Archive",x=n?`${b.graphDriveEndpoint}/items/${n}/children`:`${b.graphDriveEndpoint}/root/children`,k=await fetch(x,{headers:{Authorization:`Bearer ${a}`}});if(!k.ok)return!1;let z=(i=(await k.json()).value)==null?void 0:i.find(S=>S.name===d&&S.folder);if(!z){const S=await fetch(x,{method:"POST",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({name:d,folder:{},"@microsoft.graph.conflictBehavior":"fail"})});if(S.ok)z=await S.json();else{const X=await fetch(x,{headers:{Authorization:`Bearer ${a}`}});if(X.ok&&(z=(s=(await X.json()).value)==null?void 0:s.find(ge=>ge.name===d&&ge.folder)),!z)return!1}}const C=await fetch(`${b.graphDriveEndpoint}/items/${t.id}`,{method:"PATCH",headers:{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},body:JSON.stringify({parentReference:{id:z.id},"@microsoft.graph.conflictBehavior":"rename"})});if(!C.ok){const S=await C.json().catch(()=>({}));console.error(`Failed to move ${t.name} to Archive:`,C.status,S)}return C.ok}catch(a){return console.error(`Failed to move ${t.name} to Archive:`,a),!1}},Oe=async()=>{var s;if(!o||f.length===0)return;le(!0),H({current:0,total:f.length,file:""});const t=l.length>0?l[l.length-1].id:null;let n=0,i=0;for(let a=0;a<f.length;a++){const d=f[a];H({current:a,total:f.length,file:d.name});try{const x=await E();if(!x)continue;const k=await fetch(`${b.graphDriveEndpoint}/items/${d.id}/content`,{headers:{Authorization:`Bearer ${x}`}});if(!k.ok)continue;const pe=await k.blob(),z=new File([pe],d.name,{type:((s=d.file)==null?void 0:s.mimeType)||"application/octet-stream"}),C=new FormData;C.append("file",z),(await fetch("/api/v1/rag/store/upload",{method:"POST",body:C})).ok&&(n++,await $e(d,t)&&i++)}catch(x){console.error(`Failed to upload ${d.name}:`,x)}}H(null),le(!1),P([]),await y(t||void 0),c(`‚úÖ ${n}Í∞ú Ï†ÄÏû•, ${i}Í∞ú ArchiveÎ°ú Ïù¥ÎèôÎê®`),M(),n>0&&J("docs")},We=t=>{w({show:!0,title:"OneDrive ÌååÏùº ÏÇ≠Ï†ú",message:`"${t.name}" ÌååÏùºÏùÑ ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?`,subMessage:"OneDriveÏóêÏÑú ÏòÅÍµ¨Ï†ÅÏúºÎ°ú ÏÇ≠Ï†úÎê©ÎãàÎã§. Ïù¥ ÏûëÏóÖÏùÄ ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§.",onConfirm:()=>Fe(t)})},Fe=async t=>{var n;w(null);try{const i=await E();if(!i){g({show:!0,type:"error",title:"ÏÇ≠Ï†ú Ïã§Ìå®",message:"MS Î°úÍ∑∏Ïù∏Ïù¥ ÌïÑÏöîÌï©ÎãàÎã§."});return}const s=`${b.graphDriveEndpoint}/items/${t.id}`,a=await fetch(s,{method:"DELETE",headers:{Authorization:`Bearer ${i}`}});if(a.ok||a.status===204){g({show:!0,type:"success",title:"ÏÇ≠Ï†ú ÏôÑÎ£å",message:`"${t.name}" ÌååÏùºÏù¥ OneDriveÏóêÏÑú ÏÇ≠Ï†úÎêòÏóàÏäµÎãàÎã§.`}),P(x=>x.filter(k=>k.id!==t.id));const d=l.length>0?l[l.length-1].id:void 0;await y(d)}else{const d=await a.json().catch(()=>({}));g({show:!0,type:"error",title:"ÏÇ≠Ï†ú Ïã§Ìå®",message:((n=d.error)==null?void 0:n.message)||"OneDrive ÌååÏùº ÏÇ≠Ï†úÏóê Ïã§Ìå®ÌñàÏäµÎãàÎã§."})}}catch(i){g({show:!0,type:"error",title:"ÏÇ≠Ï†ú Ïã§Ìå®",message:i.message||"OneDrive ÌååÏùº ÏÇ≠Ï†ú Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§."})}},K=t=>{const n=t||o;if(!n)return"";const i=D.find(s=>s.name===n);return(i==null?void 0:i.displayName)||n.split("/").pop()||""};return e.jsxs("div",{style:{height:"100%",display:"flex",flexDirection:"column",background:"linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%)"},children:[e.jsxs("div",{style:{padding:"16px 20px",background:"linear-gradient(135deg, #0f172a 0%, #1e293b 50%, #334155 100%)",color:"#fff",display:"flex",alignItems:"center",gap:14,boxShadow:"0 4px 20px rgba(0,0,0,0.15)",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"radial-gradient(circle at 20% 50%, rgba(16,185,129,0.12) 0%, transparent 50%), radial-gradient(circle at 80% 50%, rgba(59,130,246,0.1) 0%, transparent 50%)",pointerEvents:"none"}}),e.jsx("div",{style:{width:44,height:44,borderRadius:12,background:"linear-gradient(135deg, #10b981 0%, #0ea5e9 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(16,185,129,0.35)",position:"relative"},children:e.jsx(Le,{size:22,strokeWidth:2.5})}),e.jsxs("div",{style:{flex:1,position:"relative"},children:[e.jsx("h1",{style:{margin:0,fontSize:18,fontWeight:700,letterSpacing:"-0.02em"},children:"RAG Manager"}),e.jsx("p",{style:{margin:"2px 0 0",fontSize:11,opacity:.7,fontWeight:400},children:"Store & Document Control"})]}),h.length>0?e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"8px 12px",background:"rgba(255,255,255,0.1)",backdropFilter:"blur(10px)",borderRadius:8,border:"1px solid rgba(255,255,255,0.1)",fontSize:12,fontWeight:500,position:"relative"},children:[e.jsx(He,{size:14,style:{opacity:.8}}),e.jsx("span",{style:{maxWidth:80,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:(fe=h[0].username)==null?void 0:fe.split("@")[0]}),e.jsx("button",{onClick:Ie,style:{padding:4,background:"rgba(255,255,255,0.15)",border:"none",borderRadius:5,color:"#fff",cursor:"pointer",marginLeft:2,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Ge,{size:12})})]}):e.jsxs("button",{onClick:Y,disabled:ve!==Ne.None,style:{display:"flex",alignItems:"center",gap:6,padding:"8px 14px",background:"rgba(255,255,255,0.1)",backdropFilter:"blur(10px)",borderRadius:8,border:"1px solid rgba(255,255,255,0.1)",fontSize:12,fontWeight:500,color:"#fff",cursor:"pointer",position:"relative"},children:[e.jsx(Pe,{size:14})," MS Î°úÍ∑∏Ïù∏"]})]}),j&&e.jsxs("div",{style:{margin:"12px 12px 0",padding:"10px 14px",fontSize:12,fontWeight:500,background:j.includes("‚úÖ")?"linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%)":j.includes("‚ùå")?"linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%)":"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)",color:j.includes("‚úÖ")?"#047857":j.includes("‚ùå")?"#b91c1c":"#1d4ed8",display:"flex",alignItems:"center",justifyContent:"space-between",borderRadius:10,boxShadow:"0 2px 8px rgba(0,0,0,0.06)",border:j.includes("‚úÖ")?"1px solid rgba(16,185,129,0.2)":j.includes("‚ùå")?"1px solid rgba(239,68,68,0.2)":"1px solid rgba(59,130,246,0.2)"},children:[e.jsx("span",{children:j}),e.jsx("button",{onClick:()=>c(null),style:{background:"rgba(0,0,0,0.08)",border:"none",borderRadius:5,cursor:"pointer",padding:4,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(Z,{size:12})})]}),e.jsx("div",{style:{display:"flex",gap:6,padding:"12px 12px 0",background:"transparent"},children:[{key:"store",label:"Ïä§ÌÜ†Ïñ¥",icon:R},{key:"docs",label:"Î¨∏ÏÑú",icon:B},{key:"upload",label:"ÏóÖÎ°úÎìú",icon:xe}].map(t=>e.jsxs("button",{onClick:()=>J(t.key),style:{flex:1,padding:"10px 8px",border:"none",borderRadius:10,background:m===t.key?"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)":"#fff",color:m===t.key?"#fff":"#64748b",fontSize:11,fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:5,boxShadow:m===t.key?"0 4px 12px rgba(59,130,246,0.3)":"0 2px 6px rgba(0,0,0,0.05)",transition:"all 0.2s"},children:[e.jsx(t.icon,{size:13}),t.label]},t.key))}),e.jsxs("div",{style:{flex:1,overflow:"auto",padding:12},children:[m==="store"&&e.jsxs("div",{children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs("div",{style:{display:"flex",gap:8,padding:6,background:"#fff",borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.06)"},children:[e.jsx("input",{type:"text",value:I,onChange:t=>ne(t.target.value),placeholder:"ÏÉà Ïä§ÌÜ†Ïñ¥ Ïù¥Î¶Ñ",style:{flex:1,padding:"10px 14px",border:"none",borderRadius:8,fontSize:12,background:"#f8fafc",outline:"none"},onKeyDown:t=>t.key==="Enter"&&de()}),e.jsx("button",{onClick:de,disabled:!I.trim()||$,style:{padding:"10px 14px",background:!I.trim()||$?"#e2e8f0":"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",color:"#fff",border:"none",borderRadius:8,cursor:"pointer",display:"flex",alignItems:"center",gap:4,boxShadow:!I.trim()||$?"none":"0 2px 8px rgba(59,130,246,0.3)"},children:e.jsx(Je,{size:14})})]})}),o&&e.jsxs("div",{style:{marginBottom:16,padding:16,background:"linear-gradient(135deg, #0f172a 0%, #1e293b 100%)",borderRadius:14,boxShadow:"0 8px 24px rgba(0,0,0,0.15)",color:"#fff",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"radial-gradient(circle at 100% 0%, rgba(59,130,246,0.2) 0%, transparent 50%)",pointerEvents:"none"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12,position:"relative"},children:[e.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(59,130,246,0.4)"},children:e.jsx(R,{size:18})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,opacity:.6,marginBottom:2,letterSpacing:"0.05em"},children:"ACTIVE STORE"}),e.jsx("div",{style:{fontSize:15,fontWeight:700,letterSpacing:"-0.01em"},children:K()})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"10px 14px",background:"rgba(255,255,255,0.1)",backdropFilter:"blur(10px)",borderRadius:10,fontSize:12,fontWeight:500,position:"relative"},children:[e.jsx(B,{size:14,style:{opacity:.8}}),e.jsxs("span",{children:[u.length,"Í∞ú Î¨∏ÏÑú Ïó∞Í≤∞Îê®"]})]})]}),e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#475569",marginBottom:10,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsxs("span",{children:["Ï†ÑÏ≤¥ Ïä§ÌÜ†Ïñ¥ (",D.length,")"]}),e.jsx("button",{onClick:N,style:{padding:6,background:"#f1f5f9",border:"none",borderRadius:6,cursor:"pointer",color:"#64748b",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ee,{size:12})})]}),$?e.jsx("div",{style:{padding:30,textAlign:"center"},children:e.jsx(U,{size:24,style:{color:"#94a3b8",animation:"spin 1s linear infinite"}})}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:D.map(t=>e.jsxs("div",{onClick:()=>ke(t.name),style:{padding:12,borderRadius:10,cursor:"pointer",background:t.name===o?"linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%)":"#fff",border:t.name===o?"1px solid #3b82f6":"1px solid #e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-between",boxShadow:t.name===o?"0 4px 12px rgba(59,130,246,0.15)":"0 2px 6px rgba(0,0,0,0.04)",transition:"all 0.2s"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10},children:[e.jsx("div",{style:{width:32,height:32,borderRadius:8,background:t.name===o?"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)":"#f1f5f9",display:"flex",alignItems:"center",justifyContent:"center"},children:t.name===o?e.jsx(ue,{size:14,style:{color:"#fff"}}):e.jsx(R,{size:14,style:{color:"#94a3b8"}})}),e.jsx("span",{style:{fontSize:13,fontWeight:t.name===o?600:500,color:t.name===o?"#1e40af":"#475569"},children:t.displayName})]}),e.jsx("button",{onClick:n=>ze(t.name,n),style:{padding:6,background:"#fef2f2",border:"none",borderRadius:6,cursor:"pointer",color:"#ef4444",opacity:.8,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(te,{size:12})})]},t.name))})]}),m==="docs"&&e.jsxs("div",{children:[o&&e.jsxs("div",{style:{marginBottom:16,padding:16,background:"linear-gradient(135deg, #0f172a 0%, #1e293b 100%)",borderRadius:14,boxShadow:"0 8px 24px rgba(0,0,0,0.15)",color:"#fff",position:"relative",overflow:"hidden"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"radial-gradient(circle at 100% 0%, rgba(59,130,246,0.2) 0%, transparent 50%)",pointerEvents:"none"}}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12,marginBottom:12,position:"relative"},children:[e.jsx("div",{style:{width:40,height:40,borderRadius:10,background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 4px 12px rgba(59,130,246,0.4)"},children:e.jsx(R,{size:18})}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:10,opacity:.6,marginBottom:2,letterSpacing:"0.05em"},children:"ACTIVE STORE"}),e.jsx("div",{style:{fontSize:15,fontWeight:700,letterSpacing:"-0.01em"},children:K()})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,padding:"10px 14px",background:"rgba(255,255,255,0.1)",backdropFilter:"blur(10px)",borderRadius:10,fontSize:12,fontWeight:500,position:"relative"},children:[e.jsx(B,{size:14,style:{opacity:.8}}),e.jsxs("span",{children:[u.length,"Í∞ú Î¨∏ÏÑú Ïó∞Í≤∞Îê®"]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:12},children:[e.jsxs("div",{style:{fontSize:12,fontWeight:600,color:"#475569"},children:["Ïä§ÌÜ†Ïñ¥ Î¨∏ÏÑú (",u.length,")"]}),e.jsx("button",{onClick:()=>M(),style:{padding:6,background:"#f1f5f9",border:"none",borderRadius:6,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ee,{size:12,style:{color:"#64748b"}})})]}),o?me?e.jsx("div",{style:{padding:40,textAlign:"center"},children:e.jsx(U,{size:28,style:{color:"#94a3b8",animation:"spin 1s linear infinite"}})}):u.length===0?e.jsxs("div",{style:{padding:40,textAlign:"center",background:"#fff",borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[e.jsx("div",{style:{width:60,height:60,borderRadius:16,background:"linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:e.jsx(B,{size:28,style:{color:"#0ea5e9"}})}),e.jsx("div",{style:{fontSize:14,color:"#475569",fontWeight:600,marginBottom:4},children:"Î¨∏ÏÑúÍ∞Ä ÏóÜÏäµÎãàÎã§"}),e.jsx("div",{style:{fontSize:12,color:"#94a3b8",marginBottom:16},children:"ÏóÖÎ°úÎìú ÌÉ≠ÏóêÏÑú Î¨∏ÏÑúÎ•º Ï∂îÍ∞ÄÌïòÏÑ∏Ïöî"}),e.jsx("button",{onClick:()=>J("upload"),style:{padding:"10px 20px",background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",color:"#fff",border:"none",borderRadius:10,fontSize:12,fontWeight:600,cursor:"pointer",boxShadow:"0 4px 12px rgba(59,130,246,0.3)"},children:"Î¨∏ÏÑú ÏóÖÎ°úÎìú"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:u.map((t,n)=>e.jsxs("div",{style:{padding:12,background:"#fff",borderRadius:10,border:"1px solid #e2e8f0",display:"flex",alignItems:"center",gap:10,boxShadow:"0 2px 6px rgba(0,0,0,0.04)",animation:"fadeIn 0.3s ease-out"},children:[e.jsx("div",{style:{width:36,height:36,borderRadius:8,background:"linear-gradient(135deg, #3b82f6 0%, #8b5cf6 100%)",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff",fontSize:11,fontWeight:700,flexShrink:0},children:n+1}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsx("div",{style:{fontSize:12,fontWeight:600,color:"#1e293b",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.displayName}),e.jsxs("div",{style:{fontSize:10,color:"#94a3b8",marginTop:2},children:[(parseInt(t.sizeBytes)/1024).toFixed(1)," KB"]})]}),e.jsx("span",{style:{padding:"4px 8px",fontSize:9,borderRadius:5,fontWeight:600,background:t.state==="STATE_ACTIVE"?"linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%)":"#fef3c7",color:t.state==="STATE_ACTIVE"?"#15803d":"#92400e"},children:t.state==="STATE_ACTIVE"?"Active":t.state}),e.jsx("button",{onClick:()=>Re(t.name),style:{padding:6,background:"#fef2f2",border:"none",borderRadius:6,cursor:"pointer",color:"#ef4444",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(te,{size:12})})]},t.name))}):e.jsxs("div",{style:{padding:40,textAlign:"center",background:"#fff",borderRadius:12,boxShadow:"0 2px 8px rgba(0,0,0,0.04)"},children:[e.jsx("div",{style:{width:60,height:60,borderRadius:16,background:"linear-gradient(135deg, #e2e8f0 0%, #f1f5f9 100%)",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px"},children:e.jsx(R,{size:28,style:{color:"#94a3b8"}})}),e.jsx("div",{style:{fontSize:13,color:"#64748b",fontWeight:500},children:"Î®ºÏ†Ä Ïä§ÌÜ†Ïñ¥Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî"})]})]}),m==="upload"&&e.jsx("div",{style:{animation:"fadeIn 0.3s ease-out"},children:o?e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{padding:"10px 12px",marginBottom:16,background:"linear-gradient(135deg, #1e293b 0%, #334155 100%)",borderRadius:8,color:"#fff",display:"flex",alignItems:"center",gap:10},children:[e.jsx(R,{size:16,style:{opacity:.8}}),e.jsx("span",{style:{fontSize:13,fontWeight:600},children:K()}),e.jsxs("span",{style:{marginLeft:"auto",fontSize:11,opacity:.7},children:[u.length,"Í∞ú Î¨∏ÏÑú"]})]}),e.jsxs("div",{style:{position:"relative",paddingLeft:24},children:[e.jsx("div",{style:{position:"absolute",left:7,top:12,bottom:12,width:2,background:"linear-gradient(180deg, #3b82f6 0%, #0ea5e9 50%, #10b981 100%)",borderRadius:1}}),e.jsxs("div",{style:{position:"relative",marginBottom:16},children:[e.jsx("div",{style:{position:"absolute",left:-24,top:8,width:18,height:18,borderRadius:"50%",background:"#3b82f6",border:"2px solid #dbeafe",display:"flex",alignItems:"center",justifyContent:"center",fontSize:9,fontWeight:700,color:"#fff"},children:"1"}),e.jsxs("div",{onClick:h.length>0?()=>{var t;return(t=re.current)==null?void 0:t.click()}:Y,style:{padding:"10px 12px",background:"#fff",borderRadius:8,border:"1px solid #e2e8f0",cursor:"pointer",display:"flex",alignItems:"center",gap:10},children:[e.jsx(xe,{size:16,style:{color:"#3b82f6"}}),e.jsx("span",{style:{fontSize:12,color:"#475569"},children:je?"ÏóÖÎ°úÎìú Ï§ë...":h.length>0?"Î°úÏª¨ ÌååÏùº ‚Üí OneDrive":"MS Î°úÍ∑∏Ïù∏ ÌïÑÏöî"})]})]}),e.jsx("input",{ref:re,type:"file",onChange:t=>{var n;(n=t.target.files)!=null&&n[0]&&Te(t.target.files[0]),t.target.value=""},style:{display:"none"}}),e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:12,marginLeft:-12},children:e.jsx(ye,{size:16,style:{color:"#94a3b8"}})}),e.jsxs("div",{style:{position:"relative",marginBottom:16},children:[e.jsx("div",{style:{position:"absolute",left:-24,top:8,width:18,height:18,borderRadius:"50%",background:"#0ea5e9",border:"2px solid #e0f2fe",display:"flex",alignItems:"center",justifyContent:"center",fontSize:9,fontWeight:700,color:"#fff"},children:"2"}),e.jsxs("div",{style:{background:"#fff",borderRadius:8,border:"1px solid #e2e8f0",overflow:"hidden"},children:[e.jsxs("div",{style:{padding:"10px 12px",background:"linear-gradient(135deg, #0078d4 0%, #00bcf2 100%)",display:"flex",alignItems:"center",gap:8},children:[e.jsx(qe,{size:16,style:{color:"#fff"}}),e.jsx("span",{style:{fontSize:13,fontWeight:600,color:"#fff"},children:"OneDrive"}),e.jsx("span",{style:{fontSize:11,color:"rgba(255,255,255,0.7)",marginLeft:"auto"},children:"ÌååÏùº ÏÑ†ÌÉù"})]}),e.jsx("div",{style:{padding:"8px 12px",background:"#f8fafc",borderBottom:"1px solid #e2e8f0",display:"flex",alignItems:"center",gap:6},children:q?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>ce(-1),style:{padding:"2px 8px",background:l.length===0?"#0ea5e9":"#fff",color:l.length===0?"#fff":"#64748b",border:"none",borderRadius:4,cursor:"pointer",fontSize:11},children:"Root"}),l.map((t,n)=>e.jsxs(Me.Fragment,{children:[e.jsx(he,{size:10,style:{color:"#94a3b8"}}),e.jsx("button",{onClick:()=>ce(n),style:{padding:"2px 8px",background:n===l.length-1?"#0ea5e9":"#fff",color:n===l.length-1?"#fff":"#64748b",border:"none",borderRadius:4,cursor:"pointer",fontSize:11},children:t.name})]},t.id)),e.jsxs("div",{style:{marginLeft:"auto",display:"flex",gap:4},children:[e.jsx("button",{onClick:()=>{const t=l.length>0?l[l.length-1].id:void 0;y(t)},style:{padding:4,background:"transparent",border:"none",cursor:"pointer"},children:e.jsx(ee,{size:12,style:{color:"#64748b"}})}),e.jsx("button",{onClick:()=>ae(!1),style:{padding:4,background:"transparent",border:"none",cursor:"pointer"},children:e.jsx(Z,{size:12,style:{color:"#64748b"}})})]})]}):e.jsx("button",{onClick:h.length>0?_:Y,style:{background:"transparent",border:"none",cursor:"pointer",fontSize:12,color:"#0ea5e9",fontWeight:500},children:h.length>0?"OneDrive Ïó¥Í∏∞":"MS Î°úÍ∑∏Ïù∏"})}),L&&e.jsxs("div",{style:{padding:"6px 12px",background:"#fef3c7",fontSize:11,color:"#92400e"},children:[L.file," (",L.current+1,"/",L.total,")"]}),q&&e.jsx("div",{style:{maxHeight:180,overflow:"auto"},children:we?e.jsx("div",{style:{padding:16,textAlign:"center"},children:e.jsx(U,{size:18,style:{color:"#94a3b8",animation:"spin 1s linear infinite"}})}):V.length===0?e.jsx("div",{style:{padding:16,textAlign:"center",color:"#94a3b8",fontSize:12},children:"Îπà Ìè¥Îçî"}):e.jsxs(e.Fragment,{children:[V.filter(t=>t.folder).map(t=>e.jsxs("div",{onClick:()=>Ee(t),style:{padding:"8px 12px",borderBottom:"1px solid #f1f5f9",display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx(Ve,{size:14,style:{color:"#0ea5e9"}}),e.jsx("span",{style:{flex:1,fontSize:12,color:"#374151"},children:t.name}),e.jsx(he,{size:12,style:{color:"#94a3b8"}})]},t.id)),V.filter(t=>t.file).map(t=>{const n=f.some(i=>i.id===t.id);return e.jsxs("div",{style:{padding:"8px 12px",borderBottom:"1px solid #f1f5f9",display:"flex",alignItems:"center",gap:8,background:n?"#eff6ff":"transparent"},children:[e.jsx("input",{type:"checkbox",checked:n,onChange:()=>Ae(t),style:{width:14,height:14,cursor:"pointer",accentColor:"#3b82f6"}}),e.jsx(B,{size:14,style:{color:n?"#3b82f6":"#94a3b8"}}),e.jsx("span",{style:{flex:1,fontSize:12,color:n?"#1d4ed8":"#374151",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),e.jsx("button",{onClick:i=>{i.stopPropagation(),We(t)},style:{padding:2,background:"transparent",border:"none",cursor:"pointer",opacity:.5},children:e.jsx(te,{size:12,style:{color:"#ef4444"}})})]},t.id)})]})})]})]}),e.jsx("div",{style:{display:"flex",justifyContent:"center",marginBottom:12,marginLeft:-12},children:e.jsx(ye,{size:16,style:{color:"#94a3b8"}})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx("div",{style:{position:"absolute",left:-24,top:8,width:18,height:18,borderRadius:"50%",background:f.length>0?"#10b981":"#d1d5db",border:`2px solid ${f.length>0?"#dcfce7":"#f3f4f6"}`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:9,fontWeight:700,color:"#fff"},children:"3"}),f.length===0?e.jsx("div",{style:{padding:"12px",background:"#f9fafb",borderRadius:8,border:"1px dashed #d1d5db",textAlign:"center",fontSize:12,color:"#9ca3af"},children:"OneDriveÏóêÏÑú ÌååÏùºÏùÑ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî"}):e.jsxs("div",{style:{background:"#fff",borderRadius:8,border:"1px solid #10b981",overflow:"hidden"},children:[e.jsx("div",{style:{padding:"8px 12px",background:"#ecfdf5",borderBottom:"1px solid #d1fae5",display:"flex",alignItems:"center",justifyContent:"space-between"},children:e.jsxs("span",{style:{fontSize:12,fontWeight:600,color:"#065f46"},children:["ÏÑ†ÌÉùÎê® (",f.length,")"]})}),e.jsx("div",{style:{maxHeight:80,overflow:"auto"},children:f.map((t,n)=>e.jsxs("div",{style:{padding:"6px 12px",borderBottom:"1px solid #f1f5f9",display:"flex",alignItems:"center",gap:8,fontSize:11},children:[e.jsx("span",{style:{color:"#10b981",fontWeight:600},children:n+1}),e.jsx("span",{style:{flex:1,color:"#374151",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.name}),e.jsx("button",{onClick:()=>Be(t),disabled:A,style:{padding:2,background:"transparent",border:"none",cursor:"pointer"},children:e.jsx(Z,{size:12,style:{color:"#ef4444"}})})]},t.id))}),e.jsx("div",{style:{padding:10},children:e.jsx("button",{onClick:Oe,disabled:A,style:{width:"100%",padding:"10px",background:A?"#9ca3af":"#10b981",color:"#fff",border:"none",borderRadius:8,fontSize:13,fontWeight:600,cursor:A?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:6},children:A?e.jsxs(e.Fragment,{children:[e.jsx(U,{size:14,style:{animation:"spin 1s linear infinite"}})," Ï†ÄÏû• Ï§ë..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{size:14})," Ïä§ÌÜ†Ïñ¥Ïóê Ï†ÄÏû•"]})})})]})]})]})]}):e.jsxs("div",{style:{padding:24,textAlign:"center",background:"#f8fafc",borderRadius:12,border:"1px dashed #cbd5e1"},children:[e.jsx(R,{size:32,style:{color:"#94a3b8",marginBottom:8}}),e.jsx("div",{style:{fontSize:13,color:"#64748b"},children:"Î®ºÏ†Ä Ïä§ÌÜ†Ïñ¥Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî"})]})})]}),(v==null?void 0:v.show)&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,width:"100%",maxWidth:400,boxShadow:"0 4px 24px rgba(0,0,0,0.2)"},children:[e.jsx("div",{style:{padding:"16px 20px",borderBottom:"1px solid #e5e7eb"},children:e.jsx("h3",{style:{fontSize:17,fontWeight:600,margin:0,color:"#1f2937"},children:v.title})}),e.jsxs("div",{style:{padding:20},children:[e.jsx("p",{style:{fontSize:14,color:"#374151",margin:0},children:v.message}),v.subMessage&&e.jsx("p",{style:{fontSize:13,color:"#6b7280",marginTop:8,marginBottom:0},children:v.subMessage})]}),e.jsxs("div",{style:{padding:"14px 20px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end",gap:8},children:[e.jsx("button",{onClick:()=>w(null),style:{padding:"10px 20px",background:"#f3f4f6",border:"none",borderRadius:8,fontSize:14,fontWeight:500,cursor:"pointer",color:"#374151"},children:"Ï∑®ÏÜå"}),e.jsx("button",{onClick:v.onConfirm,style:{padding:"10px 20px",background:"#ef4444",color:"#fff",border:"none",borderRadius:8,fontSize:14,fontWeight:600,cursor:"pointer"},children:"ÏÇ≠Ï†ú"})]})]})}),(p==null?void 0:p.show)&&e.jsx("div",{style:{position:"fixed",inset:0,background:"rgba(0,0,0,0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3},children:e.jsxs("div",{style:{background:"#fff",borderRadius:12,width:"100%",maxWidth:360,boxShadow:"0 4px 24px rgba(0,0,0,0.2)"},children:[e.jsxs("div",{style:{padding:28,textAlign:"center"},children:[e.jsx("div",{style:{width:52,height:52,borderRadius:"50%",background:p.type==="success"?"#10b981":p.type==="error"?"#ef4444":"#f59e0b",color:"white",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 16px",fontSize:26},children:p.type==="success"?"‚úì":p.type==="error"?"‚úï":"!"}),e.jsx("h3",{style:{fontSize:17,fontWeight:600,marginBottom:8,color:"#1f2937"},children:p.title}),e.jsx("p",{style:{fontSize:14,color:"#6b7280",lineHeight:1.5},children:p.message})]}),e.jsx("div",{style:{padding:"14px 20px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"center"},children:e.jsx("button",{onClick:()=>g(null),style:{padding:"10px 32px",background:p.type==="success"?"#10b981":p.type==="error"?"#ef4444":"#f59e0b",color:"#fff",border:"none",borderRadius:8,fontSize:14,fontWeight:600,cursor:"pointer"},children:"ÌôïÏù∏"})})]})}),e.jsx("style",{children:`
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-6px); } }
      `})]})}export{rt as TNTChatRightPanel};
